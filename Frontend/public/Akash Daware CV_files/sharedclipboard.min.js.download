function _define_property(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){_define_property(e,t,r[t])}))}return e}var sharedClipboard=function(e){var t={};function r(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(o,i,function(t){return e[t]}.bind(null,i));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.replaceChildren=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;const o=r(4);t.utils=o;const i=r(1);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return i.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return i.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return i.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return i.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return i.ConsoleLogger}});const a=r(5);t.browserSupport=a;const n=r(6);t.perfWatch=n;const s=r(7);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return s.initStopwatchFactory}});const l=r(8);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return l.TelemetryCollector}});var d=r(9);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return d.getNewGuid}});var c=r(10);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return c.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return c.TextAreaInputMode}});var g=r(11);Object.defineProperty(t,"replaceChildren",{enumerable:!0,get:function(){return g.replaceChildren}})},function(e,t,r){"use strict";var o,i;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(o||(t.TraceLevel=o={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(i||(t.LogCategory=i={})),t.ULS={getFromExternalLogger:function(e){const t=e;return{ULS:{trace:(e,r,o)=>t.traceTag(0,e,r,o),traceTag:(e,r,o,i)=>t.traceTag(e,r,o,i),debugTrace:(e,r,o)=>t.debugTraceTag(0,e,r,o),debugTraceTag:(e,r,o,i)=>t.debugTraceTag(e,r,o,i),assert:(e,r,o)=>t.assertTag(0,e,r,o),assertTag:(e,r,o,i)=>t.assertTag(e,r,o,i),shipAssert:(e,r,o)=>t.shipAssertTag(0,e,r,o),shipAssertTag:(e,r,o,i)=>t.shipAssertTag(e,r,o,i),dnmTrace:(e,r,o)=>t.dnmTraceTag(0,e,r,o),dnmTraceTag:(e,r,o,i)=>t.dnmTraceTag(e,r,o,i)}}}},t.ConsoleLogger=class{shipAssertTag(e,t,r,o){console.assert(r,"shipAssertTag:",e,t,o)}assertTag(e,t,r,o){console.assert(r,"assertTag",e,t,o)}traceTag(e,t,r,o){console.log("traceTag",e,o,t,r)}dnmTraceTag(e,t,r,o){console.log("dnmTraceTag",e,o,t,r)}debugTraceTag(e,t,r,o){console.log("debugTraceTag",e,o,t,r)}},t.NulLogger=class{shipAssertTag(){}assertTag(){}traceTag(){}debugTraceTag(){}dnmTraceTag(){}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return Je}));var o={};r.r(o),r.d(o,"sharedClipboardSettingsVariableName",(function(){return O})),r.d(o,"defaultPromiseTimeoutInMinutes",(function(){return R})),r.d(o,"getSharedClipboardSettings",(function(){return F})),r.d(o,"initializeSharedClipboardSettingsFromWindow",(function(){return $})),r.d(o,"initializeSharedClipboardSettings",(function(){return J})),r.d(o,"createEmptySharedClipboardSettings",(function(){return H}));var i=r(0);let a;function n(){return a}function s(e){if(!e)throw new Error("The 'logger' argument is missing");a=i.ULS.getFromExternalLogger(e)}var l,d,c,g,u;function p(e){if(e&&"object"==typeof e){if(h(e.reason))return!0;if(e.innerError&&"string"==typeof e.innerError)try{if(h(JSON.parse(e.innerError).reason))return!0}catch(e){}}if("string"==typeof e)try{if(h(JSON.parse(e).reason))return!0}catch(e){}return!1}function h(e){return e===d.LocalStorageInitilizationInaccessible}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory",e[e.AsyncSystemClipboard=8]="AsyncSystemClipboard",e[e.AsyncSystemClipboardAndLocalStorage=9]="AsyncSystemClipboardAndLocalStorage",e[e.AsyncSystemClipboardAndInMemory=10]="AsyncSystemClipboardAndInMemory"}(l||(l={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage"}(d||(d={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(c||(c={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext"}(g||(g={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(u||(u={}));class m extends Error{static augmentParameterValue(e){return e&&"string"==typeof e?e.trim():""}constructor(e,t,r){const o=m.augmentParameterValue(e);if(super(o),this.name=m.augmentParameterValue(t),this.errorName=this.name,this.name?n().ULS.traceTag(596456211,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Error '${this.name}': ${o}`):n().ULS.traceTag(596456212,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error message: "+o),r){this.innerError=r;let e=this.innerError.message;e||(e=this.innerError.name);const t=m.augmentParameterValue(e);t.length>0&&n().ULS.traceTag(596456213,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Inner error message: "+t)}this.stack||(this.stack=(new Error).stack)}}class f extends m{constructor(e,t){super(e,"NoValidKeyError",t)}}class S extends m{static getDefaultMessage(e){let t="Missing argument";return e.length>0&&(t=`Missing argument: '${e}'`),t}constructor(e,t,r){const o=m.augmentParameterValue(t),i=S.getDefaultMessage(o);let a=m.augmentParameterValue(e);0===a.length&&(a=i),super(a,"MissingArgumentError",r),this.name=o}}class w extends m{static getDefaultMessage(e,t){return e.length>0?`Invalid '${e}' argument: '${t}'`:"Invalid argument"}constructor(e,t,r,o){const i=m.augmentParameterValue(t);let a=r;a||(a="");const n=w.getDefaultMessage(i,a);let s=m.augmentParameterValue(e);0===e.length&&(s=n),super(s,"InvalidArgumentError",o),this.name=i,this.value=a}}class C extends m{constructor(e,t){super(e,"InvalidOperationError",t)}}class b extends m{constructor(e,t,r,o,i){super(t||"reason="+e,r,o),this.reason=e,i&&(this.errorName=i)}}class y extends b{constructor(e,t,r){var o,i;super(e,t,"ClipboardPlatformError",r,function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(o=e,i=d)?i[o]:"")}}new RegExp("(\\bTrident/| MSIE )"),new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");const T=(e,t,r,o)=>{e.postMessage(t,r,o)},L=function(){const e={items:{}};return{getData:()=>e,getItem:e=>{},setItem:(e,t)=>{throw new C(`Cannot set an item with clipboard data format '${e}' in an immutable empty clipboard (content is ${t&&t.length>0?"not ":""}empty)`)},hasDeferredItem:e=>!1,getDeferredItem:e=>{},get:()=>_(void 0)}}();function E(){return L}function v(e){return e&&e.items?Object.keys(e.items).length:0}function I(e){return v(e&&e.getData())}function P(e){let t=e;t||(t={items:{}});const r=e=>A(t,e);return{getItem:r,setItem:(e,r)=>{!function(e,t,r){if(!e)throw new S("","clipboardItemsData");if(!e.items)throw new w("","clipboardItemsData.items");e.items[t]=r}(t,e,r)},hasDeferredItem:e=>{const t=r(e);return t&&t.length>0},getDeferredItem:e=>Promise.resolve(r(e)),getData:()=>t,get:()=>_(t)}}function A(e,t){if(!e)throw new S("","clipboardItemsData");if(!e.items)throw new w("","clipboardItemsData.items");return e.items[t]}function _(e){const t=[];if(0===v(e))return t;for(const r in e.items){let o=A(e,r);o||(o="");const i={clipboardDataFormat:r,data:o,deferred:!1};t.push(i)}return t}var M,x,W;!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage",e[e.AsyncSystemClipboard=4]="AsyncSystemClipboard"}(M||(M={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PictureInCell=2048]="PictureInCell",e[e.ColumnWidths=4096]="ColumnWidths",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink",e[e.PastePictureInCell=2052]="PastePictureInCell",e[e.PasteWithColumnWidths=4100]="PasteWithColumnWidths"}(x||(x={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(W||(W={}));const O="sharedClipboardSettings",R=2;let D=H(),U=!1;function F(){if(!U)throw new C("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return D}function $(){U=!1,function(){if(!window||!(O in window))return D=H(),void(U=!0);const e=window[O];if(!e||"object"!=typeof e)return D=H(),void(U=!0);N(e)}()}function J(e){U=!1,N(e)}function N(e){if(!e)throw new S("","sharedClipboardSettingsCandidate");const t=H();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return D=t,void(U=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return n().ULS.traceTag(596124181,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),D=t,void(U=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();let r=t.sharedClipboardHostingApp;const o=r.indexOf("-");o>=0&&(r=r.substr(o+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch(t){n().ULS.traceTag(579737680,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some(e=>!e||!e.trim()))return n().ULS.traceTag(596124182,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],D=t,void(U=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch(t){n().ULS.traceTag(579737681,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some(e=>!e||!e.trim()))return n().ULS.traceTag(596124183,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],D=t,void(U=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return n().ULS.traceTag(596124184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],D=t,void(U=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return n().ULS.traceTag(596124185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' or '${r}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],D=t,void(U=!0)}t.whitelistOriginComponents=!0,D=t,U=!0}function H(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:"",sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:1,sharedClipboardExpirationInMinutes:3600,clipboardPromiseTimeoutInMinutes:R,remoteLoggerPath:""}}const z=new RegExp("^\\d+$");let j,k,V=!1;function B(e){if(!e)throw new S("","origin");let t="",r=e.trim().toLowerCase().split("://",3);if(!r||0===r.length||!r[0]||"http"!==r[0]&&"https"!==r[0])throw new w("Missing protocol","origin",e);if(1===r.length)throw new w("Missing domain","origin",e);if(r.length>2)throw new w("'://' should appear once","origin",e);let o=r[1];if(!o)throw new w("Missing domain","origin",e);if(t=r[0]+"://",o=o.trim(),r=o.trim().split("/",3),!r||0===r.length||!r[0]||!r[0].trim())throw new w("Missing domain","origin",e);if(r.length>2)throw new w("The last part of the origin should be the domain","origin",e);if(2===r.length&&r[1])throw new w("The last part of the origin should be the domain","origin",e);if(r=o.split(":",3),!r||0===r.length||!r[0]||!r[0].trim())throw new w("Missing domain","origin",e);if(r.length>2||2===r.length&&(!r[1]||!r[1].trim()))throw new w("The last part of the origin should be the domain and an optional port number","origin",e);if(o=r[0].trim(),t+=o,2===r.length){const o=r[1].trim(),i=z.exec(o);if(!i||1!==i.length)throw new w("Invalid port number","origin",e);const a=Number(o);if(isNaN(a))throw new w("Invalid port number","origin",e);t+=":"+o}return n().ULS.traceTag(596452423,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`getValidatedOrigin: origin = '${e}'; validated origin = '${t}'`),t}function K(e){X();const t=B(e),r=B(function(){let e="";return window&&window.location&&window.location.origin?(e=window.location.origin,e||(e="")):(n().ULS.traceTag(595932950,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`windowLocation.getWindowLocation: is window exist: ${!!window}. is window.location exist: ${window&&!!window.location}. is window.location.origin exist ${window&&window.location&&!!window.location.origin}. is window.location.protocol exist ${window&&window.location&&!!window.location.protocol}. is window.location.hostname exist ${window&&window.location&&!!window.location.hostname}. is window.location.port exist ${window&&window.location&&!!window.location.port}`),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}().origin);if(t===r)return t;if(!F().whitelistOriginComponents)throw new C(`validateOriginForReceivedMessage: Caller origin '${e}' doesn't match the current window's origin '${r}'`);const o=q(t),a=q(r);if(o.protocol!==a.protocol)throw new C(`validateRemoteWindowOrigin: Caller origin's protocol '${o.protocol}' doesn't match the current window origin's protocol '${a.protocol}'`);if(o.environment!==a.environment)throw new C(`validateRemoteWindowOrigin: Caller origin's environment '${o.environment}' doesn't match the current window origin's environment '${a.environment}'`);return t}function q(e){X();const t=e.split("://",2),r=t[0],o=G(t[1]),i={protocol:r};if(i.environment=Q(e,o,k),o.length<=i.environment.length+1)throw new w("Missing app component","origin",e);if("."!==o.charAt(i.environment.length))throw new w("Missing a domain separator after the environment component","origin",e);const a=o.substr(i.environment.length+".".length);if(i.app=Q(e,a,j),i.app.length<a.length&&"-"!==a.charAt(i.app.length))throw new w("When the Office Online app name is not the domain prefix, '-' should precede it","origin",e);return i}function G(e){if(!e)throw new S("","stringToReverse");let t="";for(let r=e.length-1;r>=0;r-=1)t+=e.charAt(r);return t}function Q(e,t,r){if(!t)throw new S("","reversedValidatedHostname");if(!r)throw new S("","reversedStringsToLengthMap");const o=t.length,i=Object.keys(r).filter(e=>{const i=r[e];return i<=o&&t.substr(0,i)===e});if(i&&i.length>0)return G(i[0]);throw new w("Invalid origin","validatedOrigin",e)}function X(){if(V)return;const e=F();e.whitelistOriginComponents&&(j=Y(e.sharedClipboardHostingApps),k=Y(e.sharedClipboardHostingEnvironments),V=!0)}function Y(e){const t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach(e=>{t[G(e)]=e.length}),t):t}function Z(){return(Math.random()+1).toString(36).substring(7)}class ee{}function te(e){return"get"===e||"set"===e||"init"===e}ee.localStorageData="localStorage/data",ee.localStorageMetadata="localStorage/metadata",ee.initIframe="initIframe";const re=function(e){if(!e)throw new S("","clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new S("","id");if(!e.operationCode)throw new S("","operationCode");if(!e.destination)throw new S("","destination");if(!te(e.operationCode))throw new w("","operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new w(`'${e.operationCode}' expects no clipboard items`,"clipboardItemsData")};function oe(e,t,r,o,i){const a={id:e,operationCode:t,failed:r,error:o,clipboardItemsData:i};return ie(a),a}const ie=function(e){if(!e)throw new S("","clipboardOperationResultMessage");const t=["failed","error","clipboardItemsData","operationCode","id","userHash"];let r=!1;for(const o of t)if(e.hasOwnProperty(o)){r=!0;break}if(!r)throw new f("clipboardOperationResultMessage has no valid key");if(!e.id||0===e.id.trim().length)throw n().ULS.traceTag(553747865,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`Missing argument 'id'. keys: ${JSON.stringify(Object.keys(e))}, isConstructorObject: ${e.constructor===Object}, operationCode: ${e.operationCode}, id: ${e.id}, failed: ${e.failed}, error: ${e.error}.`),new S("","id");if(!e.operationCode)throw new S("","operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new w("","operationCode",e.operationCode);if(e.failed){if(!e.error)throw new w(`A failed '${e.operationCode}' operation expects a non-empty error argument`,"error");if(e.clipboardItemsData)throw new w(`A failed '${e.operationCode}' operation does not expect a clipboardItemsData argument`,"clipboardItemsData")}else{if(e.error)throw new w(`'${e.operationCode}' expects an empty error argument`,"error");if("unknownresult"===e.operationCode)throw new w(`'${e.operationCode}' can only be used with a failure message`,"operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new w(`'${e.operationCode}' expects a clipboardItems argument`,"clipboardItemsData")}else if(e.clipboardItemsData)throw new w(`'${e.operationCode}' expects no clipboardItemsData argument`,"clipboardItemsData")};function ae(e){if(!e||0===e.trim().length)throw new w("","className",e);return(()=>{let t=!1;function r(t){return`${e}:${t}: already disposed`}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&n().ULS.traceTag(596456217,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new C(r(e))}}})()}const ne=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function se(e){let t=e;return t&&0!==t.trim().length||(t=Z()),new ge(t)}function le(){return ne?window.performance.now():Date.now()}function de(e){return ne?new Date(e+window.performance.timing.navigationStart):new Date(e)}function ce(e,t,r){if(!r)throw new S("","creationTimestamp");return`${e?"Fulfilled":"Still unfulfilled"} after ${e?t?t-r:"?":le()-r}ms`}class ge{fulfilled(){return this.isFulfilled}resolve(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):n().ULS.traceTag(596456257,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`Deferred promise - resolve: the resolve for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}reject(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):n().ULS.traceTag(596456260,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`Deferred promise - reject: the reject for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}markAsFulfilled(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=le(),n().ULS.traceTag(596456261,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Deferred promise: marking promise #${this.sequenceId} with id '${this.id}' as fulfilled (${this.rejected?"rejected":"resolved"}). ${ce(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`))}fulfillmentCheck(e){return n().ULS.traceTag(596456258,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Deferred promise: asked to ${e} deferred promise #${this.sequenceId} with id '${this.id}'`),this.isFulfilled&&n().ULS.traceTag(596456259,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`Deferred promise: cannot ${e} deferred promise #${this.sequenceId} with id '${this.id}' since it was ${this.rejected?"rejected":"resolved"} already on ${de(this.fulfillmentTimestamp)}. ${ce(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`),this.isFulfilled}constructor(e){this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=function(e){if(!e)throw new S("","id");const t=e.trim().toLowerCase();if(0===t.length)throw new w("","id");return t}(e),ge.sequenceId+=1,this.sequenceId=ge.sequenceId,this.creationTimestamp=le(),n().ULS.traceTag(596456225,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Deferred promise: creating deferred promise #${this.sequenceId} with id '${this.id}' on ${de(this.creationTimestamp)}`),this.promise=new Promise((e,t)=>{n().ULS.traceTag(596456226,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Deferred promise: registering callback for promise #${this.sequenceId} with id '${this.id}' on ${de(le())}`),this.internalResolve=e,this.internalReject=t})}}function ue(e){if(!e)throw new S("","remoteWindow");if(!("window"in e)||!e.window)throw new S("","remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new S("","remoteWindow.windowOrigin");const t=K(e.windowOrigin);return{window:e.window,windowOrigin:t}}function pe(){return he}ge.sequenceId=0;const he={addEventListener:(e,t)=>window.addEventListener(e,t),removeEventListener:(e,t)=>window.removeEventListener(e,t)};class me{dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(pe().removeEventListener("message",this.windowMessageHandler),this.disposableImplementationExtension.dispose())}shouldFilterMessageEvent(e){try{if(!e.origin||!e.source)return n().ULS.traceTag(596452370,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return n().ULS.traceTag(596452371,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return n().ULS.traceTag(596452372,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return n().ULS.traceTag(596452373,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1}onMessageReceived(e){if(this.shouldFilterMessageEvent(e))return;let t=void 0;try{t=this.deserializer.deserialize(e.data)}catch(e){n().ULS.traceTag(596452374,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: unable to deserialize incoming message. "+i.utils.getStringifiedError(e));try{this.handler.handleDeserializationError(e)}catch(e){n().ULS.traceTag(596452184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to handle deserialization error. "+i.utils.getStringifiedError(e))}return}if(t)try{this.handler.handleMessage(t).catch(e=>{n().ULS.traceTag(595985880,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))})}catch(e){n().ULS.traceTag(596452186,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))}else n().ULS.traceTag(596452185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: the incoming message is empty")}constructor(e,t,r){if(this.deserializer=e,this.handler=t,this.windowMessageHandler=e=>this.onMessageReceived(e),!e)throw new S("","deserializer");if(!t)throw new S("","handler");if(!r)throw new S("","windowRPC");this.disposableImplementationExtension=ae("WindowRPCReceiverInternal"),this.remoteWindow=ue(r.remoteWindow),pe().addEventListener("message",this.windowMessageHandler)}}class fe{postMessage(e){if(!e)throw new S("","outgoingMessage");if(!this.remoteWindow.window)throw new C("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new C("The remote window does not support postMessage");const t=this.serializer.serialize(e);T(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e,t,r=!1){if(this.serializer=e,this.delayedQueueEnabled=r,!e)throw new S("","serializer");if(!t)throw new S("","windowRPC");this.disposableImplementationExtension=ae("WindowRPCSenderInternal"),this.remoteWindow=ue(t.remoteWindow)}}function Se(e){return"OfficeOnlineCCP_Metadata_"+e}var we;!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(we||(we={}));class Ce{get(e){this.disposableImplementationExtension.throwIfDisposed("get"),n().ULS.traceTag(595716238,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`localStorageClipboardStorage.get: commandParameters.id='${e?e.id:""}'`);const t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(E());try{const e=JSON.parse(t);if(!e||0===v(e))return Promise.resolve(E());const r=P(e);return Promise.resolve(r)}catch(e){return Promise.resolve(E())}}set(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),n().ULS.traceTag(595716239,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`localStorageClipboardStorage.set: item count=${I(e)}'; commandParameters.id='${t?t.id:""}'`),0===I(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));const r=this.localStorageKey+"_LocalStorageChangedFlag",o=Z();return n().ULS.traceTag(595654546,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`localStorageClipboardStorage.set: set local storage value. eventFalgKey = ${r}. eventFlagValue = ${o}`),localStorage.setItem(r,o),Promise.resolve()}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),["text/plain","text/html","data/shadow-workbook"]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new y(d.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: failed access to localStorage",e)}if(!e)throw new y(d.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=M.LocalStorage,this.disposableImplementationExtension=ae("LocalStorageClipboardStorage")}}function be(e){return n().ULS.traceTag(595716236,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Attempting to create clipboard strategy type '${l.LocalStorage}' with localStorageKey: '${e}'`),(new ye).initialize(function(e){try{n().ULS.traceTag(595716237,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Attempting to create clipboard storage type '${M.LocalStorage}'`);const t=new Ce(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}(e))}class ye extends class{initialize(e){return e.then(e=>(this.clipboardStorage=e,n().ULS.traceTag(596453007,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Clipboard strategy type '${this.clipboardStrategyType}' was initialized.`),Promise.resolve(this)),e=>(n().ULS.traceTag(596453008,i.LogCategory.msoulscat_ES_EWAJS,p(e)?i.TraceLevel.Info:i.TraceLevel.Error,`Failed to initialize clipboard strategy type '${this.clipboardStrategyType}'. Error: ${i.utils.getStringifiedError(e)}`),Promise.reject(e)))}set(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){const e="ClipboardStrategyBase.set: this.clipboardStorage should be defined";return n().ULS.shipAssertTag(596121485,i.LogCategory.msoulscat_ES_EWAJS,!1,e),Promise.reject(new y(d.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new y(d.SetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).set`,e))}}get(e){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){const e="ClipboardStrategyBase.get: this.clipboardStorage should be defined";return n().ULS.shipAssertTag(596121486,i.LogCategory.msoulscat_ES_EWAJS,!1,e),Promise.reject(new y(d.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then(e=>(this.clipboardDataProcessor&&this.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e))).catch(t=>{throw n().ULS.traceTag(507848131,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`ClipboardStrategyBase.get - Failed to get clipboard items. Command id: ${e.id}, Error: ${i.utils.getStringifiedError(t)}`),t})}catch(e){return Promise.reject(new y(d.GetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).get`,e))}}onSystemClipboardChangedExternally(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(E(),e):(n().ULS.shipAssertTag(595882508,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new y(d.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new y(d.ClearClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).onSystemClipboardChangedExternally`,e))}}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())}constructor(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=ae(""+e)}}{constructor(e){super(l.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},e)}}class Te{onStorageChanged(e){n().ULS.shipAssertTag(595716249,i.LogCategory.msoulscat_ES_EWAJS,null!=e,"e should not be null"),n().ULS.traceTag(595716288,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = ${e.key}. localStorageKeyToWatch = ${this.localStorageKeyToWatch}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),n().ULS.traceTag(595716289,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = "+this.lastLocalStorageValue),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then(()=>{this.raiseMetadataChangedEvent()},()=>{n().ULS.traceTag(595716295,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")}))}raiseMetadataChangedEvent(){return n().ULS.traceTag(595715525,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = "+this.lastLocalStorageValue),this.clipboardStrategy.get({userHash:0}).then(e=>{this.listener(e),n().ULS.traceTag(595716232,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = "+this.lastLocalStorageValue)},e=>{n().ULS.traceTag(595716233,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")})}isLocalStorageValueChanged(){const e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return n().ULS.traceTag(595715526,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = ${this.lastLocalStorageValue}. currentLocalStorageValue = ${e}`),this.lastLocalStorageValue=e,t}waitForLocalStorageValueToChange(e){if(n().ULS.traceTag(595715527,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = "+this.lastLocalStorageValue),this.isLocalStorageValueChanged())return n().ULS.traceTag(595715528,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = "+this.lastLocalStorageValue),Promise.resolve();const t=se(),r=new Date,o=setInterval(()=>{const a=(new Date).getTime()-r.getTime();n().ULS.traceTag(595715529,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = ${r}. elapseTime = ${a}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()?(clearInterval(o),n().ULS.traceTag(595716234,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = ${r}. elapseTime = ${a}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.resolve()):a>e&&(clearInterval(o),n().ULS.traceTag(595716235,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = ${r}. elapseTime = ${a}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.reject())},200);return t.promise}constructor(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}}new RegExp("(\n\r)|(\r\n)|(\r)","g"),new RegExp("(\t)","g"),new RegExp("<","g"),new RegExp(">","g");var Le,Ee,ve=r(1);!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(Le||(Le={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(Ee||(Ee={}));class Ie{handleTrace(e){e.message.length>Ie.messageMaxChars&&(e.message=e.message.substr(0,Ie.messageMaxChars-Ie.trimmedMessage.length)+Ie.trimmedMessage),this.logCache.push(e),(this.logCache.length>Ie.uploadTriggerSize||e.level===Ee.Error)&&this.triggerUploadAsync()}constructor(e,t,r){this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=()=>{this.triggerUpload(!1,!1)},this.flush=()=>{this.triggerUploadAsync()},this.triggerUploadAsync=()=>{window.setTimeout(()=>this.triggerUpload(!0,!0),0)},this.triggerUpload=(e,t)=>{window.clearTimeout(this.timeoutId),this.logCache.length>0&&(this.uploadId+=1,function(e,t,r){if(!t)return;const o=window.navigator;if(o&&o.sendBeacon)try{return void o.sendBeacon(t,e)}catch(e){}!function(e,t,r){const o=new XMLHttpRequest;o.readyState!==XMLHttpRequest.UNSENT&&o.readyState!==XMLHttpRequest.DONE||(o.open("POST",t,r),o.send(e))}(e,t,r)}(function(e,t,r,o){const i=[],a=e.map(e=>function(e,t,r){const o={};if(o.G=e.tag,o.T=e.timestamp-t,o.M=e.message,o.C=e.category,e.correlationId){let t=r.findIndex(t=>t===e.correlationId);t<0&&(t=r.push(e.correlationId)-1),o.I=t}const i=1e3*e.type+e.level;return o.D=i,o}(e,o,i)),n=function(e,t,r,o,i){const a={};return a.T=e,a.L=t,a.S=r,a.I=o,i&&i.length>0&&(a.W=i),a.V=1,a}(o,a,t,r,i);return JSON.stringify(n)}(this.logCache,this.userSessionId,this.uploadId,this.timestampBase),this.remoteUrlEndpoint,t),this.logCache=[],this.timestampBase=Date.now()),e&&(this.timeoutId=window.setTimeout(this.triggerUploadAsync,Ie.uploadCadenceInMsSec))},this.userSessionId=e;let o=t+"?usid="+e;void 0!==r&&r.forEach((e,t)=>{o+="&"+t+"="+e}),this.remoteUrlEndpoint=o,window.setTimeout(()=>this.triggerUpload(!0,!0),0)}}function Pe(e,t,r,o,i,a){if(o>Ee.Info)return;const n={timestamp:Date.now(),category:r,tag:t,level:o,type:Le.Trace,message:i,correlationId:a};e.handleTrace(n)}Ie.messageMaxChars=3072,Ie.uploadCadenceInMsSec=3e4,Ie.uploadTriggerSize=30,Ie.trimmedMessage="... [Trimmed]";class Ae extends class{handleMessage(e,t){return e&&e.operationCode in this._handlers?this._handlers[e.operationCode].handleMessage(e,t):_e(t,new y(d.UnsupportedOperationCode,`Operation code '${e?e.operationCode:"incomingMessage is null"}' is unsupported`))}addMessageHandler(e,t){e?e in this._handlers?n().ULS.shipAssertTag(595944464,i.LogCategory.msoulscat_ES_EWAJS,!1,`BaseMessageHandler.addMessageHandler: handle for operation: ${e} already exist`):this._handlers[e]=t:n().ULS.shipAssertTag(595944463,i.LogCategory.msoulscat_ES_EWAJS,!1,"BaseMessageHandler.addMessageHandler: expected operationCode to be defined")}constructor(){this._handlers={}}}{get(e,t){const r={userHash:e.userHash};return this.clipboardStrategy.get(r).then(e=>(t.clipboardItemsData=e.getData(),Promise.resolve(t)),e=>_e(t,e))}set(e,t){const r={userHash:e.userHash};let o=void 0;return e.clipboardItemsData&&(o=e.clipboardItemsData),this.clipboardStrategy.set(P(o),r).then(()=>Promise.resolve(t),e=>_e(t,e))}constructor(e){super(),this.clipboardStrategy=e,this.nameForTelemetry="ClipboardStrategyMessageHandler_StrategyType_"+e.clipboardStrategyType,this.addMessageHandler("get",{handleMessage:this.get.bind(this)}),this.addMessageHandler("set",{handleMessage:this.set.bind(this)})}}function _e(e,t){return Me(e,t),Promise.resolve(e)}function Me(e,t){e.failed=!0,e.error=i.utils.getStringifiedError(t)}class xe extends class{get disposableImplementationExtension(){return this._disposableImplementationExtension}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(function(e){if(!e||!Array.isArray(e)||0===e.length)return void n().ULS.traceTag(596456214,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: no actions to execute");let t=0,r=void 0;if(e.forEach(e=>{if(t+=1,e)try{e()}catch(e){n().ULS.traceTag(596456216,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`rethrowAfterAllActions: callback action #${t} threw an exception: ${e.message}`),r||(r=new C(e.message,e))}else n().ULS.traceTag(596456215,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`rethrowAfterAllActions: callback action #${t} is empty`)}),r)throw r}([()=>{this.sender&&this.sender.dispose()},()=>{this.receiver&&this.receiver.dispose()}]),this.disposableImplementationExtension.dispose())}postMessage(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new S("","outgoingMessage");if(!this.sender){const e="WindowRPCBase::postMessage - this.sender should be defined";throw n().ULS.shipAssertTag(596121484,i.LogCategory.msoulscat_ES_EWAJS,!1,e),new C(e)}this.sender.postMessage(e)}constructor(e,t,r,o){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=ae(o)}}{handleMessage(e){if(n().ULS.traceTag(596452360,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`RPC Server - handleMessage: incomingMessage.id='${e&&e.id}'; incomingMessage.operationCode='${e&&e.operationCode}'; incomingMessage.clipboardItems.length=${v(e&&e.clipboardItemsData)}`),this.windowRPCServerState.isInitializationPending()&&e&&"init"===e.operationCode)return n().ULS.traceTag(596129562,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"The clipboard strategy is not initialized yet. Once it's done, it'll send an 'initresult' message."),Promise.resolve();const t=e&&e.id?e.id:"unknownmessageid",r=!e||!e.operationCode||!te(e.operationCode),o={id:t,failed:r,error:void 0,operationCode:r?"unknownresult":e.operationCode+"result"};return this.routeOperation(e,o).then(e=>this.postMessage(e)).catch(e=>(n().ULS.traceTag(596452182,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"RPC Server - handleMessage: unable to send result message. Sending a failure message. "+i.utils.getStringifiedError(e)),o.clipboardItemsData=void 0,Me(o,e),this.postMessage(o))).catch(e=>(n().ULS.traceTag(596452183,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"RPC Server - handleMessage: unable to send failure result message. "+i.utils.getStringifiedError(e)),Promise.reject(e)))}routeOperation(e,t){if(this.windowRPCServerState.isInitializationPending())return _e(t,new y(d.SelectClipboardStrategy,"A clipboard strategy had not been selected and initialized yet"));if(!this.windowRPCServerState.isInitializedSuccessfully())return _e(t,this.windowRPCServerState.getClipboardInitError());if("init"===e.operationCode)return Promise.resolve(t);const r=this.windowRPCServerState.getMessageHandler(e.destination);return r?r.handleMessage(e,t):_e(t,new y(d.SelectClipboardStrategy,"messageHandler does not exist"))}handleDeserializationError(e){return this.postMessage({id:"unknownmessageid",failed:!0,error:i.utils.getStringifiedError(e),operationCode:"unknownresult"}).catch(e=>{n().ULS.traceTag(596451867,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"RPC Server - handleDeserializationError: unable to send failure result message. "+i.utils.getStringifiedError(e))})}postMessage(e){try{return super.postMessage(e),Promise.resolve()}catch(t){return Promise.reject(new C(`Unable to post message for operation '${e&&e.operationCode?e.operationCode:""}'`,t))}}constructor(e,t,r,o){if(super(t,e,r,"WindowRPCServerInternal"),this.windowRPCServerState=o,!o)throw new y(d.CreateWindowRPCServer,"windowRPCServerState is undefined.");this.receiver=function(e,t,r){return new me(e,t,r)}(e,this,this),this.sender=function(e,t){return new fe(e,t)}(t,this)}}class We extends class{sendMessage(e){if(this.windowRPCServer){const t=oe(Z(),this.operationCode,!1,void 0,e);this.windowRPCServer.postMessage(t)}}constructor(e,t){this.windowRPCServer=e,this.operationCode=t}}{raiseMetadataChangedEvent(e){this.sendMessage(e.getData())}constructor(e,t,r){super(r,"getMetadata_longPollingresult"),this.localStorageKeyChangeTracker=new Te(t,e,this.raiseMetadataChangedEvent.bind(this))}}function Oe(e,t){if(!t)return Promise.resolve(!1);const r=function(e,t){try{const r=window.parent,o=e;if(!o)throw new S("remoteWindowOrigin is undefined","remoteWindowOrigin");return new xe(function(e){if(!e)throw new S("","validator");return{deserialize:t=>function(e,t){if(!e)throw new S("","incomingMessage");if(!t)throw new S("","validator");if(0===e.length)throw new w("An empty message is invalid","incomingMessage");const r=e.trim();if(0===r.length)throw new w("A message cannot contain only spaces","incomingMessage");let o;try{o=JSON.parse(r)}catch(t){throw new w("Deserialization failed","incomingMessage",`Contains ${e.length.toString()} characters`,t)}if(!o)throw new w("Deserialization returned nothing","incomingMessage");return t(o),o}(t,e)}}(re),function(e){if(!e)throw new S("","validator");return{serialize:t=>function(e,t){if(!e)throw new S("","outgoingMessage");if(!t)throw new S("","validator");return t(e),function(e){let t;try{t=JSON.stringify(e)}catch(t){throw new w("Serialization failed","outgoingMessage",Object.keys(e).length+" properties",t)}return n().ULS.traceTag(596452375,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"The length of the serialized message is "+t.length),t}(e)}(t,e)}}(ie),{window:r,windowOrigin:o},t)}catch(e){return void n().ULS.shipAssertTag(595981475,i.LogCategory.msoulscat_ES_EWAJS,!1,"createWindowRPCServer failed with exception: "+i.utils.getStringifiedError(e))}}(e,Re);if(!r)return n().ULS.traceTag(595947554,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"initModuleState: Failed to create windowRPCServer"),Promise.resolve(!1);const o=se("initmessageid");return De={initMessageIdUniqueRunningSuffix:1,initializationDeferredPromise:o,windowRPCServer:r},De.initializationDeferredPromise.promise.then(()=>function(){const e=Fe();if(n().ULS.shipAssertTag(595947555,i.LogCategory.msoulscat_ES_EWAJS,!!e,"sendClipboardInitializationSuccessResult: windowRPCServer must be defined"),!e)return Promise.reject(new C("sendClipboardInitializationSuccessResult cannot post a message since WindowRPCServer could not be created"));const t=oe($e(),"initresult",!1);return e.postMessage(t)}(),e=>function(e){const t=Fe();if(n().ULS.shipAssertTag(595947584,i.LogCategory.msoulscat_ES_EWAJS,!!t,"sendClipboardInitializationFailureResult: windowRPCServer must be defined"),!t)return Promise.reject(new C("sendClipboardInitializationFailureResult cannot post a message since WindowRPCServer could not be created"));const r=oe($e(),"initresult",!0,i.utils.getStringifiedError(e));return t.postMessage(r)}(e)).catch(()=>{}),t.then(e=>(De&&(De.metadataDataChangedMessageSender=new We(e.metadataClipboardStrategy,e.localStorageMetadataKeyToWatch,r)),function(e){const t=Object.keys(e).map(t=>`Name: ${t}, handlerName: ${e[t]&&e[t].nameForTelemetry}`).join(", ");n().ULS.traceTag(595947585,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`markInitializationSuccess: Created and initialized ClipboardStrategies '${t}'`),n().ULS.shipAssertTag(595947586,i.LogCategory.msoulscat_ES_EWAJS,!!De,"markInitializationSuccess: windowRPCServerInternalState must be defined"),De&&(De.clipboardOperationMessageHandlerMap=e,De.clipboardInitError=void 0,De.clipboardInitTimestamp=Date.now(),De.initializationDeferredPromise&&De.initializationDeferredPromise.resolve())}(e.messageHandlers),Promise.resolve(!0)),e=>(function(e){n().ULS.traceTag(595947587,i.LogCategory.msoulscat_ES_EWAJS,p(e)?i.TraceLevel.Info:i.TraceLevel.Error,"markInitializationFailure: Failed to initialize ClipboardStrategies"),n().ULS.shipAssertTag(595947588,i.LogCategory.msoulscat_ES_EWAJS,!!De,"markInitializationFailure: windowRPCServerInternalState must be defined"),De&&(De.clipboardOperationMessageHandlerMap=void 0,De.clipboardInitError=e,De.clipboardInitTimestamp=Date.now(),De.initializationDeferredPromise&&De.initializationDeferredPromise.reject(De.clipboardInitError))}(e),Promise.resolve(!1)))}const Re={getMessageHandler:function(e){if(De)if(e)if(De.clipboardOperationMessageHandlerMap){if(e in De.clipboardOperationMessageHandlerMap)return De.clipboardOperationMessageHandlerMap[e];n().ULS.shipAssertTag(595945237,i.LogCategory.msoulscat_ES_EWAJS,!1,`getMessageHandler: ${e} is not part of ClipboardStrategyMap`)}else n().ULS.shipAssertTag(595945236,i.LogCategory.msoulscat_ES_EWAJS,!1,"getMessageHandler: clipboardOperationMessageHandlerMap is not initialized");else n().ULS.shipAssertTag(595945235,i.LogCategory.msoulscat_ES_EWAJS,!1,"getMessageHandler: expected destination to be defined")},isInitializationPending:Ue,isInitializedSuccessfully:function(){return!!De&&(!Ue()&&!!De.clipboardOperationMessageHandlerMap)},getClipboardInitError:function(){if(De)return De.clipboardInitError}};let De=void 0;function Ue(){return!De||!De.initializationDeferredPromise||!De.initializationDeferredPromise.fulfilled()}function Fe(){if(De)return De.windowRPCServer}function $e(){if(!De)return"";const e=De.initMessageIdUniqueRunningSuffix;return De.initMessageIdUniqueRunningSuffix+=1,"initmessageid"+e}function Je(){s(new ve.ConsoleLogger),o.initializeSharedClipboardSettingsFromWindow();let e=i.utils.getQueryParameterByName(window.location.href,"CreatorOrigin")||"";if(!e)throw new S("remoteWindowOrigin is undefined","remoteWindowOrigin");e=K(e);try{const t=i.utils.getQueryParameterByName(window.location.href,"usid")||"";let r=i.utils.getQueryParameterByName(window.location.href,"BulsEndpointUrl")||"";if(!r){const i=o.getSharedClipboardSettings().remoteLoggerPath;i&&t&&(r=`${e}${i}`)}r&&s(function(e,t){const r=function(e,t){const r=new Ie(e,t);return{sendTraceTag:(e,t,o,i)=>Pe(r,e,t,o,i,""),shipAssertTag:(e,t,o,i)=>{o&&Pe(r,e,t,Ee.Error,i,"")},debugAssertTag:()=>{throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:r.flush,flushOnClose:r.flushOnClose,setCorrelationId:()=>{}}}(t,e);return{assertTag:(e,t,o,i)=>r.shipAssertTag(e,t,!o,i),shipAssertTag:(e,t,o,i)=>r.shipAssertTag(e,t,!o,i),debugTraceTag:r.sendTraceTag,traceTag:r.sendTraceTag}}(r,t))}catch(e){}const t=o.getSharedClipboardSettings().sharedClipboardSchemaVersion;return Oe(e,be(function(e){return"OfficeOnlineCCP_Data_"+e}(t)).then(e=>{const r=Se(t),o=function(e){return Se(e)+"_LocalStorageChangedFlag"}(t);return be(r).then(t=>{const r={};return r[ee.localStorageData]=new Ae(e),r[ee.localStorageMetadata]=new Ae(t),{messageHandlers:r,localStorageMetadataKeyToWatch:o,dataClipboardStrategy:e,metadataClipboardStrategy:t}})}))}},function(e,t,r){"use strict";r.r(t);var o=r(0);for(var i in o)["default"].indexOf(i)<0&&function(e){r.d(t,e,(function(){return o[e]}))}(i);var a=r(2);r.d(t,"initialize",(function(){return a.a}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce((e,o)=>e.then(()=>r&&r.stop?Promise.resolve(void 0):t(o,r)),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r=0){if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;const o={};Object.getOwnPropertyNames(t).forEach(e=>{"stack"!==e&&e.toUpperCase()!==e&&(o[e]=t[e])});const i=Object.getPrototypeOf(t);i&&"object"==typeof i&&Object.keys(i).forEach(e=>{"stack"!==e&&e.toUpperCase()!==e&&(o[e]=t[e])});const a={};return Object.keys(o).forEach(t=>{a[t]=e(o[t],r+1)}),a}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};const o=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";let t=e.trim().substring(0,200).trim().replace(o,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));let r=Promise.reject();for(let o=1;o<=t;o+=1)r=r.catch(t=>e(o,t));return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();let r=t(e[0]);for(let o=1;o<e.length;o+=1){const i=e[o];r=r.catch(()=>t(i))}return r},t.getQueryParameterByName=function(e,t){const r=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;let t=5381,r=t;const o=e.length;for(let i=0;i<o&&(t=4294967295&((t<<5)+t^e.charCodeAt(i)),i!==o-1);i+=2)r=4294967295&((r<<5)+r^e.charCodeAt(i+1));let i=t+35685*r+(23896*r<<16)&4294967295;return i<0&&(i+=4294967296),i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;const o={};t.promises=function(){return void 0===o.promises&&(o.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),o.promises}},function(e,t,r){"use strict";function o(){const e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function i(e,t,r){e[t]=o()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){const t=o(),r=e,a=t,n={},s=(e,t,o)=>function(e,t,r,o,a,n){i(e,"end",r);const s={sessionName:t,result:o?"success":"failure",message:n,marks:e};a(JSON.stringify(s))}(n,r,a,e,t,o);return n.start=0,{mark:e=>(e=>i(n,e,a))(e),end:e=>s(!0,e),success:(e,t)=>s(!0,e,t),failure:(e,t)=>s(!1,e,t)}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;let o=()=>Date.now();t.initStopwatchFactory=function(e,t=1){return"undefined"!=typeof self&&self.performance&&self.performance.now&&(o=()=>self.performance.now()),function(r){let i=o(),a=r;return{reset(e){null!=e&&(a=e),i=o()},stop(r){const n=o()-i,s=JSON.stringify({Target:a,Duration:n.toFixed(t),StopInfo:r});e(s)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0,t.TelemetryCollector=class{getJsonForLogging(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"}addEvent(e,t){null!=e&&null!=t&&(this.events[e]=t)}clearEvents(){this.events={}}getEventsLoggableString(){return JSON.stringify(this.events)}incrementCounter(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)}getCountersLoggableString(){return JSON.stringify(this.counters)}clearCounters(){this.counters={}}startTimer(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})}endTimer(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)}getTimerDuration(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"}getTimersLoggableString(){return JSON.stringify(this.timers)}constructor(){this.counters={},this.timers={},this.events={}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){const e=new Uint8Array(31),t=function(e){const t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof crypto?crypto:"undefined"!=typeof msCrypto?msCrypto:void 0;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}let o=!1;const i="undefined"!=typeof performance?performance:void 0;try{i&&i.now&&i.now()!==1/0&&(o=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(let r=0;r<e.length;r+=1){try{if(o){t.perfNow=!0;let e=Math.floor(100*i.now())%10;(e<0||e>9)&&(e=0);for(let t=0;t<e;t+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[r]=Math.floor(16*Math.random())}return t}(e);let r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const o=15&e[r];return r+=1,("x"===t?o:3&o|8).toString(16)}),t]}},function(e,t,r){"use strict";var o,i;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(o||(t.TextAreaVirtualKeyboardPolicy=o={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(i||(t.TextAreaInputMode=i={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=e=>{if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=e=>!!e.replaceChildren}]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/sharedClipboard.min.js.map/4d5c6f8706489cf9adfa64fd733f906a/sharedClipboard.min.js.map