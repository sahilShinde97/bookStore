/*! For license information please see excelOnlineCalc.min.js.LICENSE.txt */
var excelOnlineCalc;!function(){var e={9483:function(e,t,r){"use strict";var n,a,i;r.r(t),r.d(t,{FormulaByExampleAnnotation:function(){return l},FormulaByExampleInvocationMethod:function(){return a},FormulaByExampleResultKind:function(){return n},FormulaByExampleSignal:function(){return s},FormulaByExampleWarmUpAnnotation:function(){return c},FormulaByExampleWarmUpSignal:function(){return u},ValueType:function(){return i}}),function(e){e[e.Success=0]="Success",e[e.NoFormulas=1]="NoFormulas",e[e.Failed=2]="Failed"}(n||(n={})),function(e){e[e.Explicit=0]="Explicit",e[e.Implicit=1]="Implicit"}(a||(a={})),function(e){e[e.General=0]="General",e[e.Number=1]="Number",e[e.DateTime=2]="DateTime"}(i||(i={}));class o{static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const t=o.getTypeNameFor(e);return t?[t,...o.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const r=o.getTypeNameFor(e),n=o.getBaseTypesFor(e);for(const e of t){if(e===r)return!0;if(n.indexOf(e)>=0)return!0}return!1}static assign(e,t,r){if(r)for(const e of Object.keys(r))t[e]=r[e];return t.H_=e.H_,t}constructor(e){o.assign(o,this,e)}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class s{static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.matchesTypesFor(e,[s.getTypeName()])}constructor(e){o.assign(s,this,e)}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class u{static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleWarmUpSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.matchesTypesFor(e,[u.getTypeName()])}constructor(e){o.assign(u,this,e)}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.matchesTypesFor(e,[l.getTypeName()])}constructor(e){o.assign(l,this,e)}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleWarmUpAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.matchesTypesFor(e,[c.getTypeName()])}constructor(e){o.assign(c,this,e)}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()}},8521:function(e,t,r){"use strict";function n(e,t,r){return u(e,1,t,r)}function a(e,t,r){return u(e,2,t,r)}function i(e,t,r){return u(e,3,t,r)}function o(e,t,r){return u(e,0,t,r)}function s(e,t,r){return u(e,4,t,r)}function u(e,t,r,n){return{name:e,dataType:t,value:r,classification:n||4}}var l,c,d,g,m,h,p;r.r(t),r.d(t,{Activity:function(){return O},App:function(){return L},Asha:function(){return W},AudienceGroup:function(){return w},CV:function(){return V},Contracts:function(){return f},Copilot:function(){return K},EnumObjects:function(){return le},Funnel:function(){return M},HealthQosError:function(){return x},Platform:function(){return N},Release:function(){return G},Result:function(){return I},Session:function(){return _},SimpleTelemetryLogger:function(){return se},SuppressNexus:function(){return ie},TelemetryLogger:function(){return ge},TraceContext:function(){return Oe},TraceFlags:function(){return ce},TraceParent:function(){return Re},TraceState:function(){return be},User:function(){return P},UserAction:function(){return D},cloneEvent:function(){return oe},createTraceContext:function(){return Me},getEffectiveEventFlags:function(){return Q},logError:function(){return z},logNotification:function(){return q},makeBooleanDataField:function(){return n},makeDoubleDataField:function(){return i},makeGuidDataField:function(){return s},makeInt64DataField:function(){return a},makeStringDataField:function(){return o},onNotification:function(){return H},parseTraceContext:function(){return Pe},sendHealthQosError:function(){return me}}),function(e){e.getFields=function(e,t){var r=[];return r.push(a("".concat(e,".Code"),t.code)),void 0!==t.type&&r.push(o("".concat(e,".Type"),t.type)),void 0!==t.tag&&r.push(a("".concat(e,".Tag"),t.tag)),void 0!==t.isExpected&&r.push(n("".concat(e,".IsExpected"),t.isExpected)),r.push(o("zC.Activity.Result","Office.System.Result")),r}}(l||(l={})),function(e){e.contractName="Office.System.Activity",e.getFields=function(t){var r="Activity",i=[];return void 0!==t.cV&&i.push(o("".concat(r,".CV"),t.cV)),i.push(a("".concat(r,".Duration"),t.duration)),i.push(a("".concat(r,".Count"),t.count)),i.push(a("".concat(r,".AggMode"),t.aggMode)),void 0!==t.success&&i.push(n("".concat(r,".Success"),t.success)),void 0!==t.result&&i.push.apply(i,l.getFields("".concat(r,".Result"),t.result)),i.push(o("zC.Activity",e.contractName)),i}}(c||(c={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.id&&r.push(o("".concat(e,".Id"),t.id)),void 0!==t.version&&r.push(o("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&r.push(o("".concat(e,".SessionId"),t.sessionId)),r}}(d||(d={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.alias&&r.push(o("".concat(e,".Alias"),t.alias)),void 0!==t.primaryIdentityHash&&r.push(o("".concat(e,".PrimaryIdentityHash"),t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&r.push(o("".concat(e,".PrimaryIdentitySpace"),t.primaryIdentitySpace)),void 0!==t.tenantId&&r.push(o("".concat(e,".TenantId"),t.tenantId)),void 0!==t.tenantGroup&&r.push(o("".concat(e,".TenantGroup"),t.tenantGroup)),void 0!==t.isAnonymous&&r.push(n("".concat(e,".IsAnonymous"),t.isAnonymous)),r}}(g||(g={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.name&&r.push(o("".concat(e,".Name"),t.name)),void 0!==t.state&&r.push(o("".concat(e,".State"),t.state)),r}}(m||(m={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.id&&r.push(a("".concat(e,".Id"),t.id)),void 0!==t.name&&r.push(o("".concat(e,".Name"),t.name)),void 0!==t.commandSurface&&r.push(o("".concat(e,".CommandSurface"),t.commandSurface)),void 0!==t.parentName&&r.push(o("".concat(e,".ParentName"),t.parentName)),void 0!==t.triggerMethod&&r.push(o("".concat(e,".TriggerMethod"),t.triggerMethod)),void 0!==t.timeOffsetMs&&r.push(a("".concat(e,".TimeOffsetMs"),t.timeOffsetMs)),r}}(h||(h={})),(p||(p={})).getFields=function(e,t){var r=[];return r.push(o("".concat(e,".ErrorGroup"),t.errorGroup)),r.push(a("".concat(e,".Tag"),t.tag)),void 0!==t.code&&r.push(a("".concat(e,".Code"),t.code)),void 0!==t.id&&r.push(a("".concat(e,".Id"),t.id)),void 0!==t.count&&r.push(a("".concat(e,".Count"),t.count)),r};var f,S=c,v=l,F=p,y=m,b=d,C=h,A=g;function E(e,t){return e?e+"."+t:t}function T(e,t,r,n,a){void 0===a&&(a=4),n&&e.push(o("".concat(E(t,r)),n,a))}function R(e,t,r,a){"boolean"==typeof a&&e.push(n("".concat(E(t,r)),a))}function k(e,t,r,n){"number"==typeof n&&e.push(a("".concat(E(t,r)),n))}!function(e){var t,r;t=e.Office||(e.Office={}),(r=t.System||(t.System={})).Activity=S,r.Result=v,r.Error=F,r.Funnel=y,r.Host=b,r.User=A,r.UserAction=C}(f||(f={}));var N,I={getFields:function(e){var t="Activity.Result",r=[];return k(r,t,"Code",e.code),T(r,t,"Type",e.type),k(r,t,"Tag",e.tag),R(r,t,"IsExpected",e.isExpected),r.push(o("zC.Activity.Result","Office.System.Result")),r}},O={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",r=[];return T(r,t,"CV",e.cV),k(r,t,"Duration",e.duration),k(r,t,"Count",e.count),k(r,t,"AggMode",e.aggMode),R(r,t,"Success",e.success),e.result&&r.push.apply(r,I.getFields(e.result)),r.push(o("zC.Activity",this.contractName)),r}},P={getFields:function(e){var t="User",r=[];return T(r,t,"PrimaryIdentityHash",e.primaryIdentityHash),T(r,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),T(r,t,"TenantId",e.tenantId,1),T(r,t,"TenantGroup",e.tenantGroup,1),R(r,t,"IsAnonymous",e.isAnonymous),R(r,t,"IsSignedIn",e.isSignedIn),r}},M={getFields:function(e,t){var r=[];return T(r,e,"Name",t.name),T(r,e,"State",t.state),r}},D={getFields:function(e){var t="UserAction",r=[];return k(r,t,"Id",e.id),T(r,t,"Name",e.name),T(r,t,"CommandSurface",e.commandSurface),T(r,t,"ParentName",e.parentName),T(r,t,"TriggerMethod",e.triggerMethod),k(r,t,"TimeOffsetMs",e.timeOffsetMs),r}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(N||(N={}));var w,L={getFields:function(e){var t="App",r=[];return T(r,t,"Name",e.name,1),T(r,t,"Platform",e.platform,1),T(r,t,"Version",e.version,1),r}},_={getFields:function(e){var t="Session",r=[];return T(r,t,"Id",e.id,1),T(r,t,"EcsETag",e.ecsETag,1),r}},x={getFields:function(e){var t=[];return t.push(o("Pillar",e.pillar)),t.push(o("Veto",e.veto)),t.push(n("IsIntentional",e.isIntentional)),t.push(n("IsInternal",e.isInternal)),t.push(n("AlertOnPillar",e.alertOnPillar)),t.push(n("IsSessionEndingError",e.isSessionEndingError)),R(t,void 0,"InStaging",e.inStaging),t}};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(w||(w={}));var K,W,U,G={getFields:function(e){var t=[];return T(t,"Release","AudienceGroup",e.audienceGroup,1),t}};!function(e){var t,r,n,a,i="Copilot";(a=e.FeatureActionType||(e.FeatureActionType={})).IsEnabled="IsEnabled",a.IsSeen="IsSeen",a.IsTried="IsTried",a.IsKept="IsKept",a.IsRejected="IsRejected",(n=e.Capability||(e.Capability={})).ContentGeneration="Content Generation",n.Commanding="Commanding",n.QAandSummaries="QA and Summaries",n.Collaboration="Collaboration",n.Suggestions="Suggestions",(r=e.EntryPoint||(e.EntryPoint={})).Chat="Chat",r.Canvas="Canvas",(t=e.Verb||(e.Verb={})).Create="Create",t.Command="Command",t.Ask="Ask",t.Summarize="Summarize",t.Share="Share",t.Analyze="Analyze",e.getFields=function(e){var t=[];return T(t,i,"FeatureActionType",e.featureActionType),R(t,i,"IsUserInitiated",e.isUserInitiated),T(t,i,"FeatureName",e.featureName),T(t,i,"SubFeatureName",e.subFeatureName),T(t,i,"Capability",e.capability),R(t,i,"IsThumbsUp",e.isThumbsUp),T(t,i,"EntryPoint",e.entryPoint),T(t,i,"Verb",e.verb),T(t,i,"InteractionId",e.interactionId),t.push(o("zC.".concat(i),"Office.System.Copilot")),t}}(K||(K={})),function(e){var t,r="Asha";(t=e.EventType||(e.EventType={})).Pillar="Pillar",t.Error="Error",e.getFields=function(e){var t=[];return T(t,r,"EventType",e.eventType),T(t,r,"Pillar",e.pillar),T(t,r,"Scenario",e.scenario),T(t,r,"Veto",e.veto),T(t,r,"Error",e.error),R(t,r,"InStaging",e.inStaging),R(t,r,"IsSessionEndingError",e.isSessionEndingError),R(t,r,"IsIntentional",e.isIntentional),R(t,r,"IsInternal",e.isInternal),t.push(o("zC.".concat(r),"Office.System.Asha")),t}}(W||(W={}));var B,V=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}(),j=(B=[],{fireEvent:function(e){B.forEach((function(t){return t(e)}))},addListener:function(e){e&&B.push(e)}});function H(){return j}function q(e,t,r){j.fireEvent({level:e,category:t,message:r})}function z(e,t,r){q(0,e,(function(){var e=r instanceof Error?r.message:"";return"".concat(t,": ").concat(e)}))}function Q(e){var t={costPriority:1,samplingPolicy:1,persistencePriority:1,dataCategories:0,diagnosticLevel:100};return e.eventFlags&&e.eventFlags.dataCategories||q(0,0,(function(){return"DataCategories"})),e.eventFlags?(e.eventFlags.costPriority&&(t.costPriority=e.eventFlags.costPriority),e.eventFlags.samplingPolicy&&(t.samplingPolicy=e.eventFlags.samplingPolicy),e.eventFlags.persistencePriority&&(t.persistencePriority=e.eventFlags.persistencePriority),e.eventFlags.dataCategories&&(t.dataCategories=e.eventFlags.dataCategories),e.eventFlags.diagnosticLevel&&(t.diagnosticLevel=e.eventFlags.diagnosticLevel),t):t}var $=r(3345),Y={};function J(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?Y[e]?(t.ariaTenantToken&&(Y[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(Y[e].dnmToken=t.dnmToken)):Y[e]=t:q(0,0,(function(){return"Namespace: ".concat(e)}))}function X(e,t){for(var r=e.length;r>0;){var n=e.substr(0,r);if(Y[n]){var a=Y[n];return t.ariaTenantToken=a.ariaTenantToken,t.dnmToken=a.dnmToken,!0}r=e.lastIndexOf(".",r-1)}return!1}var Z=9007199254740991,ee=-Z,te=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,re=/^[a-zA-Z0-9_\.]{1,95}$/;function ne(e){return re.test(e)}function ae(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!ne(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<ee||e>Z)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}var ie=-1;function oe(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,$.__assign)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var se=function(){function e(e,t,r){var n,a,i;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=r||{},e&&(this.telemetrySinks=e.telemetrySinks,(n=this.persistentDataFields).push.apply(n,e.persistentDataFields),this.config=(0,$.__assign)((0,$.__assign)({},e.getConfig()),this.config),(a=this.partAFields).push.apply(a,e.partAFields)),t&&(i=this.persistentDataFields).push.apply(i,t)}return e.prototype.addEventContentType=function(e,t){e.push(a("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=oe(e),r=t.telemetryProperties;r.nexusTenantToken=ie;var n=r.ariaTenantToken;n||X(t.eventName,r)||n?this.sendTelemetryEventInternal(t,1):q(0,0,(function(){return"No tenant token: "+e.eventName}))},e.prototype.sendNonStandardEvent=function(e,t){var r=oe(e);this.sendTelemetryEventInternal(r,t)},e.prototype.sendCustomerContent=function(e){var t=oe(e),r=t.telemetryProperties,n=r.customerContentVersion;return(!n||n>2)&&(r.customerContentVersion=2),r.ariaTenantToken=void 0,r.nexusTenantToken=void 0,r.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=oe(e),r=t.telemetryProperties;r.dnmToken||X(t.eventName,r)||r.dnmToken?(this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)):q(0,0,(function(){return"No dnm token: "+t.eventName}))},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):q(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void z(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach((function(r){try{3===t||2===t?r.sendNonStandardEvent&&r.sendNonStandardEvent(e,t):r.sendTelemetryEvent(e)}catch(e){}}))}else q(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var r,n,a;if(e.dataFields&&(null===(a=e.dataFields)||void 0===a||a.unshift(o("OTelJS.Version","4.19.5")),3!==t&&this.persistentDataFields&&(r=e.dataFields).unshift.apply(r,this.persistentDataFields)),this.partAFields.length>0){var i=e.eventContract||{name:"",dataFields:[]};(n=i.dataFields).push.apply(n,this.partAFields),e.eventContract=i}this.config.disableValidation||function(e){if(!(t=e.eventName)||t.length>98||!te.test(t))throw new Error("Invalid eventName");var t,r=e.eventContract;if(r){if(r.name&&!ne(r.name))throw new Error("Invalid eventContract");ae(r.dataFields)}ae(e.dataFields)}(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,r=e;t<r.length;t++){var n=r[t],a=n[0],i=n[1];this.sendTelemetryEventInternal(a,i)}},e.prototype.setTenantToken=function(e,t,r){J(e,{ariaTenantToken:t,nexusTenantToken:r})},e.prototype.setDNMToken=function(e,t){J(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return oe(e)},e.prototype.getConfig=function(){return this.config},e}(),ue=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(ue=function(){return 1e3*Math.floor(window.performance.now())});var le,ce,de=function(e){var t,r=ue(),n=oe(e.telemetryEvent);return(0,$.__assign)((0,$.__assign)({cv:e.parentCv.getNext()},n),{createChildActivity:function(t){return de({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,r){this.result={code:e,type:t,tag:r}},endNow:function(){var n,a,i=this;if(!t){void 0===this.success&&void 0===this.result&&q(1,0,(function(){return"Activity does not have success or result set"}));var o=ue();t=!0;var s={duration:o-r,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},u=null!==(a=null===(n=this.eventContract)||void 0===n?void 0:n.dataFields)&&void 0!==a?a:[];return u.push.apply(u,O.getFields(s)),this.eventContract={name:O.contractName,dataFields:u},e.sendTelemetryEvent(this)}q(0,0,(function(){return"'".concat(i.eventName,"' already ended")}))}})},ge=function(e){function t(t,r,n){var a=e.call(this,t,r,n)||this;return a.baseCv=function(){if(!U){for(var e=[],t=0;t<22;t++)e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(Math.floor(64*Math.random())));U=new V(e.join(""))}return U}(),a}return(0,$.__extends)(t,e),t.prototype.createActivity=function(e){return de({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,r,n){return this.sendTelemetryEvent({eventName:e,eventContract:{name:O.contractName,dataFields:O.getFields(t)},dataFields:r,eventFlags:n})},t.prototype.sendError=function(e){var t=function(e){var t="Error",r=[];return r.push(o("".concat(t,".ErrorGroup"),e.errorGroup)),r.push(a("".concat(t,".Tag"),e.tag)),void 0!==e.code&&r.push(a("".concat(t,".Code"),e.code)),void 0!==e.id&&r.push(a("".concat(t,".Id"),e.id)),void 0!==e.count&&r.push(a("".concat(t,".Count"),e.count)),r}(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return de({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(se);function me(e,t,r,n,a,i,o,s,u,l,c){n.forEach((function(n){e.sendTelemetryEvent({eventName:t.name+".Qos.Error."+r,eventFlags:{diagnosticLevel:110},dataFields:(0,$.__spreadArray)((0,$.__spreadArray)([],x.getFields({veto:n,pillar:a,isIntentional:i,isInternal:o,alertOnPillar:s,isSessionEndingError:u,inStaging:l}),!0),c||[],!0),telemetryProperties:{ariaTenantToken:t.token,nexusTenantToken:ie}})}))}!function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"}}(le||(le={})),function(e){e[e.None=0]="None",e[e.Sampled=1]="Sampled"}(ce||(ce={}));var he="[-_*/0-9a-z]",pe="[a-z]".concat(he,"{0,255}"),fe="[0-9a-z]".concat(he,"{0,240}"),Se="[a-z]".concat(he,"{0,13}"),ve="".concat(fe,"@").concat(Se),Fe=new RegExp("^(?:".concat(pe,"|").concat(ve,")$")),ye=/^[ -+--<>-~]{0,255}[!-+--<>-~]$/,be=function(){function e(){this._listMemberMap=new Map}return e.prototype.set=function(e,t){if(!Fe.test(e)||!ye.test(t))return!1;var r=this._listMemberMap;return r.has(e)&&r.delete(e),r.set(e,t),r.size>32&&r.delete(r.keys().next().value),!0},e.prototype.unset=function(e){this._listMemberMap.delete(e)},e.prototype.get=function(e){return this._listMemberMap.get(e)},Object.defineProperty(e.prototype,"keys",{get:function(){return Array.from(this._listMemberMap.keys()).reverse()},enumerable:!1,configurable:!0}),e.prototype.serialize=function(){var e=this;return this.keys.map((function(t){return"".concat(t).concat("=").concat(e._listMemberMap.get(t))})).join(",")},e.parse=function(t){var r=new e,n=t.split(","),a=!0;return n.reverse().forEach((function(e){var t=e.trim();if(t){var n=t.split("=");2===n.length&&r.set(n[0],n[1])||(q(1,0,(function(){return"Invalid trace state entry '".concat(t,"'")})),a=!1)}})),a?r:void 0},e}(),Ce=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-\S+)?$/,Ae=function(e){return/^0+$/.test(e)},Ee=/^([\da-f]{16})$/,Te=16,Re=function(){function e(e,t,r){void 0===e&&(e=Ne()),void 0===t&&(t=Ie()),this.traceId=e,this.version="00",this._parentId=t,this._traceFlags=function(e){return void 0===e&&(e=ce.None),e&ce.Sampled}(r)}return Object.defineProperty(e.prototype,"parentId",{get:function(){return this._parentId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"traceFlags",{get:function(){return this._traceFlags},enumerable:!1,configurable:!0}),e.prototype.isValid=function(){return Ce.test(this.serialize())&&!Ae(this.traceId)&&!Ae(this._parentId)},e.prototype.isSampled=function(){return(this.traceFlags&ce.Sampled)===ce.Sampled},e.prototype.updateSampled=function(e,t){return t!==this._parentId&&!!this.updateParentId(t)&&(this._traceFlags=e?this._traceFlags|ce.Sampled:this._traceFlags&~ce.Sampled,!0)},e.prototype.updateParentId=function(e){return e?!(!Ee.test(e)||Ae(e)||(this._parentId=e,0)):(this._parentId=Ie(),!0)},e.prototype.serialize=function(){return"".concat(this.version,"-").concat(this.traceId,"-").concat(this._parentId,"-0").concat(this._traceFlags)},e.create=function(t,r,n){var a=new e(t,r,n);return a.isValid()?a:void 0},e.createNew=function(t){return new e(Ne(),Ie(),t)},e.parse=function(t){var r=Ce.exec(t);if(r&&"ff"!==r[1]&&("00"!==r[1]||!r[5]))return e.create(r[2],r[3],parseInt(r[4],Te))},e}();function ke(e){var t=new Uint8Array(e);window.crypto.getRandomValues(t);var r=Array.from(t).map((function(e){return(256+e).toString(Te).slice(1)})).join("");return Ae(r)?r.slice(1)+"1":r}function Ne(){return ke(16)}function Ie(){return ke(8)}var Oe=function(){function e(){}return e.getFields=function(e){var t="Event.",r=e.parent,n=e.state,i=n?n.serialize():void 0;return(0,$.__spreadArray)([o(t+"TraceId",r.traceId),o(t+"TraceParentId",r.parentId),a(t+"TraceFlags",r.traceFlags)],i?[o(t+"TraceState",i)]:[],!0)},e}();function Pe(e,t){var r,n=Re.parse(e);return n&&t&&(r=be.parse(t)),r=r||new be,{parent:n||Re.createNew(),state:r}}function Me(e){return{parent:Re.createNew(e),state:new be}}},1444:function(e,t,r){"use strict";r.r(t),r.d(t,{clearImmediate:function(){return u},setImmediate:function(){return s}});let n=1;const a=new Map;let i,o=!1,s=(e,...t)=>(a.set(n,[e,t]),i(n),n++),u=e=>{a.delete(e)};function l(e){if(o)setTimeout(l,0,e);else{const t=a.get(e);if(t){o=!0;try{t[0](...t[1])}finally{u(e),o=!1}}}}const c="undefined"==typeof self?"undefined"==typeof global?void 0:global:self;c.setImmediate?(s=c.setImmediate,u=c.clearImmediate):c.importScripts?function(){const e=new MessageChannel;e.port1.onmessage=e=>{l(e.data)},i=t=>{e.port2.postMessage(t)}}():function(){const e=`setImmediate$${Math.random()}$`;window.addEventListener("message",(t=>{"string"==typeof t.data&&t.data.startsWith(e)&&l(+t.data.slice(e.length))})),i=t=>{window.postMessage(e+t,"*")}}()},3345:function(e,t,r){"use strict";r.r(t),r.d(t,{__assign:function(){return i},__asyncDelegator:function(){return T},__asyncGenerator:function(){return E},__asyncValues:function(){return R},__await:function(){return A},__awaiter:function(){return h},__classPrivateFieldGet:function(){return P},__classPrivateFieldIn:function(){return D},__classPrivateFieldSet:function(){return M},__createBinding:function(){return f},__decorate:function(){return s},__esDecorate:function(){return l},__exportStar:function(){return S},__extends:function(){return a},__generator:function(){return p},__importDefault:function(){return O},__importStar:function(){return I},__makeTemplateObject:function(){return k},__metadata:function(){return m},__param:function(){return u},__propKey:function(){return d},__read:function(){return F},__rest:function(){return o},__runInitializers:function(){return c},__setFunctionName:function(){return g},__spread:function(){return y},__spreadArray:function(){return C},__spreadArrays:function(){return b},__values:function(){return v}});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},i.apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function s(e,t,r,n){var a,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(i<3?a(o):i>3?a(t,r,o):a(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o}function u(e,t){return function(r,n){t(r,n,e)}}function l(e,t,r,n,a,i){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,u=n.kind,l="getter"===u?"get":"setter"===u?"set":"value",c=!t&&e?n.static?e:e.prototype:null,d=t||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),g=!1,m=r.length-1;m>=0;m--){var h={};for(var p in n)h[p]="access"===p?{}:n[p];for(var p in n.access)h.access[p]=n.access[p];h.addInitializer=function(e){if(g)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(e||null))};var f=(0,r[m])("accessor"===u?{get:d.get,set:d.set}:d[l],h);if("accessor"===u){if(void 0===f)continue;if(null===f||"object"!=typeof f)throw new TypeError("Object expected");(s=o(f.get))&&(d.get=s),(s=o(f.set))&&(d.set=s),(s=o(f.init))&&a.push(s)}else(s=o(f))&&("field"===u?a.push(s):d[l]=s)}c&&Object.defineProperty(c,n.name,d),g=!0}function c(e,t,r){for(var n=arguments.length>2,a=0;a<t.length;a++)r=n?t[a].call(e,r):t[a].call(e);return n?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function g(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))}function p(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(r=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}var f=Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function S(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||f(t,e,r)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function F(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(F(arguments[t]));return e}function b(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)n[a]=i[o];return n}function C(e,t,r){if(r||2===arguments.length)for(var n,a=0,i=t.length;a<i;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}function A(e){return this instanceof A?(this.v=e,this):new A(e)}function E(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,a=r.apply(e,t||[]),i=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){a[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=a[e](t)).value instanceof A?Promise.resolve(r.value.v).then(u,l):c(i[0][2],r)}catch(e){c(i[0][3],e)}var r}function u(e){s("next",e)}function l(e){s("throw",e)}function c(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function T(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,a){t[n]=e[n]?function(t){return(r=!r)?{value:A(e[n](t)),done:!1}:a?a(t):t}:a}}function R(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=v(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,a){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,a,(t=e[r](t)).done,t.value)}))}}}function k(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var N=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function I(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&f(t,e,r);return N(t,e),t}function O(e){return e&&e.__esModule?e:{default:e}}function P(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function M(e,t,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,r):a?a.value=r:t.set(e,r),r}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},630:function(e,t){"use strict";function r(e,t,r){let n=0,a=e.length;for(;n<a;){const i=Math.floor((n+a)/2);r(e[i],t)<0?n=i+1:a=i}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.strict_binsearch=t.binsearch=void 0,t.binsearch=function(e,t,n=void 0){return void 0===n&&(n=(e,t)=>e===t?0:e<t?-1:1),r(e,t,n)},t.strict_binsearch=function(e,t,n=void 0){const a=r(e,t,n);return a===e.length||0!==n(e[a],t)?-1:a}},7188:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numComparator=t.find_all_proposed_fixes=t.Colorize=t.tuple=void 0;const n=r(2595),a=r(4809),i=r(7666),o=r(2532),s=r(172),u=r(968),l=r(630);function c(e,t){if("number"==typeof e)return e-t;for(let r=0;r<e.length;r+=1){const n=c(e[r],t[r]);if(0!==n)return n}return 0}function d(...e){return e}t.tuple=d;class g{static setReportingThreshold(e){g.reportingThreshold=e}static getReportingThreshold(){return g.reportingThreshold}static setFormattingDiscount(e){g.formattingDiscount=e}static getFormattingDiscount(){return g.formattingDiscount}static process_formulas(e,t,r){(0,u.watchdog)("wd0xea1170");const a=JSON.stringify(n.ExcelUtils.baseVector()),i=(e,t)=>[e[0]+t[0],e[1]+t[1],e[2]+t[2]],o=[];for(let s=0;s<e.length;s++){(0,u.watchdog)("wd0xa1597b");const l=e[s];for(let c=0;c<l.length;c++){(0,u.watchdog)("wd0x0d7fc8");const d=l[c].toString();if(d.length>0){const u=n.ExcelUtils.all_dependencies(s,c,r+s,t+c,e),l=c+t+1,m=s+r+1;if(0===u.length)"="===d[0]&&o.push([[l,m,0],g.distinguishedZeroHash]);else{const e=u.reduce(i);if(JSON.stringify(e)===a)o.push([[l,m,0],e.toString()]);else{const t=this.hash_vector(e).toString();o.push([[l,m,0],t])}}}}}return o}static color_all_data(e){const t=[];for(const r of Object.keys(e)){(0,u.watchdog)("wd0xc22046");const e=r.split(","),n=Number(e[0]),a=Number(e[1]);t.push([[n,a,0],g.distinguishedZeroHash])}return t}static process_values(e,t,r,n){const a=[];for(let i=0;i<e.length;i++){(0,u.watchdog)("wd0x503d57");const o=e[i];for(let e=0;e<o.length;e++){(0,u.watchdog)("wd0x366ad1");const s=o[e].toString();if(s.length>0&&"="!==t[i][e][0]&&Number(s).toString()===s){const t=e+r+1,o=i+n+1;a.push([[t,o,1],g.distinguishedZeroHash])}}}return a}static identify_ranges(e,t){const r={};for(const t of e)(0,u.watchdog)("wd0x770d8c"),r[t[1]]=r[t[1]]||[],r[t[1]].push(t[0]);for(const e of Object.keys(r))(0,u.watchdog)("wd0x84ae4d"),r[e].sort(t);return r}static group_ranges(e,t){const r={};let n=0,a=1;t||(n=1,a=0);for(const t of Object.keys(e)){(0,u.watchdog)("wd0xa372ae"),r[t]=[];let i=e[t].shift(),o=i;for(const s of e[t])s[n]===o[n]&&s[a]===o[a]+1||(r[t].push([i,o]),i=s),o=s;r[t].push([i,o])}return r}static identify_groups(e){const t=this.identify_ranges(e,((e,t)=>e[0]===t[0]?e[1]-t[1]:e[0]-t[0])),r=this.group_ranges(t,!0),n=o.JSONclone.clone(r);return this.merge_groups(n)}static processed_to_matrix(e,t,r,n,a){const i=new Array(e);for(let r=0;r<e;r++)i[r]=new Array(t).fill(0);for(const e of a){const[[t,a,o],s]=e,u=a-n-1,l=t-r-1;let c=Number(g.distinguishedZeroHash);1===o||(c=Number(s)),i[u][l]=c}return i}static stencilize(e){return s.Stencil.stencil_computation(e,((e,t)=>e*t),1)}static compute_stencil_probabilities(e,t,r){const n=new Array(e);for(let r=0;r<e;r++)n[r]=new Array(t).fill(0);let a=0;const i={};for(let n=0;n<e;n++)for(let e=0;e<t;e++)i[r[n][e]]=i[r[n][e]]+1||1,0!==r[n][e]&&(a+=1);for(let o=0;o<e;o++)for(let e=0;e<t;e++)n[o][e]=i[r[o][e]]/a;let o=0,s=0;for(let n=0;n<e;n++)for(let e=0;e<t;e++)r[n][e]>0&&(s+=i[r[n][e]]);for(let n=0;n<e;n++)for(let e=0;e<t;e++)i[r[n][e]]>0&&(o+=this.entropy(i[r[n][e]]/s));return Math.log2(a),n}static generate_suspicious_cells(e,t,r,n,a,i,o=.01){const s=[];let u=0,l=0;for(let c=0;c<e;c++)for(let e=0;e<t;e++){const t=e+r+1,d=c+n+1;i[c][e]>0&&(u+=a[c][e],l+=1,i[c][e]<=o&&0!==a[c][e]&&s.push([t,d,i[c][e]]))}const c=u/l;return s.sort(((e,t)=>Math.abs(t[2]-c)-Math.abs(e[2]-c))),s}static process_suspicious(e,t,r){(0,u.watchdog)("wd0x72fd38"),new i.Timer("process_suspicious");const[a,o]=n.ExcelUtils.extract_sheet_cell(e),s=n.ExcelUtils.cell_dependency(o,0,0);let l=[];t.length>this.formulasThreshold?console.warn("Too many formulas to perform formula analysis."):l=g.process_formulas(t,s[0]-1,s[1]-1);let c=[],m=[];const h=r.length,p=r[0].length;if(r.length>this.valuesThreshold)console.warn("Too many values to perform reference analysis.");else{const e=n.ExcelUtils.generate_all_references(t,s[0]-1,s[1]-1);c=g.color_all_data(e),m=g.process_values(r,t,s[0]-1,s[1]-1)}const f=g.identify_groups(c),S=g.identify_groups(l);let v=[];return r.length<1e4&&(v=g.find_suspicious_cells(h,p,s,t,l,m,1)),d(v,S,f,g.generate_proposed_fixes(S))}static entropy(e){return-e*Math.log2(e)}static entropydiff(e,t){const r=e+t;return-(this.entropy(e/r)+this.entropy(t/r))/Math.log2(r)}static fix_metric(e,t,r,n){const[i,o]=t,[s,u]=n,l=a.RectangleUtils.area([[i[0],i[1],0],[o[0],o[1],0]]),c=a.RectangleUtils.area([[s[0],s[1],0],[u[0],u[1],0]]),d=Math.min(l,c),g=Math.max(l,c),m=Math.min(r,e),h=Math.max(r,e);let p=Math.abs(h-m)/this.Multiplier;p<1&&(p=1);let f=(1+this.entropydiff(d,g))/(p*d);return f=-f,f}static count_proposed_fixes(e){let t=0;for(const r in e){const[n,i]=e[r][1],[o,s]=e[r][2];t+=a.RectangleUtils.diagonal([[n[0],n[1],0],[i[0],i[1],0]]),t+=a.RectangleUtils.diagonal([[o[0],o[1],0],[s[0],s[1],0]])}return t}static fix_proposed_fixes(e){const t={},r={};for(const n in e){if(e[n][1]>e[n][2]){const t=e[n][1];e[n][1]=e[n][2],e[n][2]=t}t[JSON.stringify(e[n][1])]=e[n],r[JSON.stringify(e[n][2])]=e[n]}const n=[],a={};for(const i in e){const o=e[i][0];if(-o<g.reportingThreshold/100)continue;const s=JSON.stringify(e[i][1]),u=JSON.stringify(e[i][2]);if(s in r||u in t){if(!a[s]&&s in r){const t=[-o*JSON.parse(r[s][0]),e[i][1],r[s][1]];n.push(t),a[s]=!0,a[u]=!0;continue}if(!a[u]&&u in t){const r=[-o*JSON.parse(t[u][0]),e[i][1],t[u][2]];n.push(r),a[u]=!0,a[s]=!0}}else n.push(e[i])}return n}static generate_proposed_fixes(e){const t=h(e);return t.sort(c),t}static merge_groups(e){for(const t of Object.keys(e)){(0,u.watchdog)("wd0x781a33");const r=e[t].slice();e[t]=this.merge_individual_groups(r)}return e}static merge_individual_groups(e){const t=new i.Timer("merge_individual_groups");let r=0;for(e=e.sort();;){(0,u.watchdog)("wd0x0a3668");let n=!1;const i={},o=[],s=e.slice();for(;s.length>0;){const e=s.shift();for(let t=0;t<s.length;t++)if((0,u.watchdog)("wd0x9cf1d5"),a.RectangleUtils.is_mergeable(e,s[t])){const r=JSON.stringify(e),u=JSON.stringify(s[t]);if(!(r in i)&&!(u in i)){o.push(a.RectangleUtils.bounding_box(e,s[t])),i[r]=!0,i[u]=!0,n=!0;break}}}for(let t=0;t<e.length;t++)(0,u.watchdog)("wd0x1bc2bb"),JSON.stringify(e[t])in i||o.push(e[t]);if(o.sort(),!n)return o;if(e=o.slice(),r++,r>2e3)return console.warn("Too many iterations; abandoning this group."),t.split("done, "+r+" iterations."),[[[-1,-1,0],[-1,-1,0]]]}}static hash_vector(e){{const t=0,r=0,n=Math.abs(e[0]-t),a=Math.abs(e[1]-r),i=e[2];return this.Multiplier*(n+a+i)}}static adjust_proposed_fixes(e,t,r,n){return e.map((e=>{const a=e[0];if(100*-a<1)return null;const i=e[1].map((e=>e.toString().padStart(10,"0"))),o=e[2].map((e=>e.toString().padStart(10,"0"))),s=i<o?e[1]:e[2],u=i<o?e[2]:e[1],[[l,c],[g,m]]=s,[[h,p],[f,S]]=u,v=l-r-1,F=c-n-1,y=f-r-1,b=S-n-1;let C=!0;const A=JSON.stringify(t[F][v]);for(let e=F;e<=b;e++)for(let r=v;r<=y;r++)if(JSON.stringify(t[e][r])!==A){C=!1;break}return d(a,s,u,C)})).filter((e=>null!==e))}static find_suspicious_cells(e,t,r,n,a,i,o){return(0,u.watchdog)("wd0x8cabd6"),[]}}function m(e,t){const[r,n]=e,[a,i]=t;return r[0]!==a[0]?r[0]-a[0]:r[1]-a[1]}function h(e){let t=[];const r={};!function(e,t){for(const r of Object.keys(e))(0,u.watchdog)("wd0xa287cd"),t[r]=e[r].sort(m).map(((e,t,r)=>[e[0].map(((e,t,r)=>Number(e))),e[1].map(((e,t,r)=>Number(e)))]))}(e,r);const n={},a={};for(const t of Object.keys(e))(0,u.watchdog)("wd0xb02b87"),n[t]=r[t].map(((e,t,r)=>{const[n,a]=e;return n})),a[t]=r[t].map(((e,t,r)=>{const[n,a]=e;return a}));const i=function(e){const t={};for(const r of Object.keys(e)){let n=1e6,a=1e6,i=-1e6,o=-1e6;for(let t=0;t<e[r].length;t++){const s=e[r][t][0][0],u=e[r][t][1][0],l=e[r][t][0][1],c=e[r][t][1][1];u>i&&(i=u),s<n&&(n=s),c>o&&(o=c),l<a&&(a=l)}t[r]=[[n,a,0],[i,o,0]]}return t}(e),o=Object.keys(e);p(o,((e,t)=>i[e][0][0]-i[t][0][0]));const s=o.map(((e,t,r)=>i[e])),l=Object.keys(e);p(l,((e,t)=>i[e][0][1]-i[t][0][1]));const c=l.map(((e,t,r)=>i[e]));for(const d of Object.keys(e))for(let e=0;e<r[d].length;e++){(0,u.watchdog)("wd0xe37031");const g=v(d,r[d][e],0,o,l,n,a,i,s,c);t=t.concat(g)}return t=t.map(((e,t,r)=>f(e[1],e[2])<0?[e[0],e[2],e[1]]:[e[0],e[1],e[2]])),t=function(e){const t={};return e.filter((e=>!(t[e]=e in t)))}(t),t}function p(e,t){const r=e.map(((e,t)=>({item:e,index:t}))).sort(((e,r)=>t(e.item,r.item)||e.index-r.index)).map((({item:e})=>e));for(let t=0;t<e.length;t+=1)e[t]=r[t];return e}function f(e,t){for(let r=0;r<3;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return 0}function S(e,t,r,n){const a=e[0],i=e[1],o=t[0],s=t[1],u=[a-1,s,0],c=[o,i-1,0],d=[o+1,i,0],g=[a,s+1,0],m=[];let h=-1;if(h=(0,l.strict_binsearch)(n,u,f),-1!==h&&r[h][1]===i){const e=[r[h],n[h]];m.push(e)}if(h=(0,l.strict_binsearch)(n,c,f),-1!==h&&r[h][0]===a){const e=[r[h],n[h]];m.push(e)}if(h=(0,l.strict_binsearch)(r,d,f),-1!==h&&n[h][1]===s){const e=[r[h],n[h]];m.push(e)}if(h=(0,l.strict_binsearch)(r,g,f),-1!==h&&n[h][0]===o){const e=[r[h],n[h]];m.push(e)}return m}function v(e,t,r,n,a,i,o,s,u,c){const[d,m]=t;let h=[];const p=(0,l.binsearch)(u,t,((e,t)=>e[0][0]-t[0][0])),f=(0,l.binsearch)(c,t,((e,t)=>e[0][1]-t[0][1]));let v,F,y;p>f?(v=n,y=p,F=0):(v=a,y=f,F=1),y>0&&(y-=1);for(let r=y;r<v.length;r++){const n=v[r];if(n===e)continue;const a=s[n];if(0===F){if(m[0]+1<a[0][0])break}else if(m[1]+1<a[0][1])break;if(m[0]+1<a[0][0]||m[1]+1<a[0][1]||a[1][0]+1<d[0]||a[1][1]+1<d[1]);else{const r=S(d,m,i[n],o[n]);r.length>0&&(h=h.concat(r.map(((r,a,i)=>[g.fix_metric(parseFloat(e),t,parseFloat(n),r),t,r]))))}}return h}t.Colorize=g,g.reportingThreshold=35,g.suspiciousCellsReportingThreshold=85,g.formattingDiscount=50,g.formulasThreshold=1e4,g.valuesThreshold=1e4,g.Multiplier=1,g.distinguishedZeroHash="12345",t.find_all_proposed_fixes=h,t.numComparator=f},8540:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect_errors=void 0;const n=r(2595),a=r(7188),i=r(7666),o=r(968);function s(e,t){const[r,n]=e,[a,i]=t,o=[];for(let e=r;e<=a;e++)for(let t=n;t<=i;t++)o.push([e,t,0]);return o}t.detect_errors=function(e,t,r,u=1/0){t=t??a.Colorize.getFormattingDiscount(),r=r??a.Colorize.getReportingThreshold(),o.watchdog.arm(u);const l=e.worksheets.map((function(e){if((0,o.watchdog)("wd0x8d98cc"),0===e.formulas.length&&0===e.values.length)return{name:"",out:null};let u=e.usedRangeAddress;u=u.replace(/!(!+)/,"!");const l=new i.Timer("excelint"),[c,d,g,m]=a.Colorize.process_suspicious(u,e.formulas,e.values);(0,o.watchdog)("wd0x7919b4");const h=l.elapsedTime(),p=a.Colorize.adjust_proposed_fixes(m,e.styles,0,0),f=l.elapsedTime(),S=p.map((e=>{(0,o.watchdog)("wd0xfb8f16");const[n,i,s,u]=e;let l=-n;return u||(l*=(100-t)/100),100*l>=r?(0,a.tuple)(l,i,s,u):null})).filter((e=>null!==e)),v=(e,t)=>(t[0]-e[0]+1)*(t[1]-e[1]+1)*(t[2]-e[2]+1),F=l.elapsedTime(),y=S.map((t=>{(0,o.watchdog)("wd0x2375dd");const r=t[1][0][0]===t[2][0][0]?"vertical":"horizontal",a=[],i=[],s=[],u=[],l=[],c=[],d=[],g=[],m=[],h=t[3],p=[v(...t[1]),v(...t[2])];for(let r=0;r<2;r++){const o=t[r+1][0],h=o[1]-1,p=o[0]-1,f=e.formulas[h][p],S=n.ExcelUtils.numeric_constants(f);l.push(S),c.push(c.reduce(((e,t)=>e+t),0));const v=n.ExcelUtils.all_cell_dependencies(f,p+1,h+1,!1);d.push(v.length);const F=n.ExcelUtils.formulaToR1C1(f,p+1,h+1),y=n.ExcelUtils.column_index_to_name(p+1)+(h+1)+":",b=y+F;s.push(F),u.push(b),a.push(f),i.push(y+f),g.push((f.match(/\$/g)||[]).length),m.push(v)}const f=Math.abs(c[0]-c[1]),S=[];for(let e=0;e<m.length;e++)if(m[e].length>0){if("vertical"===r&&0===m[e][0][0]&&-1===m[e][0][1]){S.push("recurrent-formula");break}if("horizontal"===r&&-1===m[e][0][0]&&0===m[e][0][1]){S.push("recurrent-formula");break}}d[0]!==d[1]&&S.push("different-referent-count"),l[0].length!==l[1].length&&(1===Math.abs(l[0].length-l[1].length)?S.push("one-extra-constant"):S.push("number-of-constants-mismatch")),l[0].length>0&&l[1].length>0&&(d[0]+d[1]===0?S.push("both-constants"):d[0]*d[1]==0&&S.push("one-is-all-constants")),s[0]!==s[1]&&JSON.stringify(m[0].sort())!==JSON.stringify(m[1].sort())&&S.push("r1c1-mismatch"),g[0]!==g[1]&&S.push("absolute-ref-mismatch");for(let e=0;e<m.length;e++)if(m[e].length>0&&m[e][0][0]*m[e][0][1]!=0){S.push("off-axis-reference");break}return 0===S.length&&S.push("unclassified"),{bin:S,direction:r,sameFormat:h,rangeSizes:p,numbers:c,sameConstants:l[0]===l[1],numeric_difference:f,magnitude_numeric_difference:0===f?0:Math.log10(f),formulas:i,r1c1formulas:u,dependence_vectors:m}})),b=l.elapsedTime(),C=e.formulas.flat().filter((e=>e.length>0)).length,A=e.values.flat().filter((e=>e.length>0)).length,E=e.values[0].length,T=e.values.length,R=T*E,k=S.map((e=>e[0])).reduce(((e,t)=>e+t),0);let N=S.map((e=>((0,o.watchdog)("wd0xbcc23c"),e[0]>=r/100?s(e[1][0],e[1][1]).concat(s(e[2][0],e[2][1])):[])));const I=Array.from(new Set(N.flat(1).map((e=>JSON.stringify(e)))));N=I.map((e=>JSON.parse(e)));const O=l.elapsedTime(),P={suspiciousnessThreshold:r,formattingDiscount:t,proposedFixes:S,exampleFixes:y,suspiciousRanges:S.length,weightedSuspiciousRanges:k,suspiciousCells:N.length,elapsedTimeSeconds:O/1e3,proposedFixesTimeSeconds:h/1e3,adjustProposedFixesTimeSeconds:(f-h)/1e3,adjustFormatProposedFixesTimeSeconds:(F-f)/1e3,exampleFixesTimeSeconds:(b-F)/1e3,numCountingTimeSeconds:(O-b)/1e3,columns:E,rows:T,totalCells:R,numFormulaCells:C,numValueCells:A};return{name:e.sheetName,out:P}})).filter((e=>null!==e.out)),c={};for(const{name:e,out:t}of l)c[e]=t;return{workbookName:e.workbookName,worksheets:c}}},2595:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExcelUtils=void 0;const n=r(968);class a{static column_name_to_index(e){if(1===e.length)return e[0].charCodeAt(0)-"A".charCodeAt(0)+1;let t=0;const r=e.split("");for(const e of r)t*=26,t+=e.charCodeAt(0)-"A".charCodeAt(0)+1;return t}static column_index_to_name(e){let t="";for(;e>0;)t+=String.fromCharCode((e-1)%26+65),e=Math.floor((e-1)/26);return t.split("").reverse().join("")}static cell_dependency(e,t,r){(0,n.watchdog)("wd0x1a9bd3");{const t=a.cell_both_absolute.exec(e);if(t){const e=a.column_name_to_index(t[1]);let r=Number(t[2]);return t[2][0]>=" "&&(r=Number(t[2].charCodeAt(0)-16384)),[e,r,0]}}(0,n.watchdog)("wd0xa26bda");{const t=a.cell_col_absolute.exec(e);if(t){const e=a.column_name_to_index(t[1]);let n=Number(t[2]);return t[2][0]>=" "&&(n=Number(t[2].charCodeAt(0)-16384)),[e,n-r,0]}}(0,n.watchdog)("wd0x2a23e1");{const r=a.cell_row_absolute.exec(e);if(r){const e=a.column_name_to_index(r[1]);let n=Number(r[2]);return r[2][0]>=" "&&(n=Number(r[2].charCodeAt(0)-16384)),[e-t,n,0]}}(0,n.watchdog)("wd0x3ebc91");{const n=a.cell_both_relative.exec(e);if(n){const e=a.column_name_to_index(n[1]);let i=Number(n[2]);return n[2][0]>=" "&&(i=Number(n[2].charCodeAt(0)-16384)),[e-t,i-r,0]}}throw new Error("We should never get here.")}static toR1C1(e,t,r=!1){const n=a.cell_dependency(e,0,0),i=a.cell_dependency(t,0,0);let o="R",s="C";r&&(o="ρ",s="γ");const u=[];i.forEach(((e,t,r)=>{u.push(e-n[t])}));let l="";return a.cell_both_absolute.exec(t)?l=o+i[1]+s+i[0]:a.cell_col_absolute.exec(t)?(0===u[1]?l+=o:l+=o+"["+u[1]+"]",l+=s+i[0]):a.cell_row_absolute.exec(t)?(0===u[0]?l+=s:l+=s+"["+u[0]+"]",l=o+i[1]+l):(0===u[1]?l+=o:l+=o+"["+u[1]+"]",0===u[0]?l+=s:l+=s+"["+u[0]+"]"),l}static formulaToR1C1(e,t,r){let n=e.slice();const i=a.column_index_to_name(t)+r;let o;for(;o=a.range_pair.exec(n);)o&&(o[1],o[2],n=n.replace(o[0],a.toR1C1(i,o[1],!0)+":"+a.toR1C1(i,o[2],!0)));let s=null;for(;s=a.single_dep.exec(n);)if(s){const e=s[1];n=n.replace(s[0],a.toR1C1(i,e,!0))}return n=n.replace(/ρ/g,"R"),n=n.replace(/γ/g,"C"),n}static extract_sheet_cell(e){(0,n.watchdog)("wd0x012630");const t=a.sheet_plus_cell.exec(e);return t?[t[1],t[2],t[2]]:["","",""]}static all_cell_dependencies(e,t,r,i=!0){(0,n.watchdog)("wd0x2f82fe");let o=null;const s=[];if("string"!=typeof e)return null;for(e=(e=(e=(e=(e=(e=(e=e.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");o=a.range_pair.exec(e);)if((0,n.watchdog)("wd0x784918"),o){const n=o[1],i=a.cell_dependency(n,t,r),u=o[2],l=a.cell_dependency(u,t,r),c=l[0]-i[0]+1,d=l[1]-i[1]+1;for(let e=0;e<c;e++)for(let t=0;t<d;t++)s.push([e+i[0],t+i[1],0]);e=e.replace(o[0],"_")}let u=null;for(;u=a.single_dep.exec(e);)if((0,n.watchdog)("wd0x0fb232"),u){const n=u[1],i=a.cell_dependency(n,t,r);s.push(i),e=e.replace(u[0],"_")}if(i){let t=null;for(;t=a.number_dep.exec(e);)(0,n.watchdog)("wd0xd82ed1"),t&&(s.push([0,0,1]),e=e.replace(t[0],"_"))}return s}static numeric_constants(e){const t=[];if("string"!=typeof(e=e.slice()))return t;e=(e=(e=(e=(e=(e=(e=e.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");let r=null;for(;r=a.range_pair.exec(e);)r&&(e=e.replace(r[0],"_"));let n=null;for(;n=a.single_dep.exec(e);)n&&(e=e.replace(n[0],"_"));let i=null;for(;i=a.number_dep.exec(e);)i&&(t.push(parseFloat(i)),e=e.replace(i[0],"_"));return t}static baseVector(){return[0,0,0]}static all_dependencies(e,t,r,i,o){(0,n.watchdog)("wd0x961028");let s=[];if(e>=o.length||t>=o[0].length||e<0||t<0)return[];const u=o[e][t];return u.length>1&&"="===u[0]&&(s=a.all_cell_dependencies(u,i,r)),s}static generate_all_references(e,t,r){(0,n.watchdog)("wd0x6a6002");const i={};for(let o=0;o<e.length;o++){const s=e[o];for(let o=0;o<s.length;o++){(0,n.watchdog)("wd0x93d412");const u=s[o];if("="===u[0]){const o=a.all_cell_dependencies(u,0,0);for(const a of o)if((0,n.watchdog)("wd0x8a466e"),0===a[0]&&0===a[1]&&0!==a[2]);else{const n=a[0]-t-1,o=a[1]-r-1;{let t=!1;if(o>=e.length||n>=e[0].length||n<0||o<0)t=!0;else{const r=e[o][n];void 0!==r&&"="!==r[0]&&(t=!0)}t&&(i[a.join(",")]=!0)}}}}}return i}}t.ExcelUtils=a,a.general_re="\\$?[A-Z][A-Z]?\\$?[\\d\\u2000-\\u6000]+",a.sheet_re="[^\\!]+",a.sheet_plus_cell=new RegExp("("+a.sheet_re+")\\!("+a.general_re+")"),a.sheet_plus_range=new RegExp("("+a.sheet_re+")\\!("+a.general_re+"):("+a.general_re+")"),a.single_dep=new RegExp("("+a.general_re+")"),a.range_pair=new RegExp("("+a.general_re+"):("+a.general_re+")","g"),a.number_dep=new RegExp("([0-9]+\\.?[0-9]*)"),a.cell_both_relative=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),a.cell_col_absolute=new RegExp("\\$([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),a.cell_row_absolute=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),a.cell_both_absolute=new RegExp("\\$([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),a.formulas_with_numbers=new RegExp("/ATAN2|BIN2DEC|BIN2HEX|BIN2OCT|DAYS360|DEC2BIN|DEC2HEX|DEC2OCT|HEX2BIN|HEX2DEC|HEX2OCT|IMLOG2|IMLOG10|LOG10|OCT2BIN|OCT2DEC|OCT2HEX|SUNX2MY2|SUMX2PY2|SUMXMY2|T.DIST.2T|T.INV.2T/","g"),a.formulas_with_quoted_sheetnames_1=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+","g"),a.formulas_with_quoted_sheetnames_2=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),a.formulas_with_unquoted_sheetnames_1=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+","g"),a.formulas_with_unquoted_sheetnames_2=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),a.formulas_with_structured_references=new RegExp("\\[([^\\]])*\\]","g"),a.originalSheetSuffix="_EL"},859:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect_errors=void 0;var n=r(8540);Object.defineProperty(t,"detect_errors",{enumerable:!0,get:function(){return n.detect_errors}})},172:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stencil=t.InfoGain=void 0,t.InfoGain=class{static normalized_entropy(e){const t=e.reduce(((e,t)=>e+t),0);let r=0;for(let n=0;n<e.length;n++){const a=e[n]/t;0!==a&&(r-=a*Math.log2(a))}return r/Math.log2(t)}};class r{static initialize(){if(!r.initialized){if(r.stencil_right=r.stencil.filter((([e,t])=>e<=0)),r.stencil_left=r.stencil.filter((([e,t])=>e>=0)),r.stencil_top=r.stencil.filter((([e,t])=>t>=0)),r.stencil_bottom=r.stencil.filter((([e,t])=>t<=0)),r.stencil_topleft=r.stencil_top.filter((([e,t])=>e>=0)),r.stencil_topright=r.stencil_top.filter((([e,t])=>e<=0)),r.stencil_bottomleft=r.stencil_bottom.filter((([e,t])=>e>=0)),r.stencil_bottomright=r.stencil_bottom.filter((([e,t])=>e<=0)),r.reflectStencils){let e;e=r.stencil.filter((([e,t])=>e>0)).map((([e,t])=>[-e,t])),r.stencil_right=r.stencil_right.concat(e),e=r.stencil.filter((([e,t])=>e<0)).map((([e,t])=>[-e,t])),r.stencil_left=r.stencil_left.concat(e),e=r.stencil.filter((([e,t])=>t<0)).map((([e,t])=>[e,-t])),r.stencil_top=r.stencil_top.concat(e),e=r.stencil.filter((([e,t])=>t>0)).map((([e,t])=>[e,-t])),r.stencil_bottom=r.stencil_bottom.concat(e),e=r.stencil_top.filter((([e,t])=>e<0)).map((([e,t])=>[-e,t])),r.stencil_topleft=r.stencil_topleft.concat(e),e=r.stencil_left.filter((([e,t])=>t<0)).map((([e,t])=>[e,-t])),r.stencil_topleft=r.stencil_topleft.concat(e),r.stencil_topleft.splice(r.stencil_topleft.findIndex((e=>JSON.stringify(e)===JSON.stringify([1,1]))),1),e=r.stencil_top.filter((([e,t])=>e>0)).map((([e,t])=>[-e,t])),r.stencil_topright=r.stencil_topright.concat(e),e=r.stencil_right.filter((([e,t])=>t<0)).map((([e,t])=>[e,-t])),r.stencil_topright=r.stencil_topright.concat(e),r.stencil_topright.splice(r.stencil_topright.findIndex((e=>JSON.stringify(e)===JSON.stringify([-1,1]))),1),e=r.stencil_bottom.map((([e,t])=>[-e,t])).filter((([e,t])=>e>0)),r.stencil_bottomleft=r.stencil_bottomleft.concat(e),e=r.stencil_left.map((([e,t])=>[e,-t])).filter((([e,t])=>t<0)),r.stencil_bottomleft=r.stencil_bottomleft.concat(e),r.stencil_bottomleft.splice(r.stencil_bottomleft.findIndex((e=>JSON.stringify(e)===JSON.stringify([1,-1]))),1),e=r.stencil_bottom.map((([e,t])=>[-e,t])).filter((([e,t])=>e<0)),r.stencil_bottomright=r.stencil_bottomright.concat(e),e=r.stencil_right.map((([e,t])=>[e,-t])).filter((([e,t])=>t<0)),r.stencil_bottomright=r.stencil_bottomright.concat(e),r.stencil_bottomright.splice(r.stencil_bottomright.findIndex((e=>JSON.stringify(e)===JSON.stringify([-1,-1]))),1)}r.initialized=!0}}static apply_stencil(e,t,n,a,i,o){if(e.length!==r.stencil.length)throw Error("Length mismatched");let s=i;for(let r=0;r<e.length;r++){const[i,u]=e[r];s=o(s,t[n+u][a+i])}return s}static stencil_computation(e,t,n){r.initialize();const a=e.length,i=e[0].length,o=Array(a).fill(0).map((()=>Array(i).fill(0)));for(let s=1;s<i-1;s++)for(let i=1;i<a-1;i++)o[i][s]=r.apply_stencil(r.stencil,e,s,i,n,t);for(let s=1;s<i-1;s++)o[0][s]=r.apply_stencil(r.stencil_top,e,0,s,n,t),o[a-1][s]=r.apply_stencil(r.stencil_bottom,e,a-1,s,n,t);for(let s=1;s<a-1;s++)o[s][0]=r.apply_stencil(r.stencil_left,e,s,0,n,t),o[s][i-1]=r.apply_stencil(r.stencil_right,e,s,i-1,n,t);return o[0][0]=r.apply_stencil(r.stencil_topleft,e,0,0,n,t),o[0][i-1]=r.apply_stencil(r.stencil_topright,e,0,i-1,n,t),o[a-1][0]=r.apply_stencil(r.stencil_bottomleft,e,a-1,0,n,t),o[a-1][i-1]=r.apply_stencil(r.stencil_bottomright,e,a-1,i-1,n,t),o}}t.Stencil=r,r.reflectStencils=!0,r.ninePointStencil=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]],r.stencil=r.ninePointStencil,r.initialized=!1},2532:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSONclone=void 0;class r{static clone(e){if(e){if(Array.isArray(e))return e.slice();if(e.constructor===Object){const t={};for(const n of Object.keys(e))t[n]=r.clone(e[n]);return t}return e}return null}}t.JSONclone=r},4809:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleUtils=void 0;class r{static is_adjacent(e,t){const[[r,n,a],[i,o,s]]=e,[[u,l,c],[d,g,m]]=t;return!(r-d>1||u-i>1||n-g>1||l-o>1)}static bounding_box(e,t){const[[r,n,a],[i,o,s]]=e,[[u,l,c],[d,g,m]]=t;return[[Math.min(r,u),Math.min(n,l),0],[Math.max(i,d),Math.max(o,g),0]]}static area(e){const[[t,r,n],[a,i,o]]=e;return(a-t+1)*(i-r+1)}static diagonal(e){const[[t,r,n],[a,i,o]]=e,s=a-t+1,u=i-r+1;return Math.sqrt(s*s+u*u)}static overlap(e,t){const[[r,n,a],[i,o,s]]=e,[[u,l,c],[d,g,m]]=t;let h=0,p=0;return h=i>d?d-r+1:i-u+1,p=o>g?g-n+1:o-l+1,h*p}static is_mergeable(e,t){return r.is_adjacent(e,t)&&r.area(e)+r.area(t)-r.overlap(e,t)===r.area(r.bounding_box(e,t))}}t.RectangleUtils=r},7666:function(e,t){"use strict";function r(){return"undefined"!=typeof process?{now:()=>{const[e,t]=process.hrtime();return(1e9*e+t)/1e6}}:"undefined"!=typeof performance?performance:Date}Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=t.createPerf=void 0,t.createPerf=r,t.Timer=class{start(){this.startTimeMS=this.perf.now(),this.splitTimeMS=this.startTimeMS}split(e){const t=this.perf.now(),r=t-this.splitTimeMS;console.warn("timer: "+this.name+" @ "+e+" : = "+this.roundMe(r)+" (total = "+this.roundMe(t-this.startTimeMS)+")"),this.splitTimeMS=t}elapsedTime(){return this.perf.now()-this.startTimeMS}roundMe(e){return Math.round(100*e)/100}constructor(e){this.perf=r(),this.name=e,this.start()}}},968:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.watchdog=void 0;const n=(0,r(7666).createPerf)();t.watchdog=function(){let e=1/0;const t=(t="")=>{if(n.now()>e)throw new Error(`Time limit exceeded with message: ${t}`)};return t.arm=t=>{e=n.now()+t},t}()},9178:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LimitedSizeHotMap=void 0;class r extends Map{set(e,t){if(!this.query(e)&&this.size>=this.maxSize){const e=this.keys().next().value;this.delete(e)}return super.set(e,t)}query(e){if(this.has(e)){const t=this.get(e);return this.delete(e),this.set(e,t),!0}return!1}constructor(e){if(super(),this.maxSize=e,e<1)throw new Error("maxSize must be greater than 0")}}t.LimitedSizeHotMap=r},2360:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.anonymizeFormulaString=t.anonymizeMagnitude=t.kindAnonymizers=t.anonymize=void 0;const n=r(5074);function a(e){return e}function i(e,r){if("string"==typeof r&&null!=o[r])return e;const n=function(e){if("object"==typeof e&&null!==e){const t=e.kind;if("string"==typeof t)return t}}(e);let a=void 0!==n?t.kindAnonymizers[n]:void 0;return void 0===a&&(a=s[function(e){const t=typeof e;if("object"===t){if(null===e)return"null";if(Array.isArray(e))return"Array"}return t}(e)]),void 0!==a?a(e,r):"<unexpected>"}t.anonymize=function(e){try{return String(JSON.stringify(i(e,void 0)))}catch(e){if(null==e||"object"!=typeof e)return`<error: ${String(JSON.stringify(e))}>`;const t=String(e.name),r=String(e.message);return r.indexOf(t)>=0?`<error ${r}>`:`<error ${t}: ${r}>`}};const o={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},s={boolean:a,symbol:function(e){return"symbol"!=typeof e?"<unexpected>":`<symbol ${String(e)}>`},undefined:a,null:a,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";const t=e.name;return"string"==typeof t&&t.length>0?`<function ${t}>`:"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";const t={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=i(e[r],r));return t},Array:function(e){return"object"==typeof e&&Array.isArray(e)?e.map(i):"<unexpected>"}};t.kindAnonymizers=Object.create(null),t.anonymizeMagnitude=function(e){const t=Math.abs(e);return 0===t?-1e4:Math.floor((0,n.mathLog2)(t))};const u=new RegExp("[^=\\[\\]\\.\\\\\\/%@#\\-_\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$¢£¤¥₠₡₢₣₤₥₦₧₨₩₪₫€₭₮₯₰₱₲₳₴₵₶₷₸₹\\sꃂd]","g"),l=/[0-9]/g,c=/d/g;t.anonymizeFormulaString=function(e){return e.toLowerCase().replace(c,"w").replace(l,"d").replace(u,"w")}},2994:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.broadcastArray2D=t.broadcastArray=t.sparseArray2DTo1D=t.transposeSparseArray2D=t.transposeArray2D=t.colArray2D=t.rowArray2D=t.singletonArray2D=t.constantArray2D=t.constantArray=t.array2DToJaggedArray=t.jaggedArray=t.array2DForall2=t.array2DForall=t.NonstrictSparseArray2D=t.NonstrictArray2D=t.StrictSparseArray2D=t.StrictArray2D=void 0;const n=r(9001),a=r(4563);class i{get(e,t){return(0,n.assertIndex)("calc.common.StrictArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]}strict(){return this}map(e){return new s(this.rows,this.cols,((t,r)=>e(this.elements[t][r])))}constructor(e,t,r){(0,n.assertNatural)("calc.common.StrictArray2D",e),(0,n.assertNatural)("calc.common.StrictArray2D",t);const a=r.length;a<e&&(0,n.assertFalse)(`calc.common.StrictArray2D: expected elements.length >= ${e}; given ${a}`);for(let i=0;i<a;i+=1){const a=r[i].length;a<t&&(0,n.assertFalse)(`calc.common.StrictArray2D: expected elements[${i}].length >= ${e}; given ${a}`)}this.rows=e,this.cols=t,this.elements=r}}t.StrictArray2D=i;class o{get(e,t){return(0,n.assertIndex)("calc.common.StrictSparseArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement}getSparse(){return this.sparseElement}strict(){return this}map(e){return new u(this.rows,this.cols,this.denseRows,this.denseCols,((t,r)=>e(this.denseElements[t][r])),(()=>e(this.sparseElement)))}constructor(e,t,r,a,i,o){(0,n.assertNatural)("calc.common.StrictSparseArray2D",e),(0,n.assertNatural)("calc.common.StrictSparseArray2D",t),(0,n.assertIndex)("calc.common.StrictSparseArray2D",r,e+1),(0,n.assertIndex)("calc.common.StrictSparseArray2D",a,t+1);const s=i.length;s<r&&(0,n.assertFalse)(`calc.common.StrictSparseArray2D: expected elements.length >= ${r}; given ${s}`);for(let e=0;e<s;e+=1){const t=i[e].length;t<a&&(0,n.assertFalse)(`calc.common.StrictSparseArray2D: expected elements[${e}].length >= ${a}; given ${t}`)}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=a,this.denseElements=i,this.sparseElement=o}}t.StrictSparseArray2D=o;class s{get(e,t){return(0,n.assertIndex)("calc.common.NonstrictArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)}strict(){const e=l(this.rows,this.cols,this.func);return new i(this.rows,this.cols,e)}map(e){return new s(this.rows,this.cols,((t,r)=>e(this.func(t,r))))}constructor(e,t,r){(0,n.assertNatural)("calc.common.NonstrictArray2D",e),(0,n.assertNatural)("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}}t.NonstrictArray2D=s;class u{get(e,t){return(0,n.assertIndex)("calc.common.NonstrictSparseArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()}getSparse(){return this.sparseFunc()}strict(){const e=l(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new o(this.rows,this.cols,this.denseRows,this.denseCols,e,t)}map(e){return new u(this.rows,this.cols,this.denseRows,this.denseCols,((t,r)=>e(this.denseFunc(t,r))),(()=>e(this.sparseFunc())))}constructor(e,t,r,a,i,o){(0,n.assertNatural)("calc.common.NonstrictSparseArray2D",e),(0,n.assertNatural)("calc.common.NonstrictSparseArray2D",t),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D",r,e+1),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D",a,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=a,this.denseFunc=i,this.sparseFunc=o}}function l(e,t,r){const n=[];for(let a=0;a<e;a+=1){const e=[];for(let n=0;n<t;n+=1)e[n]=r(a,n);n[a]=e}return n}function c(e,t,r){const n=[],a=[];for(let e=0;e<t;e+=1)a[e]=r;for(let t=0;t<e;t+=1)n[t]=a;return n}function d(e,t,r){return new s(e,t,((e,t)=>r))}t.NonstrictSparseArray2D=u,t.array2DForall=function(e,t){for(let r=0;r<t.rows;r+=1)for(let n=0;n<t.cols;n+=1)if(!e(t.get(r,n)))return!1;return!0},t.array2DForall2=function(e,t,r){const n=(0,a.fastMin)(t.rows,r.rows),i=(0,a.fastMin)(t.cols,r.cols);for(let a=0;a<n;a+=1)for(let n=0;n<i;n+=1)if(!e(t.get(a,n),r.get(a,n)))return!1;return!0},t.jaggedArray=l,t.array2DToJaggedArray=function(e){return l(e.rows,e.cols,e.get.bind(e))},t.constantArray=c,t.constantArray2D=d,t.singletonArray2D=function(e){return d(1,1,e)},t.rowArray2D=function(e){return new s(1,e.length,((t,r)=>e[r]))},t.colArray2D=function(e){return new s(e.length,1,((t,r)=>e[t]))},t.transposeArray2D=function(e){return new s(e.cols,e.rows,((t,r)=>e.get(r,t)))},t.transposeSparseArray2D=function(e){return new u(e.cols,e.rows,e.denseCols,e.denseRows,((t,r)=>e.get(r,t)),(()=>e.getSparse()))},t.sparseArray2DTo1D=function(e,t){const r=e.getSparse.bind(e);return(0,n.assertTrue)("calc.common.sparseArray2DTo1D",t?0===e.cols||e.rows>0:0===e.rows||e.cols>0),t?{length:e.cols,denseLength:e.denseCols,get:t=>e.get(0,t),getSparse:r}:{length:e.rows,denseLength:e.denseRows,get:t=>e.get(t,0),getSparse:r}},t.broadcastArray=function(e,t,r,n,a,i){if(e===r&&t===n)return a;if(1===e&&1===t)return c(r,n,void 0===a[0]?i:a[0][0]);const o=[];let s;s=1===e?(e,r)=>r<t?a[0][r]:i:1===t?(t,r)=>t<e?a[t][0]:i:(r,n)=>r<e&&n<t?a[r][n]:i;for(let e=0;e<r;e+=1){o.push([]);for(let t=0;t<n;t+=1)o[e][t]=s(e,t)}return o},t.broadcastArray2D=function(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?d(e,t,r.get(0,0)):1===r.rows?new s(e,t,((e,t)=>t<r.cols?r.get(0,t):n)):1===r.cols?new s(e,t,((e,t)=>e<r.rows?r.get(e,0):n)):new s(e,t,((e,t)=>e<r.rows&&t<r.cols?r.get(e,t):n))}},9001:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertIndex=t.assertPositiveInteger=t.assertNatural=t.assertInteger=t.assertTrue=t.assertFalse=t.assertNever=t.ulsLogger=void 0;const n=r(4068),a=r(5074),i=r(2360);function o(e,t){return function(r,n,a,i){if(e(r,n,a,i),!a)throw new Error(`${t} ${r} ${n} ${i}`)}}function s(e){return{shipAssertTag:o(e.shipAssertTag.bind(e),"shipAssertTag"),assertTag:o(e.assertTag.bind(e),"assertTag"),traceTag:e.traceTag.bind(e),debugTraceTag:e.debugTraceTag.bind(e),dnmTraceTag:e.dnmTraceTag.bind(e)}}function u(e){return(...t)=>{try{return e(...t)}catch{}}}class l{createBufferingCallback(e){return(...t)=>{this.callBuffer.length<this.callBufferCapacity&&this.callBuffer.push({method:e,args:t})}}invokeBufferedCalls(){if(0===this.callBuffer.length)return;const e=this.callBuffer;this.callBuffer=[];const r=`calc.common.DefaultLogger.invokeBufferedCalls: ${e.length} calls before initLogger`;t.ulsLogger.ULS.traceTag(579736781,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,r);for(const r of e)t.ulsLogger.noThrowLogger[r.method](...r.args)}constructor(){this.callBufferCapacity=100,this.callBuffer=[],this.shipAssertTag=this.createBufferingCallback("shipAssertTag"),this.assertTag=this.createBufferingCallback("assertTag"),this.traceTag=this.createBufferingCallback("traceTag"),this.dnmTraceTag=this.createBufferingCallback("dnmTraceTag"),this.debugTraceTag=this.createBufferingCallback("debugTraceTag")}}function c(e){return t.ulsLogger.ULS.assertTag(595980873,n.LogCategory.msoulscat_ES_EWAJS,!1,e)}t.ulsLogger=new class{setLogger(e){const t=this.logger;this.logger=e,this.ULS=s(e),this.noThrowLogger=function(e){return{shipAssertTag:u(e.shipAssertTag.bind(e)),assertTag:u(e.assertTag.bind(e)),traceTag:u(e.traceTag.bind(e)),debugTraceTag:u(e.debugTraceTag.bind(e)),dnmTraceTag:u(e.dnmTraceTag.bind(e))}}(e),t instanceof l&&t.invokeBufferedCalls()}constructor(){this.logger=new l,this.ULS=s(this.logger),this.noThrowLogger=this.logger}},t.assertNever=function(e,r){const a=`${e}: code should be unreachable because a value has type 'never'; given ${(0,i.anonymize)(r)}`;return t.ulsLogger.ULS.assertTag(595980872,n.LogCategory.msoulscat_ES_EWAJS,!1,a)},t.assertFalse=c,t.assertTrue=function(e,t){t||c(`${e}: expected condition to be true`)},t.assertInteger=function(e,t){(0,a.isInteger)(t)||c(`${e}: expected integer; given ${(0,i.anonymize)(t)}`)},t.assertNatural=function(e,t){(!(0,a.isInteger)(t)||t<0)&&c(`${e}: expected natural number; given ${(0,i.anonymize)(t)}`)},t.assertPositiveInteger=function(e,t){(!(0,a.isInteger)(t)||t<=0)&&c(`${e}: expected positive integer; given ${(0,i.anonymize)(t)}`)},t.assertIndex=function(e,t,r){(!(0,a.isInteger)(t)||t<0||t>=r)&&c(`${e}: expected natural number less than ${(0,i.anonymize)(r)}; given ${(0,i.anonymize)(t)}`)},t.assertPositiveLength=function(e,t,r){(!(0,a.isInteger)(t)||t<=0||t>r)&&c(`${e}: expected positive integer at most ${(0,i.anonymize)(r)}; given ${(0,i.anonymize)(t)}`)}},5506:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5788:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncLoop=t.asyncLoopFactory=t.asyncLoopDelayPromiseImpl=void 0;const n=r(4563),a=r(8827),i=r(2376);function o(e){return t=>new Promise((r=>e.setTimeout(r,t,void 0)))}function s(e){return(t,r)=>{const i=r?.timeThreshold??10,o=r?.costThreshold??1,s=r?.macrotaskDelay??0,u={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},[l,[c,d]]=(0,a.newPromise)();let g=!0,m=e(s),h=(0,n.now)();return function r(){if(!g||!function(){try{let e=0;for(;e<o;){u.iterations+=1;const r=t();if(void 0===r)return!1;e+=r}return!0}catch(e){return d(e),!1}}())return c();const a=(0,n.now)();a-h<i?(Promise.resolve().then(r),u.microtaskContinues+=1):(m.then((()=>{m=e(s),h=(0,n.now)(),u.macrotaskTotalDelay+=h-a,r()})),u.macrotaskContinues+=1)}(),{promise:l,stop:function(){g=!1},stats:u}}}t.asyncLoopDelayPromiseImpl=o,t.asyncLoopFactory=s,t.asyncLoop=s(o(i.defaultSetTimeoutInterface))},959:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointTilde=t.codePointRightCurlyBracket=t.codePointPipe=t.codePointLeftCurlyBracket=t.codePointBacktick=t.codePointUnderscore=t.codePointCircumflexAccent=t.codePointRightSquareBracket=t.codePointBackslash=t.codePointLeftSquareBracket=t.codePointAtSign=t.codePointQuestionMark=t.codePointGreaterThanSign=t.codePointEqualsSign=t.codePointLessThanSign=t.codePointSemicolon=t.codePointColon=t.codePointDigitNine=t.codePointDigitEight=t.codePointDigitSeven=t.codePointDigitSix=t.codePointDigitFive=t.codePointDigitFour=t.codePointDigitThree=t.codePointDigitTwo=t.codePointDigitOne=t.codePointDigitZero=t.codePointSlash=t.codePointFullStop=t.codePointMinusSign=t.codePointComma=t.codePointPlusSign=t.codePointAsterisk=t.codePointRightParen=t.codePointLeftParen=t.codePointSingleQuote=t.codePointAmpersand=t.codePointPercentSign=t.codePointDollarSign=t.codePointHash=t.codePointDoubleQuote=t.codePointExclamationMark=t.codePointSpace=t.codePointCR=t.codePointLF=t.codePointTab=void 0,t.codePointThaiDigitNine=t.codePointThaiDigitZero=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=void 0,t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointRightSingleQuotationMark=t.codePointLeftSingleQuotationMark=t.codePointEuroSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitNine=t.codePointFullwidthDigitZero=void 0,t.codePointTab=9,t.codePointLF=10,t.codePointCR=13,t.codePointSpace=32,t.codePointExclamationMark=33,t.codePointDoubleQuote=34,t.codePointHash=35,t.codePointDollarSign=36,t.codePointPercentSign=37,t.codePointAmpersand=38,t.codePointSingleQuote=39,t.codePointLeftParen=40,t.codePointRightParen=41,t.codePointAsterisk=42,t.codePointPlusSign=43,t.codePointComma=44,t.codePointMinusSign=45,t.codePointFullStop=46,t.codePointSlash=47,t.codePointDigitZero=48,t.codePointDigitOne=49,t.codePointDigitTwo=50,t.codePointDigitThree=51,t.codePointDigitFour=52,t.codePointDigitFive=53,t.codePointDigitSix=54,t.codePointDigitSeven=55,t.codePointDigitEight=56,t.codePointDigitNine=57,t.codePointColon=58,t.codePointSemicolon=59,t.codePointLessThanSign=60,t.codePointEqualsSign=61,t.codePointGreaterThanSign=62,t.codePointQuestionMark=63,t.codePointAtSign=64,t.codePointLeftSquareBracket=91,t.codePointBackslash=92,t.codePointRightSquareBracket=93,t.codePointCircumflexAccent=94,t.codePointUnderscore=95,t.codePointBacktick=96,t.codePointLeftCurlyBracket=123,t.codePointPipe=124,t.codePointRightCurlyBracket=125,t.codePointTilde=126,t.codePointCapitalA=65,t.codePointCapitalB=66,t.codePointCapitalC=67,t.codePointCapitalD=68,t.codePointCapitalE=69,t.codePointCapitalF=70,t.codePointCapitalG=71,t.codePointCapitalH=72,t.codePointCapitalI=73,t.codePointCapitalJ=74,t.codePointCapitalK=75,t.codePointCapitalL=76,t.codePointCapitalM=77,t.codePointCapitalN=78,t.codePointCapitalO=79,t.codePointCapitalP=80,t.codePointCapitalQ=81,t.codePointCapitalR=82,t.codePointCapitalS=83,t.codePointCapitalT=84,t.codePointCapitalU=85,t.codePointCapitalV=86,t.codePointCapitalW=87,t.codePointCapitalX=88,t.codePointCapitalY=89,t.codePointCapitalZ=90,t.codePointSmallA=97,t.codePointSmallB=98,t.codePointSmallC=99,t.codePointSmallD=100,t.codePointSmallE=101,t.codePointSmallF=102,t.codePointSmallG=103,t.codePointSmallH=104,t.codePointSmallI=105,t.codePointSmallJ=106,t.codePointSmallK=107,t.codePointSmallL=108,t.codePointSmallM=109,t.codePointSmallN=110,t.codePointSmallO=111,t.codePointSmallP=112,t.codePointSmallQ=113,t.codePointSmallR=114,t.codePointSmallS=115,t.codePointSmallT=116,t.codePointSmallU=117,t.codePointSmallV=118,t.codePointSmallW=119,t.codePointSmallX=120,t.codePointSmallY=121,t.codePointSmallZ=122,t.codePointThaiDigitZero=3664,t.codePointThaiDigitNine=3673,t.codePointFullwidthDigitZero=65296,t.codePointFullwidthDigitNine=65305,t.codePointFullwidthLatinCapitalA=65313,t.codePointFullwidthLatinCapitalZ=65338,t.codePointFullwidthLatinSmallA=65345,t.codePointFullwidthLatinSmallZ=65370,t.codePointEuroSign=8364,t.codePointLeftSingleQuotationMark=8216,t.codePointRightSingleQuotationMark=8217,t.codePointInvertedExclamationMark=161,t.codePointInvertedQuestionMark=191},7108:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combinations=void 0,t.combinations=function e(...t){if(0===t.length)return[[]];const[r,...n]=t,a=e(...n),i=[];for(const e of r)for(const t of a)i.push([e,...t]);return i}},6646:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initCalcThread=t.initCalcInThread=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=t.isCalcInit=t.maxRetriesForLoadingScript=t.initCalcCalled=void 0;const n=r(3345),a=r(4068),i=n.__importStar(r(4067)),o=r(9001),s=r(4729),u=r(3472),l=r(3056),c=r(8827),d=r(9745);t.initCalcCalled=new c.ResolvablePromise,t.maxRetriesForLoadingScript=9;const g=/^(https)|(http)|(file):\/\//;let m,h=!1;function p(){if(null==m)throw new Error("initCalc was not passed calcAbsUrl");return m}function f(e,r,n,c){if(h){const e="calc.config.initCalc: Calc is already initialized";return void o.ulsLogger.ULS.traceTag(595910878,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,e)}if(o.ulsLogger.setLogger(e),(0,s.initStopwatch)(e),(0,u.initFeatureConfiguration)(r),null!=n&&!g.test(n)){const e=`calc.config.initCalc: calcAbsUrl is not absolute: ${n}`;o.ulsLogger.ULS.traceTag(595910879,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,e)}i.setConfig(c??{importScriptsMaxRetries:t.maxRetriesForLoadingScript,onWorkerError(e){const t={error:(0,l.messageFromError)(e),innerError:e.info.error?(0,l.messageFromError)(e.info.error):void 0},r=`calc.onWorkerError: ${JSON.stringify(t)}`;o.ulsLogger.ULS.traceTag(593335298,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,r)},onCreateWorker(e){const t=`calc.onCreateWorker: ${JSON.stringify(e)}`;o.ulsLogger.ULS.traceTag(593335299,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,t)}}),m=n,h=!0;const p=`calc.config.initCalc: package version ${d.packageVersion} (production) initialized`;o.ulsLogger.ULS.traceTag(594642132,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,p),t.initCalcCalled.resolve(void 0)}t.isCalcInit=function(){return h},t.getCalcAbsUrl=function(){return m},t.getCalcAbsUrlOrThrow=p,t.initCalc=function(e,t,r){f(e,t,r,void 0)},t.initCalcInThread=async function(e,t,r,n){f(function(e){const t=e=>`[${(new Date).toISOString()}] ${e}`;return{shipAssertTag(r,n,a,i){e.shipAssertTag(r,n,a,t(i))},assertTag(r,n,a,i){e.assertTag(r,n,a,t(i))},traceTag(r,n,a,i){e.traceTag(r,n,a,t(i))},debugTraceTag(r,n,a,i){e.debugTraceTag(r,n,a,t(i))},dnmTraceTag(r,n,a,i){e.dnmTraceTag(r,n,a,t(i))}}}((await i.Endpoint.createOutside(e)).post),(e=>!0===t[e]),r,n)},t.initCalcThread=async function(e){const t=p(),r=new MessageChannel,n={port:r.port1,options:{id:"WorkerThreadLogger"}},a={port:r.port2,options:{id:"WorkerThreadLogger"}};try{const[r]=await Promise.all([i.Endpoint.createInside(n,(()=>o.ulsLogger.noThrowLogger)),e.call.initCalcThreadInside.transfer([a.port],a,(0,u.getFeatures)(),t)]);return r}catch(e){throw n.port.close(),e}}},4563:function(e,t){"use strict";function r(){const e=Object.create(null);return e.___=void 0,delete e.___,e}function n(e){return Object.keys(e).map((e=>Number(e))).filter((e=>!isNaN(e)))}function a(e,t){for(const r of t)e.push(r);return e}function i(e){return null!=e}Object.defineProperty(t,"__esModule",{value:!0}),t.mapFromArrayOfPairs=t.singleton=t.now=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0,t.makeNewtypeIso=function(e,t){return{wrap:e,unwrap:t}},t.staticAssertExtends=function(){},t.staticAssertSame=function(){},t.staticAssertIs=function(){return e=>e},t.staticAssertIsOptional=e=>e,t.identity=function(e){return e},t.makeStringMap=r,t.cloneStringMap=function(e){const t=r();for(const r in e)t[r]=e[r];return t},t.numEnumArray=n,t.numEnumMap=function(e,t){const r={};for(const a of n(e))r[a]=t(a);return r},t.strEnumArray=function(e){return Object.keys(e).map((e=>e)).map((t=>e[t])).sort()},t.safePush=a,t.safeConcat=function(e,t){const r=[];a(r,e);for(const e of t)a(r,e);return r},t.isDefined=i,t.isNone=function(e){return null==e},t.filterOutNones=function(e){return e.filter(i)},t.pair=function(e,t){return[e,t]},t.fastMin=function(e,t){return e<t?e:t},t.fastMax=function(e,t){return e<t?t:e},t.fastAbs=function(e){return e<0?-e:e},t.makeStringCompareCI=function(e){const t={sensitivity:"accent"};try{const r=new Intl.Collator(function(e){const t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),t);return r.compare.bind(r)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}},t.typedInstanceCreator=function(){return e=>e},t.now="undefined"!=typeof performance&&null!=performance.now?()=>performance.now():()=>Date.now(),t.singleton=function(e){class t{static instance(){return void 0===t.value&&(t.value=e()),t.value}instance(){return t.instance()}}return t.value=void 0,t},t.mapFromArrayOfPairs=function(e){return e.reduce(((e,[t,r])=>(e[t]=r,e)),{})}},2365:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;const n=r(9310);function a(e){if(0===e)return 0;let t=e;return t=(t|t>>>1)>>>0,t=(t|t>>>2)>>>0,t=(t|t>>>4)>>>0,t=(t|t>>>8)>>>0,t=(t|t>>>16)>>>0,t+=1,t/2}t.floorToPowerOf2=a;class i{static create(e){return new i(e,[],[])}setValue(e,t){return this.setValues([[e,t]])}remove(e){return void 0===this.getKeyIndex(e)?this:this.filter((t=>t!==e))}getOrSetValue(e,t){const r=this.getKeyIndex(e);if(void 0===r){const r=t();return[this.setValue(e,r),r]}return[this,this.values[r]]}filter(e){const t=[];for(let r=0;r<this.keys.length;r+=1){const n=this.keys[r],a=this.values[r];e(n,a)&&t.push([n,a])}return t.length===this.getCount()?this:this.ofSequence(t)}getCount(){return this.keys.length}getValue(e){const t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]}getEntry(e){const t=this.getKeyIndex(e);if(void 0!==t)return(0,n.entry)(this.keys[t],this.values[t])}contains(e){return void 0!==this.getKeyIndex(e)}forEach(e){for(let t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return!1;return!0}setValues(e){const t=this.keys.map(((e,t)=>[e,this.values[t],t])),r=t.length;e.forEach((([e,n],a)=>t.push([e,n,a+r]))),t.sort((([e,,t],[r,,n])=>{const a=this.keyCompare(e,r);return 0!==a?a:t-n}));const n=[];let a;for(let e=0;e<t.length;e+=1){const[r,i]=t[e];void 0===a||0!==this.keyCompare(r,a)?(n.push([r,i]),a=r):n[n.length-1]=[r,i]}return this.ofSequence(n)}getKeyIndex(e){let r=t.RootPointer;for(;r>=0&&r<this.keys.length;){const t=this.keyCompare(e,this.keys[r]);if(0===t)return r;t<0?r=l(r):t>0&&(r=c(r))}}ofSequence(e){const r=e.slice();r.sort((([e],[t])=>this.keyCompare(e,t)));const n=new Array(r.length),a=new Array(r.length),o=function(e){const r=new Array(e);return u(t.RootPointer,r,0,e),r}(r.length);for(let e=0;e<r.length;e+=1){const[t,i]=r[o[e]];n[e]=t,a[e]=i}return new i(this.keyCompare,n,a)}constructor(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}}function o(e,t){const r=[];return s(e,t,r),r}function s(e,t,r){t<0||t>=e.keys.length||(s(e,l(t),r),r.push([e.keys[t],e.values[t]]),s(e,c(t),r))}function u(e,t,r,n){if(e>=t.length)return;const i=function(e){const t=a(e);return t/2-1<=e-t?t-1:e-t/2}(n);t[e]=r+i,u(l(e),t,r,i),u(c(e),t,r+i+1,n-i-1)}function l(e){return 2*e+1}function c(e){return 2*e+2}t.ArrayMapTree=i,t.RootPointer=0,t.enumerateInOrder=o,t.enumerateKeysInOrder=function(e,t){return o(e,t).map((([e])=>e))}},2147:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryHeap=void 0,t.BinaryHeap=class{insert(e){this.items.push(e);let t=this.getCount()-1;for(;t>0;){const r=t-1>>>1,n=this.items[r];if(!(this.cmp(n,e)>0))break;this.items[t]=n,t=r}this.items[t]=e}peek(){return this.items[0]}removeMin(){const e=this.peek(),t=this.items.pop(),r=this.getCount()-1;if(r<0||void 0===t)return e;let n=0;for(this.items[0]=t;n<r;){let e=n;const a=1+(n<<1),i=2+(n<<1);if(a<=r&&this.cmp(this.items[a],t)<0&&(e=a),i<=r&&this.cmp(this.items[i],e===a?this.items[e]:t)<0&&(e=i),n===e)break;this.items[n]=this.items[e],n=e}return this.items[n]=t,e}getCount(){return this.items.length}clear(){this.items.length=0}forEach(e){for(const t of this.items)if(!e(t))return}constructor(e){this.items=[],this.cmp=e}}},9207:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachKeyUntyped=t.forEachKey=t.getNodeCount=t.complement=t.symmetricDiff=t.lazy=t.empty=t.dense=t.compareUntyped=t.combineCmp=t.compare=t.exceptUntyped=t.except=t.meetsUntyped=t.meets=t.intersectUntyped=t.intersect=t.unionUntyped=t.union=t.fromUntyped=t.createFromKey=t.cacheKeySplitting=t.SetKind=void 0;const n=r(3345).__assign;var a;function i(e,t,r=10){return n=>{if(void 0!==n.split)return n.split;const a=e(n),i=n===t?0:n.depth;return void 0!==i&&i<r&&(n.split=a,a[0][0].depth=i+1,a[1][0].depth=i+1),a}}function o(e,r){return r===t.empty?t.empty:r===t.dense?t.dense:{setOperations:e,root:r}}function s(e,r){return r===t.empty?e:r===t.dense||e===t.empty?r:e===t.dense?e:o(e.setOperations,u(e.setOperations,e.setOperations.top,e.root,r.root))}function u(e,r,n,a){if(a===t.empty)return n;if(a===t.dense)return a;if(n===t.empty)return a;if(n===t.dense)return n;if(n.isExact&&a.isExact){const i=function(e,r,n,a){const{key:i}=n,{key:o}=a,s=e.compare(i,o);if(void 0!==s)return s<0?a:n;const u=e.union(i,o);if(void 0!==u){const n=e.compare(u,r);return void 0!==n&&0===n?t.dense:v(e,r,u,!0)}}(e,r,n,a);if(void 0!==i)return i}const i=F(e,r,n),o=F(e,r,a),[[s],[l]]=e.split(r);return p(e,s,l,u(e,s,i.left,o.left),u(e,l,i.right,o.right))}function l(e,r,n,a){if(n===t.empty)return n;if(a===t.empty)return a;if(n===t.dense)return a;if(a===t.dense)return n;if(n.isExact&&a.isExact){const i=function(e,r,n,a){const{key:i}=n,{key:o}=a;if(!e.meets(i,o))return t.empty;const s=e.compare(i,o);if(void 0!==s)return s<0?n:a;const u=e.intersect(i,o);return void 0!==u?v(e,r,u,!0):void 0}(e,r,n,a);if(void 0!==i)return i}const i=F(e,r,n),o=F(e,r,a),[[s],[u]]=e.split(r);return p(e,s,u,l(e,s,i.left,o.left),l(e,u,i.right,o.right))}function c(e,r,n,a){if(n===t.empty||a===t.empty)return!1;if(n===t.dense||a===t.dense)return!0;if(n.isExact&&a.isExact)return e.meets(n.key,a.key);const i=F(e,r,n),o=F(e,r,a),[[s],[u]]=e.split(r);return c(e,s,i.left,o.left)||c(e,u,i.right,o.right)}function d(e,r){return e===t.empty||r===t.empty?e:r===t.dense?t.empty:e===t.dense?o(r.setOperations,g(r.setOperations,r.setOperations.top,e,r.root)):o(e.setOperations,g(e.setOperations,e.setOperations.top,e.root,r.root))}function g(e,r,n,a){if(n===t.empty)return n;if(a===t.empty)return n;if(a===t.dense)return t.empty;if(n===t.dense){const n=F(e,r,a),[[i],[o]]=e.split(r);return p(e,i,o,g(e,i,t.dense,n.left),g(e,o,t.dense,n.right))}if(n.isExact&&a.isExact){const t=function(e,t,r,n){const{key:a}=r,{key:i}=n;if(!e.meets(a,i))return r;const o=e.except(a,i);return void 0!==o?v(e,t,o,!0):void 0}(e,r,n,a);if(void 0!==t)return t}const i=F(e,r,n),o=F(e,r,a),[[s],[u]]=e.split(r);return p(e,s,u,g(e,s,i.left,o.left),g(e,u,i.right,o.right))}function m(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function h(e,r,n,a){if(n===a)return 0;if(n===t.empty)return-1;if(a===t.empty)return 1;if(n===t.dense)return a===t.dense?0:1;if(a===t.dense)return-1;if(n.isExact&&a.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,n,a);const i=F(e,r,n),o=F(e,r,a),[[s],[u]]=e.split(r),l=h(e,s,i.left,o.left);if(void 0===l)return;const c=h(e,u,i.right,o.right);return void 0!==c?m(l,c):void 0}function p(e,r,n,a,i){return a===t.empty?i===t.empty?t.empty:i===t.dense?f(a,i,void 0,!1,e.infimum(n,n),e.supremum(n,n)):f(a,i,void 0,!1,i.infimum,i.supremum):i===t.empty?a===t.dense?f(a,i,void 0,!1,e.infimum(r,r),e.supremum(r,r)):f(a,i,void 0,!1,a.infimum,a.supremum):a===t.dense?i===t.dense?t.dense:f(a,i,void 0,!1,e.combineInfima(e.infimum(r,r),i.infimum),e.combineSuprema(e.supremum(r,r),i.supremum)):i===t.dense?f(a,i,void 0,!1,e.combineInfima(a.infimum,e.infimum(n,n)),e.combineSuprema(a.supremum,e.supremum(n,n))):f(a,i,void 0,!1,e.combineInfima(a.infimum,i.infimum),e.combineSuprema(a.supremum,i.supremum))}function f(e,t,r,n,a,i){return{key:r,left:e,right:t,isExact:n,infimum:a,supremum:i}}function S(e,r,n){if(!e.meets(r,n))return t.empty;const a=e.compare(r,n);if(void 0!==a)return a<=0?t.dense:v(e,r,n,!0);const i=e.intersect(r,n);return void 0!==i?v(e,r,i,!0):v(e,r,n,!1)}function v(e,t,r,n){return f(void 0,void 0,r,!!n,e.infimum(r,t),e.supremum(r,t))}function F(e,r,a){if(void 0!==a.left)return a;const[[i],[o]]=e.split(r),s=p(e,i,o,S(e,i,a.key),S(e,o,a.key));if(s===t.empty||s===t.dense)throw new Error("incorrect set operations implementation");const u=s;return n(a,{left:u.left,right:u.right})}function y(e){return void 0===e||e===t.empty||e===t.dense?0:y(e.left)+y(e.right)+1}function b(e,r,n){return function r(a,i){if(i===t.empty)return!0;if(i===t.dense)return n(a);if(i.isExact)return n(i.key);const o=F(e,a,i),[[s],[u]]=e.split(a);return r(s,o.left)&&r(u,o.right)}(e.top,r)}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(a||(t.SetKind=a={})),t.cacheKeySplitting=i,t.createFromKey=function(e){const t={...e,split:i(e.split,e.top)};return e=>o(t,S(t,t.top,e))},t.fromUntyped=o,t.union=s,t.unionUntyped=u,t.intersect=function(e,r){return e===t.empty?e:r===t.empty||e===t.dense?r:r===t.dense?e:o(e.setOperations,l(e.setOperations,e.setOperations.top,e.root,r.root))},t.intersectUntyped=l,t.meets=function(e,r){return e!==t.empty&&r!==t.empty&&(e===t.dense||r===t.dense||c(e.setOperations,e.setOperations.top,e.root,r.root))},t.meetsUntyped=c,t.except=d,t.exceptUntyped=g,t.compare=function(e,r){return e===r?0:e===t.empty?-1:r===t.empty?1:e===t.dense?r===t.dense?0:1:r===t.dense?-1:h(e.setOperations,e.setOperations.top,e.root,r.root)},t.combineCmp=m,t.compareUntyped=h,t.dense=a.Dense,t.empty=a.Empty,t.lazy=S,t.symmetricDiff=function(e,t){return s(d(e,t),d(t,e))},t.complement=function(e){return d(t.dense,e)},t.getNodeCount=function(e){return e===t.empty||e===t.dense?0:y(e.root)},t.forEachKey=function(e,r){return e===t.empty||b(e.setOperations,e.root,r)},t.forEachKeyUntyped=b},4759:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boundedParetoSetOperations=t.boundedParetoSplitter=t.boundedPareto=void 0;const n=r(4563),a=r(5533);function i(e,t,r){const n=t**e,a=1-(t/r)**e,i=r**e,o=i*n,s=i-n,u=-1/e;return{cdf:1===e?e=>(1-n/e)/a:t=>(1-n*t**-e)/a,invCdf:1===e?e=>1/((i-e*s)/o):e=>((i-e*s)/o)**u}}function o(e,t,r){const a=i(e,t,r);return{canSplit:([e,t])=>t-e>1,split([e,t]){const r=a.cdf(t),i=a.cdf(e+1),o=a.invCdf((r+i)/2),s=(0,n.fastMin)((0,n.fastMax)(Math.round(o),e+1),t-1);return[[[e,s],a.cdf(s)-a.cdf(e+1)],[[s,t],a.cdf(t)-a.cdf(s)]]}}}t.boundedPareto=i,t.boundedParetoSplitter=o,t.boundedParetoSetOperations=function(e,t,r,i,s){const u=o(e,t,r);return{id:s,split:e=>u.split(e),canSplit:e=>u.canSplit(e),meets:a.ivlMeets,intersect:a.ivlMeet,union:(e,t)=>(0,a.ivlMeetsOrTouches)(e,t)?(0,a.ivlJoin)(e,t):void 0,except:a.ivlExcept,compare:a.ivlCompare,top:i,infimum:([e])=>e,supremum:([,e])=>e,combineInfima:(e,t)=>(0,n.fastMin)(e,t),combineSuprema:(e,t)=>(0,n.fastMax)(e,t)}}},9014:function(e,t){"use strict";function r(e,t){return e&t-1}Object.defineProperty(t,"__esModule",{value:!0}),t.Deque=void 0,t.Deque=class{getCount(){return this.count}maybeResize(){const e=this.values.length;if(this.count>=e){this.values.length=e<<1;for(let t=0;t<this.front;t+=1)this.values[e+t]=this.values[t],this.values[t]=void 0;return}const t=e>>4;if(t>=1&&this.count<t){for(let n=0;n<this.count;n+=1)this.values[r(this.front+n,t)]=this.values[r(this.front+n,e)];this.values.length=t,this.front=r(this.front,t)}}pushBack(e){this.maybeResize(),this.values[r(this.front+this.count,this.values.length)]=e,this.count+=1}pushFront(e){this.maybeResize();const t=r(this.front-1,this.values.length);this.values[t]=e,this.front=t,this.count+=1}peekBack(){return this.values[r(this.front+this.count-1,this.values.length)]}peekFront(){return this.values[this.front]}peekPos(e){if(!(e<0||e>=this.count))return this.values[r(this.front+e,this.values.length)]}popBack(){const e=r(this.front+this.count-1,this.values.length),t=this.values[e];return void 0!==t&&(this.values[e]=void 0,this.count-=1),t}popFront(){const e=this.values[this.front];return void 0!==e&&(this.values[this.front]=void 0,this.front=r(this.front+1,this.values.length),this.count-=1),e}forEach(e){const t=this.values.length;for(let n=0;n<this.count;n+=1)if(!e(this.values[r(this.front+n,t)]))return!1;return!0}constructor(){this.front=0,this.count=0,this.values=[void 0]}}},3624:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeNumberDict=t.makeStringDict=t.makeDictionary=void 0;const n=r(9310),a=r(4563);function i(e){function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}return{entries:(0,a.makeStringMap)(),keyToString:e,getCount(){return Object.keys(this.entries).length},getValue(e){const r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,a.isDefined)(n)?n.value:void 0},getEntry(e){const t=this.getValue(e);return void 0===t?void 0:(0,n.entry)(e,t)},setValue(e,r){const i=this.keyToString(e),o=t(this.entries,i)?this.entries[i]:void 0;(0,a.isDefined)(o)?o.value=r:this.entries[i]=(0,n.entry)(e,r)},contains(e){const r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,a.isDefined)(n)},remove(e){const r=this.keyToString(e);return!!t(this.entries,r)&&(delete this.entries[r],!0)},getOrSetValue(e,r){const i=this.keyToString(e),o=t(this.entries,i)?this.entries[i]:void 0;if((0,a.isDefined)(o))return o.value;const s=r();return delete this.entries[i],this.entries[i]=(0,n.entry)(e,s),s},forEach(e){for(const r in this.entries){const n=t(this.entries,r)?this.entries[r]:void 0;if((0,a.isDefined)(n)&&!e(n.key,n.value))return!1}return!0},filter(e){const t=[];this.forEach(((r,n)=>(e(r,n)||t.push(r),!0)));for(const e of t)this.remove(e)}}}t.makeDictionary=i,t.makeStringDict=function(){return i(a.identity)},t.makeNumberDict=function(){return i((e=>String(e)))}},922:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashSet=void 0;const n=r(4563),a=r(491);t.makeHashSet=function(e,t){return{map:{},keyToHash:e,keyEquals:t,nelements:0,add(e){const t=this.keyToHash(e);if((0,n.isNone)(this.map[t]))this.map[t]=[e],this.nelements+=1;else{const r=this.map[t];for(let t=0;t<r.length;t+=1)if(this.keyEquals(e,r[t]))return;(0,a.logCollisionKey)(e),r.push(e),this.nelements+=1}},contains(e){const t=this.keyToHash(e),r=this.map[t];if((0,n.isNone)(r))return!1;for(let t=0;t<r.length;t+=1)if(this.keyEquals(e,r[t]))return!0;return(0,a.logCollisionKey)(e),!1},forEach(e){Object.keys(this.map).forEach((t=>{this.map[Number(t)].forEach((t=>{e(t)}))}))},size(){return this.nelements},remove(e){const t=this.keyToHash(e),r=this.map[t];if((0,n.isNone)(r))return!1;const i=[];let o=!1;return r.forEach((t=>{this.keyEquals(e,t)?(this.nelements-=1,o=!0):i.push(t)})),this.map[t]=i,o||(0,a.logCollisionKey)(e),o}}}},6430:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashTable=void 0;const n=r(9310),a=r(491),i=r(4563);t.makeHashTable=function(e,t){return{map:{},nentries:0,keyToHash:e,keyEquals:t,getCount(){return this.nentries},getValue(e){const t=this.getEntry(e);return void 0===t?void 0:t.value},getEntry(e){const t=this.keyToHash(e),r=this.map[t];if(!(0,i.isNone)(r)){for(let t=0;t<r.length;t+=1){const n=r[t];if(this.keyEquals(e,n.key))return n}(0,a.logCollisionKey)(e)}},contains(e){return void 0!==this.getValue(e)},setValue(e,t){const r=this.keyToHash(e),i=this.map[r];if(null==i)this.map[r]=[(0,n.entry)(e,t)],this.nentries+=1;else{for(let r=0;r<i.length;r+=1){const n=i[r];if(this.keyEquals(n.key,e))return void(n.value=t)}i.push((0,n.entry)(e,t)),this.nentries+=1,(0,a.logCollisionKey)(e)}},remove(e){const t=this.keyToHash(e),r=this.map[t];if((0,i.isNone)(r))return!1;const n=[];let o=!1;for(let t=0;t<r.length;t+=1){const a=r[t];this.keyEquals(e,a.key)?(this.nentries-=1,o=!0):n.push(a)}return this.map[t]=n,o||(0,a.logCollisionKey)(e),o},getOrSetValue(e,t){const r=this.keyToHash(e),o=this.map[r];if((0,i.isNone)(o)){const a=t();return this.map[r]=[(0,n.entry)(e,a)],this.nentries+=1,a}for(let t=0;t<o.length;t+=1){const r=o[t];if(this.keyEquals(e,r.key))return r.value}const s=t();return o.push((0,n.entry)(e,s)),this.nentries+=1,(0,a.logCollisionKey)(e),s},forEach(e){return Object.keys(this.map).every((t=>this.map[Number(t)].every((t=>e(t.key,t.value)))))},filter(e){const t=[];this.forEach(((r,n)=>(e(r,n)||t.push(r),!0)));for(const e of t)this.remove(e)}}}},1864:function(e,t){"use strict";function r(e,t,r,n,a){let i=t,o=t+r-1;for(;i<=o;){const t=i+(o-i>>>1),r=a(e[t],n);if(0===r)return t;r<0?i=t+1:o=t-1}return~i}Object.defineProperty(t,"__esModule",{value:!0}),t.binarySearch=t.exponentialBuckets=t.linearBuckets=t.Histogram=void 0,t.Histogram=class{addSample(e){let t=this.findBucket(e);t<0&&(t=~t),this.sampleCounts[t]+=1}reset(){const e={buckets:this.buckets,sampleCounts:this.sampleCounts};return this.sampleCounts=this.createSampleCounts(),e}constructor(e){this.buckets=e,this.createSampleCounts=()=>new Array(this.buckets.length+1).fill(0),this.sampleCounts=this.createSampleCounts(),this.findBucket=(()=>{const e=(e,t)=>e-t,t=this.buckets.length;return n=>r(this.buckets,0,t,n,e)})()}},t.linearBuckets=function(e,t,r){const n=(t-e)/(r-1),a=[];for(let t=e,i=0;i<r;t+=n,i+=1)a.push(t);return a},t.exponentialBuckets=function(e,t,r){const n=Math.log(e),a=(Math.log(t)-n)/(r-1),i=[];for(let e=0,t=0;t<r;e+=a,t+=1)i.push(Math.exp(n+e));return i},t.binarySearch=r},2218:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=t.rTree=t.RingBuffer=t.rbTree=t.RedBlackMapTree=t.productSet=t.PriorityQueue=t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=t.binarySearch=t.exponentialBuckets=t.linearBuckets=t.Histogram=t.makeHashTable=t.makeHashSet=t.makeNumberDict=t.makeStringDict=t.makeDictionary=t.Deque=t.bspSplit=t.bspSet=t.BinaryHeap=t.ArrayMapTree=void 0;const n=r(3345);var a=r(2365);Object.defineProperty(t,"ArrayMapTree",{enumerable:!0,get:function(){return a.ArrayMapTree}});var i=r(2147);Object.defineProperty(t,"BinaryHeap",{enumerable:!0,get:function(){return i.BinaryHeap}}),t.bspSet=n.__importStar(r(9207)),t.bspSplit=n.__importStar(r(4759));var o=r(9014);Object.defineProperty(t,"Deque",{enumerable:!0,get:function(){return o.Deque}});var s=r(3624);Object.defineProperty(t,"makeDictionary",{enumerable:!0,get:function(){return s.makeDictionary}}),Object.defineProperty(t,"makeStringDict",{enumerable:!0,get:function(){return s.makeStringDict}}),Object.defineProperty(t,"makeNumberDict",{enumerable:!0,get:function(){return s.makeNumberDict}});var u=r(922);Object.defineProperty(t,"makeHashSet",{enumerable:!0,get:function(){return u.makeHashSet}});var l=r(6430);Object.defineProperty(t,"makeHashTable",{enumerable:!0,get:function(){return l.makeHashTable}});var c=r(1864);Object.defineProperty(t,"Histogram",{enumerable:!0,get:function(){return c.Histogram}}),Object.defineProperty(t,"linearBuckets",{enumerable:!0,get:function(){return c.linearBuckets}}),Object.defineProperty(t,"exponentialBuckets",{enumerable:!0,get:function(){return c.exponentialBuckets}}),Object.defineProperty(t,"binarySearch",{enumerable:!0,get:function(){return c.binarySearch}});var d=r(5533);Object.defineProperty(t,"ivlJoin",{enumerable:!0,get:function(){return d.ivlJoin}}),Object.defineProperty(t,"ivlMeet",{enumerable:!0,get:function(){return d.ivlMeet}}),Object.defineProperty(t,"ivlDistance",{enumerable:!0,get:function(){return d.ivlDistance}}),Object.defineProperty(t,"ivlMeets",{enumerable:!0,get:function(){return d.ivlMeets}}),Object.defineProperty(t,"ivlMeetsOrTouches",{enumerable:!0,get:function(){return d.ivlMeetsOrTouches}}),Object.defineProperty(t,"ivlExcept",{enumerable:!0,get:function(){return d.ivlExcept}}),Object.defineProperty(t,"ivlCompare",{enumerable:!0,get:function(){return d.ivlCompare}});var g=r(5469);Object.defineProperty(t,"PriorityQueue",{enumerable:!0,get:function(){return g.PriorityQueue}}),t.productSet=n.__importStar(r(5013));var m=r(1964);Object.defineProperty(t,"RedBlackMapTree",{enumerable:!0,get:function(){return m.RedBlackMapTree}}),t.rbTree=n.__importStar(r(4796));var h=r(6696);Object.defineProperty(t,"RingBuffer",{enumerable:!0,get:function(){return h.RingBuffer}}),t.rTree=n.__importStar(r(420));var p=r(9310);Object.defineProperty(t,"makeEmptyTable",{enumerable:!0,get:function(){return p.makeEmptyTable}}),Object.defineProperty(t,"entry",{enumerable:!0,get:function(){return p.entry}})},5533:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;const n=r(4563);t.ivlJoin=function(e,t){const[r,a]=e,[i,o]=t;return[(0,n.fastMin)(r,i),(0,n.fastMax)(a,o)]},t.ivlMeet=function(e,t){const[r,a]=e,[i,o]=t;return[(0,n.fastMax)(r,i),(0,n.fastMin)(a,o)]},t.ivlDistance=function(e,t){const[r,a]=e,[i,o]=t;return.5*(0,n.fastAbs)(r+a-(i+o))},t.ivlMeets=function(e,t){const[r,a]=e,[i,o]=t;return(0,n.fastMax)(r,i)<(0,n.fastMin)(a,o)},t.ivlMeetsOrTouches=function(e,t){const[r,a]=e,[i,o]=t;return(0,n.fastMax)(r,i)<=(0,n.fastMin)(a,o)},t.ivlExcept=function(e,t){const[r,n]=e,[a,i]=t;return r<a&&i>=n?[r,a]:r>=a&&i<n?[i,n]:void 0},t.ivlCompare=function(e,t){const[r,n]=e,[a,i]=t;return r===a&&n===i?0:r>=a&&n<=i?-1:r<=a&&n>=i?1:void 0}},5469:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=void 0;const n=r(2147);t.PriorityQueue=class{peek(){const e=this.heap.peek();if(void 0!==e)return e[0]}enqueue(e){this.max+=1,this.heap.insert([e,this.max])}push(e){this.min-=1,this.heap.insert([e,this.min])}pop(){const e=this.heap.removeMin();return void 0===e?(this.min=0,void(this.max=0)):e[0]}getCount(){return this.heap.getCount()}clear(){this.heap.clear()}constructor(e){this.min=0,this.max=0,this.heap=new n.BinaryHeap((([t,r],[n,a])=>{const i=e(t,n);return 0!==i?i:r-a}))}}},5013:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.productSetSerializer=t.ProductSetSerializer=t.getSubspaceCount=t.forEachProduct=t.getSubspaces=t.symmetricDiffProduct=t.complementProduct=t.meetsProduct=t.compareProduct=t.exceptProduct=t.intersectProduct=t.unionProduct=t.project=t.createFromProduct=void 0;const n=r(9207),a=([e],[t])=>{return(r=String(e))<(n=String(t))?-1:r>n?1:0;var r,n},i={},o=e=>{const t=[];for(const r of Object.keys(e)){const n=r;t.push([n,e[n].id])}const r=function(e){let t="";for(const r of e)t+=String(r[0]),t+="\0",t+=String(r[1]),t+="\0";return t}(t.sort(a));let n=i[r];return void 0===n&&(n={box:{},probabilities:{},depth:1},i[r]=n),n};function s(e){return Object.getOwnPropertyNames(e).length>0}function u(e){return s(e)?{isSubspace:!0,bounds:e}:n.dense}function l(e){return e.isSubspace?1:e.subspaceCount}const c=(e,t,r)=>({isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:l(e)+l(t)});function d(e,t){if(t===n.dense)return t;if(t.isSubspace){let r=!1;for(const n of Object.keys(t.bounds))if(Object.prototype.hasOwnProperty.call(e,n)){r=!0;break}if(!r)return n.dense}return{productOperations:e,root:t}}function g(e){return void 0===e?n.dense:e}const m={unzip(e){const t={},r={};for(const a of Object.keys(e)){const i=a;if(Object.prototype.hasOwnProperty.call(e,i)){const a=e[i];if(a===n.empty)return n.empty;if(a===n.dense)continue;t[i]=a.setOperations,r[i]=a.root}}return d(t,u(r))},combineProduct(e,t,r,a){const i={};for(const o of Object.keys(e)){const s=o;if(Object.prototype.hasOwnProperty.call(e,s)){const o=a(e[s],e[s].top,g(t[s]),g(r[s]));if(o===n.empty)return n.empty;if(o===n.dense)continue;i[s]=o}}return i},restrict(e,...t){const r={};for(const n of t)if(Object.prototype.hasOwnProperty.call(e,n)){const t=e[n];r[n]=t}return r},fromUntypedProduct(e,t,r){const a={};for(const i of r){const r=t[i];a[i]=(0,n.fromUntyped)(e[i],void 0!==r?r:n.dense)}return a},denseProduct(e){const t={};for(const r of e)t[r]=n.dense;return t}};function h(e,t,r){const a=m.combineProduct(e,t,r,n.unionUntyped);if(a===n.empty)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return a}function p(e,t,r){let a=0;for(const i of Object.keys(e)){const o=i;if(Object.prototype.hasOwnProperty.call(e,o)){const i=g(t[o]),s=g(r[o]),u=e[o];if(a=(0,n.combineCmp)(a,(0,n.compareUntyped)(u,u.top,i,s)),void 0===a)return}}return a}t.createFromProduct=m.unzip.bind(m);const f=(()=>{const e={};return(t,r,a)=>{if(r===e.left&&a===e.right)return e.res;e.left=r,e.right=a;const i=p(t,r.bounds,a.bounds);if(void 0!==i)return e.res=i<=0?a:r;let o;const s=Object.keys(t);for(const i of s)if(Object.prototype.hasOwnProperty.call(t,i)&&0!==(0,n.compareUntyped)(t[i],t[i].top,g(r.bounds[i]),g(a.bounds[i]))){if(void 0!==o)return e.res=void 0;o=i}if(void 0!==o){const i=(0,n.unionUntyped)(t[o],t[o].top,g(r.bounds[o]),g(a.bounds[o]));if(i===n.empty)return e.res=n.empty;if(i===n.dense){const{[o]:t,...n}=r.bounds;return e.res=u(n)}const s={...r.bounds,[o]:i};return e.res=u(s)}return e.res=void 0}})();function S(e,t,r){if(r===n.empty)return t;if(r===n.dense)return r;if(t===n.empty)return r;if(t===n.dense)return t;if(!t.isSubspace||!r.isSubspace)return c(t,r,h(e,t.bounds,r.bounds));const a=f(e,t,r);return void 0!==a?a:c(t,r,h(e,t.bounds,r.bounds))}function v(e,t,r,...a){if(t===n.empty||t===n.dense)return t;if(t.isSubspace)return u(m.restrict(t.bounds,...a));const[i,o]=y(e,r),[s,l]=C(e,t,i,o);return S(e,v(e,s,i,...a),v(e,l,o,...a))}function F(e,...t){if(e===n.dense||e===n.empty)return e;const r=m.restrict(e.productOperations,...t);if(!s(r))return n.dense;const a=v(r,e.root,o(r),...t);return a===n.empty?a:d(r,a)}function y(e,t){if(void 0!==t.children)return t.children;const{box:r,probabilities:a}=t;let i,o,s=0;const u=Object.keys(e);for(const t of u)if(Object.prototype.hasOwnProperty.call(e,t)){const u=a[t],l=e[t];if(void 0===u){i=t,o=l.top;break}if(u>s){const e=g(r[t]);if(e===n.empty)throw new Error("the key split can never return empty");let a=l.top;if(e!==n.dense){if(!e.isExact)throw new Error("the key can always be represented exactly");a=e.key}if(!l.canSplit(a))continue;i=t,s=u,o=a}}if(void 0===i||void 0===o)throw new Error("there has to be at least one dimension");const l=e[i],[[c,d],[m,h]]=l.split(o),p=[{box:{...r,[i]:(0,n.lazy)(l,l.top,c)},probabilities:{...a,[i]:d},depth:t.depth+1},{box:{...r,[i]:(0,n.lazy)(l,l.top,m)},probabilities:{...a,[i]:h},depth:t.depth+1}];return t.depth<10&&(t.children=p),p}function b(e,t,r,a){if(t===n.empty)return[n.empty,n.empty];if(t===n.dense)return[u(r),u(a)];const i=p(e,t.bounds,r);if(void 0!==i&&i<=0)return[t,n.empty];const o=m.combineProduct(e,t.bounds,r,n.intersectUntyped);if(o===n.empty)return[n.empty,t];const s=m.combineProduct(e,t.bounds,a,n.intersectUntyped);if(t.isSubspace)return[u(o),s===n.empty?n.empty:u(s)];const[l,c]=b(e,t.left,r,a),[d,g]=b(e,t.right,r,a);return[S(e,l,d),S(e,c,g)]}t.project=F;const C=(e,t,{box:r},{box:n})=>b(e,t,r,n);function A(e,t,r,a,i){const[o,s]=y(e,a),[u,l]=C(e,t,o,s),[c,d]=C(e,r,o,s),g=i(e,u,c,o);return g===n.dense?n.dense:S(e,g,i(e,l,d,s))}function E(e,t,r,a){if(r===n.empty)return t;if(t===n.empty)return r;if(t===n.dense)return t;if(r===n.dense)return r;if(t.isSubspace&&r.isSubspace){const n=f(e,t,r);if(void 0!==n)return n}return A(e,t,r,a,E)}function T(e,t){if(t===n.empty)return e;if(t===n.dense)return t;if(e===n.empty)return t;if(e===n.dense)return e;const r={...e.productOperations,...t.productOperations},a=E(r,e.root,t.root,o(r));return a===n.empty?a:d(r,a)}function R(e,t,r,a){if(t===n.empty||r===n.empty)return n.empty;if(t===n.dense)return r;if(r===n.dense)return t;if(t.isSubspace&&r.isSubspace){const a=m.combineProduct(e,t.bounds,r.bounds,n.intersectUntyped);return a===n.empty?n.empty:u(a)}return A(e,t,r,a,R)}function k(e,t,r,a){if(t===n.empty)return t;if(r===n.dense)return n.empty;if(r===n.empty)return t;if(t===n.dense)return A(e,t,r,a,k);if(t.isSubspace&&r.isSubspace){const a=function(e,t,r){const a=p(e,t.bounds,r.bounds);if(0===a||-1===a)return n.empty;let i;const o=Object.keys(e);for(const a of o)if(Object.prototype.hasOwnProperty.call(e,a)){const o=(0,n.compareUntyped)(e[a],e[a].top,g(t.bounds[a]),g(r.bounds[a]));if(void 0===o||o>0){if(void 0!==i)return;i=a}}if(void 0!==i){const a=(0,n.exceptUntyped)(e[i],e[i].top,g(t.bounds[i]),g(r.bounds[i]));if(a===n.empty)return n.empty;if(a===n.dense){const{[i]:e,...r}=t.bounds;return u(r)}return u({...t.bounds,[i]:a})}}(e,t,r);if(void 0!==a)return a}return A(e,t,r,a,k)}function N(e,t){if(e===n.empty)return e;if(t===n.empty)return e;if(t===n.dense)return n.empty;if(e===n.dense){const e=k(t.productOperations,n.dense,t.root,o(t.productOperations));return e===n.empty?e:d(t.productOperations,e)}const r={...e.productOperations,...t.productOperations},a=k(r,e.root,t.root,o(r));return a===n.empty?a:d(r,a)}function I(e,t,r,a){if(t===r)return 0;if(t===n.empty)return-1;if(r===n.empty)return 1;if(t===n.dense)return r===n.dense?0:1;if(r===n.dense)return-1;if(t.isSubspace&&r.isSubspace)return p(e,t.bounds,r.bounds);const[i,o]=y(e,a),[s,u]=C(e,t,i,o),[l,c]=C(e,r,i,o),d=I(e,s,l,i);return void 0!==d?(0,n.combineCmp)(d,I(e,u,c,o)):void 0}function O(e,t,r,a){if(t===n.empty||r===n.empty)return!1;if(t===n.dense||r===n.dense)return!0;if(!function(e,t,r){for(const a of Object.keys(e)){const i=a;if(Object.prototype.hasOwnProperty.call(e,i)){const a=g(t[i]),o=g(r[i]),s=e[i];if(!(0,n.meetsUntyped)(s,s.top,a,o))return!1}}return!0}(e,t.bounds,r.bounds))return!1;if(t.isSubspace&&r.isSubspace)return!0;const[i,o]=y(e,a),[s,u]=C(e,t,i,o),[l,c]=C(e,r,i,o);return O(e,s,l,i)||O(e,u,c,o)}t.unionProduct=T,t.intersectProduct=function(e,t){if(e===n.empty)return e;if(t===n.empty)return t;if(e===n.dense)return t;if(t===n.dense)return e;const r={...e.productOperations,...t.productOperations},a=R(r,e.root,t.root,o(r));return a===n.empty?a:d(r,a)},t.exceptProduct=N,t.compareProduct=function(e,t){if(e===t)return 0;if(e===n.empty)return-1;if(t===n.empty)return 1;if(e===n.dense)return t===n.dense?0:1;if(t===n.dense)return-1;const r={...e.productOperations,...t.productOperations};return I(r,e.root,t.root,o(r))},t.meetsProduct=function(e,t){if(e===n.empty||t===n.empty)return!1;if(e===n.dense||t===n.dense)return!0;const r={...e.productOperations,...t.productOperations};return O(r,e.root,t.root,o(r))},t.complementProduct=e=>N(n.dense,e),t.symmetricDiffProduct=(e,t)=>T(N(e,t),N(t,e)),t.getSubspaces=function(e){if(e===n.empty||e===n.dense)return[];const t=[];return function e(r){r.isSubspace?t.push(r.bounds):(e(r.left),e(r.right))}(e.root),t},t.forEachProduct=function(e,t,...r){const a=F(e,...r);if(a===n.empty)return!0;if(a===n.dense)return t(m.denseProduct(r));const{productOperations:i,root:o}=a;return function e(n){return n.isSubspace?t(m.fromUntypedProduct(i,n.bounds,r)):e(n.left)&&e(n.right)}(o)},t.getSubspaceCount=function(e){return e===n.empty||e===n.dense?0:l(e.root)};class P{putBack(e){this.cursor-=1,this.buffer[this.cursor]=e}pick(){return this.buffer[this.cursor]}get length(){return this.buffer.length-this.cursor}get empty(){return 0===this.length}pop(){const e=this.pick();return this.cursor+=1,e}constructor(e=[]){this.buffer=e,this.cursor=0}}class M{constructor(){this.size=0,this.clear=()=>{},this.get=()=>{},this.set=()=>this}}function D(e,t){return function(r,n,...a){const i=t.get(r);void 0===i?(e(r,n,...a),t.set(r,t.size)):n.push("__cached__",i)}}function w(e,t){return function(r,...n){if("__cached__"===r.pick()){r.pop();const e=r.pop();return t[e]}const a=e(r,...n);return t.push(a),a}}class L{getDims(e){return Object.keys(e)}serialize(e){this.cached.clear();const t=[];t.push(e.length);for(const r of e)this.serializeProductSetCached(r,t);return JSON.stringify(t)}deserialize(e){this.cache.length=0;const t=new P(JSON.parse(e)),r=t.pop(),n=[];for(let e=0;e<r;e+=1){const e=this.deserializeProductSetCached(t);n.push(e)}return n}static normalizeKey(e){if(Array.isArray(e))return[...e];if("object"==typeof e){const t={...e};return delete t.depth,delete t.split,t}return e}constructor(e){this.globalProductOperations=e,this.cached="undefined"!=typeof Map?new Map:new M,this.cache=[],this.serializers={},this.serializeProductSet=(e,t)=>{if(e===n.empty||e===n.dense)return void t.push(e);const r=e,a=this.getDims(r.productOperations);t.push(a),this.serializeUntypedSparseProductCached(r.root,t,a)},this.deserializeProductSet=e=>{const t=e.pop();if(t===n.empty||t===n.dense)return t;e.putBack(t);const r={},a=e.pop();for(const e of a){const t=this.globalProductOperations[e];r[e]=t}return{productOperations:r,root:this.deserializeUntypedSparseProductCached(e,a)}},this.serializeUntypedSparse=(e,t,r)=>{t.push(e?.isExact),t.push(this.serializers[r].serializeBound(e?.infimum)),t.push(this.serializers[r].serializeBound(e?.supremum));const a=L.normalizeKey(e?.key);t.push(this.serializers[r].serializeKey(a));for(const a of[e?.left,e?.right])null==a||a===n.empty||a===n.dense?t.push(a):(t.push("us"),this.serializeUntypedSparseCached(a,t,r))},this.deserializeUntypedSparse=(e,t)=>{const r=e.pop(),n=this.serializers[t].deserializeBound(e.pop()),a=this.serializers[t].deserializeBound(e.pop()),i=this.serializers[t].deserializeKey(e.pop()),[o,s]=["left","right"].map((r=>{const n=e.pop();return"us"===n?this.deserializeUntypedSparseCached(e,t):n}));return{infimum:n,supremum:a,isExact:r,key:i,left:o,right:s}},this.serializeUntypedSparseProduct=(e,t,r)=>{t.push(e.isSubspace);for(const n of r){const r=e.bounds[n];this.serializeUntypedSparseCached(r,t,n)}e.isSubspace||(this.serializeUntypedSparseProductCached(e.left,t,r),this.serializeUntypedSparseProductCached(e.right,t,r),t.push(e.subspaceCount))},this.deserializeUntypedSparseProduct=(e,t)=>{const r=e.pop(),n={};for(const r of t){const t=this.deserializeUntypedSparseCached(e,r);n[r]=t}return r?{isSubspace:r,bounds:n}:{isSubspace:r,bounds:n,left:this.deserializeUntypedSparseProductCached(e,t),right:this.deserializeUntypedSparseProductCached(e,t),subspaceCount:e.pop()}},this.serializeUntypedSparseCached=D(this.serializeUntypedSparse,this.cached),this.deserializeUntypedSparseCached=w(this.deserializeUntypedSparse,this.cache),this.serializeProductSetCached=D(this.serializeProductSet,this.cached),this.deserializeProductSetCached=w(this.deserializeProductSet,this.cache),this.serializeUntypedSparseProductCached=D(this.serializeUntypedSparseProduct,this.cached),this.deserializeUntypedSparseProductCached=w(this.deserializeUntypedSparseProduct,this.cache);for(const t in e){const r={serializeKey:e[t].serializeKey??(e=>JSON.stringify(e)),deserializeKey:e[t].deserializeKey??(e=>JSON.parse(e)),serializeBound:e[t].serializeBound??(e=>JSON.stringify(e)),deserializeBound:e[t].deserializeBound??(e=>JSON.parse(e))};this.serializers[t]=r}}}t.ProductSetSerializer=L,t.productSetSerializer=function(e){return new L(e)}},420:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTree=t.RTKind=t.copyExcept=void 0;const n=r(4563),a=r(9310);function i(e,t,r){if(void 0!==r){const n=e.slice();return n[t]=r,n}const n=e.slice(0,-1);return t<e.length-1&&(n[t]=e[e.length-1]),n}var o,s;function u(e,t,r){return{kind:e,key:t,value:r}}function l(e,t){return u(o.Ptr,e,t)}function c(e,t){return u(o.Leaf,e,t)}function d(e,t){return u(o.Branch,e,t)}t.copyExcept=i,function(e){e[e.Ptr=1]="Ptr",e[e.Leaf=2]="Leaf",e[e.Branch=3]="Branch"}(o||(t.RTKind=o={})),function(e){e[e.NotFound=1]="NotFound",e[e.Removed=2]="Removed",e[e.Delete=3]="Delete"}(s||(s={}));class g{static create(e,t,r,n,a=2){const i=a>1?Math.ceil(a):1;return new g({keyJoin:e,keyMeets:t,keyCompare:r,keyDistance:n,minChildren:i,maxChildren:2*i,keyGe:function(e,t){const n=r(e,t);return void 0!==n&&n>=0},keyLe:function(e,t){const n=r(e,t);return void 0!==n&&n<=0}},void 0,0)}getCount(){return this.count}get bounds(){return this.root?.key}getValue(e){if(void 0!==this.root)return function t(r,n){const a=r.keyCompare(n.key,e);if(n.kind===o.Ptr)return 0===a?n.value:void 0;if(!(void 0===a||a<0))for(const e of n.value){const n=t(r,e);if(void 0!==n)return n}}(this.lattice,this.root)}getEntry(e){const t=this.getValue(e);return void 0===t?void 0:(0,a.entry)(e,t)}setValue(e,t,r=(e=>!0)){const n=S(this.lattice,this.root,e,r,t);return void 0!==n?n===this.root?this:new g(this.lattice,n,this.count):new g(this.lattice,f(this.lattice,this.root,l(e,t)),this.count+1)}filter(e){let t=new g(this.lattice,void 0,0);return this.forEach(((r,n)=>(e(r,n)&&(t=t.setValue(r,n)),!0))),t}contains(e,t=(e=>!0)){return void 0!==S(this.lattice,this.root,e,t)}getOrSetValue(e,t){const r=this.getValue(e);if(void 0===r){const r=t();return[this.setValue(e,r),r]}return[this,r]}forEach(e){return m(this.root,e)}forEachGe(e,t){return m(this.root,t,(t=>this.lattice.keyGe(t,e)),(t=>this.lattice.keyGe(t,e)))}forEachLe(e,t){return m(this.root,t,(t=>this.lattice.keyMeets(t,e)),(t=>this.lattice.keyLe(t,e)))}forEachMeets(e,t){return m(this.root,t,(t=>this.lattice.keyMeets(t,e)),(t=>this.lattice.keyMeets(t,e)))}remove(e){if(null==this.root)return this;const t=[],r=this.lattice,a=(u,l)=>{const g=r.keyCompare(u.key,e);if(void 0===g||g<0)return(0,n.pair)(u,s.NotFound);if(u.kind===o.Leaf){const a=u.value;for(let o=0;o<a.length;o+=1)if(0===r.keyCompare(a[o].key,e)){const e=i(a,o);if(e.length<l){const r=c(u.key,e);return t.push(r),(0,n.pair)(r,s.Delete)}return(0,n.pair)(c(h(r,e),e),s.Removed)}}else{const e=u.value;for(let o=0;o<e.length;o+=1){const[c,g]=a(e[o],r.minChildren);if(g===s.Delete){const a=i(e,o);if(a.length>=l)return(0,n.pair)(d(h(r,a),a),s.Removed);const c=d(u.key,a);return t.push(c),(0,n.pair)(c,s.Delete)}if(g===s.Removed)return(0,n.pair)(d(u.key,i(e,o,c)),s.Removed)}}return(0,n.pair)(u,s.NotFound)},u=this.root.kind===o.Leaf?1:2,[p,S]=a(this.root,u);if(p===this.root)return this;let v=S===s.Delete?void 0:p;for(let e=0;e<t.length;e+=1)m(t[e],((e,t)=>(v=f(this.lattice,v,l(e,t)),!0)));return new g(this.lattice,v,this.count-1)}constructor(e,t,r){this.lattice=e,this.root=t,this.count=r}}function m(e,t,r,n){const a=void 0!==r?r:()=>!0,i=void 0!==n?n:()=>!0;if(null==e)return!0;const s=e=>{if(!a(e.key))return!0;if(e.kind===o.Leaf){const r=e.value;for(let e=0;e<r.length;e+=1){const n=r[e];if(i(n.key)&&!t(n.key,n.value))return!1}}else{const t=e.value;for(let e=0;e<t.length;e+=1)if(!s(t[e]))return!1}return!0};return s(e)}function h(e,t){let r=t[0].key;for(let n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function p(e,t,r){const[a,i]=function(e,t){const[r,a]=function(e,t){let r=0,a=1,i=e.keyDistance(t[0].key,t[1].key);for(let n=2;n<t.length;n+=1)for(let o=0;o<n;o+=1){const s=e.keyDistance(t[o].key,t[n].key);s>i&&(r=o,a=n,i=s)}return(0,n.pair)(r,a)}(e,t),i=t[r].key,o=t[a].key,s=[];for(let r=0;r<t.length;r+=1){const n=t[r];s.push([n,e.keyDistance(i,n.key)-e.keyDistance(o,n.key)])}s.sort(((e,t)=>e[1]-t[1]));let u=e.minChildren;for(;u<t.length-e.minChildren&&s[u][1]<0;u+=1);const l=[],c=[];for(let e=0;e<u;e+=1)l.push(s[e][0]);for(let e=u;e<t.length;e+=1)c.push(s[e][0]);return(0,n.pair)(l,c)}(e,r);return(0,n.pair)(u(t,h(e,a),a),u(t,h(e,i),i))}function f(e,t,r){if(null==t)return c(r.key,[r]);const[a,i]=function t(a){if(a.kind===o.Leaf){const t=[...a.value,r];if(t.length>e.maxChildren){const[r,i]=p(e,a.kind,t);return(0,n.pair)(c(r.key,r.value),i)}return(0,n.pair)(c(e.keyJoin(a.key,r.key),t),void 0)}const i=a.value.slice(),s=function(e,t,r){let n=0,a=e.keyDistance(t[0].key,r),i=t[0].value.length;for(let o=1;o<t.length;o+=1){const s=t[o],u=e.keyDistance(s.key,r);(u<a||u===a&&s.value.length<i)&&(n=o,a=u,i=s.value.length)}return n}(e,i,r.key),[u,l]=t(i[s]);if(i[s]=u,null!=l&&(i.push(l),i.length>e.maxChildren)){const[t,r]=p(e,a.kind,i);return(0,n.pair)(d(t.key,t.value),r)}return(0,n.pair)(d(e.keyJoin(a.key,r.key),i),void 0)}(t);return null!=i?d(e.keyJoin(a.key,i.key),[a,i]):a}function S(e,t,r,n,a){if(void 0!==t)return function t(n){if(n.kind!==o.Leaf)for(let a=0;a<n.value.length;a+=1){const o=n.value[a];if(e.keyMeets(o.key,r)){const e=t(o);if(void 0!==e)return d(n.key,i(n.value,a,e))}}else for(let e=0;e<n.value.length;e+=1){const t=s(n.value[e]);if(void 0!==t)return c(n.key,i(n.value,e,t))}}(t);function s(t){if(0===e.keyCompare(t.key,r))return void 0!==a&&t.value!==a&&n(t.value)?l(t.key,a):t}}t.RTree=g},1964:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;const n=r(4796);class a{static create(e){return new a(n.emptyUntyped,0,e)}getCount(){return this.count}getValue(e){const t=(0,n.findUntyped)(this,e,this.root);return t?.value}getEntry(e){return(0,n.findUntyped)(this,e,this.root)}contains(e){return void 0!==this.getValue(e)}forEach(e){return(0,n.forEachUntyped)(e,this.root)}setValue(e,t){return new a((0,n.insertUntyped)(this,e,t,this.root),this.contains(e)?this.count:this.count+1,this.keyCompare)}remove(e){return this.contains(e)?new a((0,n.removeUntyped)(this,e,this.root),this.count-1,this.keyCompare):this}getOrSetValue(e,t){const r=this.getValue(e);if(void 0!==r)return[this,r];const i=t();return[new a((0,n.insertUntyped)(this,e,i,this.root),this.count+1,this.keyCompare),i]}filter(e){let t=n.emptyUntyped,r=0;return this.forEach(((a,i)=>(e(a,i)&&(t=(0,n.insertUntyped)(this,a,i,t),r+=1),!1))),new a(t,r,this.keyCompare)}constructor(e,t,r){this.root=e,this.count=t,this.keyCompare=r}}t.RedBlackMapTree=a},4796:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remove=t.removeUntyped=t.insert=t.insertUntyped=t.forEach=t.forEachUntyped=t.find=t.findUntyped=t.empty=t.emptyUntyped=t.isLeaf=t.fromUntyped=t.Color=void 0;const n=r(9001);var a,i;!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(a||(t.Color=a={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(i||(i={}));const o=a.Red,s=a.Black,u=i.DoubleBlack,l={c:s,l:void 0,r:void 0},c={c:u,l:void 0,r:void 0};function d(e,t){return{ops:e,root:t}}function g(e){return void 0===e.l}function m(e){return e.c===o}function h(e){return e.c===s&&void 0!==e.l}function p(e){return e.c===s&&void 0===e.l}function f(e,t,r,n,a){return{c:e,l:t,key:r,value:n,r:a}}function S(e,{l:t,key:r,value:n,r:a}){return f(e,t,r,n,a)}function v(e){return g(e)?l:S(s,e)}function F(e,t,r){if(g(r))return;const n=e.keyCompare(t,r.key);return n<0?F(e,t,r.l):n>0?F(e,t,r.r):r}function y(e,t){return!!g(t)||!!y(e,t.l)&&!!e(t.key,t.value)&&y(e,t.r)}function b(e,t,r,n,a){if(e===s){if(m(t)&&m(t.l))return f(o,S(s,t.l),t.key,t.value,f(s,t.r,r,n,a));if(m(a)&&m(a.r))return f(o,f(s,t,r,n,a.l),a.key,a.value,S(s,a.r));if(m(t)&&m(t.r))return f(o,f(s,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,f(s,t.r.r,r,n,a));if(m(a)&&m(a.l))return f(o,f(s,t,r,n,a.l.l),a.l.key,a.l.value,f(s,a.l.r,a.key,a.value,a.r))}if(e===u){if(m(a)&&m(a.l))return f(s,f(s,t,r,n,a.l.l),a.l.key,a.l.value,f(s,a.l.r,a.key,a.value,a.r));if(m(t)&&m(t.r))return f(s,f(s,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,f(s,t.r.r,r,n,a))}return f(e,t,r,n,a)}function C(e,t,r,a,i){return e===o&&t.c===u&&h(i)?b(s,f(o,v(t),r,a,i.l),i.key,i.value,i.r):e===o&&h(t)&&i.c===u?b(s,t.l,t.key,t.value,f(o,t.r,r,a,v(i))):e===s&&t.c===u&&h(i)?b(u,f(o,v(t),r,a,i.l),i.key,i.value,i.r):e===s&&h(t)&&i.c===u?b(u,t.l,t.key,t.value,f(o,t.r,r,a,v(i))):e===s&&t.c===u&&m(i)&&h(i.l)?f(s,b(s,f(o,v(t),r,a,i.l.l),i.l.key,i.l.value,i.l.r),i.key,i.value,i.r):e===s&&m(t)&&h(t.r)&&i.c===u?f(s,t.l,t.key,t.value,b(s,t.r.l,t.r.key,t.r.value,f(o,t.r.r,r,a,v(i)))):((0,n.assertTrue)("calc.common.rbTree.rotate: expected R|B",t.c!==u&&i.c!==u),f(e,t,r,a,i))}function A(e,t,r,n){if(g(n))return f(o,l,t,r,l);const a=e.keyCompare(t,n.key);return a<0?b(n.c,A(e,t,r,n.l),n.key,n.value,n.r):a>0?b(n.c,n.l,n.key,n.value,A(e,t,r,n.r)):f(n.c,n.l,t,r,n.r)}function E(e,t,r,n){return function(e){return!m(e)||e.l.c!==o&&e.r.c!==o?e:S(s,e)}(A(e,t,r,n))}function T(e,t,r){if(g(r))return r;if(r.c===o&&p(r.l)&&p(r.r))return 0===e.keyCompare(t,r.key)?l:r;if(r.c===s&&p(r.l)&&p(r.r))return 0===e.keyCompare(t,r.key)?c:r;if(r.c===s&&m(r.l)&&p(r.l.l)&&p(r.l.r)&&p(r.r)){const n=e.keyCompare(t,r.key);return n<0?f(s,T(e,t,r.l),r.key,r.value,l):n>0?r:f(s,l,r.l.key,r.l.value,l)}const a=e.keyCompare(t,r.key);if(a<0)return C(r.c,T(e,t,r.l),r.key,r.value,r.r);if(a>0)return C(r.c,r.l,r.key,r.value,T(e,t,r.r));(0,n.assertTrue)("calc.common.rbTree.rem: expected node",!g(r.r));const[i,u,d]=R(r.r);return C(r.c,r.l,i,u,d)}function R(e){if(e.c===o&&p(e.l)&&p(e.r))return[e.key,e.value,l];if(e.c===s&&p(e.l)&&p(e.r))return[e.key,e.value,c];if(e.c===s&&p(e.l)&&m(e.r))return[e.key,e.value,S(s,e.r)];(0,n.assertTrue)("calc.common.rbTree.remMin: expected node",!g(e.l));const[t,r,a]=R(e.l);return[t,r,C(e.c,a,e.key,e.value,e.r)]}function k(e,t,r){const a=T(e,t,function(e){return h(e)&&e.l.c===s&&e.r.c===s?S(o,e):e}(r));return(0,n.assertTrue)("calc.common.rbTree.remove: expected R|B",a.c===o||a.c===s),a}t.fromUntyped=d,t.isLeaf=g,t.emptyUntyped=l,t.empty=function(e){return d(e,t.emptyUntyped)},t.findUntyped=F,t.find=function(e,t){return F(t.ops,e,t.root)},t.forEachUntyped=y,t.forEach=function(e,t){return y(e,t.root)},t.insertUntyped=E,t.insert=function(e,t,r){return d(r.ops,E(r.ops,e,t,r.root))},t.removeUntyped=k,t.remove=function(e,t){return d(t.ops,k(t.ops,e,t.root))}},6696:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RingBuffer=void 0,t.RingBuffer=class{count(){return this.counter}isEmpty(){return 0===this.counter}enqueue(e){this.list[this.writeIndex]=e,0!==this.counter&&this.writeIndex===this.readIndex?this.readIndex=(this.readIndex+1)%this.capacity:this.counter++,this.writeIndex=(this.writeIndex+1)%this.capacity}dequeue(){if(this.isEmpty())return;const e=this.list[this.readIndex];return this.list[this.readIndex]=void 0,this.readIndex=(this.readIndex+1)%this.capacity,this.counter--,e}executeOnEveryElement(e){for(let t=0;t<this.counter;t++){const r=(this.readIndex+t)%this.capacity,n=this.list[r];if(void 0!==n&&!e(n))return!1}return!0}constructor(e=1/0){this.list=e<1/0?new Array(e):new Array,this.counter=0,this.capacity=e,this.readIndex=0,this.writeIndex=0}}},9310:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;const r={getCount:()=>0,getValue:()=>{},getEntry:()=>{},contains:()=>!1,forEach:()=>!0};t.makeEmptyTable=function(){return r},t.entry=function(e,t){return{key:e,value:t}}},491:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logCollisionKey=void 0;const n=r(4068),a=r(9001);let i={},o=0;t.logCollisionKey=function(e){!function(e){const t=i[e];i[e]=(void 0===t?0:t)+1,o+=1,o%100==0&&(a.ulsLogger.ULS.traceTag(595858520,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,`calc.common.hashUtils.logCollision: ${JSON.stringify(i)}.`),i={})}(function(e){return"object"==typeof e?null===e?"null":`Object {${Object.keys(e)}}`:typeof e}(e))}},3472:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTypedChangeGateEnabled=t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;const n=r(9001),a=r(4068),i=r(3219);var o;!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcLegacyImplicitIntersection="CalcLegacyImplicitIntersection",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcNestedRecordFunction="CalcNestedRecordFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcLambdaBasicFunctions="CalcLambdaBasicFunctions",e.CalcLambdaDefaultParameters="CalcLambdaDefaultParameters",e.CalcLambdaCellValues="CalcLambdaCellValues",e.CalcLambdaArrayLifting="CalcLambdaArrayLifting"}(o||(t.FeatureName=o={}));let s=e=>{const t=`calc.common.isFeatureEnabledCallback: called with ${e} before initCalc`;return n.ulsLogger.ULS.traceTag(526989323,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,t),!1};const u={};function l(e){return void 0===u[e]&&(u[e]=s(e)),u[e]}t.initFeatureConfiguration=function(e){"function"==typeof e&&(s=e)},t.isFeatureEnabled=l,t.getFeatures=function(){const e={};for(const t in o){const r=o[t];null!=r&&(e[r]=l(r))}return e},t.getTypedFeatureGate=(0,i.makeGetTypedFeatureGate)({Number_Of_Times_Test_Was_Executed:1,"Microsoft.Office.Excel.TestBooleanFeatureGate":!1,"Microsoft.Office.Excel.TestStringFeatureGate":"","Microsoft.Office.Excel.TestNumericFeatureGate":0,"Microsoft.Office.Excel.ProseFormulaRepairExperimentLogBuggyIsEnabled":!1,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSDemoFeatureGateString":"DummyStringValue","Microsoft.Office.Excel.CalcTSDemoFeatureGateInt":42,"Microsoft.Office.Excel.CalcTSDemoFeatureGateBoolean":!1,"Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSUnitExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler":!1,"Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration":!0,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin":!1,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin":!1,TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_TEST_PLUGIN_IMPORTSCRIPTS_FAIL:!1,"Microsoft.Office.Excel.FormulaCollection":!1,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements":!1,"Microsoft.Office.Excel.ArgumentAssistanceOnMainThread":!1,"Microsoft.Office.Excel.AutoCompleteOnMainThread":!1,"Microsoft.Office.Excel.UnitlessTimeAndDate":!1,"Microsoft.Office.Excel.UnitExpIgnoreDivMul":!1,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled":!1,"Microsoft.Office.Excel.MockWorkerThreadPlugin":!1,"Microsoft.Office.Excel.EnableFullSessionLogging":!0,"Microsoft.Office.Excel.ChatGPTPluginEnabled":!1,"Microsoft.Office.Excel.FormulaByExamplePluginSuggestionShowing":!1,"Microsoft.Office.Excel.SetCellPrefetchPluginEnabled":!1,"Microsoft.Office.Excel.FileOptimization":!1,"Microsoft.Office.Excel.PluginResponseWindowDebugTimeExtension":0,"Microsoft.Office.Excel.FormulaByExampleConditionals":!1,"Microsoft.Office.Excel.FormulaByExampleReferenceRowFormula":!1,"Microsoft.Office.Excel.GotoCtrlClick":!1,"Microsoft.Office.Excel.CalcEtaLambda":!1,"Microsoft.Office.Excel.EtaReducedLambdas":!1,"Microsoft.Office.Excel.DesktopX10VPEnabled":!1,"Microsoft.Office.Excel.InCellControlsAutodetection":!1,"Microsoft.Office.Excel.ValuePreviewDisableCrossWorkbookRefs":!1,"Microsoft.Office.Excel.FormulaAuthoringWithNameManager":!1,"Microsoft.Office.Excel.XLONameManager":!1,"Microsoft.Office.Excel.DesktopX10FBEEnabled":!1,"Microsoft.Office.Excel.GetLocalePluginEnabled":!1,"Microsoft.Office.Excel.ProseExcelRepairEngineV10_1":!1});var c=r(3219);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return c.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return c.setFeatureGateDictionaryGetter}}),t.isTypedChangeGateEnabled=(0,i.makeTypedIsChangeGateEnabled)(["OfficeVSO:XXX_TestChangeGate","OfficeVSO:6476056_OnlySendNestedDotNotationPath","OfficeVSO:7396249_getTableHeadersFromServer","OfficeVSO:7903424_Microsoft.Office.Excel.ProvideX10FeaturesFromSchedulerFeatures","OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces","Microsoft.Office.Excel.X10IntelligentPythonWP5","OfficeVSO:8557722_x10GetNumOfComputationsFromFrame","OfficeVSO:8579351_x10ProcessNotificationsAfterShouldRunPlugin","OfficeVSO:8575821_x10MapGetRichValueFieldListContext","OfficeVSO:8620448_x10SchedulerThrowsFailures","OfficeVSO:8786821_x10SendLoggerMessagesToMainThread","OfficeVSO:9282729_x10RefactorWrapRequest","OfficeVSO:8846142_x10SendTelemetryWithUTel","Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions","OfficeVSO:9113474_x10_RegistryDeleteDuplicates","OfficeVSO:9127295_x10_awaitEventAsyncChanges","Microsoft.Office.Excel.ES6CodepointIterator","OfficeVSO:9150789_CancelSuppressedRequests","OfficeVSO:9214272_FormulaRepairSuggestionsLimit2RatherThan1","OfficeVSO:9272876_LogThrowingAsyncLazy","OfficeVSO:9275652_changeStopDeltaPrefetchPlugin"])},9729:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findIsomorphicSubtrees=void 0,t.findIsomorphicSubtrees=function(e,t,r=(()=>""),n=(()=>1)){const a=[e],i=new Set(a);for(let e=0;e<a.length;e+=1)for(const r of t(a[e]))i.has(r)||(i.add(r),a.push(r));i.clear(),a.reverse();const o=new Map,s=[],u=new Map,l=[];a.forEach(((e,a)=>{const i=t(e).map((e=>o.get(e)));if(i.some((e=>void 0===e)))throw new Error("Circular references in the tree");const c=i.map((e=>s[e])),d=function(e){let t=u.get(e);return void 0!==t||(t=u.size,u.set(e,t)),t}(c.join("/")+"/"+r(e));if(s.push(d),void 0===l[d]){const t=c.map((e=>l[e])),r=t.map((e=>e.size)).reduce(((e,t)=>e+t),n(e)),a=t.map((e=>e.depth)).reduce(((e,t)=>Math.max(e,t)),0)+1;l[d]={subtrees:[e],size:r,depth:a}}else l[d].subtrees.push(e);o.set(e,a)}));for(const e of l)e.subtrees.reverse();const c=new Array(a.length);for(const e of l)c[c.length-o.get(e.subtrees[0])-1]=e;return c.filter((e=>void 0!==e))}},8502:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fnv1a=void 0,t.fnv1a=function(e){let t=2166136261;const r=e.length;for(let n=0;n<r;n+=1)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}},9745:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.packageVersion=void 0,t.packageVersion="9.3.0"},6366:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.result=t.ulsStopwatchFactory=t.defaultSetTimeoutInterface=t.clearTimerUnified=t.setImmediateUnified=t.mixin=t.LimitedSizeHotMap=t.JSF32=t.fnv1a=t.findIsomorphicSubtrees=t.isTypedChangeGateEnabled=t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.getTypedFeatureGate=t.isFeatureEnabled=t.FeatureName=t.initCalcInThread=t.initCalcThread=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=t.isCalcInit=t.maxRetriesForLoadingScript=t.initCalcCalled=t.combinations=t.codePoint=t.asyncLoop=t.asyncLoopFactory=t.asyncLoopDelayPromiseImpl=t.PackageName=void 0;const n=r(3345);t.PackageName="excel-online-calc-common",n.__exportStar(r(2360),t),n.__exportStar(r(2994),t),n.__exportStar(r(9001),t),n.__exportStar(r(5506),t);var a=r(5788);Object.defineProperty(t,"asyncLoopDelayPromiseImpl",{enumerable:!0,get:function(){return a.asyncLoopDelayPromiseImpl}}),Object.defineProperty(t,"asyncLoopFactory",{enumerable:!0,get:function(){return a.asyncLoopFactory}}),Object.defineProperty(t,"asyncLoop",{enumerable:!0,get:function(){return a.asyncLoop}}),t.codePoint=n.__importStar(r(959));var i=r(7108);Object.defineProperty(t,"combinations",{enumerable:!0,get:function(){return i.combinations}});var o=r(6646);Object.defineProperty(t,"initCalcCalled",{enumerable:!0,get:function(){return o.initCalcCalled}}),Object.defineProperty(t,"maxRetriesForLoadingScript",{enumerable:!0,get:function(){return o.maxRetriesForLoadingScript}}),Object.defineProperty(t,"isCalcInit",{enumerable:!0,get:function(){return o.isCalcInit}}),Object.defineProperty(t,"getCalcAbsUrl",{enumerable:!0,get:function(){return o.getCalcAbsUrl}}),Object.defineProperty(t,"getCalcAbsUrlOrThrow",{enumerable:!0,get:function(){return o.getCalcAbsUrlOrThrow}}),Object.defineProperty(t,"initCalc",{enumerable:!0,get:function(){return o.initCalc}}),Object.defineProperty(t,"initCalcThread",{enumerable:!0,get:function(){return o.initCalcThread}}),Object.defineProperty(t,"initCalcInThread",{enumerable:!0,get:function(){return o.initCalcInThread}}),n.__exportStar(r(4563),t),n.__exportStar(r(2218),t);var s=r(3472);Object.defineProperty(t,"FeatureName",{enumerable:!0,get:function(){return s.FeatureName}}),Object.defineProperty(t,"isFeatureEnabled",{enumerable:!0,get:function(){return s.isFeatureEnabled}}),Object.defineProperty(t,"getTypedFeatureGate",{enumerable:!0,get:function(){return s.getTypedFeatureGate}}),Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return s.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return s.setFeatureGateDictionaryGetter}}),Object.defineProperty(t,"isTypedChangeGateEnabled",{enumerable:!0,get:function(){return s.isTypedChangeGateEnabled}});var u=r(9729);Object.defineProperty(t,"findIsomorphicSubtrees",{enumerable:!0,get:function(){return u.findIsomorphicSubtrees}});var l=r(8502);Object.defineProperty(t,"fnv1a",{enumerable:!0,get:function(){return l.fnv1a}});var c=r(5740);Object.defineProperty(t,"JSF32",{enumerable:!0,get:function(){return c.JSF32}});var d=r(9178);Object.defineProperty(t,"LimitedSizeHotMap",{enumerable:!0,get:function(){return d.LimitedSizeHotMap}});var g=r(2731);Object.defineProperty(t,"mixin",{enumerable:!0,get:function(){return g.mixin}}),n.__exportStar(r(5074),t),n.__exportStar(r(8827),t),n.__exportStar(r(7785),t),n.__exportStar(r(9584),t),n.__exportStar(r(1324),t);var m=r(2376);Object.defineProperty(t,"setImmediateUnified",{enumerable:!0,get:function(){return m.setImmediateUnified}}),Object.defineProperty(t,"clearTimerUnified",{enumerable:!0,get:function(){return m.clearTimerUnified}}),Object.defineProperty(t,"defaultSetTimeoutInterface",{enumerable:!0,get:function(){return m.defaultSetTimeoutInterface}});var h=r(4729);Object.defineProperty(t,"ulsStopwatchFactory",{enumerable:!0,get:function(){return h.ulsStopwatchFactory}}),n.__exportStar(r(477),t),n.__exportStar(r(3056),t),n.__exportStar(r(3204),t);const p=r(7785);t.result={isSuccess:p.isSuccess}},5740:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSF32=void 0;const r=(e,t)=>(e<<t|e>>>32-t)>>>0;t.JSF32=class{next(){return this.nextU32()*(1/4294967296)}nextU32(){const e=this.x[0]-r(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^r(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0}constructor(e){this.x=new Uint32Array([4058668781,e,e,e]);for(let e=0;e<20;e+=1)this.nextU32()}}},2731:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mixin=void 0,t.mixin=function(e,t,r){return class extends e{constructor(...e){super(...e);const n=t(this);for(const e of r)Object.defineProperty(this,e,{value:n[e].bind(n),enumerable:!1,configurable:!1})}}}},5074:function(e,t){"use strict";function r(e){try{return e()}catch{return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.objectValues=t.mathLog2=t.arrayFill=t.repeat=t.stringEndsWith=t.stringStartsWith=t.isInteger=void 0,t.isInteger="function"==typeof Number.isInteger&&r((()=>Number.isInteger(1)&&!Number.isInteger(1.1)))?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,t.stringStartsWith="function"==typeof"".startsWith&&r((()=>"ab".startsWith("a")&&!"ab".startsWith("b")&&"abc".startsWith("b",1)&&!"abc".startsWith("a",1)))?(e,t,r=0)=>e.startsWith(t,r):(e,t,r=0)=>r+t.length<=e.length&&e.substring(r,r+t.length)===t,t.stringEndsWith="function"==typeof"".endsWith&&r((()=>"ab".endsWith("b")&&!"ab".endsWith("a")))?(e,t)=>e.endsWith(t):(e,t)=>t.length<=e.length&&e.substring(e.length-t.length,e.length)===t,t.repeat="function"==typeof"".repeat&&r((()=>"aaa"==="a".repeat(3)))?(e,t)=>e.repeat(t):(e,t)=>Array(t+1).join(e),t.arrayFill=function(e,t){for(let r=0;r<e.length;r+=1)e[r]=t;return e},t.mathLog2=Math.log2??(e=>Math.log(e)*Math.LOG2E),t.objectValues=function(e){const t=[];for(const r in e)Object.hasOwnProperty.call(e,r)&&t.push(e[r]);return t}},8827:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaybeThenable=t.collapseThenable=t.bindMaybeThenable=t.isThenable=t.promiseLoop=t.newPromise=t.promiseFinally=t.ResolvablePromiseWithTimeout=t.ResolvablePromiseWithSyncValue=t.ResolvablePromiseWithLimitedSubscribers=t.ResolvablePromise=void 0;const n=r(9001),a=r(4563);class i{then(e,t){return this.promise.then(e,t)}toPromise(){return this.promise}resolve(e){this._resolve(e)}reject(e){this._reject(e)}constructor(){this.promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}}t.ResolvablePromise=i;class o extends i{static makeAssertMessage(e){return`ResolvablePromiseWithBoundedSubscribers should not pass a limited amount of ${e} active subscribers when not settled`}settle(){this.isSettled=!0}then(e,t){return(0,n.assertTrue)(o.makeAssertMessage(this.limit),this.isSettled||this.currentSubscribers++<this.limit),super.then(e,t)}constructor(e){super(),this.limit=e,this.currentSubscribers=0,this.isSettled=!1,super.then(this.settle.bind(this),this.settle.bind(this))}}function s(e){return(0,a.isDefined)(e)&&"function"==typeof e.then}t.ResolvablePromiseWithLimitedSubscribers=o,t.ResolvablePromiseWithSyncValue=class extends i{getCurrentValue(){return this.value}resolve(e){return s(e)||this.isUninitialized&&(this.value=e,this.isUninitialized=!1),super.resolve(e)}constructor(){super(),this.value=void 0,this.isUninitialized=!0,this.then((e=>this.value=e))}},t.ResolvablePromiseWithTimeout=class extends i{constructor(e,t){super(),t.setTimeout((()=>{const e=new Error("Promise timeout");e.name="TimeoutError",this.reject(e)}),e)}},t.promiseFinally=function(e,t){return e.then((e=>(t(),e)),(e=>(t(),Promise.reject(e))))},t.newPromise=function(){let e;return[new Promise(((t,r)=>e=[t,r])),e]},t.promiseLoop=function(e,t){let r;return new Promise(((n,a)=>{Promise.resolve(t).then((function t(i){if(void 0!==i){r=i;try{Promise.resolve(e(r)).then(t,a)}catch(e){a(e)}}else n(r)}),a)}))},t.isThenable=s,t.bindMaybeThenable=function(e,t,r){return s(e)?e.then(t,r):t(e)},t.collapseThenable=function(e){return e},t.MaybeThenable={all(e){const t=new Array(e.length),r=new i;let n=0;return e.forEach(((a,i)=>{s(a)?a.then((a=>{t[i]=a,++n===e.length&&r.resolve(t)}),(e=>{r.reject(e)})):t[i]=a})),r},any(e){const t=new i;return e.forEach(((e,r)=>{s(e)?e.then((e=>{t.resolve({result:e,resolvedIndex:r})}),(e=>{t.reject(e)})):t.resolve({result:e,resolvedIndex:r})})),t}}},7785:function(e,t){"use strict";var r,n;function a(e){return{kind:r.Success,value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.javaScriptError=t.ReasonKind=t.isSuccess=t.failure=t.successUndefined=t.success=t.ResultKind=void 0,function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused",e.Breaked="Breaked"}(r||(t.ResultKind=r={})),t.success=a,t.successUndefined=a(void 0),t.failure=function(e){return{kind:r.Failure,reason:e}},t.isSuccess=function(e){return e.kind===r.Success},function(e){e.JavaScriptError="JavaScriptError"}(n||(t.ReasonKind=n={})),t.javaScriptError=function(e){return{kind:n.JavaScriptError,error:e}}},9584:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VoidMachine=t.AllMachine=t.MachineRuntime=t.MachineCycle=t.nextOnSuccessReceiver=t.callMachineTransition=t.breakTransition=t.nextTransition=t.TransitionKind=void 0;const n=r(7785);var a;function i(e,t,r){return{kind:e,machine:t,receiver:r}}function o(e,t){return i(a.CallMachine,e,t)}!function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine",e[e.Break=3]="Break"}(a||(t.TransitionKind=a={})),t.nextTransition=i(a.Next,void 0,void 0),t.breakTransition=i(a.Break,void 0,void 0),t.callMachineTransition=o;const s={receiveResult:e=>(0,n.isSuccess)(e)?t.nextTransition:e};t.nextOnSuccessReceiver=function(){return s};class u extends Error{constructor(e,t){super("Cycle detected: tried to call an already-running Machine"),this.machine=e,this.stackDepth=t}}t.MachineCycle=u;class l{static resetStats(){l.maxStackDepth=0,l.numPauses=0,l.numCycles=0}pushFrame(e){const t=this.stack.length,r=e.machine;if(!0===r.runStatus)throw l.numCycles+=1,new u(r,t);!1===r.runStatus&&(r.runStatus=!0),this.stack.push(e),l.maxStackDepth<t+1&&(l.maxStackDepth=t+1)}advanceTopFrame(){const e=this.stack[this.stack.length-1].machine;return"boolean"!=typeof e.runStatus?e.runStatus:e.next()}step(){this.numSteps+=1;const e=this.transition;try{switch(e.kind){case a.Next:return this.transition=this.advanceTopFrame(),t.nextTransition;case a.CallMachine:return this.pushFrame(e),this.transition=this.advanceTopFrame(),t.nextTransition;case a.Break:return this.transition=t.nextTransition,e;default:const r=this.stack.pop();return r?(r.machine.runStatus=e,this.transition=r.receiver.receiveResult(e),t.nextTransition):e}}catch(e){return this.transition=(0,n.failure)((0,n.javaScriptError)(e)),t.nextTransition}}run(e=(()=>!1)){if(this.result)return this.result;try{for(;;){const t=this.step();if(t.kind===a.Break)return t;if(t.kind!==a.Next)return this.result=t;if(e())return l.numPauses+=1,t}}catch(e){return this.result=(0,n.failure)((0,n.javaScriptError)(e))}}runToResult(){for(;;){const e=this.run();if(e.kind!==a.Break)return e}}constructor(e){this.numSteps=0,this.stack=[];try{this.pushFrame(o(e,{receiveResult:e=>e})),this.transition=t.nextTransition}catch(e){this.transition=(0,n.failure)((0,n.javaScriptError)(e))}}}t.MachineRuntime=l,l.maxStackDepth=0,l.numPauses=0,l.numCycles=0,t.AllMachine=class{next(){return this.values.length<this.machines.length?o(this.machines[this.values.length],this):(0,n.success)(this.values)}receiveResult(e){return(0,n.isSuccess)(e)?(this.values.push(e.value),this.next()):e}constructor(e){this.machines=e,this.runStatus=!1,this.values=[]}},t.VoidMachine=class{next(){return o(this.machine,this)}receiveResult(e){return(0,n.isSuccess)(e)?n.successUndefined:e}constructor(e){this.machine=e,this.runStatus=!1}}},1324:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;const n=r(9584),a=r(7785);class i{setState(e,t,r){return this.onFulfilled=t,this.onRejected=r,this.transition=e,e}next(){return this.transition instanceof i?this.transition=(0,n.callMachineTransition)(this.transition,this):this.transition}receiveResult(e){let t;try{if((0,a.isSuccess)(e)){if(!this.onFulfilled)return this.setState(e,void 0,void 0);t=this.onFulfilled(e.value)}else{if(!this.onRejected)return this.setState(e,void 0,void 0);t=this.onRejected(e.reason)}}catch(e){return this.setState((0,a.failure)((0,a.javaScriptError)(e)),void 0,void 0)}return t instanceof i?(this.setState(t.transition,t.onFulfilled,t.onRejected),t.setState(this,void 0,void 0),this.next()):this.setState((0,a.success)(t),void 0,void 0)}bind(e){return new i(this,e,void 0)}catch(e){return new i(this,void 0,e)}finally(e){return new i(this,(t=>(e(),t)),(t=>(e(),i.reject(t))))}static all(e){return i.fromMachine(new n.AllMachine(e.map(i.resolve)))}settle(){return new n.MachineRuntime(this).runToResult()}static settleOrThrow(e){const t=e.settle();if((0,a.isSuccess)(t))return t.value;throw t.reason.error}constructor(e,t,r){this.transition=e,this.onFulfilled=t,this.onRejected=r,this.runStatus=!(e instanceof i||e.kind===n.TransitionKind.CallMachine)&&e}}t.Pledge=i,i.resolve=e=>e instanceof i?e:new i((0,a.success)(e),void 0,void 0),i.reject=e=>new i((0,a.failure)(e),void 0,void 0),i.undefinedPledge=i.resolve(void 0),i.fromMachine=e=>{if(e instanceof i)return e;const t=new i(i.undefinedPledge,void 0,void 0);return t.transition=(0,n.callMachineTransition)(e,t),t},i.try=e=>i.undefinedPledge.bind(e),i.RepeatMachine=class{next(){const e=this.onLoop(this.accum);return e instanceof i?(0,n.callMachineTransition)(e,this):this.receiveSuccess(e)}receiveResult(e){return(0,a.isSuccess)(e)?this.receiveSuccess(e.value):e}receiveSuccess(e){return void 0===e?(0,a.success)(this.accum):(this.accum=e,n.nextTransition)}constructor(e,t){this.onLoop=e,this.accum=t,this.runStatus=!1}},i.repeat=(e,t)=>i.resolve(t).bind((t=>i.fromMachine(new i.RepeatMachine(e,t))))},2376:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetTimeoutInterface=t.clearTimerUnified=t.setImmediateUnified=void 0;const n=r(9001),a=r(1444);function i(e,...t){return{kind:"Immediate",timer:(0,a.setImmediate)(e,...t)}}function o(e){switch(e.kind){case"Immediate":(0,a.clearImmediate)(e.timer);break;case"Timeout":clearTimeout(e.timer);break;case"Mocking":e.delayedCallback.isValid=!1;break;default:(0,n.assertNever)("unknown timer.kind",e)}}t.setImmediateUnified=i,t.clearTimerUnified=o,t.defaultSetTimeoutInterface={setImmediate:i,setTimeout:function(e,t,...r){return{kind:"Timeout",timer:setTimeout(e,t,...r)}},clearImmediate:o,clearTimeout:o}},4729:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatch=t.ulsStopwatchFactory=void 0;const n=r(4068),a={ULS:new n.NulLogger};t.ulsStopwatchFactory=(0,n.initStopwatchFactory)((e=>a.ULS.traceTag(595948114,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e))),t.initStopwatch=function(e){a.ULS=e}},477:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeIsInClass=t.forEachClassInterval=t.codePointIterator=t.codePointIteratorNew=t.numCodeUnits=t.stringCodePointAt=t.countCodePoints=t.scanCodePointsBack=t.scanCodePoints=t.stringFromCodePoint=t.surrogatePairToCodePoint=t.isAnySurrogate=t.isLowSurrogate=t.isHighSurrogate=void 0;const n=r(4563),a=r(3472),i=55296,o=56320,s=65533;function u(e){return(64512&e)===i}function l(e){return(64512&e)===o}function c(e){return 55296==(63488&e)}function d(e,t){if(u(e)&&l(t))return 65536+((1023&e)<<10|1023&t)}function g(e,t){const r=e.charCodeAt(t);return c(r)?t+1>=e.length?s:d(r,e.charCodeAt(t+1))??s:r}function m(e){return e>=65536?2:1}function*h(e,t=0){let r=t;for(;r<e.length;){const t=g(e,r);yield t,r+=m(t)}}function p(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(let r=0;r<e.length;r+=2)t(e[r],e[r+1])}t.isHighSurrogate=u,t.isLowSurrogate=l,t.isAnySurrogate=c,t.surrogatePairToCodePoint=d,t.stringFromCodePoint=function(e){if(e<=65535)return String.fromCharCode(e);const t=e-65536;return String.fromCharCode(t>>10|i,1023&t|o)},t.scanCodePoints=function(e,t,r){let n=t;for(let t=0;t<r;t+=1){if(n>=e.length)return;u(e.charCodeAt(n))&&n+1<e.length&&l(e.charCodeAt(n+1))?n+=2:n+=1}return n},t.scanCodePointsBack=function(e,t,r){let n=t;for(let t=0;t<r;t+=1){if(n-1<0)return;l(e.charCodeAt(n-1))&&n-2>=0&&u(e.charCodeAt(n-2))?n-=2:n-=1}return n},t.countCodePoints=function(e,t,r){let n=0;for(let a=t;a<r;n+=1)u(e.charCodeAt(a))&&a+1<r&&l(e.charCodeAt(a+1))?a+=2:a+=1;return n},t.stringCodePointAt=g,t.numCodeUnits=m,t.codePointIteratorNew=h,t.codePointIterator=function(e,t=0){if((0,a.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ES6CodepointIterator"))return h(e,t);const r=[];let n=t;for(;n<e.length;){const t=g(e,n);r.push(t),n+=m(t)}return r},t.forEachClassInterval=p;t.makeIsInClass=function(e){const t=function(e){const t=[];for(let e=0;e<512;++e)t.push([]);return p(e,((e,r)=>{const a=r-1>>7;for(let i=e>>7;i<=a;++i){const a=i<<7,o=i+1<<7;t[i].push((0,n.fastMax)(e,a),(0,n.fastMin)(r,o))}})),t}(e);return e=>{if(e<0||e>65535)return!1;const r=t[e>>>7];for(let t=0;t<r.length;t+=2){const n=r[t],a=r[t+1];if(e>=n&&e<a)return!0}return!1}}},3056:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prependErrorMessage=t.messageFromError=t.partialArray=void 0;const n=r(2360);t.partialArray=function(e){const t=[];return Object.keys(e).map(Number).forEach((r=>t[r]=e[r])),t},t.messageFromError=function(e){if(null==e||"object"!=typeof e)return(0,n.anonymize)(e);const t=e,r=String(t.name),a=String(t.message);if(null!=t.stack){const e=String(t.stack);return e.indexOf(a)>=0&&e.indexOf(r)>=0?e:`${r}: ${a}\n${e}`}return a.indexOf(r)>=0?a:`${r}: ${a}`},t.prependErrorMessage=function(e,t){if(null==e||"object"!=typeof e)return e;const r=e;return r.message=`${t} ${String(r.message)}`,r}},3204:function(e,t){"use strict";function r(){return e=>function(e){const t=class{constructor(e){this.obj=e}};for(const r of e)t.prototype[r]=function(...e){const t=this.obj[r](...e);return Promise.resolve(t)};return t}(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoAsync=t.wrapIntoAsyncClass=void 0,t.wrapIntoAsyncClass=r,t.wrapIntoAsync=function(e,t){return new(r()(t))(e)}},5093:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1948:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3345);n.__exportStar(r(5093),t),n.__exportStar(r(8061),t),n.__exportStar(r(5106),t)},8061:function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.DateOrder=t.CurrencyFormat=void 0,function(e){e.Paren="Paren",e.Lead="Lead",e.Intern="Intern",e.Trail="Trail"}(r||(t.CurrencyFormat=r={})),function(e){e.MDY="MDY",e.DMY="DMY",e.YMD="YMD",e.MYD="MYD",e.DYM="DYM",e.YDM="YDM"}(n||(t.DateOrder=n={}))},5106:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3428:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOrigin=void 0;const n=r(3292),a=r(2701),i=r(3803),o=r(276),s=r(5096),u=r(6366),l=r(6366),c=r(6366),d=r(6366),g=r(3563),m=r(2060),h=r(3309);function p(e,t,r,n){if(r.kind===a.PosKind.Abs)return r;const i=(0,s.wrapPosition)(e,r.index,n)-t;return i===r.index?r:(0,a.pos)(a.PosKind.Rel,i)}function f(e,t,r,i){const s=p(t.row,r.row,i.row,n.sheetRows),u=p(t.col,r.col,i.col,n.sheetCols),l=(0,o.canonicaliseBrackets)(e,s)||(0,o.canonicaliseBrackets)(e,u);return(0,a.cellRefSingle)(s,u,l,i.label)}function S(e,t,r,i){switch(i.kind){case a.CellRefKind.Error:case a.CellRefKind.Bad:return i;case a.CellRefKind.Single:return f(e,t,r,i);case a.CellRefKind.Range:{const n=f(e,t,r,i.ref1),o=f(e,t,r,i.ref2);return n===i.ref1&&o===i.ref2?i:(0,a.cellRefRange)(n,o,i.label)}case a.CellRefKind.Row:{const s=p(t.row,r.row,i.row1,n.sheetRows),u=p(t.row,r.row,i.row2,n.sheetRows),l=(0,o.canonicaliseBrackets)(e,s)||(0,o.canonicaliseBrackets)(e,u);return(0,a.cellRefRow)(s,u,l,i.label)}case a.CellRefKind.Col:{const s=p(t.col,r.col,i.col1,n.sheetCols),u=p(t.col,r.col,i.col2,n.sheetCols),l=(0,o.canonicaliseBrackets)(e,s)||(0,o.canonicaliseBrackets)(e,u);return(0,a.cellRefCol)(s,u,l,i.label)}}}const v=(0,i.createFailureErrorClass)("TransformRefsError");class F extends h.IdentityVisitor{nameNode(e,t,r){const n=(0,a.nameNode)(e,t,r),{headResolved:i,fieldsResolved:o}=this.resolver.resolveDottedName(this.locals,n,this.annotations),s=(0,a.flattenNameParts)(e).parts;if((0,m.canDenoteCellRef)(this.locals,t,s)){const[e,n,...u]=s;if(i.kind===g.ResolvedKind.ResolvedCellRef){(0,d.assertTrue)("calc.analyze.adjustFormulaOrigin: all flattened field parts resolved",s.length===1+o.length);const l=this.fn(e.ref);if(l.kind===a.CellRefKind.Single||l.kind===a.CellRefKind.Row||l.kind===a.CellRefKind.Col){const i=(e,t)=>(0,a.fieldRefNamePart)(e,t.rhs,t.canDenoteNamedObject,t.label,t.qualifiedLabel);return(0,a.nameNode)(u.reduce(i,i((0,a.cellRefNamePart)(l,e.asWhole,e.label,e.qualifiedLabel),n)),t,r)}const c=(e,{rhs:t,qualifiedLabel:r})=>(0,a.fieldRefNode)(e,t,r);return u.reduce(c,c((0,a.cellRefNode)(l,i.node.qualifier,i.node.label),n))}if(i.resolution.kind!==c.ResultKind.Success&&i.resolution.reason.kind!==g.ResolveReasonKind.NoOriginSheet&&i.resolution.reason.kind!==g.ResolveReasonKind.InvalidQualifier)throw new v(i.resolution.reason)}return n}cellRefNode(e,t,r){return(0,a.cellRefNode)(this.fn(e),t,r)}constructor(e,t,r,n){super(),this.fn=e,this.locals=r,this.annotations=n,this.resolver=(0,m.createResolver)(t)}}t.adjustFormulaOrigin=function(e,t,r,n){const a=t.originGridCell.value;if((0,i.isGridCellEqual)(a,r))return(0,u.success)(n);try{const i=(0,h.reduceBottomUp)(new F(S.bind(void 0,e.config.refStyle,a,r),e,t,n.annotations),n);return(0,u.success)({...n,node:i})}catch(e){if(e instanceof v)return(0,l.failure)(e.reason);throw e}}},9525:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(8478),s=r(2701),u=r(3803),l=r(3309);class c extends l.PledgeReducer{appNode(e,t,r,n){return i.Pledge.try((()=>(e.kind===s.NodeKind.Name&&(this.annotations[e.label]=s.appHeadNameAnnotation),super.appNode(e,t,r,n))))}letNode(e,t,r,a){const s=e.id===o.WorksheetFuncId.LETREC||e.id!==o.WorksheetFuncId.LET&&(0,n.assertFalse)("calc.lang.buildAnnotations"),u=this.bindNames(t),c=u[t.length];return this.lazyVisitAppHeadNode(e).bind((e=>s?i.Pledge.all(t.map((({binder:e})=>i.Pledge.try((()=>(0,l.visitFormulaNode)(c,e.arg)))))):i.Pledge.all(t.map((({binder:e},t)=>{const r=u[t];return i.Pledge.try((()=>(0,l.visitFormulaNode)(r,e.arg)))}))))).bind((e=>void 0===r?void 0:(0,l.visitFormulaNode)(c,r.arg))).bind((e=>i.Pledge.all(a.map((e=>i.Pledge.try((()=>(0,l.visitFormulaNode)(this,e.arg)))))))).bind((e=>{}))}lambdaNode(e,t,r,n){const a=this.bindNames(t),o=a[t.length];return this.lazyVisitAppHeadNode(e).bind((e=>i.Pledge.all(t.map((({name:e},t)=>{if(void 0===e.arg.def)return i.Pledge.resolve(void 0);const r=a[t],n=e.arg.def;return i.Pledge.try((()=>(0,l.visitFormulaNode)(r,n.rhs)))}))))).bind((e=>void 0===r?void 0:(0,l.visitFormulaNode)(o,r.arg))).bind((e=>i.Pledge.all(n.map((e=>i.Pledge.try((()=>(0,l.visitFormulaNode)(this,e.arg)))))))).bind((e=>{}))}bindNames(e){const t=[this];return e.reduce(((e,{name:r})=>{if(void 0===r.arg.wholeName)return t.push(new c(this.localeInfo,this.annotations,e)),e;const n=(0,u.getBoundName)(this.localeInfo,r.arg.wholeName),a=e.setValue(n,r.arg);return t.push(new c(this.localeInfo,this.annotations,a)),this.annotations[r.arg.label]=(0,s.localNameDeclAnnotation)(n,r.arg.wholeName),a}),this.names),t}nameNode(e,t,r){return i.Pledge.try((()=>{if(void 0===t){const t=(0,s.headNamePart)(e),r=this.names.getEntry((0,u.getBoundName)(this.localeInfo,t.asWhole));void 0===r||(r.value.kind===s.NodeKind.ContextName?this.annotations[t.label]=(0,s.localNameUseAnnotation)(r.key,r.value.whole,r.value.label):(this.annotations[t.label]=(0,s.localNameUseAnnotation)(r.key,r.value.wholeName,r.value.label),this.annotations[r.value.label].uses.push({label:t.label})))}return super.nameNode(e,t,r)}))}constructor(e,t,r){super(l.voidVisitor),this.localeInfo=e,this.annotations=t,this.names=r}}t.buildAnnotations=function(e,t,r,n){const i=[];return(0,l.reduceTopDown_Pledge)(new c(e,i,(r??[]).reduce(((t,r)=>{const n=(0,u.getBoundName)(e,r.whole);return t.setValue(n,r)}),a.RedBlackMapTree.create(e.stringCompareCI))),t),i[t.label]=(0,s.formulaRootAnnotation)(r,n),i}},276:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatName=t.formatGridRange=t.quoteQualifier=t.formatQualifier=t.shouldQuoteQualifier=t.canonicaliseRangePos=t.formatRangePos=t.canonicaliseCellPos=t.formatCellPos=t.canonicaliseColRange=t.canonicaliseRowRange=t.formatColRange=t.formatRowRange=t.canonicaliseCol=t.canonicaliseRow=t.formatCol=t.formatRow=t.resolvePosition=t.canonicaliseBrackets=t.columnName=void 0;const n=r(3292),a=r(2701),i=r(5096),o=r(6366),s=r(6366),u=r(6366),l=r(6366),c=r(6366),d=r(6366),g=(0,a.pos)(a.PosKind.Abs,0),m=(0,a.pos)(a.PosKind.Abs,n.sheetRows-1),{codePointCapitalA:h,codePointFullStop:p}=s.codePoint;function f(e){let t=e+1,r="";for(;t>0;){const e=(t-1)%26;r=String.fromCharCode(h+e)+r,t=Math.floor((t-e)/26)}return r}function S(e,t,r,n){if(t.kind===a.PosKind.Abs)return t.index;if(n)return(0,i.wrapPosition)(e,t.index,r);const o=e+t.index;return 0<=o&&o<r?o:void 0}function v(e,t,r,n,i,o){const s=S(r,n,i,o);if(void 0===s)return;if(n.kind===a.PosKind.Abs)return t+(s+1).toFixed();const u=s-r;return 0===u?t:t+e.rcLeftBracket+u.toFixed()+e.rcRightBracket}function F(e,t,r,i,o){return t===a.RefStyle.A1?function(e,t,r){const i=S(e,t,n.sheetRows,r);if(void 0===i)return;const o=(i+1).toFixed();return t.kind===a.PosKind.Abs?"$"+o:o}(r,i,o):v(e,e.rowLetter,r,i,n.sheetRows,o)}function y(e,t,r,i,o){return t===a.RefStyle.A1?function(e,t,r){const i=S(e,t,n.sheetCols,r);if(void 0===i)return;const o=f(i);return t.kind===a.PosKind.Abs?"$"+o:o}(r,i,o):v(e,e.columnLetter,r,i,n.sheetCols,o)}function b(e,t,r,n){if(r.kind===a.PosKind.Abs)return r;const i=S(t,r,e,n);if(void 0===i)return;const o=i-t;return o===r.index?r:(0,a.pos)(a.PosKind.Rel,o)}function C(e,t,r,n,a){const i=S(e,t,n,a),o=S(e,r,n,a);if(void 0!==i&&void 0!==o)return i<=o?[t,r,i,o]:[r,t,o,i]}function A(e,t,r,n,i,o,s,u,l){const c=C(o,s,u,r,l);if(void 0===c)return;const[d,g,m,h]=c;if(void 0!==t&&0===m&&h===r-1&&s.kind===u.kind)return t(n,i,l);const p=e(n,i,o,d,l);if(void 0===p)return;if(i===a.RefStyle.R1C1&&d.kind===g.kind&&d.index===g.index)return p;const f=e(n,i,o,g,l);return void 0!==f?p+":"+f:void 0}function E(e,t,r,n,a,i){const o=C(r,n,a,t,i);if(void 0===o)return;const[s,u,l,c]=o;if(void 0!==e&&0===l&&c===t-1&&n.kind===a.kind)return e;const d=b(t,r,s,i),g=b(t,r,u,i);return void 0!==d&&void 0!==g?[!1,d,g]:void 0}function T(e,t,r,n,i,o){const s=F(e,t,r.row,n,o),u=y(e,t,r.col,i,o);if(void 0!==s&&void 0!==u)return t===a.RefStyle.A1?u+s:s+u}function R(e,r,a,i,o,s,u,l){const c=C(a.row,i,s,n.sheetRows,l),d=C(a.col,o,u,n.sheetCols,l);if(void 0===c||void 0===d)return;const[g,m,h,p]=c,[f,S,v,F]=d;if(0===v&&F===n.sheetCols-1&&o.kind===u.kind)return(0,t.formatRowRange)(e,r,a.row,g,m,l);if(0===h&&p===n.sheetRows-1&&i.kind===s.kind)return(0,t.formatColRange)(e,r,a.col,f,S,l);const y=T(e,r,a,g,f,l),b=T(e,r,a,m,S,l);return void 0!==y&&void 0!==b?y+":"+b:void 0}function k(e,t){return t===p||e.isIdentContinue(t)}t.columnName=f,t.canonicaliseBrackets=function(e,t){return e===a.RefStyle.R1C1&&t.kind===a.PosKind.Rel&&0!==t.index},t.resolvePosition=S,t.formatRow=F,t.formatCol=y,t.canonicaliseRow=b.bind(void 0,n.sheetRows),t.canonicaliseCol=b.bind(void 0,n.sheetCols),t.formatRowRange=A.bind(void 0,F,void 0,n.sheetRows),t.formatColRange=A.bind(void 0,y,((e,r,n)=>(0,t.formatRowRange)(e,r,0,g,m,n)),n.sheetCols),t.canonicaliseRowRange=E.bind(void 0,void 0,n.sheetRows),t.canonicaliseColRange=E.bind(void 0,[!0,g,m],n.sheetCols),t.formatCellPos=T,t.canonicaliseCellPos=function(e,r,n,a){const i=(0,t.canonicaliseRow)(e.row,r,a),o=(0,t.canonicaliseCol)(e.col,n,a);if(void 0!==i&&void 0!==o)return{row:i,col:o}},t.formatRangePos=R,t.canonicaliseRangePos=function(e,r,a,i,o,s){const u=C(e.row,r,i,n.sheetRows,s),l=C(e.col,a,o,n.sheetCols,s);if(void 0===u||void 0===l)return;const[c,d,g,m]=u,[h,p,f,S]=l,v=(0,t.canonicaliseRow)(e.row,c,s),F=(0,t.canonicaliseCol)(e.col,h,s),y=(0,t.canonicaliseRow)(e.row,d,s),b=(0,t.canonicaliseCol)(e.col,p,s);return void 0!==v&&void 0!==F&&void 0!==y&&void 0!==b?0===f&&S===n.sheetCols-1&&a.kind===o.kind?{row1:v,row2:y,col1:void 0,col2:void 0}:0===g&&m===n.sheetRows-1&&r.kind===i.kind?{col1:F,col2:b,row1:void 0,row2:void 0}:{row1:v,col1:F,row2:y,col2:b}:void 0};const N=/'/g;function I(e,t){if(0===t.length)return!1;let r=0;const n=(0,c.stringCodePointAt)(t,r);if(!e.isIdentStart(n))return!1;r+=(0,l.numCodeUnits)(n);for(const n of(0,u.codePointIterator)(t,r))if(!k(e,n))return!1;return!0}const O=(0,n.gridCell)(0,0);function P(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;const n=(0,i.parseCellRef)(e,t,O,r,0);if(void 0!==n)if(n.refStyle===a.RefStyle.A1){const{i:t}=n;if(t>=r.length&&void 0===e.getWorksheetFuncId(r.substring(0,t)))return!0}else if(!(0,i.isR1C1IdentStart)(n.row,n.col))return!0;return!I(e,r)&&!function(e,t){let r=0;if(!(0,d.stringStartsWith)(t,e.leftBracket,r))return!1;if(r+=e.leftBracket.length,r===t.length)return!1;const n=(0,c.stringCodePointAt)(t,r);if(!k(e,n))return!1;for(r+=(0,l.numCodeUnits)(n);;){if((0,d.stringStartsWith)(t,e.rightBracket,r)){r+=e.rightBracket.length;break}if(r===t.length)return!1;const n=(0,c.stringCodePointAt)(t,r);if(!k(e,n))return!1;r+=(0,l.numCodeUnits)(n)}const a=t.indexOf(":",r);return a<0?I(e,t.substring(r)):I(e,t.substring(r,a))&&I(e,t.substring(a+1))}(e,r)&&!function(e,t){const r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&t.substring(0,r)===e.leftBracket&&t.substring(t.length-n)===e.rightBracket&&I(e,t.substring(r,t.length-n))}(e,r)}function M(e,t,r){return P(e,t,r)?D(r):r}function D(e){return`'${e.replace(N,"''")}'`}t.shouldQuoteQualifier=P,t.formatQualifier=M,t.quoteQualifier=D,t.formatGridRange=function(e,t,r=a.RefStyle.A1,i,s){const u=1===t.cols&&1===t.rows?T(e,r,(0,n.gridCell)(0,0),(0,a.pos)(a.PosKind.Rel,t.row),(0,a.pos)(a.PosKind.Rel,t.col),!1):R(e,r,(0,n.gridCell)(0,0),(0,a.pos)(a.PosKind.Rel,t.row),(0,a.pos)(a.PosKind.Rel,t.col),(0,a.pos)(a.PosKind.Rel,t.row+t.rows-1),(0,a.pos)(a.PosKind.Rel,t.col+t.cols-1),!1);if((0,o.assertTrue)("calc.lang.formatGridRange",void 0!==u),void 0===i&&void 0===s)return u;if(void 0===i||void 0===s)return M(e,r,i??s)+"!"+u;const l=i+":"+s;return(P(e,r,i)||P(e,r,s)?D(l):l)+"!"+u},t.formatName=function(e,t,r=a.RefStyle.A1,n){return void 0===n?t:M(e,r,n)+"!"+t}},5096:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;const n=r(3292),a=r(6366),i=r(6366),o=r(2701),s=r(8445),u=r(6366),l=r(6366),c=r(6366),d=r(6366),g=n.sheetRows,m=g.toString(10).length,h=n.sheetCols,p=h.toString(26).length,f=h.toString(10).length,{codePointCapitalA:S,codePointCapitalZ:v,codePointSmallA:F,codePointSmallZ:y,codePointPlusSign:b,codePointMinusSign:C,codePointColon:A}=u.codePoint;function E(e){return e>=F&&e<=y||e>=S&&e<=v}function T(e){return 1+(e>=F?e-F:e-S)}function R(e,t,r,n){return function(a,i,s,u,l){const[g,m]=function(e,t){return(0,c.stringStartsWith)(e,"$",t)?[o.PosKind.Abs,t+1]:[o.PosKind.Rel,t]}(s,u),[h,p]=e(a,r,s,m);if(p>m){if(h<1||h>t)return g===o.PosKind.Abs||(!0===n?"object"==typeof l&&l.kind===o.PosKind.Abs||l===_.A1BadDollar:(0,c.stringStartsWith)(s,"$",p))?[_.A1BadDollar,!0,p]:void 0;const e=g===o.PosKind.Rel?h-i:h;return[(0,o.pos)(g,e-1),g===o.PosKind.Abs,p]}return g!==o.PosKind.Abs||!0!==n&&p!==s.length&&a.isNumeral((0,d.stringCodePointAt)(s,p))?[void 0,!1,u]:[_.A1BadDollar,!0,p]}}function k(e,t,r){return K(e,t,r)-e}function N(e,t,r,n){return function(a,i,u,l){const d=t?e?"R":a.rowLetter:e?"C":a.columnLetter;if(l>=u.length||0!==a.stringCompareCI(d,u[l]))return[void 0,!1,l];let g=l+d.length;const[m,h]=(0,s.parseUint)(a,n,u,g);if(h>g&&m>=1&&m<=r)return[(0,o.pos)(o.PosKind.Abs,m-1),!1,h];if((0,c.stringStartsWith)(u,a.rcLeftBracket,g)){if(g+=a.rcLeftBracket.length,(0,c.stringStartsWith)(u,a.rcRightBracket,g))return[(0,o.pos)(o.PosKind.Rel,k(i,0,r)),!0,g+a.rcRightBracket.length];let e=1;const t=u.charCodeAt(g);t===b?g+=1:t===C&&(e=-1,g+=1);const[l,d]=(0,s.parseUint)(a,n,u,g);if(d>g&&l<r&&(0,c.stringStartsWith)(u,a.rcRightBracket,d))return[(0,o.pos)(o.PosKind.Rel,k(i,l*e,r)),!0,d+a.rcRightBracket.length]}return[_.RCNoNum,!1,l+d.length]}}function I(e,t,r,n,a,i,o){const s=n(e,t,i,o,void 0);if(null==s)return[void 0,void 0,o];const[u,l,c]=s;if(c>o){const t=a(e,r,i,c,u);if(null==t)return l?[u,void 0,c]:[void 0,void 0,o];const[n,,s]=t;return s>c?[u,n,s]:[u,void 0,c]}const d=a(e,r,i,o,u);if(null==d)return[void 0,void 0,o];const[g,,m]=d;return m>o?[void 0,g,m]:[void 0,void 0,o]}const O=R(s.parseUint,g,m,!0),P=R(((e,t,r,n)=>function(e,t,r){let n=0,i=r;const o=(0,a.fastMin)(t.length,r+e);for(;i<o;i+=1){const e=t.charCodeAt(i);if(!E(e))break;n=26*n+T(e)}return i===o&&i<t.length&&E(t.charCodeAt(i))?[0,r]:[n,i]}(t,r,n)),h,p,!1),M=N(!1,!0,g,m),D=N(!1,!1,h,f),w=N(!0,!0,g,m),L=N(!0,!1,h,f);var _;function x(e,t){return"object"!=typeof e&&"object"!=typeof t}function K(e,t,r){return e+t&r-1}!function(e){e[e.RCNoNum=0]="RCNoNum",e[e.A1BadDollar=1]="A1BadDollar"}(_||(t.SpecialPos=_={})),t.isR1C1IdentStart=x,t.parseCellRef=function(e,t,r,n,a){const i=function(e,t,r,n,a){const{col:i,row:s}=r,[u,l,c]=I(e,i,s,P,O,n,a),g="object"==typeof l&&l.kind===o.PosKind.Abs||l===_.A1BadDollar||"object"==typeof u&&u.kind===o.PosKind.Abs||u===_.A1BadDollar;if(null!=l&&null!=u||g||(null!=l||null!=u)&&(a-1>=0&&n.charCodeAt(a-1)===A||c<n.length&&n.charCodeAt(c)===A)){if(c<n.length&&e.isIdentContinue((0,d.stringCodePointAt)(n,c)))return;if(t!==o.RefStyle.A1&&!g)return;return{refStyle:o.RefStyle.A1,row:l,col:u,i:c}}}(e,t,r,n,a);return void 0!==i?i:function(e,t,r,n,a){const{col:i,row:s}=r;let u=!1,[l,c,g]=I(e,s,i,M,D,n,a);if(null!=l||null!=c||"R"===e.rowLetter&&"C"===e.columnLetter||(u=!0,[l,c,g]=I(e,s,i,w,L,n,a)),(null!=l||null!=c)&&(g>=n.length||!x(l,c)||!e.isIdentContinue((0,d.stringCodePointAt)(n,g))))return{refStyle:o.RefStyle.R1C1,row:l,col:c,i:g,enLocale:u}}(e,0,r,n,a)},t.parseGridCellA1=function(e,t){const[r,a,i]=I(e,0,0,P,O,t,0);return"object"==typeof r&&"object"==typeof a&&i===t.length?(0,n.gridCell)(a.index,r.index):void 0},t.parseGridRangeA1=function(e,t){const[r,o,s]=I(e,0,0,P,O,t,0);if("object"!=typeof r||"object"!=typeof o)return;if(s===t.length)return(0,n.gridCell)(o.index,r.index);if(t.charCodeAt(s)!==A)return;const[u,l,c]=I(e,0,0,P,O,t,s+1);if("object"!=typeof u||"object"!=typeof l)return;if(c!==t.length)return;const d=(0,a.fastMin)(o.index,l.index),g=(0,a.fastMin)(r.index,u.index);return(0,n.gridRange)(d,g,(0,i.fastMax)(o.index,l.index)+1-d,(0,i.fastMax)(r.index,u.index)+1-g)},t.parseQualifier=function(e){const t=e.lastIndexOf("!");if(t<0||0===t||t===e.length-1)return;const r=e.substring(0,t),n=e.substring(t+1);if(r.indexOf("'")<0)return{qualifier:r,unqualified:n};if(!(0,c.stringStartsWith)(r,"'")||!(0,l.stringEndsWith)(r,"'"))return;const a=[];for(let e=1;e<r.length-1;++e){const t=r.charAt(e);if("'"===t){if(e+1>=r.length-1||"'"!==r.charAt(e+1))return;a.push(t),++e}else a.push(t)}return{qualifier:a.join(""),unqualified:n}},t.wrapPosition=K},537:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEnglishLocaleInfo=t.createIsThousandsPositionCallback=t.createWorksheetFuncNameCallbacks=t.getEnglishWorksheetFuncIdToName=t.operatorIdToName=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishPictureDbnum=t.englishPictureColor=t.englishPictureSingle=t.englishPictureSpecial=t.englishSpecialRefNames=t.englishErrorNames=t.isIdentContinue=t.isIdentStart=t.getNumberShape=t.getOrdinal=t.isNumeral=t.LCID=t.Country=t.localeInfo=t.calcConfig=t.ulsLogger=t.NulLogger=t.TraceLevel=t.LogCategory=t.PictureSingle=t.PictureSpecial=t.PictureDbnum=t.PictureColor=void 0;const n=r(4068);Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return n.LogCategory}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return n.TraceLevel}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return n.NulLogger}});const a=r(6366),i=r(6366),o=r(6366);Object.defineProperty(t,"ulsLogger",{enumerable:!0,get:function(){return o.ulsLogger}});const s=r(6366),u=r(5005),l=r(6366),c=r(1516),d=r(6366),g=r(8610),m=r(2701),h=r(4304),p=r(9582),f=r(4656),S=r(7630);function v(e,t,r,n,a,i,o,s,u,l,c,d,g,m,h,p,f,S,v,F,y,b,C,A,E,T,R,k,N,I,O,P,M,D,w,L,_,x,K,W,U,G,B,V,j,H,q,z,Q,$,Y,J,X,Z,ee,te,re,ne,ae,ie,oe,se,ue,le,ce,de,ge,me,he){return{getWorksheetFuncId:e,getWorksheetFuncName:t,isNumeral:r,getOrdinal:n,getNumberShape:a,isThousandsPosition:i,isIdentStart:o,isIdentContinue:s,stringCompareCI:u,errorNames:l,specialRefNames:c,trueName:d,falseName:g,rowLetter:m,columnLetter:h,leftBrace:p,rightBrace:f,leftBracket:S,rightBracket:v,rcLeftBracket:F,rcRightBracket:y,decimalSeparator:b,listSeparator:C,columnSeparator:A,rowSeparator:E,thousandsSeparator:T,statementSeparator:R,lcid:k,cultureTag:N,country:I,isThai:O,isEastAsia:P,isKorea:M,isJapan:D,isChinaT:w,isChinaS:L,isComplexScript:_,numberDecimals:x,isExpSepBySpace:K,fractionSeparator:W,isPercentSepBySpace:U,currencyFormat:G,isCurrencySymbolLead:B,isCurrencySepBySpace:V,currencySymbol:j,currencyDecimals:H,dateOrder:q,dateSeparator:z,dateAltSeparator:Q,year4Digits:$,month2Digits:Y,day2Digits:J,longDateFormat:X,timeSeparator:Z,timeAltSeparator:ee,hour2Digits:te,clock24Hour:re,isAMPMSepBySpace:ne,ampmSymbols:ae,dayNameShort:ie,dayNameLong:oe,monthNameShort:se,monthNameLong:ue,pictureSpecial:le,pictureSingle:ce,pictureColor:de,pictureDbnum:ge,sysDateFormat:me,sysTimeFormat:he}}var F,y;function b(e){const t=0|e;if(t<128)return t>=48&&t<58;const r=15&t;switch(2147483632&t){case 1632:case 1776:case 3664:case 3792:case 3872:case 4160:case 6112:case 6160:return r<=9;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:return r>=6&&r<=15;case 4960:return r>=9;case 4976:return r<=1;default:return!1}}function C(e){const t=0|e;if(t<128)return(t<48||t>=58)&&(0,s.assertFalse)("calc.config.getOrdinal"),15&t;const r=15&t;let n;switch(2147483632&t){case 1632:case 1776:case 3664:case 3792:case 3872:case 4160:case 6112:case 6160:n=r;break;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:n=r-6;break;case 4960:n=r-8;break;case 4976:n=r+8;break;default:return(0,s.assertFalse)("calc.config.getOrdinal")}return(n<0||n>9||4968===t)&&(0,s.assertFalse)("calc.config.getOrdinal"),n}function A(e){const t=0|e;if(t<128)return(t<48||t>=58)&&(0,s.assertFalse)("calc.config.getNumberShape"),h.NumberShape.ASCII;switch(b(t)||(0,s.assertFalse)("calc.config.getNumberShape"),2147483632&t){case 1632:return h.NumberShape.ArabicIndic;case 1776:return h.NumberShape.ExtendedArabicIndic;case 2400:return h.NumberShape.Devanagari;case 2528:return h.NumberShape.Bengali;case 2656:return h.NumberShape.Gurmukhi;case 2784:return h.NumberShape.Gujarati;case 2912:return h.NumberShape.Oriya;case 3040:return h.NumberShape.Tamil;case 3168:return h.NumberShape.Telugu;case 3296:return h.NumberShape.Kannada;case 3424:return h.NumberShape.Malayalam;case 3664:return h.NumberShape.Thai;case 3792:return h.NumberShape.Lao;case 3872:return h.NumberShape.Tibetan;case 4160:return h.NumberShape.Myanmar;case 4960:case 4976:return h.NumberShape.Ethiopic;case 6112:return h.NumberShape.Khmer;case 6160:return h.NumberShape.Mongolian;default:return(0,s.assertFalse)("calc.config.getNumberShape")}}Object.defineProperty(t,"PictureColor",{enumerable:!0,get:function(){return S.PictureColor}}),Object.defineProperty(t,"PictureDbnum",{enumerable:!0,get:function(){return S.PictureDbnum}}),Object.defineProperty(t,"PictureSingle",{enumerable:!0,get:function(){return S.PictureSingle}}),Object.defineProperty(t,"PictureSpecial",{enumerable:!0,get:function(){return S.PictureSpecial}}),t.calcConfig=function(e,t=m.RefStyle.A1,r=f.xlMathpack,n=!1,a=!0,i=p.tzUTC,o=p.xlDatepack){return{localeInfo:e,refStyle:t,mathpack:r,date1904:n,dateCompatibility:a,timezone:i,datepack:o}},t.localeInfo=v,function(e){e[e.USA=1]="USA",e[e.UK=44]="UK",e[e.AUS=61]="AUS",e[e.NZ=64]="NZ",e[e.UNK=1]="UNK",e[e.CAN=2]="CAN",e[e.DUT=31]="DUT",e[e.FRN=33]="FRN",e[e.SPA=34]="SPA",e[e.ITN=39]="ITN",e[e.SWE=46]="SWE",e[e.GER=49]="GER",e[e.JPN=81]="JPN",e[e.MEX=52]="MEX",e[e.BRA=55]="BRA",e[e.LAM=3]="LAM",e[e.BEL=32]="BEL",e[e.SWZ=41]="SWZ",e[e.SWG=41]="SWG",e[e.SWF=41]="SWF",e[e.AUT=43]="AUT",e[e.DAN=45]="DAN",e[e.NOR=47]="NOR",e[e.POR=351]="POR",e[e.FIN=358]="FIN",e[e.ICE=354]="ICE",e[e.GRK=30]="GRK",e[e.TUR=90]="TUR",e[e.CZE=420]="CZE",e[e.HUN=36]="HUN",e[e.POL=48]="POL",e[e.RUS=7]="RUS",e[e.HEB=972]="HEB",e[e.ARB=966]="ARB",e[e.PER=981]="PER",e[e.ARB_Algeria=213]="ARB_Algeria",e[e.ARB_Bahrain=966]="ARB_Bahrain",e[e.ARB_Djibouti=253]="ARB_Djibouti",e[e.ARB_Egypt=20]="ARB_Egypt",e[e.ARB_Iraq=964]="ARB_Iraq",e[e.ARB_Jordan=962]="ARB_Jordan",e[e.ARB_Kuwait=965]="ARB_Kuwait",e[e.ARB_Lebanon=961]="ARB_Lebanon",e[e.ARB_Libya=218]="ARB_Libya",e[e.ARB_Mauritania=222]="ARB_Mauritania",e[e.ARB_Morocco=216]="ARB_Morocco",e[e.ARB_Oman=968]="ARB_Oman",e[e.ARB_Qatar=974]="ARB_Qatar",e[e.ARB_SaudiArabia=966]="ARB_SaudiArabia",e[e.ARB_Somalia=1]="ARB_Somalia",e[e.ARB_Sudan=249]="ARB_Sudan",e[e.ARB_Syria=963]="ARB_Syria",e[e.ARB_Tunisia=216]="ARB_Tunisia",e[e.ARB_UAE=971]="ARB_UAE",e[e.ARB_Yemen=969]="ARB_Yemen",e[e.KOR=82]="KOR",e[e.TW=886]="TW",e[e.PRC=86]="PRC",e[e.THA=66]="THA",e[e.VIET=84]="VIET"}(F||(t.Country=F={})),function(e){e[e.None=0]="None",e[e.USA=1033]="USA",e[e.Greek=1032]="Greek",e[e.Hungarian=1038]="Hungarian",e[e.Turkish=1055]="Turkish",e[e.Thailand=1054]="Thailand",e[e.Vietnam=1066]="Vietnam",e[e.Arabic=1025]="Arabic",e[e.Hebrew=1037]="Hebrew",e[e.Tamil=1097]="Tamil",e[e.Syriac=1114]="Syriac",e[e.Iraq=2049]="Iraq",e[e.Algerian=5121]="Algerian",e[e.Basque=1069]="Basque",e[e.PortBrazil=1046]="PortBrazil",e[e.Croatian=1050]="Croatian",e[e.Czech=1029]="Czech",e[e.Danish=1030]="Danish",e[e.Dutch=1043]="Dutch",e[e.Australian=3081]="Australian",e[e.CanadianEnglish=4105]="CanadianEnglish",e[e.British=2057]="British",e[e.Finnish=1035]="Finnish",e[e.French=1036]="French",e[e.FrenchCanadian=3084]="FrenchCanadian",e[e.Italian=1040]="Italian",e[e.NorskBokmal=1044]="NorskBokmal",e[e.NorskNynorsk=2068]="NorskNynorsk",e[e.Polish=1045]="Polish",e[e.PortIberian=2070]="PortIberian",e[e.Romanian=1048]="Romanian",e[e.Russian=1049]="Russian",e[e.Ukrainian=1058]="Ukrainian",e[e.Belarusian=1059]="Belarusian",e[e.SerbianCyrillic=3098]="SerbianCyrillic",e[e.SerbianLatin=2074]="SerbianLatin",e[e.Slovak=1051]="Slovak",e[e.Slovenian=1060]="Slovenian",e[e.SpanishModern=3082]="SpanishModern",e[e.Swedish=1053]="Swedish",e[e.HongKong=3076]="HongKong",e[e.ChinaT=1028]="ChinaT",e[e.Korea=1042]="Korea",e[e.Japan=1041]="Japan",e[e.China=2052]="China",e[e.ChinaStroke=133124]="ChinaStroke",e[e.Devihi=1125]="Devihi",e[e.Hindi=1081]="Hindi",e[e.German=1031]="German",e[e.Swiss=4108]="Swiss",e[e.Indonesia=1057]="Indonesia",e[e.EnglishIndonesia=14345]="EnglishIndonesia",e[e.EnglishIndia=16393]="EnglishIndia",e[e.Singapore=4100]="Singapore",e[e.EnglishSingapore=18441]="EnglishSingapore",e[e.Serbia=9242]="Serbia",e[e.Mexico=2058]="Mexico",e[e.Ireland=6153]="Ireland",e[e.EnglishZimbabwe=12297]="EnglishZimbabwe",e[e.Belgium=2067]="Belgium",e[e.SystemTime=62464]="SystemTime",e[e.SystemLongDate=63488]="SystemLongDate",e[e.EuroTrailing=1]="EuroTrailing",e[e.EuroLeading=2]="EuroLeading",e[e.LANG=1023]="LANG",e[e.COUNTRY=64512]="COUNTRY",e[e.OPTIONS=16711680]="OPTIONS"}(y||(t.LCID=y={})),t.isNumeral=b,t.getOrdinal=C,t.getNumberShape=A;const E=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,2,0,0,2,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0]);function T(e){const t=0|e;return t>=0&&t<128?E[t]>=2:(0,c.isIdentStart)(t)}function R(e){const t=0|e;return t>=0&&t<128?E[t]>=1:(0,c.isIdentContinue)(t)}let k;t.isIdentStart=T,t.isIdentContinue=R,t.englishErrorNames=(0,l.partialArray)({[g.ErrorType.NULL]:"#NULL!",[g.ErrorType.DIV0]:"#DIV/0!",[g.ErrorType.VALUE]:"#VALUE!",[g.ErrorType.REF]:"#REF!",[g.ErrorType.NAME]:"#NAME?",[g.ErrorType.NUM]:"#NUM!",[g.ErrorType.NA]:"#N/A",[g.ErrorType.GETTING_DATA]:"#GETTING_DATA",[g.ErrorType.SPILL]:"#SPILL!",[g.ErrorType.CONNECT]:"#CONNECT!",[g.ErrorType.BLOCKED]:"#BLOCKED!",[g.ErrorType.UNKNOWN]:"#UNKNOWN!",[g.ErrorType.FIELD]:"#FIELD!",[g.ErrorType.CALC]:"#CALC!",[g.ErrorType.BUSY]:"#BUSY!",[g.ErrorType.EXTERNAL]:"#EXTERNAL!"}),t.englishSpecialRefNames=(0,l.partialArray)({[m.SpecialRefId.All]:"#All",[m.SpecialRefId.Data]:"#Data",[m.SpecialRefId.Headers]:"#Headers",[m.SpecialRefId.Totals]:"#Totals",[m.SpecialRefId.ThisRow]:"#This Row"}),t.englishPictureSpecial=(0,l.partialArray)({[S.PictureSpecial.AP1]:"AM/PM",[S.PictureSpecial.AP2]:"A/P",[S.PictureSpecial.AP3]:"上午/下午",[S.PictureSpecial.General]:"General",[S.PictureSpecial.Currency]:"$"}),t.englishPictureSingle=(0,l.partialArray)({[S.PictureSingle.Sep]:";",[S.PictureSingle.Hash]:"#",[S.PictureSingle.Zero]:"0",[S.PictureSingle.Decimal]:".",[S.PictureSingle.Percent]:"%",[S.PictureSingle.Comma]:",",[S.PictureSingle.Colon]:":",[S.PictureSingle.DateSep]:"/",[S.PictureSingle.Slash]:"/",[S.PictureSingle.Space]:" ",[S.PictureSingle.Minus]:"-",[S.PictureSingle.Plus]:"+",[S.PictureSingle.OpenParen]:"(",[S.PictureSingle.CloseParen]:")",[S.PictureSingle.Backslash]:"\\",[S.PictureSingle.Star]:"*",[S.PictureSingle.Year]:"y",[S.PictureSingle.Month]:"m",[S.PictureSingle.Day]:"d",[S.PictureSingle.Hour]:"h",[S.PictureSingle.Minute]:"m",[S.PictureSingle.Second]:"s",[S.PictureSingle.E]:"E",[S.PictureSingle.APDelim]:"/",[S.PictureSingle.Quote]:'"',[S.PictureSingle.ColorStart]:"[",[S.PictureSingle.ColorEnd]:"]",[S.PictureSingle.Text]:"@",[S.PictureSingle.Question]:"?",[S.PictureSingle.Underscore]:"_",[S.PictureSingle.Reign]:"r",[S.PictureSingle.LocDay]:"a",[S.PictureSingle.Era]:"g",[S.PictureSingle.EraYear]:"e",[S.PictureSingle.BidiDate]:"B",[S.PictureSingle.BidiNum]:"N",[S.PictureSingle.DayTh]:"ว",[S.PictureSingle.MonthTh]:"ด",[S.PictureSingle.YearTh]:"ป",[S.PictureSingle.EngYearTh]:"b",[S.PictureSingle.ThYear]:"ค",[S.PictureSingle.HourTh]:"ช",[S.PictureSingle.MinuteTh]:"น",[S.PictureSingle.SecondTh]:"ท",[S.PictureSingle.ZeroTh]:"๐"}),t.englishPictureColor=(0,l.partialArray)({[S.PictureColor.Black]:"Black",[S.PictureColor.White]:"White",[S.PictureColor.Red]:"Red",[S.PictureColor.Green]:"Green",[S.PictureColor.Blue]:"Blue",[S.PictureColor.Yellow]:"Yellow",[S.PictureColor.Magenta]:"Magenta",[S.PictureColor.Cyan]:"Cyan",[S.PictureColor.Color]:"Color"}),t.englishPictureDbnum=(0,l.partialArray)({[S.PictureDbnum.DBNUM1]:"DBNum1",[S.PictureDbnum.DBNUM2]:"DBNum2",[S.PictureDbnum.DBNUM3]:"DBNum3",[S.PictureDbnum.DBNUM4]:"DBNum4"}),t.englishSysDateFormat="dddd, mmmm dd, yyyy",t.englishSysTimeFormat="h:mm:ss AM/PM",t.englishWorksheetFuncIdToName=function(e){const t=I()[e];return void 0===t?`wsf:${e}`:t},t.englishErrorTypeToName=function(e){const r=t.englishErrorNames[e];return void 0===r?`error.type:${e}`:r},t.englishOperatorIdToName=function(e){if(e===u.OperatorId.Isect)return" ";if(e===u.OperatorId.Union)return",";const t=u.operatorStrings[e];return void 0===t?`op:${e}`:t},t.operatorIdToName=function(e,t,r){return t===u.OperatorId.Isect?r:t===u.OperatorId.Union?e.listSeparator:u.operatorStrings[t]};const N=/_/g;function I(){if(null==k){k=[];for(const e of(0,i.numEnumArray)(u.WorksheetFuncId)){const t=(0,u.getWorksheetFuncEnglishName)(e)??u.WorksheetFuncId[e].replace(N,".");k[e]=t}}return k}function O(e,t){const r=function(e,t){const r=[];return t.forEach(((e,t)=>{null!=e&&r.push([e,t])})),d.ArrayMapTree.create(e).setValues(r)}(e,t);return{getWorksheetFuncId:e=>r.getValue(e),getWorksheetFuncName(e){const r=t[e];return null==r?(0,s.assertFalse)(`calc.config.getWorksheetFuncName: unknown function ID ${e}`):r}}}let P;t.getEnglishWorksheetFuncIdToName=I,t.createWorksheetFuncNameCallbacks=O,t.createIsThousandsPositionCallback=function(e){if(0===e.length||0===e[0])return()=>!1;if(2===e.length&&0===e[1]){const t=e[0];return e=>e>0&&e%t==0}const t=0===e[e.length-1]&&e.length>=2;return r=>{if(r<=0)return!1;let n=r;for(let t=0;t<e.length&&(n-=e[t],!(n<=0));t+=1);return n>0&&t?n%e[e.length-2]==0:0===n}},t.getEnglishLocaleInfo=function(){return null==P&&(P=function(){const e=I(),r=(0,a.makeStringCompareCI)("en-US"),{getWorksheetFuncId:n,getWorksheetFuncName:i}=O(r,e);return v(n,i,b,C,A,(e=>e>0&&e%3==0),T,R,r,t.englishErrorNames,t.englishSpecialRefNames,"TRUE","FALSE","R","C","{","}","[","]","[","]",".",",",",",";",",",";",y.USA,{primary:"en-US",userDefault:"en-US",instLang:"en-US",userCurrent:"en-US"},F.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,h.CurrencyFormat.Paren,!0,!1,"$",2,h.DateOrder.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],t.englishPictureSpecial,t.englishPictureSingle,t.englishPictureColor,t.englishPictureDbnum,t.englishSysDateFormat,t.englishSysTimeFormat)}()),P}},9582:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.TimeGranularity=t.TimeDivision=t.dateTime=t.Rounding=t.tzUTC=t.tzData=void 0;const n=r(6647),a=r(8610),i=r(6366);var o;t.tzData=(0,i.typedInstanceCreator)()(((e,t,r,n,a)=>({bias:e,standardDate:t,standardBias:r,daylightDate:n,daylightBias:a}))),t.tzUTC=(0,t.tzData)(0,void 0,0,void 0,0),t.Rounding=n.dtr.Rounding,t.dateTime=n.dtr.dtr,t.TimeDivision=n.dtr.TimeDivision,function(e){e[e.Year=0]="Year",e[e.Day=1]="Day",e[e.Instant=2]="Instant"}(o||(t.TimeGranularity=o={})),t.xlDatepack={fromNum:function(e,t,r){return n.dtr.fromNum(e.mathpack.toNumber(t),r,e.date1904,e.dateCompatibility)},toNum:function(e,t){const r=n.dtr.toNum(t,e.date1904,e.dateCompatibility);return"number"==typeof r?e.mathpack.fromNumber(r):a.numErrorOper},toNumWithDuration:function(e,t,r,i){const o=n.dtr.toNumWithDuration(t,e.date1904,e.dateCompatibility,r,i);return"number"==typeof o?e.mathpack.fromNumber(o):a.numErrorOper},daysPerMonth:n.dtr.daysPerMonth,toDays:function(e,t){return n.dtr.toDays(t,e.date1904,e.dateCompatibility)},toTime:function(e,t,r,a){return n.dtr.toTime(e.mathpack.toNumber(t),r,a)},utcToLocal:function(e,t,r){return n.dtr.utcToLocal(t,r,e.date1904,e.dateCompatibility)}}},2701:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wsfNode=t.operatorNode=t.lambdaNode=t.lambdaParam=t.paramNode=t.paramDefault=t.paramName=t.flattenLambdaArgs=t.letNode=t.letVar=t.varNode=t.indexedArg=t.flattenLetArgs=t.appNode=t.arrayNode=t.literalNode=t.formulaRootAnnotation=t.localNameDeclAnnotation=t.localNameUseAnnotation=t.formulaSpan=t.multiLineComment=t.singleLineComment=t.formula=t.cellRefBad=t.cellRefCol=t.cellRefRow=t.cellRefRange=t.cellRefSingle=t.cellRefError=t.pos=t.badQualifier=t.sheetRangeQualifier=t.identQualifier=t.sheetQualifier=t.documentQualifier=t.relativeQualifier=t.errorQualifier=t.BadType=t.StructRefKind=t.SpecialRefId=t.NamePartKind=t.NodeKind=t.appHeadNameAnnotation=t.AnnotationKind=t.CommentKind=t.PosKind=t.CellRefKind=t.QualifierKind=t.SyntaxFeature=t.RefStyle=void 0,t.getDepthUpperBound=t.badSequenceNode=t.badCharsNode=t.missingNode=t.identNode=t.structRef=t.badRef=t.missingRef=t.thisRowOpRef=t.commaOpRef=t.rangeOpRef=t.columnRef=t.specialRef=t.structRefNode=t.fieldRef=t.fieldRefNode=t.cellRefNode=t.contextNameNode=t.headNamePart=t.flattenNameParts=t.fieldRefNamePart=t.cellRefNamePart=t.identNamePart=t.nameNode=t.parenNode=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6366),u=r(6366),l=r(6366),c=r(6366);var d,g,m,h,p,f,S,v,F,y,b,C;function A(e){return void 0!==e.kind}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(d||(t.RefStyle=d={})),function(e){e.Comments="Comments",e.Statements="Statements"}(g||(t.SyntaxFeature=g={})),function(e){e.Error="ErrorQualifier",e.Relative="RelativeQualifier",e.Document="DocumentQualifier",e.Sheet="SheetQualifier",e.Ident="IdentQualifier",e.SheetRange="SheetRangeQualifier",e.Bad="BadQualifier"}(m||(t.QualifierKind=m={})),function(e){e.Error="CellRefError",e.Single="CellRefSingle",e.Range="CellRefRange",e.Row="CellRefRow",e.Col="CellRefCol",e.Bad="CellRefBad"}(h||(t.CellRefKind=h={})),function(e){e.Abs="Abs",e.Rel="Rel"}(p||(t.PosKind=p={})),function(e){e.SingleLine="SingleLineComment",e.MultiLine="MultiLineComment"}(f||(t.CommentKind=f={})),function(e){e.LocalNameUse="LocalNameUse",e.LocalNameDecl="LocalNameDecl",e.AppHeadName="AppHeadName",e.FormulaRoot="FormulaRoot"}(S||(t.AnnotationKind=S={})),t.appHeadNameAnnotation={kind:S.AppHeadName},function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Let="Let",e.Lambda="Lambda",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.FieldRef="FieldRef",e.StructRef="StructRef",e.Missing="Missing",e.BadChars="BadChars",e.BadSequence="BadSequence",e.Operator="Operator",e.WSF="WSF",e.Var="Var",e.Param="Param",e.ContextName="ContextName",e.Ident="Ident",e.ParamName="ParamName",e.ParamDef="ParamDef",e.FieldRefRHS="FieldRefRHS",e.StructRefRHS="StructRefRHS"}(v||(t.NodeKind=v={})),function(e){e.IdentNamePart="IdentNamePart",e.CellRefNamePart="CellRefNamePart",e.FieldRefNamePart="FieldRefNamePart"}(F||(t.NamePartKind=F={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(y||(t.SpecialRefId=y={})),function(e){e.SpecialRef="SpecialStructRef",e.ColumnRef="ColumnStructRef",e.RangeOpRef="RangeOpStructRef",e.CommaOpRef="CommaOpStructRef",e.ThisRowOpRef="ThisRowOpStructRef",e.MissingRef="MissingStructRef",e.BadRef="BadStructRef"}(b||(t.StructRefKind=b={})),function(e){e.Unexpected="Unexpected",e.Qualifier="Qualifier",e.NumberLiteral="NumberLiteral",e.StringLiteral="StringLiteral",e.ErrorLiteral="ErrorLiteral",e.FieldName="FieldName",e.ParamName="ParamName",e.StructRef="StructRef",e.FieldRef="FieldRef"}(C||(t.BadType=C={})),t.errorQualifier=function(e=0){return{kind:m.Error,isQuoted:!1,isClosed:!0,isTerminated:!0,label:e}},t.relativeQualifier=function(e=0){return{kind:m.Relative,isQuoted:!1,isClosed:!0,isTerminated:!0,label:e}},t.documentQualifier=function(e,t,r=!1,n=0){return{kind:m.Document,isQuoted:r,isClosed:!0,isTerminated:!0,label:n,document:e,path:t}},t.sheetQualifier=function(e,t,r=!1,n=0){return{kind:m.Sheet,isQuoted:r,isClosed:!0,isTerminated:!0,label:n,sheet:e,document:t}},t.identQualifier=function(e,t=!1,r=0){return{kind:m.Ident,isQuoted:t,isClosed:!0,isTerminated:!0,label:r,name:e}},t.sheetRangeQualifier=function(e,t,r,n=!1,a=0){return{kind:m.SheetRange,isQuoted:n,isClosed:!0,isTerminated:!0,label:a,sheet1:e,sheet2:t,document:r}},t.badQualifier=function(e,t=!1,r=!0,n=!0,a=0){return{kind:m.Bad,isQuoted:t,isClosed:r,isTerminated:n,label:a,chars:e}},t.pos=function(e,t){return{kind:e,index:t}},t.cellRefError=function(e=0){return{kind:h.Error,label:e,isBracketed:!1}},t.cellRefSingle=function(e,t,r=!1,n=0){return{kind:h.Single,label:n,row:e,col:t,isBracketed:r}},t.cellRefRange=function(e,t,r=0){const n=e.isBracketed||t.isBracketed;return{kind:h.Range,label:r,ref1:e,ref2:t,isBracketed:n}},t.cellRefRow=function(e,t,r=!1,n=0){return{kind:h.Row,label:n,row1:e,row2:t,isBracketed:r}},t.cellRefCol=function(e,t,r=!1,n=0){return{kind:h.Col,label:n,col1:e,col2:t,isBracketed:r}},t.cellRefBad=function(e,t=!1,r=0){return{kind:h.Bad,label:r,chars:e,isBracketed:t}},t.formula=function(e,t,r,n){return{node:e,spans:t,annotations:r,depthUpperBound:n??M(e)}},t.singleLineComment=function(e,t=0){return{kind:f.SingleLine,label:t,chars:e,isClosed:!0}},t.multiLineComment=function(e,t=!0,r=0){return{kind:f.MultiLine,label:r,chars:e,isClosed:t}},t.formulaSpan=function(e,t,r,o,s,u){return(0,n.assertNatural)("calc.lang.formulaSpan",e),(0,a.assertInteger)("calc.lang.formulaSpan",t),t<e&&(0,i.assertFalse)(`calc.lang.formulaSpan: expected end >= ${e}; given ${t}`),{start:e,end:t,pre:r,post:o,preComments:s,postComments:u}},t.localNameUseAnnotation=function(e,t,r){return{kind:S.LocalNameUse,name:e,whole:t,label:r}},t.localNameDeclAnnotation=function(e,t,r=[]){return{kind:S.LocalNameDecl,name:e,whole:t,uses:r}},t.formulaRootAnnotation=function(e,t){return{kind:S.FormulaRoot,contextNames:e,syntaxFeatures:t}},t.literalNode=function(e,t=!0,r=0){return{kind:v.Literal,label:r,oper:e,isClosed:t}},t.arrayNode=function(e,t=!0,r=0){return{kind:v.Array,label:r,nodes:e,isClosed:t}},t.appNode=function(e,t,r=!0,n=0){return{kind:v.App,label:n,head:e,args:t,isClosed:r}};const E=e=>{const t=[];for(const{arg:r,index:n}of e)(0,s.assertIndex)("calc.lang.flattenNumberedArgs: idx",n,e.length),(0,o.assertTrue)("calc.lang.flattenNumberedArgs: repetition",void 0===t[n]),t[n]=r;return t};function T(e,t,r){return E((0,c.safeConcat)([...void 0===t?[]:[t],...r],e.map((({name:e,binder:t})=>[e,t]))))}function R(e,t){return(0,n.assertNatural)("calc.lang.indexedArg: index",t),{arg:e,index:t}}function k(e,t){return{name:e,binder:t}}function N(e,t,r=[]){return E([...e.map((e=>e.name)),...void 0===t?[]:[t],...r])}function I(e){return{name:e}}t.flattenLetArgs=T,t.indexedArg=R,t.varNode=function(e,t=0){return{kind:v.Var,label:t,name:e,wholeName:e.whole}},t.letVar=k,t.letNode=function(e,t,r,n=[],a=!0,i=0){const o=t.map(((e,t)=>{return r=e,Array.isArray(r)?k(R(e[0],2*t),R(e[1],2*t+1)):e;var r})).sort(((e,t)=>e.name.index-t.name.index)),s=void 0!==r&&A(r)?R(r,2*o.length):r,u=T(o,s,n);return{kind:v.Let,label:i,head:e,args:u,isClosed:a,vars:o,body:s,badArgs:n}},t.flattenLambdaArgs=N,t.paramName=function(e,t,r=!0,n=0){return{kind:v.ParamName,label:n,name:e,isBracketed:t,isClosed:r}},t.paramDefault=function(e,t=0){return{kind:v.ParamDef,label:t,rhs:e}},t.paramNode=function(e,t,r=0){return{kind:v.Param,label:r,name:e,wholeName:e.name.kind===v.Ident?e.name.whole:void 0,def:t,isOptional:e.isBracketed||void 0!==t}},t.lambdaParam=I,t.lambdaNode=function(e,t,r,n=[],a=!0,i=0){const o=t.map(((e,t)=>A(e)?I(R(e,t)):e)).sort(((e,t)=>e.name.index-t.name.index)),s=void 0!==r&&A(r)?R(r,o.length):r,u=N(o,s,n);return{kind:v.Lambda,label:i,head:e,args:u,isClosed:a,params:o,body:s,badArgs:n}},t.operatorNode=function(e,t=0){return{kind:v.Operator,label:t,id:e}},t.wsfNode=function(e,t,r=0){return{kind:v.WSF,label:r,id:e,whole:t}},t.parenNode=function(e,t=!0,r=0){return{kind:v.Paren,label:r,node:e,isClosed:t}},t.nameNode=function(e,t,r=0){return{kind:v.Name,label:r,whole:e.asWhole,parts:e,qualifier:t}},t.identNamePart=function(e,t=!0,r=0,n=0){return{kind:F.IdentNamePart,label:r,qualifiedLabel:n,asWhole:e,canDenoteNamedObject:t}},t.cellRefNamePart=function(e,t,r=0,n=0){return{kind:F.CellRefNamePart,label:r,qualifiedLabel:n,asWhole:t,canDenoteNamedObject:!1,ref:e}},t.fieldRefNamePart=function(e,t,r=!0,n=0,a=0){return(0,o.assertTrue)("calc.lang.fieldRefNamePart",t.isClosed&&!t.isBracketed),{kind:F.FieldRefNamePart,label:n,qualifiedLabel:a,asWhole:e.asWhole+"."+(t.field.kind===v.Ident?t.field.whole:t.field.chars),canDenoteNamedObject:r,lhs:e,rhs:t}},t.flattenNameParts=function(e){const t=[e];let r=t[0];for(;r.kind===F.FieldRefNamePart;)t.push(r.lhs),r=r.lhs;return t.reverse(),{kind:r.kind,parts:t}},t.headNamePart=function(e){let t=e;for(;t.kind===F.FieldRefNamePart;)t=t.lhs;return t},t.contextNameNode=function(e,t=0){return{kind:v.ContextName,label:t,whole:e}},t.cellRefNode=function(e,t,r=0){return{kind:v.CellRef,label:r,ref:e,qualifier:t}},t.fieldRefNode=function(e,t,r=0){return{kind:v.FieldRef,label:r,lhs:e,rhs:t}},t.fieldRef=function(e,t=!1,r=!0,n=!1,a=0){return{kind:v.FieldRefRHS,label:a,field:e,isBracketed:t,isClosed:r,shouldBeBracketed:n}},t.structRefNode=function(e,t,r=0){return{kind:v.StructRef,label:r,lhs:e,rhs:t}},t.specialRef=function(e,t=!1,r=!0,n=0){return{kind:b.SpecialRef,label:n,id:e,isBracketed:t,isClosed:r}},t.columnRef=function(e,t=!1,r=!0,n=0){return{kind:b.ColumnRef,label:n,name:e,isBracketed:t,isClosed:r}},t.rangeOpRef=function(e,t,r=0){return{kind:b.RangeOpRef,label:r,lhs:e,rhs:t}},t.commaOpRef=function(e,t=0){const r={[y.All]:!1,[y.Data]:!1,[y.Headers]:!1,[y.Totals]:!1,[y.ThisRow]:!1},n=[];for(const t of e)switch(t.kind){case b.SpecialRef:r[t.id]=!0;break;case b.ColumnRef:case b.RangeOpRef:n.push(t)}return{kind:b.CommaOpRef,label:t,refs:e,specialRefs:r,columnRefs:n}},t.thisRowOpRef=function(e,t=0){return{kind:b.ThisRowOpRef,label:t,ref:e}},t.missingRef=function(e=0){return{kind:b.MissingRef,label:e}},t.badRef=function(e,t=!1,r=!0,n=0){return{kind:b.BadRef,chars:e,isBracketed:t,isClosed:r,label:n}},t.structRef=function(e,t=!0,r=0){return{kind:v.StructRefRHS,label:r,isClosed:t,innerRef:e}},t.identNode=function(e,t=0){return{kind:v.Ident,label:t,whole:e}},t.missingNode=function(e="",t=0){return{kind:v.Missing,label:t,chars:e}},t.badCharsNode=function(e,t,r=0){return{kind:v.BadChars,label:r,type:e,chars:t}},t.badSequenceNode=function(e,t,r=0){return{kind:v.BadSequence,label:r,type:e,contents:t}};const O=50;function P(e,t){if(t>O)return 1/0;switch(e.kind){case v.Array:{let r=0;for(const n of e.nodes)for(const e of n)r=(0,l.fastMax)(r,P(e,t+1));return r+1}case v.Param:return void 0===e.def?1:P(e.def.rhs,t+1)+1;case v.Let:case v.Lambda:case v.App:{let r=P(e.head,t+1);for(const n of e.args)r=(0,l.fastMax)(r,P(n,t+1));return r+1}case v.Paren:return P(e.node,t+1)+1;case v.FieldRef:return P(e.lhs,t+1)+1;case v.Var:case v.Name:case v.CellRef:case v.StructRef:case v.Literal:case v.Operator:case v.WSF:case v.Missing:case v.BadChars:return 1;case v.BadSequence:{let r=0;for(const n of e.contents)r=(0,l.fastMax)(r,P(n,t+1));return r+1}default:return(0,u.assertNever)("calc.lang.getDepthUpperBound",e)}}function M(e){return P(e,0)}t.getDepthUpperBound=M},1516:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIdentContinue=t.isIdentStart=void 0;const n=r(6366);t.isIdentStart=(0,n.makeIsInClass)([65,91,92,93,95,96,97,123,161,162,164,165,167,169,170,171,173,174,175,187,188,697,699,706,711,712,713,716,717,718,720,722,728,732,733,734,736,741,750,751,880,884,886,888,890,894,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1316,1329,1367,1369,1370,1377,1416,1488,1515,1520,1523,1569,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2308,2362,2365,2366,2384,2385,2392,2402,2417,2419,2427,2432,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3124,3125,3130,3133,3134,3160,3162,3168,3170,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3333,3341,3342,3345,3346,3369,3370,3386,3389,3390,3424,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3719,3721,3722,3723,3725,3726,3732,3736,3737,3744,3745,3748,3749,3750,3751,3752,3754,3756,3757,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3806,3840,3841,3904,3912,3913,3949,3976,3980,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4304,4347,4348,4349,4352,4442,4447,4515,4520,4602,4608,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5109,5121,5741,5743,5751,5761,5787,5792,5867,5870,5873,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6264,6272,6313,6314,6315,6400,6429,6480,6510,6512,6517,6528,6570,6593,6600,6656,6679,6917,6964,6981,6988,7043,7073,7086,7088,7168,7204,7245,7248,7258,7294,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8208,8209,8211,8215,8216,8218,8220,8222,8224,8226,8229,8232,8240,8241,8242,8244,8245,8246,8251,8252,8305,8306,8308,8309,8319,8320,8321,8325,8336,8341,8450,8452,8453,8454,8455,8456,8457,8468,8469,8471,8473,8478,8481,8483,8484,8485,8486,8487,8488,8489,8490,8494,8495,8506,8508,8512,8517,8522,8526,8527,8531,8533,8539,8543,8544,8585,8592,8602,8658,8659,8660,8661,8704,8705,8706,8708,8711,8713,8715,8716,8719,8720,8721,8722,8725,8726,8730,8731,8733,8737,8739,8740,8741,8742,8743,8749,8750,8751,8756,8760,8764,8766,8776,8777,8780,8781,8786,8787,8800,8802,8804,8808,8810,8812,8814,8816,8834,8836,8838,8840,8853,8854,8857,8858,8869,8870,8895,8896,8978,8979,9312,9398,9424,9450,9472,9548,9552,9589,9601,9616,9618,9622,9632,9634,9635,9642,9650,9652,9654,9656,9660,9662,9664,9666,9670,9673,9675,9676,9678,9682,9698,9702,9711,9712,9733,9735,9737,9738,9742,9744,9756,9757,9758,9759,9792,9793,9794,9795,9824,9826,9827,9830,9831,9835,9836,9838,9839,9840,11264,11311,11312,11359,11360,11376,11377,11390,11392,11493,11520,11558,11568,11622,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12288,12292,12293,12312,12317,12320,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12544,12549,12590,12593,12687,12704,12728,12784,12829,12832,12842,12849,12851,12857,12858,12896,12924,12927,12928,12963,12969,13059,13060,13069,13070,13076,13077,13080,13081,13090,13092,13094,13096,13099,13100,13110,13111,13115,13116,13129,13131,13133,13134,13137,13138,13143,13144,13179,13183,13184,13189,13192,13259,13261,13268,13269,13271,13272,13273,13275,13278,13312,19894,19968,40900,40960,42125,42240,42509,42512,42528,42538,42540,42560,42592,42594,42607,42624,42648,42786,42888,42891,42893,43003,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43274,43302,43312,43335,43520,43561,43584,43587,43588,43596,44032,55204,57344,63561,63744,64046,64048,64107,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65072,65074,65075,65093,65097,65107,65108,65112,65113,65127,65128,65132,65136,65141,65142,65277,65281,65375,65377,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511]),t.isIdentContinue=(0,n.makeIsInClass)([48,58,63,64,65,91,92,93,95,96,97,123,161,162,164,165,167,169,170,171,173,174,175,187,188,888,890,894,900,903,904,907,908,909,910,930,931,1316,1329,1367,1369,1370,1377,1416,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1520,1523,1536,1540,1542,1545,1547,1548,1550,1563,1567,1568,1569,1631,1632,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2305,2362,2364,2382,2384,2389,2392,2404,2406,2416,2417,2419,2427,2432,2433,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2555,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2902,2904,2908,2910,2911,2916,2918,2930,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3073,3076,3077,3085,3086,3089,3090,3113,3114,3124,3125,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3162,3168,3172,3174,3184,3192,3200,3202,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3330,3332,3333,3341,3342,3345,3346,3369,3370,3386,3389,3397,3398,3401,3402,3406,3415,3416,3424,3428,3430,3446,3449,3456,3458,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3719,3721,3722,3723,3725,3726,3732,3736,3737,3744,3745,3748,3749,3750,3751,3752,3754,3756,3757,3770,3771,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3806,3840,3844,3859,3898,3902,3912,3913,3949,3953,3973,3974,3980,3984,3992,3993,4029,4030,4045,4046,4048,4096,4170,4176,4250,4254,4294,4304,4347,4348,4349,4352,4442,4447,4515,4520,4602,4608,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4959,4961,4969,4989,4992,5018,5024,5109,5121,5741,5743,5751,5760,5787,5792,5867,5870,5873,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6264,6272,6315,6400,6429,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6570,6576,6602,6608,6618,6624,6684,6912,6988,6992,7002,7009,7037,7040,7083,7086,7098,7168,7224,7232,7242,7245,7294,7424,7655,7678,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8192,8209,8211,8215,8216,8218,8220,8222,8224,8226,8229,8241,8242,8244,8245,8246,8251,8252,8260,8261,8274,8275,8287,8293,8298,8306,8308,8317,8319,8333,8336,8341,8352,8374,8400,8433,8448,8528,8531,8585,8592,9001,9003,9192,9216,9255,9280,9291,9312,9886,9888,9917,9920,9924,9985,9989,9990,9994,9996,10024,10025,10060,10061,10062,10063,10067,10070,10071,10072,10079,10081,10088,10102,10133,10136,10160,10161,10175,10176,10181,10183,10187,10188,10189,10192,10214,10224,10627,10649,10712,10716,10748,10750,11085,11088,11093,11264,11311,11312,11359,11360,11376,11377,11390,11392,11499,11517,11518,11520,11558,11568,11622,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11904,11930,11931,12020,12032,12246,12272,12284,12288,12312,12317,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12544,12549,12590,12593,12687,12688,12728,12736,12772,12784,12831,12832,12868,12880,13055,13056,19894,19904,40900,40960,42125,42128,42183,42240,42509,42512,42540,42560,42592,42594,42611,42620,42622,42623,42648,42752,42893,43003,43052,43072,43124,43136,43205,43216,43226,43264,43311,43312,43348,43520,43575,43584,43598,43600,43610,44032,55204,57344,64046,64048,64107,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65063,65072,65074,65075,65093,65097,65107,65108,65112,65113,65127,65128,65132,65136,65141,65142,65277,65279,65280,65281,65375,65377,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534])},8478:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.worksheetFuncTypes=t.worksheetFuncEnglishNames=t.WorksheetFuncId=void 0;const n=r(450);var a;!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.WRAPROWS=634]="WRAPROWS",e[e.VSTACK=635]="VSTACK",e[e.HSTACK=636]="HSTACK",e[e.CHOOSEROWS=637]="CHOOSEROWS",e[e.CHOOSECOLS=638]="CHOOSECOLS",e[e.LET=639]="LET",e[e.LAMBDA=640]="LAMBDA",e[e.MAKEARRAY=641]="MAKEARRAY",e[e.APPLY=642]="APPLY",e[e.ISLAMBDA=643]="ISLAMBDA",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.PERCENTOF=646]="PERCENTOF",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.FORMATTEDNUMBER=649]="FORMATTEDNUMBER",e[e.TOCOL=650]="TOCOL",e[e.TOROW=651]="TOROW",e[e.WRAPCOLS=652]="WRAPCOLS",e[e.MAP=653]="MAP",e[e.REDUCE=654]="REDUCE",e[e.SCAN=655]="SCAN",e[e.BYROW=656]="BYROW",e[e.BYCOL=657]="BYCOL",e[e.ISOMITTED=658]="ISOMITTED",e[e.EXPAND=659]="EXPAND",e[e.TAKE=660]="TAKE",e[e.DROP=661]="DROP",e[e.PY=662]="PY",e[e.IMAGE=664]="IMAGE",e[e.UNIT=665]="UNIT",e[e.GROUPBY=666]="GROUPBY",e[e.PIVOTBY=667]="PIVOTBY",e[e.PQSOURCE=668]="PQSOURCE",e[e.PYTHON_STR=669]="PYTHON_STR",e[e.PYTHON_TYPE=670]="PYTHON_TYPE",e[e.PYTHON_TYPENAME=671]="PYTHON_TYPENAME",e[e._FF=672]="_FF",e[e.FIELDFUNCTION=673]="FIELDFUNCTION",e[e.TRANSLATE=674]="TRANSLATE",e[e.DETECTLANGUAGE=675]="DETECTLANGUAGE",e[e.REGEXTEST=676]="REGEXTEST",e[e.REGEXREPLACE=677]="REGEXREPLACE",e[e.REGEXEXTRACT=678]="REGEXEXTRACT",e[e.TRIMRANGE=679]="TRIMRANGE",e[e.IMPORTCSV=680]="IMPORTCSV",e[e.IMPORTTEXT=681]="IMPORTTEXT",e[e._TRO_TRAILING=682]="_TRO_TRAILING",e[e._TRO_LEADING=683]="_TRO_LEADING",e[e._TRO_ALL=684]="_TRO_ALL",e[e.TESTFUNCTIONBEGIN=685]="TESTFUNCTIONBEGIN",e[e.GRF=686]="GRF",e[e.RICHERROR=687]="RICHERROR",e[e.COUNTER=688]="COUNTER",e[e.BROKENRECORD=689]="BROKENRECORD",e[e.STREAM=690]="STREAM",e[e.GETRICHERRORS=691]="GETRICHERRORS",e[e.DBGSTAT=692]="DBGSTAT",e[e.RICHNUMBER=693]="RICHNUMBER",e[e.RICHERNUMBER=694]="RICHERNUMBER",e[e.DBGWRITE=695]="DBGWRITE",e[e.TEST=696]="TEST",e[e.AAC=697]="AAC",e[e.AWC=698]="AWC",e[e.PARSEDEXPRESSION=699]="PARSEDEXPRESSION",e[e.AGE_CONTACTTEST=700]="AGE_CONTACTTEST",e[e.FIRSTNAME_CONTACTTEST=701]="FIRSTNAME_CONTACTTEST",e[e.FULLNAME_CONTACTTEST=702]="FULLNAME_CONTACTTEST",e[e.LASTNAME_CONTACTTEST=703]="LASTNAME_CONTACTTEST",e[e.TRANSLATENAME_CONTACTTEST=704]="TRANSLATENAME_CONTACTTEST",e[e.ARRAYVALUE=705]="ARRAYVALUE",e[e.RECORD=706]="RECORD",e[e.DISPLAYSTRING_GENERALTEST=707]="DISPLAYSTRING_GENERALTEST",e[e.LAMBDADOC=708]="LAMBDADOC",e[e.REFIDENTITY=709]="REFIDENTITY",e[e.PQEVALUATE=710]="PQEVALUATE",e[e.REFTYPE=711]="REFTYPE",e[e.LETREC=750]="LETREC",e[e.NESTEDRECORD=751]="NESTEDRECORD"}(a||(t.WorksheetFuncId=a={})),t.worksheetFuncEnglishNames=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[669,"PYTHON_STR"],[670,"PYTHON_TYPE"],[671,"PYTHON_TYPENAME"],[672,"_FF"],[682,"_TRO_TRAILING"],[683,"_TRO_LEADING"],[684,"_TRO_ALL"],[700,"AGE_CONTACTTEST"],[701,"FIRSTNAME_CONTACTTEST"],[702,"FULLNAME_CONTACTTEST"],[703,"LASTNAME_CONTACTTEST"],[704,"TRANSLATENAME_CONTACTTEST"],[707,"DISPLAYSTRING_GENERALTEST"]].reduce(((e,t)=>(e[t[0]]=t[1],e)),[]);const i=[];t.worksheetFuncTypes=[[1,255,i,[57],i,1,0,32],[1,3,[36,831,831],i,i,823,0,64],[1,1,[271],i,i,4,0,64],[1,1,[271],i,i,4,0,64],[1,255,i,[305],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[0,1,[16],i,i,33,0,0],[0,1,[16],i,i,33,0,0],[0,0,i,i,i,3,0,32],[2,255,[1],[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,2,[1,1],i,i,2,0,64],[1,3,[1,65,4],i,i,2,0,64],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[0,0,i,i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,3,[263,48,48],i,i,263,0,0],[2,4,[48,1,1,1],i,i,311,0,0],[2,2,[2,1],i,i,2,0,64],[3,3,[2,1,1],i,i,2,0,64],[1,1,[2],i,i,1,0,64],[1,1,[7],i,i,1,0,64],[0,0,i,i,i,4,0,32],[0,0,i,i,i,4,0,32],[1,255,i,[52],i,4,0,32],[1,255,i,[52],i,4,0,32],[1,1,[4],i,i,4,0,32],[2,2,[1,1],i,i,1,0,0],[3,3,[16,83,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[1,255,i,[49],i,1,0,32],[3,3,[16,19,18],i,i,1,0,0],[2,2,[263,2],i,i,2,0,64],[1,4,[48,112,84,84],i,i,32,0,0],[1,4,[48,112,112,84],i,i,32,0,0],[1,4,[48,112,84,84],i,i,32,0,0],[1,4,[48,112,112,84],i,i,32,0,0],[1,1,[16],i,i,512,0,2],[0,1,[4],i,i,512,0,2],[0,1,[575],i,i,512,0,2],[3,5,[1,1,1,1,1],i,i,1,0,0],[3,5,[1,1,1,1,1],i,i,1,0,0],[3,5,[1,1,1,1,1],i,i,1,0,0],[3,5,[1,1,1,1,1],i,i,1,0,0],[3,6,[1,1,1,1,1,1],i,i,1,0,0],[3,3,[48,1,1],i,i,1,0,32],[1,2,[48,1],i,i,1,0,0],[0,0,i,i,i,1,16383,0],[2,3,[263,305,17],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,2,[1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[0,0,i,i,i,1,16383,0],[1,1,[16],i,i,1,0,0],[1,1,[48],i,i,1,0,0],[1,1,[48],i,i,1,0,0],[3,5,[16,65,65,65,65],i,i,16,16383,0],[2,2,[2,16],i,i,16,0,2],[2,2,[16,16],i,i,2,0,2],[0,3,[66,81,16],i,i,4,0,2],[2,3,[2,2,1],i,i,1,0,64],[1,1,[39],i,i,32,0,0],[0,2,[1,24],i,i,4,0,2],[0,0,i,i,i,4,0,2],[1,1,[303],i,i,1,0,0],[0,1,[4],i,i,4,0,2],[1,2,[2,63],i,i,4,0,2],[0,0,i,i,i,50,0,2],[1,1,[16],i,i,47,0,2],[0,2,[65,66],i,i,32,0,2],[4,5,[87,117,117,1,117],i,i,4,0,4],[0,2,[1,66],i,i,32,0,2],[0,0,i,i,i,16,0,2],[0,0,i,i,i,16,0,2],[0,1,[1],i,i,4,0,2],[2,2,[1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,255,[33],[831],i,823,0,0],[3,4,[263,49,49,4],i,i,295,0,0],[3,4,[263,49,49,4],i,i,295,0,0],[0,2,[66,65],i,i,32,0,2],[1,7,[2,65,66,67,65,65,2],i,i,575,0,2],[1,1,[63],i,i,4,0,64],[1,1,[18],i,i,2,0,2],[1,2,[2,4],i,i,6,0,2],[2,2,[16,47],i,i,4,0,2],[1,2,[1,1],i,i,1,0,0],[1,4,[2,1,4,4],i,i,7,0,2],[1,1,[1],i,i,2,0,64],[1,1,[2],i,i,2,0,64],[1,1,[2],i,i,2,0,64],[1,1,[2],i,i,2,0,64],[1,2,[2,9],i,i,2,0,64],[1,2,[2,9],i,i,2,0,64],[2,2,[258,258],i,i,4,0,64],[1,1,[2],i,i,2,0,64],[4,4,[2,1,1,2],i,i,2,0,64],[3,4,[2,2,2,2],i,i,2,0,64],[1,1,[2],i,i,1,0,0],[0,3,[66,65,66],i,i,32,0,2],[0,1,[2],i,i,2,0,2],[2,3,[2,2,1],i,i,1,0,64],[1,2,[2,16],i,i,303,16383,0],[1,1,[271],i,i,4,0,64],[1,1,[399],i,i,4,0,64],[1,1,[399],i,i,4,0,64],[1,1,[399],i,i,4,0,64],[1,1,[23],i,i,2,0,0],[1,1,[23],i,i,1,0,0],[1,2,[2,1],i,i,1,0,2],[1,1,[1],i,i,1,0,2],[1,1,[1],i,i,1,0,2],[1,1,[1],i,i,2,0,2],[2,2,[1,1],i,i,2,0,2],[2,2,[1,2],i,i,1,0,2],[2,2,[1,2],i,i,1,0,2],[1,2,[1,1],i,i,1,0,2],[1,1,[3],i,i,1,0,64],[1,1,[3],i,i,1,0,64],[3,3,[1,1,1],i,i,1,0,0],[4,4,[1,1,1,1],i,i,1,0,0],[4,5,[1,1,1,1,1],i,i,1,0,0],[1,3,[2,66,65],i,i,2,0,2],[1,2,[16,4],i,i,2,0,2],[1,2,[2,4],i,i,16,0,2],[1,2,[2,4],i,i,16,16383,0],[1,255,[2,3,66,66,66,65,67,66,67],[66],i,3,0,2],[1,255,[3],[127],i,575,0,2],[0,1,[3],i,i,1,0,2],[2,4,[3,115,83,3],i,i,1,0,2],[3,5,[3,83,115,83,3],i,i,1,0,2],[4,5,[3,3,3,4,3],i,i,4,0,2],[4,5,[3,3,3,4,3],i,i,4,0,2],[4,5,[3,3,3,3,3],i,i,4,0,2],[0,1,[3],i,i,4,0,2],[2,3,[3,3,3],i,i,4,0,2],[3,4,[3,3,3,3],i,i,4,0,2],[1,3,[1,67,66],i,i,1,0,2],[1,1,[52],i,i,36,0,2],[1,1,[2],i,i,2,0,64],[1,1,[32],i,i,1,0,0],[1,1,[32],i,i,32,0,0],[2,2,[32,32],i,i,32,0,0],[0,2,[2,2],i,i,32,0,2],[4,6,[1,1,1,1,1,1],i,i,1,0,0],[4,6,[1,1,1,1,1,1],i,i,1,0,0],[1,255,i,[121],i,1,0,32],[0,2,[1,16],i,i,4,0,2],[3,4,[2,1,1,1],i,i,512,0,2],[1,1,[4],i,i,512,0,2],[0,0,i,i,i,512,0,2],[0,0,i,i,i,512,0,2],[2,2,[2,2],i,i,1,0,2],[2,2,[1,2],i,i,32,0,2],[3,3,[1,18,18],i,i,4,0,2],[2,2,[1,2],i,i,4,0,2],[1,1,[1],i,i,4,0,2],[0,1,[1],i,i,512,0,2],[0,1,[2],i,i,4,0,2],[0,4,[3,3,3,3],i,i,3,0,2],[1,255,i,[113],i,1,0,32],[1,1,[1],i,i,1,0,0],[1,2,[1,16],i,i,47,0,2],[1,1,[1],i,i,47,0,2],[1,2,[1,2],i,i,47,0,2],[1,2,[1,2],i,i,63,0,2],[3,3,[16,19,18],i,i,1,0,0],[1,1,[143],i,i,4,0,64],[0,3,[82,65,65],i,i,2,0,2],[0,4,[66,82,17,17],i,i,1,0,2],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[1,2,[1,1],i,i,1,0,0],[1,1,[143],i,i,4,0,64],[3,3,[16,83,18],i,i,1,0,0],[1,1,[3],i,i,4,0,2],[1,1,[3],i,i,4,0,2],void 0,void 0,[1,2,[1,1],i,i,2,0,192],[2,3,[2,2,1],i,i,1,0,192],[2,3,[2,2,1],i,i,1,0,192],[4,4,[2,1,1,2],i,i,2,0,192],[1,2,[2,9],i,i,2,0,192],[1,2,[2,9],i,i,2,0,192],[3,3,[2,1,1],i,i,2,0,192],[1,1,[2],i,i,1,0,192],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[1,1,[2],i,i,2,0,192],[1,1,[2],i,i,2,0,192],[2,3,[1,16,4],i,i,1,0,32],void 0,void 0,[2,5,[1,65,65,68,66],i,i,2,0,0],[2,3,[1,1,4],i,i,1,0,0],[0,0,i,i,i,1,16383,0],[5,7,[1,1,1,1,1,1,4],i,i,1,0,0],[0,0,i,i,i,512,0,2],[1,1,[12],i,i,512,0,2],[0,0,i,i,i,512,0,2],[1,3,[2,82,84],i,i,512,0,2],[1,255,i,[49],i,1,0,32],[1,255,i,[32],i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[16,19,18],i,i,263,0,0],[2,11,[1,18,17,17,18,17,17,115,84,21,17],i,i,2,0,2],[0,1,[4],i,i,4,0,2],[0,0,i,i,i,16,0,2],[0,2,[2,2],i,i,4,0,2],[0,3,[2,2,2],i,i,4,0,2],[2,5,[2,23,23,23,23],i,i,2,0,66],[2,4,[2,1,1,2],i,i,1,0,2],[1,4,[2,66,65,65],i,i,1,0,2],[1,1,[2],i,i,3,16383,0],[0,0,i,i,i,2,0,2],[1,5,[1,2,1,1,1],i,i,47,0,2],[4,5,[1,1,1,1,1],i,i,1,0,0],[0,1,[4],i,i,512,0,2],void 0,void 0,[0,1,[1],i,i,512,0,2],[2,2,[48,48],i,i,32,0,32],[0,2,[66,96],i,i,2,0,2],[1,1,[2],i,i,4,0,2],[1,255,[17],[127],i,575,0,192],[1,1,[3],i,i,4,0,2],[1,1,[2],i,i,63,0,2],[1,2,[1,3],i,i,47,0,2],[1,3,[1,3,1],i,i,47,0,2],[1,3,[2,66,4],i,i,4,0,2],[1,1,[15],i,i,1,0,0],[0,1,[2],i,i,4,0,2],[0,1,[2],i,i,4,0,2],[0,2,[99,66],i,i,4,0,2],[3,3,[3,1,4],i,i,4,0,2],[3,3,[3,1,4],i,i,4,0,2],[2,3,[2,3,66],i,i,1,0,2],[1,2,[1,2],i,i,35,0,2],[1,255,i,[49],i,1,0,32],[3,5,[1,1,1,65,65],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,5,[1,1,1,65,65],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[4,4,[1,1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[3,3,[1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[3,3,[1,32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[4,4,[32,32,1,1],i,i,1,0,0],[3,4,[32,32,1,65],i,i,1,0,0],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[2,3,[49,1,1],i,i,1,0,32],[2,2,[49,1],i,i,1,0,32],[2,2,[49,1],i,i,1,0,32],[2,2,[49,1],i,i,1,0,32],[2,2,[49,1],i,i,1,0,32],[2,3,[49,1,65],i,i,1,0,32],[1,255,i,[32],i,1,0,32],[2,2,[49,1],i,i,1,0,32],[2,2,[1,1],i,i,1,0,0],void 0,[3,4,[2,1,1,1],i,i,1,0,130],[2,3,[2,1,1],i,i,1,0,130],[1,255,i,[2],i,2,0,64],[2,2,[1,1],i,i,1,0,0],[2,9,[66,2,66,65,65,65,66,66,66],i,i,2,0,2],[1,2,[1,2],i,i,35,0,2],[1,3,[1,66,2],i,i,35,0,2],[1,4,[1,66,66,2],i,i,7,0,2],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,255,[1],[16],i,1,0,0],[2,3,[16,15,16],i,i,1,0,64],[2,2,[16,15],i,i,1,0,64],[1,1,[16],i,i,1,0,0],[1,2,[1,2],i,i,19,0,2],[1,1,[33],i,i,33,0,2],[4,4,[1,1,1,1],i,i,1,0,0],[3,3,[1,1,2],i,i,1,0,128],[1,1,[1],i,i,2,0,192],[2,2,[1,1],i,i,2,0,192],[1,2,[1,5],i,i,2,0,0],[0,4,[66,66,66,65],i,i,6,0,2],[0,5,[66,66,66,66,65],i,i,6,0,2],[1,2,[1,2],i,i,19,0,2],[2,255,[18,18],[2,79],i,15,0,0],[1,2,[2,39],i,i,39,0,0],[1,1,[16],i,i,2,0,128],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,255,i,[49],i,1,0,32],[1,1,[1],i,i,2,0,64],[1,1,[1],i,i,2,0,192],[1,1,[3],i,i,2,0,192],[1,1,[1],i,i,2,0,192],[1,1,[1],i,i,2,0,192],[1,1,[1],i,i,2,0,192],[1,1,[2],i,i,1,0,192],[1,1,[2],i,i,4,0,192],[1,1,[1],i,i,1,0,192],[1,1,[1],i,i,1,0,192],[1,1,[1],i,i,1,0,192],[3,255,[2,2],[2],i,2,0,0],[1,255,[2],[50],i,15,0,0],[2,3,[2,50,2],i,i,10,0,0],[3,3,[2,2,2],i,i,15,0,0],[3,4,[2,2,1,2],i,i,10,0,0],[1,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,3,[95,95,95],i,i,9,0,0],[1,255,i,[127],i,9,0,0],[1,255,i,[127],i,9,0,0],[4,4,[95,95,95,127],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,3,[127,127,95],i,i,9,0,0],[3,3,[95,127,127],i,i,9,0,0],[5,6,[95,95,95,95,95,95],i,i,9,0,0],[5,6,[95,95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[3,3,[95,95,95],i,i,9,0,0],[3,3,[95,95,95],i,i,9,0,0],[3,3,[95,95,95],i,i,9,0,0],[6,7,[95,95,95,95,95,95,95],i,i,9,0,0],[6,7,[95,95,95,95,95,95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[6,6,[95,95,95,95,95,95],i,i,9,0,0],[6,6,[95,95,95,95,95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,3,[95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[5,6,[95,95,95,95,95,95],i,i,9,0,0],[5,6,[95,95,95,95,95,95],i,i,9,0,0],[7,8,[95,95,95,95,95,95,95,95],i,i,9,0,0],[7,8,[95,95,95,95,95,95,95,95],i,i,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],i,i,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,16383,0],[1,2,[95,95],i,i,9,0,0],[6,7,[95,95,95,95,95,95,95],i,i,9,0,128],[6,7,[95,95,95,95,95,95,95],i,i,9,0,0],[3,3,[95,95,95],i,i,9,0,0],[6,8,[95,95,95,95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[2,3,[95,95,127],i,i,9,0,0],[2,3,[95,95,127],i,i,9,0,0],[1,255,i,[127],i,9,0,0],[1,255,i,[127],i,9,0,0],[1,255,i,[127],i,9,0,0],[2,2,[95,127],i,i,9,0,0],[3,4,[2,2,1,2],i,i,10,0,0],[2,5,[2,50,2,1,2],i,i,10,0,64],[1,1,[2],i,i,9,0,0],[2,2,[47,575],i,i,303,0,0],[2,255,i,[16,15],i,1,0,64],[3,255,[16],[16,15],i,1,0,64],[2,3,[16,15,16],i,i,1,0,64],[3,255,[16],[16,15],i,1,0,64],[3,254,[1,1,48,17],[16],i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[3,3,[1,1,4],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,254,i,[32],i,32,0,32],[1,254,i,[32],i,1,0,32],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[2,2,[49,1],i,i,1,0,32],[2,2,[49,1],i,i,1,0,32],[2,3,[49,1,65],i,i,1,0,32],[2,3,[49,1,65],i,i,1,0,32],[3,3,[1,1,4],i,i,1,0,0],[2,2,[49,1],i,i,1,0,32],[2,2,[49,1],i,i,1,0,32],[2,3,[1,16,4],i,i,1,0,32],[2,3,[1,16,4],i,i,1,0,32],[1,254,i,[49],i,1,0,32],[1,254,i,[49],i,1,0,32],[3,3,[1,1,4],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[1,254,i,[49],i,1,0,32],[1,254,i,[49],i,1,0,32],[4,4,[1,1,1,4],i,i,1,0,0],[2,4,[95,95,75,127],i,i,9,0,0],[2,4,[95,95,75,127],i,i,9,0,0],[2,2,[1,1],i,i,1,0,128],[1,2,[1,65],i,i,1,0,128],void 0,[4,6,[1,1,1,4,65,65],i,i,1,0,0],[3,5,[1,1,1,65,65],i,i,1,0,0],[3,3,[1,1,4],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[5,5,[1,1,1,1,4],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[2,2,[1,4],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[4,4,[32,32,1,1],i,i,1,0,0],[2,3,[49,1,1],i,i,1,0,32],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[1],i,i,1,0,0],[1,2,[1,65],i,i,1,0,128],[1,2,[1,65],i,i,1,0,128],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[1,254,i,[52],i,4,0,32],[3,3,[1,1,1],i,i,1,0,0],[2,3,[1,1,65],i,i,2,0,0],[2,2,[2,1],i,i,1,0,0],[2,2,[3,3],i,i,1,0,64],[3,4,[1,1,1,65],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,254,i,[49],i,1,0,32],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,2,0,0],[1,1,[2],i,i,1,0,0],[1,1,[1],i,i,32,0,0],[1,1,[2],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,3,[2,66,66],i,i,1,0,0],[0,1,[50],i,i,1,16383,32],[0,1,[48],i,i,1,16383,32],[1,1,[16],i,i,2,16383,0],[1,1,[16],i,i,4,0,0],[2,2,[47,575],i,i,303,0,0],[1,3,[1,65,65],i,i,1,0,0],[1,3,[1,65,65],i,i,1,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[2,2],i,i,47,0,64],[1,1,[2],i,i,10,0,64],[1,1,[2],i,i,10,0,64],[3,6,[1,48,48,65,65,65],i,i,1,0,0],[3,7,[1,48,48,65,65,65,65],i,i,1,0,0],[2,4,[48,48,65,65],i,i,1,0,0],[3,3,[1,32,32],i,i,1,0,0],[3,6,[48,48,1,65,65,65],i,i,1,0,0],[3,254,[16],[16,15],i,1,0,64],[3,254,[16],[16,15],i,1,0,64],[3,254,[114,68],[114],i,2,0,96],[1,254,i,[114],i,2,0,96],[2,254,i,[44,575],i,831,0,64],[3,254,[47],[575,575],[575],831,0,64],[1,1,[1527],i,i,1503,0,233],[2,254,i,[113,113],i,1,0,33],[1,1,[16],i,i,48,0,41],[2,3,[271,2,4],i,i,303,0,105],[2,2,[271,2],i,i,303,0,97],[2,3,[48,48,111],i,i,303,0,65],[1,4,[160,96,96,4],i,i,32,0,65],[1,3,[160,4,4],i,i,32,0,65],[2,2,[2,256],i,i,1,0,80],[3,3,[2,49,1],i,i,1,0,48],[3,3,[2,49,1],i,i,1,0,48],[2,254,[2],[49],i,1,0,48],[2,7,[34,2,65,65,65,74,68],i,i,1,0,65],[1,3,[2,65,65],i,i,2,0,65],[2,6,[2,34,65,65,65,74],i,i,2,0,65],[2,6,[2,34,65,65,65,74],i,i,2,0,65],[2,6,[2,98,98,68,65,495],i,i,32,0,65],[1,4,[32,96,96,4],i,i,32,0,81],[2,2,[4,16],i,i,32,0,49],[2,4,[391,48,65,65],i,i,1,0,65],[3,6,[391,48,48,511,65,65],i,i,319,0,65],[2,254,[160],[160,65],i,32,0,65],[0,5,[65,65,65,65,68],i,i,32,16383,1],[1,4,[65,65,65,65],i,i,32,0,1],[2,254,[258,1,65,65,65],[65],i,32,0,97],[2,3,[32,1,463],i,i,32,0,65],[1,254,i,[48],i,32,0,33],[1,254,i,[48],i,32,0,33],[2,254,[48],[33],i,32,0,1],[2,254,[48],[33],i,32,0,1],[3,254,i,[319,319],[319],319,0,1],[1,254,i,[319],i,319,0,1],[3,3,[65,65,319],i,i,32,0,1],[1,254,i,[319],i,319,0,1],[1,1,[271],i,i,4,0,1],[1,1,[271],i,i,9,0,1],[0,0,i,i,i,319,0,1],[2,2,[49,49],i,i,9,0,1],[1,2,[399,1],i,i,2,0,65],[1,2,[32,1],i,i,2,0,65],[2,2,[15,2],i,i,256,0,97],[1,3,[48,65,68],i,i,32,0,97],[1,3,[48,65,68],i,i,32,0,97],[2,3,[32,1,463],i,i,32,0,65],[2,254,[48],[319],i,32,0,65],[3,3,[511,48,271],i,i,319,0,65],[3,3,[511,48,271],i,i,32,0,65],[1,2,[48,271],i,i,32,0,65],[1,2,[48,271],i,i,32,0,65],[1,1,[1535],i,i,4,0,65],[2,4,[32,65,65,495],i,i,32,0,65],[2,3,[48,65,65],i,i,48,0,65],[2,3,[48,65,65],i,i,48,0,65],[2,254,[1,1],[447],i,303,0,97],void 0,[1,5,[2,66,65,65,65],i,i,264,0,65],[2,2,[15,2],i,i,271,0,97],[3,8,[112,96,96,65,65,96,96,65],i,i,32,0,65],[4,11,[112,112,96,96,65,65,96,65,96,96,65],i,i,32,0,65],[1,1,[2],i,i,264,0,9],[1,1,[256],i,i,2,0,97],[1,1,[256],i,i,2,0,97],[1,1,[256],i,i,2,0,97],[3,254,[256,2,4],[47],i,303,0,105],[2,254,[256,2],[47],i,303,0,97],[1,3,[2,2,2],i,i,2,0,97],[1,1,[2],i,i,2,0,97],[2,3,[2,2,1],i,i,4,0,65],[3,5,[2,2,2,1,1],i,i,2,0,65],[2,4,[2,2,1,1],i,i,34,0,65],[1,3,[48,65,65],i,i,16,0,65],[1,3,[2,1,2],i,i,32,0,65],[1,5,[2,35,1,2,1],i,i,32,0,65],[1,1,[16],i,i,16,0,73],[1,1,[16],i,i,16,0,73],[1,1,[16],i,i,16,0,73],[0,0,i,i,i,1,0,1],[1,2,[287,2],i,i,288,0,97],[1,2,[1,1],i,i,10,0,97],[0,0,i,i,i,1,0,1],[3,254,[47],[2,47],i,47,0,97],[0,1,[1],i,i,1,0,1],[0,1,[1],i,i,32,0,1],[1,2,[2,1],i,i,47,0,1],[1,1,[1],i,i,264,0,97],[1,1,[1],i,i,264,0,97],[2,2,[2,47],i,i,47,0,1],[1,254,[2],[1151],i,1087,0,96],[1,254,[1],[1151],i,1087,0,0],[1,254,[1],[1151],i,1087,0,0],[1,1,[16],i,i,32,0,1],[1,1,[256],i,i,2,0,97],[1,1,[256],i,i,2,0,97],[1,1,[256],i,i,2,0,97],[1,1,[256],i,i,2,0,97],[2,2,[256,2],i,i,2,0,97],[1,1,[32],i,i,256,0,97],[3,254,[15],[2,47],i,303,0,97],[1,1,[256],i,i,2,0,97],[4,254,[256,66,66,66],[66,96],i,319,0,1],[1,1,[48],i,i,16,0,97],[2,2,[2,2],i,i,34,0,65],[1,1,[16],i,i,2,0,97],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,254,i,[319,319],[319],319,0,1],[3,254,[15],[2,303],i,303,0,97]].map((e=>void 0===e?void 0:(0,n.functionType)(...e)))},6067:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=t.createResolver=t.resolveGridRef=t.canDenoteCellRef=t.canDenoteUserDefinedFunc=t.canDenoteLocalName=t.relabelFormula=t.createPrinter=t.anonymizeFormula=t.xlMathpack=t.ieeeMathpack=t.parseSignedLiteral=t.parseNumberLiteral=t.parseUint=t.isLineBreak=t.isSpace=t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=t.formatName=t.formatGridRange=t.quoteQualifier=t.formatQualifier=t.shouldQuoteQualifier=t.canonicaliseRangePos=t.formatRangePos=t.canonicaliseCellPos=t.formatCellPos=t.canonicaliseColRange=t.canonicaliseRowRange=t.formatColRange=t.formatRowRange=t.canonicaliseCol=t.canonicaliseRow=t.formatCol=t.formatRow=t.resolvePosition=t.canonicaliseBrackets=t.columnName=t.buildAnnotations=t.adjustFormulaOrigin=t.PackageName=void 0,t.value=t.types=t.testUtil=t.signature=t.printServiceTypes=t.printService=t.mathpackXL=t.location=t.formulaModule=t.config=t.reducePledge=t.reduceBottomUp=t.PledgeReducer=t.zipVisitor=t.ZipVisitor=t.depthVisitor=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=t.bindVisitor=t.visitCellRef=void 0;const n=r(3345);t.PackageName="excel-online-calc-lang";var a=r(3428);Object.defineProperty(t,"adjustFormulaOrigin",{enumerable:!0,get:function(){return a.adjustFormulaOrigin}});var i=r(9525);Object.defineProperty(t,"buildAnnotations",{enumerable:!0,get:function(){return i.buildAnnotations}});var o=r(276);Object.defineProperty(t,"columnName",{enumerable:!0,get:function(){return o.columnName}}),Object.defineProperty(t,"canonicaliseBrackets",{enumerable:!0,get:function(){return o.canonicaliseBrackets}}),Object.defineProperty(t,"resolvePosition",{enumerable:!0,get:function(){return o.resolvePosition}}),Object.defineProperty(t,"formatRow",{enumerable:!0,get:function(){return o.formatRow}}),Object.defineProperty(t,"formatCol",{enumerable:!0,get:function(){return o.formatCol}}),Object.defineProperty(t,"canonicaliseRow",{enumerable:!0,get:function(){return o.canonicaliseRow}}),Object.defineProperty(t,"canonicaliseCol",{enumerable:!0,get:function(){return o.canonicaliseCol}}),Object.defineProperty(t,"formatRowRange",{enumerable:!0,get:function(){return o.formatRowRange}}),Object.defineProperty(t,"formatColRange",{enumerable:!0,get:function(){return o.formatColRange}}),Object.defineProperty(t,"canonicaliseRowRange",{enumerable:!0,get:function(){return o.canonicaliseRowRange}}),Object.defineProperty(t,"canonicaliseColRange",{enumerable:!0,get:function(){return o.canonicaliseColRange}}),Object.defineProperty(t,"formatCellPos",{enumerable:!0,get:function(){return o.formatCellPos}}),Object.defineProperty(t,"canonicaliseCellPos",{enumerable:!0,get:function(){return o.canonicaliseCellPos}}),Object.defineProperty(t,"formatRangePos",{enumerable:!0,get:function(){return o.formatRangePos}}),Object.defineProperty(t,"canonicaliseRangePos",{enumerable:!0,get:function(){return o.canonicaliseRangePos}}),Object.defineProperty(t,"shouldQuoteQualifier",{enumerable:!0,get:function(){return o.shouldQuoteQualifier}}),Object.defineProperty(t,"formatQualifier",{enumerable:!0,get:function(){return o.formatQualifier}}),Object.defineProperty(t,"quoteQualifier",{enumerable:!0,get:function(){return o.quoteQualifier}}),Object.defineProperty(t,"formatGridRange",{enumerable:!0,get:function(){return o.formatGridRange}}),Object.defineProperty(t,"formatName",{enumerable:!0,get:function(){return o.formatName}});var s=r(5096);Object.defineProperty(t,"SpecialPos",{enumerable:!0,get:function(){return s.SpecialPos}}),Object.defineProperty(t,"isR1C1IdentStart",{enumerable:!0,get:function(){return s.isR1C1IdentStart}}),Object.defineProperty(t,"parseCellRef",{enumerable:!0,get:function(){return s.parseCellRef}}),Object.defineProperty(t,"parseGridCellA1",{enumerable:!0,get:function(){return s.parseGridCellA1}}),Object.defineProperty(t,"parseGridRangeA1",{enumerable:!0,get:function(){return s.parseGridRangeA1}}),Object.defineProperty(t,"parseQualifier",{enumerable:!0,get:function(){return s.parseQualifier}}),Object.defineProperty(t,"wrapPosition",{enumerable:!0,get:function(){return s.wrapPosition}}),n.__exportStar(r(537),t),n.__exportStar(r(9582),t),n.__exportStar(r(2701),t);var u=r(8445);Object.defineProperty(t,"isSpace",{enumerable:!0,get:function(){return u.isSpace}}),Object.defineProperty(t,"isLineBreak",{enumerable:!0,get:function(){return u.isLineBreak}}),Object.defineProperty(t,"parseUint",{enumerable:!0,get:function(){return u.parseUint}}),Object.defineProperty(t,"parseNumberLiteral",{enumerable:!0,get:function(){return u.parseNumberLiteral}}),Object.defineProperty(t,"parseSignedLiteral",{enumerable:!0,get:function(){return u.parseSignedLiteral}}),n.__exportStar(r(3292),t),n.__exportStar(r(9188),t);var l=r(1548);Object.defineProperty(t,"ieeeMathpack",{enumerable:!0,get:function(){return l.ieeeMathpack}});var c=r(4656);Object.defineProperty(t,"xlMathpack",{enumerable:!0,get:function(){return c.xlMathpack}}),n.__exportStar(r(4304),t);var d=r(5029);Object.defineProperty(t,"anonymizeFormula",{enumerable:!0,get:function(){return d.anonymizeFormula}}),Object.defineProperty(t,"createPrinter",{enumerable:!0,get:function(){return d.createPrinter}}),n.__exportStar(r(3616),t);var g=r(9858);Object.defineProperty(t,"relabelFormula",{enumerable:!0,get:function(){return g.relabelFormula}});var m=r(2060);Object.defineProperty(t,"canDenoteLocalName",{enumerable:!0,get:function(){return m.canDenoteLocalName}}),Object.defineProperty(t,"canDenoteUserDefinedFunc",{enumerable:!0,get:function(){return m.canDenoteUserDefinedFunc}}),Object.defineProperty(t,"canDenoteCellRef",{enumerable:!0,get:function(){return m.canDenoteCellRef}}),Object.defineProperty(t,"resolveGridRef",{enumerable:!0,get:function(){return m.resolveGridRef}}),Object.defineProperty(t,"createResolver",{enumerable:!0,get:function(){return m.createResolver}}),n.__exportStar(r(3563),t),n.__exportStar(r(1981),t),n.__exportStar(r(5005),t),n.__exportStar(r(4998),t),n.__exportStar(r(450),t),n.__exportStar(r(3803),t),n.__exportStar(r(8610),t);var h=r(3309);Object.defineProperty(t,"visitFormulaNode",{enumerable:!0,get:function(){return h.visitFormulaNode}}),Object.defineProperty(t,"visitOperatorNode",{enumerable:!0,get:function(){return h.visitOperatorNode}}),Object.defineProperty(t,"visitWSFNode",{enumerable:!0,get:function(){return h.visitWSFNode}}),Object.defineProperty(t,"visitAppHeadNode",{enumerable:!0,get:function(){return h.visitAppHeadNode}}),Object.defineProperty(t,"visitQualifier",{enumerable:!0,get:function(){return h.visitQualifier}}),Object.defineProperty(t,"visitCellRef",{enumerable:!0,get:function(){return h.visitCellRef}}),Object.defineProperty(t,"bindVisitor",{enumerable:!0,get:function(){return h.bindVisitor}}),Object.defineProperty(t,"IdentityVisitor",{enumerable:!0,get:function(){return h.IdentityVisitor}}),Object.defineProperty(t,"identityVisitor",{enumerable:!0,get:function(){return h.identityVisitor}}),Object.defineProperty(t,"ConstVisitor",{enumerable:!0,get:function(){return h.ConstVisitor}}),Object.defineProperty(t,"constVisitor",{enumerable:!0,get:function(){return h.constVisitor}}),Object.defineProperty(t,"voidVisitor",{enumerable:!0,get:function(){return h.voidVisitor}}),Object.defineProperty(t,"DelegatingVisitor",{enumerable:!0,get:function(){return h.DelegatingVisitor}}),Object.defineProperty(t,"BinaryVisitor",{enumerable:!0,get:function(){return h.BinaryVisitor}}),Object.defineProperty(t,"binaryVisitor",{enumerable:!0,get:function(){return h.binaryVisitor}}),Object.defineProperty(t,"ComposeVisitor",{enumerable:!0,get:function(){return h.ComposeVisitor}}),Object.defineProperty(t,"composeVisitor",{enumerable:!0,get:function(){return h.composeVisitor}}),Object.defineProperty(t,"depthVisitor",{enumerable:!0,get:function(){return h.depthVisitor}}),Object.defineProperty(t,"ZipVisitor",{enumerable:!0,get:function(){return h.ZipVisitor}}),Object.defineProperty(t,"zipVisitor",{enumerable:!0,get:function(){return h.zipVisitor}}),Object.defineProperty(t,"PledgeReducer",{enumerable:!0,get:function(){return h.PledgeReducer}}),Object.defineProperty(t,"reduceBottomUp",{enumerable:!0,get:function(){return h.reduceBottomUp}}),Object.defineProperty(t,"reducePledge",{enumerable:!0,get:function(){return h.reducePledge}}),t.config=n.__importStar(r(537)),t.formulaModule=n.__importStar(r(2701)),t.location=n.__importStar(r(3292)),t.mathpackXL=n.__importStar(r(4656)),t.printService=n.__importStar(r(5029)),t.printServiceTypes=n.__importStar(r(3616)),t.signature=n.__importStar(r(5005)),t.testUtil=n.__importStar(r(6120)),t.types=n.__importStar(r(450)),t.value=n.__importStar(r(8610))},8445:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSignedLiteral=t.parseNumberLiteral=t.parseUint=t.isLineBreak=t.isSpace=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6366),u=r(6366),l=r(6366),c=r(4304),d=r(6366),g=r(3803),{codePointSpace:m,codePointLF:h,codePointMinusSign:p,codePointPlusSign:f,codePointSlash:S}=d.codePoint;function v(e){return e===m||e===h}function F(e,t,r,n){(0,i.assertIndex)("calc.parse.parseUint",t,16);let o=0,s=n,c=r.length;for(;s<c;){const n=(0,u.stringCodePointAt)(r,s);if(!e.isNumeral(n))break;const i=e.getOrdinal(n);0===o&&0!==i&&(c=(0,a.fastMin)(c,s+t)),o=10*o+i,s+=(0,l.numCodeUnits)(n)}return s===c&&s<r.length&&e.isNumeral((0,u.stringCodePointAt)(r,s))?[0,n]:[o,s]}function y(e,t,r,n){let a=n;const[i,s]=F(e,5,r,a);if(s===a)return!1;if(i>32767)return!1;if(a=s,!(a<r.length&&r.charCodeAt(a)===S))return!1;a+=1;const[u,l]=F(e,5,r,a);if(l===a)return!1;if(u>32767)return!1;if(a=l,0===u)return[!1,0,a];const c=t.div(t.fromNumber(i),t.fromNumber(u));return(0,o.assertTrue)("calc.lang.tryTokenizeFrac",(0,g.isNumberOper)(c)),[c,u,a]}function b(e,t,r,a,i,d,m){let h,S,b,C=a,A=0,E="",T=!1,R=!1,k=0,N=0,I=c.NumberShape.ASCII;if(!((0,s.stringStartsWith)(r,e.decimalSeparator,a)||a<r.length&&e.isNumeral((0,u.stringCodePointAt)(r,a))))return;const O=()=>{if((d||i&&r.indexOf("%",C)>=0)&&(A-=2,void 0!==h)){const e=t.div(h,t.fromNumber(100));(0,o.assertTrue)("calc.lang.parseNumberLiteral",(0,g.isNumberOper)(e)),h=e,b=c.KnownFormat.Pct}if((0,n.fastAbs)(A)>=309)return{value:void 0,i:C,consumedThousands:T,consumedDecimal:R,numDigDec:k,numShape:I,format:b};let a=t.parse(e,!0,A,E);if(void 0!==h){const e=t.add(a,h);(0,o.assertTrue)("calc.lang.parseNumberLiteral",(0,g.isNumberOper)(e)),a=e}return{value:a,i:C,consumedThousands:T,consumedDecimal:R,numDigDec:k,numShape:I,format:b}};for(;C<r.length;){const t=(0,u.stringCodePointAt)(r,C);if(!e.isNumeral(t))break;if(0!==e.getOrdinal(t))break;(S=e.getNumberShape(t))!==c.NumberShape.ASCII&&(I=S),C+=(0,l.numCodeUnits)(t)}if(m){const n=y(e,t,r,C);if(!1!==n){const[e,t,r]=n;return C=r,!1===e?{value:void 0,i:C,consumedThousands:T,consumedDecimal:R,numDigDec:k,numShape:I,format:b}:(b=t>=10?c.KnownFormat.FractBond:c.KnownFormat.Fract,h=e,O())}}let P=C;for(;C<r.length;){const t=(0,u.stringCodePointAt)(r,C);if(e.isNumeral(t))A+=1,(S=e.getNumberShape(t))!==c.NumberShape.ASCII&&(I=S),C+=(0,l.numCodeUnits)(t);else{if(!(i&&A>0&&(0,s.stringStartsWith)(r,e.thousandsSeparator,C)))break;T=!0,C+=e.thousandsSeparator.length}}if(E+=r.substring(P,C),T){const t=function(e,t,r){let n=r,a="";for(let r=0;r<t.length;){const i=(0,u.stringCodePointAt)(t,r);if(e.isNumeral(i)){const e=(0,l.numCodeUnits)(i);a+=t.substring(r,r+e),r+=e,n-=1}else{if(0===n||!e.isThousandsPosition(n))return;r+=e.thousandsSeparator.length}}return a}(e,E,A);if(void 0===t)return;E=t}if(a<C&&C<r.length&&v(r.charCodeAt(C))){const n=y(e,t,r,C+1);if(!1!==n){const[e,t,r]=n;return C=r,!1===e?{value:void 0,i:C,consumedThousands:T,consumedDecimal:R,numDigDec:k,numShape:I,format:b}:(b=t>=10?c.KnownFormat.FractBond:c.KnownFormat.Fract,h=e,O())}}let M=!1;if((0,s.stringStartsWith)(r,e.decimalSeparator,C)&&(M=C===a,R=!0,C+=e.decimalSeparator.length),0===A)for(;C<r.length;){const t=(0,u.stringCodePointAt)(r,C);if(!e.isNumeral(t))break;if(0!==e.getOrdinal(t))break;A-=1,(S=e.getNumberShape(t))!==c.NumberShape.ASCII&&(I=S),N+=1,C+=(0,l.numCodeUnits)(t)}for(P=C;C<r.length;){const t=(0,u.stringCodePointAt)(r,C);if(!e.isNumeral(t))break;(S=e.getNumberShape(t))!==c.NumberShape.ASCII&&(I=S),k+=1,C+=(0,l.numCodeUnits)(t)}if(E+=r.substring(P,C),k>0&&(k+=N),M&&C<=a+e.decimalSeparator.length)return;const D=function(e,t,r){let n=r;if(n<t.length&&0===e.stringCompareCI("E",t.substring(n,n+1)))n+=1;else{if(!(0,s.stringStartsWith)(t,"**",n))return[0,r];n+=2}let a=!1;if(n<t.length){const e=(0,u.stringCodePointAt)(t,n);((a=e===p)||e===f)&&(n+=(0,l.numCodeUnits)(e))}if(n>=t.length||!e.isNumeral((0,u.stringCodePointAt)(t,n)))return!1;const[i,o]=F(e,10,t,n);return o!==n&&!(i>2147483647)&&[a?-i:i,o]}(e,r,C);if(!1!==D){const[e,t]=D;A+=e,t!==C&&(b=c.KnownFormat.Exp),C=t}return!1===D?{value:void 0,i:C,consumedThousands:T,consumedDecimal:R,numDigDec:k,numShape:I,format:b}:O()}t.isSpace=v,t.isLineBreak=function(e){return e===h},t.parseUint=F,t.parseNumberLiteral=b,t.parseSignedLiteral=function(e,t,r,n,a){let i=n,o=!1;if(i<r.length){const e=r.charCodeAt(i);if((e===f||e===p)&&(o=e===p,i+=1,a))for(;i<r.length&&v(r.charCodeAt(i));)i+=1}const s=b(e,t,r,i,!1,!1,!1);return void 0===s?.value?[t.zero,n]:(i=s.i,[o?t.neg(s.value):s.value,i])}},3292:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridCell=t.isSheetGridRange=t.isGridCell=t.isSheetIndex=t.userDefinedFuncLoc=t.nameLoc=t.nameScope=t.documentScope=t.originCell=t.sheetGridCell=t.sheetGridRange=t.sheetGridCube=t.gridCell=t.gridRange=t.unsafeGridRange=t.sheetRangeIndexes=t.allSheetsRange=t.sheetIndex=t.sheetRange=t.structRefColumnLoc=t.documentLoc=t.sheetCols=t.sheetRows=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceRange=t.lexicalSourceCell=t.NameSource=t.LexicalKind=void 0;const n=r(6366),a=r(6366),i=r(6366);var o,s;function u(e){return{kind:o.Cell,range:e}}function l(e){return{kind:o.Range,range:e}}function c(e,t,r){return{document:e,index:t,index2:r}}function d(e,t){return c(e,t,t)}function g(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function m(e,t){return{sheet:e,range:t}}function h(e){return{document:e,index:void 0}}function p(e){return e.index===e.index2}function f(e){return 1===e.rows&&1===e.cols}function S(e){return f(e.range)}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.WSF=7]="WSF",e[e.UDF=8]="UDF",e[e.Other=9]="Other"}(o||(t.LexicalKind=o={})),function(e){e.AppHead="AppHead",e.Plain="Plain",e.StructRef="StructRef",e.Indirect="Indirect"}(s||(t.NameSource=s={})),t.lexicalSourceCell=u,t.lexicalSourceRange=l,t.lexicalSourceGrid=function(e,t){switch(e){case o.Cell:return S(t)?u(t):(0,i.assertFalse)("calc.lang.lexicalSourceGrid: expected cell");case o.Range:return l(t)}},t.lexicalSourceName=function(e){return{kind:o.NameManager,name:e}},t.lexicalSourceWSF=function(e){return{kind:o.WSF,id:e}},t.lexicalSourceUDF=function(e){return{kind:o.UDF,udf:e}},t.sheetRows=1<<20,t.sheetCols=16384,t.documentLoc=function(e,t){return{path:e,name:t}},t.structRefColumnLoc=function(e,t,r,n){return{name:e,range:t,hasHeadersRow:r,hasTotalsRow:n}},t.sheetRange=c,t.sheetIndex=d,t.allSheetsRange=function(e){return{document:e,index:void 0,index2:void 0}},t.sheetRangeIndexes=function(e,t){return{sheets:e,position:t}},t.unsafeGridRange=g,t.gridRange=function(e,r,i,o){return(0,n.assertIndex)("calc.lang.gridRange",e,t.sheetRows),(0,n.assertIndex)("calc.lang.gridRange",r,t.sheetCols),(0,a.assertPositiveLength)("calc.lang.gridRange",i,t.sheetRows-e),(0,a.assertPositiveLength)("calc.lang.gridRange",o,t.sheetCols-r),g(e,r,i,o)},t.gridCell=function(e,r){return(0,n.assertIndex)("calc.lang.gridCell",e,t.sheetRows),(0,n.assertIndex)("calc.lang.gridCell",r,t.sheetCols),g(e,r,1,1)},t.sheetGridCube=m,t.sheetGridRange=m,t.sheetGridCell=m,t.originCell=m,t.documentScope=h,t.nameScope=function(e,t){return void 0===t?h(e):d(e,t)},t.nameLoc=function(e,t){return{scope:e,name:t}},t.userDefinedFuncLoc=function(e,t){return{document:e,id:t}},t.isSheetIndex=p,t.isGridCell=f,t.isSheetGridRange=function(e){return p(e.sheet)},t.isSheetGridCell=S},9188:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatScientificLeft=t.numberComponents=void 0;const n=r(6366);t.numberComponents=(0,n.typedInstanceCreator)()(((e,t,r)=>({sign:e,mantissa:t,exponent:r}))),t.formatScientificLeft=function(e,t){if(t<=1)return t;const r=e%t;return 0===r?t:r<0?r+t:r}},1548:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ieeeMathpack=void 0;const n=r(8610),a=r(6366),i=r(9188),o=r(6366),s=r(6366),u=r(6366),l=r(6366),c=r(450),d=r(6366),{codePointDigitZero:g}=o.codePoint;function m(e){return{kind:c.OperKind.Number,_valueIEEE:e}}const h=m(0),p=m(1),f=m(Math.PI);function S(e){return isFinite(e)?m(e):n.numErrorOper}function v(e,t){const{_valueIEEE:r}=e,{_valueIEEE:n}=t;return r<n?-1:r>n?1:0}function F(e,t){const r=void 0===t?e.toExponential():e.toExponential(t),n=r.indexOf("e"),a=!(0,s.stringStartsWith)(r,"-"),i=r.substring(a?0:1,n).replace(".",""),o=parseInt(r.substring(n+1),10)+1;return function(e){for(let t=0;t<e.length;t+=1)if(e.charCodeAt(t)!==g)return!1;return!0}(i)?{sign:a,mantissa:"",exponent:0}:{sign:a,mantissa:i,exponent:o}}const y=["0","1","2","3","4","5","6","7","8","9"];function b(e){const{_valueIEEE:t}=e;return m(t<0?Math.ceil(t):Math.floor(t))}function C(e){const{_valueIEEE:t}=e;return m(Math.floor(t))}function A(e){return e.substring(0,1)+"."+e.substring(1)}t.ieeeMathpack={zero:h,one:p,pi:f,add:(e,t)=>S(e._valueIEEE+t._valueIEEE),sub:(e,t)=>S(e._valueIEEE-t._valueIEEE),mul:(e,t)=>S(e._valueIEEE*t._valueIEEE),div:function(e,t){const{_valueIEEE:r}=e,{_valueIEEE:a}=t;return 0===a?n.div0ErrorOper:S(r/a)},power:function(e,t){const{_valueIEEE:r}=e,{_valueIEEE:a}=t,i=r**a;return isFinite(i)?m(i):isNaN(i)?n.div0ErrorOper:n.numErrorOper},percent:e=>m(e._valueIEEE/100),neg:e=>m(-e._valueIEEE),compare:v,formatGeneral:function({decimalSeparator:e},t,r){const{_valueIEEE:n}=t;let a=String(n).replace("e","E");return"."!==e&&(a=a.replace(".",e)),a},formatFixed:function(e,t,r){const{_valueIEEE:n}=e;let{sign:a,mantissa:o,exponent:s}=F(n),u=r+(s+t);if(0===u){const e=parseFloat("5e"+String(s-1));if(Math.abs(n)>=e)return(0,i.numberComponents)(a,"1",s+t+1)}if(u<1)return(0,i.numberComponents)(!0,"",0);u<=21&&(({sign:a,mantissa:o,exponent:s}=F(n,u-1)),u=r+(s+t));const l=o.substring(0,u);return(0,i.numberComponents)(a,l,0===l.length?0:s+t)},formatScientific:function(e,t,r){const{_valueIEEE:n}=e;let{sign:a,mantissa:o,exponent:s}=F(n),l=(0,i.formatScientificLeft)(s,t),c=l+r;if((0,u.assertTrue)("calc.lang.ieeeFormatScientific",c>0),0===c){const e=parseFloat("5e"+String(s-1));if(Math.abs(n)>=e)return(0,i.numberComponents)(a,"",s+1)}if(c<1)return(0,i.numberComponents)(!0,"",0);c<=21&&(({sign:a,mantissa:o,exponent:s}=F(n,c-1)),l=(0,i.formatScientificLeft)(s,t),c=l+r);const d=o.substring(0,c);return(0,i.numberComponents)(a,d,0===d.length?0:s)},parse:function(e,t,r,n){return m(Number((t?"":"-")+"0."+function({getOrdinal:e},t){let r="";for(const n of(0,d.codePointIterator)(t))r+=y[e(n)];return r}(e,n)+"E"+String(r)))},trunc:b,ceil:function(e){const{_valueIEEE:t}=e;return m(Math.ceil(t))},floor:C,abs:e=>m(Math.abs(e._valueIEEE)),cond:e=>v(e,h),cond2:v,fromNumber:m,toNumber:e=>e._valueIEEE,sqrt:e=>S(Math.sqrt(e._valueIEEE)),exp:e=>S(Math.exp(e._valueIEEE)),ln:e=>S(Math.log(e._valueIEEE)),log:e=>S(Math.log(e._valueIEEE)/Math.LN10),sin:e=>m(Math.sin(e._valueIEEE)),cos:e=>m(Math.cos(e._valueIEEE)),tan:e=>m(Math.tan(e._valueIEEE)),asin:e=>S(Math.asin(e._valueIEEE)),acos:e=>S(Math.acos(e._valueIEEE)),atan:e=>S(Math.atan(e._valueIEEE)),atan2:(e,t)=>m(Math.atan2(t._valueIEEE,e._valueIEEE)),mod:(e,t)=>m(e._valueIEEE%t._valueIEEE),round:function(e,t){const{_valueIEEE:r}=e;if(0===r)return h;const{exponent:n}=F(r),a=b(t)._valueIEEE+n;if(0===a){const e=parseFloat("5e"+String(n-1));if(Math.abs(r)>=e)return S((r<0?-1:1)*parseFloat("10e"+String(n-1)))}return a<1?h:a>21?e:S(parseFloat(r.toExponential(a-1)))},roundUp:function(e,t){const{_valueIEEE:r}=e;if(0===r)return h;const{sign:n,mantissa:a,exponent:i}=F(r),o=b(t)._valueIEEE+i;return o<1?S(parseFloat((n?"":"-")+"10e"+String(i-1-o))):o>21?e:S(parseFloat((n?"":"-")+function(e,t){if(e.length<=t)return A(e);const r=e.substring(0,t);let n=0;for(let e=r.length-1;e>=0&&r.charCodeAt(e)-g==9;e-=1)n+=1;return n===r.length?"10":A(r.substring(0,r.length-n-1)+String.fromCharCode(r.charCodeAt(r.length-n-1)+1))}(a,o)+"e"+String(i-1)))},roundDown:function(e,t){const{_valueIEEE:r}=e;if(0===r)return h;const{sign:n,mantissa:a,exponent:i}=F(r),o=b(t)._valueIEEE+i;if(o<1)return h;if(o>21)return e;const s=a.substring(0,o);return S(parseFloat((n?"":"-")+A(s)+"e"+String(i-1)))},tenTo:function(e){return(0,l.assertInteger)("calc.lang.ieeeTenTo",e),S(Math.pow(10,e))},checkAlmostCancellation:(e,t)=>t,fix:function(e){const{_valueIEEE:t}=e,r=Math.abs(t);return r>=4294967296?4294967295:Math.floor(r)},lfix:function(e){const t=b(e)._valueIEEE;return t<-2147483648||t>2147483647?-2147483648:t},sfix:function(e){const t=C(e)._valueIEEE;return t<-2147483648?-2147483648:t>2147483647?2147483647:t},viewRound:a.identity}},4656:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlMathpack=void 0;const n=r(6647),a=r(8610),i=r(6366),o=r(6366),s=r(6366),u=r(450),l=r(6366);function c(e){return{kind:u.OperKind.Number,_valueXL:e}}const d=c(n.mathpack.zero()),g=c(n.mathpack.one()),m=c(n.mathpack.pi());function h(e){return 0!=(e.num&n.mathpack.MathErrorNum.DivBy0)?a.div0ErrorOper:a.numErrorOper}function p(e){return t=>(0,i.assertFalse)(`calc.lang.${e}: error ${JSON.stringify(t)}`)}function f(e,t,r){return n=>{const a=e(n._valueXL);return"number"==typeof a?t(a):r(a)}}function S(e,t,r){return(n,a)=>{const i=e(n._valueXL,a._valueXL);return"number"==typeof i?t(i):r(i)}}const v=S(((e,t)=>n.mathpack.equal(t,2)?n.mathpack.mul(e,e):n.mathpack.power(e,t)),c,h),F=f((e=>n.mathpack.div(e,100)),c,p("xlPercent")),y=f(n.mathpack.ceil,c,p("xlCeil")),b=f(n.mathpack.floor,c,p("xlFloor")),C=f(n.mathpack.cond,l.identity,p(`xlCond, isSupported = ${(0,n.isSupported)()}`)),A=S(n.mathpack.cond2,l.identity,p("xlCond2")),E=f(n.mathpack.sfix,l.identity,p("xlSfix")),T=f(n.mathpack.viewRound,c,p("xlViewRound"));t.xlMathpack={zero:d,one:g,pi:m,add:S(n.mathpack.add,c,h),sub:S(n.mathpack.sub,c,h),mul:S(n.mathpack.mul,c,h),div:S(n.mathpack.div,c,h),power:v,percent:F,neg:function(e){return 0!==C(e)?c(n.mathpack.neg(e._valueXL)):e},compare:(e,t)=>n.mathpack.compare(e._valueXL,t._valueXL),formatGeneral:function(e,t,r){const{_valueXL:a}=t,o=n.mathpack.formatGeneral(e,a,r);return"string"!=typeof o?(0,i.assertFalse)(`calc.lang.xlFormatGeneral: error ${JSON.stringify(o)}`):o},formatFixed:function(e,t,r){const{_valueXL:a}=e,o=n.mathpack.formatFixed(a,t,r);return"object"!=typeof o?(0,i.assertFalse)(`calc.lang.xlFormatFixed: error ${JSON.stringify(o)}`):o},formatScientific:function(e,t,r){const{_valueXL:a}=e,o=n.mathpack.formatScientific(a,t,r);return"object"!=typeof o?(0,i.assertFalse)(`calc.lang.xlFormatScientific: error ${JSON.stringify(o)}`):o},parse:function(e,t,r,a){const o=n.mathpack.pack(e,t,r,a);return"number"!=typeof o?(0,i.assertFalse)(`calc.lang.xlParse: error ${JSON.stringify(o)}`):c(o)},trunc:e=>c(n.mathpack.trunc(e._valueXL)),ceil:y,floor:b,abs:e=>c(n.mathpack.abs(e._valueXL)),cond:C,cond2:A,fromNumber:function(e){return(0,o.assertTrue)("calc.lang.xlFromNumber",isFinite(e)),c(e)},toNumber:function(e){const{_valueXL:t}=e;return(0,o.assertTrue)("calc.lang.xlToNumber",isFinite(t)),t},sqrt:f(n.mathpack.sqrt,c,h),exp:f(n.mathpack.exp,c,h),ln:f(n.mathpack.ln,c,h),log:f(n.mathpack.log,c,h),sin:f(n.mathpack.sin,c,h),cos:f(n.mathpack.cos,c,h),tan:f(n.mathpack.tan,c,h),asin:f(n.mathpack.asin,c,h),acos:f(n.mathpack.acos,c,h),atan:f(n.mathpack.atan,c,h),atan2:S(n.mathpack.atan2,c,h),mod:S(n.mathpack.mod,c,h),round:S(n.mathpack.round,c,h),roundUp:S(n.mathpack.roundUp,c,h),roundDown:S(n.mathpack.roundDown,c,h),tenTo:function(e){(0,s.assertInteger)("calc.lang.xlTenTo",e);const t=n.mathpack.tenTo(e);return"number"==typeof t?c(t):h(t)},checkAlmostCancellation:function(e,t){const{_valueXL:r}=e,{_valueXL:a}=t;return n.mathpack.exp32(r)-n.mathpack.exp32(a)>=52428800?d:t},fix:e=>n.mathpack.fix(e._valueXL),lfix:e=>n.mathpack.lfix(e._valueXL),sfix:E,viewRound:T}},4304:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KnownFormat=t.Calendar=t.NumberShape=t.DateOrder=t.CurrencyFormat=void 0;var n,a,i,o=r(1948);Object.defineProperty(t,"CurrencyFormat",{enumerable:!0,get:function(){return o.CurrencyFormat}}),Object.defineProperty(t,"DateOrder",{enumerable:!0,get:function(){return o.DateOrder}}),function(e){e.ASCII="ASCII",e.ArabicIndic="ArabicIndic",e.ExtendedArabicIndic="ExtendedArabicIndic",e.Devanagari="Devanagari",e.Bengali="Bengali",e.Gurmukhi="Gurmukhi",e.Gujarati="Gujarati",e.Oriya="Oriya",e.Tamil="Tamil",e.Telugu="Telugu",e.Kannada="Kannada",e.Malayalam="Malayalam",e.Thai="Thai",e.Lao="Lao",e.Tibetan="Tibetan",e.Myanmar="Myanmar",e.Ethiopic="Ethiopic",e.Khmer="Khmer",e.Mongolian="Mongolian",e.ChineseTrad1="ChineseTrad1",e.ChineseTrad2="ChineseTrad2",e.ChineseTrad3="ChineseTrad3",e.ChineseSimp1="ChineseSimp1",e.ChineseSimp2="ChineseSimp2",e.ChineseSimp3="ChineseSimp3",e.Japanese1="Japanese1",e.Japanese2="Japanese2",e.Japanese3="Japanese3",e.Korean1="Korean1",e.Korean2="Korean2",e.Korean3="Korean3",e.Korean4="Korean4"}(n||(t.NumberShape=n={})),function(e){e.Gregorian="Gregorian",e.GregorianUS="GregorianUS",e.Japan="Japan",e.Taiwan="Taiwan",e.Korea="Korea",e.Hijri="Hijri",e.Thai="Thai",e.Hebrew="Hebrew",e.GregorianMEFrench="GregorianMEFrench",e.GregorianArabic="GregorianArabic",e.GregorianXlitEnglish="GregorianXlitEnglish",e.GregorianXlitFrench="GregorianXlitFrench",e.Persian="Persian",e.UmAlQura="UmAlQura"}(a||(t.Calendar=a={})),function(e){e[e.General=0]="General",e[e.NoComFixed0=-1]="NoComFixed0",e[e.NoComFixed=-2]="NoComFixed",e[e.Fixed0=-3]="Fixed0",e[e.Fixed=-4]="Fixed",e[e.Currency=-9]="Currency",e[e.CoCurrency=-10]="CoCurrency",e[e.CurrencyDec=-11]="CurrencyDec",e[e.CoCurrencyDec=-12]="CoCurrencyDec",e[e.Pct0=-13]="Pct0",e[e.Pct=-14]="Pct",e[e.Exp=-15]="Exp",e[e.Fract=-17]="Fract",e[e.FractBond=-18]="FractBond",e[e.MMDDYY=-19]="MMDDYY",e[e.DDMMMYY=-20]="DDMMMYY",e[e.DDMMM=-21]="DDMMM",e[e.MMMYY=-22]="MMMYY",e[e.HHMMAP=-23]="HHMMAP",e[e.HHMMSSAP=-24]="HHMMSSAP",e[e.HHMM=-25]="HHMM",e[e.HHMMSS=-26]="HHMMSS",e[e.MDYHMS=-27]="MDYHMS",e[e.Currency2=-5]="Currency2",e[e.CoCurrency2=-6]="CoCurrency2",e[e.CurrencyDec2=-7]="CurrencyDec2",e[e.CoCurrencyDec2=-8]="CoCurrencyDec2",e[e.Acct=-33]="Acct",e[e.AcctCur=-32]="AcctCur",e[e.AcctDec=-35]="AcctDec",e[e.AcctDecCur=-34]="AcctDecCur",e[e.MMSS=-28]="MMSS",e[e.AbsHMMSS=-31]="AbsHMMSS",e[e.SS0=-29]="SS0",e[e.Eng=-16]="Eng",e[e.Text=-30]="Text",e[e.USCoCurrency=-1037]="USCoCurrency",e[e.USCoCurrencyDec=-1039]="USCoCurrencyDec",e[e.NoComFixed0_Tha=-2036]="NoComFixed0_Tha",e[e.NoComFixed_Tha=-2037]="NoComFixed_Tha",e[e.Fixed0_Tha=-2038]="Fixed0_Tha",e[e.Fixed_Tha=-2039]="Fixed_Tha",e[e.CoCurrency_Tha=-2041]="CoCurrency_Tha",e[e.CoCurrencyDec_Tha=-2043]="CoCurrencyDec_Tha",e[e.Pct0_Tha=-2044]="Pct0_Tha",e[e.Pct_Tha=-2045]="Pct_Tha",e[e.MMDDYY_Tha=-2048]="MMDDYY_Tha",e[e.DDMMMYY_Tha=-2049]="DDMMMYY_Tha",e[e.DDMMM_Tha=-2050]="DDMMM_Tha",e[e.MMMYY_Tha=-2051]="MMMYY_Tha",e[e.HHMM_Tha=-2052]="HHMM_Tha",e[e.HHMMSS_Tha=-2053]="HHMMSS_Tha",e[e.MDYHMS_Tha=-2054]="MDYHMS_Tha",e[e.AbsHMMSS_Tha=-2055]="AbsHMMSS_Tha",e[e.MMSS_Tha=-2056]="MMSS_Tha",e[e.SS0_Tha=-2057]="SS0_Tha",e[e.DMBB_Tha=-2058]="DMBB_Tha"}(i||(t.KnownFormat=i={}))},5029:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPrinter=t.anonymizeFormula=void 0;const n=r(2701),a=r(8610),i=r(5005),o=r(6366),s=r(6366),u=r(6366),l=r(6366),c=r(3803),d=r(3292),g=r(537),m=r(6366),h=r(6366),p=r(276),f=r(6366),S=r(6366),v=r(6366),F=r(3563),y=r(2060),b=r(6366),C=r(6366),A=r(6366),E=r(6366),T=r(6366),R=r(6366),k=r(3309),N=r(450),I=r(6366),O=r(3616),P=r(6366),M=r(6366),D=r(6366),w=/'/g,L=/"/g,_=(0,d.sheetGridCell)((0,d.sheetIndex)((0,d.documentLoc)(void 0,"Book1"),0),(0,d.gridCell)(0,0));function x(e){if(!(0,E.isSuccess)(e)&&e.reason.kind!==F.ResolveReasonKind.NoOriginSheet&&e.reason.kind!==F.ResolveReasonKind.InvalidQualifier&&e.reason.kind!==F.ResolveReasonKind.InvalidCellRef&&e.reason.kind!==F.ResolveReasonKind.InvalidStructRef&&e.reason.kind!==F.ResolveReasonKind.EmptyIntersection)throw new J(e.reason)}var K;function W(e){const t=[],r=[];for(const n of e)n.length>0&&(0,P.numCodeUnits)((0,M.stringCodePointAt)(n,0))===n.length?t[(0,M.stringCodePointAt)(n,0)]=!0:r.push(n);return(e,n)=>{const a=(0,M.stringCodePointAt)(e,n);if(!0===t[a])return!0;for(const t of r)if((0,S.stringStartsWith)(e,t,n))return!0;return!1}}function U(e,t){let r="";for(let n=0;n<e.length;){t(e,n)&&(r+="'");const a=(0,M.stringCodePointAt)(e,n);r+=(0,D.stringFromCodePoint)(a),n+=(0,P.numCodeUnits)(a)}return r}!function(e){e[e.Original=0]="Original",e[e.Bracketed=1]="Bracketed",e[e.Unbracketed=2]="Unbracketed"}(K||(K={}));class G{constructor(e){this.str=e,this.append=V,this.length=e.length}}class B{constructor(e,t){this.lhs=e,this.rhs=t,this.append=V,this.length=e.length+t.length}}function V(e){return new B(this,"string"==typeof e?new G(e):e)}function j(e,t){return 0===e.length?new G(""):e.reduce(((e,r)=>e.append(t).append(r)))}const H={pre:"",preComments:void 0},q={pre:" ",preComments:void 0},z={post:"",postComments:void 0},Q={literalNode:(e,t,r)=>r,arrayNode:(e,t,r)=>r,appNode:(e,t,r,n)=>n,letNode:(e,t,r,n,a,i)=>i,lambdaNode:(e,t,r,n,a,i)=>i,parenNode:(e,t,r)=>r,nameNode:(e,t,r)=>r,cellRefNode:(e,t,r)=>r,fieldRefNode:(e,t,r)=>r,structRefNode:(e,t,r)=>r,missingNode:(e,t)=>t,badSequenceNode:(e,t,r)=>r,badCharsNode:(e,t,r)=>r,operatorNode:(e,t)=>t,wsfNode:(e,t,r)=>r},$={...(0,k.constVisitor)(void 0),operatorNode:e=>e};class Y{print(){const e=new k.ComposeVisitor(new k.ZipVisitor({str:this,label:Q,op:$}),(e=>(this.record(e.label,e.str),e))),t=(0,k.reduceBottomUp)(e,this.root),r=new G("=").append(this.recordPrePost(t.label,this.pre(t.label,H),t.str,this.postIfComments(t.label)));return this.printRope(r)}pre(e,t){return this.anonymize?t:this.spans[e]??t}post(e,t){return this.anonymize?t:this.spans[e]??t}preIfComments(e){if(this.anonymize)return H;const t=this.spans[e];return null!=t?.preComments&&t.preComments.length>0?t:H}postIfComments(e){if(this.anonymize)return z;const t=this.spans[e];return null!=t?.postComments&&t.postComments.length>0?t:z}printRef(e,t){let r=new G("");switch(e.kind){case n.StructRefKind.SpecialRef:{(t===K.Original&&e.isBracketed||t===K.Bracketed)&&(r=r.append(this.localeInfo.leftBracket));const n=this.localeInfo.specialRefNames[e.id];if(null==n)throw new J((0,c.internal)("No locale data for specialRefName"));r=r.append(n),(t===K.Original&&e.isBracketed&&e.isClosed||t===K.Bracketed)&&(r=r.append(this.localeInfo.rightBracket));break}case n.StructRefKind.ColumnRef:{const n=0===e.name.length||(0,S.stringStartsWith)(e.name," ")||(0,v.stringEndsWith)(e.name," ");(t===K.Original&&e.isBracketed||t===K.Bracketed||t===K.Unbracketed&&n)&&(r=r.append(this.localeInfo.leftBracket));const a=U(e.name,this.isStructRefEscapable);r=r.append(this.anon(a)),(t===K.Original&&e.isBracketed&&e.isClosed||t===K.Bracketed||t===K.Unbracketed&&n)&&(r=r.append(this.localeInfo.rightBracket));break}case n.StructRefKind.RangeOpRef:r=r.append(this.printRef(e.lhs,t===K.Original?t:K.Bracketed)).append(":").append(this.printRef(e.rhs,t===K.Original?t:K.Bracketed));break;case n.StructRefKind.MissingRef:break;case n.StructRefKind.BadRef:e.isBracketed&&(r=r.append(this.localeInfo.leftBracket)),r=r.append(this.anon(e.chars)),e.isBracketed&&e.isClosed&&(r=r.append(this.localeInfo.rightBracket))}return this.record(e.label,r)}printThisRowOpRef(e,t){let r=new G("@");return e&&(r=e.kind===n.StructRefKind.ColumnRef?r.append(this.printRef(e,e.isClosed?function(e,t){for(let r=0;r<e.length;){if(t(e,r))return!0;r+=(0,P.numCodeUnits)((0,M.stringCodePointAt)(e,r))}return!1}(e.name,this.isStructRefBracketedThisRef)?K.Bracketed:K.Unbracketed:K.Original)):r.append(this.printRef(e,(0,c.isRangeOpClosed)(e)&&(0,c.isRangeOpNoMissing)(e)?K.Bracketed:K.Original))),this.record(t,r)}printApplication(e,t,r,n){const a=t.map(((e,t,r)=>this.recordPrePost(e.label,this.pre(e.label,0===t||0===e.str.length?H:q),e.str,t===r.length-1?this.post(e.label,z):this.postIfComments(e.label))));return e.str.append("(").append(j(a,this.localeInfo.listSeparator)).append(r?")":"")}printCellRef({ref:e,qualifier:t}){return(void 0!==t?this.recordPrePost(t.label,H,(0,k.visitQualifier)(this,t).str,this.postIfComments(t.label)):new G("")).append((0,k.visitCellRef)(this,e).str)}printName({qualifier:e,parts:t},r){const a=void 0!==e?this.recordPrePost(e.label,H,(0,k.visitQualifier)(this,e).str,this.postIfComments(e.label)):new G("");let i=new G("");for(const e of(0,n.flattenNameParts)(t).parts){let t;if(e.kind===n.NamePartKind.FieldRefNamePart){const r=e.rhs.field;t=this.record(e.rhs.label,new G(".").append(this.record(r.label,this.anon(r.kind===n.NodeKind.Ident?r.whole:r.chars))))}else t=e.kind===n.NamePartKind.CellRefNamePart&&r===F.ResolvedKind.ResolvedCellRef?this.printCellRef((0,n.cellRefNode)(e.ref,void 0,e.label)):new G(this.anon(e.asWhole));i=this.record(e.label,i.append(t)),this.recordQualified(e.qualifiedLabel,a,i)}return a.append(i)}printUnrecordedDocQual(e){if(void 0===e)return e;const{path:t,document:r}=e;return this.anon((t??"")+this.localeInfo.leftBracket+r+this.localeInfo.rightBracket)}printParamNameIdent(e){return e.kind===n.NodeKind.Ident?this.record(e.label,this.anon((0,c.getBoundName)(this.localeInfo,e.whole))):this.recordPrePost(e.label,this.pre(e.label,H),this.anon(e.chars),this.post(e.label,z))}printParamName(e){return this.record(e.label,new G(e.isBracketed?this.localeInfo.leftBracket:"").append(this.printParamNameIdent(e.name)).append(e.isBracketed&&e.isClosed?this.localeInfo.rightBracket:""))}record(e,t){const r="string"==typeof t?new G(t):t;return this.labelToRope[e]={ropeStart:r,ropeEnd:r,startOffset:0,endOffset:0,pre:"",post:"",preComments:void 0,postComments:void 0},r}recordQualified(e,t,r){this.labelToRope[e]={ropeStart:t,ropeEnd:r,startOffset:0,endOffset:0,pre:"",post:"",preComments:void 0,postComments:void 0}}recordPrePost(e,{pre:t,preComments:r},n,{post:a,postComments:i}){const o="string"==typeof n?new G(n):n,s=new G(t),u=new G(a);return this.labelToRope[e]={ropeStart:o,ropeEnd:o,startOffset:0,endOffset:0,pre:t,post:a,preComments:r,postComments:i},r&&this.recordComments(r,s,this.spans[e].start-t.length),i&&this.recordComments(i,u,this.spans[e].end),s.append(o).append(u)}recordComments(e,t,r){for(const n of e){const e=this.spans[n.label];if(null==e)return;this.labelToRope[n.label]={ropeStart:t,ropeEnd:t,startOffset:e.start-r,endOffset:e.end-r-t.length,pre:"",post:"",preComments:void 0,postComments:void 0}}}printRope(e){const{str:t,ropeToSpan:r}=function(e){const t=new Map,r=[];let n=0;const a=[e];for(;a.length>0;){const e=a.pop();t.set(e,{start:n,end:n+e.length}),e instanceof B?a.push(e.rhs,e.lhs):(r.push(e.str),n+=e.str.length)}return{str:r.join(""),ropeToSpan:t}}(e),a=[];for(const e of Object.keys(this.labelToRope).map(Number)){const{ropeStart:t,ropeEnd:i,startOffset:o,endOffset:s,pre:u,post:l,preComments:c,postComments:d}=this.labelToRope[e],{start:g}=r.get(t),{end:m}=r.get(i);a[e]=(0,n.formulaSpan)(g+o,m+s,u,l,c,d)}return{formula:t,spans:a}}literalNode(e,t,r){switch(e.kind){case N.OperKind.String:return new G('"'+this.anon(e.value).replace(L,'""')+'"');case N.OperKind.Boolean:return new G(e.value?this.localeInfo.trueName:this.localeInfo.falseName);case N.OperKind.Number:const t=21;return new G(this.anon(this.mathpack.formatGeneral(this.localeInfo,e,t)));case N.OperKind.Missing:return new G("");case N.OperKind.Error:const r=this.localeInfo.errorNames[e.type];if(null==r)throw new J((0,c.internal)(`No locale data for error type ${e.type}`));return new G(r);default:return(0,s.assertNever)("calc.lang.printFormula",e)}}missingNode(e,t){return new G(this.anon(e))}arrayNode(e,t,r){return new G(this.localeInfo.leftBrace).append(j(e.map((e=>j(e.map((e=>this.recordPrePost(e.label,this.preIfComments(e.label),e.str,this.postIfComments(e.label)))),this.localeInfo.columnSeparator))),this.localeInfo.rowSeparator)).append(t?this.localeInfo.rightBrace:"")}appNode(e,t,r,n){if(void 0!==e.op){if(1===t.length){const r=t[0];switch(e.op){case i.OperatorId.Percent:return r.str.append(this.recordPrePost(e.label,this.pre(e.label,H),e.str,z));case i.OperatorId.Pound:return r.str.append(this.recordPrePost(e.label,this.preIfComments(e.label),e.str,z));default:return this.recordPrePost(e.label,H,e.str,this.post(e.label,z)).append(r.str)}}if(2===t.length){const[r,n]=t;let a=" ",o=" ";switch(e.op){case i.OperatorId.Range:a=o="";break;case i.OperatorId.Isect:o="";break;case i.OperatorId.Union:a=""}return r.str.append(this.recordPrePost(e.label,this.pre(e.label,{pre:a}),e.str,this.post(e.label,{post:o}))).append(n.str)}return(0,u.assertFalse)("calc.lang.printFormula: invalid number of operator args")}return this.printApplication(e,t,r,n)}letNode(e,t,r,a,i,o){const s=t.map((({name:e,binder:t})=>(0,n.letVar)((0,n.indexedArg)({str:this.record(e.arg.label,this.record(e.arg.name.label,this.anon((0,c.getBoundName)(this.localeInfo,e.arg.wholeName)))),label:e.arg.label,op:void 0},e.index),t)));return this.printApplication(e,(0,n.flattenLetArgs)(s,r,a),i,o)}lambdaNode(e,t,r,a,i,o){const s=t.map((({name:e})=>{const t=this.printParamName(e.arg.name),r=void 0===e.arg.def?new G(""):this.recordPrePost(e.arg.def.label,this.pre(e.arg.def.label,q),new G(":=").append(this.recordPrePost(e.arg.def.rhs.label,this.pre(e.arg.def.rhs.label,0===e.arg.def.rhs.str.length?H:q),e.arg.def.rhs.str,z)),z);return(0,n.lambdaParam)((0,n.indexedArg)({str:t.append(r),label:e.arg.label,op:void 0},e.index))}));return this.printApplication(e,(0,n.flattenLambdaArgs)(s,r,a),i,o)}parenNode(e,t,r){return new G("(").append(this.recordPrePost(e.label,this.pre(e.label,H),e.str,this.post(e.label,z))).append(t?")":"")}nameNode(e,t,r){const{headResolved:a,node:i}=this.resolver.resolveDottedName(this.locals,(0,n.nameNode)(e,t,r),this.annotations);return x(a.resolution),this.printName(i,a.kind)}cellRefNode(e,t,r){const{node:a,resolution:i}=this.resolver.resolveCellRef(this.locals,(0,n.cellRefNode)(e,t,r));return x(i),this.printCellRef(a)}fieldRefNode(e,t,r){const a=t.shouldBeBracketed,i=t.isBracketed||a?this.localeInfo.leftBracket:"",o=t.isBracketed&&t.isClosed||a?this.localeInfo.rightBracket:"",s=this.record(t.field.label,this.anon(t.field.kind===n.NodeKind.Ident?U(t.field.whole,this.isFieldRefEscapable):t.field.chars)),u=t.field.kind!==n.NodeKind.Ident?this.pre(t.label,H):this.preIfComments(t.label);return e.str.append(this.recordPrePost(t.label,u,new G("."+i).append(s).append(o),this.post(t.label,z)))}structRefNode(e,t,r){const{node:a,table:i,resolution:o}=this.resolver.resolveStructRef(this.locals,(0,n.structRefNode)(e,t,r));x(o);const s=a.rhs.innerRef;let u=void 0===a.lhs?void 0:this.record(a.lhs.label,this.printName(a.lhs,F.ResolvedKind.ResolvedName));if(void 0!==u||void 0===i||!a.rhs.isClosed||s?.kind===n.StructRefKind.ColumnRef||s?.kind===n.StructRefKind.ThisRowOpRef&&s.ref?.kind===n.StructRefKind.ColumnRef||(u=new G(i.name)),void 0===s&&a.rhs.isClosed&&void 0!==u)return u;let l=new G(this.localeInfo.leftBracket);switch(s?.kind){case n.StructRefKind.ColumnRef:case n.StructRefKind.SpecialRef:if(s.kind===n.StructRefKind.SpecialRef&&s.id===n.SpecialRefId.ThisRow&&s.isClosed){l=l.append(this.printThisRowOpRef(void 0,s.label));break}l=l.append(this.printRef(s,s.isClosed?K.Unbracketed:K.Original));break;case n.StructRefKind.RangeOpRef:{const e=(0,c.isRangeOpClosed)(s)&&(0,c.isRangeOpNoMissing)(s)?K.Bracketed:K.Original;l=l.append(this.printRef(s,e));break}case n.StructRefKind.CommaOpRef:{const e=(0,c.isCommaOpRefWellFormed)(s)&&(0,c.isCommaOpClosed)(s)&&(0,c.isCommaOpNoBadOrMissing)(s);if(e&&s.specialRefs[n.SpecialRefId.ThisRow]){l=l.append(this.printThisRowOpRef(0===s.columnRefs.length?void 0:s.columnRefs[0],s.label));break}const t=e?(0,c.normalizeCommaOpRef)(s):s.refs,r=e?1===t.length?K.Unbracketed:K.Bracketed:K.Original;l=l.append(this.record(s.label,j(t.map((e=>this.printRef(e,r))),this.localeInfo.listSeparator)));break}case n.StructRefKind.ThisRowOpRef:l=l.append(this.printThisRowOpRef(s.ref,s.label));break;case n.StructRefKind.BadRef:l=l.append(this.printRef(s,K.Original))}return a.rhs.isClosed&&(l=l.append(this.localeInfo.rightBracket)),(u??new G("")).append(this.record(a.rhs.label,l))}badSequenceNode(e,t,r){return j(t.map((e=>this.recordPrePost(e.label,this.pre(e.label,H),e.str,this.post(e.label,z)))),"")}badCharsNode(e,t,r){return new G(this.anon(t))}operatorNode(e,t){const r=(0,g.operatorIdToName)(this.localeInfo,e,"");if(void 0===r)throw new J((0,c.internal)("Invalid operator"));return new G(r)}wsfNode(e,t,r){return new G(this.localeInfo.getWorksheetFuncName(e))}cellRefError(e){const t=this.localeInfo.errorNames[a.ErrorType.REF];if(null==t)throw new J((0,c.internal)("No locale data for #REF"));return{str:this.record(e,t),label:e}}cellRefSingle(e,t,r,n){const a=(0,p.formatCellPos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e,t,this.locals.wrapCellReferences);return void 0!==a?{str:this.record(n,this.anon(a)),label:n}:this.cellRefError(n)}cellRefRange(e,t,r){const n=(0,p.formatRangePos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.row,e.col,t.row,t.col,this.locals.wrapCellReferences);return void 0!==n?{str:this.record(r,this.anon(n)),label:r}:this.cellRefError(r)}cellRefRow(e,t,r,n){const a=(0,p.formatRowRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,e,t,this.locals.wrapCellReferences);return void 0!==a?{str:this.record(n,this.anon(a)),label:n}:this.cellRefError(n)}cellRefCol(e,t,r,n){const a=(0,p.formatColRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,e,t,this.locals.wrapCellReferences);return void 0!==a?{str:this.record(n,this.anon(a)),label:n}:this.cellRefError(n)}cellRefBad(e,t,r){return{str:this.record(r,this.anon(e)),label:r}}errorQualifier(e){const t=this.localeInfo.errorNames[a.ErrorType.REF];if(null==t)throw new J((0,c.internal)("No locale data for #REF"));return{str:this.record(e,t),label:e}}relativeQualifier(e){return{str:this.record(e,"!"),label:e}}documentQualifier(e,t,r,a){return{str:this.record(a,(0,p.quoteQualifier)(this.printUnrecordedDocQual((0,n.documentQualifier)(e,t)))+"!"),label:a}}sheetQualifier(e,t,r,n){let a=this.printUnrecordedDocQual(t),i=this.anon(e);const o=(0,p.shouldQuoteQualifier)(this.localeInfo,this.refStyle,(a??"")+i);return o&&(a=a?.replace(w,"''"),i=i.replace(w,"''")),{str:this.record(n,new G(o?"'":"").append(void 0===a?new G(""):this.record(t.label,a)).append(i).append(o?"'":"").append("!")),label:n}}identQualifier(e,t,r){return{str:this.record(r,(0,p.formatQualifier)(this.localeInfo,this.refStyle,this.anon(e))+"!"),label:r}}sheetRangeQualifier(e,t,r,n,a){let i=this.printUnrecordedDocQual(r),o=this.anon(e),s=this.anon(t);const u=(0,p.shouldQuoteQualifier)(this.localeInfo,this.refStyle,(i??"")+o)||(0,p.shouldQuoteQualifier)(this.localeInfo,this.refStyle,s);return u&&(i=i?.replace(w,"''"),o=o.replace(w,"''"),s=s.replace(w,"''")),{str:this.record(a,new G(u?"'":"").append(void 0===i?new G(""):this.record(r.label,i)).append(o).append(":").append(s).append(u?"'":"").append("!")),label:a}}badQualifier(e,t,r,n,a){return{str:this.record(a,this.anon(e)),label:a}}constructor(e,t,r,n){this.root=r,this.anonymize=n,this.labelToRope=[],this.anon=e=>this.anonymize?(0,h.anonymizeFormulaString)(e):e,this.locals=t,this.localeInfo=t.config?.localeInfo??e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=t.config?.refStyle??e.config.refStyle,this.resolver=(0,y.createResolver)(e),this.spans=r.spans,this.annotations=r.annotations;const a=["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket,"#","@"],i=[...a,"\t","\n","\r"," ","!",'"',"$","%","&","(",")","*","+",this.localeInfo.listSeparator,"-",".","/",":",";","<","=",">","?","\\","^","_","`","{","}","~"];this.isStructRefEscapable=W(a),this.isStructRefBracketedThisRef=W(i),this.isFieldRefEscapable=W(["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket])}}const J=(0,c.createFailureErrorClass)("PrintFormulaError"),X=(0,c.createFailureErrorClass)("PrintRangeError");function Z(e,t,r,n=!1){try{return(0,C.success)(new Y(e,t,r,n).print())}catch(e){return e instanceof J?(0,A.failure)(e.reason):(0,A.failure)((0,T.javaScriptError)(e))}}function ee(e,t){return void 0===e?(0,n.pos)(n.PosKind.Abs,t):(0,n.pos)(n.PosKind.Rel,t-e)}function te(e,t,r){return(0,n.cellRefSingle)(ee(e,r.row),ee(t,r.col))}function re(e){return(0,E.isSuccess)(e)?((0,l.assertTrue)("calc.lang.printRangeStructRef: NameLoc can't be no-table",null!=e.value),(0,C.success)(e.value)):e.reason.kind===F.ResolveReasonKind.InvalidStructRef?(0,u.assertFalse)("calc.lang.printRangeStructRef: NameLoc can't be InvalidStructRef"):(0,A.failure)(e.reason)}function ne(e,t,r,a=(0,I.makeEmptyTable)()){try{const i=t.originSheet.value;if(!(0,c.isDocumentLocEqual)(i.document,r.sheet.document))throw new X((0,c.notImplemented)(["printRange cross-document"]));return(0,C.success)(function(e,t,r,a){const i=t.originSheet.value,o=e.getNamedRanges(r);if(!(0,E.isSuccess)(o))throw new X(o.reason);if(0===o.value.length)return;const s=e=>void 0!==e.index&&(void 0===i.index||!(0,c.isSheetIndexEqual)(e,i)),u=o.value.filter((({scope:e})=>void 0===e.index?(0,c.isDocumentLocEqual)(e.document,r.sheet.document):(0,c.isSheetIndexEqual)(e,r.sheet))).filter((({scope:t,name:r})=>{if(void 0!==t.index||void 0===i.index)return!0;const n=i,a=e.getNameLoc(n,r,d.NameSource.Plain);if(!(0,E.isSuccess)(a))throw new X(a.reason);return null==a.value})).filter((({scope:e,name:t})=>s(e)||!a.contains(t)));if(0===u.length)return;const l=1===u.length?u[0]:[...u].sort(((t,r)=>e.config.localeInfo.stringCompareCI(t.name,r.name)))[0];let g;if(s(l.scope)){const t=e.getSheetName(l.scope.document,l.scope.index);if(!(0,E.isSuccess)(t))throw new X(t.reason);g=(0,n.sheetQualifier)(t.value)}return(0,n.nameNode)((0,n.identNamePart)(l.name),g)}(e,t,r,a)??function(e,t,{sheet:r,range:a}){const i=e.getContainingTable((0,d.sheetGridCell)(r,(0,c.gridRangeAnchor)(a)));if(!(0,E.isSuccess)(i))throw new X(i.reason);if(null==i.value)return;const o=i.value,s=re(e.getStructRefSpecialRef(o,n.SpecialRefId.All));if(!(0,E.isSuccess)(s))throw new X(s.reason);const u=s.value.range,l=s.value.sheet,g=(0,c.gridRangeCompare)(u,a);if(void 0===g||g<0)return;const m=re(e.getStructRefSpecialRef(o,n.SpecialRefId.Data));if(!(0,E.isSuccess)(m))throw new X(m.reason);const h=m.value.range,p=t.originGridCell.value,f=t.originSheet.value,S=void 0!==f.index&&(0,c.isSheetIndexEqual)(f,l)&&(0,c.gridRangeIsects)(u,p)?void 0:(0,n.nameNode)((0,n.identNamePart)(o.name)),v=S??(0,n.nameNode)((0,n.identNamePart)(o.name)),F=h.cols>1&&a.col===h.col&&a.cols===h.cols,y=()=>{const t=re(e.getStructRefColumn(o,a.col));if(!(0,E.isSuccess)(t))throw new X(t.reason);if(1===a.cols)return(0,n.columnRef)(t.value.name);const r=re(e.getStructRefColumn(o,a.col+a.cols-1));if(!(0,E.isSuccess)(r))throw new X(r.reason);return(0,n.rangeOpRef)((0,n.columnRef)(t.value.name),(0,n.columnRef)(r.value.name))};if(a.row===u.row&&a.rows===u.rows)return(0,n.structRefNode)(v,(0,n.structRef)(F?(0,n.specialRef)(n.SpecialRefId.All):(0,n.commaOpRef)([(0,n.specialRef)(n.SpecialRefId.All,!0),y()])));if(1===a.rows&&a.row===p.row&&a.row>=h.row&&a.row<h.row+h.rows)return(0,n.structRefNode)(1===a.cols?S:v,(0,n.structRef)((0,n.thisRowOpRef)(F?void 0:y())));if(a.row===h.row&&a.rows===h.rows)return F?(0,n.structRefNode)(v,(0,n.structRef)(void 0)):(0,n.structRefNode)(1===a.cols?S:v,(0,n.structRef)(y()));const b=a.row===u.row&&a.row+a.rows===h.row,C=a.row===h.row+h.rows&&a.row+a.rows===u.row+u.rows;if(b||C){const e=(0,n.specialRef)(b?n.SpecialRefId.Headers:n.SpecialRefId.Totals,!F);return(0,n.structRefNode)(v,(0,n.structRef)(F?e:(0,n.commaOpRef)([e,y()])))}const A=a.row===u.row&&u.row<h.row&&a.row+a.rows===h.row+h.rows,T=a.row===h.row&&u.row+u.rows>h.row+h.rows&&a.row+a.rows===u.row+u.rows;if(A||T){const e=(0,n.specialRef)(A?n.SpecialRefId.Headers:n.SpecialRefId.Data,!0),t=(0,n.specialRef)(A?n.SpecialRefId.Data:n.SpecialRefId.Totals,!0);return(0,n.structRefNode)(v,(0,n.structRef)(F?(0,n.commaOpRef)([e,t]):(0,n.commaOpRef)([e,t,y()])))}}(e,t,r)??function(e,t,r){const a=t.originSheet.value,i=function(e,t,r){if(0===r.col&&r.cols===d.sheetCols)return function(e,t,r){return(0,n.cellRefRow)(ee(e,t),ee(e,t+r-1))}(e,r.row,r.rows);if(0===r.row&&r.rows===d.sheetRows)return function(e,t,r){return(0,n.cellRefCol)(ee(e,t),ee(e,t+r-1))}(t,r.col,r.cols);const a=te(e,t,(0,c.gridRangeAnchor)(r));if((0,d.isGridCell)(r))return a;const i=te(e,t,(0,d.gridCell)(r.row+r.rows-1,r.col+r.cols-1));return(0,n.cellRefRange)(a,i)}(t.printRowsAsAbsoluteReferences?void 0:t.originGridCell.value.row,t.printColsAsAbsoluteReferences?void 0:t.originGridCell.value.col,r.range);let o;if(void 0===a.index||!(0,c.isSheetIndexEqual)(a,r.sheet)){const t=e.getSheetName(r.sheet.document,r.sheet.index);if(!(0,E.isSuccess)(t))throw new X(t.reason);o=(0,n.sheetQualifier)(t.value)}return(0,n.cellRefNode)(i,o)}(e,t,r))}catch(e){return e instanceof X?(0,A.failure)(e.reason):(0,A.failure)((0,T.javaScriptError)(e))}}t.anonymizeFormula=function(e,t,r){try{const a=r.kind===d.LexicalKind.Cell||r.kind===d.LexicalKind.Range?(0,O.printLocalsGrid)(r,(0,c.sheetGridRangeAnchor)(r.range)):r.kind===d.LexicalKind.NameManager?(0,O.printLocalsName)(r,_):(0,s.assertNever)("calc.lang.anonymizeFormula",r),i=Z((0,O.createSimplePrintGlobals)((0,g.calcConfig)((0,g.getEnglishLocaleInfo)(),n.RefStyle.A1,e.mathpack)),a,t,!0);if(i.kind===b.ResultKind.Success)return i.value.formula;if(i.reason.kind===R.ReasonKind.JavaScriptError)throw i.reason.error}catch(e){const t="calc.lang.anonymizeFormula: Format failed: "+(0,f.messageFromError)(e);o.ulsLogger.ULS.traceTag(507381981,g.LogCategory.msoulscat_ES_EWAJS,g.TraceLevel.Warning,t)}return(0,m.anonymize)(t)};const ae={getNamedRanges:()=>(0,u.assertFalse)("calc.lang.prettyPrinter: default getNamedRanges")};t.createPrinter=function(e){const t=function(e){return{config:e.config,getDocumentLoc:e.getDocumentLoc.bind(e),getSheetIndex:e.getSheetIndex.bind(e),getSheetName:e.getSheetName.bind(e),getNameLoc:e.getNameLoc.bind(e),getUserDefinedFuncLoc:e.getUserDefinedFuncLoc.bind(e),getSheetRangeIndexes:e.getSheetRangeIndexes.bind(e),getContainingTable:e.getContainingTable.bind(e),getStructRefColumn:e.getStructRefColumn.bind(e),getStructRefSpecialRef:e.getStructRefSpecialRef?.bind(e),getNamedRanges:e.getNamedRanges?.bind(e)??ae.getNamedRanges}}(e);return{printFormula:(t,r)=>{const n=Z(e,t,r);return(0,E.isSuccess)(n)?(0,C.success)(n.value.formula):n},printFormulaEx:(t,r)=>Z(e,t,r),printRange:(e,r,n)=>ne(t,e,r,n)}}},3616:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=void 0;const n=r(3292),a=r(6366),i=r(6366),o=r(6366),s=r(3803);class u{getDocumentLoc(e,t){return(0,i.success)((0,n.documentLoc)(e,t))}getSheetIndex(e,t){return(0,i.success)(t)}getSheetName(e,t){return(0,i.success)(t)}getNameLoc(e,t){return(0,i.success)(t.indexOf(".")>=0?void 0:(0,n.nameLoc)(e,t))}getUserDefinedFuncLoc(e,t){return(0,i.success)([])}getSheetRangeIndexes(e){if(void 0===e.index)return(0,o.failure)((0,s.notImplemented)(["simplePrintGlobals.getSheetRangeIndexes"]));const t=[e.index];return e.index2!==e.index&&t.push(e.index2),(0,i.success)((0,n.sheetRangeIndexes)(t,0))}getContainingTable(e){return a.successUndefined}getStructRefColumn(e,t){return a.successUndefined}getStructRefSpecialRef(e,t){return a.successUndefined}getNamedRanges(e){return(0,i.success)([])}constructor(e){this.config=e}}t.createSimplePrintGlobals=function(e){return new u(e)},t.printLocalsGrid=function(e,t,r){return{config:r??void 0,lexicalSource:e,originGridCell:(0,i.success)(t.range),originSheet:(0,i.success)(t.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1,printRowsAsAbsoluteReferences:!1,printColsAsAbsoluteReferences:!1}},t.printLocalsName=function(e,t,r){return{config:r??void 0,lexicalSource:e,originGridCell:(0,i.success)(t.range),originSheet:(0,i.success)(t.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0,printRowsAsAbsoluteReferences:!0,printColsAsAbsoluteReferences:!0}}},9858:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.relabelFormula=void 0;const n=r(2701),a=r(3309);t.relabelFormula=function(e,t=function(){let e=1;return()=>e++}()){const{spans:r,annotations:i,depthUpperBound:o}=e,s=[],u=[],l=[],c=[];function d(e){const n=t(),a=r[e];null!=a&&(s[n]=a);const o=i[e];return null!=o&&(u[n]=o),l[e]=n,c[n]=e,n}function g(e){return{...e,label:d(e.label)}}function m(e){if(e.kind===n.CellRefKind.Range){const t=e;return(0,n.cellRefRange)(m(t.ref1),m(t.ref2),d(e.label))}return{...e,label:d(e.label)}}function h(e){return null!=e?(0,n.documentQualifier)(e.document,e.path,e.isQuoted,d(e.label)):void 0}function p(e){return(0,n.fieldRef)(function(e){switch(e.kind){case n.NodeKind.Ident:return v(e);case n.NodeKind.Missing:return(0,n.missingNode)(e.chars,d(e.label));case n.NodeKind.BadChars:return(0,n.badCharsNode)(e.type,e.chars,d(e.label))}}(e.field),e.isBracketed,e.isClosed,e.shouldBeBracketed,d(e.label))}function f(e){switch(e?.kind){case void 0:return;case n.StructRefKind.SpecialRef:return(0,n.specialRef)(e.id,e.isBracketed,e.isClosed,d(e.label));case n.StructRefKind.ColumnRef:return(0,n.columnRef)(e.name,e.isBracketed,e.isClosed,d(e.label));case n.StructRefKind.RangeOpRef:return(0,n.rangeOpRef)(f(e.lhs),f(e.rhs),d(e.label));case n.StructRefKind.CommaOpRef:return(0,n.commaOpRef)(e.refs.map(f),d(e.label));case n.StructRefKind.ThisRowOpRef:return(0,n.thisRowOpRef)(void 0!==e.ref?f(e.ref):void 0,d(e.label));case n.StructRefKind.MissingRef:return(0,n.missingRef)(d(e.label));case n.StructRefKind.BadRef:return(0,n.badRef)(e.chars,e.isBracketed,e.isClosed,d(e.label))}}function S(e,t,r){return(0,n.nameNode)(function(e){const t=(0,n.flattenNameParts)(e),r=(e,{rhs:t,canDenoteNamedObject:r,label:a,qualifiedLabel:i})=>(0,n.fieldRefNamePart)(e,p(t),r,d(a),d(i));if(t.kind===n.NamePartKind.IdentNamePart){const[e,...a]=t.parts,i=(0,n.identNamePart)(e.asWhole,e.canDenoteNamedObject,d(e.label),d(e.qualifiedLabel));return a.reduce(r,i)}const[a,i,...o]=t.parts,s=(0,n.cellRefNamePart)(m(a.ref),a.asWhole,d(a.label),d(a.qualifiedLabel));return o.reduce(r,r(s,i))}(e),function(e){if(null!=e)return e.kind===n.QualifierKind.Sheet||e.kind===n.QualifierKind.SheetRange?{...e,document:h(e.document),label:d(e.label)}:{...e,label:d(e.label)}}(t),d(r))}function v({whole:e,label:t}){return(0,n.identNode)(e,d(t))}const F={literalNode:(e,t,r)=>(0,n.literalNode)(e,t,d(r)),arrayNode:(e,t,r)=>(0,n.arrayNode)(e,t,d(r)),appNode:(e,t,r,a)=>(0,n.appNode)(e,t,r,d(a)),letNode:(e,t,r,a,i,o)=>(0,n.letNode)(e,t.map((({name:e,binder:t})=>(0,n.letVar)((0,n.indexedArg)(function({name:e,label:t}){return(0,n.varNode)(v(e),d(t))}(e.arg),e.index),t))),r,a,i,d(o)),lambdaNode:(e,t,r,a,i,o)=>(0,n.lambdaNode)(e,t.map((({name:e})=>(0,n.lambdaParam)((0,n.indexedArg)(function(e){const t=(0,n.paramName)(function(e){switch(e.kind){case n.NodeKind.Ident:return v(e);case n.NodeKind.Missing:return(0,n.missingNode)(e.chars,d(e.label));case n.NodeKind.BadChars:return(0,n.badCharsNode)(e.type,e.chars,d(e.label))}}(e.name.name),e.name.isBracketed,e.name.isClosed,d(e.name.label)),r=void 0===e.def?void 0:(0,n.paramDefault)(e.def.rhs,d(e.def.label));return(0,n.paramNode)(t,r,d(e.label))}(e.arg),e.index)))),r,a,i,d(o)),parenNode:(e,t,r)=>(0,n.parenNode)(e,t,d(r)),nameNode:(e,t,r)=>S(e,t,r),cellRefNode:(e,t,r)=>(0,n.cellRefNode)(m(e),function(e){if(null!=e)return e.kind===n.QualifierKind.Sheet||e.kind===n.QualifierKind.SheetRange?{...e,document:h(e.document),label:d(e.label)}:{...e,label:d(e.label)}}(t),d(r)),fieldRefNode:(e,t,r)=>(0,n.fieldRefNode)(e,p(t),d(r)),structRefNode(e,t,r){return(0,n.structRefNode)(void 0===e?void 0:function({parts:e,qualifier:t,label:r}){return S(e,t,r)}(e),(a=t,(0,n.structRef)(f(a.innerRef),a.isClosed,d(a.label))),d(r));var a},missingNode:(e,t)=>(0,n.missingNode)(e,d(t)),badSequenceNode:(e,t,r)=>(0,n.badSequenceNode)(e,t,d(r)),badCharsNode:(e,t,r)=>(0,n.badCharsNode)(e,t,d(r)),operatorNode:(e,t)=>(0,n.operatorNode)(e,d(t)),wsfNode:(e,t,r)=>(0,n.wsfNode)(e,t,d(r))},y=(0,n.formula)((0,a.reduceBottomUp)(F,e),s,u,o);for(const e of Object.keys(u)){const t=Number(e),r=u[t];switch(r?.kind){case n.AnnotationKind.LocalNameUse:u[t]=(0,n.localNameUseAnnotation)(r.name,r.whole,l[r.label]);break;case n.AnnotationKind.LocalNameDecl:u[t]=(0,n.localNameDeclAnnotation)(r.name,r.whole,r.uses.map((({label:e})=>({label:l[e]}))))}}for(const e of Object.keys(s).map(Number)){const t=s[e],r=t?.preComments,n=t?.postComments;(r||n)&&(s[e]={...t,preComments:r?r.map(g):void 0,postComments:n?n.map(g):void 0})}return{formula:y,oldToNewLabel:l,newToOldLabel:c}}},2060:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createResolver=t.resolveGridRef=t.canDenoteCellRef=t.canDenoteUserDefinedFunc=t.canDenoteLocalName=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(276),u=r(2701),l=r(3803),c=r(3803),d=r(3292),g=r(3292),m=r(6366),h=r(6366),p=r(6366),f=r(6366),S=r(6366),v=r(3563),F=r(3563),y=r(6366);function b(e){return(0,p.isSuccess)(e)&&(0,a.isNone)(e.value)?f.successUndefined:e}function C(e){return!(0,p.isSuccess)(e)||void 0===e.value}const A=e=>e.rhs.field.kind===u.NodeKind.Ident,E=e=>e.rhs.field.whole,T=(e,t)=>(0,u.fieldRefNamePart)(e,t.rhs,t.canDenoteNamedObject,t.label,t.qualifiedLabel);function R(e,t){const[r,...n]=t;return r.kind===u.NamePartKind.IdentNamePart&&null==e&&n.every(A)}function k(e,t,r){return r.canDenoteNamedObject&&e&&(void 0===t||t.kind===u.QualifierKind.Document||t.kind===u.QualifierKind.Ident)}function N(e,t,r){const[n,...a]=r;return n.kind===u.NamePartKind.CellRefNamePart&&(null==t&&e.allowUnqualifiedCell||null!=t&&t.kind!==u.QualifierKind.Document)&&a.every(A)}function I(e,t,r,n,a){return r.kind===u.PosKind.Abs?(0,m.success)(r.index):(0,p.isSuccess)(e)?(0,m.success)((0,s.resolvePosition)(t(e.value),r,n,a)):e}t.canDenoteLocalName=R,t.canDenoteUserDefinedFunc=k,t.canDenoteCellRef=N;const O=({row:e})=>e,P=({col:e})=>e;function M(e,t,r){const n=I(e,O,t.row,g.sheetRows,r),a=I(e,P,t.col,g.sheetCols,r);return(0,p.isSuccess)(n)?(0,p.isSuccess)(a)?void 0===n.value||void 0===a.value?f.successUndefined:(0,m.success)((0,g.gridCell)(n.value,a.value)):a:n}function D(e,t){if(t.kind===u.CellRefKind.Error)return f.successUndefined;const r=e.originGridCell,n=e.wrapCellReferences;switch(t.kind){case u.CellRefKind.Single:return M(r,t,n);case u.CellRefKind.Range:{const e=M(r,t.ref1,n),a=M(r,t.ref2,n);return(0,p.isSuccess)(e)?(0,p.isSuccess)(a)?void 0===e.value||void 0===a.value?f.successUndefined:(0,m.success)((0,c.gridCellRange)(e.value,a.value)):a:e}case u.CellRefKind.Row:{const e=I(r,O,t.row1,g.sheetRows,n),a=I(r,O,t.row2,g.sheetRows,n);return(0,p.isSuccess)(e)?(0,p.isSuccess)(a)?void 0===e.value||void 0===a.value?f.successUndefined:(0,m.success)((0,c.gridCellRange)((0,g.gridCell)(e.value,0),(0,g.gridCell)(a.value,g.sheetCols-1))):a:e}case u.CellRefKind.Col:{const e=I(r,P,t.col1,g.sheetCols,n),a=I(r,P,t.col2,g.sheetCols,n);return(0,p.isSuccess)(e)?(0,p.isSuccess)(a)?void 0===e.value||void 0===a.value?f.successUndefined:(0,m.success)((0,c.gridCellRange)((0,g.gridCell)(0,e.value),(0,g.gridCell)(g.sheetRows-1,a.value))):a:e}case u.CellRefKind.Bad:return(0,h.failure)((0,F.invalidCellRef)(F.InvalidCellRefReason.BadCellRef));default:return(0,i.assertNever)("calc.lang.Resolver.resolveGridRef",t)}}t.resolveGridRef=D,t.createResolver=function(e){function t(t,r){if(void 0===r){const e=t.originSheet;return(0,p.isSuccess)(e)?[r,(0,m.success)(e.value.document)]:[r,e]}const n=e.getDocumentLoc(r.path,r.document);if(!(0,p.isSuccess)(n))return[r,n];if((0,a.isNone)(n.value))return[r,(0,h.failure)((0,F.invalidQualifier)(F.InvalidQualifierReason.UndefinedDocument))];const i=null==r.path?void 0:n.value.path,o=n.value.name;return[(0,u.documentQualifier)(o,i,r.isQuoted,r.label),(0,m.success)(n.value)]}function r(t,r){if(C(r))return[t,r];const n=b(e.getSheetIndex(r.value,t));if(!(0,p.isSuccess)(n))return[t,n];if((0,a.isNone)(n.value))return[t,(0,h.failure)((0,F.invalidQualifier)(F.InvalidQualifierReason.UndefinedSheetName))];const i=e.getSheetName(r.value,n.value);return(0,p.isSuccess)(i)?[i.value,(0,m.success)((0,g.sheetIndex)(r.value,n.value))]:[t,i]}function s(e,n){const[a,i]=t(e,n.document),[o,s]=r(n.sheet,i);return[(0,u.sheetQualifier)(o,a,n.isQuoted,n.label),s]}function A(n,a){const{qualifier:o,ref:l}=a,d=D(n,l);let S,v,y;if(void 0===o||o.kind===u.QualifierKind.Relative){S=o;const e=n.originSheet;if((0,p.isSuccess)(e)){const t=e.value;v=void 0===t.index?(0,h.failure)((0,F.noOriginSheet)(t)):(0,m.success)(t)}else v=e}else[S,v]=function(n,a){switch(a.kind){case u.QualifierKind.Error:return[a,f.successUndefined];case u.QualifierKind.Sheet:return s(n,a);case u.QualifierKind.SheetRange:return function(n,a){const[i,o]=t(n,a.document),[s,l]=r(a.sheet1,o),[d,h]=r(a.sheet2,o);let f,S=s,v=d;if(C(o))f=o;else if(C(l))f=l;else if(C(h))f=h;else{if((0,c.isSheetIndexEqual)(l.value,h.value))return[(0,u.sheetQualifier)(S,i,a.isQuoted,a.label),(0,m.success)((0,g.sheetIndex)(o.value,l.value.index))];{const t=e.getSheetRangeIndexes(l.value),r=e.getSheetRangeIndexes(h.value);(0,p.isSuccess)(t)?(0,p.isSuccess)(r)?r.value.position<t.value.position&&(S=d,v=s):f=r:f=t,f=(0,m.success)((0,g.sheetRange)(o.value,l.value.index,h.value.index))}}return[(0,u.sheetRangeQualifier)(S,v,i,a.isQuoted,a.label),f]}(n,a);case u.QualifierKind.Document:return[a,(0,h.failure)((0,F.invalidQualifier)(F.InvalidQualifierReason.SheetRangeName))];case u.QualifierKind.Bad:return[a,(0,h.failure)((0,F.invalidQualifier)(F.InvalidQualifierReason.BadQualifier))];default:return(0,i.assertNever)("calc.lang.Resolver.resolveCellRefQualifier",a)}}(n,o);return y=C(d)?d:C(v)?v:(0,m.success)((0,g.sheetGridCube)(v.value,d.value)),(0,F.resolvedCellRef)((0,u.cellRefNode)(l,S,a.label),y)}function I(r,n,a){const{qualifier:o,parts:l}=n;let c,f,S;const v=[];if(void 0===o||o.kind===u.QualifierKind.Relative){const e=r.originSheet;if(!(0,p.isSuccess)(e))return(0,F.resolvedName)(n,e,n.qualifier?.kind,v);const t=e.value;if(a!==g.NameSource.StructRef&&void 0===t.index)return(0,F.resolvedName)(n,(0,h.failure)((0,F.noOriginSheet)(t)),n.qualifier?.kind,v);c=o,S=o?.kind,f=(0,m.success)(t)}else[c,S,f]=function(e,r){switch(r.kind){case u.QualifierKind.Document:{const[n,a]=t(e,r);return[n,n.kind,C(a)?a:(0,m.success)((0,g.documentScope)(a.value))]}case u.QualifierKind.Sheet:{const[t,n]=s(e,r);return[t,t.kind,n]}case u.QualifierKind.SheetRange:return[r,r.kind,(0,h.failure)((0,F.invalidQualifier)(F.InvalidQualifierReason.SheetRangeName))];case u.QualifierKind.Ident:{const n=(0,u.sheetQualifier)(r.name,void 0,r.isQuoted,r.label),[a,i]=s(e,n);if(!(0,p.isSuccess)(i)&&i.reason.kind!==F.ResolveReasonKind.InvalidQualifier)return[r,r.kind,i];if((0,p.isSuccess)(i)&&void 0!==i.value)return[(0,u.identQualifier)(a.sheet,a.isQuoted,a.label),a.kind,i];const o=(0,u.documentQualifier)(r.name,void 0,r.isQuoted,r.label),[l,c]=t(e,o);return C(c)?[r,r.kind,c]:[(0,u.identQualifier)(l.document,l.isQuoted,l.label),l.kind,(0,m.success)((0,g.documentScope)(c.value))]}case u.QualifierKind.Bad:return[r,r.kind,(0,h.failure)((0,F.invalidQualifier)(F.InvalidQualifierReason.BadQualifier))];default:return(0,i.assertNever)("calc.lang.Resolver.resolveNameQualifier",r)}}(r,o);a===g.NameSource.StructRef&&(0,p.isSuccess)(f)&&void 0!==f.value.index&&(f=(0,m.success)((0,g.documentScope)(f.value.document)));let y,A=l;return C(f)?y=f:(v.push((0,d.nameLoc)(f.value,l.asWhole)),y=b(e.getNameLoc(f.value,l.asWhole,a)),(0,p.isSuccess)(y)&&void 0===y.value&&void 0!==f.value.index&&(f=(0,m.success)((0,g.documentScope)(f.value.document)),v.push((0,d.nameLoc)(f.value,l.asWhole)),y=b(e.getNameLoc(f.value,l.asWhole,a))),C(y)||(A=(0,u.identNamePart)(y.value.name,l.canDenoteNamedObject,l.label,l.qualifiedLabel))),(0,F.resolvedName)((0,u.nameNode)(A,c,n.label),y,S,v)}function O(t,r,n=!1){const i=e.getStructRefColumn(t,r.name);if(!(0,p.isSuccess)(i))return{kind:u.StructRefKind.ColumnRef,innerRef:r,resolution:i};const o=i.value;if((0,a.isNone)(o))return{kind:u.StructRefKind.ColumnRef,innerRef:r,resolution:(0,h.failure)((0,F.invalidStructRef)(F.InvalidStructRefReason.UndefinedColumnName))};let s=o.range.range;return n&&(s=(0,g.gridRange)(s.row-(o.hasHeadersRow?1:0),s.col,s.rows+(o.hasHeadersRow?1:0)+(o.hasTotalsRow?1:0),s.cols)),{kind:u.StructRefKind.ColumnRef,innerRef:(0,u.columnRef)(o.name,r.isBracketed,r.isClosed,r.label),resolution:(0,m.success)((0,g.sheetGridRange)(o.range.sheet,s))}}function P(t,r,n){if(n===u.SpecialRefId.ThisRow){if(!(0,p.isSuccess)(t.originGridCell))return t.originGridCell;const e=P(t,r,u.SpecialRefId.Data);if(C(e))return e;const n=e.value.range,a=t.originGridCell.value.row;return a<n.row||a>=n.row+n.rows?(0,h.failure)(F.emptyIntersection):(0,m.success)((0,g.sheetGridRange)(e.value.sheet,(0,g.gridRange)(a,n.col,1,n.cols)))}return b(e.getStructRefSpecialRef(r,n))}function M(e,t,r){switch(t.kind){case u.StructRefKind.ColumnRef:return O(e,t,r);case u.StructRefKind.MissingRef:return{kind:u.StructRefKind.MissingRef,innerRef:t,resolution:f.successUndefined}}}function w(e,t,r=!1){const{innerRef:n,resolution:a}=M(e,t.lhs,r),{innerRef:i,resolution:o}=M(e,t.rhs,r),s=(0,u.rangeOpRef)(n,i,t.label);if(!(0,p.isSuccess)(a)&&a.reason.kind!==F.ResolveReasonKind.InvalidStructRef)return{kind:u.StructRefKind.RangeOpRef,innerRef:s,resolution:a};if(!(0,p.isSuccess)(o)&&o.reason.kind!==F.ResolveReasonKind.InvalidStructRef)return{kind:u.StructRefKind.RangeOpRef,innerRef:s,resolution:o};if(!(0,p.isSuccess)(a))return{kind:u.StructRefKind.RangeOpRef,innerRef:s,resolution:a};if(!(0,p.isSuccess)(o))return{kind:u.StructRefKind.RangeOpRef,innerRef:s,resolution:o};let l,d;if(void 0!==a.value)l=a.value.sheet,d=(0,c.gridRangeJoinOpt)(a.value.range,o.value?.range);else{if(void 0===o.value)return{kind:u.StructRefKind.RangeOpRef,innerRef:s,resolution:(0,h.failure)((0,F.invalidStructRef)(F.InvalidStructRefReason.InvalidOp))};l=o.value.sheet,d=o.value.range}return{kind:u.StructRefKind.RangeOpRef,innerRef:s,resolution:(0,m.success)((0,g.sheetGridRange)(l,d))}}function L(r,n){const{qualifier:a,parts:o}=n,s=r.config?.localeInfo??e.config.localeInfo;let c,g,h,S;if(void 0===a){const e=r.originSheet;if(!(0,p.isSuccess)(e))return(0,F.resolvedUserDefinedFunc)(n,e,[],o.asWhole);c=a,g=(0,m.success)(e.value.document)}else[c,g]=function(e,r){switch(r.kind){case u.QualifierKind.Document:return t(e,r);case u.QualifierKind.Ident:{const n=(0,u.documentQualifier)(r.name,void 0,r.isQuoted,r.label),[a,i]=t(e,n);return[(0,u.identQualifier)(a.document,a.isQuoted,a.label),i]}default:return(0,i.assertNever)("calc.lang.Resolver.resolveUserDefinedFuncQualifier",r)}}(r,a);let v=o.asWhole;if(C(g))S=g,h=[];else{v=(0,l.getUserDefinedFuncName)(s,o.asWhole);const t=e.getUserDefinedFuncLoc(g.value,v);h=[(0,d.userDefinedFuncLoc)(g.value,v)],S=(0,p.isSuccess)(t)?0!==t.value.length?t:f.successUndefined:t}return(0,F.resolvedUserDefinedFunc)((0,u.nameNode)((0,u.identNamePart)(v,o.canDenoteNamedObject,o.label,o.qualifiedLabel),c,n.label),S,h,v)}return{resolveGridRef:D,resolveCellRef:A,resolveName:I,resolveStructRef:function(t,r){const{lhs:n,rhs:i}=r;let o,s,l=n;if(void 0!==n){const{node:e,resolution:i,precedents:u}=I(t,n,g.NameSource.StructRef),c=i;if(!(0,p.isSuccess)(c))return(0,F.resolvedStructRef)(r,void 0,c,u);if((0,a.isNone)(c.value))return(0,F.resolvedStructRef)(r,void 0,(0,h.failure)((0,F.invalidStructRef)(F.InvalidStructRefReason.UndefinedTableName)),u);l=e,o=c.value,s=u}else{const{originGridCell:n,originSheet:i}=t;if(!(0,p.isSuccess)(n))return(0,F.resolvedStructRef)(r,void 0,n,[]);if(!(0,p.isSuccess)(i))return(0,F.resolvedStructRef)(r,void 0,i,[]);if(void 0===i.value.index)return(0,F.resolvedStructRef)(r,void 0,(0,h.failure)((0,F.invalidStructRef)(F.InvalidStructRefReason.InvalidOriginSheet)),[]);const u=e.getContainingTable((0,g.sheetGridCell)(i.value,n.value));if(!(0,p.isSuccess)(u))return(0,F.resolvedStructRef)(r,void 0,u,[]);if((0,a.isNone)(u.value))return(0,F.resolvedStructRef)(r,void 0,(0,h.failure)((0,F.invalidStructRef)(F.InvalidStructRefReason.MissingTableName)),[]);o=u.value,s=[o]}const{structRef:d,resolution:v}=function(e,t,r){switch(r.innerRef?.kind){case u.StructRefKind.ColumnRef:{const{innerRef:e,resolution:n}=O(t,r.innerRef);return{structRef:(0,u.structRef)(e,r.isClosed,r.label),resolution:n}}case u.StructRefKind.RangeOpRef:{const{innerRef:e,resolution:n}=w(t,r.innerRef);return{structRef:(0,u.structRef)(e,r.isClosed,r.label),resolution:n}}case void 0:return{structRef:r,resolution:P(e,t,u.SpecialRefId.Data)};case u.StructRefKind.SpecialRef:return{structRef:r,resolution:P(e,t,r.innerRef.id)};case u.StructRefKind.CommaOpRef:{const{commaOpRef:n,resolution:a}=function(e,t,r){const n=r.refs.map((r=>function(e,t,r){switch(r.kind){case u.StructRefKind.ColumnRef:return O(t,r,!0);case u.StructRefKind.SpecialRef:return{kind:u.StructRefKind.SpecialRef,innerRef:r,resolution:P(e,t,r.id)};case u.StructRefKind.RangeOpRef:return w(t,r,!0);case u.StructRefKind.MissingRef:return{kind:u.StructRefKind.MissingRef,innerRef:r,resolution:f.successUndefined};case u.StructRefKind.BadRef:return{kind:u.StructRefKind.BadRef,innerRef:r,resolution:(0,h.failure)((0,F.invalidStructRef)(F.InvalidStructRefReason.InvalidOp))}}}(e,t,r))),a=(0,u.commaOpRef)(n.map((e=>e.innerRef)),r.label);for(const{resolution:e}of n)if(!(0,p.isSuccess)(e)&&e.reason.kind!==F.ResolveReasonKind.InvalidStructRef)return{commaOpRef:a,resolution:e};const i=[];for(const e of n){if(!(0,p.isSuccess)(e.resolution)||e.kind===u.StructRefKind.BadRef)return{commaOpRef:a,resolution:e.resolution};i.push((e.kind===u.StructRefKind.SpecialRef||(e.kind,u.StructRefKind.MissingRef),{kind:e.kind,resolution:e.resolution}))}if(!(0,c.isCommaOpRefWellFormed)(r))return{commaOpRef:a,resolution:(0,h.failure)((0,F.invalidStructRef)(F.InvalidStructRefReason.InvalidOp))};let o,s;for(const e of i)e.kind===u.StructRefKind.SpecialRef&&(o=(0,c.gridRangeJoinOpt)(o,e.resolution.value?.range),void 0===s&&(s=e.resolution.value?.sheet));if(void 0===o||void 0===s)return{commaOpRef:a,resolution:f.successUndefined};for(const e of i)if(e.kind!==u.StructRefKind.SpecialRef&&e.kind!==u.StructRefKind.MissingRef&&(o=(0,c.gridRangeIsect)(o,e.resolution.value.range),void 0===o))return{commaOpRef:a,resolution:(0,h.failure)((0,F.invalidStructRef)(F.InvalidStructRefReason.InvalidOp))};return{commaOpRef:a,resolution:(0,m.success)((0,g.sheetGridRange)(s,o))}}(e,t,r.innerRef);return{structRef:(0,u.structRef)(n,r.isClosed,r.label),resolution:a}}case u.StructRefKind.ThisRowOpRef:{const n=P(e,t,u.SpecialRefId.ThisRow);if(C(n)||void 0===r.innerRef.ref)return{structRef:r,resolution:n};const{innerRef:a,resolution:i}=r.innerRef.ref.kind===u.StructRefKind.ColumnRef?O(t,r.innerRef.ref):w(t,r.innerRef.ref),o=(0,u.thisRowOpRef)(a,a.label);if(C(i))return{structRef:(0,u.structRef)(o,r.isClosed,r.label),resolution:i};const s=(0,c.gridRangeIsect)(n.value.range,i.value.range);return s?{structRef:(0,u.structRef)(o,r.isClosed,r.label),resolution:(0,m.success)((0,g.sheetGridRange)(n.value.sheet,s))}:{structRef:r,resolution:(0,h.failure)((0,F.invalidStructRef)(F.InvalidStructRefReason.InvalidOp))}}case u.StructRefKind.BadRef:return{structRef:r,resolution:(0,h.failure)((0,F.invalidStructRef)(F.InvalidStructRefReason.InvalidOp))}}}(t,o,i);return(0,F.resolvedStructRef)(v.kind===S.ResultKind.Failure&&v.reason.kind!==F.ResolveReasonKind.EmptyIntersection?r:(0,u.structRefNode)(l,d,r.label),o,v,s)},resolveUserDefinedFunc:L,resolveDottedName:function(t,r,a){const i=r.parts,s=r.qualifier,c={names:new Array,udfs:new Array},d=a[r.label],h=d?.kind===u.AnnotationKind.AppHeadName,p=(0,u.flattenNameParts)(i).parts,f=(0,u.nameNode)((0,u.identNamePart)(i.asWhole,i.canDenoteNamedObject,i.label,i.qualifiedLabel),s,r.label);if(R(s,p)){const[e,...t]=p,n=function(e,t){const r=t[e.label],n=r?.kind===u.AnnotationKind.LocalNameUse?r:void 0;return(0,F.resolvedLocalName)((0,u.nameNode)((0,u.identNamePart)(n?.name??e.asWhole,e.canDenoteNamedObject,e.label,e.qualifiedLabel),void 0,e.qualifiedLabel),(0,m.success)(n))}(e,a);if(void 0!==n.resolution.value)return(0,F.resolvedDottedName)((0,u.nameNode)(t.reduce(T,n.node.parts),s,r.label),n,t.map(E),c)}let b;const C=()=>{if(!b)return!1;const e=b.headResolved.resolution;return e.kind!==S.ResultKind.Success&&e.reason.kind!==F.ResolveReasonKind.InvalidQualifier||e.kind===S.ResultKind.Success&&void 0!==e.value};if(i.canDenoteNamedObject){const e=I(t,f,h?g.NameSource.AppHead:g.NameSource.Plain);if((0,n.safePush)(c.names,e.precedents),b=(0,F.resolvedDottedName)(e.node,e,[],c),C())return b}if(k(h,s,i)){const e=L(t,f);if((0,n.safePush)(c.udfs,e.precedents),b=(0,F.resolvedDottedName)(e.node,e,[],c),C())return b}if(N(t,s,p)){const[e,...n]=p,a=null!=s&&s.kind===u.QualifierKind.Ident?(0,u.sheetQualifier)(s.name,void 0,s.isQuoted,s.label):s,l=A(t,(0,u.cellRefNode)(e.ref,a,e.qualifiedLabel)),d=l.node.qualifier;return(0,o.assertTrue)("calc.lang.Resolver.resolveDottedName: resolveCellRef doesn't generate ErrorQualifier",d?.kind!==u.QualifierKind.Error),(0,o.assertTrue)("calc.lang.Resolver.resolveDottedName: resolveCellRef doesn't touch ref",l.node.ref===e.ref),b=(0,F.resolvedDottedName)((0,u.nameNode)(i,d,r.label),l,n.map(E),c),b}if((0,l.isUnqualifiedNameNode)(r)&&(0,y.getTypedFeatureGate)("Microsoft.Office.Excel.CalcEtaLambda")&&(0,y.getTypedFeatureGate)("Microsoft.Office.Excel.EtaReducedLambdas")){const n=function(t,r){const n=t.config?.localeInfo??e.config.localeInfo,a=(0,l.getEtaFuncId)(n,r.whole),i=r.parts;return(0,v.resolvedWorksheetFunc)((0,u.nameNode)((0,u.identNamePart)(void 0!==a?n.getWorksheetFuncName(a):i.asWhole,i.canDenoteNamedObject,i.label,i.qualifiedLabel),void 0,i.qualifiedLabel),(0,m.success)(a))}(t,r);if(void 0!==n.resolution.value)return(0,F.resolvedDottedName)(n.node,n,[],c)}return void 0!==b?b:(0,F.resolvedDottedName)(r,(0,F.resolvedNever)(f),[],c)}}}},3563:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedDottedName=t.resolvedNever=t.resolvedStructRef=t.resolvedLocalName=t.resolvedWorksheetFunc=t.resolvedUserDefinedFunc=t.resolvedCellRef=t.resolvedName=t.ResolvedKind=t.emptyIntersection=t.invalidStructRef=t.InvalidStructRefReason=t.invalidCellRef=t.InvalidCellRefReason=t.invalidQualifier=t.InvalidQualifierReason=t.noOriginSheet=t.ResolveReasonKind=t.resolveLocalsGrid=void 0;const n=r(6366),a=r(6366),i=r(6366);var o,s,u,l,c;t.resolveLocalsGrid=function(e){return{originGridCell:(0,a.success)(e.range),originSheet:(0,a.success)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},function(e){e.NoOriginSheet="NoOriginSheet",e.InvalidQualifier="InvalidQualifier",e.InvalidCellRef="InvalidCellRef",e.InvalidStructRef="InvalidStructRef",e.EmptyIntersection="EmptyIntersection"}(o||(t.ResolveReasonKind=o={})),t.noOriginSheet=function(e){return{kind:o.NoOriginSheet,origin:e}},function(e){e.UndefinedDocument="UndefinedDocument",e.UndefinedSheetName="UndefinedSheetName",e.SheetRangeName="SheetRangeName",e.DocumentCellRef="DocumentCellRef",e.BadQualifier="BadQualifier"}(s||(t.InvalidQualifierReason=s={})),t.invalidQualifier=function(e){return{kind:o.InvalidQualifier,reason:e}},function(e){e.BadCellRef="BadCellRef"}(u||(t.InvalidCellRefReason=u={})),t.invalidCellRef=function(e){return{kind:o.InvalidCellRef,reason:e}},function(e){e.UndefinedColumnName="UndefinedColumnName",e.UndefinedTableName="UndefinedTableName",e.InvalidOriginSheet="InvalidOriginSheet",e.InvalidOp="InvalidOp",e.MissingTableName="MissingTableName",e.NamedObjectNotTable="NamedObjectNotTable"}(l||(t.InvalidStructRefReason=l={})),t.invalidStructRef=function(e){return{kind:o.InvalidStructRef,reason:e}},t.emptyIntersection={kind:o.EmptyIntersection},function(e){e.ResolvedName="ResolvedName",e.ResolvedCellRef="ResolvedCellRef",e.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",e.ResolvedWorksheetFunc="ResolvedWorksheetFunc",e.ResolvedLocalName="ResolvedLocalName",e.ResolvedStructRef="ResolvedStructRef",e.ResolvedNever="ResolvedNever",e.ResolvedDottedName="ResolvedDottedName"}(c||(t.ResolvedKind=c={})),t.resolvedName=(0,i.typedInstanceCreator)()(((e,t,r,n)=>({kind:c.ResolvedName,node:e,resolution:t,qualifierResolution:r,precedents:n}))),t.resolvedCellRef=(0,i.typedInstanceCreator)()(((e,t)=>({kind:c.ResolvedCellRef,node:e,resolution:t}))),t.resolvedUserDefinedFunc=(0,i.typedInstanceCreator)()(((e,t,r,n)=>({kind:c.ResolvedUserDefinedFunc,node:e,resolution:t,precedents:r,name:n}))),t.resolvedWorksheetFunc=(0,i.typedInstanceCreator)()(((e,t)=>({kind:c.ResolvedWorksheetFunc,node:e,resolution:t}))),t.resolvedLocalName=(0,i.typedInstanceCreator)()(((e,t)=>({kind:c.ResolvedLocalName,node:e,resolution:t}))),t.resolvedStructRef=(0,i.typedInstanceCreator)()(((e,t,r,n)=>({kind:c.ResolvedStructRef,node:e,table:t,resolution:r,precedents:n}))),t.resolvedNever=(0,i.typedInstanceCreator)()((e=>({kind:c.ResolvedNever,node:e,resolution:n.successUndefined}))),t.resolvedDottedName=(0,i.typedInstanceCreator)()(((e,t,r,n)=>({kind:c.ResolvedDottedName,node:e,headResolved:t,fieldsResolved:r,precedents:n})))},1981:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGridRangeTable=void 0;const n=r(6366),a=r(3803),i=r(420);function o(e,t){const{row:r,col:a,rows:i,cols:o}=e,{row:s,col:u,rows:l,cols:c}=t;return(0,n.fastAbs)(r-s+.5*(i-l))+(0,n.fastAbs)(a-u+.5*(o-c))}t.makeGridRangeTable=function(){return i.RTree.create(a.gridRangeJoin,a.gridRangeIsects,a.gridRangeCompare,o)}},5005:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVolatileFunc=t.getWorksheetFuncEnglishName=t.getWorksheetFuncType=t.getOperatorType=t.operatorStrings=t.OperatorId=t.higherOrderFunctionType=t.unknownFunctionType=t.WorksheetFuncId=void 0;const n=r(450),a=r(8478);Object.defineProperty(t,"WorksheetFuncId",{enumerable:!0,get:function(){return a.WorksheetFuncId}});const i=r(6366),o=r(6366);var s;t.unknownFunctionType=(0,n.functionType)(0,254,[],[n.SignatureType.All],[],n.SignatureType.All,n.SpecialPrecs.All,n.FunctionFlags.AllowLStrs),t.higherOrderFunctionType=function(){const e=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Rich|n.OperKind.Error|n.OperKind.Blank|((0,i.isFeatureEnabled)(o.FeatureName.CalcLambdaCellValues)?0:n.OperKind.Range)|((0,i.isFeatureEnabled)(o.FeatureName.CalcLambdaArrayLifting)?0:n.OperKind.Array),t=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Rich|n.OperKind.Error|n.OperKind.Blank|n.OperKind.Missing|n.OperKind.Array|n.OperKind.Range;return(0,n.functionType)(1,255,[e],[t],[],n.SignatureType.All,n.SpecialPrecs.None,n.FunctionFlags.Allow3dRef|n.FunctionFlags.AllowLStrs)},function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.At=24]="At",e[e.Pound=25]="Pound"}(s||(t.OperatorId=s={})),t.operatorStrings=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"];const u=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Blank,l=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Blank,c=(0,n.functionType)(2,2,[n.OperKind.Number,n.OperKind.Number],[],[],n.OperKind.Number,n.SpecialPrecs.None,n.FunctionFlags.None),d=(0,n.functionType)(1,1,[n.OperKind.Number],[],[],n.OperKind.Number,n.SpecialPrecs.None,n.FunctionFlags.None),g=(0,n.functionType)(1,1,[u],[],[],u,n.SpecialPrecs.None,n.FunctionFlags.AllowLStrs),m=(0,n.functionType)(2,2,[n.OperKind.String,n.OperKind.String],[],[],n.OperKind.String,n.SpecialPrecs.None,n.FunctionFlags.AllowLStrs),h=(0,n.functionType)(2,2,[l,l],[],[],n.OperKind.Boolean,n.SpecialPrecs.None,n.FunctionFlags.AllowLStrs),p=(0,n.functionType)(2,2,[n.OperKind.Range,n.OperKind.Range],[],[],n.OperKind.Range,n.SpecialPrecs.AllCells,n.FunctionFlags.None),f=(0,n.functionType)(2,2,[n.OperKind.Range,n.OperKind.Range],[],[],n.OperKind.Range,n.SpecialPrecs.None,n.FunctionFlags.None),S=(0,n.functionType)(2,2,[n.OperKind.Boolean,n.OperKind.Boolean],[],[],n.OperKind.Boolean,n.SpecialPrecs.None,n.FunctionFlags.None),v=[];function F(e){const r=a.worksheetFuncTypes[e];return null!=r?r:t.unknownFunctionType}function y(e,t){const r=a.worksheetFuncTypes[e];null!=r&&(r.staticPrecs=t)}v[s.Add]=c,v[s.Sub]=c,v[s.Mul]=c,v[s.Div]=c,v[s.Pow]=c,v[s.Percent]=d,v[s.Neg]=d,v[s.At]=a.worksheetFuncTypes[a.WorksheetFuncId.SINGLE],v[s.Pound]=a.worksheetFuncTypes[a.WorksheetFuncId.ANCHORARRAY],v[s.Pos]=g,v[s.Concat]=m,v[s.Eq]=h,v[s.Ne]=h,v[s.Lt]=h,v[s.Le]=h,v[s.Gt]=h,v[s.Ge]=h,v[s.Range]=p,v[s.Isect]=f,v[s.Union]=f,v[s.And]=S,v[s.Or]=S,v[s.Xor]=S,v[s.Min]=c,v[s.Max]=c,t.getOperatorType=function(e){const r=v[e];return null!=r?r:t.unknownFunctionType},t.getWorksheetFuncType=F,t.getWorksheetFuncEnglishName=function(e){return a.worksheetFuncEnglishNames[e]},t.isVolatileFunc=function(e){return 0!=(F(e).staticPrecs&(n.SpecialPrecs.Time|n.SpecialPrecs.Calc))},y(a.WorksheetFuncId.ROW,n.SpecialPrecs.OwnRow),y(a.WorksheetFuncId.COLUMN,n.SpecialPrecs.OwnCol),y(a.WorksheetFuncId.SHEET,n.SpecialPrecs.OwnDocSheets),y(a.WorksheetFuncId.SHEETS,n.SpecialPrecs.OwnDocSheets),y(a.WorksheetFuncId.OFFSET,n.SpecialPrecs.AllCells),y(a.WorksheetFuncId.INDIRECT,n.SpecialPrecs.AllCells),y(a.WorksheetFuncId.SUMIF,n.SpecialPrecs.AllCells),y(a.WorksheetFuncId.AVERAGEIF,n.SpecialPrecs.AllCells),y(a.WorksheetFuncId.LOOKUP,n.SpecialPrecs.AllCells),y(a.WorksheetFuncId.ADDRESS,n.SpecialPrecs.RefStyle),y(a.WorksheetFuncId.FORMULATEXT,n.SpecialPrecs.RefStyle),y(a.WorksheetFuncId.NOW,n.SpecialPrecs.Time),y(a.WorksheetFuncId.TODAY,n.SpecialPrecs.Time),y(a.WorksheetFuncId.RAND,n.SpecialPrecs.Calc),y(a.WorksheetFuncId.RANDBETWEEN,n.SpecialPrecs.Calc),y(a.WorksheetFuncId.RANDARRAY,n.SpecialPrecs.Calc),y(a.WorksheetFuncId.SUBTOTAL,n.SpecialPrecs.CellProps),y(a.WorksheetFuncId.CELL,n.SpecialPrecs.CellProps|n.SpecialPrecs.AllCells),y(a.WorksheetFuncId.INFO,n.SpecialPrecs.None)},4998:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalAlignment=t.HorizontalAlignment=t.BorderLineType=t.PatternType=t.FillKind=t.FontVerticalAlignment=t.FontUnderline=void 0;const n=r(6366);var a,i,o,s,u,l,c;!function(e){e.None="None",e.Single="Single",e.Double="Double",e.SingleAccounting="SingleAccounting",e.DoubleAccounting="DoubleAccounting"}(a||(t.FontUnderline=a={})),(0,n.staticAssertSame)(),function(e){e.None="None",e.Subscript="Subscript",e.Superscript="Superscript"}(i||(t.FontVerticalAlignment=i={})),(0,n.staticAssertSame)(),function(e){e.Pattern="Pattern",e.Gradient="Gradient"}(o||(t.FillKind=o={})),function(e){e.None="None",e.Solid="Solid",e.MediumGray="MediumGray",e.DarkGray="DarkGray",e.LightGray="LightGray",e.DarkHorizontal="DarkHorizontal",e.DarkVertical="DarkVertical",e.DarkDown="DarkDown",e.DarkUp="DarkUp",e.DarkGrid="DarkGrid",e.DarkTrellis="DarkTrellis",e.LightHorizontal="LightHorizontal",e.LightVertical="LightVertical",e.LightDown="LightDown",e.LightUp="LightUp",e.LightGrid="LightGrid",e.LightTrellis="LightTrellis",e.Gray125="Gray125",e.Gray0625="Gray0625"}(s||(t.PatternType=s={})),function(e){e.None="None",e.Thin="Thin",e.Medium="Medium",e.Dashed="Dashed",e.Dotted="Dotted",e.Thick="Thick",e.Double="Double",e.Hair="Hair",e.MediumDashed="MediumDashed",e.DashDot="DashDot",e.MediumDashDot="MediumDashDot",e.DashDotDot="DashDotDot",e.MediumDashDotDot="MediumDashDotDot",e.SlantDashDot="SlantDashDot"}(u||(t.BorderLineType=u={})),(0,n.staticAssertSame)(),function(e){e.Automatic="Automatic",e.Left="Left",e.Center="Center",e.Right="Right",e.Fill="Fill",e.Justify="Justify",e.CenterAcrossSelection="CenterAcrossSelection",e.Distributed="Distributed",e.JustifyDistributed="JustifyDistributed"}(l||(t.HorizontalAlignment=l={})),(0,n.staticAssertSame)(),function(e){e.Top="Top",e.Center="Center",e.Bottom="Bottom",e.Justify="Justify",e.Distributed="Distributed"}(c||(t.VerticalAlignment=c={})),(0,n.staticAssertSame)()},6120:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSingleRange=t.sheet1=t.sheet1Name=t.document1=void 0;const n=r(3292);t.document1=(0,n.documentLoc)(void 0,"Book1"),t.sheet1Name="Sheet1",t.sheet1=(0,n.sheetIndex)(t.document1,0),t.createSingleRange=function(e,r){const a=(0,n.gridCell)(e,r);return(0,n.sheetGridCell)(t.sheet1,a)}},450:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.FunctionFlags=t.SpecialPrecs=t.SignatureType=t.OperKind=void 0;const n=r(6366),a=r(6366),i=r(6366);var o,s,u,l;!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(o||(t.OperKind=o={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(s||(t.SignatureType=s={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"}(u||(t.SpecialPrecs=u={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.Chart=4]="Chart",e[e.OnlyParsedDuringLoad=8]="OnlyParsedDuringLoad",e[e.Internal=16]="Internal",e[e.Allow3dRef=32]="Allow3dRef",e[e.AllowLStrs=64]="AllowLStrs",e[e.HiddenFromUI=128]="HiddenFromUI"}(l||(t.FunctionFlags=l={})),t.functionType=function(e,t,r,o,s,u,l,c){if((0,n.assertNatural)("calc.lang.functionType",t),(0,i.assertIndex)("calc.lang.functionType",e,t+1),0===o.length?0!==s.length:s.length>=o.length){const e=JSON.stringify(s);(0,a.assertFalse)(`calc.lang.functionType: expected tailTypes.length < restTypes.length; given ${e}`)}if(0===o.length&&r.length+s.length<t){const e=JSON.stringify(r);(0,a.assertFalse)(`calc.lang.functionType: expected headTypes.length + tailTypes.length >= ${t}; given ${e}`)}return{minArgs:e,maxArgs:t,headTypes:r,restTypes:o,tailTypes:s,returnType:u,staticPrecs:l,flags:c}}},3803:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notImplemented=t.ReasonKind=t.LangReasonKind=t.isReadOperEqual=t.isWriteOper=t.isPrimitiveOper=t.isRichOper=t.isBlankOper=t.isMissingOper=t.isArrayOper=t.isRangeOper=t.isErrorOper=t.isBooleanOper=t.isStringOper=t.isNumberOper=t.shouldFieldRefBeBracketed=t.isValidArgsLength=t.getArgType=t.isBooleanLiteralNode=t.isNumberLiteralNode=t.isMissingLiteralNode=t.isMissingNode=t.isUnqualifiedNameNode=t.isWSFNode=t.isOperatorNode=t.getArguments=t.gridCellRange=t.sheetGridRangeAnchor=t.gridRangeAnchor=t.isSheetGridRangeEqual=t.isSheetGridCellEqual=t.isGridRangeEqual=t.isGridCellEqual=t.isNameScopeEqual=t.sheetRangeToSheetIndex=t.isSheetIndexEqual=t.isDocumentLocEqual=t.gridRangeAnchorHash=t.gridRangeSize=t.gridRangeExcept=t.gridRangeCompare=t.gridCellImplicitIsect=t.gridRangeIsects=t.gridRangeIsect=t.gridRangesJoin=t.gridRangeJoinOpt=t.gridRangeJoin=t.forEachTileInRange=t.forEachCellInRange=t.isWellFormed=void 0,t.applyComparison=t.normalizeCommaOpRef=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isCommaOpRefWellFormed=t.getBoundName=t.getEtaFuncId=t.getUserDefinedFuncName=t.getWorksheetFuncId=t.createFailureErrorClass=t.internal=t.unavailable=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6366),u=r(3292),l=r(2701),c=r(450),d=r(6366),g=r(6366),m=r(6366),h=r(6366),p=r(5005);function f(e,t){const{row:r,col:n,rows:a,cols:i}=e,{row:o,col:s,rows:l,cols:c}=t,d=(0,g.fastMin)(r,o),h=(0,g.fastMin)(n,s),p=(0,m.fastMax)(r+a,o+l)-d,f=(0,m.fastMax)(n+i,s+c)-h;return(0,u.unsafeGridRange)(d,h,p,f)}function S(e,t){return e===t||e.name===t.name&&e.path===t.path}function v(e,t){return S(e.document,t.document)&&e.index===t.index}function F(e,t){return e.row===t.row&&e.col===t.col}function y(e,t){return e.row===t.row&&e.col===t.col&&e.rows===t.rows&&e.cols===t.cols}function b(e){return(0,u.isGridCell)(e)?e:(0,u.unsafeGridRange)(e.row,e.col,1,1)}t.isWellFormed=function(e){return e.isWellFormed},t.forEachCellInRange=function(e,t){if((0,u.isGridCell)(e))return t(e,0,0);const{row:r,rows:n,col:a,cols:i}=e;for(let e=0;e<n;e+=1)for(let n=0;n<i;n+=1)if(!t((0,u.gridCell)(r+e,a+n),e,n))return!1;return!0},t.forEachTileInRange=function(e,t,r){const{row:n,rows:a,col:l,cols:c}=e;(0,o.assertPositiveInteger)("calc.lang.forEachTileInRange",t),(0,i.assertIndex)("calc.lang.forEachTileInRange",n,u.sheetRows),(0,i.assertIndex)("calc.lang.forEachTileInRange",l,u.sheetCols),(0,s.assertPositiveLength)("calc.lang.forEachTileInRange",a,u.sheetRows-n),(0,s.assertPositiveLength)("calc.lang.forEachTileInRange",c,u.sheetCols-l);for(let e=n;e<n+a;e+=t)for(let i=l;i<l+c;i+=t)if(!r((0,u.unsafeGridRange)(e,i,(0,g.fastMin)(t,a+n-e),(0,g.fastMin)(t,c+l-i))))return!1;return!0},t.gridRangeJoin=f,t.gridRangeJoinOpt=function(e,t){return e?t?f(e,t):e:t},t.gridRangesJoin=function(e){return 0===e.length&&(0,n.assertFalse)("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(f)},t.gridRangeIsect=function(e,t){const{row:r,col:n,rows:a,cols:i}=e,{row:o,col:s,rows:l,cols:c}=t,d=(0,m.fastMax)(r,o),h=(0,m.fastMax)(n,s),p=(0,g.fastMin)(r+a,o+l)-d,f=(0,g.fastMin)(n+i,s+c)-h;if(!(p<=0||f<=0))return(0,u.unsafeGridRange)(d,h,p,f)},t.gridRangeIsects=function(e,t){const{row:r,col:n,rows:a,cols:i}=e,{row:o,col:s,rows:u,cols:l}=t;return(0,m.fastMax)(r,o)<(0,g.fastMin)(r+a,o+u)&&(0,m.fastMax)(n,s)<(0,g.fastMin)(n+i,s+l)},t.gridCellImplicitIsect=function(e,t){const{row:r,col:n}=e,{row:a,col:i,rows:o,cols:s}=t,l=a<=r&&r<a+o,c=i<=n&&n<i+s;return l&&c?(0,u.gridCell)(r,n):l&&1===s?(0,u.gridCell)(r,i):c&&1===o?(0,u.gridCell)(a,n):1===s&&1===o?(0,u.gridCell)(a,i):void 0},t.gridRangeCompare=function(e,t){const{row:r,col:n,rows:a,cols:i}=e,{row:o,col:s,rows:u,cols:l}=t,c=r+a,d=o+u,g=n+i,m=s+l;return r===o&&c===d&&n===s&&g===m?0:r<=o&&c>=d&&n<=s&&g>=m?1:r>=o&&c<=d&&n>=s&&g<=m?-1:void 0},t.gridRangeExcept=function(e,t){const r=[e.row,e.row+e.rows],n=[e.col,e.col+e.cols],a=[t.row,t.row+t.rows],i=[t.col,t.col+t.cols],o=(0,h.ivlCompare)(r,a),s=(0,h.ivlCompare)(n,i);if(void 0!==o&&o<=0){const t=(0,h.ivlExcept)(n,i);if(void 0!==t)return(0,u.gridRange)(e.row,t[0],e.rows,t[1]-t[0])}if(void 0!==s&&s<=0){const t=(0,h.ivlExcept)(r,a);if(void 0!==t)return(0,u.gridRange)(t[0],e.col,t[1]-t[0],e.cols)}},t.gridRangeSize=function(e){return e.rows*e.cols},t.gridRangeAnchorHash=function(e){return u.sheetCols*e.row+e.col},t.isDocumentLocEqual=S,t.isSheetIndexEqual=v,t.sheetRangeToSheetIndex=function(e){if(e.index===e.index2)return{...e,__isRange:!1}},t.isNameScopeEqual=function(e,t){return S(e.document,t.document)&&e.index===t.index},t.isGridCellEqual=F,t.isGridRangeEqual=y,t.isSheetGridCellEqual=function(e,t){return v(e.sheet,t.sheet)&&F(e.range,t.range)},t.isSheetGridRangeEqual=function(e,t){return v(e.sheet,t.sheet)&&y(e.range,t.range)},t.gridRangeAnchor=b,t.sheetGridRangeAnchor=function(e){return(0,u.isSheetGridCell)(e)?e:(0,u.sheetGridCell)(e.sheet,b(e.range))},t.gridCellRange=function(e,t){const{row:r,col:n}=e,{row:a,col:i}=t;return(0,u.unsafeGridRange)((0,g.fastMin)(r,a),(0,g.fastMin)(n,i),Math.abs(a-r)+1,Math.abs(i-n)+1)};const C=[];function A(e){return e.kind===l.NodeKind.Literal&&k(e.oper)}function E(e){return e.kind===l.NodeKind.Literal&&R(e.oper)}function T(e){return e.kind===c.OperKind.Number}function R(e){return e.kind===c.OperKind.Boolean}function k(e){return e.kind===c.OperKind.Missing}t.getArguments=function(e){return 0===function(e){return 1===e.length&&A(e[0])?0:e.length}(e)?C:e},t.isOperatorNode=function(e){return e.kind===l.NodeKind.Operator},t.isWSFNode=function(e){return e.kind===l.NodeKind.WSF},t.isUnqualifiedNameNode=function(e){return e.kind===l.NodeKind.Name&&void 0===e.qualifier},t.isMissingNode=function(e){return e.kind===l.NodeKind.Missing},t.isMissingLiteralNode=A,t.isNumberLiteralNode=function(e){return e.kind===l.NodeKind.Literal&&T(e.oper)},t.isBooleanLiteralNode=E,t.getArgType=function({maxArgs:e,headTypes:t,restTypes:r,tailTypes:n},a,s){if((0,o.assertPositiveInteger)("calc.runtime.getArgType: n",s),(0,i.assertIndex)("calc.runtime.getArgType: i",a,s),a>=e)return c.SignatureType.None;if(a<t.length)return t[a];if(0===r.length)return c.SignatureType.None;if(a<t.length+r.length)return r[a-t.length];const u=(s-t.length)%r.length;return u>n.length?c.SignatureType.None:a>=s-u?n[a-(s-u)]:r[(a-t.length)%r.length]},t.isValidArgsLength=function({minArgs:e,maxArgs:t,headTypes:r,restTypes:n,tailTypes:a},i){return!(i<e||i>t)&&(i<=r.length+n.length||0!==n.length&&(i-r.length)%n.length<=a.length)},t.shouldFieldRefBeBracketed=function(e,t,r){if(0===r.length)return!1;if(t.field.kind!==l.NodeKind.Ident)return!1;let n=e;for(;n.kind===l.NodeKind.App&&n.head.kind===l.NodeKind.Operator;){const e=n.head.id;if(e!==p.OperatorId.Range&&e!==p.OperatorId.Isect||2!==n.args.length)break;n=n.args[1]}return E(n)||n.kind===l.NodeKind.Name||n.kind===l.NodeKind.CellRef},t.isNumberOper=T,t.isStringOper=function(e){return e.kind===c.OperKind.String},t.isBooleanOper=R,t.isErrorOper=function(e){return e.kind===c.OperKind.Error},t.isRangeOper=function(e){return e.kind===c.OperKind.Range},t.isArrayOper=function(e){return e.kind===c.OperKind.Array},t.isMissingOper=k,t.isBlankOper=function(e){return e.kind===c.OperKind.Blank},t.isRichOper=function(e){return e.kind===c.OperKind.Rich};const N=c.OperKind.Number|c.OperKind.String|c.OperKind.Boolean;t.isPrimitiveOper=function(e){return 0!=(e.kind&N)};const I=N|c.OperKind.Error|c.OperKind.Array|c.OperKind.Rich;var O;t.isWriteOper=function(e){return 0!=(e.kind&I)},t.isReadOperEqual=function e(t,r,n,i){if(n.kind!==r.kind)return!1;switch(n.kind){case c.OperKind.Boolean:case c.OperKind.String:return n.value===r.value;case c.OperKind.Number:return 0===t.cond2(n,r);case c.OperKind.Error:return n.type===r.type;case c.OperKind.Rich:return i;case c.OperKind.Array:const o=r;if(n.cols!==o.cols||n.rows!==o.rows)return!1;for(let r=0;r<n.rows;r+=1){const a=n.opers[r],s=o.opers[r];for(let r=0;r<n.cols;r+=1)if(!e(t,s[r],a[r],i))return!1}return!0;case c.OperKind.Blank:return!0;default:return(0,a.assertNever)("calc.lang.readOperEq",n)}},function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"}(O||(t.LangReasonKind=O={})),t.ReasonKind={...d.ReasonKind,...O},t.notImplemented=function(e){return{kind:t.ReasonKind.NotImplemented,features:e}},t.unavailable=function(e,...r){return 0===e.length&&(0,n.assertFalse)("calc.lang.unavailable: expected nonempty array"),{kind:t.ReasonKind.Unavailable,objects:e}},t.internal=function(e){return{kind:t.ReasonKind.Internal,message:e}},t.createFailureErrorClass=function(e){const t=function(t){this.reason=t,this.name=e,this.stack=e,this.message=t.kind};return(t.prototype=Object.create(Error.prototype)).constructor=t,t};t.getWorksheetFuncId=function(e,t){let r=t;return r.length>6&&0===e.stringCompareCI(r.substring(0,6),"_xlfn.")&&(r=r.substring(6),r.length>6&&0===e.stringCompareCI(r.substring(0,6),"_xlws.")&&(r=r.substring(6))),e.getWorksheetFuncId(r)};t.getUserDefinedFuncName=function(e,t){let r=t;return r.length>7&&0===e.stringCompareCI(r.substring(0,7),"_xludf.")&&(r=r.substring(7)),r};t.getEtaFuncId=function(e,t){let r=t;return r.length>7&&0===e.stringCompareCI(r.substring(0,7),"_xleta.")&&(r=r.substring(7)),e.getWorksheetFuncId(r)};function P(e){return e.kind!==l.StructRefKind.SpecialRef&&e.kind!==l.StructRefKind.BadRef||e.isBracketed}function M(e){return e.kind===l.StructRefKind.MissingRef||e.kind===l.StructRefKind.BadRef}function D(e){switch(e.kind){case l.StructRefKind.SpecialRef:case l.StructRefKind.ColumnRef:return e.isClosed;case l.StructRefKind.RangeOpRef:return D(e.lhs)&&D(e.rhs);case l.StructRefKind.MissingRef:return!0;case l.StructRefKind.BadRef:return e.isClosed}}t.getBoundName=function(e,t){let r=t;return r.length>6&&0===e.stringCompareCI(r.substring(0,6),"_xlpm.")&&(r=r.substring(6)),r},t.isCommaOpRefWellFormed=function(e){return e.columnRefs.length<=1&&e.refs.every(P)&&function({specialRefs:e}){const t=Object.keys(e).reduce(((t,r)=>t+(e[Number(r)]?1:0)),0);return 1===t||2===t&&e[l.SpecialRefId.Data]&&(e[l.SpecialRefId.Headers]||e[l.SpecialRefId.Totals])}(e)},t.isCommaOpClosed=function(e){return e.refs.every(D)},t.isCommaOpNoBadOrMissing=function(e){return!e.refs.some(M)},t.isRangeOpClosed=function(e){return D(e.lhs)&&D(e.rhs)},t.isRangeOpNoMissing=function(e){return!M(e.lhs)&&!M(e.rhs)};const w={[l.SpecialRefId.All]:1,[l.SpecialRefId.Headers]:2,[l.SpecialRefId.Data]:3,[l.SpecialRefId.Totals]:4,[l.SpecialRefId.ThisRow]:5},L=e=>e.kind===l.StructRefKind.MissingRef?7:e.kind!==l.StructRefKind.SpecialRef?6:w[e.id];function _(e,t){return L(e)-L(t)}t.normalizeCommaOpRef=function(e){const t={},r=[];for(const n of e.refs)n.kind!==l.StructRefKind.SpecialRef?r.push(n):void 0===t[n.id]&&(t[n.id]=!0,r.push(n));return r.sort(_),r},t.applyComparison=function(e,t){switch(e){case p.OperatorId.Eq:return 0===t;case p.OperatorId.Ne:return 0!==t;case p.OperatorId.Lt:return t<0;case p.OperatorId.Gt:return t>0;case p.OperatorId.Le:return t<=0;case p.OperatorId.Ge:return t>=0}}},8610:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.falseOper=t.trueOper=t.blankOper=t.missingOper=t.range3DOper=t.rangeSeqOper=t.arrayOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.naErrorOper=t.numErrorOper=t.nameErrorOper=t.refErrorOper=t.valueErrorOper=t.div0ErrorOper=t.nullErrorOper=t.errorOper=t.stringOper=t.booleanOper=t.precedents=t.ErrorType=t.cellStringLimit=t.PrecsBound=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(450);var u,l;function c(e){return{kind:s.OperKind.Error,type:e}}!function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"}(u||(t.PrecsBound=u={})),t.cellStringLimit=32767,function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.SPILL=9]="SPILL",e[e.CONNECT=10]="CONNECT",e[e.BLOCKED=11]="BLOCKED",e[e.UNKNOWN=12]="UNKNOWN",e[e.FIELD=13]="FIELD",e[e.CALC=14]="CALC",e[e.BUSY=16]="BUSY",e[e.EXTERNAL=19]="EXTERNAL",e[e.TIMEOUT=20]="TIMEOUT"}(l||(t.ErrorType=l={})),t.precedents=function(e,t,r,n,a){return{cells:e,names:t,udfs:r,special:n,bound:a}},t.booleanOper=function(e){return e?t.trueOper:t.falseOper},t.stringOper=function(e){return{kind:s.OperKind.String,value:e}},t.errorOper=function(e){const t=d[e];return void 0!==t?t:c(e)},t.nullErrorOper=c(l.NULL),t.div0ErrorOper=c(l.DIV0),t.valueErrorOper=c(l.VALUE),t.refErrorOper=c(l.REF),t.nameErrorOper=c(l.NAME),t.numErrorOper=c(l.NUM),t.naErrorOper=c(l.NA),t.gettingDataErrorOper=c(l.GETTING_DATA),t.spillErrorOper=c(l.SPILL),t.connectErrorOper=c(l.CONNECT),t.blockedErrorOper=c(l.BLOCKED),t.unknownErrorOper=c(l.UNKNOWN),t.fieldErrorOper=c(l.FIELD),t.calcErrorOper=c(l.CALC),t.busyErrorOper=c(l.BUSY),t.externalErrorOper=c(l.EXTERNAL);const d=(0,o.partialArray)({[l.NULL]:t.nullErrorOper,[l.DIV0]:t.div0ErrorOper,[l.VALUE]:t.valueErrorOper,[l.REF]:t.refErrorOper,[l.NAME]:t.nameErrorOper,[l.NUM]:t.numErrorOper,[l.NA]:t.naErrorOper,[l.GETTING_DATA]:t.gettingDataErrorOper,[l.SPILL]:t.spillErrorOper,[l.CONNECT]:t.connectErrorOper,[l.BLOCKED]:t.blockedErrorOper,[l.UNKNOWN]:t.unknownErrorOper,[l.FIELD]:t.fieldErrorOper,[l.CALC]:t.calcErrorOper,[l.BUSY]:t.busyErrorOper,[l.EXTERNAL]:t.externalErrorOper});t.arrayOper=function(e,t,r){return(0,n.assertNatural)("calc.lang.arrayOper",e),(0,n.assertNatural)("calc.lang.arrayOper",t),r.length!==e?(0,i.assertFalse)("calc.lang.arrayOper: Inconsistent row number"):{kind:s.OperKind.Array,rows:e,cols:t,opers:r}},t.rangeSeqOper=function(e,t){return(0,a.assertPositiveInteger)("calc.lang.rangeSeqOper",t.length),{kind:s.OperKind.Range,sheets:e,ranges:t}},t.range3DOper=function(e,t){return{kind:s.OperKind.Range,sheets:e,ranges:[t]}},t.missingOper={kind:s.OperKind.Missing},t.blankOper={kind:s.OperKind.Blank},t.trueOper={kind:s.OperKind.Boolean,value:!0},t.falseOper={kind:s.OperKind.Boolean,value:!1}},3309:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducePledge=t.reduceTopDown_Pledge=t.reduceBottomUp=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_Pledge=t.PledgeReducer=t.reduceBottomUp_CPS=t.reduceBottomUp_Recursive=t.zipVisitor=t.ZipVisitor=t.depthVisitor=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=t.bindVisitor=t.visitCellRef=t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6366),u=r(2701),l=r(2701);function c(e,t){switch(t.kind){case l.NodeKind.Literal:{const{oper:r,isClosed:n,label:a}=t;return e.literalNode(r,n,a)}case l.NodeKind.Array:{const{nodes:r,isClosed:n,label:a}=t;return e.arrayNode(r,n,a)}case l.NodeKind.App:{const{head:r,args:n,isClosed:a,label:i}=t;return e.appNode(r,n,a,i)}case l.NodeKind.Let:{const{head:r,vars:n,body:a,badArgs:i,isClosed:o,label:s}=t;return e.letNode(r,n,a,i,o,s)}case l.NodeKind.Lambda:{const{head:r,params:n,body:a,badArgs:i,isClosed:o,label:s}=t;return e.lambdaNode(r,n,a,i,o,s)}case l.NodeKind.Paren:{const{node:r,isClosed:n,label:a}=t;return e.parenNode(r,n,a)}case l.NodeKind.Name:{const{parts:r,qualifier:n,label:a}=t;return e.nameNode(r,n,a)}case l.NodeKind.CellRef:{const{ref:r,qualifier:n,label:a}=t;return e.cellRefNode(r,n,a)}case l.NodeKind.FieldRef:{const{lhs:r,rhs:n,label:a}=t;return e.fieldRefNode(r,n,a)}case l.NodeKind.StructRef:{const{lhs:r,rhs:n,label:a}=t;return e.structRefNode(r,n,a)}case l.NodeKind.Missing:{const{chars:r,label:n}=t;return e.missingNode(r,n)}case l.NodeKind.BadChars:{const{type:r,chars:n,label:a}=t;return e.badCharsNode(r,n,a)}case l.NodeKind.BadSequence:{const{type:r,contents:n,label:a}=t;return e.badSequenceNode(r,n,a)}default:return(0,n.assertNever)("calc.lang.visitFormulaNode",t)}}function d(e,t){const{id:r,label:n}=t;return e.operatorNode(r,n)}function g(e,t){const{id:r,whole:n,label:a}=t;return e.wsfNode(r,n,a)}function m(e,t){switch(t.kind){case l.NodeKind.Operator:return d(e,t);case l.NodeKind.WSF:return g(e,t);default:return c(e,t)}}function h(e){return{literalNode:e.literalNode.bind(e),arrayNode:e.arrayNode.bind(e),appNode:e.appNode.bind(e),letNode:e.letNode.bind(e),lambdaNode:e.lambdaNode.bind(e),parenNode:e.parenNode.bind(e),nameNode:e.nameNode.bind(e),cellRefNode:e.cellRefNode.bind(e),fieldRefNode:e.fieldRefNode.bind(e),structRefNode:e.structRefNode.bind(e),missingNode:e.missingNode.bind(e),badSequenceNode:e.badSequenceNode.bind(e),badCharsNode:e.badCharsNode.bind(e),operatorNode:e.operatorNode.bind(e),wsfNode:e.wsfNode.bind(e)}}t.visitFormulaNode=c,t.visitOperatorNode=d,t.visitWSFNode=g,t.visitAppHeadNode=m,t.visitQualifier=function(e,t){switch(t.kind){case l.QualifierKind.Error:{const{label:r}=t;return e.errorQualifier(r)}case l.QualifierKind.Relative:{const{label:r}=t;return e.relativeQualifier(r)}case l.QualifierKind.Document:{const{document:r,path:n,isQuoted:a,label:i}=t;return e.documentQualifier(r,n,a,i)}case l.QualifierKind.Sheet:{const{sheet:r,document:n,isQuoted:a,label:i}=t;return e.sheetQualifier(r,n,a,i)}case l.QualifierKind.Ident:{const{name:r,isQuoted:n,label:a}=t;return e.identQualifier(r,n,a)}case l.QualifierKind.SheetRange:{const{sheet1:r,sheet2:n,document:a,isQuoted:i,label:o}=t;return e.sheetRangeQualifier(r,n,a,i,o)}case l.QualifierKind.Bad:{const{chars:r,isQuoted:n,isClosed:a,isTerminated:i,label:o}=t;return e.badQualifier(r,n,a,i,o)}default:return(0,n.assertNever)("calc.lang.visitQualifier",t)}},t.visitCellRef=function(e,t){switch(t.kind){case l.CellRefKind.Error:{const{label:r}=t;return e.cellRefError(r)}case l.CellRefKind.Single:{const{row:r,col:n,isBracketed:a,label:i}=t;return e.cellRefSingle(r,n,a,i)}case l.CellRefKind.Range:{const{ref1:r,ref2:n,label:a}=t;return e.cellRefRange(r,n,a)}case l.CellRefKind.Row:{const{row1:r,row2:n,isBracketed:a,label:i}=t;return e.cellRefRow(r,n,a,i)}case l.CellRefKind.Col:{const{col1:r,col2:n,isBracketed:a,label:i}=t;return e.cellRefCol(r,n,a,i)}case l.CellRefKind.Bad:{const{chars:r,isBracketed:n,label:a}=t;return e.cellRefBad(r,n,a)}default:return(0,n.assertNever)("calc.lang.visitCellRef",t)}},t.bindVisitor=h;class p{literalNode(e,t,r){return(0,l.literalNode)(e,t,r)}arrayNode(e,t,r){return(0,l.arrayNode)(e,t,r)}appNode(e,t,r,n){return(0,l.appNode)(e,t,r,n)}letNode(e,t,r,n,a,i){return(0,l.letNode)(e,t,r,n,a,i)}lambdaNode(e,t,r,n,a,i){return(0,l.lambdaNode)(e,t,r,n,a,i)}parenNode(e,t,r){return(0,l.parenNode)(e,t,r)}nameNode(e,t,r){return(0,l.nameNode)(e,t,r)}cellRefNode(e,t,r){return(0,l.cellRefNode)(e,t,r)}fieldRefNode(e,t,r){return(0,l.fieldRefNode)(e,t,r)}structRefNode(e,t,r){return(0,l.structRefNode)(e,t,r)}missingNode(e,t){return(0,l.missingNode)(e,t)}badSequenceNode(e,t,r){return(0,u.badSequenceNode)(e,t,r)}badCharsNode(e,t,r){return(0,u.badCharsNode)(e,t,r)}operatorNode(e,t){return(0,l.operatorNode)(e,t)}wsfNode(e,t,r){return(0,l.wsfNode)(e,t,r)}}t.IdentityVisitor=p,t.identityVisitor=h(new p);class f{literalNode(e,t,r){return this.value}arrayNode(e,t,r){return this.value}appNode(e,t,r,n){return this.value}letNode(e,t,r,n,a,i){return this.value}lambdaNode(e,t,r,n,a,i){return this.value}parenNode(e,t,r){return this.value}nameNode(e,t,r){return this.value}cellRefNode(e,t,r){return this.value}fieldRefNode(e,t,r){return this.value}structRefNode(e,t,r){return this.value}missingNode(e,t){return this.value}badSequenceNode(e,t,r){return this.value}badCharsNode(e,t,r){return this.value}operatorNode(e,t){return this.value}wsfNode(e,t,r){return this.value}constructor(e){this.value=e}}function S(e){return h(new f(e))}t.ConstVisitor=f,t.constVisitor=S,t.voidVisitor=S(void 0);class v{literalNode(e,t,r){return this.visitor.literalNode(e,t,r)}arrayNode(e,t,r){return this.visitor.arrayNode(e,t,r)}appNode(e,t,r,n){return this.visitor.appNode(e,t,r,n)}letNode(e,t,r,n,a,i){return this.visitor.letNode(e,t,r,n,a,i)}lambdaNode(e,t,r,n,a,i){return this.visitor.lambdaNode(e,t,r,n,a,i)}parenNode(e,t,r){return this.visitor.parenNode(e,t,r)}nameNode(e,t,r){return this.visitor.nameNode(e,t,r)}cellRefNode(e,t,r){return this.visitor.cellRefNode(e,t,r)}fieldRefNode(e,t,r){return this.visitor.fieldRefNode(e,t,r)}structRefNode(e,t,r){return this.visitor.structRefNode(e,t,r)}missingNode(e,t){return this.visitor.missingNode(e,t)}badSequenceNode(e,t,r){return this.visitor.badSequenceNode(e,t,r)}badCharsNode(e,t,r){return this.visitor.badCharsNode(e,t,r)}operatorNode(e,t){return this.visitor.operatorNode(e,t)}wsfNode(e,t,r){return this.visitor.wsfNode(e,t,r)}constructor(e){this.visitor=e}}t.DelegatingVisitor=v;class F extends v{arrayNode(e,t,r){return(0,a.assertTrue)("calc.lang.binaryVisitor: non-empty array",e.length>0&&e[0].length>0),e.map((e=>e.reduce(this.reducer))).reduce(this.reducer)}appNode(e,t,r,n){return t.reduce(this.reducer,e)}letNode(e,t,r,n,a,i){return[...t.map((({binder:e})=>e.arg)),...void 0===r?[]:[r.arg],...n.map((e=>e.arg))].reduce(this.reducer,e)}lambdaNode(e,t,r,n,a,i){return[...t.map((({name:e})=>e.arg.def?.rhs)).filter(o.isDefined),...void 0===r?[]:[r.arg],...n.map((e=>e.arg))].reduce(this.reducer,e)}parenNode(e,t,r){return e}fieldRefNode(e,t,r){return e}badSequenceNode(e,t,r){return(0,a.assertTrue)("calc.lang.binaryVisitor: non-empty bad-sequence",t.length>0),t.reduce(this.reducer)}constructor(e,t){super(e),this.reducer=(e,r)=>t(e,r)}}function y(e,t){return h(new F(e,t))}t.BinaryVisitor=F,t.binaryVisitor=y;class b{literalNode(e,t,r){return this.b(this.a.literalNode(e,t,r))}arrayNode(e,t,r){return this.b(this.a.arrayNode(e,t,r))}appNode(e,t,r,n){return this.b(this.a.appNode(e,t,r,n))}letNode(e,t,r,n,a,i){return this.b(this.a.letNode(e,t,r,n,a,i))}lambdaNode(e,t,r,n,a,i){return this.b(this.a.lambdaNode(e,t,r,n,a,i))}parenNode(e,t,r){return this.b(this.a.parenNode(e,t,r))}nameNode(e,t,r){return this.b(this.a.nameNode(e,t,r))}cellRefNode(e,t,r){return this.b(this.a.cellRefNode(e,t,r))}fieldRefNode(e,t,r){return this.b(this.a.fieldRefNode(e,t,r))}structRefNode(e,t,r){return this.b(this.a.structRefNode(e,t,r))}missingNode(e,t){return this.b(this.a.missingNode(e,t))}badSequenceNode(e,t,r){return this.b(this.a.badSequenceNode(e,t,r))}badCharsNode(e,t,r){return this.b(this.a.badCharsNode(e,t,r))}operatorNode(e,t){return this.b(this.a.operatorNode(e,t))}wsfNode(e,t,r){return this.b(this.a.wsfNode(e,t,r))}constructor(e,t){this.a=e,this.b=t}}function C(e,t){return h(new b(e,t))}t.ComposeVisitor=b,t.composeVisitor=C,t.depthVisitor=C(y(S(0),i.fastMax),(e=>e+1));class A{literalNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].literalNode(e,t,r);return n}arrayNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].arrayNode(e,t,r);return n}appNode(e,t,r,n){const a={};for(const i of this.keys)a[i]=this.visitors[i].appNode(e,t,r,n);return a}letNode(e,t,r,n,a,i){const o={};for(const s of this.keys)o[s]=this.visitors[s].letNode(e,t,r,n,a,i);return o}lambdaNode(e,t,r,n,a,i){const o={};for(const s of this.keys)o[s]=this.visitors[s].lambdaNode(e,t,r,n,a,i);return o}parenNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].parenNode(e,t,r);return n}nameNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].nameNode(e,t,r);return n}cellRefNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].cellRefNode(e,t,r);return n}fieldRefNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].fieldRefNode(e,t,r);return n}structRefNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].structRefNode(e,t,r);return n}missingNode(e,t){const r={};for(const n of this.keys)r[n]=this.visitors[n].missingNode(e,t);return r}badSequenceNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].badSequenceNode(e,t,r);return n}badCharsNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].badCharsNode(e,t,r);return n}operatorNode(e,t){const r={};for(const n of this.keys)r[n]=this.visitors[n].operatorNode(e,t);return r}wsfNode(e,t,r){const n={};for(const a of this.keys)n[a]=this.visitors[a].wsfNode(e,t,r);return n}constructor(e){this.visitors=e,this.keys=Object.keys(e)}}function E(e,t){const r=t=>{switch(t.kind){case l.NodeKind.Literal:{const{oper:r,isClosed:n,label:a}=t;return e.literalNode(r,n,a)}case l.NodeKind.Array:{const{nodes:n,isClosed:a,label:i}=t;return e.arrayNode(n.map((e=>e.map(r))),a,i)}case l.NodeKind.App:{const{head:n,args:a,isClosed:i,label:o}=t;return e.appNode((t=>{switch(t.kind){case l.NodeKind.Operator:return d(e,t);case l.NodeKind.WSF:return g(e,t);default:return r(t)}})(n),a.map(r),i,o)}case l.NodeKind.Let:{const{head:n,vars:a,body:i,badArgs:o,isClosed:s,label:u}=t;return e.letNode(g(e,n),a.map((({name:e,binder:t})=>(0,l.letVar)(e,(0,l.indexedArg)(r(t.arg),t.index)))),void 0===i?void 0:(0,l.indexedArg)(r(i.arg),i.index),o.map((e=>(0,l.indexedArg)(r(e.arg),e.index))),s,u)}case l.NodeKind.Lambda:{const{head:n,params:a,body:i,badArgs:o,isClosed:s,label:u}=t;return e.lambdaNode(g(e,n),a.map((({name:e})=>void 0===e.arg.def?(0,l.lambdaParam)(e):(0,l.lambdaParam)((0,l.indexedArg)((0,l.paramNode)(e.arg.name,(0,l.paramDefault)(r(e.arg.def.rhs),e.arg.def.label),e.arg.label),e.index)))),void 0===i?void 0:(0,l.indexedArg)(r(i.arg),i.index),o.map((e=>(0,l.indexedArg)(r(e.arg),e.index))),s,u)}case l.NodeKind.Paren:{const{node:n,isClosed:a,label:i}=t;return e.parenNode(r(n),a,i)}case l.NodeKind.Name:{const{parts:r,qualifier:n,label:a}=t;return e.nameNode(r,n,a)}case l.NodeKind.CellRef:{const{ref:r,qualifier:n,label:a}=t;return e.cellRefNode(r,n,a)}case l.NodeKind.FieldRef:{const{lhs:n,rhs:a,label:i}=t;return e.fieldRefNode(r(n),a,i)}case l.NodeKind.StructRef:{const{lhs:r,rhs:n,label:a}=t;return e.structRefNode(r,n,a)}case l.NodeKind.Missing:{const{chars:r,label:n}=t;return e.missingNode(r,n)}case l.NodeKind.BadChars:{const{type:r,chars:n,label:a}=t;return e.badCharsNode(r,n,a)}case l.NodeKind.BadSequence:{const{type:n,contents:a,label:i}=t;return e.badSequenceNode(n,a.map(r),i)}default:return(0,n.assertNever)("calc.lang.reduceBottomUp_Recursive",t)}};return r(t)}function T(e,t,r,n){const a=[],i=e=>(a.push(e),o),o=()=>a.length<t.length?r(e,t[a.length],i):n(a);return o}function R(e,t,r){return T(e,t,M,r)}function k(e,t,r,n){return()=>void 0!==t?r(e,t,n):n(void 0)}function N(e,t,r){const{id:n,whole:a,label:i}=t;return()=>r(e.wsfNode(n,a,i))}function I(e,{name:t,binder:r},n){return M(e,r.arg,(e=>n((0,l.letVar)(t,(0,l.indexedArg)(e,r.index)))))}function O(e,{name:t},r){const n=t.arg;return void 0===n.def?()=>r((0,l.lambdaParam)(t)):M(e,n.def.rhs,(e=>r((0,l.lambdaParam)((0,l.indexedArg)((0,l.paramNode)(n.name,(0,l.paramDefault)(e,n.def.label),n.label),t.index)))))}function P(e,{arg:t,index:r},n){return M(e,t,(e=>n((0,l.indexedArg)(e,r))))}function M(e,t,r){switch(t.kind){case l.NodeKind.Literal:{const{oper:n,isClosed:a,label:i}=t;return()=>r(e.literalNode(n,a,i))}case l.NodeKind.Array:{const{nodes:n,isClosed:a,label:i}=t;return T(e,n,R,(t=>r(e.arrayNode(t,a,i))))}case l.NodeKind.App:{const{head:n,args:a,isClosed:i,label:o}=t;return()=>function(e,t,r){switch(t.kind){case l.NodeKind.Operator:{const{id:n,label:a}=t;return()=>r(e.operatorNode(n,a))}case l.NodeKind.WSF:return N(e,t,r);default:return M(e,t,r)}}(e,n,(t=>R(e,a,(n=>r(e.appNode(t,n,i,o))))))}case l.NodeKind.Let:{const{head:n,vars:a,body:i,badArgs:o,isClosed:s,label:u}=t;return()=>N(e,n,(t=>T(e,a,I,(n=>k(e,i,P,(a=>T(e,o,P,(i=>r(e.letNode(t,n,a,i,s,u))))))))))}case l.NodeKind.Lambda:{const{head:n,params:a,body:i,badArgs:o,isClosed:s,label:u}=t;return()=>N(e,n,(t=>()=>T(e,a,O,(n=>k(e,i,P,(a=>T(e,o,P,(i=>r(e.lambdaNode(t,n,a,i,s,u))))))))))}case l.NodeKind.Paren:{const{node:n,isClosed:a,label:i}=t;return()=>M(e,n,(t=>()=>r(e.parenNode(t,a,i))))}case l.NodeKind.Name:{const{parts:n,qualifier:a,label:i}=t;return()=>r(e.nameNode(n,a,i))}case l.NodeKind.CellRef:{const{ref:n,qualifier:a,label:i}=t;return()=>r(e.cellRefNode(n,a,i))}case l.NodeKind.FieldRef:{const{lhs:n,rhs:a,label:i}=t;return()=>M(e,n,(t=>()=>r(e.fieldRefNode(t,a,i))))}case l.NodeKind.StructRef:{const{lhs:n,rhs:a,label:i}=t;return()=>r(e.structRefNode(n,a,i))}case l.NodeKind.Missing:{const{chars:n,label:a}=t;return()=>r(e.missingNode(n,a))}case l.NodeKind.BadChars:{const{type:n,chars:a,label:i}=t;return()=>r(e.badCharsNode(n,a,i))}case l.NodeKind.BadSequence:{const{type:n,contents:a,label:i}=t;return R(e,a,(t=>r(e.badSequenceNode(n,t,i))))}default:return(0,n.assertNever)("calc.lang.reduceBottomUp_CPS",t)}}function D(e,t){let r;return function(e){let t=e;for(;null!=t;)t=t()}(M(e,t,(e=>{r=e}))),r}t.ZipVisitor=A,t.zipVisitor=function(e){return h(new A(e))},t.reduceBottomUp_Recursive=E,t.reduceBottomUp_CPS=D;class w{literalNode(e,t,r){return s.Pledge.try((()=>this.visitor.literalNode(e,t,r)))}arrayNode(e,t,r){return s.Pledge.all(e.map((e=>s.Pledge.all(e.map(this.lazyVisitFormulaNode))))).bind((e=>this.visitor.arrayNode(e,t,r)))}appNode(e,t,r,n){return this.lazyVisitAppHeadNode(e).bind((e=>s.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((t=>this.visitor.appNode(e,t,r,n)))))}letNode(e,t,r,n,a,i){return this.lazyVisitWSFNode(e).bind((e=>s.Pledge.all(t.map(this.lazyVisitVar)).bind((t=>(void 0===r?s.Pledge.resolve(void 0):this.lazyVisitIndexedArg(r)).bind((r=>s.Pledge.all(n.map(this.lazyVisitIndexedArg)).bind((n=>this.visitor.letNode(e,t,r,n,a,i)))))))))}lambdaNode(e,t,r,n,a,i){return this.lazyVisitWSFNode(e).bind((e=>s.Pledge.all(t.map(this.lazyVisitParam)).bind((t=>(void 0===r?s.Pledge.resolve(void 0):this.lazyVisitIndexedArg(r)).bind((r=>s.Pledge.all(n.map(this.lazyVisitIndexedArg)).bind((n=>this.visitor.lambdaNode(e,t,r,n,a,i)))))))))}parenNode(e,t,r){return this.lazyVisitFormulaNode(e).bind((e=>this.visitor.parenNode(e,t,r)))}nameNode(e,t,r){return s.Pledge.try((()=>this.visitor.nameNode(e,t,r)))}cellRefNode(e,t,r){return s.Pledge.try((()=>this.visitor.cellRefNode(e,t,r)))}fieldRefNode(e,t,r){return this.lazyVisitFormulaNode(e).bind((e=>this.visitor.fieldRefNode(e,t,r)))}structRefNode(e,t,r){return s.Pledge.try((()=>this.visitor.structRefNode(e,t,r)))}missingNode(e,t){return s.Pledge.try((()=>this.visitor.missingNode(e,t)))}badSequenceNode(e,t,r){return s.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((t=>this.visitor.badSequenceNode(e,t,r)))}badCharsNode(e,t,r){return s.Pledge.try((()=>this.visitor.badCharsNode(e,t,r)))}operatorNode(e,t){return s.Pledge.try((()=>this.visitor.operatorNode(e,t)))}wsfNode(e,t,r){return s.Pledge.try((()=>this.visitor.wsfNode(e,t,r)))}constructor(e){this.visitor=e,this.visitFormulaNode=e=>c(this,e),this.lazyVisitFormulaNode=e=>s.Pledge.resolve(e).bind(this.visitFormulaNode),this.visitAppHeadNode=e=>m(this,e),this.lazyVisitAppHeadNode=e=>s.Pledge.resolve(e).bind(this.visitAppHeadNode),this.visitWSFNode=e=>g(this,e),this.lazyVisitWSFNode=e=>s.Pledge.resolve(e).bind(this.visitWSFNode),this.lazyVisitVar=({name:e,binder:t})=>this.lazyVisitFormulaNode(t.arg).bind((r=>(0,l.letVar)(e,(0,l.indexedArg)(r,t.index)))),this.lazyVisitParam=({name:e})=>{const t=e.arg;return void 0===t.def?s.Pledge.resolve((0,l.lambdaParam)(e)):this.lazyVisitFormulaNode(t.def.rhs).bind((r=>(0,l.lambdaParam)((0,l.indexedArg)((0,l.paramNode)(t.name,(0,l.paramDefault)(r,t.def.label),t.label),e.index))))},this.lazyVisitIndexedArg=({arg:e,index:t})=>this.lazyVisitFormulaNode(e).bind((e=>(0,l.indexedArg)(e,t)))}}t.PledgeReducer=w,t.reduceBottomUp_Pledge=function(e,t){return _(new w(e),t)};function L(e,t,r){return r<=50?E(e,t):D(e,t)}function _(e,t){return s.Pledge.settleOrThrow(s.Pledge.resolve(c(e,t)))}t.reduceBottomUp_MaxDepth=L,t.reduceBottomUp=function(e,t){return L(e,t.node,t.depthUpperBound)},t.reduceTopDown_Pledge=_,t.reducePledge=function(e,t){return _(e,t.node)}},8630:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldInstallFormat=t.parseEdit=void 0;const n=r(6366),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6442),d=r(6824),g=r(7843),m=r(6366),h=r(6366),p=r(6366),f=r(6366);function S(e){const t=(0,n.stringStartsWith)(e,"'"),r=t?e.substring(1):e;return r.length>i.cellStringLimit?(0,m.failure)((0,c.notValueString)("cell text too long")):(0,h.success)((0,c.stringEdit)((0,s.stringOper)(r),t))}function v(e,t,r){return(0,g.parseDateInternal)((0,g.initParseDateGlobals)(e),t,r,c.GetTimeKind.ValueCell)}function F(e,t,r){const{localeInfo:n,mathpack:a}=e.config,i=n.isEastAsia&&r.valueType===c.FormatValueType.Percentage&&!0;let o=!1;switch(r.valueType){case c.FormatValueType.Number:case c.FormatValueType.Currency:case c.FormatValueType.Percentage:case c.FormatValueType.Fraction:case c.FormatValueType.Scientific:case c.FormatValueType.Accounting:o=!0}return(0,d.parseConstInternal)(n,a,t,i,!0,o)}t.parseEdit=function(e,t,r){try{if(r.valueType===c.FormatValueType.Text)return S(t);if(""===t)return(0,h.success)((0,c.otherEdit)(a.blankOper));if(t.length>1&&(0,n.stringStartsWith)(t,"="))return(0,h.success)((0,c.formulaEdit)(t));if(!(0,n.stringStartsWith)(t,"'")){const n=function(e,t,r){const n=function(e,t){if(0===e.stringCompareCI(t,e.trueName))return u.trueOper;if(0===e.stringCompareCI(t,e.falseName))return l.falseOper;for(let r=1;r<e.errorNames.length;r+=1){const n=e.errorNames[r];if(null!=n&&0===e.stringCompareCI(n,t))return(0,o.errorOper)(r)}}(e.config.localeInfo,t);if(void 0!==n)return(0,h.success)((0,c.otherEdit)(n));const a=r.valueType===c.FormatValueType.Date||r.valueType===c.FormatValueType.Time?[v,F]:[F,v];for(const n of a){const a=n(e,t,r);if(!(0,p.isSuccess)(a))return a;if(void 0!==a.value){const{value:e,format:t}=a.value;return(0,h.success)((0,c.numberEdit)(e,t))}}return(0,h.success)(void 0)}(e,t,r);if(!(0,p.isSuccess)(n))return n;if(void 0!==n.value)return(0,h.success)(n.value)}return t.length>1&&function(e){const t=e.charAt(0);return"="===t||"+"===t||"-"===t||"@"===t}(t)?(0,h.success)((0,c.formulaEdit)(t)):S(t)}catch(e){return(0,m.failure)((0,f.javaScriptError)(e))}},t.shouldInstallFormat=function(e,t){return e!==t&&t.source===c.NumberFormatSource.Builtin&&(t.valueType===c.FormatValueType.General||function(e,t){return e?.valueType!==c.FormatValueType.Number&&t.valueType!==c.FormatValueType.Number&&e?.valueType!==t.valueType}(e,t))}},3240:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormat=t.evalFormatImpl=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6442),b=r(6067),C=r(6067),A=r(6067),E=r(6067),T=r(6067),R=r(6067),k=r(6366),N=r(6067),I=r(6366),O=r(6366),P=r(6366),M=r(6366),D=r(6366),w=r(6067),L=r(6067),_=r(6366),x=(0,k.typedInstanceCreator)()(((e,t,r,n)=>({strong:e,format:t,valueType:r,decimals:n}))),K={},W=(0,d.createFailureErrorClass)("InferenceError"),U={getDocumentLoc:()=>(0,a.assertFalse)("calc.numfmt.evalFormula: default getDocumentLoc"),getSheetIndex:()=>(0,a.assertFalse)("calc.numfmt.evalFormula: default getSheetIndex"),getSheetName:()=>(0,a.assertFalse)("calc.numfmt.evalFormula: default getSheetName"),getNameLoc:()=>(0,a.assertFalse)("calc.numfmt.evalFormula: default getNameLoc"),getUserDefinedFuncLoc:()=>(0,a.assertFalse)("calc.numfmt.evalFormula: default getUserDefinedFuncLoc"),getSheetRangeIndexes:()=>(0,a.assertFalse)("calc.numfmt.evalFormula: default getSheetRangeIndexes"),getCellFormat:()=>(0,a.assertFalse)("calc.numfmt.evalFormula: default getCellFormat"),getKnownFormat:()=>(0,a.assertFalse)("calc.numfmt.evalFormula: default getKnownFormat"),getIformat:()=>(0,a.assertFalse)("calc.numfmt.evalFormula: default getIformat"),getFormatString:()=>(0,a.assertFalse)("calc.numfmt.evalFormula: default getFormatString"),getContainingTable:()=>(0,a.assertFalse)("calc.numfmt.evalFormula: default getContainingTable"),getStructRefColumn:()=>(0,a.assertFalse)("calc.numfmt.evalFormula: default getStructRefColumn"),getStructRefSpecialRef:()=>(0,a.assertFalse)("calc.numfmt.evalFormula: default getStructRefSpecialRef")};function G(e,t){const r=function(e){return{config:e.config,getDocumentLoc:e.getDocumentLoc?.bind(e)??U.getDocumentLoc,getSheetIndex:e.getSheetIndex?.bind(e)??U.getSheetIndex,getSheetName:e.getSheetName?.bind(e)??U.getSheetName,getNameLoc:e.getNameLoc?.bind(e)??U.getNameLoc,getUserDefinedFuncLoc:e.getUserDefinedFuncLoc?.bind(e)??U.getUserDefinedFuncLoc,getSheetRangeIndexes:e.getSheetRangeIndexes?.bind(e)??U.getSheetRangeIndexes,getCellFormat:e.getCellFormat?.bind(e)??U.getCellFormat,getKnownFormat:e.getKnownFormat?.bind(e)??U.getKnownFormat,getIformat:e.getIformat?.bind(e)??U.getIformat,getFormatString:e.getFormatString?.bind(e)??U.getFormatString,getContainingTable:e.getContainingTable?.bind(e)??U.getContainingTable,getStructRefColumn:e.getStructRefColumn?.bind(e)??U.getStructRefColumn,getStructRefSpecialRef:e.getStructRefSpecialRef?.bind(e)??U.getStructRefSpecialRef}}(e);return{globals:r,locals:t,config:e.config,localeInfo:t.config?.localeInfo??e.config.localeInfo,mathpack:e.config.mathpack,get document(){const e=t.originSheet;if(!(0,P.isSuccess)(e))throw new W(e);return e.value.document},get defaultFormat(){const e=Q(this,N.KnownFormat.General);return x(!1,e,e.valueType,e.decimals)},get unitlessFormat(){const e=Q(this,N.KnownFormat.General);return x(!0,e,e.valueType,e.decimals)},resolver:(0,C.createResolver)(r),multOrDivTainted:!1}}const B={[y.FormatValueType.General]:0,[y.FormatValueType.Number]:1,[y.FormatValueType.Currency]:2,[y.FormatValueType.Accounting]:2,[y.FormatValueType.Percentage]:3,[y.FormatValueType.Date]:4,[y.FormatValueType.Time]:5,[y.FormatValueType.Fraction]:6,[y.FormatValueType.Scientific]:7,[y.FormatValueType.Text]:8,[y.FormatValueType.Custom]:9};var V;!function(e){e[e.Propagate=-2147483648]="Propagate",e[e.Ignore=-2147483647]="Ignore"}(V||(V={}));const j={[A.WorksheetFuncId.INT]:V.Propagate,[A.WorksheetFuncId.MOD]:V.Propagate,[A.WorksheetFuncId.ROUND]:V.Propagate,[A.WorksheetFuncId.SUM]:V.Propagate,[A.WorksheetFuncId.TRUNC]:V.Propagate,[A.WorksheetFuncId.AVERAGE]:V.Propagate,[A.WorksheetFuncId.MAX]:V.Propagate,[A.WorksheetFuncId.MEDIAN]:V.Propagate,[A.WorksheetFuncId.MIN]:V.Propagate,[A.WorksheetFuncId.ROUNDUP]:V.Propagate,[A.WorksheetFuncId.ROUNDDOWN]:V.Propagate,[A.WorksheetFuncId.NPV]:N.KnownFormat.CoCurrencyDec,[A.WorksheetFuncId.PV]:N.KnownFormat.CoCurrencyDec,[A.WorksheetFuncId.FV]:N.KnownFormat.CoCurrencyDec,[A.WorksheetFuncId.PMT]:N.KnownFormat.CoCurrencyDec,[A.WorksheetFuncId.RATE]:N.KnownFormat.Pct0,[A.WorksheetFuncId.MIRR]:N.KnownFormat.Pct0,[A.WorksheetFuncId.IRR]:N.KnownFormat.Pct0,[A.WorksheetFuncId.DATE]:N.KnownFormat.MMDDYY,[A.WorksheetFuncId.TIME]:N.KnownFormat.HHMMAP,[A.WorksheetFuncId.NOW]:N.KnownFormat.MDYHMS,[A.WorksheetFuncId.SLN]:N.KnownFormat.CoCurrencyDec,[A.WorksheetFuncId.SYD]:N.KnownFormat.CoCurrencyDec,[A.WorksheetFuncId.DDB]:N.KnownFormat.CoCurrencyDec,[A.WorksheetFuncId.IPMT]:N.KnownFormat.CoCurrencyDec,[A.WorksheetFuncId.PPMT]:N.KnownFormat.CoCurrencyDec,[A.WorksheetFuncId.TODAY]:N.KnownFormat.MMDDYY,[A.WorksheetFuncId.VDB]:N.KnownFormat.CoCurrencyDec,[A.WorksheetFuncId.DB]:N.KnownFormat.CoCurrencyDec},H=[[y.FormatValueType.General,y.FormatValueType.Number,y.FormatValueType.Currency,y.FormatValueType.Percentage,y.FormatValueType.Date,y.FormatValueType.Time,y.FormatValueType.Fraction,y.FormatValueType.Scientific,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.Number,y.FormatValueType.Currency,y.FormatValueType.Percentage,y.FormatValueType.Date,y.FormatValueType.Time,y.FormatValueType.Number,y.FormatValueType.Scientific,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Currency,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Currency,y.FormatValueType.Currency,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Percentage,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Percentage,y.FormatValueType.Percentage,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Date,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Time,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Fraction,y.FormatValueType.Scientific,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Scientific,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Custom]],q=[[y.FormatValueType.General,y.FormatValueType.Number,y.FormatValueType.Currency,y.FormatValueType.General,y.FormatValueType.Date,y.FormatValueType.Time,y.FormatValueType.Fraction,y.FormatValueType.Scientific,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.Number,y.FormatValueType.Currency,y.FormatValueType.Number,y.FormatValueType.Date,y.FormatValueType.Time,y.FormatValueType.Fraction,y.FormatValueType.Scientific,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Currency,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Currency,y.FormatValueType.Currency,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Percentage,y.FormatValueType.Date,y.FormatValueType.Time,y.FormatValueType.Percentage,y.FormatValueType.Scientific,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Date,y.FormatValueType.Date,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Time,y.FormatValueType.Time,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Fraction,y.FormatValueType.Scientific,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Scientific,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Text,y.FormatValueType.Custom],[y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.General,y.FormatValueType.Custom]];function z(e,t){if("number"!=typeof t)return t;const r=e.globals.getIformat(e.document,t);if(!(0,P.isSuccess)(r))throw new W(r.reason);return r.value}function Q(e,t){const r=e.globals.getKnownFormat(e.document,t);if(!(0,P.isSuccess)(r))throw new W(r.reason);return r.value}function $(e,t){if("number"==typeof t)return t;const r=e.globals.getFormatString(e.document,t.formatString);if(!(0,P.isSuccess)(r))throw new W(r.reason);return void 0!==r.value?r.value:t}function Y(e,t,r){(0,i.assertTrue)("calc.numfmt.evalFormula: well-formed bin op",2===t.length);const[n,a]=t;return r(e,n,a)}function J(e,t,[r],[n]){const a=B[r.valueType],i=B[n.valueType],o=a<=i?t[a][i]:t[i][a],s=B[o],u=n.decimals>r.decimals?n.decimals:r.decimals;switch(s){case a:return x(!0,r.format,r.valueType,u);case i:return x(!0,n.format,n.valueType,u);default:return e.unitlessFormat}}function X(e,t,r){return J(e,q,t,r)}function Z(e,t,r){const[n]=t,[a]=r;if(n.format===a.format&&n.valueType===a.valueType&&n.valueType===y.FormatValueType.Time)return x(!0,n.format,n.valueType,n.decimals);if(n.valueType===y.FormatValueType.Date&&a.valueType===y.FormatValueType.Time||n.valueType===y.FormatValueType.Time&&a.valueType===y.FormatValueType.Date){const t=Q(e,N.KnownFormat.MDYHMS),{valueType:r,decimals:n}=t;return x(!0,t,r,n)}return J(e,H,t,r)}const ee=e=>e.unitlessFormat;function te(e,[t],[r]){return t.format===r.format?x(!0,t.format,t.valueType,t.decimals):e.unitlessFormat}function re(e){return B[e]===B[y.FormatValueType.General]}class ne{literalNode(e){switch(e.kind){case R.OperKind.String:case R.OperKind.Boolean:case R.OperKind.Error:case R.OperKind.Missing:return _.Pledge.resolve(this.context.defaultFormat);case R.OperKind.Number:const t=21,r=this.context.mathpack.formatGeneral(this.context.localeInfo,this.context.mathpack.abs(e),t),a=r.indexOf(this.context.localeInfo.decimalSeparator),i=a>=0?r.length-a-1:0,o=Q(this.context,N.KnownFormat.General);return _.Pledge.resolve(x(!1,o,o.valueType,i));default:return(0,n.assertNever)("calc.numfmt.evalFormat: unexpected literal oper",e)}}arrayNode(e){return _.Pledge.resolve(this.context.defaultFormat)}appNode(e,t){if((0,g.isOperatorNode)(e))return _.Pledge.all(t.map((e=>this.lazyVisitFormulaNode(e).bind((t=>[t,e]))))).bind((t=>function(e,t,r){switch(t){case E.OperatorId.Mul:case E.OperatorId.Div:return e.multOrDivTainted=!0,Y(e,r,X);case E.OperatorId.Pow:return Y(e,r,X);case E.OperatorId.Add:case E.OperatorId.Sub:return Y(e,r,Z);case E.OperatorId.Percent:{(0,i.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",1===r.length);const[t,n]=r[0];if(!(0,p.isNumberLiteralNode)(n))return e.defaultFormat;const{strong:a,decimals:o}=t,s=Q(e,N.KnownFormat.Pct);return x(a,s,s.valueType,o)}case E.OperatorId.Pound:case E.OperatorId.At:return e.defaultFormat;case E.OperatorId.Neg:case E.OperatorId.Pos:{(0,i.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",1===r.length);const[e]=r[0];return e}case E.OperatorId.Lt:case E.OperatorId.Le:case E.OperatorId.Eq:case E.OperatorId.Ge:case E.OperatorId.Gt:case E.OperatorId.Ne:return Y(e,r,ee);case E.OperatorId.Isect:case E.OperatorId.Union:case E.OperatorId.Range:case E.OperatorId.Concat:return Y(e,r,te);case E.OperatorId.And:case E.OperatorId.Or:case E.OperatorId.Xor:case E.OperatorId.Min:case E.OperatorId.Max:throw new W((0,l.notImplemented)(["evalFormat for Yellow ops"]));default:return(0,n.assertNever)("calc.numfmt.evalFormat: unexpected operator id",t)}}(this.context,e.id,t)));if((0,m.isWSFNode)(e)){const r=e.id,n=j[r]??V.Ignore,a=(0,T.getWorksheetFuncType)(r),s=(0,h.getArguments)(t);if((0,i.assertTrue)("calc.numfmt.evalFormula: well-formed WSF args",(0,o.isValidArgsLength)(a,s.length)),n===V.Ignore)return _.Pledge.resolve(this.context.defaultFormat);if(n===V.Propagate)return 0===s.length?_.Pledge.resolve(this.context.defaultFormat):_.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((e=>{const t=e[0];let r=t.format,n=t.valueType,a=t.decimals;const i=!re(n);if(!t.strong&&i)return this.context.unitlessFormat;let o=i;for(let t=1;t<e.length;t+=1){const i=e[t],s=!re(i.valueType);if(!i.strong&&s)return this.context.unitlessFormat;o||(r=i.format,n=i.valueType,a=i.decimals,o=s)}return x(!0,r,n,a)}));const u=Q(this.context,n),{valueType:l,decimals:c}=u;return _.Pledge.resolve(x(!0,u,l,c))}return this.lazyVisitFormulaNode(e)}letNode(e,t,r,n){return _.Pledge.resolve(this.context.defaultFormat)}lambdaNode(e,t,r,n){return _.Pledge.resolve(this.context.defaultFormat)}parenNode(e){return this.lazyVisitFormulaNode(e)}nameNode(e,t){return _.Pledge.resolve(this.context.defaultFormat)}cellRefNode(e,t){const{resolution:r}=this.context.resolver.resolveCellRef(this.context.locals,(0,f.cellRefNode)(e,t));if(!(0,P.isSuccess)(r))throw(0,i.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",r.reason.kind!==b.ResolveReasonKind.NoOriginSheet),new W(r.reason);const n=r.value;if(void 0===n)throw K;return(0,s.isSheetGridRange)(n)?_.Pledge.resolve(ie(this.context,n)):_.Pledge.resolve(this.context.unitlessFormat)}fieldRefNode(e,t){return this.lazyVisitFormulaNode(e).bind((e=>this.context.defaultFormat))}structRefNode(e,t){const r=(0,F.structRefNode)(e,t),{resolution:n}=this.context.resolver.resolveStructRef(this.context.locals,r);if(!(0,P.isSuccess)(n)){if((0,i.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",n.reason.kind!==b.ResolveReasonKind.NoOriginSheet),n.reason.kind===b.ResolveReasonKind.EmptyIntersection)throw K;throw new W(n.reason)}const a=n.value;if(void 0===a)throw K;return _.Pledge.resolve(ie(this.context,a))}missingNode(e){return(0,a.assertFalse)("calc.numfmt.evalFormat: unexpected missing node")}badSequenceNode(e,t){return(0,a.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")}badCharsNode(e,t){return(0,a.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")}operatorNode(e,t){return _.Pledge.resolve((0,S.operatorNode)(e,t))}wsfNode(e,t,r){return _.Pledge.resolve((0,v.wsfNode)(e,t,r))}constructor(e){this.context=e,this.visitFormulaNode=e=>(0,L.visitFormulaNode)(this,e),this.lazyVisitFormulaNode=e=>_.Pledge.resolve(e).bind(this.visitFormulaNode)}}function ae(e,t){return(0,w.reducePledge)(new ne(e),t)}function ie(e,t){const r=(0,u.sheetGridRangeAnchor)(t),n=e.globals.getCellFormat(r);if(!(0,P.isSuccess)(n))throw new W(n.reason);const a=n.value,i=z(e,a);if(!(0,c.isDocumentLocEqual)(r.sheet.document,e.document)&&("number"!=typeof a||i.source!==y.NumberFormatSource.Builtin))return e.defaultFormat;const{valueType:o,decimals:s}=i;return x(!0,a,o,s)}t.evalFormatImpl=function(e,t,r){try{const n=G(e,t),a=ae(n,r);return(0,O.success)({...a,format:$(n,a.format),mulOrDivTainted:n.multOrDivTainted})}catch(e){return e instanceof W?(0,I.failure)(e.reason):e===K?D.successUndefined:(0,I.failure)((0,M.javaScriptError)(e))}},t.evalFormat=function(e,t,r){try{const n=G(e,t),a=ae(n,r);return(0,O.success)(function(e,{strong:t,format:r,valueType:n,decimals:a}){if(n!==y.FormatValueType.Number||!e.multOrDivTainted){if(a>0&&t&&(n===y.FormatValueType.Number||n===y.FormatValueType.Currency||n===y.FormatValueType.Accounting||n===y.FormatValueType.Percentage)){const t=z(e,r);a!==t.decimals&&(r=t.synthesizeDecimals(a))}if(n!==y.FormatValueType.General&&t)return $(e,r)}}(n,a))}catch(e){return e instanceof W?(0,I.failure)(e.reason):e===K?D.successUndefined:(0,I.failure)((0,M.javaScriptError)(e))}}},1822:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNumberFormatter=void 0;const n=r(6442),a=r(1472),i=r(8630),o=r(2122),s=r(3240),u=r(4529),l=r(3340);t.createNumberFormatter=function(e){return{createFormat:(t,r)=>(0,a.createFormat)(e,t,"boolean"!=typeof r?r:r?n.NumberFormatSource.Builtin:n.NumberFormatSource.CustomString),applyFormat:(t,r,n)=>(0,a.applyFormat)(e,t,r,n),changeFormatDecimals:a.changeFormatDecimals,renderValue:(t,r)=>(0,o.renderValue)(e.config.mathpack,t,r),renderHashesValue:(e,t)=>(0,o.renderHashesValue)(e,t),renderFormulaBar(t,r,n,a){return(0,u.renderFormulaBar)(this,e,t,r,n,a)},parseGeneral:(t,r,n,a)=>(0,l.parseGeneral)(e,t,r,n,a),parseDate:(t,r)=>(0,l.parseDate)(e,t,r),parseEdit:(t,r)=>(0,i.parseEdit)(e,t,r),evalFormat:(t,r)=>(0,s.evalFormat)(e,t,r)}}},4529:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderFormulaBar=void 0;const n=r(6442),a=r(6067),i=r(6067),o=r(6067),s=r(9992),u=r(6366),l=r(6366),c=r(4878),d=r(6067),g=r(6067),m=r(6366),h=r(6366),p=r(6366),f=r(6366);t.renderFormulaBar=function(e,t,r,S,v,F){try{const{localeInfo:f}=t.config;switch(S.kind){case g.OperKind.Number:return function(e,t,r,i,l){if(l.isDate||l.isTime){const a=function(e,t,r,a,i){const{mathpack:l,localeInfo:g}=t.config;if(l.cond(a)<0)return(0,m.success)(void 0);let p="";const f=0!==l.fix(a)||i.isDate;let S=a;if(f){const i=l.trunc(a),d=(0,c.getFormatString)(e,t,r,(0,s.buildMMDDYYFormat)(g,!0),n.NumberFormatSource.CustomString);if(!(0,h.isSuccess)(d))return d;const f=(0,c.applyFormatAndRenderToString)(e,d.value,i);if(!(0,h.isSuccess)(f))return f;if("string"!=typeof f.value)return(0,m.success)(void 0);p+=f.value;const v=l.sub(a,i);(0,u.assertTrue)("calc.numfmt.renderFormulaBar: sub error",!(0,o.isErrorOper)(v)),S=v}if(l.cond(S)>0||i.isTime){f&&(p+="  ");const n=t.getKnownFormat(r,g.clock24Hour?d.KnownFormat.HHMMSS:d.KnownFormat.HHMMSSAP);if(!(0,h.isSuccess)(n))return n;const a=(0,c.applyFormatAndRenderToString)(e,n.value,S);if(!(0,h.isSuccess)(a))return a;if("string"!=typeof a.value)return(0,m.success)(void 0);p+=a.value}return(0,m.success)(p)}(e,(0,c.initUtilGlobals)(t),r,i,l);if(!(0,h.isSuccess)(a))return a;if(void 0!==a.value)return a.value,a}const{mathpack:g,localeInfo:f}=t.config;if(l.isPercent){const e=g.mul(i,g.fromNumber(100));return(0,o.isErrorOper)(e)?(0,p.failure)((0,a.notImplemented)(["renderFormulaBar % overflow"])):(0,m.success)(g.formatGeneral(f,e,21)+"%")}return(0,m.success)(g.formatGeneral(f,i,21))}(e,t,r,S,v);case g.OperKind.String:return(0,m.success)(F?"'"+S.value:S.value);case g.OperKind.Boolean:return(0,m.success)(S.value?f.trueName:f.falseName);case g.OperKind.Error:const y=f.errorNames[S.type];return null==y?(0,p.failure)((0,i.internal)(`No locale data for error type ${S.type}`)):(0,m.success)(y);case g.OperKind.Array:return(0,p.failure)((0,a.notImplemented)(["Array renderFormulaBar"]));case g.OperKind.Rich:return(0,p.failure)((0,a.notImplemented)(["Rich renderFormulaBar"]));case g.OperKind.Blank:return(0,m.success)("");default:return(0,l.assertNever)("calc.numfmt.renderFormulaBar: never value",S)}}catch(e){return(0,p.failure)((0,f.javaScriptError)(e))}}},1472:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeFormatDecimals=t.applyFormat=t.createFormat=t.NumberFormatImpl=t.pictureCalendar=t.pictureNumberShape=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6366),l=r(6366),c=r(6366),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6442),v=r(6366),F=r(6366),y=r(6366),b=r(6366),C=r(6067),A=r(6067),E=r(6067),T=r(6067),R=r(6067),k=r(6366),N=r(6366),I=r(6366),O=r(6366),P=r(6067),M=r(6366),D=r(6366),w=r(6366),L=r(6366),_=r(6067),x=r(3387),K=r(6366),W=r(6067),U=r(6067),G=r(6067),B=r(6067),V=r(2122),j=r(6067),H=r(6366),q=r(6366),z=r(6366),Q=r(6366),$=r(6366),Y=r(1944),{codePointMinusSign:J,codePointPlusSign:X,codePointDigitZero:Z,codePointHash:ee,codePointFullStop:te,codePointDigitOne:re,codePointDigitTwo:ne,codePointLeftParen:ae,codePointRightParen:ie,codePointSmallT:oe,codePointBackslash:se}=K.codePoint;var ue;!function(e){e[e.WantPic=0]="WantPic",e[e.WantClose=1]="WantClose",e[e.Done=2]="Done"}(ue||(ue={}));const le={decimalSeparator:"NOTUSED"};function ce(e,t,r,n){const{mantissa:a,exponent:i}=e.formatFixed(t,0,0);return(0,u.assertTrue)("calc.numfmt.dtrInteger: mantissa len <= exponent",a.length<=i),(0,u.assertTrue)("calc.numfmt.dtrInteger: mantissa || !exponent",0!==a.length||0===i),(0,x.convertDigitsShape)(i<r?(0,I.repeat)("0",r-i):"",n)+(0,x.convertNumberShape)(le,a+(0,I.repeat)("0",i-a.length),n)}function de(e,t,r,n,a){const{mantissa:i,exponent:o}=e.formatFixed(t,0,0);(0,u.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa len <= exponent",i.length<=o),(0,u.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa || !exponent",0!==i.length||0===o);const s=((o<r?(0,I.repeat)("0",r-o):"")+i+(0,I.repeat)("0",o-i.length)).substring(0,n);return(0,x.convertDigitsShape)(s,a)}function ge(e,t){const{mantissa:r,exponent:n}=e.formatFixed(t,0,0);return(0,u.assertTrue)("calc.numfmt.formatInt: mantissa len <= exponent",r.length<=n),(0,u.assertTrue)("calc.numfmt.formatInt: mantissa || !exponent",0!==r.length||0===n),""===r?"0":r.length<n?r+(0,I.repeat)("0",n-r.length):r}function me(e){const t=[];for(let r=0;r<e.length;r+=1){const n=e[r];switch(n.kind){case S.FormattedUnitKind.Blank:case S.FormattedUnitKind.String:{let a=n.str;for(;r+1<e.length;){const t=e[r+1];if(t.kind!==n.kind)break;a+=t.str,r+=1}t.push({kind:n.kind,str:a});break}case S.FormattedUnitKind.Flexible:case S.FormattedUnitKind.General:t.push(n)}}return t}const he=e=>e.kind===S.FormattedUnitKind.Flexible,pe={1:U.NumberShape.ChineseTrad1,2:U.NumberShape.ChineseTrad2,3:U.NumberShape.ChineseTrad3},fe={1:U.NumberShape.ChineseSimp1,2:U.NumberShape.ChineseSimp2,3:U.NumberShape.ChineseSimp3},Se={1:U.NumberShape.Japanese1,2:U.NumberShape.Japanese2,3:U.NumberShape.Japanese3},ve={1:U.NumberShape.Korean1,2:U.NumberShape.Korean2,3:U.NumberShape.Korean3,4:U.NumberShape.Korean4};function Fe(e){return e+1}var ye;!function(e){e[e.Ne=0]="Ne",e[e.Le=1]="Le",e[e.Ge=2]="Ge",e[e.Eq=3]="Eq",e[e.Lt=4]="Lt",e[e.Gt=5]="Gt"}(ye||(ye={}));const be=(0,N.partialArray)({[ye.Ne]:"<>",[ye.Le]:"<=",[ye.Ge]:">=",[ye.Eq]:"=",[ye.Lt]:"<",[ye.Gt]:">"}),Ce={[ye.Ne]:A.OperatorId.Ne,[ye.Le]:A.OperatorId.Le,[ye.Ge]:A.OperatorId.Ge,[ye.Eq]:A.OperatorId.Eq,[ye.Lt]:A.OperatorId.Lt,[ye.Gt]:A.OperatorId.Gt},Ae={[A.OperatorId.Ne]:ye.Ne,[A.OperatorId.Le]:ye.Le,[A.OperatorId.Ge]:ye.Ge,[A.OperatorId.Eq]:ye.Eq,[A.OperatorId.Lt]:ye.Lt,[A.OperatorId.Gt]:ye.Gt};var Ee;function Te(e,t,r,n){for(let a=0;a<t.length;a+=1){const i=t[a];if(null==i)continue;if(n+i.length>r.length)continue;const o=r.substring(n,n+i.length);if(0===e.stringCompareCI(i,o))return Number(a)}}function Re(e,t,r,n){for(let e=0;e<t.length;e+=1){const a=t[e];if(null!=a&&(0,k.stringStartsWith)(r,a,n))return Number(e)}return Te(e,t,r,n)}function ke(e,t){return e[t]??""}function Ne(e,t,r,n){const a=r.substring(n,n+(0,F.numCodeUnits)((0,v.stringCodePointAt)(r,n)));for(let r=0;r<t.length;r+=1){const n=t[r];if(null==n)continue;if(0===n.length)continue;const i=n.substring(0,(0,F.numCodeUnits)((0,v.stringCodePointAt)(n,0)));if(0===e.stringCompareCI(a,i))return!0}return!1}function Ie(e,t){let r=t.indexOf(ke(e.pictureSingle,i.PictureSingle.APDelim));return r<0&&(r=t.length>>1),[t.substring(0,r),t.substring(r+1)]}!function(e){e[e.AMPM=100]="AMPM",e[e.AMPMFE=101]="AMPMFE",e[e.General=102]="General",e[e.Currency=103]="Currency",e[e.Color=200]="Color",e[e.Dbnum=201]="Dbnum",e[e.Cond=202]="Cond",e[e.CurrCode=203]="CurrCode",e[e.Char=300]="Char",e[e.StrLit=301]="StrLit",e[e.Numeral=302]="Numeral",e[e.PrefixDigTh=303]="PrefixDigTh",e[e.LatinDate=304]="LatinDate",e[e.BidiDate=305]="BidiDate",e[e.Exp=306]="Exp"}(Ee||(Ee={}));const Oe=/^[0-9A-F]{1,8}$/i,Pe=/^(?:([a-z]{2,}(?:-[A-Z0-9](?:[A-Z0-9]+|(?=,)|$)(?:_[A-Z0-9]+)?)*)(?:-x-([a-z]+))?|x-([a-z0-9]+))?(?:,([0-9A-F]{1,4}))?$/i;t.pictureNumberShape=(0,N.partialArray)({1:U.NumberShape.ASCII,2:U.NumberShape.ArabicIndic,3:U.NumberShape.ExtendedArabicIndic,4:U.NumberShape.Devanagari,5:U.NumberShape.Bengali,6:U.NumberShape.Gurmukhi,7:U.NumberShape.Gujarati,8:U.NumberShape.Oriya,9:U.NumberShape.Tamil,10:U.NumberShape.Telugu,11:U.NumberShape.Kannada,12:U.NumberShape.Malayalam,13:U.NumberShape.Thai,14:U.NumberShape.Lao,15:U.NumberShape.Tibetan,16:U.NumberShape.Myanmar,17:U.NumberShape.Ethiopic,18:U.NumberShape.Khmer,19:U.NumberShape.Mongolian,27:U.NumberShape.Japanese1,28:U.NumberShape.Japanese2,29:U.NumberShape.Japanese3,30:U.NumberShape.ChineseSimp1,31:U.NumberShape.ChineseSimp2,32:U.NumberShape.ChineseSimp3,33:U.NumberShape.ChineseTrad1,34:U.NumberShape.ChineseTrad2,35:U.NumberShape.ChineseTrad3,36:U.NumberShape.Korean1,37:U.NumberShape.Korean2,38:U.NumberShape.Korean3,39:U.NumberShape.Korean4}),t.pictureCalendar=(0,N.partialArray)({1:W.Calendar.Gregorian,2:W.Calendar.GregorianUS,3:W.Calendar.Japan,4:W.Calendar.Taiwan,5:W.Calendar.Korea,6:W.Calendar.Hijri,7:W.Calendar.Thai,8:W.Calendar.Hebrew,9:W.Calendar.GregorianMEFrench,10:W.Calendar.GregorianArabic,11:W.Calendar.GregorianXlitEnglish,12:W.Calendar.GregorianXlitFrench,22:W.Calendar.Persian,23:W.Calendar.UmAlQura});const Me=Object.keys(S.CultureTag).reduce(((e,t)=>{const r=S.CultureTag[t];return e[String(r)]=r,e}),Object.create(null));function De(e){return e.toString(16).toUpperCase()}function we(e){return Number("0x"+e)}const Le={culture:"en-US",tag:void 0},_e={culture:"fr-FR",tag:void 0},xe={culture:"ar-IQ",tag:void 0},Ke={culture:"ar-SA",tag:void 0},We={culture:"ar-DZ",tag:void 0},Ue={culture:"th-TH",tag:void 0},Ge={[i.PictureSingle.Hour]:G.TimeDivision.Hour,[i.PictureSingle.HourTh]:G.TimeDivision.Hour,[i.PictureSingle.Minute]:G.TimeDivision.Minute,[i.PictureSingle.MinuteTh]:G.TimeDivision.Minute,[i.PictureSingle.Second]:G.TimeDivision.Second,[i.PictureSingle.SecondTh]:G.TimeDivision.Second};function Be(e){return e.kind===Ve.Char?e.formattedStr:void 0}var Ve;!function(e){e[e.Char=400]="Char",e[e.Fraction=401]="Fraction",e[e.Exp=402]="Exp",e[e.Num=403]="Num",e[e.FracSeconds=404]="FracSeconds",e[e.DateSep=405]="DateSep",e[e.TimeSep=406]="TimeSep",e[e.SysFormat=407]="SysFormat"}(Ve||(Ve={}));const je={kind:Ee.General};function He(e){return 1===e.length&&e[0].kind===Ee.General}var qe,ze,Qe;!function(e){e[e.Num=0]="Num",e[e.Date=1]="Date",e[e.Fraction=2]="Fraction",e[e.Percent=3]="Percent",e[e.Exp=4]="Exp",e[e.Text=5]="Text",e[e.General=6]="General",e[e.Other=7]="Other"}(qe||(qe={})),function(e){e[e.Pos=0]="Pos",e[e.Neg=1]="Neg",e[e.Zero=2]="Zero",e[e.Text=3]="Text"}(ze||(ze={})),function(e){e[e.Unknown=0]="Unknown",e[e.Either=1]="Either",e[e.Number=2]="Number",e[e.Text=3]="Text"}(Qe||(Qe={}));const $e={code:[je],color:void 0,dbnum:void 0,dtrRounding:B.Rounding.RoundSec};function Ye(e){return void 0===e.color&&void 0===e.dbnum&&He(e.code)}const Je={},Xe=(0,g.createFailureErrorClass)("ApplyHashesError"),Ze=(0,g.createFailureErrorClass)("ApplyError"),et=(0,g.createFailureErrorClass)("InitError");class tt{get isPercent(){return this.hasPercent}get isDate(){return this.hasDate}get isTime(){return this.hasTime}get isTextOnly(){return!this.posBeforeText}get isInputDependent(){return this.isInputDependentFormat()}get culture(){return this.thisCurrCode}get currencySymbol(){return this.thisCurrencySymbol}apply(e,t,r,n){try{return(0,H.success)(this.applyImpl(e,t,r,n))}catch(e){return e instanceof Ze?(0,q.failure)(e.reason):(0,q.failure)((0,z.javaScriptError)((0,O.prependErrorMessage)(e,`(while applying format ${this.logFormatString})`)))}}isInputDependentFormat(){for(const e of this.parts)for(const t of e.code)switch(t.kind){case Ee.General:case Ee.AMPM:case Ee.AMPMFE:case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Text:case i.PictureSingle.Year:case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.Month:case i.PictureSingle.MonthTh:case i.PictureSingle.Day:case i.PictureSingle.DayTh:case i.PictureSingle.LocDay:case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Minute:case i.PictureSingle.MinuteTh:case i.PictureSingle.Second:case i.PictureSingle.SecondTh:case i.PictureSingle.Era:case i.PictureSingle.EraYear:case Ve.Fraction:case Ve.Exp:case Ve.Num:case Ve.SysFormat:case Ve.FracSeconds:case i.PictureSingle.Question:return!0;case Ve.DateSep:case Ve.TimeSep:case Ve.Char:case Ee.LatinDate:case i.PictureSingle.Decimal:case i.PictureSingle.Percent:case Ee.BidiDate:case Ee.Currency:case Ee.CurrCode:case Ee.StrLit:case Ee.Numeral:case Ee.PrefixDigTh:case Ee.Exp:case i.PictureSingle.Slash:case i.PictureSingle.Star:case i.PictureSingle.Underscore:}return!1}applyImpl(e,t,r,n){const{mathpack:a,localeInfo:o}=this.config;if(this.valueType===S.FormatValueType.General){const i=void 0;if((0,f.isStringOper)(e))return(0,S.formattedValue)([(0,S.formattedUnitString)(e.value)],i,t,r);if(!n&&0===a.cond(e))return(0,S.formattedValue)([],i,t,r);const s=(0,S.formattedUnitGeneral)(a.toNumber(e),o.decimalSeparator,!0,U.NumberShape.ASCII,U.NumberShape.ASCII,!0);return(0,S.formattedValue)([s],i,t,r)}let s=!1;for(;;){let o;try{let u,d=!1;const g=[];if((0,f.isStringOper)(e))u=ze.Text;else{const t=a.cond(e);void 0!==this.condPos||void 0!==this.condNeg?({partKind:u,forceNeg:d}=this.getPart(e)):u=t<0?ze.Neg:t>0?ze.Pos:ze.Zero,t<0&&(this.onlyOneNumberPart||d)&&g.push((0,S.formattedUnitString)("-"))}o=this.parts[u];const{color:m,dbnum:h,code:p,dtrRounding:v}=o;if(!n&&u===ze.Zero&&o===this.parts[ze.Pos]&&!s)return(0,S.formattedValue)([],m,t,r);const F=this.getNumShape(h);this.applyPart({dtrRounding:v,dbnum:h,forceNeg:d,units:g,numShape:F,bidiDate:void 0},p,e,void 0);const y=r|(u!==ze.Text||Ye(o)||(c=void 0,void 0===(l=o).color&&void 0===l.dbnum&&1===(c=l.code).length&&c[0].kind===i.PictureSingle.Text)?S.Clip.None:S.Clip.MaxChars),b=g.some(he)?S.Alignment.Left:t;return(0,S.formattedValue)(me(g),m,b,y)}catch(t){if(t===Je){(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyImpl restart",!(0,f.isStringOper)(e)&&0!==a.cond(e)),e=a.zero,s=!0;continue}if(t instanceof Xe)return(0,S.hashesValue)(t.reason,o?.color);throw t}}var l,c}applyPart(e,t,r,o){const{mathpack:s,datepack:c,localeInfo:g}=this.config,h=this.applyCurrCode?.calendar??W.Calendar.Gregorian;let y;const b=()=>{if(void 0!==y)return y;(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart getDtr value",!(0,f.isStringOper)(r));const{date1904:t,dateCompatibility:n}=this.config;if(!n&&s.cond(r)<0)throw new Xe(S.dateOverflow);if(n&&s.cond(r)<0){if(t)throw new Ze((0,d.notImplemented)(["negative date 1904"]));throw new Xe(S.dateOverflow)}const a=c.fromNum(this.config,s.abs(r),e.dtrRounding);if(!1===a)throw new Xe(S.dateOverflow);switch(h){case W.Calendar.Gregorian:case W.Calendar.GregorianUS:case W.Calendar.GregorianMEFrench:case W.Calendar.GregorianArabic:case W.Calendar.GregorianXlitEnglish:case W.Calendar.GregorianXlitFrench:break;case W.Calendar.Thai:a.yr+=543;break;default:throw new Ze((0,d.notImplemented)(["calendar: "+h]))}return(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: components within range",a.yr>=0&&a.mon>=1&&a.mon<=12&&a.dom>=0&&a.dom<=31&&a.hour>=0&&a.hour<=23&&a.min>=0&&a.min<=59&&a.sec>=0&&a.sec<=59&&a.fracSec>=0&&a.wdy>=1&&a.wdy<=7),y=a},C=()=>{if(void 0!==y)throw new Ze((0,d.notImplemented)(["use of value after date component"]));return r};let A=!1,E=e.numShape;const T=e.units;for(let y=0;y<t.length;y+=1){const R=t[y];switch(R.kind){case Ee.General:{A=!0;const t=C();if((0,f.isStringOper)(t))T.push((0,S.formattedUnitString)(t.value));else{const r=s.abs(t);if(s.cond(t)<0&&"0"===s.formatGeneral(g,r,1))throw new Ze((0,d.notImplemented)(["potential LRestart in interval (-0.5,0)"]));const n=(0,S.formattedUnitGeneral)(s.toNumber(r),g.decimalSeparator,!1,E,this.getNumShape(void 0),this.valueType===S.FormatValueType.General);if(void 0!==e.dbnum){const e=(0,V.renderGeneral)(s,n,255);(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart General renderRes",!1!==e),T.push((0,S.formattedUnitString)(e));break}T.push(n)}break}case i.PictureSingle.Text:{const e=C();(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Text value",(0,f.isStringOper)(e)),T.push((0,S.formattedUnitString)(e.value));break}case Ee.Exp:case i.PictureSingle.Slash:case Ve.Char:T.push((0,S.formattedUnitString)(R.formattedStr));break;case i.PictureSingle.Star:T.push((0,S.formattedUnitFlexible)(R.escaped));break;case i.PictureSingle.Underscore:T.push((0,S.formattedUnitBlank)(R.escaped));break;case Ee.StrLit:T.push((0,S.formattedUnitString)(R.escaped));break;case i.PictureSingle.Percent:case Ee.Numeral:T.push((0,S.formattedUnitString)(R.formattedStr));break;case Ee.Currency:T.push((0,S.formattedUnitString)(g.currencySymbol));break;case Ee.CurrCode:{const{currencySymbol:e,currCode:t}=R;(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart system tag",!(0,S.isSystemCultureTag)(t?.tag)),void 0!==e&&T.push((0,S.formattedUnitString)(e));break}case Ve.DateSep:T.push((0,S.formattedUnitString)(g.dateSeparator));break;case Ve.TimeSep:R.printAsTimeSep?T.push((0,S.formattedUnitString)(g.timeSeparator)):T.push((0,S.formattedUnitString)(R.formattedStr));break;case Ve.Num:{const t=C();(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num value",!(0,f.isStringOper)(t)),(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num numState",void 0===o);const{numDigLeft:r,numDigDec:n,numPercent:a,numThousands:i}=R,l=2*a-3*i,{mantissa:c,exponent:d}=s.formatFixed(t,l,n);if((0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa || !exponent",0!==c.length||0===d),(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa len",c.length<=d+n),s.cond(t)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===c.length)throw Je;this.applyPart(e,R.codeBefore,s.zero,void 0),this.applyPart(e,R.code,s.zero,{comma:R.comma,fractionDenom:!1,decimal:!1,digits:c,digitsExp:d,numDigLeft:r});break}case Ve.Exp:{const t=C();(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp value",!(0,f.isStringOper)(t)),(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp numState",void 0===o);const{numMantDigLeft:r,numMantDigDec:n}=R,a=0===r&&0===n,{mantissa:i,exponent:l}=s.formatScientific(t,r,n);(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa || !exponent",0!==i.length||0===l||a);const c=(0,P.formatScientificLeft)(l,r);(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa len",i.length<=c+n),this.applyPart(e,R.codeMant,s.zero,{comma:R.commaMant,fractionDenom:!1,decimal:!1,digits:i,digitsExp:c,numDigLeft:R.numMantDigLeft}),this.applyPart(e,R.codeBetween,s.zero,void 0);const d=""!==i||a?l-c:0;d<0?T.push((0,S.formattedUnitString)("-")):R.isNeg||T.push((0,S.formattedUnitString)("+"));const g=ge(s,s.fromNumber(d));this.applyPart(e,R.codeExp,s.zero,{comma:R.commaMant,fractionDenom:!1,decimal:!1,digits:g,digitsExp:g.length,numDigLeft:R.numExpDigLeft});break}case Ve.Fraction:{const t=C();(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction value",!(0,f.isStringOper)(t)),(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction numState",void 0===o);const{numPercent:r,numThousands:n,numIntDigLeft:a,numNumerDig:l,numDenomDig:c,commaInt:g,denomValue:h}=R,v=2*r-3*n,F=s.tenTo(v),y=(0,m.isErrorOper)(F)?F:s.mul(s.abs(t),F);if((0,m.isErrorOper)(y))throw new Ze((0,d.notImplemented)(["overflow on fraction exp adjust"]));const b=e=>{for(let t=e;t<T.length;t+=1){const e=T[t];e.kind===S.FormattedUnitKind.String&&(T[t]=(0,S.formattedUnitBlank)(e.str))}};let A,E,k,N=R.anyZeroNumer;if(void 0!==R.codeInt){let t=s.trunc(y);const r=s.sub(y,t);if((0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart fracPart sub",(0,p.isNumberOper)(r)),({numer:A,denom:E}=this.formFraction(r,h,c)),(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart numer <= denom",s.cond2(A,E)<=0),0===s.cond2(A,E)){A=s.zero;const e=s.add(t,s.one);(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart bumped error",(0,p.isNumberOper)(e)),t=e}0!==s.cond(A)&&(N=!0);const n=ge(s,t),o={comma:g,fractionDenom:!1,decimal:!1,digits:n,digitsExp:n.length,numDigLeft:a},l=T.length;this.applyPart(e,R.codeInt,s.zero,o),k=T.length,(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction lastDigInt",void 0!==R.lastDigInt),0===s.cond(t)&&N&&R.lastDigInt!==i.PictureSingle.Zero?(R.lastDigInt!==i.PictureSingle.Question&&(T.length=l),this.applyPart(e,R.codeBetween1,s.zero,void 0),b(l),R.firstDigNumer!==i.PictureSingle.Question&&(T.length=l)):this.applyPart(e,R.codeBetween1,s.zero,void 0)}else{if(({numer:A,denom:E}=this.formFraction(y,h,c)),s.cond(t)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===s.cond(A))throw Je;N=!0,k=T.length}const I=ge(s,A),O={comma:!1,fractionDenom:!1,decimal:!1,digits:I,digitsExp:I.length,numDigLeft:l};this.applyPart(e,R.codeNumer,s.zero,O),this.applyPart(e,R.codeBetween2,s.zero,void 0);const P=ge(s,E),M={comma:!1,fractionDenom:!0,decimal:O.decimal,digits:P,digitsExp:P.length,numDigLeft:c};this.applyPart(e,R.codeDenom,s.zero,M),N||(R.anyQuestionNumer||R.firstDigDenom===i.PictureSingle.Question?b(k):T.length=k);break}case i.PictureSingle.Decimal:(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Decimal numState",void 0!==o),o.digitsExp>0&&(o.numDigLeft=o.digitsExp,this.dumpDigLeft(e,o,o.digitsExp)),o.decimal=!0,T.push((0,S.formattedUnitString)(g.decimalSeparator));break;case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:{(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/Z/Q numState",void 0!==o);let r=R.count;if(o.decimal||o.fractionDenom&&R.kind===i.PictureSingle.Question){if(o.fractionDenom&&y!==t.length-1)throw new Ze((0,d.notImplemented)(["left-align bug in denominator"]));if(o.digitsExp<0){const e=(0,M.fastMin)(r,-o.digitsExp),t=(0,x.convertDigitsShape)((0,I.repeat)("0",e),E);T.push((0,S.formattedUnitString)(t)),o.digitsExp+=e,r-=e}{const e=(0,M.fastMin)(r,o.digits.length),t=(0,x.convertDigitsShape)(o.digits.substring(0,e),E);T.push((0,S.formattedUnitString)(t)),o.digits=o.digits.substring(e),r-=e}if(R.kind!==i.PictureSingle.Hash&&r>0){const e=(0,x.convertDigitsShape)((0,I.repeat)("0",r),E);T.push(R.kind===i.PictureSingle.Question?(0,S.formattedUnitBlank)(e):(0,S.formattedUnitString)(e))}break}if(o.numDigLeft>o.digitsExp){const e=(0,M.fastMin)(r,o.numDigLeft-o.digitsExp);if(R.kind!==i.PictureSingle.Hash){let t=(0,x.convertDigitsShape)((0,I.repeat)("0",e),E);o.comma&&(t=(0,x.insertCommas)(g,t,o.numDigLeft-e)),T.push(R.kind===i.PictureSingle.Question?(0,S.formattedUnitBlank)(t):(0,S.formattedUnitString)(t))}r-=e,o.numDigLeft-=e}else r+=o.digitsExp-o.numDigLeft,o.numDigLeft=o.digitsExp;this.dumpDigLeft(e,o,r);break}case Ee.PrefixDigTh:g.isThai&&(E=e.numShape=U.NumberShape.Thai);break;case Ee.LatinDate:this.hasTokenCurrCode||(e.bidiDate=S.BidiDate.English);break;case Ee.BidiDate:throw new Ze((0,d.notImplemented)(["TokenKind.BidiDate"]));case i.PictureSingle.HourTh:case i.PictureSingle.MinuteTh:case i.PictureSingle.SecondTh:case i.PictureSingle.Hour:case i.PictureSingle.Minute:case i.PictureSingle.Second:{const t=R.kind===i.PictureSingle.HourTh||R.kind===i.PictureSingle.MinuteTh||R.kind===i.PictureSingle.SecondTh,r=t&&!this.hasTokenCurrCode?U.NumberShape.Thai:E;if(R.isAbs){const n=C();if((0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/M/S value",!(0,f.isStringOper)(n)),t&&this.hasTokenCurrCode)throw new Ze((0,d.notImplemented)(["fcAbsHourTh && fIntlNum bug"]));const a=c.toTime(this.config,s.abs(n),Ge[R.kind],e.dtrRounding);if(!1===a)throw new Ze((0,d.notImplemented)(["absolute time overflow"]));T.push((0,S.formattedUnitString)(ce(s,s.fromNumber(a),R.count,r)))}else{const e=b();let t;if(R.kind===i.PictureSingle.Minute||R.kind===i.PictureSingle.MinuteTh)t=e.min;else if(R.kind===i.PictureSingle.Second||R.kind===i.PictureSingle.SecondTh)t=e.sec;else if(t=e.hour,R.isAMPM){if(R.kind===i.PictureSingle.HourTh)throw new Ze((0,d.notImplemented)(["fc12HourTh/fc12Hour2Th forgotten"]));t>12&&(t-=12),0===t&&(t=12)}T.push((0,S.formattedUnitString)(ce(s,s.fromNumber(t),R.count,r)))}break}case Ee.AMPM:case Ee.AMPMFE:{let e;if(e=!!(0,f.isStringOper)(r)||b().hour<12,(!this.hasTokenCurrCode||R.kind===Ee.AMPMFE)&&(R.kind===Ee.AMPMFE||g.isEastAsia||R.pictureKind===a.PictureSpecial.AP2)){const t=Ie(g,R.tokenStr);T.push((0,S.formattedUnitString)(t[e?0:1]));break}const t=this.getBundledLocaleInfo("localised AM/PM string",W.Calendar.Gregorian,this.applyCurrCode);T.push((0,S.formattedUnitString)(t.ampmSymbols[e?0:1]));break}case Ve.FracSeconds:{const e=b();(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart FracSeconds rounding",e.rounding>=R.rounding);const t=de(s,s.fromNumber(e.fracSec),e.rounding,R.rounding,E);T.push((0,S.formattedUnitString)(g.decimalSeparator+t));break}case i.PictureSingle.Era:throw new Ze((0,d.notImplemented)(["PictureSingle.Era"]));case i.PictureSingle.EraYear:throw new Ze((0,d.notImplemented)(["PictureSingle.EraYear"]));case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.Year:{const e=R.kind!==i.PictureSingle.YearTh&&R.kind!==i.PictureSingle.ThYear||this.hasTokenCurrCode?E:U.NumberShape.Thai,t=(R.kind===i.PictureSingle.YearTh||R.kind===i.PictureSingle.EngYearTh)&&!this.hasTokenCurrCode,r=b().yr+(t?543:0),n=R.count>2?r:r%100;T.push((0,S.formattedUnitString)(ce(s,s.fromNumber(n),R.count,e)));break}case i.PictureSingle.Month:case i.PictureSingle.MonthTh:{const t=b().mon;switch(R.count){case 1:case 2:{const e=R.kind!==i.PictureSingle.MonthTh||this.hasTokenCurrCode?E:U.NumberShape.Thai;T.push((0,S.formattedUnitString)(ce(s,s.fromNumber(t),R.count,e)));break}case 3:case 4:case 5:{let r;if(r=e.bidiDate===S.BidiDate.English?(0,n.getEnglishLocaleInfo)():this.getBundledLocaleInfo("localised month string",h,R.kind!==i.PictureSingle.MonthTh||this.hasTokenCurrCode?this.applyCurrCode:Ue),3===R.count)T.push((0,S.formattedUnitString)(r.monthNameShort[t-1]));else if(4===R.count||e.bidiDate===S.BidiDate.English)T.push((0,S.formattedUnitString)(r.monthNameLong[t-1]));else{const e=r.monthNameLong[t-1];T.push((0,S.formattedUnitString)(e.substring(0,(0,F.numCodeUnits)((0,v.stringCodePointAt)(e,0)))))}break}}break}case i.PictureSingle.Day:case i.PictureSingle.DayTh:case i.PictureSingle.LocDay:{const t=R.kind===i.PictureSingle.DayTh;if(R.count<3){const e=t&&!this.hasTokenCurrCode?U.NumberShape.Thai:E,r=b().dom;T.push((0,S.formattedUnitString)(ce(s,s.fromNumber(r),R.count,e)))}else{const r=b().wdy;let a;if(a=e.bidiDate===S.BidiDate.English||!this.hasTokenCurrCode&&g.isEastAsia&&R.kind===i.PictureSingle.Day?(0,n.getEnglishLocaleInfo)():this.getBundledLocaleInfo("localised day string",h,t&&!this.hasTokenCurrCode?Ue:this.applyCurrCode),t&&this.hasTokenCurrCode&&3===R.count)throw new Ze((0,d.notImplemented)(["fcDay3Th && fIntlNum bug"]));const o=3===R.count?a.dayNameShort[r-1]:a.dayNameLong[r-1];T.push((0,S.formattedUnitString)(o))}break}case Ve.SysFormat:(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart SysFormat numState",void 0===o),this.applyPart(e,R.codeSysFormat,r,o);break;default:return(0,l.assertNever)("calc.numfmt.NumberFormatImpl: applyPart code",R)}}A&&C()}dumpDigLeft(e,t,r){const{localeInfo:n}=this.config,{units:a,numShape:i}=e;let o=r;{const e=(0,M.fastMin)(o,t.digits.length);let r=(0,x.convertDigitsShape)(t.digits.substring(0,e),i);t.comma&&(r=(0,x.insertCommas)(n,r,t.numDigLeft-e)),a.push((0,S.formattedUnitString)(r)),t.digits=t.digits.substring(e),o-=e,t.digitsExp-=e,t.numDigLeft-=e}if(o>0){let e=(0,x.convertDigitsShape)((0,I.repeat)("0",o),i);t.comma&&(e=(0,x.insertCommas)(n,e,t.numDigLeft-o)),a.push((0,S.formattedUnitString)(e)),t.digitsExp-=o,t.numDigLeft-=o}}getPart(e){const{mathpack:t}=this.config;for(let r=ze.Pos;r<ze.Zero;r+=1){const n=r;let a;if(r===ze.Pos){if(a=this.condPos,void 0===a&&t.cond(e)>0)return{partKind:n,forceNeg:!1}}else{if(this.parts[n]===this.parts[ze.Pos])throw new Xe(S.noFormatPart);if(0===this.parts[ze.Pos].code.length)throw new Ze((0,d.notImplemented)(['emulation of ";[COND]foo" bug']));if(a=this.condNeg,void 0===a){if(this.parts[ze.Zero]===this.parts[ze.Pos])return(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: getPart condPos",void 0!==this.condPos),{partKind:n,forceNeg:t.cond(this.condPos.operand)>0||this.condPos.operator===A.OperatorId.Eq};if(t.cond(e)<0)return{partKind:n,forceNeg:!1}}}if(void 0===a)continue;const{operator:i,operand:o}=a,s=t.sub(e,o);if((0,m.isErrorOper)(s))throw new Ze((0,d.notImplemented)(["overflow in condition check"]));if((0,_.applyComparison)(i,t.cond2(e,o)))switch(i){case A.OperatorId.Eq:return{partKind:n,forceNeg:!1};case A.OperatorId.Ne:case A.OperatorId.Gt:case A.OperatorId.Ge:return{partKind:n,forceNeg:!0};case A.OperatorId.Lt:return{partKind:n,forceNeg:t.cond(o)>0};case A.OperatorId.Le:return{partKind:n,forceNeg:t.cond(o)>=0}}}const r=ze.Zero;if(this.parts[r]===this.parts[ze.Pos])throw new Xe(S.noFormatPart);return{partKind:r,forceNeg:!0}}getNumShape(e){const t=this.applyCurrCode;let r=t?.numberShape;if(void 0!==r)return r;if(void 0===e)return U.NumberShape.ASCII;const n=this.getBundledLocaleInfo("localised DBNUM culture",W.Calendar.Gregorian,t);return n.isEastAsia&&(n.isKorea?r=ve[e]:n.isJapan?r=Se[e]:n.isChinaT?r=pe[e]:n.isChinaS&&(r=fe[e])),r??U.NumberShape.ASCII}formFraction(e,t,r){const{mathpack:n}=this.config;if(void 0!==t){const r=n.fromNumber(137438953472);if((0,m.isErrorOper)(n.sub(e,r)))throw new Ze((0,d.notImplemented)(["overflow in fraction threshold check"]));if(n.cond2(e,r)<0){const t=n.mul(e,n.fromNumber(1.0000000000000002));(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction nudged error",(0,p.isNumberOper)(t)),e=t}const a=t,i=n.toNumber(a)<<1,o=n.mul(e,n.fromNumber(i));if(!(0,p.isNumberOper)(o))throw new Ze((0,d.notImplemented)(["overflow in fraction denom mul"]));const s=n.lfix(o);if(s<0||s>=65535)throw new Xe(S.fractionOverflow);return{numer:n.fromNumber(s+1>>1),denom:a}}let a;switch(r){case 1:a=10;break;case 2:a=100;break;case 3:a=1e3;break;case 4:a=1e4;break;case 5:a=1e5;break;case 6:a=1e6;break;default:a=1e7}let i=n.fix(e);if(i>=2147483647)throw new Xe(S.fractionOverflow);let o=e,s=1,l=1,c=0,g=0;for(;;){const e=s*i;g+=e;const t=c*i;if(l+=t,e>2147483647||t>2147483647||l>=a){1===c&&2===i&&0===n.cond2(o,n.trunc(o))&&(s+=1);break}[s,g]=[g,s],[c,l]=[l,c];const r=n.sub(o,n.trunc(o));if((0,u.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction frac sub",(0,p.isNumberOper)(r)),0===n.cond(r))break;const h=n.div(n.one,r);if((0,m.isErrorOper)(h))throw new Ze((0,d.notImplemented)(["overflow in fraction inversion"]));if(o=h,(i=n.fix(o))>2147483647)break}return 0===c&&(c=s=1),{numer:n.fromNumber(s),denom:n.fromNumber(c)}}synthesizeDecimals(e){const t=(0,D.fastMax)(0,(0,M.fastMin)(e,127)),r=[];for(let e=ze.Pos;e<=ze.Text;e+=1){const n=this.parts[e];if((e===ze.Neg||e===ze.Zero)&&n===this.parts[ze.Pos]){r.push(r[ze.Pos]);continue}if(e===ze.Text){r.push(n===this.parts[ze.Pos]?r[ze.Pos]:n);continue}const{code:a,color:i,dbnum:o,dtrRounding:s}=n,u={code:a.map((r=>{if(r.kind===Ve.Num){const{numDigLeft:n,numPercent:a,numThousands:i,comma:o,codeBefore:s}=r;return{kind:Ve.Num,numDigLeft:n,numDigDec:t,numPercent:a,numThousands:i,comma:o,code:this.adjustDecimals(e,r.numDigDec,r.code,t),codeBefore:s}}if(r.kind===Ve.Exp){const{isNeg:n,numMantDigLeft:a,numExpDigLeft:i,commaMant:o,codeBetween:s,codeExp:u}=r;return{kind:Ve.Exp,isNeg:n,numMantDigLeft:a,numMantDigDec:t,numExpDigLeft:i,commaMant:o,codeMant:this.adjustDecimals(e,r.numMantDigDec,r.codeMant,t),codeBetween:s,codeExp:u}}return r})),color:i,dbnum:o,dtrRounding:s};r.push(u)}try{const e=new tt(this.config,{old:this,logFormatString:`synthesizeDecimals(dec=${t} on ${this.logFormatString})`,synth:r});if(e.formatString.length>255)throw new et(this.notFormatString("format string too long: max length"));return e}catch(e){if(e instanceof et)return this;throw e}}adjustDecimals(e,t,r,n){if(n===t)return r;let a,o,s,l=!1;for(let e=0;e<r.length;e+=1){const t=r[e];switch(t.kind){case i.PictureSingle.Decimal:void 0===s&&(s=e);break;case i.PictureSingle.Hash:case i.PictureSingle.Question:case i.PictureSingle.Zero:void 0!==s?o=e:(a=e,t.kind===i.PictureSingle.Question&&(l=!0))}}const c=e=>e===i.PictureSingle.Percent||e===Ee.Currency||e===Ee.CurrCode||e===i.PictureSingle.Star;if(0===n){if(void 0===s)return r;let e=0,t=0;void 0===a?void 0!==o&&(e=s+1,t=o+1):(e=s,t=(o??s)+1);const n=r.slice(0,e);for(let a=e;a<t;a+=1)c(r[a].kind)&&n.push(r[a]);return(0,L.safePush)(n,r.slice(t)),n}if(t>n){let e;(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: adjustDecimals dec",void 0!==s),function(e){e[e.AfterDigs=0]="AfterDigs",e[e.Dropping=1]="Dropping",e[e.Keeping=2]="Keeping"}(e||(e={}));let a=e.AfterDigs;const o=[];let l=t-n;for(let t=r.length-1;t>=0;t-=1){t<=s&&(a=e.Keeping);const n=r[t];if(a===e.AfterDigs&&(n.kind!==i.PictureSingle.Hash&&n.kind!==i.PictureSingle.Question&&n.kind!==i.PictureSingle.Zero||(a=e.Dropping)),a===e.Keeping||a===e.AfterDigs||c(n.kind))o.push(n);else if(n.kind===i.PictureSingle.Hash||n.kind===i.PictureSingle.Question||n.kind===i.PictureSingle.Zero){const t=(0,M.fastMin)(l,n.count);t<n.count&&o.push({kind:n.kind,count:n.count-t}),l-=t,0===l&&(a=e.Keeping)}}return o.reverse(),o}if(e===ze.Zero&&l&&void 0===o)return r;const d=n-t;if(void 0!==o){const e=r.slice(),t=e[o];return e[o]={kind:t.kind,count:t.count+d},e}const g=r.slice(),m=s??a??g.length-1,h=[];return void 0===s&&h.push({kind:i.PictureSingle.Decimal}),h.push({kind:i.PictureSingle.Zero,count:d}),g.splice(m+1,0,...h),g}parseString(e){if(this.source!==S.NumberFormatSource.CustomBytecode&&e.length>255)throw new et(this.notFormatString("format string too long: max length"));let t=!1,r=!1,n=0,a=!1;for(let s=ze.Pos;s<=ze.Text&&!a;s+=1){const l=this.tokenize(e.substring(n)),{cond:c,currencySymbol:g,hasTokenCurrCode:m}=l,h=this.convertTokToSun(l),{currCode:p,hasPercent:f,hasDate:v,hasTime:F}=h,y=this.classifySunPartKind(h,s===ze.Text?Qe.Text:Qe.Unknown),{part:b,applyCurrCode:C}=this.convertSunToCode(h);if(n+=l.consumed,a=l.eos,f&&(this.hasPercent=!0),v&&(this.hasDate=!0),F&&(this.hasTime=!0),m){if(!(s===ze.Pos||this.hasTokenCurrCode&&(i=this.thisCurrCode,o=p,i===o||void 0!==i&&void 0!==o&&(0,S.isFormatCultureEqual)(i,o))))throw new et((0,d.notImplemented)(["inconsistent CurrCode in number parts"]));this.hasTokenCurrCode||(this.hasTokenCurrCode=!0,this.thisCurrCode=p)}if(void 0!==C&&void 0===this.applyCurrCode&&(this.applyCurrCode=C),void 0!==g&&void 0===this.thisCurrencySymbol&&(this.thisCurrencySymbol=g),this.source===S.NumberFormatSource.System&&((0,u.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: system ipart",s===ze.Pos),!a||y===Qe.Text))throw new et(this.notFormatString("system format with more than one part"));if((y===Qe.Text||s===ze.Pos&&y===Qe.Either)&&(t=!0,this.parts[ze.Text]=b,y===Qe.Text)){if(void 0!==c)throw new et(this.notFormatString("condition in text part"));if(void 0!==p)throw new et((0,d.notImplemented)(["CurrCode in text part"]));break}if(r=!0,this.parts[s]=b,this.onlyOneNumberPart=s===ze.Pos,s===ze.Pos)this.parts[ze.Neg]=b,this.parts[ze.Zero]=b,this.condPos=c;else if(s===ze.Neg)this.condNeg=c;else if(void 0!==c)throw new et(this.notFormatString("condition in zero part"))}var i,o;if(!a)throw new et(this.notFormatString("too many parts"));r||(this.parts[ze.Pos]=$e,this.parts[ze.Neg]=$e,this.parts[ze.Zero]=$e,this.posBeforeText=!1),t||(this.parts[ze.Text]=$e),r&&!t&&this.onlyOneNumberPart&&void 0!==this.condPos&&!He(this.parts[ze.Pos].code)&&(this.parts[ze.Neg]=$e,this.onlyOneNumberPart=!1),(0,u.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: every part set",this.parts.every((e=>void 0!==e))),this.checkBytecode()}tokenize(e){const{localeInfo:t}=this.config,r={color:void 0,dbnum:void 0,dbnumForbidden:!1,cond:void 0,hasTokenCurrCode:!1,currCode:void 0,currencySymbol:void 0,tokens:[],consumed:0,eos:!0};let n,a,o;for(;r.consumed<e.length&&r.eos;){const t=this.readToken(r,e,r.consumed),s=n;switch(n=t,r.consumed+=t.tokenStr.length,t.kind){case i.PictureSingle.Sep:r.eos=!1;continue;case Ee.Color:if(void 0!==r.color)throw new et(this.notFormatString("more than one color"));if(0!==r.tokens.length)throw new et((0,d.notImplemented)(["colour in middle of format"]));r.color=t.color;continue;case Ee.Dbnum:if(void 0!==r.dbnum)throw new et(this.notFormatString("more than one DBNUM"));if(r.dbnumForbidden)throw new et(this.notFormatString("DBNUM after token which forbids it (% or E)"));if(0!==r.tokens.length)throw new et((0,d.notImplemented)(["DBNUM in middle of format"]));r.dbnum=t.dbnum;continue;case Ee.Cond:if(void 0!==r.cond)throw new et(this.notFormatString("more than one condition"));if(0!==r.tokens.length)throw new et((0,d.notImplemented)(["condition in middle of format"]));r.cond=t.cond;continue;case Ee.CurrCode:if(void 0!==a)throw new et(this.notFormatString("more than one currency code in section"));a=t;break;case Ee.Currency:o=t;break;case Ee.AMPM:case Ee.AMPMFE:case i.PictureSingle.Colon:case i.PictureSingle.DateSep:case Ee.LatinDate:case Ee.BidiDate:case i.PictureSingle.Year:case i.PictureSingle.Month:case i.PictureSingle.Day:case i.PictureSingle.Hour:case i.PictureSingle.Minute:case i.PictureSingle.Second:case i.PictureSingle.Reign:case i.PictureSingle.LocDay:case i.PictureSingle.Era:case i.PictureSingle.EraYear:case i.PictureSingle.EngYearTh:case i.PictureSingle.DayTh:case i.PictureSingle.MonthTh:case i.PictureSingle.YearTh:case i.PictureSingle.ThYear:case i.PictureSingle.HourTh:case i.PictureSingle.MinuteTh:case i.PictureSingle.SecondTh:if(s?.kind===t.kind){s.count+=t.count;continue}}r.tokens.push(t)}return void 0!==a?(r.hasTokenCurrCode=!0,r.currCode=a.currCode,r.currencySymbol=a.currencySymbol):void 0!==o&&void 0===r.currencySymbol&&(r.currencySymbol=S.FormatCurrency.LocaleInfo),4!==r.dbnum||t.isKorea||void 0===r.currCode&&!t.isThai||(r.dbnum=void 0),r}readToken(e,t,r){const{mathpack:n,localeInfo:s}=this.config,u=Te(s,s.pictureSpecial,t,r);if(void 0!==u){let e=u;const n=ke(s.pictureSpecial,e);s.isJapan&&e===a.PictureSpecial.GeneralOldMAC&&(e=a.PictureSpecial.General);const i=t.substring(r,r+n.length);switch(e){case a.PictureSpecial.AP1:case a.PictureSpecial.AP2:return{kind:Ee.AMPM,tokenStr:i,count:1,pictureKind:e};case a.PictureSpecial.AP3:return{kind:Ee.AMPMFE,tokenStr:i,count:1};case a.PictureSpecial.General:return{kind:Ee.General,tokenStr:i};case a.PictureSpecial.Currency:return{kind:Ee.Currency,tokenStr:i}}}const c=(0,v.stringCodePointAt)(t,r),g=(0,F.numCodeUnits)(c),m=t.substring(r,r+g),h=Re(s,s.pictureSingle,t,r);if(void 0!==h){let u=h;if((s.isJapan||s.isChinaT)&&(u===i.PictureSingle.E||u===i.PictureSingle.EraYear)){let e,n;u=!(r+g+1<t.length)||(e=t.charCodeAt(r+g))!==J&&e!==X||(n=t.charCodeAt(r+g+1))!==Z&&n!==ee&&n!==te?i.PictureSingle.EraYear:i.PictureSingle.E}if(u===i.PictureSingle.BidiDate||u===i.PictureSingle.EngYearTh){let e;if(r+g<t.length&&((e=t.charCodeAt(r+g))===re||e===ne))return{kind:e===re?Ee.LatinDate:Ee.BidiDate,tokenStr:t.substring(r,r+g+1),count:1};u=i.PictureSingle.EngYearTh}if(u===i.PictureSingle.BidiNum)throw new et(this.notFormatString("bidi num not allowed"));switch(u){case i.PictureSingle.Star:case i.PictureSingle.Underscore:{if(r+g>=t.length)throw new et(this.notFormatString("unterminated "+m));const e=(0,v.stringCodePointAt)(t,r+g),n=(0,F.numCodeUnits)(e),a=(0,y.stringFromCodePoint)(e);return{kind:u,tokenStr:t.substring(r,r+g+n),escaped:a}}case i.PictureSingle.Backslash:return this.readToken_Backslash(t,r,g);case i.PictureSingle.Quote:{const e=t.indexOf(m,r+g);if(e<0)throw new et(this.notFormatString("unterminated quoted string"));const n=t.substring(r+g,e),i=t.substring(r,e+g),o=Te(s,s.pictureSpecial,n,0);return void 0!==o&&o===a.PictureSpecial.Currency&&ke(s.pictureSpecial,o).length===n.length?{kind:Ee.Currency,tokenStr:i}:{kind:Ee.StrLit,tokenStr:i,escaped:n}}case i.PictureSingle.E:{if(s.isEastAsia){if(void 0!==e.dbnum)throw new et(this.notFormatString("invalid DBNUM with exp"));if(e.dbnumForbidden)throw new et((0,d.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));e.dbnumForbidden=!0}if(r+g>=t.length)throw new et(this.notFormatString("unterminated exp"));const n=t.charCodeAt(r+g);if(n!==X&&n!==J)throw new et(this.notFormatString("exp not followed by sign"));const a=t.substring(r,r+g+1);return{kind:Ee.Exp,tokenStr:a,eStr:m,isNeg:n===J}}case i.PictureSingle.Hash:case i.PictureSingle.Year:case i.PictureSingle.Month:case i.PictureSingle.Day:case i.PictureSingle.Hour:case i.PictureSingle.Minute:case i.PictureSingle.Second:case i.PictureSingle.YearTh:case i.PictureSingle.MonthTh:case i.PictureSingle.DayTh:case i.PictureSingle.HourTh:case i.PictureSingle.MinuteTh:case i.PictureSingle.SecondTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.Question:case i.PictureSingle.Comma:case i.PictureSingle.Reign:case i.PictureSingle.LocDay:case i.PictureSingle.Era:case i.PictureSingle.EraYear:{if(u===i.PictureSingle.Reign&&!s.isJapan&&!s.isChinaT)break;let e=g,n=1;for(;(0,k.stringStartsWith)(t,m,r+e)&&void 0===Te(s,s.pictureSpecial,t,r+e);)e+=g,n+=1;if(u===i.PictureSingle.LocDay&&n<3)break;return{kind:u,tokenStr:t.substring(r,r+e),count:n}}case i.PictureSingle.Sep:case i.PictureSingle.Text:case i.PictureSingle.Decimal:case i.PictureSingle.Slash:case i.PictureSingle.Minus:case i.PictureSingle.Plus:return{kind:u,tokenStr:m};case i.PictureSingle.Space:return{kind:Ee.Char,tokenStr:m,escaped:m};case i.PictureSingle.Colon:return{kind:u,tokenStr:m,count:1};case i.PictureSingle.Percent:if(s.isEastAsia){if(void 0!==e.dbnum)throw new et(this.notFormatString("invalid DBNUM with pct"));if(e.dbnumForbidden)throw new et((0,d.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));e.dbnumForbidden=!0}return{kind:i.PictureSingle.Percent,tokenStr:m};case i.PictureSingle.DateSep:return m===ke(s.pictureSingle,i.PictureSingle.Slash)?{kind:i.PictureSingle.Slash,tokenStr:m}:m===ke(s.pictureSingle,i.PictureSingle.Minus)?{kind:i.PictureSingle.Minus,tokenStr:m}:{kind:i.PictureSingle.DateSep,tokenStr:m,count:1};case i.PictureSingle.ColorStart:{const e=ke(s.pictureSingle,i.PictureSingle.ColorEnd),a=t.indexOf(e,r+g);if(a<0)throw new et(this.notFormatString("unterminated ["));const l=t.substring(r+g,a),c=t.substring(r,a+e.length),h=Te(s,be,l,0);if(void 0!==h){let e=ke(be,h).length;for(;e<l.length&&(0,R.isSpace)(l.charCodeAt(e));)e+=1;const t=(0,T.parseSignedLiteral)(s,n,l,e,!1);if(t[1]===e)throw new et((0,d.notImplemented)(["invalid number in condition"]));if(t[1]!==l.length)throw new et((0,d.notImplemented)(["trailing junk after condition"]));return{kind:Ee.Cond,tokenStr:c,cond:{operator:Ce[h],operand:t[0]}}}const f=Te(s,s.pictureColor,l,0);if(void 0!==f){const e=ke(s.pictureColor,f);if(f!==o.PictureColor.Color){if(e.length!==l.length)throw new et((0,d.notImplemented)(["trailing junk after named color"]));return{kind:Ee.Color,tokenStr:c,color:(p=f,o.PictureColor[p])}}if(f===o.PictureColor.Color){let t=e.length;for(;t<l.length&&(0,R.isSpace)(l.charCodeAt(t));)t+=1;const[r,n]=(0,E.parseUint)(s,4,l,t);if(n===t)throw new et(this.notFormatString("missing number for numbered color"));if(n!==l.length)throw new et((0,d.notImplemented)(["trailing junk after numbered color"]));if(r<1||r>56)throw new et(this.notFormatString("out-of-range numbered color"));return{kind:Ee.Color,tokenStr:c,color:r+8}}}const S=Te(s,s.pictureDbnum,l,0);if(void 0!==S){if(ke(s.pictureDbnum,S).length!==l.length)throw new et((0,d.notImplemented)(["trailing junk after DBNUM"]));return{kind:Ee.Dbnum,tokenStr:c,dbnum:Fe(S)}}return(0,k.stringStartsWith)(l,"$")?{kind:Ee.CurrCode,tokenStr:c,...this.parseCurrCode(l.substring(1))}:{kind:u,tokenStr:m}}case i.PictureSingle.ColorEnd:return{kind:u,tokenStr:m};case i.PictureSingle.OpenParen:case i.PictureSingle.CloseParen:return{kind:u,tokenStr:m,escaped:m};case i.PictureSingle.Extra:case i.PictureSingle.APDelim:case i.PictureSingle.Nen1:case i.PictureSingle.Gatsu1:case i.PictureSingle.Nichi1:case i.PictureSingle.Nen2:case i.PictureSingle.Gatsu2:case i.PictureSingle.Nichi2:case i.PictureSingle.Zero:case i.PictureSingle.ZeroTh:break;default:return(0,l.assertNever)("calc.numfmt.NumberFormatImpl: readToken single picKind",u)}}var p;if(s.isNumeral(c)){if(s.getNumberShape(c)!==U.NumberShape.ASCII)throw new et((0,d.notImplemented)(["non-ASCII digits"]));const e=s.getOrdinal(c);if(0===e){let e=g,n=1;for(;(0,k.stringStartsWith)(t,m,r+e);)e+=g,n+=1;const a=t.substring(r,r+e);return{kind:i.PictureSingle.Zero,tokenStr:a,count:n}}return{kind:Ee.Numeral,tokenStr:m,ordinal:e}}switch(c){case ae:return{kind:i.PictureSingle.OpenParen,tokenStr:m,escaped:m};case ie:return{kind:i.PictureSingle.CloseParen,tokenStr:m,escaped:m};case se:return this.readToken_Backslash(t,r,g);case oe:if(s.isThai)return{kind:Ee.PrefixDigTh,tokenStr:m}}return{kind:Ee.Char,tokenStr:m,escaped:m}}readToken_Backslash(e,t,r){if(t+r>=e.length)throw new et(this.notFormatString("unterminated backslash"));const n=(0,v.stringCodePointAt)(e,t+r),a=(0,F.numCodeUnits)(n),o=(0,y.stringFromCodePoint)(n),s=e.substring(t,t+r+a);return n===ae||n===ie?{kind:n===ae?i.PictureSingle.OpenParen:i.PictureSingle.CloseParen,tokenStr:s,escaped:o}:{kind:Ee.Char,tokenStr:s,escaped:o}}convertTokToSun({color:e,dbnum:t,cond:r,currCode:n,tokens:a}){const{localeInfo:o}=this.config,s={suns:[],dtrRounding:B.Rounding.RoundSec,color:e,dbnum:t,currCode:n,hasPercent:!1,hasDate:!1,hasTime:!1,get isEmpty(){return 0===this.suns.length&&void 0===r&&void 0===e&&void 0===t&&void 0===n}},c=0===o.stringCompareCI(ke(o.pictureSingle,i.PictureSingle.Month),ke(o.pictureSingle,i.PictureSingle.Minute));let g,m,h,p,f,S=!1,v=0,F=0,y=!1,b=!1,C=!1,A=!1,E=0;const T=(e,t)=>{const r=Ge[e];if(t){if(b)throw new et(this.notFormatString("more than one absolute time"));if(void 0!==g&&r>=g)throw new et(this.notFormatString("absolute time must be largest division"));b=!0}else if(b&&r<=g)throw new et((0,d.notImplemented)(["larger time division after absolute time"]));(void 0===g||r<g)&&(g=r)};function R(e,t,r){const n=g;if(T(e,t),e===i.PictureSingle.Hour||e===i.PictureSingle.HourTh)C=!0,p=r,f=void 0;else if(e===i.PictureSingle.Second||e===i.PictureSingle.SecondTh)if(void 0===f||b)void 0===n&&(C=!0);else{const e=f.code[0];(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCode",e.kind===i.PictureSingle.Month);const t=i.PictureSingle.Minute,r=e.count;(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCount",1===r||2===r);const n=!1;T(t,n),v-=1,F+=1,f.code=[{kind:t,count:r,isAbs:n}],f=void 0}else C=!1}function k(e){const t=ke(o.pictureSingle,e.kind);return{kind:Ve.TimeSep,printAsTimeSep:v>0||F>0,formattedStr:t}}function N(e){const t=ke(o.pictureSingle,e.kind);return t===ke(o.pictureSingle,i.PictureSingle.DateSep)?{kind:Ve.DateSep}:t===ke(o.pictureSingle,i.PictureSingle.Colon)?k(e):{kind:Ve.Char,formattedStr:t}}for(let e=0;e<a.length;e+=1){const t=a[e];switch(t.kind){case Ee.AMPM:case Ee.AMPMFE:case i.PictureSingle.Colon:case i.PictureSingle.DateSep:case i.PictureSingle.Year:case i.PictureSingle.Month:case i.PictureSingle.Day:case i.PictureSingle.Hour:case i.PictureSingle.Minute:case i.PictureSingle.Second:case i.PictureSingle.Reign:case i.PictureSingle.LocDay:case i.PictureSingle.Era:case i.PictureSingle.EraYear:case i.PictureSingle.EngYearTh:case Ee.LatinDate:case Ee.BidiDate:case i.PictureSingle.DayTh:case i.PictureSingle.MonthTh:case i.PictureSingle.YearTh:case i.PictureSingle.ThYear:case i.PictureSingle.HourTh:case i.PictureSingle.MinuteTh:case i.PictureSingle.SecondTh:{const r={kind:qe.Date,code:[]};switch(s.suns.push(r),y=!0,t.kind){case Ee.LatinDate:case Ee.BidiDate:if(0!==e&&(1!==e||a[0].kind!==Ee.CurrCode))throw new et(this.notFormatString("bidi date must be first"));r.code.push(t);break;case i.PictureSingle.DateSep:r.code.push({kind:Ve.DateSep});break;case i.PictureSingle.Colon:r.code.push(k(t));break;case i.PictureSingle.Reign:v+=1,o.isJapan&&t.count>=2&&r.code.push({kind:i.PictureSingle.Era,count:3}),r.code.push({kind:i.PictureSingle.EraYear,count:o.isChinaT?1:2});break;case i.PictureSingle.Era:v+=1,r.code.push({kind:i.PictureSingle.Era,count:(0,M.fastMin)(3,t.count)});break;case i.PictureSingle.EraYear:v+=1,r.code.push({kind:i.PictureSingle.EraYear,count:(0,M.fastMin)(2,t.count)});break;case i.PictureSingle.Year:case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:f=void 0,v+=1,r.code.push({kind:t.kind,count:t.count<=2?2:4});break;case i.PictureSingle.Month:if(c&&t.count<=2){if(C){const e=i.PictureSingle.Minute,n=!1;R(e,n,r),F+=1,r.code.push({kind:e,count:t.count,isAbs:n}),C=!1;break}f=r}else f=void 0;v+=1,r.code.push({kind:t.kind,count:(0,M.fastMin)(5,t.count)});break;case i.PictureSingle.MonthTh:v+=1,r.code.push({kind:t.kind,count:(0,M.fastMin)(4,t.count)});break;case i.PictureSingle.Day:case i.PictureSingle.DayTh:f=void 0,v+=1,r.code.push({kind:t.kind,count:(0,M.fastMin)(4,t.count)});break;case i.PictureSingle.LocDay:f=void 0,v+=1,r.code.push({kind:i.PictureSingle.LocDay,count:3===t.count?3:4});break;case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Minute:case i.PictureSingle.MinuteTh:case i.PictureSingle.Second:case i.PictureSingle.SecondTh:{const e=!1;R(t.kind,e,r),F+=1;const n=(0,M.fastMin)(2,t.count);t.kind===i.PictureSingle.Hour||t.kind===i.PictureSingle.HourTh?r.code.push({kind:t.kind,count:n,isAbs:e,isAMPM:!1}):r.code.push({kind:t.kind,count:n,isAbs:e});break}case Ee.AMPM:case Ee.AMPMFE:if(b)throw new et(this.notFormatString("AM/PM after absolute time"));if(t.count>1)throw new et((0,d.notImplemented)(["multiple AM/PM symbols"]));void 0!==p&&(p.code[0].isAMPM=!0,p=void 0),A=!0,r.code.push(t);break;default:return(0,l.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok as date",t)}break}case i.PictureSingle.Decimal:case Ee.Numeral:case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:case i.PictureSingle.Comma:{if(y){if(t.kind!==i.PictureSingle.Decimal&&t.kind!==i.PictureSingle.Comma)throw new et(this.notFormatString("number picture in date/time format"));const r={kind:qe.Date,code:[]};s.suns.push(r);const n=a[e+1];if(t.kind===i.PictureSingle.Decimal&&n?.kind===i.PictureSingle.Zero){const t=n.count;if(t>3)throw new et(this.notFormatString("invalid number of fractional seconds"));e+=1,R(i.PictureSingle.Second,!1,r),F+=1,r.code.push({kind:Ve.FracSeconds,rounding:t}),s.dtrRounding=(0,D.fastMax)(s.dtrRounding,t)}else r.code.push(N(t));break}if(t.kind===i.PictureSingle.Comma){const e=ke(o.pictureSingle,t.kind),r={kind:qe.Other,code:[{kind:Ve.Char,formattedStr:e}]};s.suns.push(r);break}const r=e=>e===Ee.Numeral||e===i.PictureSingle.Hash||e===i.PictureSingle.Zero||e===i.PictureSingle.Question,n={kind:qe.Num,code:[],numDigLeft:0,numDigDec:0,numPercent:0,numThousands:0,comma:!1,decimal:!1,numVal:!1,nonZero:!1,get digitTokens(){return this.anyHash||this.anyQuestion},get reallyNum(){return this.anyHash||this.anyQuestion||this.anyZero},lastDig:void 0,firstDig:void 0,anyHash:!1,anyQuestion:!1,anyZero:!1};let u;for(s.suns.push(n),void 0===m&&(m=n),h=n,e-=1;e+1<a.length;e+=1){const t=a[e+1];let s=!0;switch(t.kind){case i.PictureSingle.Decimal:S=n.decimal=!0,n.code.push(t),u=void 0;break;case Ee.Numeral:n.code.push({kind:t.kind,formattedStr:t.tokenStr,ordinal:t.ordinal}),n.numVal=n.nonZero=!0,u=void 0;break;case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:if(n.decimal?n.numDigDec+=t.count:n.numDigLeft+=t.count,void 0===n.firstDig&&(n.firstDig=t.kind),n.lastDig=t.kind,t.kind===i.PictureSingle.Hash?n.anyHash=!0:t.kind===i.PictureSingle.Question?n.anyQuestion=!0:(n.anyZero=!0,n.numVal=!0),void 0!==u&&u.kind===t.kind)u.count+=t.count;else{const e={kind:t.kind,count:t.count};n.code.push(e),u=e}break;case i.PictureSingle.Comma:const l=a[e+2]?.kind;if(r(l))S||(n.comma=!0);else{let e=t.count;const r=ke(o.pictureSingle,i.PictureSingle.Space);r===ke(o.pictureSingle,i.PictureSingle.Comma)&&(!o.isCurrencySymbolLead&&o.isCurrencySepBySpace&&l===Ee.Currency||o.isPercentSepBySpace&&l===i.PictureSingle.Percent)&&(n.code.push({kind:Ve.Char,formattedStr:r}),e-=1),e>0&&(n.numThousands+=e)}break;default:s=!1}if(!s)break}break}case i.PictureSingle.Percent:{E+=1;const e={kind:qe.Percent,code:[{kind:i.PictureSingle.Percent,formattedStr:t.tokenStr}]};s.suns.push(e),s.hasPercent=!0;break}case Ee.Exp:{const e={kind:qe.Exp,code:[{kind:Ee.Exp,formattedStr:t.eStr,isNeg:t.isNeg}],isNeg:t.isNeg};s.suns.push(e);break}case Ee.General:{const e={kind:qe.General,code:[t]};s.suns.push(e);break}case i.PictureSingle.Text:{const e={kind:qe.Text,code:[t]};s.suns.push(e);break}case i.PictureSingle.Slash:{if(y){const e={kind:qe.Date,code:[N(t)]};s.suns.push(e);break}const e={kind:qe.Fraction,code:[{kind:i.PictureSingle.Slash,formattedStr:t.tokenStr}]};s.suns.push(e);break}case i.PictureSingle.Star:case Ee.PrefixDigTh:case i.PictureSingle.Underscore:case Ee.Currency:case Ee.CurrCode:case Ee.StrLit:{const e={kind:qe.Other,code:[t]};s.suns.push(e);break}case i.PictureSingle.ColorEnd:case i.PictureSingle.Plus:{const e={kind:qe.Other,code:[{kind:Ve.Char,formattedStr:t.tokenStr}]};s.suns.push(e);break}case i.PictureSingle.OpenParen:case i.PictureSingle.CloseParen:case Ee.Char:{const e={kind:qe.Other,code:[{kind:Ve.Char,formattedStr:t.escaped}]};s.suns.push(e);break}case i.PictureSingle.Minus:{if(y){const e={kind:qe.Date,code:[N(t)]};s.suns.push(e);break}const e=ke(o.pictureSingle,t.kind),r={kind:qe.Other,code:[{kind:Ve.Char,formattedStr:e}]};s.suns.push(r);break}case i.PictureSingle.ColorStart:{let t=ue.WantPic;const r={kind:qe.Date,code:[]};for(;e+1<a.length&&t!==ue.Done;e+=1){const n=a[e+1];switch(n.kind){case i.PictureSingle.ColorEnd:if(t!==ue.WantClose)throw new et(this.notFormatString("unexpected closing ]"));t=ue.Done;continue;case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Month:case i.PictureSingle.Minute:case i.PictureSingle.Second:{if(n.kind===i.PictureSingle.Month&&!c)break;const e=n.kind===i.PictureSingle.Month?i.PictureSingle.Minute:n.kind,a=!0;R(e,a,r),F+=1;const o=(0,M.fastMin)(2,n.count);e===i.PictureSingle.Hour||e===i.PictureSingle.HourTh?r.code.push({kind:e,count:o,isAbs:a,isAMPM:!1}):r.code.push({kind:e,count:o,isAbs:a}),y=!0,t=ue.WantClose;continue}case Ee.Char:if(n.tokenStr===ke(o.pictureSingle,i.PictureSingle.Space))continue}throw new et(this.notFormatString("unexpected token after ["))}if(t!==ue.Done)throw new et((0,d.notImplemented)(["semicolon inside [ ]"]));s.suns.push(r);break}default:return(0,l.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok",t)}if(s.suns.length>=2){const e=s.suns[s.suns.length-2],t=s.suns[s.suns.length-1];if(e.kind===qe.Other&&t.kind===qe.Other){const r=e.code;(0,L.safePush)(r,t.code),s.suns.pop()}}}if(void 0!==m&&(m.numThousands=h.numThousands,m.numPercent=E),A&&void 0!==p&&(p.code[0].isAMPM=!0),b)for(const e of s.suns)if(e.kind===qe.Date)for(const t of e.code)switch(t.kind){case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Minute:case i.PictureSingle.MinuteTh:case i.PictureSingle.Second:case i.PictureSingle.SecondTh:t.isAbs=Ge[t.kind]===g}if(s.suns.length>32)throw new et(this.notFormatString("format string too long: SUNs limit"));return s.hasDate=v>0,s.hasTime=F>0,s}classifySunPartKind({suns:e,isEmpty:t,hasDate:r,hasTime:n},a){let i=a===Qe.Number,o=a===Qe.Text,s=!i&&!o;for(const t of e){switch(t.kind){case qe.Num:case qe.Fraction:case qe.Percent:case qe.Exp:i=!0;break;case qe.Text:o=!0;break;case qe.General:continue;case qe.Other:case qe.Date:break;default:return(0,l.assertNever)("calc.numfmt.NumberFormatImpl: classifySunPartKind sun",t)}s=!1}if((i?1:0)+(r||n?1:0)+(o?1:0)>1)throw new et(this.notFormatString("cannot mix number/date/text"));return i||r||n?Qe.Number:o?Qe.Text:s&&!t?Qe.Either:a}convertSunToCode({suns:e,isEmpty:t,dtrRounding:r,color:n,dbnum:a,currCode:i}){const{localeInfo:o}=this.config,s=[];function u(t){for(let r=t-1;r>=0;r-=1){const t=e[r];if(t.kind===qe.Num)return[r,t]}}function c(t){for(let r=t+1;r<e.length;r+=1){const t=e[r];if(t.kind===qe.Num)return[r,t]}}let d,g=!1,m=0;for(let t=0;t<e.length;t+=1){const r=e[t];switch(r.kind){case qe.Text:if(d===qe.Text)break;if(void 0!==d)throw new et(this.notFormatString("@ after other control"));d=qe.Text;break;case qe.General:if(void 0!==d)throw new et(this.notFormatString("General after other control"));if(g)throw new et(this.notFormatString("General after number"));d=qe.General;break;case qe.Num:if(g=!0,d===qe.General)throw new et(this.notFormatString("number after General"));break;case qe.Fraction:if(void 0!==d)throw new et(this.notFormatString("/ after other control"));if(o.isEastAsia&&void 0!==a)throw new et(this.notFormatString("/ not allowed with DBNUM"));d=qe.Fraction;const n=u(t);if(void 0===n)throw new et(this.notFormatString("no number before /"));const[i,h,p]=this.mergeNumSuns(e,m,n[0]),f=c(t);if(void 0===f)throw new et(this.notFormatString("no number after /"));const S=e.slice(n[0]+1,f[0]),v=void 0!==c(f[0]);(0,L.safePush)(s,this.flattenSuns(i)),(0,L.safePush)(s,this.buildFractCode(h,p,n[1],S,f[1],v)),m=f[0]+1;break;case qe.Exp:if(void 0!==d)throw new et(this.notFormatString("E after other control"));d=qe.Exp;const[F,y,b]=this.mergeNumSuns(e,m,t);if(void 0===y)throw new et(this.notFormatString("no number before E"));const[C,A,E]=this.mergeNumSuns(e,t+1,e.length);if(void 0===A)throw new et(this.notFormatString("no number after E"));(0,L.safePush)(s,this.flattenSuns(F)),(0,L.safePush)(s,this.buildExpCode(r.isNeg,y,[...b,e[t],...C],A)),(0,L.safePush)(s,this.flattenSuns(E)),m=e.length;break;case qe.Percent:case qe.Other:case qe.Date:break;default:return(0,l.assertNever)("calc.numfmt.NumberFormatImpl: convertSunToCode sun",r)}}if(void 0===d){const[t,r,n]=this.mergeNumSuns(e,m,e.length);void 0!==r?(0,L.safePush)(s,this.buildNumberCode(t,r)):(0,L.safePush)(s,this.flattenSuns(t)),(0,L.safePush)(s,this.flattenSuns(n)),m=e.length}(0,L.safePush)(s,this.flattenSuns(e.slice(m))),0!==e.length||t||s.push(je);const h=i?.tag;if((0,S.isSystemCultureTag)(h)){const e=h===S.CultureTag.SysDate?o.sysDateFormat:o.sysTimeFormat,t=new tt(this.config,{old:void 0,formatString:e,source:S.NumberFormatSource.System}),r=t.parts[ze.Pos];return{part:{code:[{kind:Ve.SysFormat,codeSysFormat:r.code,codeThisFormat:s}],color:r.color,dbnum:r.dbnum,dtrRounding:r.dtrRounding},applyCurrCode:t.thisCurrCode}}return{part:{code:s,color:n,dbnum:a,dtrRounding:r},applyCurrCode:i}}flattenSuns(e){return(0,w.safeConcat)([],e.map((e=>e.code)))}buildExpCode(e,t,r,n){if(n.comma)throw new et(this.notFormatString("comma following E"));const a=t.numDigDec;if(a>127)throw new et(this.notFormatString("too many decimal digits"));const{code:i,comma:o,numDigLeft:s}=this.bumpDigitsForComma(t);return[{kind:Ve.Exp,isNeg:e,numMantDigLeft:s,numMantDigDec:a,numExpDigLeft:n.numDigLeft,commaMant:o,codeMant:i,codeBetween:this.flattenSuns(r),codeExp:this.flattenSuns([n])}]}buildNumberCode(e,t){const{numDigDec:r}=t;if(r>127)throw new et(this.notFormatString("too many decimal digits"));const{code:n,comma:a,numDigLeft:i}=this.bumpDigitsForComma(t);return[{kind:Ve.Num,numDigLeft:i,numDigDec:r,numPercent:t.numPercent,numThousands:t.numThousands,comma:a,codeBefore:this.flattenSuns(e),code:n}]}buildFractCode(e,t,r,n,a,o){const{mathpack:s}=this.config;if(r.comma)throw new et(this.notFormatString("comma in numerator"));if(r.decimal)throw new et((0,d.notImplemented)(["decimals in numerator"]));if(a.comma)throw new et(this.notFormatString("comma in denominator"));if(a.decimal)throw new et(this.notFormatString("decimals in denominator"));if(0!==r.numDigDec)throw new et(this.notFormatString("decimals in numerator"));if((u=a).numVal&&u.nonZero&&u.digitTokens)throw new et(this.notFormatString("literal and placeholder digits mixed in denominator"));var u;if(o)throw new et((0,d.notImplemented)(["fraction number formats with trailing numbers"]));let l,g=!1,m=0;if(void 0!==e){if(!e.reallyNum)throw new et((0,d.notImplemented)(["fixed numerals in fraction integer part"]));if(e.decimal)throw new et((0,d.notImplemented)(["decimal in fraction integer part"]));if(0!==e.numDigDec)throw new et(this.notFormatString("decimals in fraction integer part"));if(e.numVal&&e.nonZero)throw new et((0,d.notImplemented)(["numerals in fraction integer part"]));({code:l,comma:g,numDigLeft:m}=this.bumpDigitsForComma(e))}const h=e?.numPercent??r.numPercent,p=e?.numThousands??r.numThousands;if(p>0)throw new et((0,d.notImplemented)(["fraction number formats with thousands"]));let f,{code:S,numDigLeft:v,firstDig:F}=a;if(a.numVal&&a.nonZero){if(o)throw new et((0,d.notImplemented)(["fraction number formats with specified denominator and trailing numbers"]));if(a.code.length>5)throw new et((0,d.notImplemented)(["too many digits in denominator"]));let e=0;for(let t=0;t<a.code.length;t+=1){const r=a.code[t];switch(r.kind){case Ee.Numeral:e=10*e+r.ordinal;break;case i.PictureSingle.Zero:if(0===t)throw new et((0,d.notImplemented)(["leading zero in denominator"]));e*=10;break;default:return(0,c.assertFalse)("calc.numfmt.NumberFormatImpl: buildFractCode denomCode")}}if(e>32767)throw new et((0,d.notImplemented)(["overflow in denominator not emulated"]));S=[{kind:i.PictureSingle.Hash,count:1}],v=1,F=void 0,f=s.fromNumber(e)}return[{kind:Ve.Fraction,numIntDigLeft:m,numPercent:h,numThousands:p,numNumerDig:r.numDigLeft,numDenomDig:v,commaInt:g,codeInt:l,codeBetween1:this.flattenSuns(t),codeNumer:r.code,codeBetween2:this.flattenSuns(n),codeDenom:S,denomValue:f,lastDigInt:void 0!==e?e.lastDig:void 0,firstDigNumer:r.firstDig,firstDigDenom:F,anyZeroNumer:r.anyZero,anyQuestionNumer:r.anyQuestion}]}mergeNumSuns(e,t,r){const n=[],a=[];let i;for(let o=t;o<e.length&&o<r;o+=1){const t=e[o];void 0!==i?t.kind===qe.Num?(i.decimal?i.numDigDec+=t.numDigLeft+t.numDigDec:(i.numDigLeft+=t.numDigLeft,i.numDigDec+=t.numDigDec),i.comma=i.comma||t.comma,i.decimal=i.decimal||t.decimal,i.numVal=i.numVal||t.numVal,i.nonZero=i.nonZero||t.nonZero,void 0!==t.lastDig&&(i.lastDig=t.lastDig),void 0===i.firstDig&&(i.firstDig=t.firstDig),i.anyHash=i.anyHash||t.anyHash,i.anyQuestion=i.anyQuestion||t.anyQuestion,i.anyZero=i.anyZero||t.anyZero,(0,L.safePush)(i.code,this.flattenSuns(a)),a.length=0,(0,L.safePush)(i.code,t.code)):a.push(t):t.kind===qe.Num?i=t:n.push(t)}return[n,i,a]}bumpDigitsForComma(e){if(!e.comma)return e;if(this.anyLegalCommaPosition(e))return e;const t=e.numDigLeft%3,r=(0===t?0===e.numDigLeft?3:e.numDigLeft:e.numDigLeft+3-t)+1;for(let t=0;t<e.code.length;t+=1){const n=e.code[t];switch(n.kind){case i.PictureSingle.Hash:{const a=e.code.slice();return a[t]={...n,count:n.count+(r-e.numDigLeft)},{code:a,comma:!0,numDigLeft:r}}case i.PictureSingle.Zero:case i.PictureSingle.Question:case i.PictureSingle.Decimal:{const n=e.code.slice();return n.splice(t,0,{kind:i.PictureSingle.Hash,count:r-e.numDigLeft}),{code:n,comma:!0,numDigLeft:r}}}}throw new et((0,d.notImplemented)(["comma with pure number literal"]))}anyLegalCommaPosition(e){if(e.numDigLeft<4)return!1;const t=e=>{const t=e?.kind;return t===i.PictureSingle.Hash||t===i.PictureSingle.Zero||t===i.PictureSingle.Question};let r=e.numDigLeft;for(let n=0;n<e.code.length;n+=1){const a=e.code[n];if(a.kind===i.PictureSingle.Decimal)return!1;if(t(a))for(let i=0;i<a.count;i+=1)if(r-=1,r>0&&r%3==0&&(i+1<a.count||t(e.code[n+1])))return!0}return!1}parseCurrCode(e){const{localeInfo:t}=this.config;let r,n,a;{const n=e.indexOf("-");if(0!==e.length&&0!==n){if(r=n<0?e:e.substring(0,n),r.length>61)throw new et(this.notFormatString("currencySymbol too long"));for(const e of(0,b.codePointIterator)(r))if(t.isNumeral(e)&&t.getNumberShape(e)!==U.NumberShape.ASCII)throw new et((0,d.notImplemented)(["non-ASCII digits in currencySymbol"]))}n>=0&&(a=e.substring(n+1))}if(void 0!==a&&(n=this.parseFormatCulture(a),void 0===n))throw new et((0,d.notImplemented)(["unhandled CurrCode: "+(0,$.anonymizeFormulaString)(e)]));if((0,S.isSystemCultureTag)(n?.tag)){if(void 0!==r)throw new et(this.notFormatString("currencySymbol with sysdate/systime"));if(this.source===S.NumberFormatSource.System)throw new et(this.notFormatString("system format referenced circularly within system format"))}return{currencySymbol:r,currCode:n}}parseFormatCulture(e){const r={culture:"",numberShape:void 0,nationalNumberInput:!1,calendar:void 0,localCalendarInput:!1,tag:void 0},n=n=>{const a=(32512&n)>>8;if(0!==a&&(r.numberShape=t.pictureNumberShape[a],void 0===r.numberShape))throw new et((0,d.notImplemented)([`unknown number shape ${a} in culture: ${(0,$.anonymizeFormulaString)(e)}`]));r.nationalNumberInput=0!=(32768&n);const i=127&n;if(0!==i&&(r.calendar=t.pictureCalendar[i],void 0===r.calendar))throw new et((0,d.notImplemented)([`unknown calendar ${i} in culture: ${(0,$.anonymizeFormulaString)(e)}`]));r.localCalendarInput=0!=(128&n)},a=e.match(Pe);if(null!=a){r.culture=a[1]??"";const t=a[2]??a[3];if(null!=t){if(r.tag=Me[t.toLowerCase()],void 0===r.tag)throw new et((0,d.notImplemented)(["unknown CurrCode tag: "+(0,$.anonymizeFormulaString)(e)]));switch(r.tag){case S.CultureTag.SysDate:case S.CultureTag.SysTime:case S.CultureTag.Euro1:case S.CultureTag.Euro2:case S.CultureTag.Bitcoin1:case S.CultureTag.Bitcoin2:if(""!==r.culture)throw new et(this.notFormatString(`CultureTag ${String(r.tag)} cannot have culture`));break;case S.CultureTag.GenLower:case S.CultureTag.GenUpper:case S.CultureTag.NomLower:case S.CultureTag.Gannen:if(""===r.culture)throw new et(this.notFormatString(`CultureTag ${String(r.tag)} must have culture`))}}const i=a[4];return null!=i&&n(we(i)),r}if(Oe.test(e)){const t=we(e);let a=65535&t;switch(a){case s.LCID.SystemLongDate:r.tag=S.CultureTag.SysDate;break;case s.LCID.SystemTime:r.tag=S.CultureTag.SysTime;break;case s.LCID.EuroTrailing:r.tag=S.CultureTag.Euro1;break;case s.LCID.EuroLeading:r.tag=S.CultureTag.Euro2;break;default:64512==(64512&a)&&(r.tag=S.CultureTag.GenLower),63488==(64512&a)&&(r.tag=S.CultureTag.GenUpper),62464==(64512&a)&&(r.tag=S.CultureTag.NomLower),void 0!==r.tag&&(a&=-63489),r.culture=(0,Y.convertKnownLCID)(a)}return n(t>>16),r}}determineValueType(){const{localeInfo:e}=this.config,t={accountFill:!1,fvt:void 0};for(const e of this.parts){t.accountFill=!1;const r=this.determineValueTypeCodes(t,e.code);if(void 0!==r)return r;if(t.accountFill&&(t.fvt===S.FormatValueType.Number||t.fvt===S.FormatValueType.Currency))return S.FormatValueType.Accounting;if(void 0!==t.fvt)return t.fvt}return void 0!==t.fvt?t.fvt:this.formatString===ke(e.pictureSpecial,a.PictureSpecial.General)?S.FormatValueType.General:S.FormatValueType.Custom}determineValueTypeCodes(e,t){const{localeInfo:r}=this.config;for(let n=0;n<t.length;n+=1){const a=t[n];switch(a.kind){case Ee.General:break;case i.PictureSingle.Text:return S.FormatValueType.Text;case i.PictureSingle.Star:e.accountFill=!0;break;case Ve.Char:case Ee.Exp:case i.PictureSingle.Slash:case Ee.StrLit:case i.PictureSingle.Percent:case i.PictureSingle.Underscore:case Ee.Numeral:case Ve.DateSep:case Ve.TimeSep:break;case Ee.Currency:e.fvt=S.FormatValueType.Currency;break;case Ee.CurrCode:void 0!==a.currencySymbol&&(e.fvt=S.FormatValueType.Currency);break;case Ve.Num:{e.fvt=1===a.numPercent&&0===a.numThousands?S.FormatValueType.Percentage:S.FormatValueType.Number;const t=a.codeBefore;let n,i=0;if(r.isEastAsia){if(i<t.length&&"("===Be(t[i])&&(i+=1),i<t.length&&"US$"===Be(t[i]))return S.FormatValueType.Currency;if(r.isChinaT){if(i<t.length&&"NT$"===Be(t[i]))return S.FormatValueType.Currency}else if(i<t.length&&"$"===Be(t[i]))return S.FormatValueType.Currency}if(void 0!==(n=this.determineValueTypeCodes(e,a.codeBefore.slice(i))))return n;if(void 0!==(n=this.determineValueTypeCodes(e,a.code)))return n;break}case Ve.Exp:{let t;if(e.fvt=S.FormatValueType.Scientific,void 0!==(t=this.determineValueTypeCodes(e,a.codeMant)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,a.codeBetween)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,a.codeExp)))return t;break}case Ve.Fraction:{let t;if(e.fvt=S.FormatValueType.Fraction,void 0!==a.codeInt&&void 0!==(t=this.determineValueTypeCodes(e,a.codeInt)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,a.codeBetween1)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,a.codeNumer)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,a.codeBetween2)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,a.codeDenom)))return t;break}case i.PictureSingle.Decimal:case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:case Ee.PrefixDigTh:case Ee.LatinDate:case Ee.BidiDate:break;case i.PictureSingle.HourTh:case i.PictureSingle.MinuteTh:case i.PictureSingle.SecondTh:case i.PictureSingle.Hour:case i.PictureSingle.Minute:case i.PictureSingle.Second:case Ve.FracSeconds:return S.FormatValueType.Time;case Ee.AMPM:case Ee.AMPMFE:break;case i.PictureSingle.Era:case i.PictureSingle.EraYear:case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.MonthTh:case i.PictureSingle.DayTh:case i.PictureSingle.Year:case i.PictureSingle.Month:case i.PictureSingle.Day:case i.PictureSingle.LocDay:return S.FormatValueType.Date;case Ve.SysFormat:return this.determineValueTypeCodes(e,a.codeThisFormat);default:return(0,l.assertNever)("calc.numfmt.NumberFormatImpl: determineValueTypeCodes code",a)}}}determineDecimals(){const e=this.parts[ze.Pos];for(const t of e.code)switch(t.kind){case Ve.Num:return t.numDigDec;case Ve.Exp:return t.numMantDigDec}return 0}determineBidiDate(){const e=ke(this.config.localeInfo.pictureSingle,i.PictureSingle.BidiDate);return(0,k.stringStartsWith)(this.formatString,e+"1")?S.BidiDate.English:(0,k.stringStartsWith)(this.formatString,e+"2")?S.BidiDate.Lunar:void 0}printFormatString(){const{localeInfo:e}=this.config,[t,r,n,a]=this.parts,o=!(Ye(a)||a===t),s=this.posBeforeText||!o;let u="";return s&&(u+=this.printPart(t,this.condPos),r!==t&&(u+=ke(e.pictureSingle,i.PictureSingle.Sep),u+=this.printPart(r,this.condNeg),n!==t&&(u+=ke(e.pictureSingle,i.PictureSingle.Sep),u+=this.printPart(n,void 0)))),o&&(s&&(u+=ke(e.pictureSingle,i.PictureSingle.Sep)),u+=this.printPart(a,void 0)),u}printPart(e,t){const{mathpack:r,localeInfo:n}=this.config;let a="";var s;if(void 0!==e.color&&(a+=ke(n.pictureSingle,i.PictureSingle.ColorStart)+("number"==typeof e.color?ke(n.pictureColor,o.PictureColor.Color)+String(e.color-8):ke(n.pictureColor,(s=e.color,o.PictureColor[s])))+ke(n.pictureSingle,i.PictureSingle.ColorEnd)),void 0!==t){const e=21;a+=ke(n.pictureSingle,i.PictureSingle.ColorStart)+ke(be,Ae[t.operator])+r.formatGeneral(n,t.operand,e)+ke(n.pictureSingle,i.PictureSingle.ColorEnd)}return void 0!==e.dbnum&&(a+=ke(n.pictureSingle,i.PictureSingle.ColorStart)+ke(n.pictureDbnum,e.dbnum-1)+ke(n.pictureSingle,i.PictureSingle.ColorEnd)),a+=this.printCodes({seenDig:!1,wasPrevDig:!1},e.code,void 0),a}printCodes(e,r,n){const{mathpack:o,localeInfo:s}=this.config;let d,g="";if(void 0!==n&&n.numThousands>0){for(let e=0;e<r.length;e+=1){const t=r[e].kind;t!==i.PictureSingle.Zero&&t!==i.PictureSingle.Hash&&t!==i.PictureSingle.Question&&t!==i.PictureSingle.Decimal&&t!==Ee.Numeral||(d=e)}(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes thousandsAfter",void 0!==d)}for(let m=0;m<r.length;m+=1){const h=r[m],p=e.wasPrevDig;switch(e.wasPrevDig=!1,h.kind){case Ee.General:g+=ke(s.pictureSpecial,a.PictureSpecial.General);break;case i.PictureSingle.Decimal:void 0!==n&&(n.decimal=!0),e.wasPrevDig=!0,g+=ke(s.pictureSingle,i.PictureSingle.Decimal);break;case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:{e.seenDig=!0,e.wasPrevDig=!0;const t=h.kind===i.PictureSingle.Zero?"0":ke(s.pictureSingle,h.kind),a=(0,I.repeat)(t,h.count);if(void 0===n||n.decimal){g+=a;break}if(n.comma){const e=n.numDigLeft-h.count;g+=(0,x.insertCommas)({isThousandsPosition:t=>{return t>0&&t%3==0&&(t>e||(n=r[m+1]?.kind,n===i.PictureSingle.Hash||n===i.PictureSingle.Zero||n===i.PictureSingle.Question));var n},thousandsSeparator:ke(s.pictureSingle,i.PictureSingle.Comma)},a,e)}else g+=a;n.numDigLeft-=h.count;break}case Ee.Numeral:e.wasPrevDig=!0,g+=h.formattedStr;break;case Ve.Exp:g+=this.printCodes(e,h.codeMant,{comma:h.commaMant,numThousands:0,decimal:!1,numDigLeft:h.numMantDigLeft})+this.printCodes(e,h.codeBetween,void 0)+this.printCodes(e,h.codeExp,{comma:!1,numThousands:0,decimal:!1,numDigLeft:h.numExpDigLeft});break;case Ve.Num:g+=this.printCodes(e,h.codeBefore,void 0)+this.printCodes(e,h.code,{comma:h.comma,numThousands:h.numThousands,decimal:!1,numDigLeft:h.numDigLeft});break;case Ve.Fraction:{const t=void 0===h.codeInt?"":this.printCodes(e,h.codeInt,{comma:h.commaInt,numThousands:0,decimal:!1,numDigLeft:h.numIntDigLeft}),r=this.printCodes(e,h.codeBetween1,void 0),n=this.printCodes(e,h.codeNumer,{comma:!1,numThousands:0,decimal:!1,numDigLeft:h.numNumerDig}),a=this.printCodes(e,h.codeBetween2,void 0),i=this.printCodes(e,h.codeDenom,{comma:!1,numThousands:h.numThousands,decimal:!1,numDigLeft:h.numDenomDig});g+=t+r+n+a+(void 0!==h.denomValue?ge(o,h.denomValue):i);break}case Ve.Char:{const t=ke(s.pictureSingle,i.PictureSingle.Backslash),n=Re(s,s.pictureSingle,h.formattedStr,0),a=Ne(s,s.pictureSpecial,h.formattedStr,0);if(void 0!==n&&n!==i.PictureSingle.Extra&&n!==i.PictureSingle.Zero)switch(n){case i.PictureSingle.Comma:const n=r[m+1];if(p){const e=ke(s.pictureSingle,i.PictureSingle.Space);if(h.formattedStr!==e||void 0===n||(s.isCurrencySymbolLead||!s.isCurrencySepBySpace||n.kind!==Ee.Currency)&&(!s.isPercentSepBySpace||n.kind!==i.PictureSingle.Percent)){g+=t;break}}if(n?.kind===Ve.Char&&n?.formattedStr===h.formattedStr){g+=t;break}break;case i.PictureSingle.Decimal:g+=t;break;case i.PictureSingle.Slash:e.seenDig&&(g+=t);break;case i.PictureSingle.Space:case i.PictureSingle.Minus:case i.PictureSingle.Plus:case i.PictureSingle.OpenParen:case i.PictureSingle.CloseParen:break;case i.PictureSingle.DateSep:ke(s.pictureSingle,i.PictureSingle.DateSep)!==ke(s.pictureSingle,i.PictureSingle.Minus)&&(g+=t);break;default:g+=t}else(a||s.isNumeral((0,v.stringCodePointAt)(h.formattedStr,0)))&&(g+=t);g+=h.formattedStr;break}case Ee.Exp:g+=h.formattedStr+(h.isNeg?"-":"+");break;case Ee.StrLit:{const e=ke(s.pictureSingle,i.PictureSingle.Quote);(0,u.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes StrLit",h.escaped.indexOf(e)<0),g+=e+h.escaped+e;break}case i.PictureSingle.Slash:g+=ke(s.pictureSingle,i.PictureSingle.Slash);break;case i.PictureSingle.Percent:g+=ke(s.pictureSingle,i.PictureSingle.Percent);break;case i.PictureSingle.Star:g+=ke(s.pictureSingle,i.PictureSingle.Star)+h.escaped;break;case i.PictureSingle.Underscore:g+=ke(s.pictureSingle,i.PictureSingle.Underscore)+h.escaped;break;case Ee.PrefixDigTh:g+="t";break;case Ee.Currency:g+=ke(s.pictureSpecial,a.PictureSpecial.Currency);break;case Ee.CurrCode:if(g+=ke(s.pictureSingle,i.PictureSingle.ColorStart),g+="$",void 0!==h.currencySymbol&&(g+=h.currencySymbol),void 0!==h.currCode){const{culture:e,numberShape:r,nationalNumberInput:n,calendar:a,localCalendarInput:i,tag:o}=h.currCode;g+="-";let s=0;switch(void 0!==r&&(s|=t.pictureNumberShape.indexOf(r)<<8),n&&(s|=32768),void 0!==a&&(s|=t.pictureCalendar.indexOf(a)),i&&(s|=128),typeof e){case"number":{let t=e;switch(o){case void 0:break;case S.CultureTag.GenLower:t|=64512;break;case S.CultureTag.GenUpper:t|=63488;break;case S.CultureTag.NomLower:t|=62464;break;default:(0,c.assertFalse)("calc.numfmt.NumberFormatImpl: printCodes lcid2")}let r=De(s<<16|t);/^[a-f]{1,7}$/i.test(r)&&(r="0"+r),g+=r;break}case"string":g+=e,void 0!==o&&(""!==e&&(g+="-"),g+="x-",g+=String(o)),0!==s&&(g+=",",g+=De(s))}}g+=ke(s.pictureSingle,i.PictureSingle.ColorEnd);break;case i.PictureSingle.Text:g+=ke(s.pictureSingle,i.PictureSingle.Text);break;case Ee.LatinDate:g+=ke(s.pictureSingle,i.PictureSingle.BidiDate)+"1";break;case Ee.BidiDate:g+=ke(s.pictureSingle,i.PictureSingle.BidiDate)+"2";break;case Ve.FracSeconds:g+=ke(s.pictureSingle,i.PictureSingle.Decimal)+(0,I.repeat)("0",h.rounding);break;case Ve.DateSep:g+=ke(s.pictureSingle,i.PictureSingle.DateSep);break;case Ve.TimeSep:g+=ke(s.pictureSingle,i.PictureSingle.Colon);break;case i.PictureSingle.Era:case i.PictureSingle.EraYear:case i.PictureSingle.Year:case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.Month:case i.PictureSingle.MonthTh:case i.PictureSingle.Day:case i.PictureSingle.DayTh:case i.PictureSingle.LocDay:g+=(0,I.repeat)(ke(s.pictureSingle,h.kind),h.count);break;case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Minute:case i.PictureSingle.MinuteTh:case i.PictureSingle.Second:case i.PictureSingle.SecondTh:if(h.isAbs){g+=ke(s.pictureSingle,i.PictureSingle.ColorStart)+(0,I.repeat)(ke(s.pictureSingle,h.kind),h.count)+ke(s.pictureSingle,i.PictureSingle.ColorEnd);break}g+=(0,I.repeat)(ke(s.pictureSingle,h.kind),h.count);break;case Ee.AMPM:case Ee.AMPMFE:h.kind===Ee.AMPMFE||s.isEastAsia||h.pictureKind===a.PictureSpecial.AP2?g+=h.tokenStr:g+=ke(s.pictureSpecial,h.pictureKind);break;case Ve.SysFormat:g+=this.printCodes(e,h.codeThisFormat,void 0);break;default:return(0,l.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",h)}m===d&&(g+=(0,I.repeat)(ke(s.pictureSingle,i.PictureSingle.Comma),n.numThousands))}return g}countBytecodeBuffer(e){const{mathpack:t,localeInfo:r}=this.config;let n=0;for(let o=0;o<e.length;o+=1){const s=e[o];let u=1;switch(s.kind){case i.PictureSingle.Percent:case Ee.Numeral:case Ve.Char:case i.PictureSingle.Star:case i.PictureSingle.Underscore:u+=2;break;case Ee.StrLit:u+=1+2*s.escaped.length;break;case Ve.FracSeconds:case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:case Ee.Exp:u+=1;break;case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Minute:case i.PictureSingle.MinuteTh:case i.PictureSingle.Second:case i.PictureSingle.SecondTh:s.isAbs&&(u+=1);break;case Ve.Fraction:u+=5,void 0!==s.codeInt&&(u+=this.countBytecodeBuffer(s.codeInt)),u+=this.countBytecodeBuffer(s.codeBetween1),u+=this.countBytecodeBuffer(s.codeNumer),u+=this.countBytecodeBuffer(s.codeBetween2),u+=this.countBytecodeBuffer(s.codeDenom),void 0!==s.denomValue&&(u-=2,u+=2+2*ge(t,s.denomValue).length),s.commaInt&&(u+=1);break;case Ve.Exp:u+=3,u+=this.countBytecodeBuffer(s.codeMant),u+=this.countBytecodeBuffer(s.codeBetween),u+=this.countBytecodeBuffer(s.codeExp),s.commaMant&&(u+=1);break;case Ve.Num:u+=3,u+=this.countBytecodeBuffer(s.codeBefore),u+=this.countBytecodeBuffer(s.code),s.comma&&(u+=1);break;case Ve.SysFormat:u=0,u+=this.countBytecodeBuffer(s.codeThisFormat);break;case Ee.CurrCode:u+=2*((s.currencySymbol?.length??0)+1),u+=8;break;case Ee.AMPM:{const e=r.isEastAsia||s.pictureKind===a.PictureSpecial.AP2?Ie(r,s.tokenStr):r.ampmSymbols;u+=2+2*(e[0].length+e[1].length)}break;case Ee.AMPMFE:case Ee.General:case i.PictureSingle.Decimal:case i.PictureSingle.Slash:case Ee.PrefixDigTh:case Ee.Currency:case i.PictureSingle.Text:case Ee.LatinDate:case Ee.BidiDate:case Ve.DateSep:case Ve.TimeSep:case i.PictureSingle.Era:case i.PictureSingle.EraYear:case i.PictureSingle.Year:case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.Month:case i.PictureSingle.MonthTh:case i.PictureSingle.Day:case i.PictureSingle.DayTh:case i.PictureSingle.LocDay:break;default:return(0,l.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",s)}n+=u}return n}countBytecodePart({code:e,color:t,dbnum:r,dtrRounding:n}){let a=0;return void 0!==t&&(a+=2),void 0!==r&&(a+=2),0!==n&&(a+=2),a+=this.countBytecodeBuffer(e),a}countBytecode(){let e=0;for(let t=ze.Pos;t<=ze.Text;t+=1){(t===ze.Pos&&void 0!==this.condPos||t===ze.Neg&&void 0!==this.condNeg)&&(e+=10);const r=this.parts[t];let n=!1;for(let e=ze.Pos;e<t;e+=1)if(this.parts[e]===r){n=!0;break}n||(e+=this.countBytecodePart(r))}return e}checkBytecode(){if(this.countBytecode()>255)throw new et(this.notFormatString("format string too long: bytecode limit"));if(this.countBytecode()>247)throw new et((0,d.notImplemented)(["format string too long: close to bytecode limit"]))}getBundledLocaleInfo(e,t,r){let n=r;switch(t){case W.Calendar.GregorianUS:n=Le;break;case W.Calendar.GregorianMEFrench:n=_e;break;case W.Calendar.GregorianArabic:n=xe;break;case W.Calendar.GregorianXlitEnglish:n=Ke;break;case W.Calendar.GregorianXlitFrench:n=We;break;case W.Calendar.UmAlQura:case W.Calendar.Hijri:break;case W.Calendar.Thai:n=Ue}if(void 0!==n?.culture&&""!==n.culture){const t=(0,Y.getBundledLocaleInfo)(n);if(void 0===t)throw new Ze(this.notImplementedCulture(e,n.culture));return t}return this.config.localeInfo}notFormatString(e){return(0,S.notFormatString)(`${e} (source=${String(this.source)}): ${this.logFormatString}`)}notImplementedCulture(e,t){const r="number"==typeof t?`lcid:${De(t)}`:`lang:${t}`;return(0,d.notImplemented)([`${e}: culture = ${r}`])}constructor(e,t){this.config=e,this.hasPercent=!1,this.hasDate=!1,this.hasTime=!1,this.posBeforeText=!0,this.onlyOneNumberPart=!0,this.parts=[void 0,void 0,void 0,void 0],this.hasTokenCurrCode=!1,void 0===t.old?(this.logFormatString=(0,$.anonymizeFormulaString)(t.formatString),this.source=t.source,this.parseString(t.formatString)):(this.hasPercent=t.old.hasPercent,this.hasDate=t.old.hasDate,this.hasTime=t.old.hasTime,this.posBeforeText=t.old.posBeforeText,this.onlyOneNumberPart=t.old.onlyOneNumberPart,this.parts=t.synth,this.hasTokenCurrCode=t.old.hasTokenCurrCode,this.thisCurrCode=t.old.thisCurrCode,this.thisCurrencySymbol=t.old.thisCurrencySymbol,this.applyCurrCode=t.old.applyCurrCode,this.condPos=t.old.condPos,this.condNeg=t.old.condNeg,this.logFormatString=t.logFormatString,this.source=S.NumberFormatSource.CustomString,this.checkBytecode()),this.formatString=this.printFormatString(),this.valueType=this.determineValueType(),this.decimals=this.determineDecimals(),this.bidiDate=this.determineBidiDate()}}t.NumberFormatImpl=tt,t.createFormat=function(e,t,r){try{return(0,H.success)(new tt(e.config,{old:void 0,formatString:t,source:r}))}catch(e){return e instanceof et?(0,q.failure)(e.reason):(0,q.failure)((0,z.javaScriptError)(e))}},t.applyFormat=function(e,t,r,n){try{let a,i,o;const{localeInfo:s}=e.config;switch(r.kind){case j.OperKind.String:a=function(e){if(0===e.length)return!1;const t=(0,v.stringCodePointAt)(e,0);return t>=1424&&t<=1535||8207===t||t>=64285&&t<=64335||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=2208&&t<=2303||t>=64336&&t<=65023||t>=65136&&t<=65279}(r.value)?S.Alignment.Right:S.Alignment.Left,i=S.Clip.None,o=r;break;case j.OperKind.Number:a=t.isTextOnly?S.Alignment.Left:S.Alignment.Right,i=S.Clip.All,o=r;break;case j.OperKind.Boolean:a=S.Alignment.Center,i=S.Clip.All,o=(0,C.stringOper)(r.value?s.trueName:s.falseName);break;case j.OperKind.Blank:return(0,H.success)((0,S.formattedValue)([],void 0,S.Alignment.Left,S.Clip.All));case j.OperKind.Error:const e=s.errorNames[r.type];return null==e?(0,q.failure)((0,h.internal)(`No locale data for error type ${r.type}`)):(0,H.success)((0,S.formattedValue)([(0,S.formattedUnitString)(e)],void 0,S.Alignment.Center,S.Clip.All));case j.OperKind.Array:return(0,q.failure)((0,d.notImplemented)(["Array applyFormat"]));case j.OperKind.Rich:return(0,q.failure)((0,d.notImplemented)(["Rich applyFormat"]))}return t.apply(o,a,i,n)}catch(e){return(0,q.failure)((0,z.javaScriptError)(e))}},t.changeFormatDecimals=function(e,t){try{switch(e.valueType){case S.FormatValueType.General:return(0,q.failure)((0,d.notImplemented)(["changeDecimals General"]));case S.FormatValueType.Number:case S.FormatValueType.Currency:case S.FormatValueType.Accounting:case S.FormatValueType.Percentage:case S.FormatValueType.Scientific:if(0===e.decimals&&t<0)return Q.successUndefined;const r=(0,D.fastMax)(0,e.decimals+t),n=e.synthesizeDecimals(r);return n.formatString===e.formatString?Q.successUndefined:(0,H.success)(n);default:return Q.successUndefined}}catch(e){return(0,q.failure)((0,z.javaScriptError)(e))}}},3228:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toXLNumber=t.applyValueEdit=t.getValueEditOperKind=t.applyFormatAndRenderToString=t.getFormatString=t.initUtilGlobals=t.getRibbonFormat=t.RibbonFormat=t.convertKnownLCID=t.englishXLSXKnownFormat=t.isKnownFormatDefined=t.getKnownFormat=t.buildCurrencyFormat=t.buildFractionFormat=t.buildScientificFormat=t.buildPercentFormat=t.buildNumberFormat=t.createNumberFormatter=t.shouldInstallFormat=t.PackageName=void 0;const n=r(3345);t.PackageName="excel-online-calc-numfmt";var a=r(8630);Object.defineProperty(t,"shouldInstallFormat",{enumerable:!0,get:function(){return a.shouldInstallFormat}});var i=r(1822);Object.defineProperty(t,"createNumberFormatter",{enumerable:!0,get:function(){return i.createNumberFormatter}});var o=r(9992);Object.defineProperty(t,"buildNumberFormat",{enumerable:!0,get:function(){return o.buildNumberFormat}}),Object.defineProperty(t,"buildPercentFormat",{enumerable:!0,get:function(){return o.buildPercentFormat}}),Object.defineProperty(t,"buildScientificFormat",{enumerable:!0,get:function(){return o.buildScientificFormat}}),Object.defineProperty(t,"buildFractionFormat",{enumerable:!0,get:function(){return o.buildFractionFormat}}),Object.defineProperty(t,"buildCurrencyFormat",{enumerable:!0,get:function(){return o.buildCurrencyFormat}}),Object.defineProperty(t,"getKnownFormat",{enumerable:!0,get:function(){return o.getKnownFormat}}),Object.defineProperty(t,"isKnownFormatDefined",{enumerable:!0,get:function(){return o.isKnownFormatDefined}}),Object.defineProperty(t,"englishXLSXKnownFormat",{enumerable:!0,get:function(){return o.englishXLSXKnownFormat}});var s=r(1944);Object.defineProperty(t,"convertKnownLCID",{enumerable:!0,get:function(){return s.convertKnownLCID}});var u=r(3405);Object.defineProperty(t,"RibbonFormat",{enumerable:!0,get:function(){return u.RibbonFormat}}),Object.defineProperty(t,"getRibbonFormat",{enumerable:!0,get:function(){return u.getRibbonFormat}}),n.__exportStar(r(6442),t);var l=r(4878);Object.defineProperty(t,"initUtilGlobals",{enumerable:!0,get:function(){return l.initUtilGlobals}}),Object.defineProperty(t,"getFormatString",{enumerable:!0,get:function(){return l.getFormatString}}),Object.defineProperty(t,"applyFormatAndRenderToString",{enumerable:!0,get:function(){return l.applyFormatAndRenderToString}});var c=r(3059);Object.defineProperty(t,"getValueEditOperKind",{enumerable:!0,get:function(){return c.getValueEditOperKind}}),Object.defineProperty(t,"applyValueEdit",{enumerable:!0,get:function(){return c.applyValueEdit}}),Object.defineProperty(t,"toXLNumber",{enumerable:!0,get:function(){return c.toXLNumber}})},9992:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.englishXLSXKnownFormat=t.isKnownFormatDefined=t.getKnownFormat=t.buildNumShapeDateTimeFormat=t.buildNumShapeConstFormat=t.buildMMDDYYFormat=t.buildSingle=t.buildCurrencyFormat=t.buildFractionFormat=t.buildQuoted=t.buildScientificFormat=t.buildPercentFormat=t.buildNumberFormat=t.getColor=t.getSingle=t.getSpecial=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(3387),f=r(6366),S=r(6366),v=r(6366),F=r(6366),y=r(1472),b=r(6366);function C(e,t){const r=e.pictureSpecial[t]??c.englishPictureSpecial[t];return(0,v.assertTrue)("calc.numfmt.knownFormat: getSpecial",void 0!==r),r}function A(e,t){const r=e.pictureSingle[t]??d.englishPictureSingle[t];return(0,v.assertTrue)("calc.numfmt.knownFormat: getSingle",void 0!==r),r}function E(e,t){const r=e.pictureColor[t]??g.englishPictureColor[t];return(0,v.assertTrue)("calc.numfmt.knownFormat: getColor",void 0!==r),r}function T(e,t,r,n){let a="";if(r>1){const n=(0,F.repeat)(A(e,u.PictureSingle.Hash),r-1);a+=t?(0,p.insertCommas)({isThousandsPosition:e=>e>0&&e%3==0,thousandsSeparator:A(e,u.PictureSingle.Comma)},n,1):n}return a+="0",n>0&&(a+=A(e,u.PictureSingle.Decimal),a+=(0,F.repeat)("0",n)),a}function R(e,t){let r="";return r+="0",t>0&&(r+=A(e,u.PictureSingle.Decimal),r+=(0,F.repeat)("0",t)),e.isPercentSepBySpace&&(r+=A(e,u.PictureSingle.Space)),r+=A(e,u.PictureSingle.Percent),r}function k(e,t,r,n){let a="";return a+=T(e,!1,t,r),e.isExpSepBySpace&&(a+=A(e,u.PictureSingle.Space)),a+=A(e,u.PictureSingle.E),a+="+",a+=(0,F.repeat)("0",n),a}function N(e,t){const r=A(e,u.PictureSingle.Quote);return r+t+r}function I(e,t){let r="";r+=A(e,u.PictureSingle.Hash);const n=e.fractionSeparator;return n===A(e,u.PictureSingle.Comma)?r+=N(e,n):r+=" "===n?A(e,u.PictureSingle.Space):N(e,n),r+=(0,F.repeat)(A(e,u.PictureSingle.Question),t),r+=A(e,u.PictureSingle.Slash),r+=(0,F.repeat)(A(e,u.PictureSingle.Question),t),r}var O,P;function M(e,t){let r="";return r+=N(e,"-"),t>0&&(r+=(0,F.repeat)(A(e,u.PictureSingle.Question),t)),r}function D(e,t,r,n,a,o,c=!1){const{isCurrencySymbolLead:d,currencyFormat:g,isCurrencySepBySpace:m}=e,h=c?O.Pos:a?O.Text:O.Neg,p=T(e,!0,4,r);let f="";for(let c=O.Pos;c<=h;c+=1){c!==O.Pos&&(f+=A(e,u.PictureSingle.Sep)),c===O.Neg&&t&&(f+=A(e,u.PictureSingle.ColorStart)+E(e,l.PictureColor.Red)+A(e,u.PictureSingle.ColorEnd));const h=()=>c===O.Zero?M(e,r):c===O.Text?A(e,u.PictureSingle.Text):p,S=()=>c!==O.Text?w(e,u.PictureSingle.Star,u.PictureSingle.Space):"",v=()=>{let t="";if(d)switch(g){case i.CurrencyFormat.Paren:t+=w(e,u.PictureSingle.Underscore,u.PictureSingle.OpenParen);break;case i.CurrencyFormat.Trail:t+=w(e,u.PictureSingle.Underscore,u.PictureSingle.Minus);break;case i.CurrencyFormat.Intern:t+=w(e,u.PictureSingle.Underscore,u.PictureSingle.Space)}else{switch(g){case i.CurrencyFormat.Trail:t+=w(e,u.PictureSingle.Underscore,u.PictureSingle.Minus);break;case i.CurrencyFormat.Paren:case i.CurrencyFormat.Intern:t+=w(e,u.PictureSingle.Underscore,u.PictureSingle.Space)}g!==i.CurrencyFormat.Lead&&(t+=S())}return t},F=()=>{if(d)switch(g){case i.CurrencyFormat.Lead:return w(e,u.PictureSingle.Underscore,u.PictureSingle.Minus);case i.CurrencyFormat.Intern:return w(e,u.PictureSingle.Underscore,u.PictureSingle.Space)}else switch(g){case i.CurrencyFormat.Lead:return w(e,u.PictureSingle.Underscore,u.PictureSingle.Minus);case i.CurrencyFormat.Paren:case i.CurrencyFormat.Intern:return w(e,u.PictureSingle.Underscore,u.PictureSingle.Space)}return""},y=()=>c===O.Neg?A(e,u.PictureSingle.OpenParen):"",b=()=>c!==O.Text||d?c===O.Neg?A(e,u.PictureSingle.CloseParen):w(e,u.PictureSingle.Underscore,u.PictureSingle.CloseParen):"",T=()=>{let t="";if(c!==O.Neg)switch(g){case i.CurrencyFormat.Intern:d||c===O.Text||(t+=w(e,u.PictureSingle.Underscore,u.PictureSingle.Minus));break;case i.CurrencyFormat.Lead:case i.CurrencyFormat.Trail:if(g===i.CurrencyFormat.Lead&&!a)break;t+=w(e,u.PictureSingle.Underscore,u.PictureSingle.Minus)}else t+=A(e,u.PictureSingle.Minus);return a&&!d&&g===i.CurrencyFormat.Lead&&(t+=S()),t},R=()=>{let t="";return n&&!d&&m&&(t+=A(e,u.PictureSingle.Space)),n&&(t+=o??C(e,s.PictureSpecial.Currency)),d&&m&&(t+=A(e,u.PictureSingle.Space)),t},k=()=>{let e="";return c!==O.Text&&(d?(n&&(e+=R()),a&&(e+=S())):e+=R()),e};if(a&&(f+=v()),d)switch(g){case i.CurrencyFormat.Paren:a||(f+=y()),f+=k(),a&&(f+=y()),f+=h(),f+=b();break;case i.CurrencyFormat.Lead:f+=T(),f+=k(),f+=h();break;case i.CurrencyFormat.Intern:f+=k(),f+=T(),f+=h();break;case i.CurrencyFormat.Trail:f+=k(),f+=h(),f+=T()}else switch(g){case i.CurrencyFormat.Paren:f+=y(),f+=h(),a&&(f+=b()),f+=k(),a||(f+=b());break;case i.CurrencyFormat.Lead:f+=T(),f+=h(),f+=k();break;case i.CurrencyFormat.Intern:f+=h(),f+=T(),f+=k();break;case i.CurrencyFormat.Trail:f+=h(),f+=k(),f+=T()}a&&(f+=F())}return f}function w(e,...t){return t.map((t=>"string"==typeof t?t:A(e,t))).join("")}t.getSpecial=C,t.getSingle=A,t.getColor=E,t.buildNumberFormat=T,t.buildPercentFormat=R,t.buildScientificFormat=k,t.buildQuoted=N,t.buildFractionFormat=I,function(e){e[e.Pos=0]="Pos",e[e.Neg=1]="Neg",e[e.Zero=2]="Zero",e[e.Text=3]="Text"}(O||(O={})),t.buildCurrencyFormat=D,t.buildSingle=w,function(e){e[e.Day=0]="Day",e[e.Month=1]="Month",e[e.Year=2]="Year"}(P||(P={}));const L={[o.DateOrder.MDY]:[P.Month,P.Day,P.Year],[o.DateOrder.DMY]:[P.Day,P.Month,P.Year],[o.DateOrder.YMD]:[P.Year,P.Month,P.Day],[o.DateOrder.MYD]:[P.Month,P.Year,P.Day],[o.DateOrder.DYM]:[P.Day,P.Year,P.Month],[o.DateOrder.YDM]:[P.Year,P.Day,P.Month]};function _(e,t){return w(e,(t?e.hour2Digits&&!e.clock24Hour:e.hour2Digits)?u.PictureSingle.Hour:"",u.PictureSingle.Hour,u.PictureSingle.Colon,u.PictureSingle.Minute,u.PictureSingle.Minute)}function x(e,t){return _(e,t)+w(e,u.PictureSingle.Colon,u.PictureSingle.Second,u.PictureSingle.Second)}function K(e){let t="";return e.isAMPMSepBySpace&&(t+=A(e,u.PictureSingle.Space)),t+=C(e,s.PictureSpecial.AP1),t}function W(e,t,r,n,a=e.year4Digits){const{month2Digits:i,day2Digits:o}=e,s=[(0,F.repeat)(t,o?2:1),(0,F.repeat)(r,i?2:1),(0,F.repeat)(n,a?4:2)],l=L[e.dateOrder];let c="";for(let t=0;t<3;t+=1)c+=s[l[t]],t<2&&(c+=A(e,u.PictureSingle.DateSep));return c}function U(e,t){const r=A(e,u.PictureSingle.Year),n=A(e,u.PictureSingle.Month);return W(e,A(e,u.PictureSingle.Day),n,r,t)}function G(e,t,r,n=u.PictureSingle.Day,a=u.PictureSingle.Month,i=u.PictureSingle.Year){const{day2Digits:o}=e,s=e.country===m.Country.GER,l="/"===e.dateSeparator&&" "!==e.dateAltSeparator;let c="";return t&&(c+=w(e,o?n:"",n),l?c+=e.dateAltSeparator:(c+=A(e,u.PictureSingle.DateSep),s&&(c+=A(e,u.PictureSingle.Space)))),c+=w(e,a,a,a),r&&(c+=l?e.dateAltSeparator:A(e,s?u.PictureSingle.Space:u.PictureSingle.DateSep),c+=w(e,i,i)),c}function B(e){return w(e,e.hour2Digits?u.PictureSingle.HourTh:"",u.PictureSingle.HourTh,u.PictureSingle.Colon,u.PictureSingle.MinuteTh,u.PictureSingle.MinuteTh)}function V(e){return W(e,A(e,u.PictureSingle.DayTh),A(e,u.PictureSingle.MonthTh),A(e,u.PictureSingle.YearTh))}function j(e,t,r){return G(e,t,r,u.PictureSingle.DayTh,u.PictureSingle.MonthTh,u.PictureSingle.YearTh)}function H(e,t){switch(t){case a.KnownFormat.General:return C(e,s.PictureSpecial.General);case a.KnownFormat.NoComFixed0:return T(e,!1,1,0);case a.KnownFormat.NoComFixed:return T(e,!1,1,2);case a.KnownFormat.Fixed0:return T(e,!0,4,0);case a.KnownFormat.Fixed:return T(e,!0,4,2);case a.KnownFormat.Currency:return D(e,!1,0,!0,!1);case a.KnownFormat.CoCurrency:return D(e,!0,0,!0,!1);case a.KnownFormat.CurrencyDec:return D(e,!1,2,!0,!1);case a.KnownFormat.CoCurrencyDec:return D(e,!0,2,!0,!1);case a.KnownFormat.Pct0:return R(e,0);case a.KnownFormat.Pct:return R(e,2);case a.KnownFormat.Exp:return k(e,1,2,2);case a.KnownFormat.Fract:return I(e,1);case a.KnownFormat.FractBond:return I(e,2);case a.KnownFormat.MMDDYY:return U(e);case a.KnownFormat.DDMMMYY:return G(e,!0,!0);case a.KnownFormat.DDMMM:return G(e,!0,!1);case a.KnownFormat.MMMYY:return G(e,!1,!0);case a.KnownFormat.HHMMAP:return _(e,!0)+K(e);case a.KnownFormat.HHMMSSAP:return x(e,!0)+K(e);case a.KnownFormat.HHMM:return _(e,!1);case a.KnownFormat.HHMMSS:return x(e,!1);case a.KnownFormat.MDYHMS:return w(e,U(e),u.PictureSingle.Space,_(e,!1));case a.KnownFormat.USCoCurrency:case a.KnownFormat.USCoCurrencyDec:return D({...e,isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:i.CurrencyFormat.Paren},!0,t===a.KnownFormat.USCoCurrencyDec?2:0,!0,!1,e.isChinaT?N(e,"US$"):"$");case a.KnownFormat.Currency2:return D(e,!1,0,!1,!1);case a.KnownFormat.CoCurrency2:return D(e,!0,0,!1,!1);case a.KnownFormat.CurrencyDec2:return D(e,!1,2,!1,!1);case a.KnownFormat.CoCurrencyDec2:return D(e,!0,2,!1,!1);case a.KnownFormat.Acct:return D(e,!1,0,!1,!0);case a.KnownFormat.AcctDec:return D(e,!1,2,!1,!0);case a.KnownFormat.AcctCur:return D(e,!1,0,!0,!0);case a.KnownFormat.AcctDecCur:return D(e,!1,2,!0,!0);case a.KnownFormat.MMSS:return w(e,u.PictureSingle.Minute,u.PictureSingle.Minute,u.PictureSingle.Colon,u.PictureSingle.Second,u.PictureSingle.Second);case a.KnownFormat.AbsHMMSS:return w(e,u.PictureSingle.ColorStart,u.PictureSingle.Hour,u.PictureSingle.ColorEnd,u.PictureSingle.Colon,u.PictureSingle.Minute,u.PictureSingle.Minute,u.PictureSingle.Colon,u.PictureSingle.Second,u.PictureSingle.Second);case a.KnownFormat.SS0:return w(e,u.PictureSingle.Minute,u.PictureSingle.Minute,u.PictureSingle.Colon,u.PictureSingle.Second,u.PictureSingle.Second,u.PictureSingle.Decimal,"0");case a.KnownFormat.Eng:return k(e,3,1,1);case a.KnownFormat.Text:return A(e,u.PictureSingle.Text);case a.KnownFormat.NoComFixed0_Tha:return"t"+T(e,!1,1,0);case a.KnownFormat.NoComFixed_Tha:return"t"+T(e,!1,1,2);case a.KnownFormat.Fixed0_Tha:return"t"+T(e,!0,4,0);case a.KnownFormat.Fixed_Tha:return"t"+T(e,!0,4,2);case a.KnownFormat.CoCurrency_Tha:case a.KnownFormat.CoCurrencyDec_Tha:return D({...e,isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:i.CurrencyFormat.Paren},!0,t===a.KnownFormat.CoCurrencyDec_Tha?2:0,!0,!1,"t"+C(e,s.PictureSpecial.Currency));case a.KnownFormat.Pct0_Tha:return"t"+R(e,0);case a.KnownFormat.Pct_Tha:return"t"+R(e,2);case a.KnownFormat.MMDDYY_Tha:return V(e);case a.KnownFormat.DDMMMYY_Tha:return j(e,!0,!0);case a.KnownFormat.DDMMM_Tha:return j(e,!0,!1);case a.KnownFormat.MMMYY_Tha:return j(e,!1,!0);case a.KnownFormat.HHMM_Tha:return B(e);case a.KnownFormat.HHMMSS_Tha:return function(e){return B(e)+w(e,u.PictureSingle.Colon,u.PictureSingle.SecondTh,u.PictureSingle.SecondTh)}(e);case a.KnownFormat.MDYHMS_Tha:return w(e,V(e),u.PictureSingle.Space,B(e));case a.KnownFormat.AbsHMMSS_Tha:return w(e,u.PictureSingle.ColorStart,u.PictureSingle.HourTh,u.PictureSingle.ColorEnd,u.PictureSingle.Colon,u.PictureSingle.MinuteTh,u.PictureSingle.MinuteTh,u.PictureSingle.Colon,u.PictureSingle.SecondTh,u.PictureSingle.SecondTh);case a.KnownFormat.MMSS_Tha:return w(e,u.PictureSingle.MinuteTh,u.PictureSingle.MinuteTh,u.PictureSingle.Colon,u.PictureSingle.SecondTh,u.PictureSingle.SecondTh);case a.KnownFormat.SS0_Tha:return w(e,u.PictureSingle.MinuteTh,u.PictureSingle.MinuteTh,u.PictureSingle.Colon,u.PictureSingle.SecondTh,u.PictureSingle.SecondTh,u.PictureSingle.Decimal,"0");case a.KnownFormat.DMBB_Tha:return W(e,A(e,u.PictureSingle.Day),A(e,u.PictureSingle.Month),A(e,u.PictureSingle.EngYearTh),!1);default:return(0,S.assertNever)("calc.numfmt.getKnownFormat",t)}}t.buildMMDDYYFormat=U,t.buildNumShapeConstFormat=function(e,t,r,a,o,s,l,c){const d=y.pictureNumberShape.indexOf(r)<<24|function(e){switch(e){case n.NumberShape.ArabicIndic:case n.NumberShape.ExtendedArabicIndic:return h.LCID.Arabic;case n.NumberShape.Devanagari:return h.LCID.Hindi;case n.NumberShape.Bengali:return 1093;case n.NumberShape.Gurmukhi:return 1094;case n.NumberShape.Gujarati:return 1095;case n.NumberShape.Oriya:return 1096;case n.NumberShape.Tamil:return h.LCID.Tamil;case n.NumberShape.Telugu:return 1098;case n.NumberShape.Kannada:return 1099;case n.NumberShape.Malayalam:return 1100;case n.NumberShape.Thai:return h.LCID.Thailand;case n.NumberShape.Lao:return 1108;case n.NumberShape.Tibetan:return 1105;case n.NumberShape.Myanmar:return 1109;case n.NumberShape.Ethiopic:return 1118;case n.NumberShape.Khmer:return 1107;case n.NumberShape.Mongolian:return 1104;case n.NumberShape.ASCII:case n.NumberShape.ChineseTrad1:case n.NumberShape.ChineseTrad2:case n.NumberShape.ChineseTrad3:case n.NumberShape.ChineseSimp1:case n.NumberShape.ChineseSimp2:case n.NumberShape.ChineseSimp3:case n.NumberShape.Japanese1:case n.NumberShape.Japanese2:case n.NumberShape.Japanese3:case n.NumberShape.Korean1:case n.NumberShape.Korean2:case n.NumberShape.Korean3:case n.NumberShape.Korean4:return 0;default:return(0,S.assertNever)("calc.numfmt.lcidFromNumShape",e)}}(r);let g=l;if((a||o)&&(g=2),g=(0,b.fastMin)(g,14),a){const t=w(e,u.PictureSingle.ColorStart,"$"+e.currencySymbol+"-"+d.toString(16).toUpperCase(),u.PictureSingle.ColorEnd);return D({...e,isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:i.CurrencyFormat.Paren},!0,2,!0,!1,t).replace(t,(()=>t+A(e,u.PictureSingle.Space)))}const m=w(e,u.PictureSingle.ColorStart,"$-"+d.toString(16).toUpperCase(),u.PictureSingle.ColorEnd);if(o)return m+R({...e,isPercentSepBySpace:!1},2);if(s)return m+T(e,!0,4,g);const p=t.formatGeneral(e,c,11),f=p.indexOf("E");if(f>=0){const t=p.substring(0,f),r=t.indexOf(e.decimalSeparator)>=0,n=t.replace(e.decimalSeparator,"").length,a=p.substring(f+2).length;return m+w(e,"0",g>0&&!r?"":u.PictureSingle.Decimal,(0,F.repeat)(A(e,u.PictureSingle.Hash),n-1),u.PictureSingle.E,g>0?"-":"+",(0,F.repeat)("0",a))}return m+w(e,"0",g>0?u.PictureSingle.Decimal:"",(0,F.repeat)(A(e,u.PictureSingle.Hash),g))},t.buildNumShapeDateTimeFormat=function(e,t,r){return w(e,u.PictureSingle.ColorStart,"$-"+(y.pictureNumberShape.indexOf(t)<<24).toString(16).toUpperCase(),u.PictureSingle.ColorEnd)+H(e,r)},t.getKnownFormat=H,t.isKnownFormatDefined=function(e,t){return e<=a.KnownFormat.General&&e>=a.KnownFormat.AcctDec||(e<=-1e3&&e>=-1099?t.isEastAsia:e<=-1100&&e>=-1199?t.isJapan:e<=-1200&&e>=-1299?t.isKorea:e<=-1300&&e>=-1399?t.isChinaT:e<=-1400&&e>=-1499?t.isChinaS:e<=-2e3&&e>=-2099?t.isThai:(0,f.assertFalse)("calc.numfmt.isKnownFormatDefined"))},t.englishXLSXKnownFormat={0:a.KnownFormat.General,1:a.KnownFormat.NoComFixed0,2:a.KnownFormat.NoComFixed,3:a.KnownFormat.Fixed0,4:a.KnownFormat.Fixed,5:a.KnownFormat.Currency,6:a.KnownFormat.CoCurrency,7:a.KnownFormat.CurrencyDec,8:a.KnownFormat.CoCurrencyDec,9:a.KnownFormat.Pct0,10:a.KnownFormat.Pct,11:a.KnownFormat.Exp,12:a.KnownFormat.Fract,13:a.KnownFormat.FractBond,14:a.KnownFormat.MMDDYY,15:a.KnownFormat.DDMMMYY,16:a.KnownFormat.DDMMM,17:a.KnownFormat.MMMYY,18:a.KnownFormat.HHMMAP,19:a.KnownFormat.HHMMSSAP,20:a.KnownFormat.HHMM,21:a.KnownFormat.HHMMSS,22:a.KnownFormat.MDYHMS,37:a.KnownFormat.Currency2,38:a.KnownFormat.CoCurrency2,39:a.KnownFormat.CurrencyDec2,40:a.KnownFormat.CoCurrencyDec2,41:a.KnownFormat.Acct,42:a.KnownFormat.AcctCur,43:a.KnownFormat.AcctDec,44:a.KnownFormat.AcctDecCur,45:a.KnownFormat.MMSS,46:a.KnownFormat.AbsHMMSS,47:a.KnownFormat.SS0,48:a.KnownFormat.Eng,49:a.KnownFormat.Text}},1944:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertKnownLCID=t.getBundledLocaleInfo=void 0;const n=r(6067),a=r(6366),i={ar:[["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],["الأحد","الإثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],["الأحد","الإثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],["ص","م"],"z"],en:[["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["AM","PM"],"z"],es:[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","set","oct.","nov.","dic."],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],["do.","lu.","ma.","mi.","ju.","vi.","sá."],["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],["a. m.","p. m."],"z"],fr:[["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],"en","z"],zh:[["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],["週日","週一","週二","週三","週四","週五","週六"],["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],["上午","下午"],"s"],de:[["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So","Mo","Di","Mi","Do","Fr","Sa"],["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],"en","z"],hr:[["sij","vlj","ožu","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],["siječanj","veljača","ožujak","travanj","svibanj","lipanj","srpanj","kolovoz","rujan","listopad","studeni","prosinac"],["ned","pon","uto","sri","čet","pet","sub"],["nedjelja","ponedjeljak","utorak","srijeda","četvrtak","petak","subota"],"en","z"],nl:[["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],["zo","ma","di","wo","do","vr","za"],["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],"en","z"],sv:[["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],["sön","mån","tis","ons","tor","fre","lör"],["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],"en","z"],it:[["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],["dom","lun","mar","mer","gio","ven","sab"],["domenica","lunedì","martedì","mercoledì","giovedì","venerdì","sabato"],"en","z"],ro:[["ian.","feb.","mar.","apr.","mai","iun.","iul.","aug.","sept.","oct.","nov.","dec."],["ianuarie","februarie","martie","aprilie","mai","iunie","iulie","august","septembrie","octombrie","noiembrie","decembrie"],["dum.","lun.","mar.","mie.","joi","vin.","sâm."],["duminică","luni","marți","miercuri","joi","vineri","sâmbătă"],["a.m.","p.m."],"z"],ru:[["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"],["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],"en","z"],sr:[["jan","feb","mar","apr","maj","jun","jul","avg","sep","okt","nov","dec"],["januar","februar","mart","april","maj","jun","jul","avgust","septembar","oktobar","novembar","decembar"],["ned","pon","uto","sre","čet","pet","sub"],["nedelja","ponedeljak","utorak","sreda","četvrtak","petak","subota"],["pre podne","po podne"],"z"],uk:[["Січ","Лют","Бер","Кві","Тра","Чер","Лип","Сер","Вер","Жов","Лис","Гру"],["січень","лютий","березень","квітень","травень","червень","липень","серпень","вересень","жовтень","листопад","грудень"],["Нд","Пн","Вт","Ср","Чт","Пт","Сб"],["неділя","понеділок","вівторок","середа","четвер","п'ятниця","субота"],"en","z"],bg:[["яну","фев","мар","апр","май","юни","юли","авг","сеп","окт","ное","дек"],["януари","февруари","март","април","май","юни","юли","август","септември","октомври","ноември","декември"],["нед","пон","вт","ср","четв","пет","съб"],["неделя","понеделник","вторник","сряда","четвъртък","петък","събота"],"en","z"],cs:[["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],["leden","únor","březen","duben","květen","červen","červenec","srpen","září","říjen","listopad","prosinec"],["ne","po","út","st","čt","pá","so"],["neděle","pondělí","úterý","středa","čtvrtek","pátek","sobota"],["dop.","odp."],"z"],da:["sv",["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],["sø","ma","ti","on","to","fr","lø"],["søndag","mandag","tirsdag","onsdag","torsdag","fredag","lørdag"],"sv","z"],el:[["Ιαν","Φεβ","Μαρ","Απρ","Μαϊ","Ιουν","Ιουλ","Αυγ","Σεπ","Οκτ","Νοε","Δεκ"],["Ιανουάριος","Φεβρουάριος","Μάρτιος","Απρίλιος","Μάιος","Ιούνιος","Ιούλιος","Αύγουστος","Σεπτέμβριος","Οκτώβριος","Νοέμβριος","Δεκέμβριος"],["Κυρ","Δευ","Τρι","Τετ","Πεμ","Παρ","Σαβ"],["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"],["πμ","μμ"],"z"],et:[["jaan","veebr","märts","apr","mai","juuni","juuli","aug","sept","okt","nov","dets"],["jaanuar","veebruar","märts","aprill","mai","juuni","juuli","august","september","oktoober","november","detsember"],["P","E","T","K","N","R","L"],["pühapäev","esmaspäev","teisipäev","kolmapäev","neljapäev","reede","laupäev"],"en","z"],fi:[["tammi","helmi","maalis","huhti","touko","kesä","heinä","elo","syys","loka","marras","joulu"],["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kesäkuu","heinäkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],["su","ma","ti","ke","to","pe","la"],["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],["ap.","ip."],"z"],he:[["ינו","פבר","מרץ","אפר","מאי","יונ","יול","אוג","ספט","אוק","נוב","דצמ"],["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],["יום א","יום ב","יום ג","יום ד","יום ה","יום ו","שבת"],["יום ראשון","יום שני","יום שלישי","יום רביעי","יום חמישי","יום שישי","שבת"],"en","z"],hu:[["jan.","febr.","márc.","ápr.","máj.","jún.","júl.","aug.","szept.","okt.","nov.","dec."],["január","február","március","április","május","június","július","augusztus","szeptember","október","november","december"],["V","H","K","Sze","Cs","P","Szo"],["vasárnap","hétfő","kedd","szerda","csütörtök","péntek","szombat"],["de.","du."],"z"],id:[["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],["Mgg","Sen","Sel","Rab","Kam","Jum","Sab"],["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],"en","z"],ja:[["1","2","3","4","5","6","7","8","9","10","11","12"],["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],["日","月","火","水","木","金","土"],["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],["午前","午後"],"j"],ko:["ja",["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],["일","월","화","수","목","금","토"],["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],["오전","오후"],"k"],lt:[["saus.","vas.","kov.","bal.","geg.","birž.","liep.","rugp.","rugs.","spal.","lapkr.","gruod."],["sausis","vasaris","kovas","balandis","gegužė","birželis","liepa","rugpjūtis","rugsėjis","spalis","lapkritis","gruodis"],["sk","pr","an","tr","kt","pn","št"],["sekmadienis","pirmadienis","antradienis","trečiadienis","ketvirtadienis","penktadienis","šeštadienis"],["priešpiet","popiet"],"z"],lv:[["janv.","febr.","marts","apr.","maijs","jūn.","jūl.","aug.","sept.","okt.","nov.","dec."],["janvāris","februāris","marts","aprīlis","maijs","jūnijs","jūlijs","augusts","septembris","oktobris","novembris","decembris"],["svētd.","pirmd.","otrd.","trešd.","ceturtd.","piektd.","sestd."],["svētdiena","pirmdiena","otrdiena","trešdiena","ceturtdiena","piektdiena","sestdiena"],["priekšp.","pēcp."],"z"],nb:[["jan","feb","mar","apr","mai","jun","jul","aug","sep","okt","nov","des"],["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],["søn","man","tir","ons","tor","fre","lør"],"da","ro","z"],pl:[["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],["niedz.","pon.","wt.","śr.","czw.","pt.","sob."],["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"],"en","z"],pt:[["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],["dom","seg","ter","qua","qui","sex","sáb"],["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"],"en","z"],sk:["ja",["január","február","marec","apríl","máj","jún","júl","august","september","október","november","december"],["ne","po","ut","st","št","pi","so"],["nedeľa","pondelok","utorok","streda","štvrtok","piatok","sobota"],"en","z"],sl:[["jan.","feb.","mar.","apr.","maj","jun.","jul.","avg.","sep.","okt.","nov.","dec."],["januar","februar","marec","april","maj","junij","julij","avgust","september","oktober","november","december"],["ned.","pon.","tor.","sre.","čet.","pet.","sob."],["nedelja","ponedeljek","torek","sreda","četrtek","petek","sobota"],["dop.","pop."],"z"],th:[["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."],["อาทิตย์","จันทร์","อังคาร","พุธ","พฤหัสบดี","ศุกร์","เสาร์"],"en","z"],tr:[["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"],["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],["Paz","Pzt","Sal","Çar","Per","Cum","Cmt"],["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],["ÖÖ","ÖS"],"z"],vi:[["Thg1","Thg2","Thg3","Thg4","Thg5","Thg6","Thg7","Thg8","Thg9","Thg10","Thg11","Thg12"],["Tháng Giêng","Tháng Hai","Tháng Ba","Tháng Tư","Tháng Năm","Tháng Sáu","Tháng Bảy","Tháng Tám","Tháng Chín","Tháng Mười","Tháng Mười Một","Tháng Mười Hai"],["CN","T2","T3","T4","T5","T6","T7"],["Chủ Nhật","Thứ Hai","Thứ Ba","Thứ Tư","Thứ Năm","Thứ Sáu","Thứ Bảy"],["SA","CH"],"z"],ta:[["ஜனவரி","பிப்ரவரி","மார்ச்","ஏப்ரல்","மே","ஜூன்","ஜூலை","ஆகஸ்ட்","செப்டம்பர்","அக்டோபர்","நவம்பர்","டிசம்பர்"],["ஜனவரி","பிப்ரவரி","மார்ச்","ஏப்ரல்","மே","ஜூன்","ஜூலை","ஆகஸ்ட்","செப்டம்பர்","அக்டோபர்","நவம்பர்","டிசம்பர்"],["ஞாயிறு","திங்கள்","செவ்வாய்","புதன்","வியாழன்","வெள்ளி","சனி"],["ஞாயிற்றுக்கிழமை","திங்கள்கிழமை","செவ்வாய்க்கிழமை","புதன்கிழமை","வியாழக்கிழமை","வெள்ளிக்கிழமை","சனிக்கிழமை"],["காலை","மாலை"],"z"],syr:[["܏ܟܢ ܏ܒ","ܫܒܛ","ܐܕܪ","ܢܝܣܢ","ܐܝܪ","ܚܙܝܪܢ","ܬܡܘܙ","ܐܒ","ܐܝܠܘܠ","܏ܬܫ ܏ܐ","܏ܬܫ ܏ܒ","܏ܟܢ ܏ܐ"],["ܟܢܘܢ ܐܚܪܝ","ܫܒܛ","ܐܕܪ","ܢܝܣܢ","ܐܝܪ","ܚܙܝܪܢ","ܬܡܘܙ","ܐܒ","ܐܝܠܘܠ","ܬܫܪܝ ܩܕܝܡ","ܬܫܪܝ ܐܚܪܝ","ܟܢܘܢ ܩܕܝܡ"],["܏ܐ ܏ܒܫ","܏ܒ ܏ܒܫ","܏ܓ ܏ܒܫ","܏ܕ ܏ܒܫ","܏ܗ ܏ܒܫ","܏ܥܪܘܒ","܏ܫܒ"],["ܚܕ ܒܫܒܐ","ܬܪܝܢ ܒܫܒܐ","ܬܠܬܐ ܒܫܒܐ","ܐܪܒܥܐ ܒܫܒܐ","ܚܡܫܐ ܒܫܒܐ","ܥܪܘܒܬܐ","ܫܒܬܐ"],["ܩ.ܛ","ܒ.ܛ"],"z"],eu:[["urt.","ots.","mar.","api.","mai.","eka.","uzt.","abu.","ira.","urr.","aza.","abe."],["urtarrila","otsaila","martxoa","apirila","maiatza","ekaina","uztaila","abuztua","iraila","urria","azaroa","abendua"],["ig.","al.","ar.","az.","og.","or.","lr."],["igandea","astelehena","asteartea","asteazkena","osteguna","ostirala","larunbata"],"en","z"],be:[["студз","лют","сак","крас","май","чэрв","ліп","жн","вер","кастр","ліст","снеж"],["студзень","люты","сакавік","красавік","май","чэрвень","ліпень","жнівень","верасень","кастрычнік","лістапад","снежань"],["нд","пн","аўт","ср","чц","пт","сб"],["нядзеля","панядзелак","аўторак","серада","чацвер","пятніца","субота"],"en","z"],dv:[["ޖަނަވަރީ","ފެބްރުއަރީ","މާރޗް","އޭޕްރިލް","މެއި","ޖޫން","ޖުލައި","އޮގަސްޓް","ސެޕްޓެމްބަރ","އޮކްޓޯބަރ","ނޮވެމްބަރ","ޑިސެމްބަރ"],["ޖަނަވަރީ","ފެބްރުއަރީ","މާރޗް","އޭޕްރިލް","މެއި","ޖޫން","ޖުލައި","އޮގަސްޓް","ސެޕްޓެމްބަރ","އޮކްޓޯބަރ","ނޮވެމްބަރ","ޑިސެމްބަރ"],["އާދީއްތަ","ހޯމަ","އަންގާރަ","ބުދަ","ބުރާސްފަތި","ހުކުރު","ހޮނިހިރު"],["އާދީއްތަ","ހޯމަ","އަންގާރަ","ބުދަ","ބުރާސްފަތި","ހުކުރު","ހޮނިހިރު"],["މކ","މފ"],"z"],hi:[["जनवरी","फरवरी","मार्च","अप्रैल","मई","जून","जुलाई","अगस्त","सितम्बर","अक्तूबर","नवम्बर","दिसम्बर"],["जनवरी","फरवरी","मार्च","अप्रैल","मई","जून","जुलाई","अगस्त","सितम्बर","अक्तूबर","नवम्बर","दिसम्बर"],["रवि.","सोम.","मंगल.","बुध.","गुरु.","शुक्र.","शनि."],["रविवार","सोमवार","मंगलवार","बुधवार","गुरुवार","शुक्रवार","शनिवार"],["पूर्वाह्न","अपराह्न"],"z"],fil:[["Ene","Peb","Mar","Abr","May","Hun","Hul","Ago","Set","Okt","Nob","Dis"],["Enero","Pebrero","Marso","Abril","Mayo","Hunyo","Hulyo","Agosto","Setyembre","Oktubre","Nobyembre","Disyembre"],["Lin","Lun","Mar","Miy","Huw","Biy","Sab"],["Linggo","Lunes","Martes","Miyerkules","Huwebes","Biyernes","Sabado"],"en","z"],ms:[["Jan","Feb","Mac","Apr","Mei","Jun","Jul","Ogo","Sep","Okt","Nov","Dis"],["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"],["Ahd","Isn","Sel","Rab","Kha","Jum","Sab"],["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu"],["PG","PTG"],"z"],"ar-SA":"ar","ar-IQ":[["كانون الثاني","شباط","آذار","نيسان","أيار","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],["كانون الثاني","شباط","آذار","نيسان","أيار","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],"ar","ar","ar","z"],"ar-DZ":"ar","ar-EG":"ar","en-US":"en","en-AU":"en","en-BZ":"en","en-CA":"en","en-029":"en","en-HK":"en","en-IN":"en","en-ID":"en","en-IE":"en","en-JM":"en","en-MY":"en","en-NZ":"en","en-PH":"en","en-SG":"en","en-ZA":"en","en-TT":"en","en-GB":"en","en-ZW":"en","en-AS":"en","en-KE":"en","en-KW":"en","en-NL":"en","en-CH":"en","en-001":"en","en-VU":"en","en-MX":"en","en-IO":"en","en-IL":"en","en-PK":"en","en-NG":"en","en-UK":"en","es-ES":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sep.","oct.","nov.","dic."],"es","es","es","en","z"],"es-AR":["es-ES","es",["dom.","lun.","mar.","mié.","jue.","vie.","sáb."],"es",["a. m.","p. m."],"z"],"es-BO":["es-ES","es","es-AR","es","es-AR","z"],"es-CL":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],"es","es-AR","es","es-AR","z"],"es-CO":["es-ES","es","es-AR","es","es-AR","z"],"es-CR":["es-ES","es","es-AR","es","es-AR","z"],"es-DO":["es-ES","es","es-AR","es","es-AR","z"],"es-EC":["es-ES","es","es-AR","es","es-AR","z"],"es-SV":["es-ES","es","es-AR","es","es-AR","z"],"es-GT":["es-ES","es","es-AR","es","es-AR","z"],"es-HN":["es-ES","es","es-AR","es","es-AR","z"],"es-419":["es-ES","es","es-AR","es","ro","z"],"es-MX":["es-ES","es","es-AR","es","es","z"],"es-NI":["es-ES","es","es-AR","es","es-AR","z"],"es-PA":["es-ES","es","es-AR","es","es-AR","z"],"es-PY":["es-CL","es","es-AR","es","es-CL","z"],"es-PE":[["Ene.","Feb.","Mar.","Abr.","May.","Jun.","Jul.","Ago.","Set.","Oct.","Nov.","Dic."],["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Setiembre","Octubre","Noviembre","Diciembre"],"es-AR","es","es-AR","z"],"es-PR":["es-ES","es","es-AR","es","es-AR","z"],"es-ES_tradnl":["es-ES","es","es","es","es-ES","z"],"es-US":[["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],"es",["dom","lun","mar","mié","jue","vie","sáb"],"es","en","z"],"es-UY":["es","es-PE","es-AR","es","es-AR","z"],"es-VE":["es-CL","es","es-AR","es","es-CL","z"],"es-CU":["es-ES","es","es-AR","es","ro","z"],"fr-FR":"fr","fr-BE":"fr","fr-CM":["fr","fr","fr","fr",["mat.","soir"],"z"],"fr-CA":"fr","fr-029":"fr","fr-CD":"fr","fr-CI":"fr","fr-HT":"fr","fr-LU":"fr","fr-ML":"fr","fr-MC":"fr","fr-MA":[["jan.","fév.","mar.","avr.","mai","jui.","juil.","août","sept.","oct.","nov.","déc."],"fr","fr","fr","en","z"],"fr-RE":"fr","fr-SN":"fr","fr-CH":"fr","zh-CN":["zh","zh",["周日","周一","周二","周三","周四","周五","周六"],"zh","zh","s"],"zh-SG":[["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],"zh","zh-CN","zh","zh","s"],"zh-HK":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-MO":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-TW":["zh-SG","zh","zh","zh","zh-SG","t"],"de-DE":"de","de-AT":[["Jän","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Jänner","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],"de","en","z"],"de-LI":[["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],"de","de-AT","de","en","z"],"de-LU":["de-LI","de","de-AT","de","de-LI","z"],"de-CH":["de-LI","de","de-AT","de","de-LI","z"],"hr-HR":"hr","hr-BA":[["sij","velj","ožu","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],"hr","hr","hr","en","z"],"nl-NL":"nl","nl-BE":"nl","sv-SE":"sv","sv-FI":[["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],"sv","sv","sv",["fm","em"],"z"],"it-IT":"it","it-CH":"it","ro-RO":"ro","ro-MD":["ro","ro",["Du","Lu","Mar","Mie","Jo","Vi","Sâ"],"ro","ro","z"],"ru-RU":"ru","ru-MD-x-genlower":[["янв.","февр.","март","апр.","май","июнь","июль","авг.","сент.","окт.","нояб.","дек."],["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],"ru","ru","en","z"],"sr-Latn-RS":"sr","sr-Latn-BA":[["jan","feb","mart","apr","maj","jun","jul","avg","sept","okt","nov","dec"],"sr","hr","hr",["prije podne","po podne"],"z"],"sr-Latn-CS":[["jan.","feb.","mart","apr.","maj","jun","jul","avg.","sept.","okt.","nov.","dec."],"sr",["ned.","pon.","uto.","sre.","čet.","pet.","sub."],"sr","en","z"],"uk-UA-x-genlower":["uk",["січня","лютого","березня","квітня","травня","червня","липня","серпня","вересня","жовтня","листопада","грудня"],"uk","uk","uk","z"],"uk-UA":"uk","bg-BG":"bg","cs-CZ":"cs","da-DK":["sv","da","da","da","sv","z"],"el-GR":"el","et-EE":"et","fi-FI":"fi","he-IL":"he","hu-HU":"hu","id-ID":"id","ja-JP":"ja","ko-KR":["ja","ko","ko","ko","ko","k"],"lt-LT":"lt","lv-LV":"lv","nb-NO":["nb","nb","nb","da","nb","z"],"pl-PL":"pl","pt-BR":"pt","pt-PT":"pt","sk-SK":["ja","sk","sk","sk","en","z"],"sl-SI":"sl","th-TH":"th","tr-TR":"tr","vi-VN":"vi","ta-IN":"ta","syr-SY":"syr","eu-ES":"eu","be-BY-x-genlower":["be",["студзеня","лютага","сакавіка","красавіка","мая","чэрвеня","ліпеня","жніўня","верасня","кастрычніка","лістапада","снежня"],"be","be","be","z"],"be-BY":"be","dv-MV":"dv","hi-IN":"hi","fil-PH":"fil","ms-MY":"ms"};let o;t.getBundledLocaleInfo=function({culture:e,tag:t}){if("number"==typeof e)return;let r=e;return void 0!==t&&(""!==e&&(r+="-"),r+="x-"+String(t)),void 0===o&&(o=function(){const e={},t=["monthNameShort","monthNameLong","dayNameShort","dayNameLong","ampmSymbols"];for(const r of Object.keys(i)){const n=i[r];if("string"==typeof n){const t=e[n];(0,a.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture",void 0!==t),e[r]=t;continue}const[o,s,u,l,c]=n.slice(0,5).map(((r,n)=>{if("string"==typeof r){const i=e[r];return(0,a.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture 2",void 0!==i),i[t[n]]}return r})),d=n[5],g="k"===d,m="j"===d,h="t"===d,p="s"===d,f=g||m||h||p;e[r]={monthNameShort:o,monthNameLong:s,dayNameShort:u,dayNameLong:l,ampmSymbols:c,isEastAsia:f,isKorea:g,isJapan:m,isChinaT:h,isChinaS:p}}return e}()),o[r]};const s={[n.LCID.USA]:"en-US",[n.LCID.Greek]:"el-GR",[n.LCID.Hungarian]:"hu-HU",[n.LCID.Turkish]:"tr-TR",[n.LCID.Thailand]:"th-TH",[n.LCID.Vietnam]:"vi-VN",[n.LCID.Arabic]:"ar-SA",[n.LCID.Hebrew]:"he-IL",[n.LCID.Tamil]:"ta-IN",[n.LCID.Syriac]:"syr-SY",[n.LCID.Iraq]:"ar-IQ",[n.LCID.Algerian]:"ar-DZ",[n.LCID.Basque]:"eu-ES",[n.LCID.PortBrazil]:"pt-BR",[n.LCID.Croatian]:"hr-HR",[n.LCID.Czech]:"cs-CZ",[n.LCID.Danish]:"da-DK",[n.LCID.Dutch]:"nl-NL",[n.LCID.Australian]:"en-AU",[n.LCID.CanadianEnglish]:"en-CA",[n.LCID.British]:"en-GB",[n.LCID.Finnish]:"fi-FI",[n.LCID.French]:"fr-FR",[n.LCID.FrenchCanadian]:"fr-CA",[n.LCID.Italian]:"it-IT",[n.LCID.NorskBokmal]:"nb-NO",[n.LCID.NorskNynorsk]:"nn-NO",[n.LCID.Polish]:"pl-PL",[n.LCID.PortIberian]:"pt-PT",[n.LCID.Romanian]:"ro-RO",[n.LCID.Russian]:"ru-RU",[n.LCID.Ukrainian]:"uk-UA",[n.LCID.Belarusian]:"be-BY",[n.LCID.SerbianCyrillic]:"sr-Cyrl-CS",[n.LCID.SerbianLatin]:"sr-Latn-CS",[n.LCID.Slovak]:"sk-SK",[n.LCID.Slovenian]:"sl-SI",[n.LCID.SpanishModern]:"es-ES",[n.LCID.Swedish]:"sv-SE",[n.LCID.HongKong]:"zh-HK",[n.LCID.ChinaT]:"zh-TW",[n.LCID.Korea]:"ko-KR",[n.LCID.Japan]:"ja-JP",[n.LCID.China]:"zh-CN",[n.LCID.Devihi]:"dv-MV",[n.LCID.Hindi]:"hi-IN",[n.LCID.German]:"de-DE",[n.LCID.Swiss]:"fr-CH",[n.LCID.Indonesia]:"id-ID",[n.LCID.EnglishIndonesia]:"en-ID",[n.LCID.EnglishIndia]:"en-IN",[n.LCID.Singapore]:"zh-SG",[n.LCID.EnglishSingapore]:"en-SG",[n.LCID.Serbia]:"sr-RS",[n.LCID.Mexico]:"es-MX",[n.LCID.Ireland]:"en-IE",[n.LCID.EnglishZimbabwe]:"en-ZW",[n.LCID.Belgium]:"nl-BE"};t.convertKnownLCID=function(e){return"string"==typeof e?e:s[e]??e}},3340:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDate=t.parseGeneral=void 0;const n=r(6824),a=r(7843),i=r(6366),o=r(6366),s=r(6366);t.parseGeneral=function(e,t,r,u,l){try{const{localeInfo:o,mathpack:s}=e.config,c=(0,n.parseConstInternal)(o,s,t,r,u,!1);return(0,i.isSuccess)(c)?void 0!==c.value?c:(0,a.parseDateInternal)((0,a.initParseDateGlobals)(e),t,void 0,l):c}catch(e){return(0,o.failure)((0,s.javaScriptError)(e))}},t.parseDate=function(e,t,r){try{return(0,a.parseDateInternal)((0,a.initParseDateGlobals)(e),t,void 0,r)}catch(e){return(0,o.failure)((0,s.javaScriptError)(e))}}},6824:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseConstInternal=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(9992),u=r(6366),l=r(6366),c=r(6366),{codePointDollarSign:d,codePointBackslash:g,codePointPercentSign:m,codePointSpace:h,codePointLeftParen:p,codePointMinusSign:f,codePointPlusSign:S,codePointRightParen:v}=u.codePoint;var F,y;function b(e,t,r,n){if(" "===t||""===t)return;const a="$"===t;if(e.isEastAsia){if(n<r.length&&r.charCodeAt(n)===d&&!a)return{currency:F.DollarUS,i:n+1};if(n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"US$"))return{currency:e.isChinaT?F.DollarUS:F.DollarExtra,i:n+3};if(("¥"===t&&e.isJapan||"₩"===t&&e.isKorea)&&n<r.length&&r.charCodeAt(n)===g)return{currency:F.Default,i:n+1};if(e.isChinaT&&n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"NT$"))return{currency:F.DollarExtra,i:n+3}}return n+t.length<=r.length&&0===e.stringCompareCI(r.substring(n,n+t.length),t)?{currency:F.Default,i:n+t.length}:void 0}function C(e,t,r,u,c,d){let g,C=0,A=!1,E=!1,T=!1,{isCurrencySymbolLead:R,currencySymbol:k}=e;c!==y.None&&(R=c===y.Lead,k="€");let N=0;for(;N<r.length;){if(void 0===g&&R){const t=b(e,k,r,N);if(void 0!==t){({currency:g,i:N}=t);continue}}const t=r.charCodeAt(N);switch(t){case m:N+=1,C+=1;continue;case h:N+=1;continue;case p:case f:case S:if(N+=1,E)return(0,l.success)(void 0);E=!0,t===p&&(A=!0),T=t!==S;continue}break}const I=(0,n.parseNumberLiteral)(e,t,r,N,!0,C>0||u,d);if(void 0===I||void 0===I.value)return(0,l.success)(void 0);N=I.i;const O=T?t.neg(I.value):I.value;for(;N<r.length;){if(void 0===g&&!R){const t=b(e,k,r,N);if(void 0!==t){({currency:g,i:N}=t);continue}}switch(r.charCodeAt(N)){case m:N+=1,C+=1;continue;case h:N+=1;continue;case v:if(N+=1,!A)return(0,l.success)(void 0);A=!1;continue}break}if(N!==r.length||A||C>1||void 0!==g&&C>0)return(0,l.success)(void 0);let P,M=I.numDigDec;if(I.consumedDecimal&&M<e.numberDecimals&&(I.consumedThousands||C>0?M=e.numberDecimals:void 0!==g&&(M=e.currencyDecimals)),void 0!==I.format)P=I.format;else if(g===F.DollarUS)P=I.consumedDecimal?i.KnownFormat.USCoCurrencyDec:i.KnownFormat.USCoCurrency;else if(g===F.DollarExtra)P=(0,s.buildCurrencyFormat)({...e,isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:a.CurrencyFormat.Paren},!1,I.consumedDecimal?2:0,!0,!1,e.isChinaT?(0,s.buildQuoted)(e,"NT$"):(0,s.buildQuoted)(e,"US$"));else if(I.numShape===o.NumberShape.Thai&&e.isThai)P=void 0!==g?I.consumedDecimal?i.KnownFormat.CoCurrencyDec_Tha:i.KnownFormat.CoCurrency_Tha:C>0?I.consumedDecimal?i.KnownFormat.Pct_Tha:i.KnownFormat.Pct0_Tha:I.consumedThousands?I.consumedDecimal?i.KnownFormat.Fixed_Tha:i.KnownFormat.Fixed0_Tha:I.consumedDecimal?i.KnownFormat.NoComFixed_Tha:i.KnownFormat.NoComFixed0_Tha;else if(I.numShape!==o.NumberShape.ASCII)P=(0,s.buildNumShapeConstFormat)(e,t,I.numShape,void 0!==g,C>0,I.consumedThousands,M,O);else if(void 0!==g)switch(c){case y.None:P=I.consumedDecimal?i.KnownFormat.CoCurrencyDec:i.KnownFormat.CoCurrency;break;case y.Lead:P=(0,s.buildCurrencyFormat)({...e,isCurrencySymbolLead:!0,isCurrencySepBySpace:!0,currencyFormat:a.CurrencyFormat.Lead},!0,I.consumedDecimal?2:0,!0,!1,"[$€-x-euro2]");break;case y.Trail:P=(0,s.buildCurrencyFormat)({...e,isCurrencySymbolLead:!1,isCurrencySepBySpace:!0,currencyFormat:a.CurrencyFormat.Lead},!0,I.consumedDecimal?2:0,!0,!1,"[$€-x-euro1]")}else P=C>0?I.consumedDecimal?i.KnownFormat.Pct:i.KnownFormat.Pct0:I.consumedThousands?I.consumedDecimal?i.KnownFormat.Fixed:i.KnownFormat.Fixed0:i.KnownFormat.General;return(0,l.success)({value:O,format:P})}!function(e){e[e.Default=0]="Default",e[e.DollarUS=1]="DollarUS",e[e.DollarExtra=2]="DollarExtra"}(F||(F={})),function(e){e[e.None=0]="None",e[e.Lead=1]="Lead",e[e.Trail=2]="Trail"}(y||(y={})),t.parseConstInternal=function(e,t,r,n,a,i){if(!a)return C(e,t,r,n,y.None,i);for(let a=y.None;a<=y.Trail;a+=1){const o=C(e,t,r,n,a,i);if(!(0,c.isSuccess)(o))return o;if(void 0!==o.value)return o;if(a===y.None&&r.indexOf("€")<0)break}return(0,l.success)(void 0)}},7843:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDateInternal=t.initParseDateGlobals=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6442),s=r(6366),u=r(6067),l=r(6067),c=r(6366),d=r(6366),g=r(6366),m=r(6366),h=r(6067),p=r(6366),f=r(6366),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(6067),E=r(6366),T=r(6366),R=r(6366),k=r(6366),N=r(6366),I=r(9992),{codePointSlash:O,codePointSpace:P,codePointMinusSign:M,codePointColon:D}=m.codePoint,w={getTime:()=>(0,p.assertFalse)("calc.numfmt.parseDateInternal: default getTime")};var L;function _(e,t){return(0,f.assertTrue)("calc.numfmt.monthToken",Z(e,1,12)),{kind:L.Month,value:e,bidiDate:t}}t.initParseDateGlobals=function(e){return{config:e.config,getTime:e.getTime?.bind(e)??w.getTime}},function(e){e[e.Month=0]="Month",e[e.AMPM=1]="AMPM",e[e.Number=2]="Number"}(L||(L={}));const x=[...new Array(12)].map(((e,t)=>_(t+1))),K=e=>x[e],W=e=>_(e+1,o.BidiDate.English),U=e=>_(e+1,o.BidiDate.Lunar),[G,B]=[!0,!1].map((e=>({kind:L.AMPM,am:e}))),V=e=>0===e?G:B;function j(e,t,r){return(0,f.assertTrue)("calc.numfmt.numberToken",(0,T.isInteger)(e)&&Z(e,-9999,9999)&&Z(t,1,4)),{kind:L.Number,value:e,digits:t,numShape:r}}var H;!function(e){e[e.Nil=0]="Nil",e[e.Space=1]="Space",e[e.Date=2]="Date",e[e.Time=3]="Time",e[e.TimeAlt=4]="TimeAlt",e[e.FracSec=5]="FracSec",e[e.Intl1St3=6]="Intl1St3"}(H||(H={}));const q=e=>e===H.Time||e===H.TimeAlt,z=(e,t)=>e.lcid===i.LCID.Hungarian&&t===H.Date,Q=e=>e<=H.Space,$=e=>e<=H.Date,Y=["上午","下午"],J={[n.Country.FRN]:[["Jun",_(6)],["Jul",_(7)]],[n.Country.DUT]:[["Mrt",_(3)]],[n.Country.GER]:[["Mrz",_(3)]]},X=["محرم","صفر","ربيع الاول","ربيع الثاني","جمادى الاولى","جمادى الثانية","رجب","شعبان","رمضان","شوال","ذو القعدة","ذو الحجة"];function Z(e,t,r){return e>=t&&e<=r}function ee(e,t){const r=e.getTime(A.TimeGranularity.Year,t);if(!(0,k.isSuccess)(r))return r;const n=e.config,a=n.datepack.fromNum(n,r.value,y.Rounding.RoundSec);return(0,f.assertTrue)("calc.numfmt.parseDateInternal: current year fromNum",!1!==a),(0,N.success)(a.yr)}function te(e,t,r,n){return n+t.length<=r.length&&0===e.stringCompareCI(t,r.substring(n,n+t.length))}function re(e,t,r,n,a,i){const o=t.indexOf(" ",r);for(let u=0;u<n.length;u+=1){const l=n[u],c=(0,s.fastMin)(a,l.length);if(o>=0&&l.indexOf(" ")<0&&o-r>=c&&o-r<=l.length){const n=l.substring(0,o-r);if(te(e,n,t,r))return[i(u),r+n.length]}let d;for(let n=c;n<=l.length;n+=1){const a=l.substring(0,n);if(!te(e,a,t,r))break;d=r+a.length}if(void 0!==d)return[i(u),d]}}function ne(e,t,r,n,a){for(let i=0;i<n.length;i+=1){const o=n[i];if(te(e,o,t,r))return[a(i),r+o.length]}}function ae(e,t,r){const n=J[e.country];if(void 0!==n)for(const[a,i]of n)if(te(e,a,t,r))return[i,r+a.length];let o;if(e.isEastAsia){if(o=re(e,t,r,(0,a.getEnglishLocaleInfo)().monthNameLong,3,K),void 0!==o)return o}else if(e.isComplexScript){if(o=ne(e,t,r,e.monthNameLong,K),void 0!==o)return o;if(o=ne(e,t,r,e.monthNameShort,K),void 0!==o)return o;if(o=ne(e,t,r,(0,a.getEnglishLocaleInfo)().monthNameLong,W),void 0!==o)return o;if(o=ne(e,t,r,(0,a.getEnglishLocaleInfo)().monthNameShort,W),void 0!==o)return o}else if(o=re(e,t,r,e.monthNameLong,3,K),void 0!==o)return o;return(e.lcid&i.LCID.LANG)==(i.LCID.Arabic&i.LCID.LANG)&&(o=ne(e,t,r,X,U),void 0!==o)?o:(o=re(e,t,r,e.ampmSymbols,1,V),void 0!==o?o:(o=re(e,t,r,(0,a.getEnglishLocaleInfo)().ampmSymbols,1,V),void 0!==o||(e.isChinaS||e.isChinaT)&&(o=re(e,t,r,Y,1,V),void 0!==o)?o:[void 0,r]))}function ie(e,t,r,n){let a=r;const i=t.charCodeAt(a)===M;let o,s,u;if(i&&(a+=1),n===H.FracSec){if([o,s]=(0,h.parseUint)(e,4,a+4<t.length?t.substring(0,a+4):t,a),u=s-a,(0,f.assertTrue)("calc.numfmt.parseDateInternal: 0 < digits <= 4",Z(u,1,4)),4===u){let r;for(;s<t.length&&e.isNumeral(r=(0,c.stringCodePointAt)(t,s));)s+=(0,d.numCodeUnits)(r);o=Math.round(o/10),u=3}}else if([o,s]=(0,h.parseUint)(e,4,t,a),u=s-a,u>4||u>2&&o<100)return[void 0,r];if(0===u)return[void 0,r];const l=function(e,t){let r=F.NumberShape.ASCII;for(const n of(0,g.codePointIterator)(t)){const t=e.getNumberShape(n);t!==F.NumberShape.ASCII&&(r=t)}return r}(e,t.substring(a,s));return a=s,[j(i?-o:o,u,l),a]}function oe(e,t,r,n){let a=H.Nil,i=r;if(t.charCodeAt(i)===P)for(a=H.Space;t.charCodeAt(i)===P;)i+=1;return null!=e.timeAltSeparator&&e.timeAltSeparator!==e.timeSeparator&&n===H.Time&&(0,E.stringStartsWith)(t,e.timeAltSeparator,i)?(a=H.TimeAlt,i+=e.timeAltSeparator.length):(0,E.stringStartsWith)(t,e.dateSeparator,i)?(a=H.Date,i+=e.dateSeparator.length):(0,E.stringStartsWith)(t,e.timeSeparator,i)?(a=H.Time,i+=e.timeSeparator.length):(0,E.stringStartsWith)(t,e.decimalSeparator,i)&&n===H.Time?(a=H.FracSec,i+=e.decimalSeparator.length):t.charCodeAt(i)===O||t.charCodeAt(i)===M?(a=H.Date,i+=1):t.charCodeAt(i)===D?(a=H.Time,i+=1):(0,E.stringStartsWith)(t,", ",i)&&(a=H.Intl1St3,i+=2),a===H.Space&&(" "===e.dateSeparator?a=H.Date:" "===e.timeSeparator?a=H.Time:" "===e.decimalSeparator&&n===H.Time&&(a=H.FracSec)),[a,i]}function se(e,t,r,n){return t===F.NumberShape.ASCII?r:t!==F.NumberShape.Lao&&t!==F.NumberShape.Thai||!e.isThai?(0,I.buildNumShapeDateTimeFormat)(e,t,r):n}t.parseDateInternal=function(e,t,r,n){const{config:a}=e,{localeInfo:i}=a;if(!i.isEastAsia&&!function(e,t){for(const r of(0,g.codePointIterator)(t))if(e.isNumeral(r))return!0;return!1}(i,t))return(0,N.success)(void 0);if(i.isEastAsia)return(0,R.failure)((0,u.notImplemented)(["parse East Asia date"]));if(i.isThai){let e=t.indexOf("b");if(e<0&&(e=t.indexOf("B")),e>=0&&e+1<t.length&&i.isNumeral((0,c.stringCodePointAt)(t,e+1)))return(0,R.failure)((0,u.notImplemented)(["parse Thai Buddhist date"]))}const s=function(e,t,r){const{localeInfo:n,dateCompatibility:a}=e,i=[];let o=r?.bidiDate,s=F.NumberShape.ASCII;const l=r?.culture;let d,g=!1,m=!1;for(let e=0;e<t.length;){if(i.length>=9)return(0,N.success)(void 0);let r;if(n.isNumeral((0,c.stringCodePointAt)(t,e))||!a&&e+1<t.length&&t.charCodeAt(e)===M&&n.isNumeral((0,c.stringCodePointAt)(t,e+1))){const[a,i]=ie(n,t,e,d);if(void 0===a)return(0,N.success)(void 0);e=i,a.numShape!==F.NumberShape.ASCII&&(s=a.numShape),r=a}else{if(t.charCodeAt(e)===P)return(0,R.failure)((0,u.notImplemented)(["absurd date/time string with leading space"]));{const[a,s]=ae(n,t,e);if(void 0===a)return(0,N.success)(void 0);if(e=s,a.kind===L.Month){if(g)return(0,N.success)(void 0);g=!0,void 0!==a.bidiDate&&(o=a.bidiDate)}if(a.kind===L.AMPM){if(m)return(0,N.success)(void 0);if(m=!0,0===i.length||i[i.length-1].sep!==H.Space)return(0,N.success)(void 0);d=i[i.length-1].sep=H.Time}r=a}}const[l,h]=oe(n,t,e,d);for(e=h;e<t.length&&t.charCodeAt(e)===P;)e+=1;i.push({tok:r,sep:l}),d=l}return(0,f.assertTrue)("calc.numfmt.parseDateInternal: > 0 tokens",0!==i.length),(0,N.success)({tokens:i,bidiDate:o,numShape:s,culture:l})}(a,t,r);if(!(0,k.isSuccess)(s)||void 0===s.value)return s;const{tokens:d,bidiDate:m,numShape:h,culture:A}=s.value;if(m===o.BidiDate.Lunar)return(0,R.failure)((0,u.notImplemented)(["Lunar calendar"]));if(void 0!==A&&(A.localCalendarInput||A.tag===o.CultureTag.Gannen))return(0,R.failure)((0,u.notImplemented)(["parse date: possible local calendar"]));const E=function(e,t){const{localeInfo:r}=e;let n,a,i,o,s,l,c;for(let e=0;e<t.length;e+=1)if(q(t[e].sep)){n={start:e,end:e+1};break}if(void 0!==n){if(0!==n.start&&t[n.start-1].sep!==H.Space&&!z(r,t[n.start-1].sep))return(0,N.success)(void 0);for(;n.end<t.length&&q(t[n.end-1].sep);)n.end+=1;if(n.end<t.length&&t[n.end-1].sep===H.FracSec){n.end+=1;const e=t[n.end-1];if(e.tok.kind!==L.Number)return(0,N.success)(void 0);if(e.tok,l=e,n.end<t.length&&q(t[n.end-1].sep)){n.end+=1;const e=t[n.end-1];if(e.tok.kind!==L.AMPM)return(0,R.failure)((0,u.notImplemented)(["non-AM/PM after FracSec"]));e.tok,c=e}}else{const e=t[n.end-1];e.tok.kind===L.AMPM&&(e.tok,c=e)}const e=n.end-n.start-(void 0!==l?1:0)-(void 0!==c?1:0);for(let r=0;r<e;r+=1)if(t[n.start+r].tok.kind!==L.Number)return(0,R.failure)((0,u.notImplemented)(["non-number in H/M/S component"]));switch(e){case 0:return(0,p.assertFalse)("calc.numfmt.parseDateInternal: 0 time");case 1:(0,f.assertTrue)("calc.numfmt.parseDateInternal: 1 time => !fracSec",void 0===l),i=t[n.start];break;case 2:void 0===l?(i=t[n.start],o=t[n.start+1]):(o=t[n.start],s=t[n.start+1]);break;case 3:i=t[n.start],o=t[n.start+1],s=t[n.start+2];break;default:return(0,N.success)(void 0)}for(let e=n.end;e<t.length;e+=1)if(q(t[e].sep))return(0,N.success)(void 0);if(n.end===t.length){const e=t[n.end-1].sep;if(!(Q(e)||void 0!==c&&e===H.FracSec))return(0,R.failure)((0,u.notImplemented)(["trailing sep after time"]))}else{const e=t[n.end-1].sep;if(!Q(e)&&e!==H.Intl1St3)return(0,R.failure)((0,u.notImplemented)(["unexpected sep between time and date"]))}if(0===n.start)n.end!==t.length&&(a={start:n.end,end:t.length});else{if(n.end!==t.length)return(0,R.failure)((0,u.notImplemented)(["date part split around time part"]));a={start:0,end:n.start}}}else a={start:0,end:t.length};return(0,N.success)({time:n,date:a,hour:i,min:o,sec:s,fracSec:l,ampm:c})}(a,d);if(!(0,k.isSuccess)(E)||void 0===E.value)return E;const{time:T,date:I,hour:O,min:D,sec:w,fracSec:_,ampm:x}=E.value,K=function(e,t,r,n){const{config:a}=e,{localeInfo:i,dateCompatibility:o,datepack:s}=a;let l,c,d,g=!1;if(void 0!==n){const e=n.end-n.start;if(e<2||e>3)return(0,N.success)(void 0);const{tok:t,sep:a}=r[n.start],{tok:s,sep:m}=r[n.start+1],{tok:h,sep:p}=r[n.end-1];if((0,f.assertTrue)("calc.numfmt.parseDateInternal: all not AM/PM",t.kind!==L.AMPM&&s.kind!==L.AMPM&&h.kind!==L.AMPM),!Q(p)&&!z(i,p))return(0,N.success)(void 0);const v=void 0!==function(e,t){for(let r=t.start;r<t.end;r+=1)if(e[r].tok.kind===L.Month)return r}(r,n);if(g=v,v)if($(a)&&$(m))if(t.kind===L.Month){if(e>2)return(0,N.success)(void 0);c=t,(0,f.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",h.kind!==L.Month),l=h}else{if(s.kind!==L.Month)return(0,N.success)(void 0);d=t,c=s,3===e&&((0,f.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",h.kind!==L.Month),l=h)}else{if(3!==e)return(0,N.success)(void 0);if(Q(m))return(0,N.success)(void 0);const r=i.longDateFormat?t:s,n=i.longDateFormat?s:t;if(r.kind!==L.Month)return(0,N.success)(void 0);(0,f.assertTrue)("calc.numfmt.parseDateInternal: Int1 dom & yr not Month",n.kind!==L.Month&&h.kind!==L.Month),d=n,c=r,l=h}else if((0,f.assertTrue)("calc.numfmt.parseDateInternal: all not Month",t.kind!==L.Month&&s.kind!==L.Month&&h.kind!==L.Month),2===e&&a===H.Date)switch(g=!0,i.dateOrder){case S.DateOrder.MDY:c=t,l=h;break;case S.DateOrder.YMD:Z(t.value,1,12)?(c=t,d=h):(l=t,c=h);break;case S.DateOrder.DMY:Z(h.value,1,12)?(d=t,c=h):(c=t,l=h);break;default:return(0,R.failure)((0,u.notImplemented)(["date parse date order"]))}else{if(e<3||a!==H.Date||m!==H.Date)return(0,N.success)(void 0);switch(t.value>999||!o&&t.value>99?S.DateOrder.YMD:i.dateOrder){case S.DateOrder.MDY:c=t,d=s,l=h;break;case S.DateOrder.YMD:l=t,c=s,d=h;break;case S.DateOrder.DMY:d=t,c=s,l=h;break;default:return(0,R.failure)((0,u.notImplemented)(["date parse date order"]))}}}let m=!1;if(i.dateOrder!==S.DateOrder.DMY&&void 0===d&&void 0!==c&&Z(c.value,1,12)&&void 0!==l&&Z(l.value,1,31)){const r=ee(e,t);if(!(0,k.isSuccess)(r))return r;l.value<=s.daysPerMonth(c.value,r.value,o)&&(d=l,l=j(r.value,4,F.NumberShape.ASCII),m=!0)}return(0,N.success)({yr:l,mon:c,dom:d,useMonthName:g,usingCurrentYear:m})}(e,n,d,I);if(!(0,k.isSuccess)(K)||void 0===K.value)return K;const{yr:W,mon:U,dom:G,useMonthName:B,usingCurrentYear:V}=K.value,Y=function(e,t,r,n,a,i,o,s,c,d){const{config:g}=e,{mathpack:m,datepack:h,dateCompatibility:p}=g;let S,v,F;if(void 0!==n||void 0!==a||void 0!==r){if((0,f.assertTrue)("calc.numfmt.parseDateInternal: dom || yr",void 0!==a||void 0!==r),(0,f.assertTrue)("calc.numfmt.parseDateInternal: mon",void 0!==n),v=n.value,!Z(v,1,12))return(0,N.success)(void 0);if(void 0===r){const r=ee(e,t);if(!(0,k.isSuccess)(r))return r;S=r.value}else S=Z(r.value,0,99)?function(e){return 1900+(e<30?100:0)+e}(r.value):r.value;if(!Z(S,1900,9999))return(0,N.success)(void 0);if(F=a?.value??1,!Z(F,1,h.daysPerMonth(v,S,p)))return(0,N.success)(void 0)}else{const e=h.fromNum(g,m.zero,y.Rounding.RoundSec);(0,f.assertTrue)("calc.numfmt.parseDateInternal: zeroDtr fromNum",!1!==e),({yr:S,mon:v,dom:F}=e)}let A,E=0,T=0,I=0,O=0,P=y.Rounding.RoundSec,M=0;if(void 0!==i){if(i.value<0)return(0,R.failure)((0,u.notImplemented)(["negative hour"]));if(i.value>23){if(void 0!==A)return(0,N.success)(void 0);M=i.value,A=b.TimeDivision.Hour}else E=i.value}if(void 0!==o){if(o.value<0)return(0,R.failure)((0,u.notImplemented)(["negative minute"]));if(o.value>59){if(void 0!==A)return(0,N.success)(void 0);M=o.value,A=b.TimeDivision.Minute}else T=o.value}if(void 0!==s){if(s.value<0)return(0,R.failure)((0,u.notImplemented)(["negative second"]));if(s.value>59){if(void 0!==A)return(0,N.success)(void 0);M=s.value,A=b.TimeDivision.Second}else I=s.value}if(void 0!==c){if(c.value<0)return(0,R.failure)((0,u.notImplemented)(["negative fractional second"]));(0,f.assertTrue)("calc.numfmt.parseDateInternal: fracSec.digits",c.digits>=1&&c.digits<=3),P=c.digits,(0,f.assertTrue)("calc.numfmt.parseDateInternal: fracSec.value",c.value<(3===P?1001:2===P?100:10)),O=c.value}if(void 0!==d){if(void 0!==A||E>12)return(0,N.success)(void 0);d.am?12===E&&(E=0):E<12&&(E+=12)}const D=(0,C.dateTime)(S,v,F,E,T,I,1,O,P),w=void 0!==A?h.toNumWithDuration(g,D,A,M):h.toNum(g,D);return(0,l.isErrorOper)(w)?(0,N.success)(void 0):(0,N.success)({value:w,duration:A})}(e,n,W,U,G,O?.tok,D?.tok,w?.tok,_?.tok,x?.tok);if(!(0,k.isSuccess)(Y)||void 0===Y.value)return Y;const{value:J,duration:X}=Y.value,te=function(e,t,r,n,a,i,o,s,l,c,d,g,m){if(s)return l?.sep===H.TimeAlt?(0,N.success)(e.sysTimeFormat):void 0!==d?(0,N.success)(se(e,t,v.KnownFormat.SS0,v.KnownFormat.SS0_Tha)):void 0!==m?m!==b.TimeDivision.Hour||void 0!==g||r?(0,N.success)(v.KnownFormat.General):(0,N.success)(se(e,t,v.KnownFormat.AbsHMMSS,v.KnownFormat.AbsHMMSS_Tha)):r?(0,N.success)(se(e,t,v.KnownFormat.MDYHMS,v.KnownFormat.MDYHMS_Tha)):void 0!==g?(0,N.success)(se(e,t,void 0!==c?v.KnownFormat.HHMMSSAP:v.KnownFormat.HHMMAP,void 0!==c?v.KnownFormat.HHMMSS_Tha:v.KnownFormat.HHMM_Tha)):(0,N.success)(se(e,t,void 0!==c?v.KnownFormat.HHMMSS:v.KnownFormat.HHMM,void 0!==c?v.KnownFormat.HHMMSS_Tha:v.KnownFormat.HHMM_Tha));if((0,f.assertTrue)("calc.numfmt.parseDateInternal: !haveTime => haveDate",r),!i)return(0,N.success)(se(e,t,v.KnownFormat.MMDDYY,v.KnownFormat.MMDDYY_Tha));const h=void 0!==n&&!o,p=se(e,t,void 0===a?v.KnownFormat.MMMYY:h?v.KnownFormat.DDMMMYY:v.KnownFormat.DDMMM,void 0===a?v.KnownFormat.MMMYY_Tha:h?v.KnownFormat.DDMMMYY_Tha:v.KnownFormat.DDMMM_Tha);return e.isEastAsia&&p===v.KnownFormat.DDMMM&&r?(0,R.failure)((0,u.notImplemented)(["parseDateInternal ifmt for East Asian DDMMM"])):(0,N.success)(p)}(i,h,void 0!==I,W,G,B,V,void 0!==T,D,w,_,x,X);return(0,k.isSuccess)(te)?(0,N.success)({value:J,format:te.value}):te}},2122:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderHashesValue=t.renderValue=t.renderGeneral=void 0;const n=r(6442),a=r(6067),i=r(6366),o=r(6366),s=r(6366),u=r(6366),l=r(3387),c=r(6366),d=r(6366),g=r(6366),m=r(6366),h=e=>e.kind!==n.FormattedUnitKind.General,p=e=>e.kind!==n.FormattedUnitKind.Flexible,f=255;function S(e,t,r){return 0!=(t&n.Clip.MaxChars)&&r.length>f?n.Clip.MaxChars:0!=(t&n.Clip.CellWidth)&&e.renderWidth<1/0&&e.getTextWidth(r)>e.renderWidth?n.Clip.CellWidth:void 0}function v(e,t,r,n,a,i,l){const c=(0,s.fastMax)(0,f-r.length-n.length);let d=0===a.length?c:Math.floor(c/a.length);if(e.renderWidth!==1/0){const t=e.getTextWidth(a);t>0&&(d=(0,u.fastMin)(d,(0,s.fastMax)(Math.floor((e.renderWidth-e.getTextWidth(r+n))/t),0)))}const g=l(d);if(e.bestFit&&i&&(!1===g||g.indexOf("E")>=0)){let e=1,t=g;for(;(!1===t||t.indexOf("E")>=0)&&d+e<=y;)t=l(d+e),e++;if(!1!==t)return t}let m;if(!1===g||void 0===(m=S(e,t,r+g+n))){let a=g;for(let i=d+1;i<d+50;i+=1){const o=l(i);if(!1===o)continue;if(o===a)break;const s=S(e,t,r+o+n);if(void 0!==s){!1===a&&(a=s);break}a=o}return(0,o.assertTrue)("calc.numfmt.renderValue: false after upwards search",!1!==a),a}let h=m;for(let a=d-1;a>=0;a-=1){const i=l(a);if(!1===i)break;const o=S(e,t,r+i+n);if(void 0===o)return i;h=o}return h}const F=(0,a.createFailureErrorClass)("RenderHashesError"),y=11;function b(e,t,r){const n=e.fromNumber(t.num),a=t.includeSign&&e.cond(n)<0?"-":"";let i=a+e.formatGeneral(t,e.abs(n),r-a.length);if("-0"===i&&(i="0"),i.length>r)return!1;const s=i.indexOf("E");if(s>=0){const e=(0,l.convertNumberShape)(t,i.substring(0,s),t.expNumberShape),r=i.substring(s,s+2),n=(0,l.convertDigitsShape)(i.substring(s+2),t.expNumberShape);return(0,o.assertTrue)("calc.numfmt.render: formatGeneral ePart","E-"===r||"E+"===r),e+r+n}return(0,l.convertNumberShape)(t,i,t.numberShape)}t.renderGeneral=b,t.renderValue=function(e,t,r){try{return(0,n.isHashesValue)(t)?(0,g.success)((0,n.hashesValue)(t.units,t.color)):(0,g.success)(function(e,{units:t,color:r,alignment:a,clip:i},l){const d=(0,n.memoizedRenderCallback)(l);let g,m;if(t.every(h))g=t;else if(d.renderWidth===1/0)g=t.map((t=>{if(t.kind!==n.FormattedUnitKind.General)return t;const r=b(e,t,y);return(0,o.assertTrue)("calc.numfmt.renderValue: false after format at defaultGenPrecision",!1!==r),(0,n.formattedUnitString)(r)}));else{let r,a,s="",l="";for(let e=0;e<t.length;e+=1){const i=t[e];switch(i.kind){case n.FormattedUnitKind.String:case n.FormattedUnitKind.Blank:void 0!==r?l+=i.str:s+=i.str;break;case n.FormattedUnitKind.General:(0,o.assertTrue)("calc.numfmt.renderValue: expected a single General unit",void 0===r),r=e,a=i;case n.FormattedUnitKind.Flexible:}}(0,o.assertTrue)("calc.numfmt.renderValue: genUnit",void 0!==r&&void 0!==a);const c=a,m=v(d,i,s,l,"0",c.builtin,(t=>b(e,c,(0,u.fastMin)(t,y))));if("number"==typeof m)throw new F((0,n.tooWide)(m));g=t.map((e=>e.kind===n.FormattedUnitKind.General?(0,n.formattedUnitString)(m):e))}if(g.every(p))m=g;else if(d.renderWidth===1/0||d.bestFit)m=g.filter(p);else{let e,t,r="",a="";for(let i=0;i<g.length;i+=1){const o=g[i];switch(o.kind){case n.FormattedUnitKind.String:case n.FormattedUnitKind.Blank:void 0!==e?a+=o.str:r+=o.str;break;case n.FormattedUnitKind.Flexible:e=i,t=o}}(0,o.assertTrue)("calc.numfmt.renderValue: lastFlexUnit",void 0!==e&&void 0!==t);const u=t;let l=v(d,n.Clip.All,r,a,t.str,!1,(e=>(0,c.repeat)(u.str,e)));if("number"==typeof l){if(0!=(l&i))throw new F((0,n.tooWide)(l));l=""}let h=l.length/u.str.length;h=(0,s.fastMax)(h-1,0);const p=(0,c.repeat)(u.str,h);m=g.map(((t,r)=>t.kind!==n.FormattedUnitKind.Flexible?t:(0,n.formattedUnitString)(r===e?p:"")))}if(i!==n.Clip.None){let e="";for(let t=0;t<m.length;t+=1)e+=m[t].str;const t=S(d,i,e);if(d.bestFit&&t===n.Clip.CellWidth)return(0,n.renderedValue)(m,r,a,i);if(void 0!==t)throw new F((0,n.tooWide)(t))}return(0,n.renderedValue)(m,r,a,i)}(e,t,r))}catch(e){return e instanceof F?(0,g.success)((0,n.hashesValue)(e.reason,t.color)):(0,m.failure)((0,d.javaScriptError)(e))}},t.renderHashesValue=function(e,t){try{let r=v((0,n.memoizedRenderCallback)(t),e.clip,"","","#",!1,(e=>(0,c.repeat)("#",e)));if("number"==typeof r)switch(r){case n.Clip.MaxChars:r=(0,c.repeat)("#",f);break;case n.Clip.CellWidth:r="";break;default:return(0,i.assertNever)("calc.numFmt.renderHashesValue",r)}const a=(0,n.formattedUnitString)(r);return(0,g.success)((0,n.renderedValue)([a],e.color,e.alignment,e.clip))}catch(e){return(0,m.failure)((0,d.javaScriptError)(e))}}},3405:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRibbonFormat=t.RibbonFormat=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(9992);var l;function c(e,t){return(0,u.buildSingle)(e,a.PictureSingle.ColorStart,"$-",t,a.PictureSingle.ColorEnd)}!function(e){e.GalleryGeneral="GalleryGeneral",e.GalleryNumber="GalleryNumber",e.GalleryCurrency="GalleryCurrency",e.GalleryAccounting="GalleryAccounting",e.GalleryShortDate="GalleryShortDate",e.GalleryLongDate="GalleryLongDate",e.GalleryTime="GalleryTime",e.GalleryPercentage="GalleryPercentage",e.GalleryFraction="GalleryFraction",e.GalleryScientific="GalleryScientific",e.GalleryText="GalleryText",e.ButtonComma="ButtonComma",e.ButtonPercentage="ButtonPercentage",e.ButtonAccounting="ButtonAccounting",e.KeyboardGeneral="KeyboardGeneral",e.KeyboardNumber="KeyboardNumber",e.KeyboardCurrency="KeyboardCurrency",e.KeyboardDate="KeyboardDate",e.KeyboardTime="KeyboardTime",e.KeyboardPercentage="KeyboardPercentage",e.KeyboardScientific="KeyboardScientific"}(l||(t.RibbonFormat=l={})),t.getRibbonFormat=function(e,t,r){const d=(r?.culture?.calendar??s.Calendar.Gregorian)===s.Calendar.Gregorian;switch(t){case l.GalleryGeneral:case l.KeyboardGeneral:return(0,u.getKnownFormat)(e,o.KnownFormat.General);case l.GalleryNumber:return(0,u.buildNumberFormat)(e,!1,1,e.currencyDecimals);case l.KeyboardNumber:return(0,u.buildNumberFormat)(e,!0,4,e.currencyDecimals);case l.GalleryCurrency:{const t={...e,currencyFormat:e.currencyFormat===i.CurrencyFormat.Paren?i.CurrencyFormat.Lead:e.currencyFormat};return(0,u.buildCurrencyFormat)(t,!1,e.currencyDecimals,!0,!1,void 0,!0)}case l.KeyboardCurrency:return(0,u.buildCurrencyFormat)(e,!0,e.currencyDecimals,!0,!1);case l.GalleryAccounting:case l.ButtonAccounting:return(0,u.buildCurrencyFormat)(e,!1,e.currencyDecimals,!0,!0);case l.GalleryShortDate:return d?(0,u.getKnownFormat)(e,o.KnownFormat.MMDDYY):(0,u.buildSingle)(e,a.PictureSingle.Month,a.PictureSingle.DateSep,a.PictureSingle.Day,a.PictureSingle.Sep,a.PictureSingle.Text);case l.GalleryLongDate:return d?c(e,"x-sysdate")+(0,u.buildSingle)(e,a.PictureSingle.Day,a.PictureSingle.Day,a.PictureSingle.Day,a.PictureSingle.Day,", ",a.PictureSingle.Month,a.PictureSingle.Month,a.PictureSingle.Month,a.PictureSingle.Month," ",a.PictureSingle.Day,a.PictureSingle.Day,", ",a.PictureSingle.Year,a.PictureSingle.Year,a.PictureSingle.Year,a.PictureSingle.Year):(0,u.buildSingle)(e,a.PictureSingle.Month,a.PictureSingle.DateSep,a.PictureSingle.Day,a.PictureSingle.DateSep,a.PictureSingle.Year,a.PictureSingle.Year,a.PictureSingle.Sep,a.PictureSingle.Text);case l.GalleryTime:return c(e,"x-systime")+(0,u.buildSingle)(e,a.PictureSingle.Hour,a.PictureSingle.Colon,a.PictureSingle.Minute,a.PictureSingle.Minute,a.PictureSingle.Colon,a.PictureSingle.Second,a.PictureSingle.Second," ")+(0,u.getSpecial)(e,n.PictureSpecial.AP1);case l.KeyboardDate:return c(e,"en-US")+(0,u.buildSingle)(e,a.PictureSingle.Day,"-",a.PictureSingle.Month,a.PictureSingle.Month,a.PictureSingle.Month,"-",a.PictureSingle.Year,a.PictureSingle.Year,a.PictureSingle.Sep,a.PictureSingle.Text);case l.KeyboardTime:return c(e,"en-US")+(0,u.buildSingle)(e,a.PictureSingle.Hour,a.PictureSingle.Colon,a.PictureSingle.Minute,a.PictureSingle.Minute," ",(0,u.getSpecial)(e,n.PictureSpecial.AP1),a.PictureSingle.Sep,a.PictureSingle.Text);case l.GalleryPercentage:return(0,u.buildPercentFormat)(e,e.currencyDecimals);case l.ButtonPercentage:case l.KeyboardPercentage:return(0,u.getKnownFormat)(e,o.KnownFormat.Pct0);case l.GalleryFraction:return(0,u.getKnownFormat)(e,o.KnownFormat.Fract);case l.GalleryScientific:case l.KeyboardScientific:return(0,u.buildScientificFormat)(e,1,e.currencyDecimals,2);case l.GalleryText:return(0,u.getKnownFormat)(e,o.KnownFormat.Text);case l.ButtonComma:return(0,u.buildCurrencyFormat)(e,!1,e.currencyDecimals,!1,!0)}}},6442:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormatLocalsGrid=t.createFormatGlobals=t.NumberFormatSource=t.otherEdit=t.numberEdit=t.stringEdit=t.formulaEdit=t.EditKind=t.renderedValueToString=t.renderInfiniteWidth=t.memoizedRenderCallback=t.renderCallback=t.isHashesValue=t.renderedValue=t.formattedValue=t.hashesValue=t.formattedUnitFlexible=t.formattedUnitBlank=t.formattedUnitString=t.formattedUnitGeneral=t.FormattedUnitKind=t.Clip=t.GetTimeKind=t.Alignment=t.NamedColor=t.FormatCurrency=t.isFormatCultureEqual=t.isSystemCultureTag=t.CultureTag=t.BidiDate=t.FormatValueType=t.formatLocIFormat=t.formatLocKnownFormat=t.FormatLocKind=t.previousFormatFailure=t.aggregationError=t.fractionOverflow=t.dateOverflow=t.tooWide=t.noFormatPart=t.notFormatString=t.notValueString=t.ReasonKind=t.FormatReasonKind=void 0;const n=r(6067),a=r(6067),i=r(6366),o=r(6366);var s,u,l,c,d,g,m,h,p,f,S,v,F;function y(e,t,r,n){return{units:e,color:t,alignment:r,clip:n}}function b(e,t,r){return{renderWidth:e,bestFit:r,getTextWidth:t}}!function(e){e.NotValueString="NotValueString",e.NotFormatString="NotFormatString",e.NoFormatPart="NoFormatPart",e.TooWide="TooWide",e.DateOverflow="DateOverflow",e.FractionOverflow="FractionOverflow",e.AggregationError="AggregationError",e.PreviousFormatFailure="PreviousFormatFailure"}(s||(t.FormatReasonKind=s={})),t.ReasonKind={...n.LangReasonKind,...s},t.notValueString=function(e){return{kind:t.ReasonKind.NotValueString,message:e}},t.notFormatString=function(e){return{kind:t.ReasonKind.NotFormatString,message:e}},t.noFormatPart={kind:t.ReasonKind.NoFormatPart},t.tooWide=function(e){return{kind:t.ReasonKind.TooWide,clip:e}},t.dateOverflow={kind:t.ReasonKind.DateOverflow},t.fractionOverflow={kind:t.ReasonKind.FractionOverflow},t.aggregationError={kind:t.ReasonKind.AggregationError},t.previousFormatFailure=function(e){return{kind:t.ReasonKind.PreviousFormatFailure,format:e}},function(e){e.FormatString="FormatString",e.KnownFormat="KnownFormat",e.IFormat="IFormat"}(u||(t.FormatLocKind=u={})),t.formatLocKnownFormat=function(e,t){return{kind:u.KnownFormat,document:e,knownFormat:t}},t.formatLocIFormat=function(e,t){return{kind:u.IFormat,document:e,iformat:t}},function(e){e.General="General",e.Number="Number",e.Currency="Currency",e.Accounting="Accounting",e.Date="Date",e.Time="Time",e.Percentage="Percentage",e.Fraction="Fraction",e.Scientific="Scientific",e.Text="Text",e.Custom="Custom"}(l||(t.FormatValueType=l={})),function(e){e.English="English",e.Lunar="Lunar"}(c||(t.BidiDate=c={})),function(e){e.SysDate="sysdate",e.SysTime="systime",e.Euro1="euro1",e.Euro2="euro2",e.GenLower="genlower",e.GenUpper="genupper",e.NomLower="nomlower",e.Bitcoin1="xbt1",e.Bitcoin2="xbt2",e.Gannen="gannen"}(d||(t.CultureTag=d={})),t.isSystemCultureTag=function(e){return e===d.SysDate||e===d.SysTime},t.isFormatCultureEqual=function(e,t){return e.culture===t.culture&&e.numberShape===t.numberShape&&e.nationalNumberInput===t.nationalNumberInput&&e.calendar===t.calendar&&e.localCalendarInput===t.localCalendarInput&&e.tag===t.tag},function(e){e[e.LocaleInfo=0]="LocaleInfo"}(g||(t.FormatCurrency=g={})),function(e){e.Black="Black",e.White="White",e.Red="Red",e.Green="Green",e.Blue="Blue",e.Yellow="Yellow",e.Magenta="Magenta",e.Cyan="Cyan"}(m||(t.NamedColor=m={})),function(e){e.Left="Left",e.Center="Center",e.Right="Right"}(h||(t.Alignment=h={})),function(e){e.ValueCell="ValueCell",e.Volatile="Volatile",e.NonVolatile="NonVolatile"}(p||(t.GetTimeKind=p={})),function(e){e[e.MaxChars=2]="MaxChars",e[e.CellWidth=4]="CellWidth",e[e.None=0]="None",e[e.All=6]="All"}(f||(t.Clip=f={})),function(e){e.String="String",e.Blank="Blank",e.General="General",e.Flexible="Flexible"}(S||(t.FormattedUnitKind=S={})),t.formattedUnitGeneral=function(e,t,r,n,a,i){return{kind:S.General,num:e,decimalSeparator:t,includeSign:r,numberShape:n,expNumberShape:a,builtin:i}},t.formattedUnitString=function(e){return{kind:S.String,str:e}},t.formattedUnitBlank=function(e){return{kind:S.Blank,str:e}},t.formattedUnitFlexible=function(e){return{kind:S.Flexible,str:e}},t.hashesValue=function(e,t){return y(e,t,h.Center,f.All)},t.formattedValue=y,t.renderedValue=y,t.isHashesValue=function(e){return!Array.isArray(e.units)},t.renderCallback=b,t.memoizedRenderCallback=function(e){const t=(0,i.makeStringMap)();return b(e.renderWidth,(r=>{if(null!=t[r])return t[r];const n=e.getTextWidth(r);return t[r]=n,n}),e.bestFit)},t.renderInfiniteWidth={renderWidth:1/0,bestFit:!1,getTextWidth:e=>e.length},t.renderedValueToString=function(e){let t="";for(const r of e.units)switch(r.kind){case S.String:t+=r.str;break;case S.Blank:for(let e=0;e<r.str.length;e+=1)t+=" "}return t},function(e){e.Formula="Formula",e.String="String",e.Number="Number",e.Other="Other"}(v||(t.EditKind=v={})),t.formulaEdit=function(e){return{kind:v.Formula,fmla:e}},t.stringEdit=function(e,t){return{kind:v.String,value:e,tick:t}},t.numberEdit=function(e,t){return{kind:v.Number,value:e,format:t}},t.otherEdit=function(e){return{kind:v.Other,value:e}},function(e){e.Builtin="Builtin",e.CustomString="CustomString",e.CustomBytecode="CustomBytecode",e.System="System"}(F||(t.NumberFormatSource=F={})),t.createFormatGlobals=function(e,t){return{config:e,getTime:t}},t.evalFormatLocalsGrid=function(e,t){const r=(0,a.sheetGridRangeAnchor)(e.range);return{config:t??void 0,lexicalSource:e,originGridCell:(0,o.success)(r.range),originSheet:(0,o.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}},3387:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertCommas=t.convertNumberShape=t.convertDigitsShape=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6366),u=r(6366),l=r(6366),c=r(6366),d=r(6067),{codePointDigitZero:g,codePointDigitNine:m,codePointDigitOne:h}=c.codePoint,p={[d.NumberShape.ArabicIndic]:{zero:1632,one:1633},[d.NumberShape.ExtendedArabicIndic]:{zero:1776,one:1777},[d.NumberShape.Devanagari]:{zero:2406,one:2407},[d.NumberShape.Bengali]:{zero:2534,one:2535},[d.NumberShape.Gurmukhi]:{zero:2662,one:2663},[d.NumberShape.Gujarati]:{zero:2790,one:2791},[d.NumberShape.Oriya]:{zero:2918,one:2919},[d.NumberShape.Tamil]:{zero:48,one:3047},[d.NumberShape.Telugu]:{zero:3174,one:3175},[d.NumberShape.Kannada]:{zero:3302,one:3303},[d.NumberShape.Malayalam]:{zero:3430,one:3431},[d.NumberShape.Thai]:{zero:3664,one:3665},[d.NumberShape.Lao]:{zero:3792,one:3793},[d.NumberShape.Tibetan]:{zero:3872,one:3873},[d.NumberShape.Myanmar]:{zero:4160,one:4161},[d.NumberShape.Ethiopic]:{zero:48,one:4969},[d.NumberShape.Khmer]:{zero:6112,one:6113},[d.NumberShape.Mongolian]:{zero:6160,one:6161}},f={[d.NumberShape.Japanese1]:{digits:[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Japanese",dbnum:1},[d.NumberShape.Japanese2]:{digits:[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],ten:25342,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"Japanese",dbnum:2},[d.NumberShape.Japanese3]:{digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Japanese",dbnum:3},[d.NumberShape.Korean1]:{digits:[65296,19968,20108,19977,22235,20116,63953,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Korean",dbnum:1},[d.NumberShape.Korean2]:{digits:[63922,22777,36019,63851,22235,20237,63953,19971,20843,20061],ten:63859,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"Korean",dbnum:2},[d.NumberShape.Korean3]:{digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Korean",dbnum:3},[d.NumberShape.Korean4]:{digits:[50689,51068,51060,49340,49324,50724,50977,52832,54036,44396],ten:49901,hundred:48177,thousand:52380,tenThousand:47564,hundredMillion:50613,trillion:51312,langId:"Korean",dbnum:4},[d.NumberShape.ChineseSimp1]:{digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806,langId:"ChineseSimp",dbnum:1},[d.NumberShape.ChineseSimp2]:{digits:[38646,22777,36144,21441,32902,20237,38470,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:19975,hundredMillion:20159,trillion:20806,langId:"ChineseSimp",dbnum:2},[d.NumberShape.ChineseSimp3]:{digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806,langId:"ChineseSimp",dbnum:3},[d.NumberShape.ChineseTrad1]:{digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"ChineseTrad",dbnum:1},[d.NumberShape.ChineseTrad2]:{digits:[38646,22777,36019,21443,32902,20237,38520,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"ChineseTrad",dbnum:2},[d.NumberShape.ChineseTrad3]:{digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"ChineseTrad",dbnum:3}};function S(e,t){if(t===d.NumberShape.ASCII)return e;switch(t){case d.NumberShape.ArabicIndic:case d.NumberShape.ExtendedArabicIndic:case d.NumberShape.Devanagari:case d.NumberShape.Bengali:case d.NumberShape.Gurmukhi:case d.NumberShape.Gujarati:case d.NumberShape.Oriya:case d.NumberShape.Tamil:case d.NumberShape.Telugu:case d.NumberShape.Kannada:case d.NumberShape.Malayalam:case d.NumberShape.Thai:case d.NumberShape.Lao:case d.NumberShape.Tibetan:case d.NumberShape.Myanmar:case d.NumberShape.Ethiopic:case d.NumberShape.Khmer:case d.NumberShape.Mongolian:{let r="";const n=p[t];for(let t=0;t<e.length;t+=1){const a=e.charCodeAt(t);(0,i.assertTrue)("calc.numfmt.convertDigitsShape",g<=a&&a<=m),r+=a===g?(0,o.stringFromCodePoint)(n.zero):(0,o.stringFromCodePoint)(n.one+(a-h))}return r}case d.NumberShape.ChineseTrad1:case d.NumberShape.ChineseTrad2:case d.NumberShape.ChineseTrad3:case d.NumberShape.ChineseSimp1:case d.NumberShape.ChineseSimp2:case d.NumberShape.ChineseSimp3:case d.NumberShape.Japanese1:case d.NumberShape.Japanese2:case d.NumberShape.Japanese3:case d.NumberShape.Korean1:case d.NumberShape.Korean2:case d.NumberShape.Korean3:case d.NumberShape.Korean4:{let r="";const n=f[t];for(let t=0;t<e.length;t+=1)r+=v(n,e.charCodeAt(t));return r}}}function v(e,t){return(0,i.assertTrue)("calc.numfmt.ideographicDigit",g<=t&&t<=m),(0,o.stringFromCodePoint)(e.digits[t-g])}var F;function y(e,t){switch(t){case F.Ten:return(0,o.stringFromCodePoint)(e.ten);case F.Hundred:return(0,o.stringFromCodePoint)(e.hundred);case F.Thousand:return(0,o.stringFromCodePoint)(e.thousand);case F.TenThousand:return(0,o.stringFromCodePoint)(e.tenThousand);case F.HundredMillion:return(0,o.stringFromCodePoint)(e.hundredMillion);case F.Trillion:return(0,o.stringFromCodePoint)(e.trillion);default:return(0,n.assertFalse)("calc.numfmt.ideographicRank")}}t.convertDigitsShape=S,function(e){e[e.Ten=10]="Ten",e[e.Hundred=11]="Hundred",e[e.Thousand=12]="Thousand",e[e.TenThousand=13]="TenThousand",e[e.HundredMillion=14]="HundredMillion",e[e.Trillion=15]="Trillion"}(F||(F={})),t.convertNumberShape=function({decimalSeparator:e},t,r){if(r===d.NumberShape.ASCII)return t;switch(r){case d.NumberShape.ArabicIndic:case d.NumberShape.ExtendedArabicIndic:case d.NumberShape.Devanagari:case d.NumberShape.Bengali:case d.NumberShape.Gurmukhi:case d.NumberShape.Gujarati:case d.NumberShape.Oriya:case d.NumberShape.Tamil:case d.NumberShape.Telugu:case d.NumberShape.Kannada:case d.NumberShape.Malayalam:case d.NumberShape.Thai:case d.NumberShape.Lao:case d.NumberShape.Tibetan:case d.NumberShape.Myanmar:case d.NumberShape.Ethiopic:case d.NumberShape.Khmer:case d.NumberShape.Mongolian:{const n=t.indexOf(e);return S(t.substring(0,n<0?void 0:n),r)+(n<0?"":e)+(n<0?"":S(t.substring(n+e.length),r))}case d.NumberShape.ChineseTrad1:case d.NumberShape.ChineseTrad2:case d.NumberShape.ChineseTrad3:case d.NumberShape.ChineseSimp1:case d.NumberShape.ChineseSimp2:case d.NumberShape.ChineseSimp3:case d.NumberShape.Japanese1:case d.NumberShape.Japanese2:case d.NumberShape.Japanese3:case d.NumberShape.Korean1:case d.NumberShape.Korean2:case d.NumberShape.Korean3:case d.NumberShape.Korean4:{const n=f[r],a="ChineseSimp"===n.langId||"ChineseTrad"===n.langId,o=2===n.dbnum||"Korean"===n.langId&&(1===n.dbnum||4===n.dbnum),s=t.indexOf(e);let u=0,l=s<0?t.length:s,c="";if(l>12){if(l>16)for(;12<l;l--,u++)c+=v(n,t.charCodeAt(u));else{let e=16,r=F.Thousand,i=!1;do{if(e>l){e--,r--;continue}const s=t.charCodeAt(u);s!==g?((a||o||s>h||e%4==1)&&(a&&i&&(c+=v(n,g),i=!1),c+=v(n,s)),r>=F.Ten&&(c+=y(n,r))):i=!0,e--,r--,l--,u++}while(e>12)}c+=y(n,F.Trillion)}{let e=12;do{let r=F.Thousand,i=!1,s=!1;do{if(e>l){e--,r--;continue}const d=t.charCodeAt(u);d!==g||0===c.length?((a||o||d>h||e%4==1)&&(a&&s&&(c+=v(n,g),s=!1),c+=v(n,d)),r>=F.Ten&&(c+=y(n,r)),i=!0):s=!0,e--,r--,l--,u++}while(e%4);i&&l/4!=0&&(8===l?c+=y(n,F.HundredMillion):4===l&&(c+=y(n,F.TenThousand)))}while(l>0)}if(u!==t.length)for((0,i.assertTrue)("calc.numfmt.convertNumberShape",s>=0&&u===s),c+=e,u=s+e.length;u<t.length;u++)c+=v(n,t.charCodeAt(u));return c}default:return(0,a.assertNever)("calc.numfmt.convertNumberShape",r)}},t.insertCommas=function(e,t,r){if(""===t)return"";const n=(0,s.countCodePoints)(t,0,t.length);let a="";for(let i=0,o=0;i<t.length;){const s=(0,u.stringCodePointAt)(t,i),c=(0,l.numCodeUnits)(s);a+=t.substring(i,i+c),i+=c,o+=1,e.isThousandsPosition(r+(n-o))&&(a+=e.thousandsSeparator)}return a}},4878:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyFormatAndRenderToString=t.getFormatString=t.initUtilGlobals=void 0;const n=r(6067),a=r(6442),i=r(6366),o=r(6366),s=r(6366),u={getKnownFormat:()=>(0,s.assertFalse)("calc.numfmt: default getKnownFormat"),getIformat:()=>(0,s.assertFalse)("calc.numfmt: default getIformat"),getFormatString:()=>(0,s.assertFalse)("calc.numfmt: default getFormatString")};t.initUtilGlobals=function(e){return{config:e.config,getKnownFormat:e.getKnownFormat?.bind(e)??u.getKnownFormat,getIformat:e.getIformat?.bind(e)??u.getIformat,getFormatString:e.getFormatString?.bind(e)??u.getFormatString}},t.getFormatString=function(e,t,r,n,a){const o=t.getFormatString(r,n);return(0,i.isSuccess)(o)?void 0!==o.value?t.getIformat(r,o.value):e.createFormat(n,a):o},t.applyFormatAndRenderToString=function(e,t,r){const s=(0,n.isStringOper)(r)?a.Clip.None:a.Clip.All,u=t.apply(r,a.Alignment.Right,s,!0);if(!(0,i.isSuccess)(u))return u;const l=e.renderValue(u.value,a.renderInfiniteWidth);return(0,i.isSuccess)(l)?(0,a.isHashesValue)(l.value)?(0,o.success)(l.value.units):(0,o.success)((0,a.renderedValueToString)(l.value)):l}},3059:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toXLNumber=t.applyValueEdit=t.getValueEditOperKind=void 0;const n=r(6442),a=r(6067),i=r(6366),o=r(6366),s=r(6366),u=r(8630),l=r(9992);t.getValueEditOperKind=function(e){return e.value.kind},t.applyValueEdit=function(e,t,r,i){let s=r;if(i.kind===n.EditKind.Number&&i.format!==a.KnownFormat.General){const n=i.format,a="string"==typeof n?n:(0,l.getKnownFormat)(t,n),c="string"!=typeof n,d=e.createFormat(a,c);if(!(0,o.isSuccess)(d))return d;const g=d.value;(0,u.shouldInstallFormat)(g,r)&&(s=g)}return e.applyFormat(s,i.value,!0)},t.toXLNumber=function(e,t,r){const a=t.parseGeneral(r,!1,!0,n.GetTimeKind.NonVolatile);return(0,o.isSuccess)(a)?null==a.value?(0,i.failure)(null):(0,s.success)(e.toNumber(a.value.value)):a}},3271:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PackageName=void 0,t.PackageName="excel-online-calc-recalc"},2107:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.geomean=t.devsq=t.avedev=t.rank_avg=t.rank=t.aggregate=t.subtotal=t.mode_mult=t.mode=t.varpa=t.vara=t.varp=t.var_=t.stdevpa=t.stdeva=t.stdevp=t.stdev=t.trimmean=t.median=t.quartile_exc=t.quartile=t.percentile_exc=t.percentile=t.small=t.large=t.xor=t.or=t.and=t.minifs=t.maxifs=t.mina=t.maxa=t.min=t.max=t.countifs=t.countif=t.counta=t.countblank=t.count=t.textjoin=t.concat=t.averagea=t.averageifs=t.averageif=t.average=t.product=t.sumifs=t.sumif=t.sumsq=t.sum=void 0,t.sumproduct=t.harmean=void 0;const n=r(6366),a=r(6366),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(6067),E=r(6067),T=r(6067),R=r(5146),k=r(6067),N=r(6067),I=r(6067),O=r(6067),P=r(7716),M=r(6366),D=r(6067),w=r(3091),L=r(7674),_=r(6880),x=r(6067),K=r(6366),W=r(6366),U=r(6366),G=r(6067),B=r(6067),V=r(6067),j=r(3109);function H(e,t){const r=(0,f.isRichOper)(t)?t.getFallback():t;switch(r.kind){case x.OperKind.Number:return r;case x.OperKind.Boolean:case x.OperKind.String:return;case x.OperKind.Error:return r;case x.OperKind.Missing:case x.OperKind.Blank:return;default:return(0,n.assertNever)("calc.funcs.arithmeticOperationCoerce",r)}}function q(e,t){const r=(0,f.isRichOper)(t)?t.getFallback():t;switch(r.kind){case x.OperKind.Boolean:return r.value?e.mathpack.one:e.mathpack.zero;case x.OperKind.Number:return r;case x.OperKind.String:return e.mathpack.zero;case x.OperKind.Error:return r;case x.OperKind.Missing:case x.OperKind.Blank:return;default:return(0,n.assertNever)("calc.funcs.arithmeticAOperationCoerce",r)}}function z(e){return function(t,r,n){if(void 0!==t&&(0,p.isErrorOper)(t))return t;if((0,a.assertTrue)("calc.funcs.numberReducer",void 0===t||(0,b.isNumberOper)(t)),(0,p.isErrorOper)(r))return r;let i,o;(0,a.assertTrue)("calc.funcs.numberReducer",(0,b.isNumberOper)(r)),void 0===t?(i=r,o=n-1):(i=t,o=n);for(let t=0;t<o;t+=1){const t=e(i,r);if((0,p.isErrorOper)(t))return t;i=t}return i}}function Q(e){return(t,r,n)=>(e.count+=n,r)}function $(e,t,r){if(!(0,b.isNumberOper)(r))return r;const n=function(e){for(let t=e.length-1;t>=0;t-=1){const r=e[t];if(void 0!==r&&(0,R.isRangeValues)(r))for(let e=r.arrays.length-1;e>=0;e-=1){const t=r.arrays[e];if(t.rows>t.denseRows||t.cols>t.denseCols){const e=t.getSparse();if(e?.kind===x.OperKind.Number)return e}for(let e=t.denseRows-1;e>=0;e-=1)for(let r=t.denseCols-1;r>=0;r-=1){const n=t.get(e,r);if(n?.kind===x.OperKind.Number)return n}}}}(t);return n?.kind!==x.OperKind.Number?r:e.mathpack.checkAlmostCancellation(n,r)}function Y(e,t,r){let n=(0,w.reduceDerefOpers)(t,z(t.mathpack.add),H,r);return null==n?t.mathpack.zero:(e&&(n=$(t,r,n)),n)}const J=Y.bind(void 0,!1),X=Y.bind(void 0,!0);function Z(e){return(0,S.isRangeOper)(e)&&1!==e.ranges.length}function ee(e,t,r){if(Z(t))return(0,W.failure)(i.valueErrorOper);if(void 0===r){const r=e.dereferenceAllOpers([t])[0];return(0,U.success)({values:r,valuesToFilter:r})}if(Z(r))return(0,W.failure)(i.valueErrorOper);const{actualEvalRange:n,actualFilterRange:a}=function(e,t){const r=e.ranges[0],n=t.ranges[0],a=(0,M.fastMin)(r.cols,I.sheetCols-n.col),i=(0,M.fastMin)(r.rows,O.sheetRows-n.row),o=(0,k.gridRange)(r.row,r.col,i,a),s=(0,u.range3DOper)(e.sheets,o),l=(0,k.gridRange)(n.row,n.col,i,a);return{actualEvalRange:s,actualFilterRange:(0,u.range3DOper)(t.sheets,l)}}(t,r),o=n.ranges[0],s=a.ranges[0],l=e.dereferenceAllOpers([n])[0];if(o.col===s.col&&o.row===s.row)return(0,U.success)({values:l,valuesToFilter:l});const c=e.dereferenceAllOpers([a])[0];return(0,U.success)({values:l,valuesToFilter:c})}function te(e,[t,r,n]){const a=ee(e,t,n);if(!(0,K.isSuccess)(a))return a.reason;const{values:i,valuesToFilter:o}=a.value,s=[(0,R.rangeValues)([(0,P.applyCriteria)(e,i.arrays[0],r,o.arrays[0])])];return J(e,s)}function re(e,t,r=!1,n=!1){const a=t[0];if(Z(a))return(0,W.failure)(i.valueErrorOper);let o,s;if(r){const r=t[1],[n]=e.dereferenceAllOpers([a]);o=(0,P.applyCriteria)(e,n.arrays[0],r),s=2}else{const[t]=e.dereferenceAllOpers([a]);o=t.arrays[0],s=1}for(let r=s;r<t.length;r+=2){const n=t[r],s=t[r+1];if(Z(n))return(0,W.failure)(i.valueErrorOper);if(n.ranges[0].cols!==a.ranges[0].cols||n.ranges[0].rows!==a.ranges[0].rows)return(0,W.failure)(i.valueErrorOper);const[u]=e.dereferenceAllOpers([n]);o=(0,P.applyCriteria)(e,u.arrays[0],s,o)}return n&&(o=o.strict()),(0,U.success)((0,R.rangeValues)([o]))}function ne(e,t){const r=(0,w.reduceDerefOpers)(e,z(e.mathpack.mul),H,t);return null==r?e.mathpack.zero:r}function ae(e,t,r,n,i,o){let s=(0,w.reduceDerefOpers)(i,z(i.mathpack.add),e,o,t);if(null==s)return n;if(r&&(s=$(i,o,s)),(0,p.isErrorOper)(s))return s;const u={count:0},l=(0,w.reduceDerefOpers)(i,Q(u),e,o,t);(0,a.assertTrue)("calc.funcs.averageCoerceInner",(0,b.isNumberOper)(s)&&l?.kind===x.OperKind.Number&&u.count>0);const c=i.mathpack.div(s,i.mathpack.fromNumber(u.count));return(0,p.isErrorOper)(c)?c:[c,u.count]}function ie(e,t,r,n,a){const i=ae(e,t,r,o.div0ErrorOper,n,a);return Array.isArray(i)?i[0]:i}t.sum=function(e,t){const r=e.dereferenceAllOpers(t);return X(e,r)},t.sumsq=function(e,t){const r=e.dereferenceAllOpers(t),n=Ue(H),a=(0,w.reduceDerefOpers)(e,z(e.mathpack.add),n,r);return null==a?e.mathpack.zero:a},t.sumif=te,t.sumifs=function(e,t){if(3===t.length)return te(e,[t[1],t[2],t[0]]);const r=re(e,t);return(0,K.isSuccess)(r)?J(e,[r.value]):r.reason},t.product=function(e,t){const r=e.dereferenceAllOpers(t);return ne(e,r)};const oe=ie.bind(void 0,H,void 0,!1),se=ie.bind(void 0,H,void 0,!0),ue=ie.bind(void 0,q,(function(e,t){const r=(0,f.isRichOper)(t)?t.getFallback():t;return(0,C.isStringOper)(r)?e.mathpack.zero:H(0,r)}),!0);function le(e,[t,r,n]){const a=ee(e,t,n);if(!(0,K.isSuccess)(a))return a.reason;const{values:i,valuesToFilter:o}=a.value,s=[(0,R.rangeValues)([(0,P.applyCriteria)(e,i.arrays[0],r,o.arrays[0]).strict()])];return oe(e,s)}function ce(e,t,r,n,o){let s,u=0,c="";const d=(e,t)=>e.coerceOper(t,x.OperKind.String),m=(e,n,o)=>{if(void 0!==e&&(0,p.isErrorOper)(e))return e;for(let e=0;e<o;e+=1){if(void 0!==s&&t.length>0&&(!r||s.value.length>0)){const e=t[u];if(u=(u+1)%t.length,c.length+e.value.length>l.cellStringLimit)return i.valueErrorOper;c+=e.value}if((0,p.isErrorOper)(n))return n;if((0,a.assertTrue)("calc.funcs.concatInner: expected string in reducer",(0,C.isStringOper)(n)),c.length+n.value.length>l.cellStringLimit)return i.valueErrorOper;if(c+=n.value,s=n,""===n.value&&(0===t.length||r))break}return n};for(let t=0;t<o.length;t+=1){const r=n[t];if((0,S.isRangeOper)(r)&&r.ranges.length>1)return i.valueErrorOper;const s=(0,w.reduceDerefOpers)(e,m,d,o.slice(t,t+1));if(void 0!==s&&(0,p.isErrorOper)(s))return s;(0,a.assertTrue)("calc.funcs.concatInner: expected string from reduce",void 0!==s&&(0,C.isStringOper)(s))}if(r&&void 0!==s&&""===s.value&&t.length>0&&c.length>0){const e=t[(u+t.length-1)%t.length];c=c.substring(0,c.length-e.value.length)}return(0,g.stringOper)(c)}function de(e,t,r){const n={count:0};return(0,w.reduceDerefOpers)(t,Q(n),e,r),t.mathpack.fromNumber(n.count)}t.average=function(e,t){const r=e.dereferenceAllOpers(t);return se(e,r)},t.averageif=le,t.averageifs=function(e,t){if(3===t.length)return le(e,[t[1],t[2],t[0]]);const r=re(e,t,void 0,!0);return(0,K.isSuccess)(r)?oe(e,[r.value]):r.reason},t.averagea=function(e,t){const r=e.dereferenceAllOpers(t);return ue(e,r)},t.concat=function(e,t){const r=e.dereferenceAllOpers(t);return ce(e,[],!0,t,r)},t.textjoin=function(e,t){const[r,n,...o]=t,s=[];if(!(0,v.isMissingOper)(r)){if((0,S.isRangeOper)(r)&&r.ranges.length>1)return i.valueErrorOper;const t=(e,t)=>e.coerceOper(t,x.OperKind.String),n=(0,w.reduceDerefOpers)(e,Ie(s,L.assertString),t,e.dereferenceAllOpers([r]));if(void 0!==n&&(0,p.isErrorOper)(n))return n;(0,a.assertTrue)("calc.funcs.textjoin: expected string from reduce",void 0!==n&&(0,C.isStringOper)(n))}return ce(e,s,(0,v.isMissingOper)(n)||n.value,o,e.dereferenceAllOpers(o))};const ge=de.bind(void 0,(function(e,t){const r=(0,f.isRichOper)(t)?t.getFallback():t;return(0,b.isNumberOper)(r)?r:void 0}));t.count=function(e,t){const r=e.dereferenceAllOpers(t);return ge(e,r)};const me=de.bind(void 0,(function(e,t){const r=(0,f.isRichOper)(t)?t.getFallback():t;return(0,F.isBlankOper)(r)||(0,_.isEmptyStringOper)(r)?r:void 0}));t.countblank=function(e,t){const r=t[0];if(!(0,y.isSheetIndex)(r.sheets)||1!==r.ranges.length)return i.valueErrorOper;const n=e.dereferenceAllOpers(t);return me(e,n)};const he=de.bind(void 0,(function(e,t){const r=(0,f.isRichOper)(t)?t.getFallback():t;return(0,E.isPrimitiveOper)(r)||(0,p.isErrorOper)(r)?r:void 0}));t.counta=function(e,t){const r=e.dereferenceAllOpers(t);return he(e,r)};const pe=de.bind(void 0,((e,t)=>t));function fe(e,[t,r]){if(Z(t))return i.valueErrorOper;const[n]=e.dereferenceAllOpers([t]),a=[(0,R.rangeValues)([(0,P.applyCriteria)(e,n.arrays[0],r)])];return pe(e,a)}t.countif=fe,t.countifs=function(e,t){if(2===t.length)return fe(e,t);const r=re(e,t,!0);return(0,K.isSuccess)(r)?pe(e,[r.value]):r.reason};const Se=(e,t,r)=>e.mathpack.cond2(t,r)>0,ve=(e,t,r)=>e.mathpack.cond2(t,r)<0;function Fe(e,t,r,n,i){const o=(0,w.reduceDerefOpers)(n,((t,r,i)=>void 0===t?r:(0,p.isErrorOper)(t)?t:((0,a.assertTrue)("calc.funcs.minMaxCoerceInner",(0,b.isNumberOper)(t)),(0,p.isErrorOper)(r)?r:((0,a.assertTrue)("calc.funcs.minMaxCoerceInner",(0,b.isNumberOper)(r)),e(n,t,r)?t:r))),t,i,r);return null==o?n.mathpack.zero:o}const ye=Fe.bind(void 0,Se,H,void 0),be=Fe.bind(void 0,ve,H,void 0),Ce=Fe.bind(void 0,Se,q,H),Ae=Fe.bind(void 0,ve,q,H);function Ee(e,t){const r=(0,f.isRichOper)(t)?t.getFallback():t;switch(r.kind){case x.OperKind.Boolean:return r;case x.OperKind.Number:return(0,m.booleanOper)(0!==e.mathpack.cond(r));case x.OperKind.String:return;case x.OperKind.Error:return r;case x.OperKind.Missing:case x.OperKind.Blank:return;default:return(0,n.assertNever)("calc.funcs.aggregationFuncs: booleanOperationCoerce",r)}}function Te(e,t,r){const n=(0,w.reduceDerefOpers)(t,((t,r,n)=>void 0!==t&&(0,p.isErrorOper)(t)?t:(0,p.isErrorOper)(r)?r:((0,a.assertTrue)("calc.funcs.booleanInner",(void 0===t||(0,A.isBooleanOper)(t))&&(0,A.isBooleanOper)(r)),(0,m.booleanOper)(e(t?.value,r.value,n)))),Ee,r);return null==n?i.valueErrorOper:n}t.max=function(e,t){const r=e.dereferenceAllOpers(t);return ye(e,r)},t.min=function(e,t){const r=e.dereferenceAllOpers(t);return be(e,r)},t.maxa=function(e,t){const r=e.dereferenceAllOpers(t);return Ce(e,r)},t.mina=function(e,t){const r=e.dereferenceAllOpers(t);return Ae(e,r)},t.maxifs=function(e,t){const r=re(e,t);return(0,K.isSuccess)(r)?ye(e,[r.value]):r.reason},t.minifs=function(e,t){const r=re(e,t);return(0,K.isSuccess)(r)?be(e,[r.value]):r.reason};const Re=Te.bind(void 0,((e,t)=>!1!==e&&t)),ke=Te.bind(void 0,((e,t)=>!0===e||t)),Ne=Te.bind(void 0,((e,t,r)=>t?((!0===e?1:0)+r)%2==1:!0===e));function Ie(e,t){return(r,n,a)=>{if(void 0!==r&&(0,p.isErrorOper)(r))return r;if(!(0,p.isErrorOper)(n)){const r=t(n);for(let t=0;t<a;t+=1)e.push(r)}return n}}function Oe(e,t,r,n){const a=[],i=(0,w.reduceDerefOpers)(t,Ie(a,L.assertNumber),H,[r]);if(null==i)return s.numErrorOper;if((0,p.isErrorOper)(i))return i;const o=t.mathpack;if(o.cond2(n,o.one)<0)return s.numErrorOper;if(o.cond2(n,o.fromNumber(a.length))>0)return s.numErrorOper;const u=a.sort(o.cond2);if(e){const e=(0,L.assertNumber)(o.add((0,L.assertNumber)(o.sub(o.fromNumber(a.length),n)),o.one));return u[o.lfix(e)-1]}return u[o.lfix(n)-1]}t.and=function(e,t){const r=e.dereferenceAllOpers(t);return Re(e,r)},t.or=function(e,t){const r=e.dereferenceAllOpers(t);return ke(e,r)},t.xor=function(e,t){const r=e.dereferenceAllOpers(t);return Ne(e,r)};const Pe=Oe.bind(void 0,!0),Me=Oe.bind(void 0,!1);function De(e,t,r,n){const a=e.mathpack,i=[],o=(0,w.reduceDerefOpers)(e,Ie(i,L.assertNumber),H,t);if(null==o)return s.numErrorOper;if((0,p.isErrorOper)(o))return o;if((0,p.isErrorOper)(r))return r;if(a.cond(r)<0)return s.numErrorOper;if(a.cond2(r,a.one)>0)return s.numErrorOper;const u=i.sort(a.cond2),l=(0,L.assertNumber)(a.sub(a.fromNumber(u.length),a.one)),c=(0,L.assertNumber)(a.add(a.fromNumber(u.length),a.one)),d=n?(0,L.assertNumber)(a.mul(l,r)):(0,L.assertNumber)(a.sub((0,L.assertNumber)(a.mul(c,r)),a.one));if(a.cond(d)<0||a.cond2(d,l)>0)return s.numErrorOper;const g=a.lfix(d),m=(0,L.assertNumber)(a.sub(d,a.fromNumber(g)));if(0===a.cond(m))return u[g];const h=a.sub(u[g+1],u[g]);return(0,p.isErrorOper)(h)?h:a.add(u[g],(0,L.assertNumber)(a.mul(h,m)))}t.large=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return Pe(e,r,n)},t.small=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return Me(e,r,n)};const we=(e,t,r)=>De(e,[t],r,!0);t.percentile=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return we(e,r,n)};const Le=(e,t,r)=>De(e,[t],r,!1);function _e(e,t){const r=e.mathpack;if(r.cond(t)<0)return s.numErrorOper;if(r.cond2(t,r.fromNumber(5))>=0)return s.numErrorOper;const n=r.lfix(t);return r.div(r.fromNumber(n),r.fromNumber(4))}t.percentile_exc=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return Le(e,r,n)};const xe=(e,t,r)=>De(e,[t],_e(e,r),!0);t.quartile=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return xe(e,r,n)};const Ke=(e,t,r)=>De(e,[t],_e(e,r),!1);function We(e,t){return De(e,t,e.mathpack.fromNumber(.5),!0)}function Ue(e){return function(t,r){const n=e(t,r);return void 0!==n&&(0,b.isNumberOper)(n)?t.mathpack.mul(n,n):n}}function Ge(e,t){return function(r,n){const a=e(r,n);if(a?.kind!==x.OperKind.Number)return a;const i=r.mathpack,o=i.sub(a,t);return(0,p.isErrorOper)(o)?o:i.mul(o,o)}}function Be(e,t,r,n){const i={count:0};if(null==(0,w.reduceDerefOpers)(r,Q(i),e,n,t))return o.div0ErrorOper;(0,a.assertTrue)("calc.funcs.varFirstPass: unexpected count type",i.count>=1);const s=z(r.mathpack.add),u=(0,w.reduceDerefOpers)(r,s,e,n,t),l=(0,w.reduceDerefOpers)(r,s,Ue(e),n,void 0===t?void 0:Ue(t));if((0,a.assertTrue)("calc.funcs.varFirstPass: expected sum",null!=u),(0,a.assertTrue)("calc.funcs.varFirstPass: expected sumSq",null!=l),(0,p.isErrorOper)(u))return u;if((0,p.isErrorOper)(l))return l;(0,a.assertTrue)("calc.funcs.varFirstPass: unexpected oper type",(0,b.isNumberOper)(u)&&(0,b.isNumberOper)(l));const c=r.mathpack,d=c.div(u,c.fromNumber(i.count));return(0,p.isErrorOper)(d)?d:[i.count,u,l,d]}function Ve(e,t,r,n,i){const o=z(r.mathpack.add),s=(0,w.reduceDerefOpers)(r,o,Ge(e,i),n,void 0===t?void 0:Ge(t,i));return(0,a.assertTrue)("calc.funcs.varSecondPass: unexpected error",s?.kind===x.OperKind.Number),s}function je(e,t,r,n){const a=Be(e,t,r,n);if(!Array.isArray(a))return a;const i=r.mathpack,[s,u,l,c]=a;if(s<2)return o.div0ErrorOper;const d=i.mul(u,u);if((0,p.isErrorOper)(d))return d;const g=(0,L.assertNumber)(i.div(d,i.fromNumber(s))),m=(0,L.assertNumber)(i.sub(l,g));if(0===i.cond(c))return i.cond(m)<0?i.zero:i.div(m,i.fromNumber(s-1));if(i.cond(m)>=0){const e=(0,L.assertNumber)(i.div(m,i.fromNumber(s-1))),t=21219957905e-324;if(i.cond2(e,i.fromNumber(t))>0){const t=i.div(g,l),r=(0,p.isErrorOper)(t)?t:i.sub(t,i.one);if(!(0,p.isErrorOper)(r)&&i.cond2(i.abs(r),i.fromNumber(.01))>0){const t=i.div(c,e),r=(0,p.isErrorOper)(t)?t:i.sub(i.abs(t),i.fromNumber(1e3));if(!(0,p.isErrorOper)(r)&&i.cond(r)<0)return e}}}const h=Ve(e,t,r,n,c);return i.cond(h)<0?i.zero:i.div(h,i.fromNumber(s-1))}function He(e,t,r,n){const a=Be(e,t,r,n);if(!Array.isArray(a))return a;const i=r.mathpack,[s,u,l,c]=a;if(s<1)return o.div0ErrorOper;const d=i.mul(u,u);if((0,p.isErrorOper)(d))return d;const g=i.mul(l,i.fromNumber(s));if((0,p.isErrorOper)(g))return g;const m=(0,L.assertNumber)(i.sub(g,d));if(0===i.cond(c))return i.cond(m)<0?i.zero:i.div(m,i.fromNumber(s*s));if(i.cond(m)>=0){const e=(0,L.assertNumber)(i.div(m,i.fromNumber(s*s))),t=21219957905e-324;if(i.cond2(e,i.fromNumber(t))>0){const t=i.div((0,L.assertNumber)(i.div(d,i.fromNumber(s))),l),r=(0,p.isErrorOper)(t)?t:i.sub(t,i.one);if(!(0,p.isErrorOper)(r)&&i.cond2(i.abs(r),i.fromNumber(.01))>0){const t=i.div(c,e),r=(0,p.isErrorOper)(t)?t:i.sub(i.abs(t),i.fromNumber(1e3));if(!(0,p.isErrorOper)(r)&&i.cond(r)<0)return e}}}const h=Ve(e,t,r,n,c);return i.cond(h)<0?i.zero:i.div(h,i.fromNumber(s))}t.quartile_exc=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return Ke(e,r,n)},t.median=function(e,t){const r=e.dereferenceAllOpers(t);return We(e,r)},t.trimmean=function(e,t){const[r,n]=e.dereferenceAllOpers(t);let i=[];const o=(0,w.reduceDerefOpers)(e,Ie(i,L.assertNumber),H,[r]);if(null==o)return s.numErrorOper;if((0,p.isErrorOper)(o))return o;const u=e.mathpack;if(u.cond(n)<0)return s.numErrorOper;if(u.cond2(n,u.one)>=0)return s.numErrorOper;i=i.sort(u.cond2);const l=u.lfix((0,L.assertNumber)(u.div((0,L.assertNumber)(u.mul(u.fromNumber(i.length),n)),u.fromNumber(2))));(0,a.assertTrue)("calc.funcs.trimmean",l+l<i.length);const c=i[l],d=i[i.length-1-l];let g=0,m=0;const h=(0,w.reduceDerefOpers)(e,z(e.mathpack.add),((e,t)=>{const r=H(0,t);if(void 0===r)return r;(0,a.assertTrue)("calc.funcs.trimmean: unexpected error",(0,b.isNumberOper)(r));const n=e.mathpack;if(n.cond2(r,c)<0)g+=1;else{if(!(n.cond2(r,d)>0))return r;m+=1}}),[r]);(0,a.assertTrue)("calc.funcs.trimmean: found no elements",void 0!==h&&(0,b.isNumberOper)(h)),(0,a.assertTrue)("calc.funcs.trimmean: trimmed too many",g<=l&&m<=l);let f=h;for(;g<l;g+=1){const e=u.sub(f,c);if((0,p.isErrorOper)(e))return e;f=e}for(;m<l;m+=1){const e=u.sub(f,d);if((0,p.isErrorOper)(e))return e;f=e}return u.div(f,u.fromNumber(i.length-l-l))};const qe=je.bind(void 0,H,void 0),ze=He.bind(void 0,H,void 0),Qe=je.bind(void 0,q,H),$e=He.bind(void 0,q,H);function Ye(e){return function(t,r){const n=e(t,r);return(0,b.isNumberOper)(n)?t.mathpack.sqrt(n):n}}const Je=Ye(qe),Xe=Ye(ze),Ze=Ye(Qe),et=Ye($e);t.stdev=function(e,t){const r=e.dereferenceAllOpers(t);return Je(e,r)},t.stdevp=function(e,t){const r=e.dereferenceAllOpers(t);return Xe(e,r)},t.stdeva=function(e,t){const r=e.dereferenceAllOpers(t);return Ze(e,r)},t.stdevpa=function(e,t){const r=e.dereferenceAllOpers(t);return et(e,r)},t.var_=function(e,t){const r=e.dereferenceAllOpers(t);return qe(e,r)},t.varp=function(e,t){const r=e.dereferenceAllOpers(t);return ze(e,r)},t.vara=function(e,t){const r=e.dereferenceAllOpers(t);return Qe(e,r)},t.varpa=function(e,t){const r=e.dereferenceAllOpers(t);return $e(e,r)};const tt=[se,ge,he,ye,be,ne,Je,Xe,X,qe,ze];function rt(e,t){const r=[],n=(0,w.reduceDerefOpers)(e,(i=r,(e,t,r)=>{if(void 0!==e&&(0,p.isErrorOper)(e))return e;if((0,b.isNumberOper)(t))for(let e=0;e<r;e+=1)i.push({value:t,index:i.length});return t}),H,t);var i;if(null==n)return c.naErrorOper;if((0,p.isErrorOper)(n))return n;const o=e.mathpack,s=r.sort(((e,t)=>o.cond2(e.value,t.value)));let u=1,l=0,d=1/0;const g=[];function m(e){u=1,d=e.index}const h=e=>{const{value:t}=e;u>l?(l=u,g.length=0,g.push({value:t,index:d})):u===l&&g.push({value:t,index:d})};m(s[0]);for(let e=1;e<s.length;e+=1)S=s[e-1],v=s[e],0===o.cond2(S.value,v.value)?((f=s[e]).index<d&&(d=f.index),u+=1):(h(s[e-1]),m(s[e]));var f,S,v;return h(s[s.length-1]),l<2?c.naErrorOper:((0,a.assertTrue)("calc.funcs.modeInner: unexpected error",0!==g.length),g.sort(((e,t)=>e.index-t.index)))}function nt(e,t){const r=rt(e,t);return Array.isArray(r)?r[0].value:r}t.mode=function(e,t){return nt(e,t)},t.mode_mult=function(e,t){const r=rt(e,t);return Array.isArray(r)?(0,d.arrayOper)(r.length,1,r.map((e=>[e.value]))):r};const at=(0,G.binaryVisitor)({...(0,B.constVisitor)(!1),wsfNode:e=>e===D.WorksheetFuncId.SUBTOTAL||e===D.WorksheetFuncId.AGGREGATE},((e,t)=>e||t));function it(e){if(!(0,R.isRangeValues)(e))return e;const t=e.arrays.map((e=>e.map((([e,t])=>{return void 0!==t&&(r=t.formula,(0,V.reduceBottomUp)(at,r))?void 0:e;var r}))));return(0,R.rangeValues)(t)}t.subtotal=function(e,[t,...r]){const n=e.mathpack.sfix(t),a=tt.length;if(!(n>=1&&n<=a||n>=101&&n<=a+100))return i.valueErrorOper;const o=n>100||e.isInFilterMode(r),s=e.dereferenceAllOpersAndFormulae(r,o).map(it);return(0,tt[n%100-1])(e,s)};const ot=[...tt,We,nt],st=[Pe,Me,we,xe,Le,Ke];function ut(e,[t,r,n=h.falseOper],a){const i=n.value?1:-1;let o=0,s=0;const u=e.mathpack,l=(0,w.reduceDerefOpers)(e,((e,r,n)=>{if(void 0!==e)return e;if((0,p.isErrorOper)(r))return r;const a=u.cond2(t,(0,L.assertNumber)(r));0===a?o+=n:a===i&&(s+=n)}),H,e.dereferenceAllOpers([r]));if(void 0!==l)return l;if(0===o)return c.naErrorOper;const d=u.fromNumber(s+1);if(a){const e=u.div(u.fromNumber(o-1),u.fromNumber(2));return u.add(d,(0,L.assertNumber)(e))}return d}function lt(e){return function(t,r){const n=e(t,r);return n?.kind===x.OperKind.Number?t.mathpack.abs(n):n}}function ct(e,t,r){const n=ae(H,void 0,!0,s.numErrorOper,t,r);if(!Array.isArray(n))return n;const[i,o]=n,u=(0,w.reduceDerefOpers)(t,z(t.mathpack.add),e(function(e,t){return function(r,n){const a=e(r,n);return a?.kind===x.OperKind.Number?r.mathpack.sub(a,t):a}}(H,i)),r);return(0,a.assertTrue)("calc.funcs.sumDevAndCount",void 0!==u),(0,p.isErrorOper)(u)?u:[(0,L.assertNumber)(u),o]}t.aggregate=function(e,t){const[r,n,o,s,...u]=t,l=e.mathpack,c=l.sfix(r),d=l.sfix(n);if(!(c>=1&&c<=ot.length+st.length&&d>=0&&d<=7))return i.valueErrorOper;const g=1==(1&d),m=2==(2&d),h=!(4==(4&d));function f(t){let r=h?e.dereferenceAllOpersAndFormulae(t,g).map(it):e.dereferenceAllOpers(t,g);return m&&(r=r.map((e=>{if((0,w.isPrimitiveCoercedOper)(e))return e;if((0,R.isRangeValues)(e)){const t=e.arrays.map((e=>e.map((e=>void 0===e||(0,p.isErrorOper)(e)?void 0:e))));return(0,R.rangeValues)(t)}if((0,w.isCoercedArrayOper)(e)){const t=e.opers.map((e=>e.map((e=>void 0===e||(0,p.isErrorOper)(e)?void 0:e))));return(0,w.coercedArrayOper)(e.rows,e.cols,t)}return e}))),r}if(c>ot.length){if(void 0===s||u.length>0)return i.valueErrorOper;const t=x.OperKind.Number;!(0,S.isRangeOper)(s)||(0,y.isSheetIndex)(s.sheets)&&1===s.ranges.length&&(0,N.isGridCell)(s.ranges[0])||(0,j.throwEvaluationError)((0,T.notImplemented)(["AGGREGATE multi-cell array param"]));const r=e.coerceOper(e.dereferenceOper(s,t),t);if((0,p.isErrorOper)(r))return i.valueErrorOper;if((0,S.isRangeOper)(o)&&!(0,y.isSheetIndex)(o.sheets))return i.valueErrorOper;const[n]=f([o]);return(0,st[c-ot.length-1])(e,n,r)}for(let e=2;e<t.length;e+=1){const r=t[e];if(!r||!(0,S.isRangeOper)(r)||!(0,y.isSheetIndex)(r.sheets))return i.valueErrorOper}const v=f(t.slice(2));return(0,a.assertTrue)("calc.funcs.aggregate: requested non-array function with unexpected number",c>=1&&c<=ot.length),(0,ot[c-1])(e,v)},t.rank=function(e,t){return ut(e,t,!1)},t.rank_avg=function(e,t){return ut(e,t,!0)},t.avedev=function(e,t){const r=e.dereferenceAllOpers(t),n=ct(lt,e,r);if(!Array.isArray(n))return n;const[a,i]=n;return e.mathpack.div(a,e.mathpack.fromNumber(i))},t.devsq=function(e,t){const r=e.dereferenceAllOpers(t),n=ct(Ue,e,r);if(!Array.isArray(n))return n;const[a]=n;return a};const dt=new Float64Array(1),gt=new Int32Array(dt.buffer);function mt(e,t){dt[0]=e.toNumber(t);const r=((2146435072&gt[1])>>>20)-1023;return gt[1]=-2146435073&gt[1]|1072693248,[e.fromNumber(dt[0]),r]}function ht(e,t,r){dt[0]=e.toNumber(t);const n=((2146435072&gt[1])>>>20)-1023;return gt[1]=-2146435073&gt[1]|n+r+1023<<20&2146435072,e.fromNumber(dt[0])}t.geomean=function(e,t){const r=e.mathpack,n=e.dereferenceAllOpers(t),i={count:0,prodExp:0};let o=(0,w.reduceDerefOpers)(e,function(e,t){const r=e.mathpack;return function(e,n,i){if(void 0!==e&&(0,p.isErrorOper)(e))return e;if((0,a.assertTrue)("calc.funcs.geometricReducer",void 0===e||(0,b.isNumberOper)(e)),(0,p.isErrorOper)(n))return n;if((0,a.assertTrue)("calc.funcs.geometricReducer",(0,b.isNumberOper)(n)),r.cond(n)<=0)return s.numErrorOper;const[o,u]=mt(r,n);let l=e??r.one;for(let e=0;e<i;e+=1){if(t.count%512==511){const[e,n]=mt(r,l);if(t.prodExp+=n,l=e,t.prodExp>2130706431||t.prodExp<-2130706431)return s.numErrorOper}t.count+=1,t.prodExp+=u,l=r.mul(l,o),(0,a.assertTrue)("calc.funcs.geometricReducer",!(0,p.isErrorOper)(l))}return l}}(e,i),H,n);if(null==o)return s.numErrorOper;if((0,p.isErrorOper)(o))return o;if((0,a.assertTrue)("calc.funcs.geomean",i.count>0&&(0,b.isNumberOper)(o)),1===i.count)return ht(r,o,i.prodExp);{const[e,t]=mt(r,o);i.prodExp+=t,o=e}const u=i.prodExp/i.count|0,l=i.prodExp%i.count,c=r.div(r.one,r.fromNumber(i.count));if((0,a.assertTrue)("calc.funcs.geomean",!(0,p.isErrorOper)(c)),l<=1e3){const e=ht(r,o,l),t=r.power(e,c);return(0,a.assertTrue)("calc.funcs.geomean",!(0,p.isErrorOper)(t)),ht(r,t,u)}const d=l-1e3,g=ht(r,o,l-d),m=r.power(g,c);(0,a.assertTrue)("calc.funcs.geomean",!(0,p.isErrorOper)(m));const h=ht(r,m,u),f=r.mul(r.fromNumber(i.count),r.fromNumber(1.4426950408889636));(0,a.assertTrue)("calc.funcs.geomean",!(0,p.isErrorOper)(f));const S=r.div(r.fromNumber(d),f);(0,a.assertTrue)("calc.funcs.geomean",!(0,p.isErrorOper)(S));const v=r.exp(S);return(0,p.isErrorOper)(v)?v:r.mul(h,v)},t.harmean=function(e,t){const r=e.dereferenceAllOpers(t),n=(i=H,function(e,t){const r=i(e,t);if(void 0===r||!(0,b.isNumberOper)(r))return r;const n=e.mathpack;return n.cond(r)<=0?s.numErrorOper:n.div(n.one,r)});var i;const o=(0,w.reduceDerefOpers)(e,z(e.mathpack.add),n,r);if(null==o)return c.naErrorOper;if((0,p.isErrorOper)(o))return o;const u={count:0},l=(0,w.reduceDerefOpers)(e,Q(u),n,r);(0,a.assertTrue)("calc.funcs.harmean",(0,b.isNumberOper)(o)&&l?.kind===x.OperKind.Number&&u.count>0);const d=e.mathpack.div(o,e.mathpack.fromNumber(u.count));return(0,p.isErrorOper)(d)?d:e.mathpack.div(e.mathpack.one,d)};const pt=e=>(0,f.isRichOper)(e)?e.getFallback():e;t.sumproduct=(e,t)=>{const r=t.map((e=>(0,d.arrayOper)(e.rows,e.cols,e.opers.map((e=>e.map(pt)))))),n=e.mathpack;for(const e of r)for(const t of e.opers)for(const e of t)if((0,p.isErrorOper)(e))return e;const a=r[0].rows,o=r[0].cols;if(!r.every((e=>e.rows===a&&e.cols===o)))return i.valueErrorOper;let s=n.zero;for(let e=0;e<a;++e)e:for(let t=0;t<o;++t){const a=r[0].opers[e][t];if(!(0,b.isNumberOper)(a))continue e;let i=a;for(let a=1;a<r.length;++a){const o=r[a].opers[e][t];if(!(0,b.isNumberOper)(o))continue e;if(i=n.mul(i,o),(0,p.isErrorOper)(i))return i}if(s=n.add(i,s),(0,p.isErrorOper)(s))return s}return s}},405:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unique=t.sortby=t.sort=t.filter=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6366),u=r(6366),l=r(6366),c=r(6366),d=r(6366),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(6067),E=r(6067),T=r(5146),R=r(7985),k=r(7674);function N(e){return(0,h.isBlankOper)(e)?(0,y.arrayOper)(1,1,[[e]]):e}function I(e,t=F.missingOper,r,n){const a=e.mathpack,i=(0,S.isMissingOper)(t)?(0,y.arrayOper)(1,1,[[a.one]]):t;if(!(1===i.rows&&i.cols>=1||1===i.cols&&i.rows>=1))return E.valueErrorOper;if(i.rows*i.cols>r)return E.valueErrorOper;const o=[];for(let t=0;t<i.rows;++t)for(let r=0;r<i.cols;++r){const s=e.coerceOper(i.opers[t][r],g.OperKind.Number);if(!(0,v.isNumberOper)(s))return(0,k.assertError)(s);const u=n(a.sfix(s));if("number"!=typeof u)return u;o.push(u)}return o}function O(e,t){return t?new o.NonstrictArray2D(e.cols,e.rows,((t,r)=>e.opers[r][t])):new i.StrictArray2D(e.rows,e.cols,e.opers)}function P(e,t,r,a){const{rows:i,cols:s}=t,l=e.config,c=[];for(let e=0;e<i;++e)c.push(e);c.sort(((e,t)=>{for(let r=0;r<a.length;++r){const[n,i]=a[r],o=(0,R.sortOpers)(l,n(e),n(t),i,!1);if(0!==o)return o}return e-t}));const d=new o.NonstrictArray2D(i,s,((e,r)=>t.get(c[e],r))),g=r?(0,n.transposeArray2D)(d):d;return(0,y.arrayOper)(g.rows,g.cols,(0,u.array2DToJaggedArray)(g))}t.filter=function(e,t){const[r,l,c]=t,d=(0,k.rangeOrArrayToVal)(r,A.refErrorOper);if((0,f.isErrorOper)(d))return d;const m=(0,k.rangeOrArrayToVal)(l,A.refErrorOper);if((0,f.isErrorOper)(m))return m;const{rows:h,cols:v}=(0,k.makeSlicer)(d),{rows:F,cols:R}=(0,k.makeSlicer)(m);if(!(1===F&&R>=1||1===R&&F>=1))return E.valueErrorOper;const N=1===F&&1===R?1===h:F>1;if(N?F!==h:R!==v)return E.valueErrorOper;const[I]=e.dereferenceAllOpers([m]),O=(0,a.sparseArray2DTo1D)((0,T.isRangeValues)(I)?I.arrays[0]:new s.StrictSparseArray2D(I.rows,I.cols,I.rows,I.cols,I.opers,b.blankOper),!N),P=[];for(let t=0;t<O.length;++t){const r=e.coerceOper(O.get(t),g.OperKind.Boolean);if(!(0,p.isBooleanOper)(r))return r;if(r.value)P.push(t);else if(t>=O.denseLength)break}if(N?(0,k.validateArraySize)(P.length,v):(0,k.validateArraySize)(h,P.length),0===P.length)return void 0===c||(0,S.isMissingOper)(c)?C.calcErrorOper:c;const[M]=e.dereferenceAllOpers([d]),D=(0,T.isRangeValues)(M)?M.arrays[0]:new i.StrictArray2D(M.rows,M.cols,M.opers),w=e=>new o.NonstrictArray2D(P.length,e.cols,((t,r)=>e.get(P[t],r))),L=N?w(D):(0,n.transposeArray2D)(w((0,n.transposeArray2D)(D)));return(0,y.arrayOper)(L.rows,L.cols,(0,u.array2DToJaggedArray)(L))},t.sort=function(e,t){const[r,n,a,i]=t,o=N(r),s=!!i&&i.value,u=O(o,s),l=u.cols,c=I(e,n,l,(e=>e>=1&&e<=l?e-1:E.valueErrorOper));if(!Array.isArray(c))return c;const g=I(e,a,c.length,(e=>1===e||-1===e?e:E.valueErrorOper));if(!Array.isArray(g))return g;if(1===g.length)g.length=c.length,(0,d.arrayFill)(g,g[0]);else if(g.length!==c.length)return E.valueErrorOper;const m=c.map(((e,t)=>[t=>u.get(t,e),g[t]]));return 1===u.rows?o:P(e,u,s,m)},t.sortby=function(e,t){const[r,...n]=t,a=N(r);(0,l.assertTrue)("calc.funcs.sortby",n.every(((e,t)=>t%2==0?(0,m.isArrayOper)(e)||(0,h.isBlankOper)(e):(0,v.isNumberOper)(e)||(0,S.isMissingOper)(e))));const i=[];for(let e=0;e<n.length;e+=2)i.push([N(n[e]),n[e+1]??F.missingOper]);const o=i[0][0].cols>=i[0][0].rows&&i[0][0].cols===a.cols,s=O(a,o),u=[];for(const[t,r]of i){if(1!==t.rows&&1!==t.cols)return E.valueErrorOper;if(!(o?t.cols===a.cols:t.rows===a.rows))return E.valueErrorOper;const n=t.opers,i=e.mathpack.sfix((0,v.isNumberOper)(r)?r:e.mathpack.one);if(1!==i&&-1!==i)return E.valueErrorOper;u.push([o?e=>n[0][e]:e=>n[e][0],i])}return 1===s.rows?a:P(e,s,o,u)},t.unique=function(e,t){const[r,a,i]=t,s=N(r),l=a?.value??!1,d=i?.value??!1,g=O(s,l);if(1===g.rows)return s;const m=e.config,h=[];let p=c.RedBlackMapTree.create(((e,t)=>{for(let r=0;r<g.cols;++r){const n=(0,R.sortOpers)(m,g.get(e,r),g.get(t,r),1,!0);if(0!==n)return n}return 0}));for(let e=0;e<g.rows;++e){let t;[p,t]=p.getOrSetValue(e,(()=>({firstRow:e,count:0}))),t.count+=1,h.push(t)}const f=d?h.filter((e=>1===e.count)):h.filter(((e,t)=>e.firstRow===t));if(0===f.length)return C.calcErrorOper;const S=new o.NonstrictArray2D(f.length,g.cols,((e,t)=>g.get(f[e].firstRow,t))),v=l?(0,n.transposeArray2D)(S):S;return(0,y.arrayOper)(v.rows,v.cols,(0,u.array2DToJaggedArray)(v))}},7716:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyCriteria=t.compileCriteria=t.parseCriteria=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6366),l=r(6366),c=r(4171),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6366),v=r(2443),F=r(6880),y=r(6067),b={"=":s.OperatorId.Eq,"<":s.OperatorId.Lt,">":s.OperatorId.Gt},C={"<>":s.OperatorId.Ne,"<=":s.OperatorId.Le,">=":s.OperatorId.Ge};function A(e,t){if(!(0,h.isStringOper)(t))return t;const[r,s]=function(e){if(e.length>=2){const t=C[e.substring(0,2)];if(void 0!==t)return[t,e.substring(2)]}if(e.length>=1){const t=b[e.substring(0,1)];if(void 0!==t)return[t,e.substring(1)]}return[void 0,e]}(t.value),u=function(e,t){const{localeInfo:r}=e.config;if(0===r.stringCompareCI(t,r.trueName))return a.trueOper;if(0===r.stringCompareCI(t,r.falseName))return i.falseOper;for(let e=1;e<r.errorNames.length;e+=1){const a=r.errorNames[e];if(null!=a&&0===r.stringCompareCI(a,t))return(0,n.errorOper)(e)}const s=e.parseGeneral(t,!1);return void 0!==s?s:(0,o.stringOper)(t)}(e,s);return{kind:"FilterExpression",operator:r,operand:u}}function E(e,t){const r="FilterExpression"===t.kind?t:{kind:"FilterExpression",operator:s.OperatorId.Eq,operand:t},{mathpack:n,localeInfo:a}=e.config;if(r.operator===s.OperatorId.Ne&&(0,F.isEmptyStringOper)(r.operand))return e=>!(0,d.isBlankOper)(e);if(r.operator===s.OperatorId.Eq&&(0,F.isEmptyStringOper)(r.operand))return d.isBlankOper;if(void 0!==r.operator&&(0,F.isEmptyStringOper)(r.operand))return e=>!1;if(void 0===r.operator&&(0,F.isEmptyStringOper)(r.operand))return e=>(0,d.isBlankOper)(e)||(0,F.isEmptyStringOper)(e);const i=void 0===r.operator?s.OperatorId.Eq:r.operator;switch(r.operand.kind){case y.OperKind.Number:return o=i,u=r.operand,t=>{const r=(0,m.isRichOper)(t)?t.getFallback():t;if((0,f.isNumberOper)(r))return(0,c.cmpNum)(n,o,r,u);if((0,h.isStringOper)(r)&&o===s.OperatorId.Eq){const t=e.parseGeneral(r.value,!1);return void 0!==t&&(0,c.cmpNum)(n,o,t,u)}return o===s.OperatorId.Ne};case y.OperKind.Boolean:return function(e,t){return r=>{const n=(0,m.isRichOper)(r)?r.getFallback():r;return(0,p.isBooleanOper)(n)?(0,c.cmpBool)(e,n,t):e===s.OperatorId.Ne}}(i,r.operand);case y.OperKind.String:return function(e,t){switch(e){case s.OperatorId.Eq:case s.OperatorId.Ne:const r=new v.WildExp(a,t.value);return t=>{const n=(0,m.isRichOper)(t)?t.getFallback():t;return(0,h.isStringOper)(n)?r.test(n.value)===(e===s.OperatorId.Eq):e===s.OperatorId.Ne};case s.OperatorId.Lt:case s.OperatorId.Gt:case s.OperatorId.Le:case s.OperatorId.Ge:return r=>{const n=(0,m.isRichOper)(r)?r.getFallback():r;return!!(0,h.isStringOper)(n)&&(0,c.cmpStr)(a,e,n,t)}}}(i,r.operand);case y.OperKind.Error:return function(e,t){return r=>{const n=(0,m.isRichOper)(r)?r.getFallback():r;return(0,g.isErrorOper)(n)?(0,c.cmpInt)(e,n.type-t.type):e===s.OperatorId.Ne}}(i,r.operand);default:return(0,S.assertNever)("calc.funcs.criteria.compileCriteria",r.operand)}var o,u}t.parseCriteria=A,t.compileCriteria=E,t.applyCriteria=function(e,t,r,n){const a=E(e,A(e,r)),i=t,o=void 0===n?i:n;return new u.NonstrictSparseArray2D(o.rows,o.cols,(0,l.fastMax)(i.denseRows,o.denseRows),(0,l.fastMax)(i.denseCols,o.denseCols),((e,t)=>{const r=i.get(e,t);return a(r)?o.get(e,t):void 0}),(()=>{const e=i.getSparse();return a(e)?o.getSparse():void 0}))}},3273:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.yearFrac=t.networkdays=t.networkdays_intl=t.eomonth=t.edate=t.workday=t.workday_intl=t.days=t.datedif=t.days360=t.time=t.date=t.weeknum=t.isoweeknum=t.weekday=t.second=t.minute=t.hour=t.day=t.month=t.year=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(7674),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6366),S=r(6067),v=r(6366);function F(e,t,[r]){const{datepack:a,config:i}=t,o=a.fromNum(i,r,l.Rounding.RoundSec);return!1===o?n.numErrorOper:t.mathpack.fromNumber(e(o))}function y(e,[t,r],a=!1){const{config:i,mathpack:o,datepack:s}=e,u=s.fromNum({...i,date1904:i.date1904&&!a},t,l.Rounding.RoundSec);if(!1===u)return n.numErrorOper;let c;switch(void 0!==r?o.sfix(r):1){case 1:case 17:c=u.wdy;break;case 2:case 11:c=1===u.wdy?7:u.wdy-1;break;case 3:c=1===u.wdy?6:u.wdy-2;break;case 12:c=(u.wdy+4)%7+1;break;case 13:c=(u.wdy+3)%7+1;break;case 14:c=(u.wdy+2)%7+1;break;case 15:c=(u.wdy+1)%7+1;break;case 16:c=u.wdy%7+1;break;default:return n.numErrorOper}return o.fromNumber(c)}function b(e,t,r){if(!t){const t=e.lfix(r);if(0===t||1===t)return e.fromNumber(52)}return n.numErrorOper}function C(e,t,[r,a]){const i=(0,c.chkDateOper)(t,r);if((0,d.isErrorOper)(i))return i;const[o,s]=function(e,t,r){if(void 0===t||(0,g.isMissingOper)(t))return[r?2:1,r];const n=(0,c.chkNumOper)(e,t);if(!(0,d.isErrorOper)(n)){const t=e.mathpack.sfix(n);if(r){if(1===t||2===t)return[t,r]}else{if(1===t||2===t)return[t,r];if(t>=11&&t<=16)return[t-9,r];if(17===t)return[1,r];if(21===t)return[2,!0]}}return[void 0,r]}(t,a,e);if(void 0===o)return n.numErrorOper;const{mathpack:m,datepack:h,config:p}=t,f={...p,date1904:!1},S=h.fromNum(f,i,l.Rounding.RoundSec);if(!1===S)return b(m,f.dateCompatibility,i);const F=(0,u.dateTime)(S.yr,1,1,0,0,0,0,0,l.Rounding.RoundSec),C=h.toNum(f,F);if((0,d.isErrorOper)(C))return b(m,f.dateCompatibility,i);const A=y(t,[C],!0);if((0,d.isErrorOper)(A))return A;const E=(0,c.assertNumber)(m.add((0,c.assertNumber)(m.sub(A,m.fromNumber(o))),m.fromNumber(7))),T=(0,c.assertNumber)((0,c.numMod)(m,E,m.fromNumber(7))),R=(0,c.assertNumber)(m.add(m.floor((0,c.assertNumber)(m.div((0,c.assertNumber)(m.add((0,c.assertNumber)(m.sub(i,C)),T)),m.fromNumber(7)))),m.one));return s?function(e,t,r,n){const{mathpack:a,datepack:i,config:o}=e,s={...n},u=(t+6-s.wdy)%7;if(12===s.mon&&s.dom+u>=35)return a.one;s.dom=4,s.mon=1;let l=i.toDays(o,s);if((0,v.assertTrue)("calc.funcs.weeknumISOAmendments",!1!==l),l=(l-1)%7+1,(l-t+7)%7<3){const e=(0,c.assertNumber)(a.sub(r,a.one));if(0===a.cond(e)){const e=s.yr-1;return t===l||e%4==0&&(e%100!=0||e%400==0)&&(t-l+7)%7==6?a.fromNumber(53):a.fromNumber(52)}return e}return r}(t,o,R,S):R}t.year=F.bind(void 0,(e=>e.yr)),t.month=F.bind(void 0,(e=>e.mon)),t.day=F.bind(void 0,(e=>e.dom)),t.hour=F.bind(void 0,(e=>e.hour)),t.minute=F.bind(void 0,(e=>e.min)),t.second=F.bind(void 0,(e=>e.sec)),t.weekday=function(e,t){return y(e,t)},t.isoweeknum=C.bind(void 0,!0),t.weeknum=C.bind(void 0,!1);const A=-32768,E=32767,T=1900;function R(e,t){let r;if((0,h.isStringOper)(t)){const n=t.value.replace(/^\s+/,"");if(r=e.coerceOper((0,s.stringOper)(n),S.OperKind.Number),(0,d.isErrorOper)(r))return r}else r=t;return(0,c.chkDateOper)(e,r)}function k(e,t,r){return r?(0,c.assertNumber)(e.sub(t,e.fromNumber(c.atpm1904to1900Days))):t}function N(e,t){return 0!=(e>>t%7&1)}var I;function O(e){switch(e){case 1:return I.Saturday|I.Sunday;case 2:return I.Sunday|I.Monday;case 3:return I.Monday|I.Tuesday;case 4:return I.Tuesday|I.Wednesday;case 5:return I.Wednesday|I.Thursday;case 6:return I.Thursday|I.Friday;case 7:return I.Friday|I.Saturday;case 11:return I.Sunday;case 12:return I.Monday;case 13:return I.Tuesday;case 14:return I.Wednesday;case 15:return I.Thursday;case 16:return I.Friday;case 17:return I.Saturday;default:return!1}}function P(e){if(7!==e.length)return!1;let t=I.None;for(let r=0;r<e.length;r+=1)if("1"===e[r])t|=1<<(r+2)%7;else if("0"!==e[r])return!1;return t}function M(e,[t,r,a,o]){let s=I.Saturday|I.Sunday,u=(0,c.chkDateOper)(e,t);if((0,d.isErrorOper)(u))return u;let l=(0,c.chkNumOper)(e,r);if((0,d.isErrorOper)(l))return l;const{mathpack:m,config:v}=e;l=m.floor(l);const F=m.cond(l)>0?m.one:m.fromNumber(-1);let y=m.abs(l);const b=(0,c.assertNumber)(m.add(u,l));if(!(0,c.validDateRange)(e,b))return n.numErrorOper;if(0===m.cond(y))return k(m,u,v.date1904);let C=null;const A=[];if(a){if(!(0,g.isMissingOper)(a)){if((0,p.isNumberOper)(a)){const e=O(m.lfix(a));if(!1===e)return n.numErrorOper;s=e}else{if(!(0,h.isStringOper)(a))return n.numErrorOper;{const e=P(a.value);if(!1===e)return i.valueErrorOper;s=e}}if(127===s)return i.valueErrorOper}if(o&&!(0,g.isMissingOper)(o)){const t=(0,c.chkNumMultiOper)(e,o);if(!(0,f.isSuccess)(t))return t.reason;C=t.value}}const E=null==C?[]:function(e){const t=[],r=e.getSparse(),n=e.cols-e.denseCols;for(let a=0;a<e.denseRows;a+=1){for(let r=0;r<e.denseCols;r+=1){const n=e.get(a,r);void 0!==n&&t.push(n)}if(n>0&&void 0!==r)for(let e=0;e<n;e+=1)t.push(r)}const a=(e.rows-e.denseRows)*e.cols;if(a>0&&void 0!==r)for(let e=0;e<a;e+=1)t.push(r);return t}(C);for(let t=E.length-1;t>=0;t-=1){const r=E[t];switch(r.kind){case S.OperKind.Number:case S.OperKind.String:case S.OperKind.Blank:const n=(0,c.chkDateOper)(e,r);if((0,d.isErrorOper)(n))return n;A[t]=n;break;case S.OperKind.Error:return r;default:return i.valueErrorOper}}for(;m.cond(y)>0;){if(u=(0,c.assertNumber)(m.add(u,F)),N(s,m.lfix(u)))continue;let e=!0;for(let t=0;t<E.length;t+=1)if(0===m.cond2(A[t],u)){e=!1;break}e&&(y=(0,c.assertNumber)(m.sub(y,m.one)))}return u=k(m,u,v.date1904),(0,c.validDateRange)(e,u)?u:n.numErrorOper}t.date=function(e,[t,r,a]){const{mathpack:i,datepack:o,config:s}=e;let c=i.sfix(t);if(c>9999)return n.numErrorOper;const d=i.sfix(r);if(d>E||d<A)return n.numErrorOper;let g=i.sfix(a);(g>E||g<A)&&(g=E),s.dateCompatibility?c<T&&(c+=1900):c<T&&!(1899===c&&12===d&&g>=30)&&(c+=1900);const m=(0,u.dateTime)(c,d,g,0,0,0,0,0,l.Rounding.RoundSec);return o.toNum(s,m)},t.time=function(e,[t,r,a]){const{mathpack:i,datepack:o,config:s}=e,c=i.sfix(t);if(c>32767)return n.numErrorOper;const g=i.sfix(r);if(g>32767)return n.numErrorOper;const m=i.sfix(a);if(m>32767)return n.numErrorOper;let h,p,f;s.dateCompatibility?(h=s.date1904?1904:1900,p=1,f=s.date1904?1:0):(h=1899,p=12,f=30);const S=(0,u.dateTime)(h,p,f,c,g,m,0,0,l.Rounding.RoundSec),v=o.toNum(s,S);return(0,d.isErrorOper)(v)?v:i.cond(v)<0?n.numErrorOper:i.sub(v,i.trunc(v))},t.days360=function(e,[t,r,n]){const{mathpack:i,datepack:o,config:s}=e,u=n?.value??!1,c=o.fromNum(s,t,l.Rounding.RoundSec);if(!1===c)return a.naErrorOper;const d=31===c.dom||!u&&2===c.mon&&c.dom===o.daysPerMonth(2,c.yr,s.dateCompatibility)?30:c.dom,g=i.fromNumber(360*(c.yr-T)+30*c.mon+d),m=o.fromNum(s,r,l.Rounding.RoundSec);if(!1===m)return a.naErrorOper;const h=31!==m.dom||!u&&30!==c.dom?m.dom:30,p=i.fromNumber(360*(m.yr-T)+30*m.mon+h);return i.sub(p,g)},t.datedif=function(e,[t,r,{value:a}]){if(a.length>2||0===a.length)return n.numErrorOper;const{mathpack:i,datepack:o,config:s}=e,u=i.lfix(t),c=o.fromNum(s,t,l.Rounding.RoundSec);if(!1===c)return n.numErrorOper;const d=e.mathpack.lfix(r),g=o.fromNum(s,r,l.Rounding.RoundSec);if(!1===g)return n.numErrorOper;if(u>d)return n.numErrorOper;let m=g.dom,h=g.mon,p=g.yr;c.dom>m&&(h-=1,0===h&&(h=12,p-=1),m+=o.daysPerMonth(h,p,s.dateCompatibility)),c.mon>h&&(h+=12,p-=1);const f=(e,t)=>0===s.localeInfo.stringCompareCI(e,t);if(f(a,"Y"))return i.fromNumber(p-c.yr);if(f(a,"M"))return i.fromNumber(12*(p-c.yr)+(h-c.mon));if(f(a,"D"))return i.fromNumber(d-u);if(f(a,"MD"))return i.fromNumber(m-c.dom);if(f(a,"YM"))return i.fromNumber(h-c.mon);if(f(a,"YD")){let e=0;for(let t=c.mon;t<h;t+=1)e+=o.daysPerMonth(t,c.yr,s.dateCompatibility);return i.fromNumber(e+(m-c.dom))}return n.numErrorOper},t.days=function(e,[t,r]){if((0,h.isStringOper)(t)&&t.value.length>255||(0,h.isStringOper)(r)&&r.value.length>255)return i.valueErrorOper;const n=R(e,t);if((0,d.isErrorOper)(n))return n;const a=R(e,r);return(0,d.isErrorOper)(a)?a:e.mathpack.sub(n,a)},function(e){e[e.None=0]="None",e[e.Saturday=1]="Saturday",e[e.Sunday=2]="Sunday",e[e.Monday=4]="Monday",e[e.Tuesday=8]="Tuesday",e[e.Wednesday=16]="Wednesday",e[e.Thursday=32]="Thursday",e[e.Friday=64]="Friday"}(I||(I={})),t.workday_intl=M,t.workday=function(e,[t,r,n]){return M(e,n?[t,r,o.missingOper,n]:[t,r])};const D=1900,w=-9999;function L(e,t,[r,a]){const i=(0,c.chkDateOper)(t,r);if((0,d.isErrorOper)(i))return i;let o=(0,c.chkNumOper)(t,a);if((0,d.isErrorOper)(o))return o;const{mathpack:s,config:g}=t;o=s.cond(o)>0?s.floor(o):s.ceil(o);const m=function(e,t,r,n){const{mathpack:a,datepack:i,config:o}=e,s={...o,date1904:!1},g=i.fromNum(s,t,l.Rounding.RoundSec);if(!1===g)return g;let m=a.fromNumber(g.dom),h=a.fromNumber(g.mon);const p=a.fromNumber(12);let f=a.fromNumber(g.yr);if(a.cond(r)>=0){f=(0,c.assertNumber)(a.add(a.floor((0,c.assertNumber)(a.div(r,p))),f));const e=(0,c.assertNumber)((0,c.numMod)(a,r,p)),t=(0,c.assertNumber)(a.add(e,h));1===a.cond2(t,p)&&(f=(0,c.assertNumber)(a.add(f,a.one))),h=(0,c.assertNumber)((0,c.numMod)(a,t,p))}else{const e=a.neg(r),t=a.floor((0,c.assertNumber)(a.div(e,p)));f=(0,c.assertNumber)(a.sub(f,t));const n=(0,c.assertNumber)((0,c.numMod)(a,e,p));if(a.cond2(n,h)>=0)f=(0,c.assertNumber)(a.sub(f,a.one)),h=(0,c.assertNumber)(a.add((0,c.assertNumber)(a.sub(h,n)),p));else{const e=(0,c.assertNumber)(a.sub(h,n));h=(0,c.assertNumber)((0,c.numMod)(a,e,p))}}0===a.cond(h)&&(h=p);const S=a.lfix(h);switch(S){case 4:case 6:case 9:case 11:const e=a.fromNumber(30);a.cond2(m,e)>0&&(m=e);break;case 2:a.cond2(m,a.fromNumber(28))>0&&(m=a.fromNumber(i.daysPerMonth(2,a.toNumber(f),!1)))}if(n&&(m=a.fromNumber(i.daysPerMonth(S,a.toNumber(f),!1))),a.lfix(f)<(s.dateCompatibility?D:w))return!1;const v=function(e,t,r,n,a,i){const o=e.lfix(n),s=e.lfix(a),c=e.lfix(i);return t.toNum(r,(0,u.dateTime)(c,s,o,0,0,0,0,0,l.Rounding.RoundSec))}(a,i,s,m,h,f);return!(0,d.isErrorOper)(v)&&v}(t,i,o,!e);return!1===m?n.numErrorOper:k(s,m,g.date1904)}function _(e,[t,r,a,s]){const u=e.mathpack;let l,p=I.Saturday|I.Sunday,f=5;function v(e){p=e,f=7;let t=p;for(;0!==t;)1==(1&t)&&(f-=1),t>>=1}if(void 0!==a&&!(0,g.isMissingOper)(a))if((0,h.isStringOper)(a)){const e=P(a.value);if(!1===e)return i.valueErrorOper;v(e)}else{const t=(0,c.chkNumOper)(e,a);if((0,d.isErrorOper)(t))return i.valueErrorOper;const r=O(u.lfix(t));if(!1===r)return n.numErrorOper;v(r)}const F=s??o.missingOper,y=(0,c.chkDateOper)(e,t);if((0,d.isErrorOper)(y))return y;const b=(0,c.chkDateOper)(e,r);if((0,d.isErrorOper)(b))return b;let C,A=u.lfix(y),E=u.lfix(b);A>E?(C=A,A=E,E=C,l=-1):l=1,C=A%7,C=E%7;let T=0,R=A<E?A:E,k=A<E?E:A;for(;R%7!=0&&R!==k;)N(p,R)||(T+=1),R+=1;for(;k%7!=6&&R!==k;)N(p,k)||(T+=1),k-=1;if(k===R&&1!=(p>>R%7&1)&&(T+=1),A>E){const e=R;R=k,k=e}let M=u.fromNumber(f*Math.floor((k+1-R)/7)+T);switch(F.kind){case S.OperKind.Number:case S.OperKind.String:const t=(0,c.chkDateOper)(e,F);if((0,d.isErrorOper)(t))return t;C=u.lfix(t),C>=A&&C<=E&&C%7>=2&&(M=(0,c.assertNumber)(u.sub(M,u.one)));break;case S.OperKind.Range:case S.OperKind.Array:const r=function(e,t,r,a,o,s){let u;const l=e.mathpack;if(void 0===s||(0,g.isMissingOper)(s))u=I.Saturday|I.Sunday;else if((0,h.isStringOper)(s)){const e=P(s.value);if(!1===e)return i.valueErrorOper;u=e}else{const t=(0,c.chkNumOper)(e,s);if((0,d.isErrorOper)(t))return i.valueErrorOper;const r=O(l.lfix(t));if(!1===r)return n.numErrorOper;u=r}const p=l.fromNumber(r),f=l.fromNumber(a),v=e.dereferenceOper(o,S.OperKind.Array);if(!(0,m.isArrayOper)(v))return i.valueErrorOper;const F=[];function y(e){if(l.cond2(e,p)>=0&&l.cond2(e,f)<=0){const t=l.lfix(e);N(u,t)||F.push(e)}}for(let t=0;t<v.rows;t+=1)for(let r=0;r<v.cols;r+=1){const n=v.opers[t][r];switch(n.kind){case S.OperKind.Number:case S.OperKind.String:const t=(0,c.chkDateOper)(e,n);if((0,d.isErrorOper)(t))return t;y(t);break;case S.OperKind.Blank:break;case S.OperKind.Error:return n;default:return i.valueErrorOper}}let b=t;if(0!==F.length){const e=F.sort(((e,t)=>l.cond2(e,t)));let t=e[0];b=(0,c.assertNumber)(l.sub(b,l.one));for(let r=0;r<e.length;r+=1){const n=e[r];0!==l.cond2(n,t)&&(t=n,b=(0,c.assertNumber)(l.sub(b,l.one)))}}return b}(e,M,A,E,F,a);if((0,d.isErrorOper)(r))return r;M=r;break;case S.OperKind.Error:return F;case S.OperKind.Missing:break;default:return i.valueErrorOper}return u.mul(u.fromNumber(l),M)}function x(e,t,r,n,a,i,o){const{mathpack:s}=e,u=360*(r-t),l=30*(a-n);return s.fromNumber(o-i+l+u)}function K(e,t,r,n){const{datepack:a,config:i}=e;return t===a.daysPerMonth(r,n,i.dateCompatibility)}var W;t.edate=L.bind(void 0,!0),t.eomonth=L.bind(void 0,!1),t.networkdays_intl=_,t.networkdays=function(e,[t,r,n]){return _(e,n?[t,r,o.missingOper,n]:[t,r])},function(e){e[e.DefaultBasis=0]="DefaultBasis",e[e.Basis30360=0]="Basis30360",e[e.BasisActual=1]="BasisActual",e[e.BasisActual360=2]="BasisActual360",e[e.BasisActual365=3]="BasisActual365",e[e.BasisE30360=4]="BasisE30360"}(W||(W={})),t.yearFrac=function(e,[t,r,a]){let i=W.DefaultBasis;if(void 0!==a){const t=function(e,t){let r=W.DefaultBasis;if(void 0===t||(0,g.isMissingOper)(t))return r;const a=(0,c.chkNumOper)(e,t);if((0,d.isErrorOper)(a))return a;const i=e.mathpack;switch(r=i.lfix(i.floor(a)),r){case W.Basis30360:case W.BasisActual:case W.BasisActual360:case W.BasisActual365:case W.BasisE30360:return r;default:return n.numErrorOper}}(e,a);if("number"!=typeof t)return t;i=t}let o=(0,c.chkDateOper)(e,t);if((0,d.isErrorOper)(o))return o;let s=(0,c.chkDateOper)(e,r);if((0,d.isErrorOper)(s))return s;const m=e.mathpack;if(m.cond2(o,s)>0){const e=o;o=s,s=e}const h=function(e,t,r,n,a){const i=e.mathpack;switch(i.cond2(t,r)){case 1:break;case 0:return i.zero;case-1:switch(n){case W.Basis30360:return function(e,t,r,n,a){const{datepack:i,config:o}=e,s=i.fromNum(o,t,l.Rounding.RoundSec);if(!1===s)return!1;let u=s.dom;const c=s.mon,d=s.yr,g=i.fromNum(o,r,l.Rounding.RoundSec);if(!1===g)return!1;let m=g.dom;const h=g.mon,p=g.yr;return 2===m&&K(e,m,h,p)&&(2===u&&K(e,u,c,d)||3===n)&&(m=30),31===m&&(u>=30||3===n)&&(m=30),31===u&&(u=30),2===c&&K(e,u,c,d)&&(u=30),x(e,d,p,c,h,u,m)}(e,t,r,a);case W.BasisActual360:case W.BasisActual365:case W.BasisActual:return(0,c.assertNumber)(i.sub(r,t));case W.BasisE30360:return function(e,t,r){const{datepack:n,config:a}=e,i=n.fromNum(a,t,l.Rounding.RoundSec);if(!1===i)return!1;let o=i.dom;const s=i.mon,u=i.yr,c=n.fromNum(a,r,l.Rounding.RoundSec);if(!1===c)return!1;let d=c.dom;const g=c.mon;return 31===o&&(o=30),31===d&&(d=30),x(e,u,c.yr,s,g,o,d)}(e,t,r)}}return!1}(e,o,s,i,0);if(!1===h)return n.numErrorOper;const p=function(e,t,r,n){const{mathpack:a,datepack:i,config:o}=e,s=a.fromNumber(360),g=a.fromNumber(365),m=a.fromNumber(366);switch(t){case W.BasisActual:const e=i.fromNum(o,r,l.Rounding.RoundSec);if(!1===e)return!1;const t=e.dom,h=e.mon,p=e.yr,f=i.fromNum(o,n,l.Rounding.RoundSec);if(!1===f)return!1;const S=f.dom,v=f.mon,F=f.yr,y=F-1;if(p===F)return 29===i.daysPerMonth(2,p,o.dateCompatibility)?m:g;if(y===p&&(h>v||h===v&&t>=S)){if(29===i.daysPerMonth(2,p,o.dateCompatibility)){const e=i.toNum(o,(0,u.dateTime)(p,2,29,0,0,0,0,0,l.Rounding.RoundSec));return!(0,d.isErrorOper)(e)&&(a.cond2(e,r)>=0?m:g)}if(29===i.daysPerMonth(2,F,o.dateCompatibility)){const e=i.toNum(o,(0,u.dateTime)(p,2,29,0,0,0,0,0,l.Rounding.RoundSec));return!(0,d.isErrorOper)(e)&&(a.cond2(e,n)<=0?m:g)}return g}let b=0;for(let e=p;e<=F;e+=1)29===i.daysPerMonth(2,e,o.dateCompatibility)?b+=366:b+=365;const C=a.fromNumber(F-p+1);return(0,c.assertNumber)(a.div(a.fromNumber(b),C));case W.Basis30360:case W.BasisActual360:case W.BasisE30360:return s;case W.BasisActual365:return g;default:return s}}(e,i,o,s);return!1===p?n.numErrorOper:m.div(h,p)}},3947:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gestep=t.delta=void 0;const n=r(7674),a=r(6067),i=r(6067);function o(e,t){const[r,o]=t,s=void 0===o||(0,a.isMissingOper)(o)?e.mathpack.zero:(0,n.chkNumOper)(e,o);if((0,i.isErrorOper)(s))return s;const u=(0,n.chkNumOper)(e,r);return(0,i.isErrorOper)(u)?u:[u,s]}t.delta=function(e,t){const r=o(e,t);if(!Array.isArray(r))return r;const[n,a]=r,i=e.mathpack;return 0===i.cond2(n,a)?i.one:i.zero},t.gestep=function(e,t){const r=o(e,t);if(!Array.isArray(r))return r;const[n,a]=r,i=e.mathpack;return i.cond2(n,a)>=0?i.one:i.zero}},2619:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFunc=void 0;const n=r(3345),a=n.__importStar(r(2107)),i=n.__importStar(r(3273)),o=n.__importStar(r(3947)),s=n.__importStar(r(8788)),u=n.__importStar(r(3451)),l=n.__importStar(r(1095)),c=n.__importStar(r(9748)),d=n.__importStar(r(3392)),g=n.__importStar(r(4167)),m=n.__importStar(r(5625)),h=n.__importStar(r(8969)),p=n.__importStar(r(2769)),f=n.__importStar(r(9393)),S=n.__importStar(r(4525)),v=n.__importStar(r(3270)),F=n.__importStar(r(4180)),y=n.__importStar(r(405)),b=r(6366),C=r(6366),A=r(6067),E={};E[A.WorksheetFuncId.SUM]=a.sum,E[A.WorksheetFuncId.PRODUCT]=a.product,E[A.WorksheetFuncId.AVERAGE]=a.average,E[A.WorksheetFuncId.COUNTBLANK]=a.countblank,E[A.WorksheetFuncId.MAX]=a.max,E[A.WorksheetFuncId.MIN]=a.min,E[A.WorksheetFuncId.AND]=a.and,E[A.WorksheetFuncId.COUNTA]=a.counta,E[A.WorksheetFuncId.OR]=a.or,E[A.WorksheetFuncId.CONCAT]=a.concat,E[A.WorksheetFuncId.AVERAGEIF]=a.averageif,E[A.WorksheetFuncId.AVERAGEIFS]=a.averageifs,E[A.WorksheetFuncId.COUNT]=a.count,E[A.WorksheetFuncId.COUNTIF]=a.countif,E[A.WorksheetFuncId.COUNTIFS]=a.countifs,E[A.WorksheetFuncId.MEDIAN]=a.median,E[A.WorksheetFuncId.SUMSQ]=a.sumsq,E[A.WorksheetFuncId.SUMIF]=a.sumif,E[A.WorksheetFuncId.SUMIFS]=a.sumifs,E[A.WorksheetFuncId.LARGE]=a.large,E[A.WorksheetFuncId.SMALL]=a.small,E[A.WorksheetFuncId.RANK]=a.rank,E[A.WorksheetFuncId.RANK_EQ]=a.rank,E[A.WorksheetFuncId.RANK_AVG]=a.rank_avg,E[A.WorksheetFuncId.PERCENTILE]=a.percentile,E[A.WorksheetFuncId.PERCENTILE_INC]=a.percentile,E[A.WorksheetFuncId.PERCENTILE_EXC]=a.percentile_exc,E[A.WorksheetFuncId.QUARTILE]=a.quartile,E[A.WorksheetFuncId.QUARTILE_INC]=a.quartile,E[A.WorksheetFuncId.QUARTILE_EXC]=a.quartile_exc,E[A.WorksheetFuncId.TRIMMEAN]=a.trimmean,E[A.WorksheetFuncId.AVERAGEA]=a.averagea,E[A.WorksheetFuncId.MAXA]=a.maxa,E[A.WorksheetFuncId.MINA]=a.mina,E[A.WorksheetFuncId.MAXIFS]=a.maxifs,E[A.WorksheetFuncId.MINIFS]=a.minifs,E[A.WorksheetFuncId.XOR]=a.xor,E[A.WorksheetFuncId.AGGREGATE]=a.aggregate,E[A.WorksheetFuncId.SUBTOTAL]=a.subtotal,E[A.WorksheetFuncId.VAR]=a.var_,E[A.WorksheetFuncId.VAR_S]=a.var_,E[A.WorksheetFuncId.VARP]=a.varp,E[A.WorksheetFuncId.VAR_P]=a.varp,E[A.WorksheetFuncId.STDEV]=a.stdev,E[A.WorksheetFuncId.STDEV_S]=a.stdev,E[A.WorksheetFuncId.STDEVP]=a.stdevp,E[A.WorksheetFuncId.STDEV_P]=a.stdevp,E[A.WorksheetFuncId.VARA]=a.vara,E[A.WorksheetFuncId.VARPA]=a.varpa,E[A.WorksheetFuncId.STDEVA]=a.stdeva,E[A.WorksheetFuncId.STDEVPA]=a.stdevpa,E[A.WorksheetFuncId.AVEDEV]=a.avedev,E[A.WorksheetFuncId.DEVSQ]=a.devsq,E[A.WorksheetFuncId.MODE]=a.mode,E[A.WorksheetFuncId.MODE_SNGL]=a.mode,E[A.WorksheetFuncId.MODE_MULT]=a.mode_mult,E[A.WorksheetFuncId.TEXTJOIN]=a.textjoin,E[A.WorksheetFuncId.SUMPRODUCT]=a.sumproduct,E[A.WorksheetFuncId.GEOMEAN]=a.geomean,E[A.WorksheetFuncId.HARMEAN]=a.harmean,E[A.WorksheetFuncId.YEAR]=i.year,E[A.WorksheetFuncId.MONTH]=i.month,E[A.WorksheetFuncId.DAY]=i.day,E[A.WorksheetFuncId.HOUR]=i.hour,E[A.WorksheetFuncId.MINUTE]=i.minute,E[A.WorksheetFuncId.SECOND]=i.second,E[A.WorksheetFuncId.WEEKNUM]=i.weeknum,E[A.WorksheetFuncId.ISOWEEKNUM]=i.isoweeknum,E[A.WorksheetFuncId.WEEKDAY]=i.weekday,E[A.WorksheetFuncId.DATE]=i.date,E[A.WorksheetFuncId.TIME]=i.time,E[A.WorksheetFuncId.DAYS360]=i.days360,E[A.WorksheetFuncId.DAYS]=i.days,E[A.WorksheetFuncId.DATEDIF]=i.datedif,E[A.WorksheetFuncId.WORKDAY]=i.workday,E[A.WorksheetFuncId.WORKDAY_INTL]=i.workday_intl,E[A.WorksheetFuncId.EDATE]=i.edate,E[A.WorksheetFuncId.EOMONTH]=i.eomonth,E[A.WorksheetFuncId.NETWORKDAYS]=i.networkdays,E[A.WorksheetFuncId.NETWORKDAYS_INTL]=i.networkdays_intl,E[A.WorksheetFuncId.YEARFRAC]=i.yearFrac,E[A.WorksheetFuncId.DELTA]=o.delta,E[A.WorksheetFuncId.GESTEP]=o.gestep,E[A.WorksheetFuncId.NA]=s.na,E[A.WorksheetFuncId.T]=s.t_,E[A.WorksheetFuncId.N]=s.n_,E[A.WorksheetFuncId.TYPE]=s.type,E[A.WorksheetFuncId.ERROR_TYPE]=s.error_type,E[A.WorksheetFuncId.INFO]=s.info,E[A.WorksheetFuncId.IF]=l.if_,E[A.WorksheetFuncId.IFS]=l.ifs,E[A.WorksheetFuncId.SWITCH]=l.switch_,E[A.WorksheetFuncId.TRUE]=l.true_,E[A.WorksheetFuncId.FALSE]=l.false_,E[A.WorksheetFuncId.NOT]=l.not,E[A.WorksheetFuncId.CHOOSE]=l.choose,E[A.WorksheetFuncId.INDEX]=c.index,E[A.WorksheetFuncId.MATCH]=c.match,E[A.WorksheetFuncId.LOOKUP]=c.lookup,E[A.WorksheetFuncId.HLOOKUP]=c.hlookup,E[A.WorksheetFuncId.VLOOKUP]=c.vlookup,E[A.WorksheetFuncId.ABS]=d.abs,E[A.WorksheetFuncId.CEILING]=d.ceiling,E[A.WorksheetFuncId.ECMA_CEILING]=d.ceiling,E[A.WorksheetFuncId.DEGREES]=d.degrees,E[A.WorksheetFuncId.FLOOR]=d.floor,E[A.WorksheetFuncId.RADIANS]=d.radians,E[A.WorksheetFuncId.ROUND]=d.round,E[A.WorksheetFuncId.ROUNDUP]=d.roundup,E[A.WorksheetFuncId.ROUNDDOWN]=d.rounddown,E[A.WorksheetFuncId.EVEN]=d.even,E[A.WorksheetFuncId.SIGN]=d.sign,E[A.WorksheetFuncId.PI]=d.pi,E[A.WorksheetFuncId.SQRT]=d.sqrt,E[A.WorksheetFuncId.EXP]=d.exp,E[A.WorksheetFuncId.POWER]=d.power,E[A.WorksheetFuncId.LN]=d.ln,E[A.WorksheetFuncId.LOG10]=d.log10,E[A.WorksheetFuncId.LOG]=d.log,E[A.WorksheetFuncId.SIN]=d.sin,E[A.WorksheetFuncId.COS]=d.cos,E[A.WorksheetFuncId.TAN]=d.tan,E[A.WorksheetFuncId.ASIN]=d.asin,E[A.WorksheetFuncId.ACOS]=d.acos,E[A.WorksheetFuncId.ATAN]=d.atan,E[A.WorksheetFuncId.ATAN2]=d.atan2,E[A.WorksheetFuncId.FACT]=d.fact,E[A.WorksheetFuncId.SQRTPI]=d.sqrtpi,E[A.WorksheetFuncId.FACTDOUBLE]=d.factdouble,E[A.WorksheetFuncId.INT]=d.int,E[A.WorksheetFuncId.TRUNC]=d.trunc,E[A.WorksheetFuncId.ODD]=d.odd,E[A.WorksheetFuncId.MROUND]=d.mround,E[A.WorksheetFuncId.QUOTIENT]=d.quotient,E[A.WorksheetFuncId.FLOOR_MATH]=d.floor_math,E[A.WorksheetFuncId.FLOOR_PRECISE]=d.floor_precise,E[A.WorksheetFuncId.CEILING_MATH]=d.ceiling_math,E[A.WorksheetFuncId.CEILING_PRECISE]=d.ceiling_precise,E[A.WorksheetFuncId.ISO_CEILING]=d.ceiling_precise,E[A.WorksheetFuncId.MOD]=d.mod,E[A.WorksheetFuncId.TEXT]=g.text,E[A.WorksheetFuncId.FIXED]=g.fixed,E[A.WorksheetFuncId.DOLLAR]=g.dollar,E[A.WorksheetFuncId.VALUE]=g.value,E[A.WorksheetFuncId.DATEVALUE]=g.datevalue,E[A.WorksheetFuncId.TIMEVALUE]=g.timevalue,E[A.WorksheetFuncId.NUMBERVALUE]=g.numbervalue,E[A.WorksheetFuncId.ARRAYTOTEXT]=g.arraytotext,E[A.WorksheetFuncId.VALUETOTEXT]=g.valuetotext,E[A.WorksheetFuncId.ISERROR]=m.iserror,E[A.WorksheetFuncId.ISERR]=m.iserr,E[A.WorksheetFuncId.ISBLANK]=m.isblank,E[A.WorksheetFuncId.ISLOGICAL]=m.islogical,E[A.WorksheetFuncId.ISNA]=m.isna,E[A.WorksheetFuncId.ISNONTEXT]=m.isnontext,E[A.WorksheetFuncId.ISTEXT]=m.istext,E[A.WorksheetFuncId.ISNUMBER]=m.isnumber,E[A.WorksheetFuncId.ISREF]=m.isref,E[A.WorksheetFuncId.ISEVEN]=m.iseven,E[A.WorksheetFuncId.ISODD]=m.isodd,E[A.WorksheetFuncId.ISFORMULA]=m.isformula,E[A.WorksheetFuncId.FORMULATEXT]=m.formulatext,E[A.WorksheetFuncId.ROWS]=h.rows,E[A.WorksheetFuncId.COLUMNS]=h.columns,E[A.WorksheetFuncId.AREAS]=h.areas,E[A.WorksheetFuncId.SHEETS]=h.sheets,E[A.WorksheetFuncId.ROW]=h.row,E[A.WorksheetFuncId.COLUMN]=h.column,E[A.WorksheetFuncId.SHEET]=h.sheet,E[A.WorksheetFuncId.OFFSET]=h.offset,E[A.WorksheetFuncId.TRANSPOSE]=h.transpose,E[A.WorksheetFuncId.SINGLE]=h.single,E[A.WorksheetFuncId.ADDRESS]=f.address,E[A.WorksheetFuncId.INDIRECT]=f.indirect,E[A.WorksheetFuncId.TAKE]=f.take,E[A.WorksheetFuncId.DROP]=f.drop,E[A.WorksheetFuncId.SEQUENCE]=f.sequence,E[A.WorksheetFuncId.HSTACK]=f.hstack,E[A.WorksheetFuncId.VSTACK]=f.vstack,E[A.WorksheetFuncId.CHOOSECOLS]=f.choosecols,E[A.WorksheetFuncId.CHOOSEROWS]=f.chooserows,E[A.WorksheetFuncId.TOCOL]=f.tocol,E[A.WorksheetFuncId.TOROW]=f.torow,E[A.WorksheetFuncId.EXPAND]=f.expand,E[A.WorksheetFuncId.WRAPCOLS]=f.wrapcols,E[A.WorksheetFuncId.WRAPROWS]=f.wraprows,E[A.WorksheetFuncId.FILTER]=y.filter,E[A.WorksheetFuncId.SORT]=y.sort,E[A.WorksheetFuncId.SORTBY]=y.sortby,E[A.WorksheetFuncId.UNIQUE]=y.unique,E[A.WorksheetFuncId.LEFT]=S.left,E[A.WorksheetFuncId.RIGHT]=S.right,E[A.WorksheetFuncId.MID]=S.mid,E[A.WorksheetFuncId.LEN]=S.len,E[A.WorksheetFuncId.CONCATENATE]=S.concatenate,E[A.WorksheetFuncId.EXACT]=S.exact,E[A.WorksheetFuncId.REPT]=S.rept,E[A.WorksheetFuncId.TRIM]=S.trim,E[A.WorksheetFuncId.CLEAN]=S.clean,E[A.WorksheetFuncId.CHAR]=S.char,E[A.WorksheetFuncId.UNICHAR]=S.unichar,E[A.WorksheetFuncId.CODE]=S.code,E[A.WorksheetFuncId.UNICODE]=S.unicode,E[A.WorksheetFuncId.LOWER]=S.lower,E[A.WorksheetFuncId.UPPER]=S.upper,E[A.WorksheetFuncId.PROPER]=S.proper,E[A.WorksheetFuncId.FIND]=S.find,E[A.WorksheetFuncId.REPLACE]=S.replace,E[A.WorksheetFuncId.SEARCH]=S.search,E[A.WorksheetFuncId.SUBSTITUTE]=S.substitute,E[A.WorksheetFuncId.TEXTBEFORE]=S.textBefore,E[A.WorksheetFuncId.TEXTAFTER]=S.textAfter,E[A.WorksheetFuncId.TEXTSPLIT]=S.textSplit,E[A.WorksheetFuncId.RAND]=v.rand,E[A.WorksheetFuncId.RANDBETWEEN]=v.randbetween,E[A.WorksheetFuncId.NOW]=v.now,E[A.WorksheetFuncId.TODAY]=v.today,E[A.WorksheetFuncId.RANDARRAY]=v.randarray,E[A.WorksheetFuncId.HYPERLINK]=F.hyperlink,E[A.WorksheetFuncId.FIELDVALUE]=p.fieldvalue,E[A.WorksheetFuncId._FV]=p.fieldvalue,E[A.WorksheetFuncId.MAKEARRAY]=u.makearray,E[A.WorksheetFuncId.ISOMITTED]=m.isomitted,E[A.WorksheetFuncId.MAP]=u.map,E[A.WorksheetFuncId.BYROW]=u.byrow,E[A.WorksheetFuncId.BYCOL]=u.bycol,E[A.WorksheetFuncId.REDUCE]=u.reduce,E[A.WorksheetFuncId.SCAN]=u.scan,E[A.WorksheetFuncId.XLOOKUP]=c.xlookup,E[A.WorksheetFuncId.XMATCH]=c.xmatch;let T=!1;t.getWorksheetFunc=function(e){return T||(T=!0,(0,b.isFeatureEnabled)(C.FeatureName.CalcRecordFunctions)&&(E[A.WorksheetFuncId.RECORD]=p.record),(0,b.isFeatureEnabled)(C.FeatureName.CalcNestedRecordFunction)&&(E[A.WorksheetFuncId.NESTEDRECORD]=p.record),(0,b.isFeatureEnabled)(C.FeatureName.CalcLambdaBasicFunctions)&&(E[A.WorksheetFuncId.APPLY]=u.apply,E[A.WorksheetFuncId.ISLAMBDA]=m.islambda)),E[e]}},8788:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.info=t.error_type=t.type=t.n_=t.t_=t.na=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(9835),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6366),S=r(6067),v=r(6880),F=r(3109);function y(e,t){if((0,c.isRangeOper)(t)){if((0,u.isSheetIndex)(t.sheets)){const r=(0,i.rangeSeqOper)(t.sheets,[(0,l.gridRangeAnchor)(t.ranges[0])]);return e.dereferenceOper(r,s.readOperType)}return o.valueErrorOper}return t}t.na=function(e,t){return a.naErrorOper},t.t_=function(e,[t]){const r=y(e,t);return(0,g.isStringOper)(r)||(0,d.isErrorOper)(r)?r:v.emptyStringOper},t.n_=function(e,[t]){const r=y(e,t);if((0,m.isNumberOper)(r)||(0,d.isErrorOper)(r))return r;const n=e.mathpack;return(0,h.isBooleanOper)(r)&&r.value?n.one:n.zero},t.type=function(e,[t]){const r=e.mathpack;switch(t.kind){case S.OperKind.Number:return r.fromNumber(1);case S.OperKind.String:return r.fromNumber(2);case S.OperKind.Boolean:return r.fromNumber(4);case S.OperKind.Error:return r.fromNumber(16);case S.OperKind.Array:return r.fromNumber(64);case S.OperKind.Rich:return r.fromNumber(128);default:return(0,f.assertNever)("calc.funcs.type",t)}},t.error_type=function(e,[t]){return(0,d.isErrorOper)(t)?(t.type>n.ErrorType.CALC&&(0,F.throwEvaluationError)((0,p.notImplemented)(["ERROR.TYPE for "+String(t.type)])),e.mathpack.fromNumber(t.type)):a.naErrorOper},t.info=function(e,t){return o.valueErrorOper}},3451:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scan=t.reduce=t.bycol=t.byrow=t.map=t.makearray=t.apply=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(1819),u=r(9835),l=r(9835),c=r(3109),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(7674),y=r(6067),b=r(6067),C=r(6366),A=r(6366),E=r(6366),T=r(6366),R=r(6366),k=r(6067);function N(e,t,r){const n=function(e,t){return(0,h.isRangeOper)(t)&&(0,f.isSheetIndex)(t.sheets)&&1===t.ranges.length&&(0,S.isGridCell)(t.ranges[0])?e.dereferenceOper(t,b.SignatureType.All&~y.OperKind.Range):t}(e,t);return n instanceof s.LambdaOper&&n.checkArity(r)?n:a.valueErrorOper}function I(e,t){return r=>{let n=r;if((0,h.isRangeOper)(n)){if(!(0,f.isSheetIndex)(n.sheets)||1!==n.ranges.length||!(0,S.isGridCell)(n.ranges[0]))return(0,u.earlyReturn)((0,R.success)(i.calcErrorOper));n=t.dereferenceOper(n,b.SignatureType.All&~y.OperKind.Range),(0,T.assertTrue)("calc.funcs.coerceLambdaRvToArrayElt",!(0,h.isRangeOper)(n))}return(0,p.isArrayOper)(n)?1!==n.rows||1!==n.cols?(0,u.earlyReturn)((0,R.success)(i.calcErrorOper)):n.opers[0][0]:((0,m.isMissingOper)(n)&&(0,c.throwEvaluationError)((0,d.notImplemented)([`${(0,k.englishWorksheetFuncIdToName)(e)}: MissingOper in result`])),n)}}function O(e,t,r,i,o){const s=N(e,i,r.length);if((0,g.isErrorOper)(s))return s;const u=[];for(const e of r){if(!(0,p.isArrayOper)(e)&&!(0,h.isRangeOper)(e))return a.valueErrorOper;const t=(0,F.rangeOrArrayToVal)(e,a.valueErrorOper);if((0,g.isErrorOper)(t))return t;u.push(o((0,F.makeSlicer)(t)))}const c=u.map((e=>e.rows)).reduce(A.fastMin),d=u.map((e=>e.rows)).reduce(C.fastMax),m=u.map((e=>e.cols)).reduce(A.fastMin),f=u.map((e=>e.cols)).reduce(C.fastMax);return(0,F.validateArraySize)(d,f),(0,l.machineCall)(new l.ArrayMachine(e,d,f,((t,r)=>t>=c||r>=m?n.naErrorOper:e.applyLambda(s,u.map((e=>e.slice(t,1,r,1))))),I(t,e)))}function P(e,t,r,n,i){const s=(0,F.rangeOrArrayToVal)(n,a.valueErrorOper);if((0,g.isErrorOper)(s))return s;const c=(0,F.makeSlicer)(s),d=N(e,i,2);if((0,g.isErrorOper)(d))return d;const h=!(0,m.isMissingOper)(r);let p,f=h?r:void 0,S=!0;if(t===v.WorksheetFuncId.REDUCE)p=e=>(f=e,o.blankOper);else{const r=I(t,e);p=e=>{const t=r(e);return t.kind===u.EarlyReturnKind.EarlyReturn||(f=t),t}}const y=(0,l.machineCall)(new l.ArrayMachine(e,c.rows,c.cols,((t,r)=>{const n=S;return S=!1,n&&!h?c.slice(t,1,r,1):((0,T.assertTrue)("calc.funcs.scanReduce",void 0!==f),e.applyLambda(d,[f,c.slice(t,1,r,1)]))}),p));return t===v.WorksheetFuncId.REDUCE?(0,l.machineCall)(new l.ThenMachine(e,(()=>y),(()=>((0,T.assertTrue)("calc.funcs.scanReduce",void 0!==f),f)))):y}t.apply=function(e,[t,...r]){const n=N(e,t,r.length);return(0,g.isErrorOper)(n)?n:e.applyLambda(n,r)},t.makearray=function(e,[t,r,n]){const i=N(e,n,2);if((0,g.isErrorOper)(i))return i;const o=e.mathpack,s=(0,m.isMissingOper)(t)?1:o.fix(t),u=(0,m.isMissingOper)(r)?1:o.fix(r);return s<1||u<1?a.valueErrorOper:((0,F.validateArraySize)(s,u),(0,l.machineCall)(new l.ArrayMachine(e,s,u,((t,r)=>{const n=e.mathpack,a=[n.fromNumber(t+1),n.fromNumber(r+1)];return e.applyLambda(i,a)}),I(v.WorksheetFuncId.MAKEARRAY,e))))},t.map=function(e,t){const r=t.slice(0,t.length-1),n=t[t.length-1];return O(e,v.WorksheetFuncId.MAP,r,n,E.identity)},t.byrow=function(e,t){const r=[t[0]],a=t[1];return void 0===a?n.naErrorOper:O(e,v.WorksheetFuncId.BYROW,r,a,(e=>({rows:e.rows,cols:1,slice:(t,r,n,a)=>e.slice(t,r,0,e.cols)})))},t.bycol=function(e,t){const r=[t[0]],a=t[1];return void 0===a?n.naErrorOper:O(e,v.WorksheetFuncId.BYCOL,r,a,(e=>({rows:1,cols:e.cols,slice:(t,r,n,a)=>e.slice(0,e.rows,n,a)})))},t.reduce=function(e,t){const[r,n,a]=t;return P(e,v.WorksheetFuncId.REDUCE,r,n,a)},t.scan=function(e,t){const[r,n,a]=t;return P(e,v.WorksheetFuncId.SCAN,r,n,a)}},1095:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.not=t.false_=t.true_=t.switch_=t.ifs=t.choose=t.if_=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6366),l=r(6366),c=r(6880),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(3109),C=r(6067),A=(0,c.makeStrict)((0,g.getWorksheetFuncType)(d.WorksheetFuncId.IFS)),E=(0,c.makeStrict)((0,g.getWorksheetFuncType)(d.WorksheetFuncId.SWITCH));function T(e,t,r,n){const a=n.slice();return e.dereferenceOpers(a,t),(0,c.arrayLift)(e,t,(n=>{const a=[];for(let r=0;r<n.length;r+=1){const i=(0,m.getArgType)(t,r,n.length);a[r]=e.coerceOper(n[r],i)}return r(e,a)}),a)}t.if_=function(e,t){const r=t[0];(0,u.assertTrue)("calc.funcs.if: condition is not a boolean",(0,y.isBooleanOper)(r));const n=t[r.value?1:2];return(0,u.assertTrue)("calc.funcs.if: result is undefined",void 0!==n),n},t.choose=function(e,t){const r=t[0];(0,u.assertTrue)("calc.funcs.choose",(0,v.isNumberOper)(r));const a=e.mathpack.fix(r);return a<1||a>t.length-1?n.valueErrorOper:t[a]},t.ifs=function e(t,r){for(let n=0;n<r.length;n+=2){const a=r[n];if((0,p.isArrayOper)(a)){const a=r.slice(n);return T(t,A,e,a)}if((0,f.isErrorOper)(a))return a;if((0,u.assertTrue)("calc.funcs.ifs",(0,y.isBooleanOper)(a)),a.value)return r[n+1]}return a.naErrorOper},t.switch_=function e(t,r){const n=r[0];if((0,p.isArrayOper)(n))return T(t,E,e,r);if((0,f.isErrorOper)(n))return n;const i=function({mathpack:e,localeInfo:t},r){switch(r.kind){case C.OperKind.Number:return t=>(0,S.isRichOper)(t)?(0,b.throwEvaluationError)((0,h.notImplemented)(["SWITCH with a rich value case"])):(0,v.isNumberOper)(t)&&0===e.compare(r,t);case C.OperKind.String:return e=>(0,S.isRichOper)(e)?(0,b.throwEvaluationError)((0,h.notImplemented)(["SWITCH with a rich value case"])):(0,F.isStringOper)(e)&&0===t.stringCompareCI(r.value,e.value);case C.OperKind.Boolean:return e=>(0,S.isRichOper)(e)?(0,b.throwEvaluationError)((0,h.notImplemented)(["SWITCH with a rich value case"])):(0,y.isBooleanOper)(e)&&r.value===e.value;case C.OperKind.Rich:return(0,b.throwEvaluationError)((0,h.notImplemented)(["SWITCH with a rich value condition"]));default:return(0,l.assertNever)("calc.funcs.makeSwitchComparer",r)}}(t.config,n);for(let n=1;n<r.length-1;n+=2){const a=C.OperKind.Error|C.OperKind.Rich|C.OperKind.Number|C.OperKind.Boolean|C.OperKind.String|C.OperKind.Array,o=t.coerceOper(t.dereferenceOper(r[n],a),a);if((0,p.isArrayOper)(o))return T(t,E,e,r);if((0,f.isErrorOper)(o))return o;if(i(o))return r[n+1]}return r.length%2==0?r[r.length-1]:a.naErrorOper},t.true_=function(e,t){return i.trueOper},t.false_=function(e,t){return o.falseOper},t.not=function(e,[t]){return(0,s.booleanOper)(!t.value)}},9748:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xmatch=t.xlookup=t.makeWildcardComparer=t.vlookup=t.hlookup=t.lookup=t.match=t.linearSearch=t.binarySearch=t.makeLookupComparer=t.index=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(5146),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6366),A=r(6366),E=r(6366),T=r(3109),R=r(2443),k=r(6067),N=r(6067),I=r(6067),O=r(6067),P=r(6366),M=r(6366),D=r(6366),w=r(6366),L=r(6366),_=r(6067),x=r(7985);function K(e,[t,r,n,a]){const i=e.mathpack,o=i.sfix(r);if(o<0)return u.valueErrorOper;const s=void 0===n?void 0:i.sfix(n);if(void 0!==s&&s<0)return u.valueErrorOper;const g=void 0===a?0:i.sfix(a)-1;if(g<0)return u.valueErrorOper;let m,h;switch(t.kind){case _.OperKind.Range:if(!(0,v.isSheetIndex)(t.sheets))return u.valueErrorOper;if(g>=t.ranges.length)return l.refErrorOper;const e=t.ranges[g];if(void 0===s)if(1===e.rows)m=0,h=o-1;else{if(1!==e.cols)return l.refErrorOper;m=o-1,h=-1}else m=o-1,h=s-1;if(m>=e.rows||h>=e.cols)return l.refErrorOper;const r=(0,O.gridRange)(e.row+(0,w.fastMax)(m,0),e.col+(0,w.fastMax)(h,0),-1===m?e.rows:1,-1===h?e.cols:1);return(0,c.rangeSeqOper)(t.sheets,[r]);case _.OperKind.Array:return g>0?l.refErrorOper:(void 0===s?1===t.rows?(m=0,h=o-1):(m=o-1,h=-1):(m=o-1,h=s-1),m>=t.rows||h>=t.cols?l.refErrorOper:-1===m&&-1===h?t:-1===m?(0,d.arrayOper)(t.rows,1,t.opers.map((e=>[e[h]]))):-1===h?(0,d.arrayOper)(1,t.cols,[t.opers[m]]):t.opers[m][h]);default:return(0,C.assertNever)("calc.funcs.lookupFuncs: INDEX",t)}}t.index=K;const W=e=>e<0?n.OperatorId.Lt:e>0?n.OperatorId.Gt:n.OperatorId.Eq,U=(e,t,r)=>W(e.cond2(t,r)),G=(e,t)=>W(e-t);function B(e,t,r=!1){const a=!0,{localeInfo:i,mathpack:o}=e.config;let s;switch(t.kind){case _.OperKind.Number:s=e=>({correctType:a,sgnT:U(o,e,t)});break;case _.OperKind.String:if(r){const e=new R.WildExp(i,t.value);s=t=>({correctType:a,sgnT:e.test(t.value)?n.OperatorId.Eq:n.OperatorId.Ne})}else s=e=>({correctType:a,sgnT:W(i.stringCompareCI(e.value,t.value))});break;case _.OperKind.Boolean:s=e=>({correctType:a,sgnT:G(e.value,t.value)});break;case _.OperKind.Rich:return(0,T.throwEvaluationError)((0,S.notImplemented)(["lookup with rich value condition"]));case _.OperKind.Blank:s=()=>({correctType:a,sgnT:n.OperatorId.Eq});break;default:return(0,C.assertNever)("calc.funcs.makeLookupComparer",t)}return e=>{const r=(0,p.isRichOper)(e)?e.getFallback():e;return t.kind!==r.kind?{correctType:!1,sgnT:n.OperatorId.Ne}:s(r)}}function V(e,t,r){let a=!1;const i=r.length-1;let o=Math.floor((0+i)/2),s=0,u=i;const l=B(e,t);for(;;){let e=l(r.get(o)).sgnT;if(e===n.OperatorId.Ne){if(o<u)for(let t=o+1;t<=u;t+=1)if(e=l(r.get(t)).sgnT,e!==n.OperatorId.Ne){o=t;break}e===n.OperatorId.Ne&&(o=Math.floor((s+u)/2),e=n.OperatorId.Gt)}if(e===n.OperatorId.Eq){if(o<i){o+=1,a=!0,s=o,u=o;continue}return o}if(e===n.OperatorId.Lt?s=o+1:u=o-1,!(s<=u)){if(a)o-=1;else if(e===n.OperatorId.Gt&&(o-=1,o>=0)){s=o,u=o;continue}return o}o=Math.floor((s+u)/2)}}function j(e,t,r,a){let i=-1;const o=B(e,t,a===n.OperatorId.Eq);for(let e=0;e<r.length;e+=1){const t=r.get(e),{correctType:s,sgnT:u}=o(t);if(s){if(u===n.OperatorId.Eq)return e;if(u!==n.OperatorId.Ne&&u===a)return i;i=e}e===r.denseLength&&(e=(0,w.fastMax)(e,r.length-2))}return a!==n.OperatorId.Eq?i:r.length}function H(e){switch(e.kind){case _.OperKind.Number:return i.naErrorOper;case _.OperKind.Range:return(0,v.isSheetIndex)(e.sheets)?e.ranges.length>1?i.naErrorOper:e:u.valueErrorOper;case _.OperKind.Array:return e}}function q(e,t){let r;switch(t.kind){case _.OperKind.Number:return t;case m.DerefOperKind.RangeValues:r=t.arrays[0].get(0,0);break;case _.OperKind.Array:r=t.opers[0][0];break;default:return(0,C.assertNever)("calc.funcs.lookupFuncs.getNumFromRef",t)}return r=e.coerceOper(r,_.OperKind.Number),(0,h.isErrorOper)(r)?l.refErrorOper:r}function z(e){switch(e.kind){case _.OperKind.Number:case _.OperKind.Rich:return i.naErrorOper;case _.OperKind.Range:if(!(0,v.isSheetIndex)(e.sheets))return u.valueErrorOper;if(e.ranges.length>1)return i.naErrorOper;const t=e.ranges[0];return 1!==t.rows&&1!==t.cols?i.naErrorOper:e;case _.OperKind.Array:return 1!==e.rows&&1!==e.cols?i.naErrorOper:e}}function Q(e){switch(e.kind){case m.DerefOperKind.RangeValues:return e.arrays[0];case _.OperKind.Array:return new M.StrictSparseArray2D(e.rows,e.cols,e.rows,e.cols,e.opers,o.blankOper)}}function $(e,t){switch(t.kind){case _.OperKind.Range:const r=t.sheets,n=t.ranges[0];return new D.NonstrictSparseArray2D(n.rows,n.cols,n.rows,n.cols,((t,a)=>{const i=(0,k.gridCell)(n.row+t,n.col+a),[o]=e.dereferenceAllOpers([(0,c.rangeSeqOper)(r,[i])]);return o.arrays[0].get(0,0)}),(()=>(0,A.assertFalse)("calc.funcs.lookupFuncs: rangeOrArrayOperToLazyArray2D")));case _.OperKind.Array:return new M.StrictSparseArray2D(t.rows,t.cols,t.rows,t.cols,t.opers,o.blankOper)}}function Y(e){if((0,f.isRangeOper)(e)){const t=e.ranges[0];return t.cols>t.rows}return e.cols>e.rows}function J(e,[t,r,a,o=g.trueOper],s){const c=H(r);if((0,h.isErrorOper)(c))return c;const d=X(c,s),[m]=e.dereferenceAllOpers([d]),p=(0,P.sparseArray2DTo1D)(Q(m),s),f=o.value?V(e,t,p):j(e,t,p,n.OperatorId.Eq);if(f<0||f>=p.length)return i.naErrorOper;const F=function(e,t){switch(t.kind){case _.OperKind.Number:return t;case _.OperKind.Range:if(!(0,v.isSheetIndex)(t.sheets))return u.valueErrorOper;if(t.ranges.length>1)return l.refErrorOper;const r=t.ranges;return e.calcingArray?(0,T.throwEvaluationError)((0,S.notImplemented)(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):r[0].rows>1||r[0].cols>1?(0,T.throwEvaluationError)((0,S.notImplemented)(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):t;case _.OperKind.Array:return(0,T.throwEvaluationError)((0,S.notImplemented)(["HLOOKUP/VLOOKUP array argument 3"]))}}(e,a);if((0,h.isErrorOper)(F))return F;const[y]=e.dereferenceAllOpers([F]),b=q(e,y);if((0,h.isErrorOper)(b))return b;const C=e.mathpack.sfix(b)-1,A=$(e,c);return C<0?u.valueErrorOper:C>=(s?A.rows:A.cols)?l.refErrorOper:s?A.get(C,f):A.get(f,C)}function X(e,t){if((0,f.isRangeOper)(e)){const r=e.ranges[0],n=(0,O.gridRange)(r.row,r.col,t?1:r.rows,t?r.cols:1);return(0,c.rangeSeqOper)(e.sheets,[n])}return e}var Z,ee;function te(e){return e===ee.DescendingBinary||e===ee.AscendingBinary}function re(e,t,r=a.missingOper,n=a.missingOper){const i=(0,y.isMissingOper)(r)?Z.Exact:e.mathpack.sfix(r);if(i<Z.Lower||i>Z.Wildcard)return u.valueErrorOper;const o=(0,y.isMissingOper)(n)?ee.Linear:e.mathpack.sfix(n);if(o<ee.DescendingBinary||o>ee.AscendingBinary||0===o)return u.valueErrorOper;if(i===Z.Wildcard&&te(o))return u.valueErrorOper;const s=H(t);if((0,h.isErrorOper)(s))return s;const[l]=e.dereferenceAllOpers([s]),c=Q(l),{rows:d,cols:g}=c;let m;if(1===d)m=!0;else{if(1!==g)return u.valueErrorOper;m=!1}return{kind:void 0,lookupArray:(0,P.sparseArray2DTo1D)(c,m),matchMode:i,searchMode:o,isHorizontal:m}}function ne(e,t,r,a,i){return r===n.OperatorId.Gt?t===Z.Higher&&(void 0===i||W((0,x.sortOpers)(e,a,i,1,!1))===n.OperatorId.Lt):t===Z.Lower&&(void 0===i||W((0,x.sortOpers)(e,a,i,1,!1))===n.OperatorId.Gt)}function ae(e,t){const r=new R.WildExp(e.config.localeInfo,t.value);return e=>(0,b.isStringOper)(e)&&r.test(e.value)?n.OperatorId.Eq:n.OperatorId.Ne}function ie(e,t,r){return te(t.searchMode)?function(e,{lookupArray:t,matchMode:r,searchMode:a},i){const o=e.config,s=a===ee.DescendingBinary;let u,l=0,c=t.length-1;(0,E.assertTrue)("calc.funcs.xBinarySearch",r!==Z.Wildcard);let d=!1;for(;c>=l;){const e=Math.floor((c+l)/2),a=(g=t.get(e),W((0,x.sortOpers)(o,g,i,1,!1)));if(a===n.OperatorId.Eq)d=!0,u=e;else if(!d){const t=r===Z.Higher&&a===n.OperatorId.Gt,i=r===Z.Lower&&a===n.OperatorId.Lt;(t||i)&&(u=e)}s!==(a===n.OperatorId.Lt)?l=e+1:c=e-1}var g;return u}(e,t,r):function(e,{lookupArray:t,matchMode:r,searchMode:a},i){const o=e.config;let s;const u=r===Z.Lower||r===Z.Higher,l=r===Z.Wildcard&&(0,b.isStringOper)(i)?ae(e,i):e=>W((0,x.sortOpers)(o,e,i,1,!1)),c=a===ee.ReverseLinear?t.length-1:0,d=a===ee.ReverseLinear?-1:1;for(let e=c;e>=0&&e<t.length;e+=d){const a=t.get(e),i=l(a);if(i===n.OperatorId.Eq){s=e;break}if(u&&((0,E.assertTrue)("calc.funcs.xLinearSearch",i!==n.OperatorId.Ne),ne(o,r,i,a,void 0===s?void 0:t.get(s))&&(s=e)),e>=t.denseLength){const r=t.denseLength,n=t.length-1;e=d>0?(0,w.fastMax)(e,n-1):(0,L.fastMin)(e,r+1)}}return s}(e,t,r)}t.makeLookupComparer=B,t.binarySearch=V,t.linearSearch=j,t.match=function(e,[t,r,a=e.mathpack.one]){const o=e.mathpack,s=function(e){switch(e.kind){case _.OperKind.Number:return e;case _.OperKind.Range:if(!(0,v.isSheetIndex)(e.sheets))return u.valueErrorOper;if(e.ranges.length>1)return l.refErrorOper;const t=e.ranges[0];return 1!==t.rows||1!==t.cols?l.refErrorOper:e}}(a);if((0,h.isErrorOper)(s))return s;const[c]=e.dereferenceAllOpers([s]),d=q(e,c);if((0,h.isErrorOper)(d))return d;const g=z(r);if((0,h.isErrorOper)(g))return g;const[m]=e.dereferenceAllOpers([g]),p=Q(m),f=1===p.rows,S=(0,P.sparseArray2DTo1D)(p,f);let F=-1;return F=o.cond(d)>0?V(e,t,S):0===o.cond(d)?j(e,t,S,n.OperatorId.Eq):j(e,t,S,n.OperatorId.Lt),F<0||F>=S.length?i.naErrorOper:e.mathpack.fromNumber(F+1)},t.lookup=function(e,[t,r,n]){const a=H(r);if((0,h.isErrorOper)(a))return a;const u=Y(a),l=X(a,u),[c]=e.dereferenceAllOpers([l]),d=(0,P.sparseArray2DTo1D)(Q(c),u),g=V(e,t,d);if(g<0)return i.naErrorOper;if(void 0!==n){const t=z(n);if((0,h.isErrorOper)(t))return t;const r=Y(t),a=function(e,t,r){if((0,f.isRangeOper)(r)){const n=r.ranges[0],a=(0,O.gridRange)(n.row,n.col,(0,L.fastMin)(t?1:e,N.sheetRows-n.row),(0,L.fastMin)(t?e:1,I.sheetCols-n.col));return(0,s.range3DOper)(r.sheets,a)}return r}(d.length,r,t),u=(0,P.sparseArray2DTo1D)($(e,a),r);return g>=u.length?(0,F.isArrayOper)(t)?i.naErrorOper:o.blankOper:u.get(g)}const m=$(e,a);return u?m.get(m.rows-1,g):m.get(g,m.cols-1)},t.hlookup=function(e,t){return J(e,t,!0)},t.vlookup=function(e,t){return J(e,t,!1)},function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Higher=1]="Higher",e[e.Wildcard=2]="Wildcard"}(Z||(Z={})),function(e){e[e.DescendingBinary=-2]="DescendingBinary",e[e.ReverseLinear=-1]="ReverseLinear",e[e.Linear=1]="Linear",e[e.AscendingBinary=2]="AscendingBinary"}(ee||(ee={})),t.makeWildcardComparer=ae,t.xlookup=function(e,t){const[r,n,o,s=a.missingOper,l,c]=t,d=re(e,n,l,c);if(void 0!==d.kind)return d;const g=function(e){switch(e.kind){case _.OperKind.Range:return(0,E.assertTrue)("calc.funcs.xlookup",(0,v.isSheetIndex)(e.sheets)),e.ranges.length>1?i.naErrorOper:[e.ranges[0].rows,e.ranges[0].cols];case _.OperKind.Array:return[e.rows,e.cols]}}(o);if(!Array.isArray(g))return g;const[m,h]=g,p=d.lookupArray.length,f=p===m&&(1===m||!d.isHorizontal),S=p===h&&(1===h||d.isHorizontal);if(!f&&!S)return u.valueErrorOper;const F=ie(e,d,r);if(void 0===F)return(0,y.isMissingOper)(s)?i.naErrorOper:s;const b=e.mathpack;return K(e,f?[o,b.fromNumber(F+1),1===h?b.one:b.zero]:[o,1===m?b.one:b.zero,b.fromNumber(F+1)])},t.xmatch=function(e,t){const[r,n,a,o]=t,s=re(e,n,a,o);if(void 0!==s.kind)return s;const u=ie(e,s,r);return void 0===u?i.naErrorOper:e.mathpack.fromNumber(u+1)}},3392:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sqrtpi=t.factdouble=t.fact=t.quotient=t.mod=t.radians=t.degrees=t.sign=t.abs=t.odd=t.even=t.floor_precise=t.floor_math=t.floor=t.ceiling_precise=t.ceiling_math=t.ceiling=t.mround=t.rounddown=t.roundup=t.trunc=t.round=t.int=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log=t.log10=t.ln=t.power=t.exp=t.sqrt=t.pi=void 0;const n=r(7674),a=r(6067),i=r(6067),o=r(6067),s=r(6067);function u(e,t,r){const n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return i.numErrorOper;if(0===n||0===a)return e.zero;const s=e.div(t,r);return(0,o.isErrorOper)(s)?s:e.mul(e.ceil(e.viewRound(s)),r)}function l(e,t,r){const n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return i.numErrorOper;if(0===n&&0===a)return t;const s=e.div(t,r);return(0,o.isErrorOper)(s)?s:e.mul(e.floor(e.viewRound(s)),r)}function c(e,t,[r]){const a=t.mathpack;if(a.cond(r)>=0){const t=a.ceil(r);return 0===a.cond2((0,n.assertNumber)((0,n.numMod)(a,t,a.fromNumber(2))),a.one)===e?a.add(t,a.one):t}const i=a.floor(r);return 0===a.cond2((0,n.assertNumber)((0,n.numMod)(a,i,a.fromNumber(2))),a.one)===e?a.sub(i,a.one):i}t.pi=function(e,t){return e.mathpack.pi},t.sqrt=(0,n.wrap1)((e=>e.mathpack.sqrt)),t.exp=(0,n.wrap1)((e=>e.mathpack.exp)),t.power=(0,n.wrap2)((e=>e.mathpack.power)),t.ln=(0,n.wrap1)((e=>e.mathpack.ln)),t.log10=(0,n.wrap1)((e=>e.mathpack.log)),t.log=function(e,[t,r]){const n=e.mathpack;if(void 0===r)return n.log(t);const a=n.ln(t);if((0,o.isErrorOper)(a))return a;const i=n.ln(r);return(0,o.isErrorOper)(i)?i:n.div(a,i)},t.sin=(0,n.wrap1)((e=>e.mathpack.sin)),t.cos=(0,n.wrap1)((e=>e.mathpack.cos)),t.tan=(0,n.wrap1)((e=>e.mathpack.tan)),t.asin=(0,n.wrap1)((e=>e.mathpack.asin)),t.acos=(0,n.wrap1)((e=>e.mathpack.acos)),t.atan=(0,n.wrap1)((e=>e.mathpack.atan)),t.atan2=(0,n.wrap2)((e=>e.mathpack.atan2)),t.int=function(e,t){let[r]=t;const n=e.mathpack;return n.cond2(n.abs(r),n.fromNumber(1e15))<0&&(r=n.viewRound(r)),n.floor(r)},t.round=(0,n.wrap2)((e=>e.mathpack.round)),t.trunc=function(e,[t,r=e.mathpack.zero]){return e.mathpack.roundDown(t,r)},t.roundup=(0,n.wrap2)((e=>e.mathpack.roundUp)),t.rounddown=(0,n.wrap2)((e=>e.mathpack.roundDown)),t.mround=function(e,[t,r]){const a=(0,n.chkNumOper)(e,t);if((0,o.isErrorOper)(a))return a;const s=(0,n.chkNumOper)(e,r);if((0,o.isErrorOper)(s))return s;const u=e.mathpack;if(0===u.cond(s))return u.zero;if(0!==u.cond(a)&&u.cond(a)<0!=u.cond(s)<0)return i.numErrorOper;const l=u.div(a,s);if((0,o.isErrorOper)(l))return i.numErrorOper;const c=u.floor(l),d=(0,n.assertNumber)(u.sub(l,c)),g=u.fromNumber(.5-5e-15);if(u.cond2(d,g)<0)return u.mul(c,s);const m=u.add(c,u.one);return(0,o.isErrorOper)(m)?m:u.mul(m,s)},t.ceiling=function(e,[t,r]){return u(e.mathpack,t,r)},t.ceiling_math=function(e,[t,r,n]){const a=e.mathpack;let i=void 0===r||(0,s.isMissingOper)(r)?a.one:a.abs(r);const o=void 0===n||(0,s.isMissingOper)(n)?a.zero:n;return 0!==a.cond(o)&&a.cond(t)<0&&(i=a.neg(i)),0===a.cond(i)?a.zero:u(a,t,i)},t.ceiling_precise=function(e,[t,r]){const n=e.mathpack,a=void 0===r||(0,s.isMissingOper)(r)?n.one:n.abs(r);return 0===n.cond(a)?n.zero:u(n,t,a)},t.floor=function(e,[t,r]){return l(e.mathpack,t,r)},t.floor_math=function(e,[t,r,n]){const a=e.mathpack;let i=void 0===r||(0,s.isMissingOper)(r)?a.one:a.abs(r);const o=void 0===n||(0,s.isMissingOper)(n)?a.zero:n;return 0!==a.cond(o)&&a.cond(t)<0&&(i=a.neg(i)),0===a.cond(i)?a.zero:l(a,t,i)},t.floor_precise=function(e,[t,r]){const n=e.mathpack,a=void 0===r||(0,s.isMissingOper)(r)?n.one:n.abs(r);return 0===n.cond(a)?n.zero:l(n,t,a)},t.even=c.bind(void 0,!0),t.odd=c.bind(void 0,!1),t.abs=(0,n.wrap1)((e=>e.mathpack.abs)),t.sign=function(e,[t]){const r=e.mathpack;return r.fromNumber(r.cond(t))},t.degrees=function(e,[t]){const r=e.mathpack,a=(0,n.assertNumber)(r.div(r.fromNumber(180),r.pi));return r.mul(t,a)},t.radians=function(e,[t]){const r=e.mathpack,a=(0,n.assertNumber)(r.div(r.pi,r.fromNumber(180)));return r.mul(t,a)},t.mod=(0,n.wrap2)((e=>e.mathpack.mod)),t.quotient=function(e,[t,r]){const s=(0,n.chkNumOper)(e,t);if((0,o.isErrorOper)(s))return s;const u=(0,n.chkNumOper)(e,r);if((0,o.isErrorOper)(u))return u;const l=e.mathpack;if(0===l.cond(u))return a.div0ErrorOper;const c=l.div(s,u);return(0,o.isErrorOper)(c)?i.numErrorOper:l.cond(c)>0?l.floor(c):l.ceil(c)},t.fact=function(e,[t]){const r=e.mathpack,n=r.sfix(t);if(r.cond(t)<0||n>170)return i.numErrorOper;let a=r.one;for(let e=n;e>0;e-=1){if((0,o.isErrorOper)(a))return a;a=r.mul(r.fromNumber(e),a)}return a},t.factdouble=function(e,[t]){const r=(0,n.chkNumOper)(e,t);if((0,o.isErrorOper)(r))return r;const a=e.mathpack,s=a.floor(r);if(a.cond2(s,a.fromNumber(-1))<0||a.cond2(s,a.fromNumber(300))>0)return i.numErrorOper;let u=a.one;for(let e=a.toNumber(s);e>1;e-=2){if((0,o.isErrorOper)(u))return u;u=a.mul(a.fromNumber(e),u)}return u},t.sqrtpi=function(e,[t]){const r=(0,n.chkNumOper)(e,t);if((0,o.isErrorOper)(r))return r;const a=e.mathpack;if(a.cond(r)<0)return i.numErrorOper;const s=a.mul(a.pi,r);return(0,o.isErrorOper)(s)?s:a.sqrt(s)}},9865:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextFuncs=void 0,t.nextFuncs={v1:{}}},4167:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valuetotext=t.arraytotext=t.numbervalue=t.isWhitespace=t.timevalue=t.datevalue=t.value=t.dollar=t.fixed=t.text=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6366),u=r(6366),l=r(3392),c=r(6067),d=r(6366),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(3228),C=r(3228),A=r(6067),E=r(3228),T=r(3109),R=r(6366),k=r(6366),N=r(6366),I=r(6366),{codePointSpace:O,codePointTab:P,codePointLF:M,codePointCR:D}=d.codePoint;function w(e,t,r,a){if(void 0===r||(0,g.isMissingOper)(r))return{formatValue:t,formatDecimals:a??2};const i=e.config.mathpack;if(i.cond(r)<0){const n=0,a=(0,l.round)(e,[t,r]);return(0,u.assertTrue)("calc.funcs.fixedDollarRound",(0,p.isNumberOper)(a)||(0,m.isErrorOper)(a)),{formatValue:a,formatDecimals:n}}const o=i.sfix(r);return o<0||o>127?{formatValue:n.valueErrorOper,formatDecimals:0}:{formatValue:t,formatDecimals:o}}function L(e){let t=0;for(;t<e.length&&e.charCodeAt(t)===O;)t+=1;return e.substring(t)}function _(e,t){return(0,h.isStringOper)(t)?t.value.length>255?n.valueErrorOper:e.parseDate(L(t.value))??n.valueErrorOper:n.valueErrorOper}function x(e){return e===O||e===P||e===D||e===M}var K;function W(e,t,r){const a=void 0===r?K.Concise:e.mathpack.sfix(r);return a!==K.Concise&&a!==K.Strict?n.valueErrorOper:U(e,t,a)}function U(e,t,r){const n=[],l=e.config.localeInfo;switch(t.kind){case A.OperKind.Array:{for(let e=0;e<t.rows;++e)for(let r=0;r<t.cols;++r){const n=t.opers[e][r];if((0,S.isArrayOper)(n)||(0,v.isRangeOper)(n))return i.calcErrorOper}const a=r===K.Concise?l.listSeparator:l.rowSeparator,o=r===K.Concise?l.listSeparator:l.columnSeparator;r===K.Strict&&n.push(l.leftBrace);for(let i=0;i<t.rows;++i){0!==i&&(n.push(a),r===K.Concise&&n.push(" "));for(let a=0;a<t.cols;++a){0!==a&&(n.push(o),r===K.Concise&&n.push(" "));const s=U(e,t.opers[i][a],r);if((0,m.isErrorOper)(s))return s;n.push(s.value)}}r===K.Strict&&n.push(l.rightBrace);break}case A.OperKind.String:r===K.Strict?n.push('"'+t.value.replace(/"/g,'""')+'"'):n.push(t.value);break;case A.OperKind.Number:case A.OperKind.Boolean:{const r=e.coerceOper(t,A.OperKind.String);(0,u.assertTrue)("calc.funcs.operToText",(0,h.isStringOper)(r)),n.push(r.value);break}case A.OperKind.Blank:break;case A.OperKind.Error:{const e=l.errorNames[t.type];null==e&&(0,T.throwEvaluationError)((0,F.internal)(`No locale data for error type ${t.type}`)),n.push(e);break}case A.OperKind.Rich:(0,T.throwEvaluationError)((0,y.notImplemented)(["ARRAYTOTEXT/VALUETOTEXT rich argument"]));default:return(0,s.assertNever)("calc.funcs.operToText",t)}return n.reduce(((e,t)=>e+t.length),0)>o.cellStringLimit?i.calcErrorOper:(0,a.stringOper)(n.join(""))}t.text=function(e,[t,{value:r}]){const i=(0,f.isRichOper)(t)?t.getFallback():t;if((0,h.isStringOper)(i)&&i.value.length>255||r.length>255)return n.valueErrorOper;let o;switch(i.kind){case A.OperKind.String:{const t=e.coerceOper(i,A.OperKind.Number);o=(0,p.isNumberOper)(t)?t:i;break}case A.OperKind.Number:o=i;break;case A.OperKind.Boolean:{const t=e.coerceOper(i,A.OperKind.String);(0,u.assertTrue)("calc.funcs.text",(0,h.isStringOper)(t)),o=t;break}case A.OperKind.Error:return n.valueErrorOper}const s=e.applyFormat(e.originSheet.document,r,o,E.NumberFormatSource.CustomString);return void 0!==s?(0,a.stringOper)(s):n.valueErrorOper},t.fixed=function(e,[t,r,i]){const{formatValue:o,formatDecimals:s}=w(e,t,r,void 0);if((0,m.isErrorOper)(o))return o;let u;u=i?.value?0===s?c.KnownFormat.NoComFixed0:2===s?c.KnownFormat.NoComFixed:(0,b.buildNumberFormat)(e.config.localeInfo,!1,1,s):0===s?c.KnownFormat.Fixed0:2===s?c.KnownFormat.Fixed:(0,b.buildNumberFormat)(e.config.localeInfo,!0,4,s);const l=e.applyFormat(e.originSheet.document,u,o,E.NumberFormatSource.CustomBytecode);return void 0!==l?(0,a.stringOper)(l):n.valueErrorOper},t.dollar=function(e,[t,r]){const{localeInfo:i}=e.config,{formatValue:o,formatDecimals:s}=w(e,t,r,i.isEastAsia?i.currencyDecimals:void 0);if((0,m.isErrorOper)(o))return o;const u=0===s?c.KnownFormat.Currency:2===s?c.KnownFormat.CurrencyDec:(0,C.buildCurrencyFormat)(i,!1,s,!0,!1),l=e.applyFormat(e.originSheet.document,u,o,E.NumberFormatSource.CustomBytecode);return void 0!==l&&l.length>0&&l.charCodeAt(l.length-1)===O?(0,a.stringOper)(l.substring(0,l.length-1)):void 0!==l?(0,a.stringOper)(l):n.valueErrorOper},t.value=function(e,[t]){switch(t.kind){case A.OperKind.Boolean:return n.valueErrorOper;case A.OperKind.Number:return t;case A.OperKind.String:return t.value.length>255?n.valueErrorOper:e.coerceOper((0,a.stringOper)(L(t.value)),A.OperKind.Number)}},t.datevalue=function(e,[t]){const r=_(e,t);return(0,m.isErrorOper)(r)?r:e.mathpack.trunc(r)},t.timevalue=function(e,[t]){const r=_(e,t);return(0,m.isErrorOper)(r)?r:e.mathpack.sub(r,e.mathpack.trunc(r))},t.isWhitespace=x,t.numbervalue=function(e,t){const[r,i,o]=t,s=e.mathpack,l=e.config.localeInfo;if(void 0!==i&&(!(0,h.isStringOper)(i)||""===i.value)||void 0!==o&&(!(0,h.isStringOper)(o)||""===o.value))return n.valueErrorOper;const c=e=>(0,N.stringFromCodePoint)((0,k.stringCodePointAt)(e,0)),d=l.decimalSeparator,g=i?c(i.value):d;let m=o?c(o.value):l.thousandsSeparator;if(g===m){if(void 0!==o)return n.valueErrorOper;m=d}const f=r.value;if(""===f)return s.zero;let S=!1,v=0;const F=[];let y=0;const b=e=>(F.push(e),y+=e.length);for(;v<f.length&&y<255;)if(x(f.charCodeAt(v)))v+=1;else if(S||!(0,I.stringStartsWith)(f,m,v))if((0,I.stringStartsWith)(f,g,v))S=!0,b(d),v+=g.length;else{const e=(0,k.stringCodePointAt)(f,v);b((0,N.stringFromCodePoint)(e)),v+=(0,R.numCodeUnits)(e)}else v+=m.length;if(v!==f.length)return n.valueErrorOper;let C=0;for(;F.length>0&&"%"===F[F.length-1];)y-=F.pop().length,++C;if(0===F.length)return s.zero;const E=e.coerceOper((0,a.stringOper)(F.join("")),A.OperKind.Number);if(!(0,p.isNumberOper)(E))return n.valueErrorOper;let T=E;for(;C>0;)T=s.div(T,s.fromNumber(100)),(0,u.assertTrue)("calc.funcs.numberValue",(0,p.isNumberOper)(T)),--C;return T},function(e){e[e.Concise=0]="Concise",e[e.Strict=1]="Strict"}(K||(K={})),t.arraytotext=function(e,t){return W(e,t[0],t[1])},t.valuetotext=function(e,t){return W(e,t[0],t[1])}},5625:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulatext=t.isformula=t.isodd=t.iseven=t.isomitted=t.islambda=t.isref=t.isnumber=t.istext=t.isnontext=t.isna=t.islogical=t.isblank=t.iserr=t.iserror=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(6366),E=r(1819),T=r(7674);function R(e,[t]){const r=(0,T.chkNumOper)(e,t);if((0,S.isErrorOper)(r))return r;const n=e.mathpack,a=(0,T.assertNumber)(n.add(n.abs(r),n.fromNumber(1.0000000000000003e-10))),i=(0,T.assertNumber)(n.div(n.floor(a),n.fromNumber(2)));return(0,o.booleanOper)(0===n.cond2(i,n.floor(i)))}function k(e,t,r){if(!(0,l.isSheetIndex)(t.sheets))return n.valueErrorOper;const a=t.ranges[0];if(e.calcingArray||!(0,c.isGridCell)(a)){const n=t.sheets;return(0,i.arrayOper)(a.rows,a.cols,(0,A.jaggedArray)(a.rows,a.cols,((t,i)=>{const o=(0,C.sheetGridCell)(n,(0,b.gridCell)(a.row+t,a.col+i));return r(e.getCellFormula(o),o)})))}const o=(0,d.sheetGridRangeAnchor)((0,y.sheetGridRange)(t.sheets,a));return r(e.getCellFormula(o),o)}t.iserror=function(e,[t]){return(0,o.booleanOper)((0,S.isErrorOper)(t))},t.iserr=function(e,[t]){return(0,o.booleanOper)((0,S.isErrorOper)(t)&&t.type!==u.ErrorType.NA)},t.isblank=function(e,[t]){return(0,o.booleanOper)((0,g.isBlankOper)(t))},t.islogical=function(e,[t]){return(0,o.booleanOper)((0,m.isBooleanOper)(t))},t.isna=function(e,[t]){return(0,o.booleanOper)((0,S.isErrorOper)(t)&&t.type===u.ErrorType.NA)},t.isnontext=function(e,[t]){return(0,o.booleanOper)(!(0,h.isStringOper)(t))},t.istext=function(e,[t]){return(0,o.booleanOper)((0,h.isStringOper)(t))},t.isnumber=function(e,[t]){return(0,o.booleanOper)((0,p.isNumberOper)(t))},t.isref=function(e,[t]){return(0,o.booleanOper)((0,f.isRangeOper)(t))},t.islambda=function(e,[t]){return(0,o.booleanOper)(t instanceof E.LambdaOper)},t.isomitted=function(e,[t]){return(0,o.booleanOper)((0,v.isMissingOper)(t))},t.iseven=R,t.isodd=function(e,t){const r=R(e,t);return(0,m.isBooleanOper)(r)?(0,o.booleanOper)(!r.value):r},t.isformula=function(e,[t]){return k(e,t,(e=>(0,o.booleanOper)(void 0!==e)))},t.formulatext=function(e,[t]){return k(e,t,((t,r)=>{if(void 0===t)return a.naErrorOper;const n=e.printFormula(t,r.range);return t.source.kind===F.LexicalKind.Cell?(0,s.stringOper)(n):(0,s.stringOper)("{"+n+"}")}))}},8969:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.single=t.transpose=t.offset=t.sheet=t.sheets=t.column=t.row=t.columns=t.rows=t.areas=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(6366),E=r(6366),T=r(6366),R=r(6366);function k(e,t){if(!t)return[e.reflectionGridCell,!e.calcingArray];if(!(0,u.isSheetIndex)(t.sheets))return n.valueErrorOper;if(t.ranges.length>1)return a.refErrorOper;const r=t.ranges[0];return[r,(0,l.isGridCell)(r)]}t.areas=function(e,[t]){return(0,u.isSheetIndex)(t.sheets)?e.mathpack.fromNumber(t.ranges.length):n.valueErrorOper},t.rows=function(e,[t]){const r=e.mathpack;return(0,c.isArrayOper)(t)?r.fromNumber(t.rows):(0,u.isSheetIndex)(t.sheets)?t.ranges.length>1?a.refErrorOper:r.fromNumber(t.ranges[0].rows):n.valueErrorOper},t.columns=function(e,[t]){const r=e.mathpack;return(0,c.isArrayOper)(t)?r.fromNumber(t.cols):(0,u.isSheetIndex)(t.sheets)?t.ranges.length>1?a.refErrorOper:r.fromNumber(t.ranges[0].cols):n.valueErrorOper},t.row=function(e,[t]){const r=k(e,t);if(!Array.isArray(r))return r;const[n,a]=r,i=e.mathpack;return a?i.fromNumber(n.row+1):(0,s.arrayOper)(n.rows,1,(0,R.jaggedArray)(n.rows,1,(e=>i.fromNumber(n.row+e+1))))},t.column=function(e,[t]){const r=k(e,t);if(!Array.isArray(r))return r;const[n,a]=r,i=e.mathpack;return a?i.fromNumber(n.col+1):(0,s.arrayOper)(1,n.cols,(0,R.jaggedArray)(1,n.cols,((e,t)=>i.fromNumber(n.col+t+1))))},t.sheets=function(e,[t]){const r=e.mathpack;return t?(0,c.isArrayOper)(t)?i.naErrorOper:r.fromNumber(e.getSheetRangeIndexes(t.sheets).length):r.fromNumber(e.getSheetRangeIndexes((0,F.allSheetsRange)(e.reflectionSheet.document)).length)},t.sheet=function(e,[t]){const r=e.mathpack;if(!t){const t=e.reflectionSheet;return void 0===t.index?i.naErrorOper:r.fromNumber(e.getSheetRangePosition(t)+1)}if((0,m.isStringOper)(t)){const n=e.getSheetIndex(e.reflectionSheet.document,t.value);return void 0===n?i.naErrorOper:r.fromNumber(e.getSheetRangePosition(n)+1)}return(0,d.isRangeOper)(t)?r.fromNumber(e.getSheetRangePosition(t.sheets)+1):(0,c.isArrayOper)(t)?i.naErrorOper:(0,T.assertNever)("calc.funcs.sheet",t)},t.offset=function(e,[t,r,i,s,l]){if(!(0,u.isSheetIndex)(t.sheets))return n.valueErrorOper;if(1!==t.ranges.length)return n.valueErrorOper;const c=e.mathpack,{row:d,col:m,rows:h,cols:p}=t.ranges[0];let f=d;(0,g.isNumberOper)(r)&&(f+=c.lfix(r));let S=m;(0,g.isNumberOper)(i)&&(S+=c.lfix(i));let v=f+h-1;if(void 0!==s&&(0,g.isNumberOper)(s)){const e=c.cond(s);if(0===e)return a.refErrorOper;v=f+c.lfix(s)-(e>0?1:-1)}let F=S+p-1;if(void 0!==l&&(0,g.isNumberOper)(l)){const e=c.cond(l);if(0===e)return a.refErrorOper;F=S+c.lfix(l)-(e>0?1:-1)}const T=(0,A.fastMin)(f,v),R=(0,A.fastMin)(S,F),k=(0,E.fastMax)(f,v)-T+1,N=(0,E.fastMax)(S,F)-R+1;return T<0||R<0||T+k>b.sheetRows||R+N>C.sheetCols?a.refErrorOper:(0,o.rangeSeqOper)(t.sheets,[(0,y.gridRange)(T,R,k,N)])},t.transpose=function(e,[t]){return(0,c.isArrayOper)(t)?(0,s.arrayOper)(t.cols,t.rows,(0,R.jaggedArray)(t.cols,t.rows,((e,r)=>t.opers[r][e]))):t},t.single=function(e,[t]){if((0,h.isPrimitiveOper)(t)||(0,f.isMissingOper)(t)||(0,v.isBlankOper)(t)||(0,S.isRichOper)(t))return t;if((0,c.isArrayOper)(t))return t.opers[0][0];if(!(0,u.isSheetIndex)(t.sheets))return a.refErrorOper;if(1!==t.ranges.length)return n.valueErrorOper;const r=e.originGridCell,i=(0,p.gridCellImplicitIsect)(r,t.ranges[0]);return void 0===i?n.valueErrorOper:(0,o.rangeSeqOper)(t.sheets,[i])}},2769:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.record=t.fieldvalue=void 0;const n=r(6067),a=r(6067),i=r(6366),o=r(1819);t.fieldvalue=function(e,[t,{value:r}]){if((0,a.isRichOper)(t)){const e=t.getField(r);if(void 0!==e)return e}return n.fieldErrorOper},t.record=function(e,t){const r=t[0],n=e.config.localeInfo;let a=i.RedBlackMapTree.create(n.stringCompareCI);for(let e=1;e<t.length;e+=2){const{value:r}=t[e],n=t[e+1];a=a.setValue(r,n)}return new o.RecordOper(a,r)}},3091:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reduceDerefOpers=t.isPrimitiveCoercedOper=t.isCoercedArrayOper=t.coercedArrayOper=void 0;const n=r(5146),a=r(6366),i=r(6366),o=r(6366),s=r(6067);t.coercedArrayOper=function(e,t,r){return(0,i.assertNatural)("calc.runtime.coercedArrayOper",e),(0,i.assertNatural)("calc.runtime.coercedArrayOper",t),r.length!==e?(0,o.assertFalse)("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:s.OperKind.Array,rows:e,cols:t,opers:r}},t.isCoercedArrayOper=function(e){return e.kind===s.OperKind.Array};const u=s.OperKind.Number|s.OperKind.String|s.OperKind.Boolean;t.isPrimitiveCoercedOper=function(e){const{kind:t}=e;return"number"==typeof t&&0!=(t&u)},t.reduceDerefOpers=function(e,t,r,i,o){const u=(n,i,u,c)=>{if(i?.kind===s.OperKind.Array){const e=new a.StrictArray2D(i.rows,i.cols,i.opers);let t=n;for(let r=0;r<u;r+=1)t=l(t,e);return t}const d=(c&&void 0!==o?o:r)(e,i);return null==d?n:t(n,d,u)};function l(e,t){let r=e;for(let e=0;e<t.rows;e+=1)for(let n=0;n<t.cols;n+=1){const a=t.get(e,n);void 0!==a&&(r=u(r,a,1,!0))}return r}function c(e,t){let r=e;const n=t.getSparse(),a=t.cols-t.denseCols;for(let e=0;e<t.denseRows;e+=1){for(let n=0;n<t.denseCols;n+=1){const a=t.get(e,n);void 0!==a&&(r=u(r,a,1,!1))}a>0&&void 0!==n&&(r=u(r,n,a,!1))}const i=(t.rows-t.denseRows)*t.cols;return i>0&&void 0!==n&&(r=u(r,n,i,!1)),r}return i.reduce(((e,t)=>(0,n.isRangeValues)(t)?t.arrays.reduce(c,e):u(e,t,1,!1)),void 0)}},9393:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wraprows=t.wrapcols=t.torow=t.tocol=t.chooserows=t.choosecols=t.vstack=t.hstack=t.expand=t.drop=t.take=t.sequence=t.indirect=t.address=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(6067),E=r(6067),T=r(6067),R=r(6067),k=r(6067),N=r(6067),I=r(6067),O=r(6067),P=r(6067),M=r(6067),D=r(6067),w=r(6067),L=r(6366),_=r(6366),x=r(6366),K=r(6366),W=r(6067),U=r(3109),G=r(6366),B=r(6366),V=r(6366),j=r(6366),H=r(6366),q=r(6366),z=r(6366),Q=r(6366),$=r(6366),Y=r(6366),J=r(6366),X=r(5146),Z=r(7674);function ee(e,t){if((0,G.fastAbs)(e)<t){const r=(0,G.fastAbs)(e);return e<0?{start:t-r,count:r}:{start:0,count:r}}return{start:0,count:t}}function te(e,t){if((0,G.fastAbs)(e)<t){const r=t-(0,G.fastAbs)(e);return e<0?{start:0,count:r}:{start:e,count:r}}return{start:0,count:0}}t.address=function(e,[t,r,n,a,i]){const o=e.mathpack,u=n?.kind===W.OperKind.Number?o.sfix(n)-1:0;if(u<0||u>3)return s.valueErrorOper;const c=0!=(1&u),d=0!=(2&u),p=a?.kind!==W.OperKind.Boolean||a.value?v.RefStyle.A1:v.RefStyle.R1C1,f=(e,t,r)=>p===v.RefStyle.R1C1&&e?-t<r&&r<t:1<=r&&r<=t,S=o.sfix(t);if(!f(d,g.sheetRows,S))return s.valueErrorOper;if(!(0,T.isNumberOper)(r))return s.valueErrorOper;const b=o.sfix(r);if(!f(c,m.sheetCols,b))return s.valueErrorOper;const E=(0,h.gridCell)(S<0?g.sheetRows-1:0,b<0?m.sheetCols-1:0),R=(0,F.pos)(d?y.PosKind.Rel:y.PosKind.Abs,p===v.RefStyle.R1C1&&d?S:S-1),k=(0,F.pos)(c?y.PosKind.Rel:y.PosKind.Abs,p===v.RefStyle.R1C1&&c?b:b-1),N=(0,C.formatCellPos)(e.config.localeInfo,p,E,R,k,!1);return(0,L.assertTrue)("calc.funcs.address: cell wrapped",void 0!==N),i?.kind===W.OperKind.String?""===i.value?(0,l.stringOper)("!"+N):i.value.length>255?s.valueErrorOper:(0,l.stringOper)((0,A.formatQualifier)(e.config.localeInfo,e.config.refStyle,i.value)+"!"+N):(0,l.stringOper)(N)},t.indirect=function(e,[{value:t},r]){const n=r?.value??1?v.RefStyle.A1:v.RefStyle.R1C1;if(t.length>255||(0,_.stringStartsWith)(t," "))return s.valueErrorOper;let a=(0,f.originCell)(e.originSheet,e.originGridCell);const i={lexicalKind:p.LexicalKind.Indirect,originGridCell:(0,x.success)(a.range),originSheet:(0,x.success)(a.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:!1},o=e.parseFormula(n,a.range,i,"="+t);if(!(0,K.isSuccess)(o))return u.refErrorOper;let l=o.value.node,c=!1,d=!1;for(;;){if(!c&&l.kind===b.NodeKind.App&&(0,R.isOperatorNode)(l.head)&&l.head.id===w.OperatorId.Pound&&1===l.args.length&&(c=!0,l=l.args[0]),d||l.kind!==b.NodeKind.Name){if(l.kind===b.NodeKind.CellRef){const t=e.getCellRef(l.qualifier,l.ref,a,!0);return void 0===t?u.refErrorOper:(0,E.isSheetIndex)(t.sheets)?c?(0,U.throwEvaluationError)((0,k.notImplemented)(["# operator in INDIRECT"])):t:u.refErrorOper}if(l.kind===b.NodeKind.StructRef){if(void 0===l.lhs)return u.refErrorOper;const t=e.getStructRef(l.lhs,l.rhs,a);return void 0===t||c?u.refErrorOper:t}return u.refErrorOper}{const t=e.getNameFormula(l.qualifier,l.whole,S.NameSource.Indirect);if(void 0===t)return u.refErrorOper;a=(0,f.originCell)(a.sheet,(0,h.gridCell)(0,0)),l=t[1],d=!0}}},t.sequence=(e,t)=>{const[r,n,a,i]=t,o=e.mathpack,u=(0,O.isMissingOper)(r)?1:o.sfix(r),l=void 0===n||(0,O.isMissingOper)(n)?1:o.sfix(n);if(u<0||u>g.sheetRows||l<0||l>g.sheetRows)return s.valueErrorOper;if((0,Z.validateArraySize)(u,l),0===u||0===l)return d.calcErrorOper;const m=void 0===a||(0,O.isMissingOper)(a)?o.fromNumber(1):a,h=void 0===i||(0,O.isMissingOper)(i)?o.fromNumber(1):i;let p=m;const f=[];for(let e=0;e<u;e++){const e=[];for(let t=0;t<l;t++){if(e.push(p),(0,I.isErrorOper)(p))continue;const t=o.add(p,h);p=(0,I.isErrorOper)(t)?t:o.checkAlmostCancellation(h,t)}f.push(e)}return(0,c.arrayOper)(u,l,f)},t.take=(e,t)=>{const[r,n,a]=t,i=e.mathpack,o=(0,Z.rangeOrArrayToVal)(r,s.valueErrorOper);if(!(0,N.isArrayOper)(o)&&!(0,P.isRangeOper)(o))return o;const u=(0,Z.makeSlicer)(o),l=(0,O.isMissingOper)(n)?u.rows:i.lfix(n),c=void 0===a||(0,O.isMissingOper)(a)?u.cols:i.lfix(a),{start:g,count:m}=ee(l,u.rows),{start:h,count:p}=ee(c,u.cols);return 0===m||0===p?d.calcErrorOper:u.slice(g,m,h,p)},t.drop=(e,t)=>{const[r,n,a]=t,i=e.mathpack,o=(0,Z.rangeOrArrayToVal)(r,s.valueErrorOper);if(!(0,N.isArrayOper)(o)&&!(0,P.isRangeOper)(o))return o;const u=(0,Z.makeSlicer)(o),l=(0,O.isMissingOper)(n)?0:i.lfix(n),c=void 0===a||(0,O.isMissingOper)(a)?0:i.lfix(a),{start:g,count:m}=te(l,u.rows),{start:h,count:p}=te(c,u.cols);return 0===m||0===p?d.calcErrorOper:u.slice(g,m,h,p)},t.expand=function(e,t){const[r,n,u=a.missingOper,l=a.missingOper]=t,m=e.mathpack,h=(0,O.isMissingOper)(n)?r.rows:m.lfix(n),p=(0,O.isMissingOper)(u)?r.cols:m.lfix(u);if(h<r.rows||p<r.cols)return s.valueErrorOper;if(0===h||0===p)return d.calcErrorOper;if(p>g.sheetRows||h>g.sheetRows)return o.numErrorOper;(0,Z.validateArraySize)(h,p);const f=(0,O.isMissingOper)(l)?i.naErrorOper:l;return(0,N.isArrayOper)(f)?s.valueErrorOper:(0,c.arrayOper)(h,p,(0,H.array2DToJaggedArray)(new $.StrictSparseArray2D(h,p,r.rows,r.cols,r.opers,f)))},t.hstack=(e,t)=>ne(e,t,!0),t.vstack=(e,t)=>ne(e,t,!1);const re=()=>i.naErrorOper;function ne(e,t,r){const n=e.dereferenceAllOpers(t).map((e=>(0,X.isRangeValues)(e)?e.arrays:[new Q.StrictArray2D(e.rows,e.cols,e.opers)])),a=(0,B.safeConcat)([],n).map((e=>r?(0,Y.transposeArray2D)(e):e)),i=a.reduce(((e,t)=>(0,V.fastMax)(t.cols,e)),0),s=a.reduce(((e,t)=>e+t.rows),0);if(i>g.sheetRows||s>g.sheetRows)return o.numErrorOper;(0,Z.validateArraySize)(s,i);const u=(0,B.safeConcat)([],a.map((e=>function(e,t,r){return e.cols>=t?e:new z.NonstrictSparseArray2D(e.rows,t,e.rows,e.cols,e.get.bind(e),r)}(e,i,re))).map(H.array2DToJaggedArray)),l=new Q.StrictArray2D(u.length,u[0].length,u),d=r?(0,Y.transposeArray2D)(l):l;return(0,c.arrayOper)(d.rows,d.cols,(0,H.array2DToJaggedArray)(d))}function ae(e,t,r){const n=t.lfix(e),a=n>0?n:-n;return a>r||0===a?s.valueErrorOper:(0,Z.getAbsoluteIndex)(r,n)}function ie(e,t,r){if(e.rows>1&&e.cols>1)return s.valueErrorOper;const n=[];for(const a of e.opers)for(const e of a){if(!(0,T.isNumberOper)(e))return(0,I.isErrorOper)(e)?e:s.valueErrorOper;const a=ae(e,t,r);if("number"!=typeof a)return a;n.push(a)}return n}const oe=(e,t)=>{const r=[];for(const n of e){const e=t.opers[n];r.push(e)}return r},se=(e,t)=>t.opers.map((t=>{const r=[];for(const n of e)r.push(t[n]);return r})),ue=(e,t,r,n)=>{const[a,...i]=t;if((0,P.isRangeOper)(a)){if(a.ranges.length>1)return u.refErrorOper;(0,L.assertTrue)("calc.funcs.ChooseColRow: not 3D ref",(0,E.isSheetIndex)(a.sheets))}const s=e.dereferenceOper(a,W.OperKind.Array);if(!(0,N.isArrayOper)(s))return s;const l=function(e,t,r){const n=[];for(const a of e)if((0,N.isArrayOper)(a)){const e=ie(a,t,r);if(!Array.isArray(e))return e;(0,j.safePush)(n,e)}else{const e=ae(a,t,r);if("number"!=typeof e)return e;n.push(e)}return n}(i,e.mathpack,n?s.rows:s.cols);if(!Array.isArray(l))return l;if(l.length>g.sheetRows||(n?s.cols:s.rows)>g.sheetRows)return o.numErrorOper;n?(0,Z.validateArraySize)(l.length,s.cols):(0,Z.validateArraySize)(s.rows,l.length);const m=r(l,s);return 0===m.length||0===m[0].length?d.calcErrorOper:(0,c.arrayOper)(m.length,m[0].length,m)};function le(e,t){return t?new q.NonstrictArray2D(1,e.length,((t,r)=>e[r])):new q.NonstrictArray2D(e.length,1,(t=>e[t]))}function ce(e,t,r){const[a,i,u]=r,l=e.mathpack,[m]=e.dereferenceAllOpers([a]),h=(0,X.isRangeValues)(m)?m.arrays:[new $.StrictSparseArray2D(m.rows,m.cols,m.rows,m.cols,m.opers,n.blankOper)],p=void 0===i||(0,O.isMissingOper)(i)?0:l.lfix(i),f=void 0!==u&&!(0,O.isMissingOper)(u)&&u.value;if(p<0||p>3)return s.valueErrorOper;const S=1===p||3===p,v=2===p||3===p,F=[],y=[],b=(e,t)=>{S&&(0,M.isBlankOper)(e)||v&&(0,I.isErrorOper)(e)||(F.push(e),y.push(t))};for(const e of h){const t=f?(0,J.transposeSparseArray2D)(e):e,{rows:r,cols:n,denseRows:a,denseCols:i}=t;for(let e=0;e<a;++e){for(let r=0;r<i;++r)b(t.get(e,r),1);i<n&&b(t.getSparse(),n-i)}a<r&&n>0&&b(t.getSparse(),n*(r-a))}const C=y.reduce(((e,t)=>e+t),0);if(0===C)return d.calcErrorOper;if(C>g.sheetRows)return o.numErrorOper;t===D.WorksheetFuncId.TOROW?(0,Z.validateArraySize)(1,C):(0,Z.validateArraySize)(C,1);const A=[];for(let e=0;e<F.length;++e){const t=F[e],r=y[e];for(let e=0;e<r;++e)A.push(t)}const E=le(A,t===D.WorksheetFuncId.TOROW);return(0,c.arrayOper)(E.rows,E.cols,(0,H.array2DToJaggedArray)(E))}function de(e,t,r){const[n,u,l=a.missingOper]=r;if(!(1===n.rows&&n.cols>=1||1===n.cols&&n.rows>=1))return s.valueErrorOper;const d=e.mathpack.lfix(u);if(d<1)return o.numErrorOper;const g=1===n.rows?n.opers[0]:n.opers.map((e=>e[0])),m=g.length;if(d>=m){const e=le(g,t===D.WorksheetFuncId.WRAPROWS);return(0,c.arrayOper)(e.rows,e.cols,(0,H.array2DToJaggedArray)(e))}const h=Math.floor((m+d-1)/d);t===D.WorksheetFuncId.WRAPROWS?(0,Z.validateArraySize)(h,d):(0,Z.validateArraySize)(d,h);const p=(0,O.isMissingOper)(l)?i.naErrorOper:l,f=(e,t)=>{const r=e*d+t;return r>=g.length?p:g[r]},S=t===D.WorksheetFuncId.WRAPROWS?new q.NonstrictArray2D(h,d,((e,t)=>f(e,t))):new q.NonstrictArray2D(d,h,((e,t)=>f(t,e)));return(0,c.arrayOper)(S.rows,S.cols,(0,H.array2DToJaggedArray)(S))}t.choosecols=(e,t)=>ue(e,t,se,!1),t.chooserows=(e,t)=>ue(e,t,oe,!0),t.tocol=function(e,t){return ce(e,D.WorksheetFuncId.TOCOL,t)},t.torow=function(e,t){return ce(e,D.WorksheetFuncId.TOROW,t)},t.wrapcols=function(e,t){return de(e,D.WorksheetFuncId.WRAPCOLS,t)},t.wraprows=function(e,t){return de(e,D.WorksheetFuncId.WRAPROWS,t)}},7985:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sortOpers=void 0;const n=r(6366),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(3109),l=e=>e<0?-1:e>0?1:0,c={[a.OperKind.Number]:1,[a.OperKind.String]:2,[a.OperKind.Boolean]:3,[a.OperKind.Array]:4,[a.OperKind.Error]:5};t.sortOpers=function e(t,r,d,g,m){if((0,i.isBlankOper)(r))return(0,i.isBlankOper)(d)?0:1;if((0,i.isBlankOper)(d))return-1;if((0,o.isRichOper)(r)||(0,o.isRichOper)(d))return(0,u.throwEvaluationError)((0,s.notImplemented)(["rich value sort"]));if(r.kind!==d.kind)return l(g*(c[r.kind]-c[d.kind]));switch(r.kind){case a.OperKind.Number:return l(g*t.mathpack.cond2(r,d));case a.OperKind.String:return l(g*t.localeInfo.stringCompareCI(r.value,d.value));case a.OperKind.Boolean:return l(g*(r.value-d.value));case a.OperKind.Array:{const a=r,i=d,o=(0,n.fastMin)(a.rows,i.rows),s=(0,n.fastMin)(a.cols,i.cols);for(let r=0;r<o;++r){for(let n=0;n<s;++n){const o=e(t,a.opers[r][n],i.opers[r][n],g,m);if(0!==o)return o}if(a.cols!==i.cols)return l(g*(a.cols-i.cols))}return a.rows!==i.rows?l(g*(a.rows-i.rows)):0}case a.OperKind.Error:return m?l(g*(r.type-d.type)):0}}},4525:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textAfter=t.textBefore=t.textSplit=t.substitute=t.search=t.replace=t.find=t.proper=t.upper=t.lower=t.unicode=t.code=t.unichar=t.char=t.clean=t.trim=t.rept=t.exact=t.concatenate=t.len=t.mid=t.left=t.right=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(3109),S=r(6366),v=r(6366),F=r(6366),y=r(6366),b=r(6366),C=r(6366),A=r(6366),E=r(6366),T=r(2443),R=r(6366),k=r(6366),N=r(6366),I=r(6067),O=r(6880),P=r(6366),M=r(6366),D=r(7674),{codePointSpace:w,codePointCapitalA:L,codePointCapitalZ:_,codePointSmallA:x,codePointSmallZ:K}=R.codePoint,W=2147483647;function U(e,t){return void 0===t?1:e.cond(t)<0?d.valueErrorOper:e.sfix(t)}function G(e){return e>=L&&e<=_||e>=x&&e<=K}function B(e,t,r){return""===e?e:function(e){for(let t=0;t<e.length;t+=1)if(e.charCodeAt(t)>=128)return!1;return!0}(e)?r():(0,f.throwEvaluationError)((0,i.notImplemented)([t+" for non-ASCII input"]))}function V(e,t,r){if(void 0===t||(0,u.isMissingOper)(t))return[];if((0,s.isStringOper)(t))return r&&0===t.value.length?d.valueErrorOper:[t.value];const a=[];for(let i=0;i<t.rows;++i){const o=t.opers[i];for(let t=0;t<o.length;++t){const i=o[t],s=e.coerceOper(i,I.OperKind.String);if((0,n.isErrorOper)(s))return s;const u=(0,D.assertString)(s).value;if(r&&0===u.length)return d.valueErrorOper;a.push(u)}}return a.sort(((e,t)=>e.length-t.length)),a}function j(e,t,r){for(const n of r)if((0,N.stringStartsWith)(e,n,t))return n}function H(e,t,r,n,a,i,o,s){const l=function(e,t,r,n,a,i,o){const s=t.value,l=void 0===n||(0,u.isMissingOper)(n)?1:e.mathpack.sfix(n),g=V(e,r,!1);if(!Array.isArray(g))return g;const m=g.reduce(((e,t)=>t.length<e?t.length:e),g[0].length),h=-(s.length-m+1),p=s.length-m+1;if(void 0!==n&&!(0,u.isMissingOper)(n)){if(0!==m&&!(l>=h&&l<=p))return d.valueErrorOper;if(0===l)return d.valueErrorOper}let f,S;if(void 0===a||(0,u.isMissingOper)(a))f=!1;else{const t=e.mathpack.lfix(a);if(0!==t&&1!==t)return d.valueErrorOper;f=1===t}if(void 0===i||(0,u.isMissingOper)(i))S=!1;else{const t=e.mathpack.lfix(i);if(0!==t&&1!==t)return d.valueErrorOper;S=1===t}return function(e,t,r,n,a,i,o){let s=e,u=t;if(0===r)return n>0?[0,0]:[s.length,s.length];if(s.length-r<0)return o;a&&(s=s.toLowerCase(),u=u.map((e=>e.toLowerCase())));let l=n,c=0;const d=s.length;let g=1;for(n<0&&(g=-1,c=d);c<=d&&c>=0;){const e=j(s,c,u);if(void 0!==e){if(l-=g,0===l)return[c,e.length];c+=g*(e.length-1)}c+=g}return i&&n-g==0?1===g?[s.length,0]:[0,0]:o}(s,g,m,l,f,S,void 0===o||(0,u.isMissingOper)(o)?c.naErrorOper:o)}(t,r,n,a,i,o,s);if(Array.isArray(l)){const[t,n]=l;return e===q.TEXTBEFORE?(0,g.stringOper)(r.value.slice(0,t)):(0,g.stringOper)(r.value.slice(t+n))}return l}var q;t.right=function(e,[{value:t},r]){if(void 0!==r&&(0,n.isErrorOper)(r))return r;const a=U(e.mathpack,r);if("number"!=typeof a&&(0,n.isErrorOper)(a))return d.valueErrorOper;const i=(0,S.scanCodePointsBack)(t,t.length,a)??0;return(0,g.stringOper)(t.substring(i))},t.left=function(e,[{value:t},r]){if(void 0!==r&&(0,n.isErrorOper)(r))return r;const a=U(e.mathpack,r);if("number"!=typeof a&&(0,n.isErrorOper)(a))return d.valueErrorOper;const i=(0,v.scanCodePoints)(t,0,a)??t.length;return(0,g.stringOper)(t.substring(0,i))},t.mid=function(e,[{value:t},r,n]){const a=e.mathpack,i=a.fix(r)-1,o=a.fix(n);if(a.cond(r)<0||i<0||a.cond(n)<0||o<0)return d.valueErrorOper;const s=(0,v.scanCodePoints)(t,0,i)??t.length,u=(0,v.scanCodePoints)(t,s,o)??t.length;return(0,g.stringOper)(t.substring(s,u))},t.len=function(e,[{value:t}]){return e.mathpack.fromNumber((0,F.countCodePoints)(t,0,t.length))},t.concatenate=function(e,t){let r="";for(let e=0;e<t.length;e+=1){const{value:n}=t[e];if(r.length+n.length>l.cellStringLimit){r+=n.substring(0,l.cellStringLimit-r.length);break}r+=n}return(0,g.stringOper)(r)},t.exact=function(e,[t,r]){return((0,a.isRichOper)(t)||(0,a.isRichOper)(r))&&(0,f.throwEvaluationError)((0,i.notImplemented)(["EXACT rich argument"])),(0,m.booleanOper)(t.value===r.value)},t.rept=function(e,[{value:t},r]){const n=e.mathpack,a=n.fix(r);return n.cond(r)<0||a>W?d.valueErrorOper:""===t?O.emptyStringOper:a*t.length>l.cellStringLimit?d.valueErrorOper:(0,g.stringOper)((0,k.repeat)(t,a))},t.trim=function(e,[{value:t}]){let r="";for(let e=0;e<t.length;){for(;e<t.length&&t.charCodeAt(e)===w;)e+=1;const n=e;for(;e<t.length;){const r=t.charCodeAt(e)===w;if(e+=1,r)break}r+=t.substring(n,e)}return r.length>0&&r.charCodeAt(r.length-1)===w&&(r=r.substring(0,r.length-1)),(0,g.stringOper)(r)},t.clean=function(e,[{value:t}]){let r="";for(let e=0;e<t.length;e+=1){const n=t.charCodeAt(e);(n>=256||(127&n)>=32)&&(r+=t.charAt(e))}return(0,g.stringOper)(r)},t.char=function(e,[t]){const r=e.mathpack.sfix(t);return r<1||r>255?d.valueErrorOper:(0,g.stringOper)(String.fromCharCode(r))},t.unichar=function(e,[t]){const r=e.mathpack,n=r.lfix(r.trunc(t));return r.cond2(t,r.one)<0||n>=1114112?d.valueErrorOper:n<=65535&&(0,y.isAnySurrogate)(n)||n>=64976&&n<=65007||(65535&n)>=65534?c.naErrorOper:(0,g.stringOper)((0,b.stringFromCodePoint)(n))},t.code=function(e,[{value:t}]){if(0===t.length)return d.valueErrorOper;const r=t.charCodeAt(0);return r>255?(0,f.throwEvaluationError)((0,i.notImplemented)(["CODE for codepoints > 255"])):e.mathpack.fromNumber(r)},t.unicode=function(e,[{value:t}]){if(0===t.length)return d.valueErrorOper;const r=t.charCodeAt(0),n=e.mathpack;if(!(0,y.isAnySurrogate)(r))return n.fromNumber(r);if(1===t.length)return d.valueErrorOper;const a=t.charCodeAt(1),i=(0,C.surrogatePairToCodePoint)(r,a);return void 0===i?d.valueErrorOper:n.fromNumber(i)},t.lower=function(e,[{value:t}]){return(0,g.stringOper)(B(t,"LOWER",t.toLowerCase.bind(t)))},t.upper=function(e,[{value:t}]){return(0,g.stringOper)(B(t,"UPPER",t.toUpperCase.bind(t)))},t.proper=function(e,[{value:t}]){return(0,g.stringOper)(B(t,"PROPER",(()=>{const e=t.toLowerCase();let r="",n=0;for(;;){const t=n;for(;n<e.length&&!G(e.charCodeAt(n));)n+=1;if(r+=e.substring(t,n),n===e.length)break;const a=n,i=(0,A.stringCodePointAt)(e,n);for(r+=(0,b.stringFromCodePoint)(i).toUpperCase(),n+=(0,E.numCodeUnits)(i);n<e.length&&G(e.charCodeAt(n));)n+=1;r+=e.substring(a+1,n)}return r})))},t.find=function(e,[{value:t},{value:r},n]){const a=void 0!==n?e.mathpack.sfix(n)-1:0;if(a<0||a>=W)return d.valueErrorOper;const i=(0,v.scanCodePoints)(r,0,a)??r.length,o=r.indexOf(t,i);return o>=0?e.mathpack.fromNumber((0,F.countCodePoints)(r,0,o)+1):d.valueErrorOper},t.replace=function(e,[{value:t},r,n,{value:a}]){const i=e.mathpack.sfix(r)-1;if(i<0||i>=l.cellStringLimit)return d.valueErrorOper;const o=e.mathpack.sfix(n);if(o<0||o>l.cellStringLimit)return d.valueErrorOper;const s=(0,v.scanCodePoints)(t,0,i)??t.length,u=(0,v.scanCodePoints)(t,s,o)??t.length,c=t.slice(0,s),m=t.slice(u);return c.length+a.length+m.length>l.cellStringLimit?d.valueErrorOper:(0,g.stringOper)(c+a+m)},t.search=function(e,[{value:t},{value:r},n]){const a=void 0!==n?e.mathpack.sfix(n)-1:0;if(a<0||a>=W)return d.valueErrorOper;let i=(0,v.scanCodePoints)(r,0,a)??r.length;const o=new T.WildExp(e.config.localeInfo,t,!0);for(;i<r.length;i+=1)if(o.test(r.slice(i)))return e.mathpack.fromNumber((0,F.countCodePoints)(r,0,i)+1);return d.valueErrorOper},t.substitute=function(e,[t,{value:r},{value:a},i]){const{value:o}=t;let s=1/0;if(void 0!==i){const t=e.coerceOper(i,I.OperKind.Number);if((0,n.isErrorOper)(t))return t;if(s=e.mathpack.sfix(t),s<1||s>2147483646)return d.valueErrorOper}const u=r.length;if(u>0){let e="",t=0,n=0;for(;s>=0&&-1!==(n=o.indexOf(r,n));)if(s-=1,s===1/0||0===s){const r=o.slice(t,n);if(e.length+r.length+a.length>l.cellStringLimit)return d.valueErrorOper;e+=r,e+=a,n+=u,t=n}else n+=1;const i=o.slice(t);return e.length+i.length>l.cellStringLimit?d.valueErrorOper:(e+=i,(0,g.stringOper)(e))}return t},t.textSplit=(e,t)=>{const[r,n,a,i,s,l]=t,m=r.value;if(0===m.length)return d.valueErrorOper;let f=V(e,n,!0);if(!Array.isArray(f))return f;let S=V(e,a,!0);if(!Array.isArray(S))return S;const v=void 0!==i&&!(0,u.isMissingOper)(i)&&i.value;let F;if(void 0===s||(0,u.isMissingOper)(s))F=!1;else{const t=e.mathpack.lfix(s);if(0!==t&&1!==t)return d.valueErrorOper;F=1===t}const y=void 0===l||(0,u.isMissingOper)(l)?c.naErrorOper:l;if((0,o.isArrayOper)(y))return d.valueErrorOper;let b=m;if(F&&(b=m.toLowerCase(),f=f.map((e=>e.toLowerCase())),S=S.map((e=>e.toLowerCase()))),0===f.length&&0===S.length)return d.valueErrorOper;const C=function(e,t,r,n,a){let i=0,o=0;const s=[];let u;for(;i<=t.length;){let l,c;if(o<t.length&&(l=j(t,o,r),c=void 0===l?j(t,o,n):void 0),(0,P.assertTrue)("calc.runtime.textsplit: current in bounds",o<=t.length),void 0!==l||void 0!==c||o===t.length){(o-i>0||!a)&&(void 0===u&&(u=[],s.push(u)),u.push((0,g.stringOper)(e.slice(i,o))),void 0!==c&&(u=void 0));const t=(l??c??"1").length;(0,P.assertTrue)("calc.runtime.textsplit: matchLength > 0",t>0),o+=t,i=o}else++o}return s}(m,b,f,S,v);if(!Array.isArray(C))return C;if(0===C.length)return h.calcErrorOper;const A=C.reduce(((e,t)=>(0,M.fastMax)(t.length,e)),0);return(0,P.assertTrue)("calc.runtime.textsplit: non-zero cols",A>0),(0,p.arrayOper)(C.length,A,C.map((e=>{for(;e.length<A;)e.push(y);return e})))},function(e){e[e.TEXTBEFORE=1]="TEXTBEFORE",e[e.TEXTAFTER=2]="TEXTAFTER"}(q||(q={})),t.textBefore=(e,t)=>{const[r,n,a,i,o,s]=t;return H(q.TEXTBEFORE,e,r,n,a,i,o,s)},t.textAfter=(e,t)=>{const[r,n,a,i,o,s]=t;return H(q.TEXTAFTER,e,r,n,a,i,o,s)}},7674:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAbsoluteIndex=t.rangeOrArrayToVal=t.makeSlicer=t.ArraySlicer=t.RangeSlicer=t.validateArraySize=t.numInt=t.numMod=t.validDateRange=t.chkNumMultiOper=t.chkDateOper=t.atpm1904to1900Days=t.chkNumOper=t.assertError=t.assertString=t.assertNumber=t.wrap2=t.wrap1=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(9835),c=r(6366),d=r(6366),g=r(6366),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6366),C=r(6067),A=r(6366),E=r(6366),T=r(3109),R=r(6067),k=r(6366);function N(e,t){const r=(0,l.refToVal)(e,t,!1),n=(0,p.isRichOper)(r)?r.getFallback():r;switch(n.kind){case C.OperKind.Number:return n;case C.OperKind.Boolean:return i.valueErrorOper;case C.OperKind.String:const t=e.coerceOper(n,C.OperKind.Number);return(0,m.isNumberOper)(t)?t:i.valueErrorOper;case C.OperKind.Error:return n;case C.OperKind.Array:return i.valueErrorOper;case C.OperKind.Missing:return o.naErrorOper;case C.OperKind.Blank:return e.mathpack.zero;default:return(0,c.assertNever)("calc.funcs.chkNumOper",n)}}t.wrap1=function(e){return(t,r)=>e(t)(r[0])},t.wrap2=function(e){return(t,r)=>e(t)(r[0],r[1])},t.assertNumber=e=>(0,m.isNumberOper)(e)?e:(0,d.assertFalse)("calc.funcs.assertNumber"),t.assertString=e=>(0,h.isStringOper)(e)?e:(0,d.assertFalse)("calc.funcs.assertString"),t.assertError=e=>(0,f.isErrorOper)(e)?e:(0,d.assertFalse)("calc.funcs.assertError"),t.chkNumOper=N,t.atpm1904to1900Days=1462,t.chkDateOper=function(e,r){let n=N(e,r);if((0,f.isErrorOper)(n))return n;const a=e.mathpack;return a.cond(n)<0?s.numErrorOper:(n=a.floor(n),D(e,n)?(e.config.date1904&&!(0,h.isStringOper)(r)&&(n=a.add(a.fromNumber(t.atpm1904to1900Days),n)),n):s.numErrorOper)},t.chkNumMultiOper=function e(t,r){switch(r.kind){case C.OperKind.Number:return(0,A.success)(new b.StrictSparseArray2D(1,1,1,1,[[r]],u.blankOper));case C.OperKind.String:const n=t.coerceOper(r,C.OperKind.Number);return(0,f.isErrorOper)(n)?(0,E.failure)(i.valueErrorOper):(0,A.success)(new b.StrictSparseArray2D(1,1,1,1,[[n]],u.blankOper));case C.OperKind.Blank:return(0,A.success)(new b.StrictSparseArray2D(1,1,1,1,[[t.mathpack.zero]],u.blankOper));case C.OperKind.Missing:return(0,E.failure)(o.naErrorOper);case C.OperKind.Error:return(0,E.failure)(r);case C.OperKind.Range:return e(t,(0,l.refToVal)(t,r,!1));case C.OperKind.Array:return(0,A.success)(new b.StrictSparseArray2D(r.rows,r.cols,r.rows,r.cols,r.opers,u.blankOper));default:return(0,E.failure)(i.valueErrorOper)}};const I=0,O=2958465,P=0,M=2957003;function D(e,t){let r,n;const a=e.mathpack.lfix(t);return e.config.date1904?(r=P,n=M):(r=I,n=O),a>=r&&a<=n}t.validDateRange=D,t.numMod=function(e,t,r){const n=e.div(t,r);if((0,f.isErrorOper)(n))return n;const a=e.mul(e.trunc(n),r);if((0,f.isErrorOper)(a))return a;const i=e.sub(t,a);return!(0,f.isErrorOper)(i)&&e.cond(t)<0?e.abs(i):i},t.numInt=function(e,t){const r=e.sub(e.trunc(t),t);return(0,m.isNumberOper)(r)&&0===e.cond(r)},t.validateArraySize=function(e,t){if(e*t>1048576)return(0,T.throwEvaluationError)((0,S.notImplemented)(["Very large array size"]))};class w{slice(e,t,r,n){const{row:i,col:o}=this.oper.ranges[0];return(0,a.range3DOper)(this.oper.sheets,(0,R.gridRange)(i+e,o+r,t,n))}constructor(e){this.oper=e;const{rows:t,cols:r}=e.ranges[0];this.rows=t,this.cols=r}}t.RangeSlicer=w;class L{slice(e,t,r,a){return(0,n.arrayOper)(t,a,this.oper.opers.slice(e,e+t).map((e=>e.slice(r,r+a))))}constructor(e){this.oper=e,this.rows=e.opers.length,this.cols=e.opers[0].length}}t.ArraySlicer=L,t.makeSlicer=function(e){return(0,y.isArrayOper)(e)?new L(e):new w(e)},t.rangeOrArrayToVal=function(e,t){return(0,v.isRangeOper)(e)?e.ranges.length>1?t:((0,g.assertTrue)("calc.funcs.rangeOrArrayToVal: not 3D ref",(0,F.isSheetIndex)(e.sheets)),e):e},t.getAbsoluteIndex=function(e,t){return(0,g.assertTrue)("calc.funcs.getAbsoluteIndex",(0,k.isInteger)(t)&&0!==t&&t<=e&&t>=-e),t>0?t-1:e+t}},3270:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.today=t.now=t.randarray=t.randbetween=t.rand=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(7674),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6366);function h(e,t,r){const n=e.mathpack,a=(0,u.assertNumber)(n.add(r,n.one));return n.floor(p(e,t,a))}function p(e,t,r){const n=e.mathpack,a=n.sub(r,t),i=e.getRandom();if((0,l.isErrorOper)(a)){const e=n.div(t,n.fromNumber(3)),a=n.div(r,n.fromNumber(3));(0,m.assertTrue)("calc.funcs.getRandomFloatBetween",!(0,l.isErrorOper)(e)&&!(0,l.isErrorOper)(a));const o=n.sub(a,e);return(0,m.assertTrue)("calc.funcs.getRandomFloatBetween",!(0,l.isErrorOper)(o)&&n.cond(o)>=0),(0,u.assertNumber)(n.mul(n.fromNumber(3),(0,u.assertNumber)(n.add(e,(0,u.assertNumber)(n.mul(i,o))))))}return(0,u.assertNumber)(n.add(t,(0,u.assertNumber)(n.mul(i,a))))}t.rand=function(e,t){return e.getRandom()},t.randbetween=function(e,[t,r]){const n=(0,u.chkNumOper)(e,t),a=(0,u.chkNumOper)(e,r);if((0,l.isErrorOper)(n))return n;if((0,l.isErrorOper)(a))return a;const i=e.mathpack;if(i.cond2(n,a)>0)return o.numErrorOper;const s=e.getRandom(),c=i.ceil(n),d=i.floor(a),g=i.sub(d,c);return(0,l.isErrorOper)(g)?g:i.add(i.floor((0,u.assertNumber)(i.mul((0,u.assertNumber)(i.add(g,i.one)),s))),c)},t.randarray=function(e,t){const[r=i.missingOper,o=i.missingOper,l=i.missingOper,d=i.missingOper,m=i.missingOper]=t,f=e.mathpack,S=(0,c.isMissingOper)(r)?1:f.sfix(r),v=(0,c.isMissingOper)(o)?1:f.sfix(o);if(S<0||S>g.sheetRows||v<0||v>g.sheetRows)return s.valueErrorOper;if((0,u.validateArraySize)(S,v),0===S||0===v)return a.calcErrorOper;const F=(0,c.isMissingOper)(l)?f.zero:l,y=(0,c.isMissingOper)(d)?f.one:d;if(f.cond2(F,y)>0)return s.valueErrorOper;const b=!(0,c.isMissingOper)(m)&&m.value;if(b&&(!(0,u.numInt)(f,F)||!(0,u.numInt)(f,y)))return s.valueErrorOper;const C=[];for(let t=0;t<S;t++){const t=[];for(let r=0;r<v;r++){const r=b?h(e,F,y):p(e,F,y);t.push(r)}C.push(t)}return(0,n.arrayOper)(S,v,C)},t.now=function(e,t){return e.getTime(d.TimeGranularity.Instant)},t.today=function(e,t){return e.getTime(d.TimeGranularity.Day)}},4180:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hyperlink=void 0,t.hyperlink=function(e,[t,r]){return e.followHyperlinks?t:r??t}},2443:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WildExp=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366);var s;!function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"}(s||(s={}));const{codePointTilde:u,codePointQuestionMark:l,codePointAsterisk:c}=n.codePoint;t.WildExp=class{pushBlock(e){if(""===e)return;const t=this.blocks.length;this.blocks.push(e),this.bytecode.push(t);for(let t=1;t<e.length;t+=1)this.bytecode.push(s.OP_DOT)}pushMeta(e){e===l?this.bytecode.push(s.OP_DOT):this.bytecode.push(s.OP_DOTSTAR)}test(e){if(void 0!==this.simplePattern)return this.testSimple(e,this.simplePattern);let t=Object.create(null);this.addState(t,0);for(let r=0;r<e.length;r+=1){const n=Object.keys(t);if(t=Object.create(null),0===n.length)return!1;for(let a=0;a<n.length;a+=1){const i=Number(n[a]);if(i===this.bytecode.length)continue;const o=this.bytecode[i];switch(o){case s.OP_DOT:this.addState(t,i+1);break;case s.OP_DOTSTAR:this.addState(t,i);break;default:const n=this.blocks[o];r+n.length<=e.length&&0===this.localeInfo.stringCompareCI(n,e.substring(r,r+n.length))&&this.addState(t,i+1)}}}return this.bytecode.length in t}addState(e,t){e[t]=!0;const r=this.bytecode;for(let n=t;n<r.length&&r[n]===s.OP_DOTSTAR;n+=1)e[n+1]=!0}testSimple(e,t){return t.length<=e.length&&(t.length===e.length||this.appendWildcard)&&0===this.localeInfo.stringCompareCI(t,e.substring(0,t.length))}constructor(e,t,r=!1){this.localeInfo=e,this.source=t,this.appendWildcard=r,this.bytecode=[],this.blocks=[];let n="";for(let e=0;e<t.length;e+=1){const r=t.charCodeAt(e);if(r===u&&e+1<t.length){const r=(0,i.stringCodePointAt)(t,e+1);n+=(0,o.stringFromCodePoint)(r),e+=(0,a.numCodeUnits)(r)}else r!==u&&(r!==l&&r!==c?n+=t.charAt(e):(this.pushBlock(n),n="",this.pushMeta(r)))}0===this.bytecode.length&&(this.simplePattern=n),this.pushBlock(n),r&&this.pushMeta(c)}}},8073:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextFuncs=t.getWorksheetFunc=t.LambdaOper=t.RecordOper=t.isMachineCall=t.machineCall=t.MachineCallKind=t.readOperType=t.singleReadOperType=t.createEvaluator=t.createCompiler=t.PackageName=void 0;const n=r(3345);t.PackageName="excel-online-calc-runtime";var a=r(1146);Object.defineProperty(t,"createCompiler",{enumerable:!0,get:function(){return a.createCompiler}});var i=r(4596);Object.defineProperty(t,"createEvaluator",{enumerable:!0,get:function(){return i.createEvaluator}}),n.__exportStar(r(5146),t);var o=r(9835);Object.defineProperty(t,"singleReadOperType",{enumerable:!0,get:function(){return o.singleReadOperType}}),Object.defineProperty(t,"readOperType",{enumerable:!0,get:function(){return o.readOperType}}),Object.defineProperty(t,"MachineCallKind",{enumerable:!0,get:function(){return o.MachineCallKind}}),Object.defineProperty(t,"machineCall",{enumerable:!0,get:function(){return o.machineCall}}),Object.defineProperty(t,"isMachineCall",{enumerable:!0,get:function(){return o.isMachineCall}}),n.__exportStar(r(7496),t);var s=r(1819);Object.defineProperty(t,"RecordOper",{enumerable:!0,get:function(){return s.RecordOper}}),Object.defineProperty(t,"LambdaOper",{enumerable:!0,get:function(){return s.LambdaOper}});var u=r(2619);Object.defineProperty(t,"getWorksheetFunc",{enumerable:!0,get:function(){return u.getWorksheetFunc}});var l=r(9865);Object.defineProperty(t,"nextFuncs",{enumerable:!0,get:function(){return l.nextFuncs}})},5773:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coerceOper=void 0;const n=r(6880),a=r(3109),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(3228),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6366),F=r(6880),y=r(6366);function b(e,t){return 0!=(t&i.OperKind.Number)?e.zero:0!=(t&i.OperKind.String)?F.emptyStringOper:0!=(t&i.OperKind.Boolean)?c.falseOper:o.valueErrorOper}function C(e,t,r){const{localeInfo:n,mathpack:S}=e.globals.config;if(0!=(r&t.kind))return t;if((0,h.isNumberOper)(t)){if(0!=(r&i.OperKind.String)){const e=20;return(0,l.stringOper)(S.formatGeneral(n,t,e))}return 0!=(r&i.OperKind.Boolean)?(0,d.booleanOper)(0!==S.cond(t)):0!=(r&i.OperKind.Array)?(0,s.arrayOper)(1,1,[[t]]):o.valueErrorOper}if((0,p.isStringOper)(t)){if(0!=(r&i.OperKind.Number)){if(0===t.value.length)return o.valueErrorOper;if(t.value.length>255)return o.valueErrorOper;const r=e.numberFormatter.parseGeneral(t.value,!1,!0,m.GetTimeKind.NonVolatile);return(0,v.isSuccess)(r)||(0,a.throwEvaluationError)(r.reason),void 0!==r.value?r.value.value:o.valueErrorOper}if(0!=(r&i.OperKind.Boolean)){if(0===n.stringCompareCI(t.value,n.trueName))return g.trueOper;if(0===n.stringCompareCI(t.value,n.falseName))return c.falseOper}return 0!=(r&i.OperKind.Array)?(0,s.arrayOper)(1,1,[[t]]):o.valueErrorOper}if((0,f.isBooleanOper)(t))return 0!=(r&i.OperKind.Number)?t.value?S.one:S.zero:0!=(r&i.OperKind.String)?(0,l.stringOper)(t.value?n.trueName:n.falseName):0!=(r&i.OperKind.Array)?(0,s.arrayOper)(1,1,[[t]]):o.valueErrorOper;switch(t.kind){case i.OperKind.Error:return t;case i.OperKind.Missing:return 0!=(r&i.OperKind.Blank)?u.blankOper:b(S,r);case i.OperKind.Blank:return b(S,r);case i.OperKind.Rich:return 0!=(r&i.OperKind.Array)?(0,s.arrayOper)(1,1,[[t]]):C(e,t.getFallback(),r);case i.OperKind.Range:case i.OperKind.Array:return o.valueErrorOper;default:return(0,y.assertNever)("calc.runtime.coerceOper",t)}}t.coerceOper=function(e,t,r){const a=C(e,t,r);return(0,S.isErrorOper)(a)&&!(0,S.isErrorOper)(t)&&(0,n.traceErrorOper)("calc.runtime.coerceOper",a.type,`kind = ${t.kind}`),a}},1146:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCompiler=t.compiledFormulaTerm=t.compiledFormula=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(3798),s=r(7496),u=r(6880),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(6067),E=r(6067),T=r(6067),R=r(6067),k=r(6067),N=r(6067),I=r(6067),O=r(6067),P=r(6366),M=r(6067),D=r(6067),w=r(6067),L=r(6366),_=r(6366),x=r(6366),K=r(6067),W=r(6067),U=r(6366),G=r(6366),B=r(6366),V=r(6067),j=r(6366),H=r(6067),q=r(6067),z=r(6067),Q=(0,v.createFailureErrorClass)("CompileError"),$=(0,u.makeStrict)((0,R.getWorksheetFuncType)(k.WorksheetFuncId.IF)),Y=(0,u.makeStrict)((0,R.getWorksheetFuncType)(k.WorksheetFuncId.CHOOSE));function J(e){return(0,o.isOperTerm)(e)&&(0,y.isWriteOper)(e)}class X{literalNode(e,t,r){return B.Pledge.resolve(this.noopTerm(e,r))}arrayNode(e,t,r){return B.Pledge.all(e.map((e=>B.Pledge.all(e.map(this.lazyVisitFormulaNode))))).bind((e=>this.toArrayTerm(e,r)))}toArrayTerm(e,t){const r=e.length,n=void 0===e[0]?0:e[0].length,a=e.map((e=>e.map((e=>e.kind===o.TermKind.Noop?e.children:e))));return a.every((e=>e.every(J)))?this.noopTerm((0,M.arrayOper)(r,n,a),t):(0,o.arrayTerm)(r,n,e,t)}appNode(e,t,r,n){const s=this.context.annotations[n]?.kind===h.AnnotationKind.FormulaRoot;if((0,S.isOperatorNode)(e)){const r=(0,N.getOperatorType)(e.id);return B.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((t=>(0,o.appTerm)((0,o.operatorIdToName)(e.id),r,s,void 0,t,n)))}const u=(0,F.getArguments)(t);if((0,b.isWSFNode)(e)){const{id:t}=e;switch(t){case k.WorksheetFuncId.IFERROR:case k.WorksheetFuncId.IFNA:{(0,a.assertTrue)("calc.runtime.toIfPredicateTerm: expected wff",2===u.length);const[e,r]=u,i=new X({...this.context,numNames:this.context.numNames+1});return B.Pledge.all([this.lazyVisitFormulaNode(e),B.Pledge.try((()=>(0,W.visitFormulaNode)(i,r)))]).bind((([e,r])=>this.toIfPredicateTerm(t===k.WorksheetFuncId.IFERROR?k.WorksheetFuncId.ISERROR:k.WorksheetFuncId.ISNA,e,r,n)))}case k.WorksheetFuncId._UDF:return(0,i.assertFalse)("calc.runtime.appNode: expected wff (not UDF)")}return B.Pledge.all(u.map(this.lazyVisitFormulaNode)).bind((e=>{switch(t){case k.WorksheetFuncId.IF:return this.toIfTerm(e,n);case k.WorksheetFuncId.CHOOSE:return this.toChooseTerm(e,n)}const r=(0,R.getWorksheetFuncType)(t);return(0,o.appTerm)((0,o.worksheetFunctionIdToName)(t),r,!1,void 0,e,n)}))}return this.lazyVisitFormulaNode(e).bind((e=>B.Pledge.all(u.map(this.lazyVisitFormulaNode)).bind((t=>this.toAppTerm(e,t,n)))))}toIfPredicateTerm(e,t,r,n){const a=(0,o.readStackTerm)(0,void 0),i=(0,o.conditionalTerm)((0,o.worksheetFunctionIdToName)(k.WorksheetFuncId.IF),$,!1,(0,o.appTerm)((0,o.worksheetFunctionIdToName)(e),(0,R.getWorksheetFuncType)(e),!1,void 0,[a],void 0),[r,a],void 0);return(0,o.letTerm)([t],!1,[void 0],i,n)}toIfTerm(e,t){switch(e.length){case 3:return(0,o.conditionalTerm)((0,o.worksheetFunctionIdToName)(k.WorksheetFuncId.IF),$,!1,e[0],[e[1],e[2]],t);case 2:return(0,o.conditionalTerm)((0,o.worksheetFunctionIdToName)(k.WorksheetFuncId.IF),$,!1,e[0],[e[1],w.falseOper],t);case 1:throw new Q((0,C.notImplemented)(["single-argument IF"]));default:return(0,i.assertFalse)("calc.runtime.toIfTerm: expected wff")}}toChooseTerm(e,t){return(0,a.assertTrue)("calc.runtime.toChooseTerm: expected wff",e.length>=1),(0,o.conditionalTerm)((0,o.worksheetFunctionIdToName)(k.WorksheetFuncId.CHOOSE),Y,!1,e[0],e.slice(1),t)}toAppTerm(e,t,r){return(0,o.appTerm)((0,o.worksheetFunctionIdToName)(k.WorksheetFuncId._UDF),(0,O.higherOrderFunctionType)(),!1,void 0,[e,...t],r)}letNode(e,t,r,n,u,l){const c=e.id===k.WorksheetFuncId.LETREC||e.id!==k.WorksheetFuncId.LET&&(0,i.assertFalse)("calc.runtime.compile");(0,a.assertTrue)("calc.runtime.letNode: expected wff",void 0!==r);const d=this.bindNames(t),g=d[t.length],m=t.map((({name:e})=>e.arg.label));let h;return h=c?B.Pledge.all(t.map((({binder:e})=>B.Pledge.try((()=>(0,W.visitFormulaNode)(g,e.arg)))))):B.Pledge.all(t.map((({binder:e},t)=>{const r=d[t];return B.Pledge.try((()=>(0,W.visitFormulaNode)(r,e.arg)))}))),h.bind((e=>(0,W.visitFormulaNode)(g,r.arg).bind((r=>(0,o.letTerm)(e.map(((e,r)=>this.noopTerm(e,(0,s.runtimePositionLetVal)(t[r].name.arg.label,t[r].binder.arg.label)))),c,m,r,l)))))}lambdaNode(e,t,r,n,i,s){(0,a.assertTrue)("calc.runtime.lambdaNode: expected wff",void 0!==r);const u=this.bindNames(t),l=u[t.length],c=t.reduce(((e,{name:t},r)=>(0,U.fastMax)(e,t.arg.isOptional?0:r+1)),0),d=t.length;return B.Pledge.all(t.map((({name:e},t)=>{if(void 0===e.arg.def)return B.Pledge.resolve(void 0);const r=u[t],n=e.arg.def.rhs;return B.Pledge.try((()=>(0,W.visitFormulaNode)(r,n)))}))).bind((e=>(0,W.visitFormulaNode)(l,r.arg).bind((r=>{const n=[...e.map(((e,t)=>[e,t])).filter((e=>void 0!==e[0])).map((([e])=>e)),r];return(0,o.lambdaTerm)((e=>e>=c&&e<=d),t.map((({name:e})=>({paramNodeLabel:e.arg.label,paramNameLabel:e.arg.name.name.label,hasDef:void 0!==e.arg.def,isRest:!1}))),n,s)}))))}bindNames(e){const t=this.context.numNames,r=[this];return e.reduce(((e,{name:n},i)=>{(0,a.assertTrue)("calc.runtime.bindNames: expected wff",void 0!==n.arg.wholeName);const o=e.setValue((0,A.getBoundName)(this.context.localeInfo,n.arg.wholeName),t+i);return r.push(new X({...this.context,names:o,numNames:t+i+1})),o}),this.context.names),r}parenNode(e,t,r){return this.lazyVisitFormulaNode(e).bind((e=>this.noopTerm(e,r)))}nameNode(e,t,r){const n=this.context.annotations[r]?.kind===h.AnnotationKind.AppHeadName;return B.Pledge.resolve(this.toNameTerm(e,t,n))}toNameTerm(e,t,r){const{locals:n,names:i,numNames:u}=this.context,d=(0,p.flattenNameParts)(e).parts;if((0,q.canDenoteLocalName)(t,d)){const[e,...t]=d,r=i.getEntry((0,A.getBoundName)(this.context.localeInfo,e.asWhole));if(void 0!==r){const n=r.value,a=(0,o.readStackTerm)(u-n-1,e.qualifiedLabel);return B.Pledge.resolve(t.reduce(((e,t)=>this.toFieldRefTerm(e,t.rhs.field.whole,t.qualifiedLabel)),a))}}let g;if(null==t&&(0,j.getTypedFeatureGate)("Microsoft.Office.Excel.CalcEtaLambda")&&(0,j.getTypedFeatureGate)("Microsoft.Office.Excel.EtaReducedLambdas")){const t=(0,T.getEtaFuncId)(this.context.localeInfo,e.asWhole);if(void 0!==t){const r={...(0,R.getWorksheetFuncType)(t)};r.maxArgs=(0,G.fastMin)(254,r.maxArgs),g=(0,o.lambdaTerm)((e=>(0,E.isValidArgsLength)(r,e)),[{paramNodeLabel:void 0,paramNameLabel:void 0,hasDef:!1,isRest:!0}],[(0,o.appTerm)((0,o.worksheetFunctionIdToName)(t),r,!1,[{isSpread:!0}],[(0,o.readStackTerm)(0,void 0)],(0,s.runtimePositionEtaLambdaBody)(t))],e.qualifiedLabel)}}if((0,H.canDenoteCellRef)(n,t,d)){const[e,...r]=d,n=null!=t&&t.kind===l.QualifierKind.Ident?(0,c.sheetQualifier)(t.name,void 0,t.isQuoted,t.label):t,a=(0,o.cellRefTerm)(e.ref,n,e.qualifiedLabel);g=r.reduce(((e,t)=>this.toFieldRefTerm(e,t.rhs.field.whole,t.qualifiedLabel)),a)}return(0,z.canDenoteUserDefinedFunc)(r,t,e)&&(g=(0,o.udfTerm)(e.asWhole,t,g,e.qualifiedLabel)),e.canDenoteNamedObject&&(g=(0,o.nameTerm)(e.asWhole,t,r?V.NameSource.AppHead:V.NameSource.Plain,g,e.qualifiedLabel)),(0,a.assertTrue)("calc.runtime.compile: expected wff NameNode",void 0!==g),B.Pledge.resolve(g)}cellRefNode(e,t,r){return B.Pledge.resolve((0,o.cellRefTerm)(e,t,r))}fieldRefNode(e,t,r){(0,a.assertTrue)("calc.runtime.compile: expected wff FieldRef",t.field.kind===f.NodeKind.Ident);const n=t.field.whole;return this.lazyVisitFormulaNode(e).bind((e=>this.toFieldRefTerm(e,n,r)))}toFieldRefTerm(e,t,r){const n=k.WorksheetFuncId.FIELDVALUE;return(0,o.appTerm)((0,o.worksheetFunctionIdToName)(n),(0,R.getWorksheetFuncType)(n),!1,void 0,[e,(0,D.stringOper)(t)],r)}noopTerm(e,t){return this.context.locals.emitStepInfo?(0,o.noopTerm)(e,t):e}structRefNode(e,t,r){return B.Pledge.resolve((0,o.structRefTerm)((0,m.structRefNode)(e,t,r),r))}missingNode(e,t){return(0,i.assertFalse)("calc.runtime.compile: unexpected missing node")}badSequenceNode(e,t,r){return(0,i.assertFalse)("calc.runtime.compile: unexpected bad node")}badCharsNode(e,t,r){return(0,i.assertFalse)("calc.runtime.compile: unexpected bad node")}operatorNode(e,t){return B.Pledge.resolve((0,d.operatorNode)(e,t))}wsfNode(e,t,r){return B.Pledge.resolve((0,g.wsfNode)(e,t,r))}constructor(e){this.context=e,this.visitFormulaNode=e=>(0,W.visitFormulaNode)(this,e),this.lazyVisitFormulaNode=e=>B.Pledge.resolve(e).bind(this.visitFormulaNode)}}const Z={[I.OperatorId.At]:k.WorksheetFuncId.SINGLE,[I.OperatorId.Pound]:k.WorksheetFuncId.ANCHORARRAY},ee=[function(e){if(!(0,o.isOperTerm)(e)&&e.kind===o.TermKind.App&&(0,o.isOperatorName)(e.data.funName)){const t=Z[(0,o.operatorNameToId)(e.data.funName)];if(void 0!==t)return(0,o.appTerm)((0,o.worksheetFunctionIdToName)(t),(0,R.getWorksheetFuncType)(t),e.data.isFormulaRoot,e.data.args,e.children,e.position)}return e}],te=(e,t)=>t(e),re=e=>ee.reduce(te,e);function ne(e,t){return{...e,term:t}}t.compiledFormula=ne,t.compiledFormulaTerm=function(e,t){return"object"!=typeof t.term?(0,i.assertFalse)(`${e}: expected known compiled formula type; given ${(0,n.anonymize)(t)}`):t.term},t.createCompiler=function(e){return{compileFormula:(t,r)=>function(e,t,r){try{const a=t.config?.localeInfo??e.config.localeInfo,{names:i,numNames:s}=function(e,t){const r=t.annotations[t.node.label],n=P.RedBlackMapTree.create(e.stringCompareCI);if(r?.kind===h.AnnotationKind.FormulaRoot){const{contextNames:t=[]}=r;return{names:t.reduce(((t,r,n)=>t.setValue((0,A.getBoundName)(e,r.whole),n)),n),numNames:t.length}}return{names:n,numNames:0}}(a,r),u={globals:e,locals:t,localeInfo:a,annotations:r.annotations,names:i,numNames:s},l=(n=(0,K.reducePledge)(new X(u),r),(0,o.transformBottomUp)(n,re));return(0,L.success)(ne(r,l))}catch(e){return e instanceof Q?(0,_.failure)(e.reason):(0,_.failure)((0,x.javaScriptError)(e))}var n}(e,t,r)}}},2986:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dereferenceOpers=t.dereferenceOper=t.dereference=t.getCellValuesAsArray=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6366),u=r(6366),l=r(6366),c=r(7496),d=r(3109),g=r(9835),m=r(6880),h=r(4068),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6366),b=r(6067),C=r(6067),A=r(6067),E=r(6067),T=r(6067),R=r(6067),k=r(6067),N=r(6067),I=r(6067),O=r(6067),P=r(6067),M=r(4488),D=r(6067),w=r(6366),L=r(6366),_=16;function x(e,t){const r=t.map.getValue(e);if(void 0!==r){const e=(0,M.recordCellCycle)(r,t.current);return(0,d.throwEvaluationError)(e)}}function K(e,t,r){e.precedents.cells.push(t);const n=e.globals.getCellValue(t);if(n.kind===w.ResultKind.Failure)return(0,d.throwEvaluationError)(n.reason);const a=n.value;if(a.kind===c.CellKind.FinalValue)return a.oper;x(a.anchor,e.visitedCells),r.push(a.anchor)}function W(e,t,r,n){let i;if(e.precedents.cells.push(t),!n||(0,k.gridRangeSize)(t.range)<=_)i=t;else{const r=e.globals.getUsedRange(t.sheet);let n;(0,L.isSuccess)(r)?n=null==r.value?void 0:r.value.range:(0,d.throwEvaluationError)(r.reason);const a=void 0===n?void 0:(0,R.gridRangeIsect)(t.range,(0,I.gridRange)(0,0,n.row+n.rows,n.col+n.cols));if(void 0===a)return new u.StrictSparseArray2D(t.range.rows,t.range.cols,0,0,[],p.blankOper);i=(0,O.sheetGridRange)(t.sheet,a)}const o=e.globals.getCellValues(i);if(o.kind===w.ResultKind.Failure)return(0,d.throwEvaluationError)(o.reason);const s=r.length,l=function(e,t,r,n,i){const o=[],s=n.length;let l=0;(0,a.assertTrue)("calc.runtime.deference: readIntoArray2D number of rows",s===r.rows);for(let u=0;u<s;u+=1){o.push([]);const s=n[u].length;(0,a.assertTrue)("calc.runtime.deference: readIntoArray2D number of cols",s===r.cols),l=0===u?s:(0,y.fastMin)(s,l);for(let r=0;r<s;r+=1){const s=n[u][r];c.CellKind.FinalValue===s.kind?o[u][r]=s.oper:(x(s.anchor,e.visitedCells),(0,a.assertTrue)("calc.runtime.deference: readIntoArray2D correct sheet",(0,b.isSheetIndexEqual)(s.anchor.sheet,t.sheet)),i.push(s.anchor),o[u][r]=f.refErrorOper)}}return new u.StrictSparseArray2D(t.range.rows,t.range.cols,s,l,o,p.blankOper)}(e,t,i.range,o.value,r);return s===r.length?l:void 0}function U(e,t,r){const n=W(e,t,r,!1);if(null!=n)return(0,S.arrayOper)(n.rows,n.cols,n.rows===n.denseRows&&n.cols===n.denseCols?n.denseElements:(0,s.array2DToJaggedArray)(n))}function G(e,t,r,n){if(0!=(r&D.OperKind.Range))return t;if(!(0,T.isRangeOper)(t))return t;const a=t.sheets;if(!(0,C.isSheetIndex)(a))return(0,m.traceErrorOper)("calc.runtime.dereference",v.ErrorType.REF,`3D range, oper = ${(0,l.anonymize)(t)}`),f.refErrorOper;if(1!==t.ranges.length)return(0,m.traceErrorOper)("calc.runtime.dereference",v.ErrorType.VALUE,`union range, oper = ${(0,l.anonymize)(t)}`),F.valueErrorOper;const s=t.ranges[0];if(0!=(r&g.singleReadOperType)){if((0,A.isGridCell)(s))return K(e,(0,P.sheetGridCell)(a,s),n);if(e.locals.implicitIntersect&&(0,i.isFeatureEnabled)(o.FeatureName.CalcLegacyImplicitIntersection)&&!(0,i.isFeatureEnabled)(o.FeatureName.CalcPreventSpillingHack)){const r=e.locals.originGridCell;if(!(0,L.isSuccess)(r))return(0,d.throwEvaluationError)(r.reason);const i=(0,N.gridCellImplicitIsect)(r.value,s);return null==i?((0,m.traceErrorOper)("calc.runtime.dereference",v.ErrorType.VALUE,`empty intersection, oper = ${(0,l.anonymize)(t)}`),F.valueErrorOper):K(e,(0,P.sheetGridCell)(a,i),n)}return U(e,(0,O.sheetGridRange)(a,s),n)}return 0!=(r&D.OperKind.Array)?U(e,(0,O.sheetGridRange)(a,s),n):((0,m.traceErrorOper)("calc.runtime.dereference",v.ErrorType.VALUE,`bad target type ${r}`),F.valueErrorOper)}t.getCellValuesAsArray=W,t.dereference=G,t.dereferenceOper=function(e,t,r){const a=[],i=G(e,t,r,a);if(null==i){if(a.length>0)return(0,d.throwEvaluationError)((0,d.unevaluated)(a));const e=`calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = ${(0,l.anonymize)(t)}`;return n.ulsLogger.ULS.assertTag(595980819,h.LogCategory.msoulscat_ES_EWAJS,!1,e)}return i},t.dereferenceOpers=function(e,t,r){const n=[];for(let a=0;a<t.length;a+=1){const i=G(e,t[a],(0,E.getArgType)(r,a,t.length),n);null!=i&&(t[a]=i)}if(n.length>0)return(0,d.throwEvaluationError)((0,d.unevaluated)(n))}},3070:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCellEvaluationMachine=void 0;const n=r(6366),a=r(7496),i=r(3109),o=r(3109),s=r(9835),u=r(6366),l=r(4488),c=r(4488),d=r(6067),g=r(6366),m=r(6067),h=r(6366),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6880),C=r(1819),A=r(6366),E=r(6366);class T{evalCell(){const e=this.context.globals.getCellValue(this.cell);if(e.kind===u.ResultKind.Failure)return{kind:i.CellEvaluationResultKind.ReadFailure,failure:e};const t=e.value;if(t.kind===a.CellKind.FinalValue)return{kind:i.CellEvaluationResultKind.ReadOper};const r=this.context.globals.getCellFormula(t.anchor);if(r.kind===u.ResultKind.Failure){const e="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return(0,n.assertFalse)(e)}const d=r.value;if(null==d){const e=`calc.runtime.CellEvaluationMachine.next: client error: expected getCellFormula(${(0,h.anonymize)(t.anchor)}) != null`;return(0,n.assertFalse)(e)}const m=this.visitAnchor(d),p=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,o.evalLocalsGrid)(m.source),m.precedents,(0,c.appendVisitedCell)(this.visitedCells,m),l.emptyVisitedNames,s.readOperType,d.formula);return g.Pledge.fromMachine(p).bind(this.receiveSuccess(m)).catch(this.receiveFailure(m))}visitAnchor(e){const t=(0,y.sheetGridRangeAnchor)(e.source.range),r=this.visitedCells.map.getValue(t);if(null!=r){const e=`calc.runtime.CellEvaluationMachine.visitAnchor: unexpected visitValue at ${(0,h.anonymize)(t)}; given ${(0,h.anonymize)(r)}`;return(0,n.assertFalse)(e)}return{cell:t,cycle:void 0,previous:this.visitedCells.current,source:e.source,precedents:(0,o.bottomEvalPrecedents)()}}receiveSuccess(e){return t=>{if((0,v.isRangeOper)(t)||(0,S.isMissingOper)(t)){const e=`calc.runtime.CellEvaluationMachine.receiveSuccess: expected ReadOper; given ${(0,h.anonymize)(t)}`;return(0,n.assertFalse)(e)}return this.writeSuccess(e.source,t,e.precedents)}}receiveFailure(e){return t=>{const r=t.kind===a.ReasonKind.PreviousFailure&&void 0!==e.cycle?e.cycle:t;return this.writeFailure(e.source,r,e.precedents)}}writeSuccess(e,t,r){return this.setCellValue(e,t,r),{kind:i.CellEvaluationResultKind.WroteOper,source:e}}writeFailure(e,t,r){return this.context.globals.setCellFailure(e.range,t,r),{kind:i.CellEvaluationResultKind.WroteFailure,source:e}}setCellValue(e,t,r){const n=this.context.globals.config.mathpack.zero,a=(0,f.isBlankOper)(t)?n:t;if(e.kind===d.LexicalKind.Cell){if((0,p.isArrayOper)(a)){const t=void 0===a.opers[0]?m.naErrorOper:a.opers[0][0],i=(0,f.isBlankOper)(t)?n:t;if(!this.isLambdaEnabled(e,i,r))return;return this.context.globals.setCellValue(e.range,i,r)}if(!this.isLambdaEnabled(e,a,r))return;return this.context.globals.setCellValue(e.range,a,r)}const i=e.range.range,o=(0,b.broadcastWriteOper)(i.rows,i.cols,a).opers,s=e=>(0,f.isBlankOper)(e)?n:e,u=o.map((e=>e.map(s)));if(this.isLambdaEnabled(e,u,r))return this.context.globals.setCellValues(e.range,u,r)}isLambdaEnabled(e,t,r){return!((Array.isArray(t)?t.some((e=>e.some((e=>e instanceof C.LambdaOper)))):t instanceof C.LambdaOper)&&!(0,E.isFeatureEnabled)(A.FeatureName.CalcLambdaCellValues)&&(this.context.globals.setCellFailure(e.range,(0,F.notImplemented)(["LAMBDA cell values"]),r),1))}constructor(e,t,r,n){this.context=e,this.stepConfig=t,this.visitedCells=r,this.cell=n}}t.createCellEvaluationMachine=function(e,t,r,n){return g.Pledge.try((()=>new T(e,t,r,n).evalCell()))}},9662:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCallTermEvaluationMachine=t.createFormulaEvaluationMachine=void 0;const n=r(6366),a=r(6366),i=r(7496),o=r(3109),s=r(3109),u=r(3109),l=r(3109),c=r(3109),d=r(3109),g=r(6366),m=r(6366),h=r(6366),p=r(6366),f=r(6366),S=r(6366),v=r(4488),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(6067),E=r(6067),T=r(6067),R=r(6067),k=r(6067),N=r(6067),I=r(6366),O=r(6067),P=r(6067),M=r(6067),D=r(6067),w=r(6067),L=r(6067),_=r(6067),x=r(6880),K=r(1819),W=r(6366),U=r(6366),G=r(3798),B=r(3298),V=r(2986),j=r(6067),H=r(6067),q=r(5773),z=r(1146),Q=r(6880),$=r(6067),Y=r(6067),J=r(6067),X=r(6067),Z=r(6067),ee=r(6067),te=()=>(0,d.throwEvaluationError)((0,_.notImplemented)(["LETREC cycle"]));function re(e,t){return{context:e,holeIndex:0,locals:t}}class ne{get globals(){return this.context.globals}get numberFormatter(){return this.context.numberFormatter}next(){try{return this.doNext()}catch(e){if(e instanceof d.EvaluationError)return(0,d.handleEvaluationError)(this.context,this.visitedCells,e.reason);throw e}}receiveResult(e){return(0,p.isSuccess)(e)?this.updateTermTransition(e.value):e}doNext(){if((0,G.isOperTerm)(this.term)){const e=this.continuation;if(0===e.length){(0,a.assertTrue)("calc.runtime.FormulaEvaluationMachine.doNext: lambdaDepth correctly decremented",this.usage.lambdaDepth===this.initialLambdaDepth);const e=(0,V.dereferenceOper)(this,this.term,this.target),t=(0,q.coerceOper)(this,e,this.target);return this.precedents.bound=T.PrecsBound.Exact,!(0,U.isFeatureEnabled)(W.FeatureName.CalcPreventSpillingHack)||this.isNested||this.locals.lexicalSource.kind!==y.LexicalKind.Cell||!(0,O.isArrayOper)(t)||1===t.rows&&1===t.cols?(0,S.success)(t):(0,h.failure)((0,_.notImplemented)(["spilling"]))}const t=e[e.length-1];return this.applyContinuation(this.term,t)}return this.reduceFormula(this.term)}applyContinuation(e,t){const r=t.context;switch(r.kind){case G.TermKind.App:{const n=t.holeIndex,i=r.children.length;(0,a.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",n<=i);const o=t.locals;if(n===i)return(0,a.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",(0,D.isMissingOper)(e)),this.dispatchFunction(o,r.data,r.position);const s=r.data.args[n]?.isSpread;return!0===s?((0,a.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",e instanceof B.RestArgsOper),(0,g.safePush)(o,e.opers)):((0,a.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",!(e instanceof B.RestArgsOper)),o.push(e)),n+1<i?this.nextHoleTransition(t,r.children[n+1]):this.nextHoleTransition(t,b.missingOper)}case G.TermKind.Conditional:{const n=t.holeIndex;if(0===n){const i=(0,G.worksheetFunctionNameToId)(r.data.funName),o=i===ee.WorksheetFuncId.IF?j.OperKind.Boolean:j.OperKind.Number;let s=(0,V.dereferenceOper)(this,e,o);if((0,O.isArrayOper)(s))return t.locals=[s],this.nextHoleTransition(t,r.children[n+1]);if((0,L.isRichOper)(s))return(0,h.failure)((0,_.notImplemented)(["IF/CHOOSE with a rich value condition"]));if(s=(0,q.coerceOper)(this,s,o),i===ee.WorksheetFuncId.IF&&(0,P.isBooleanOper)(s))return this.popContextTransition(r.children[s.value?1:2]);if(i===ee.WorksheetFuncId.CHOOSE&&(0,w.isNumberOper)(s)){const e=this.context.globals.config.mathpack.fix(s);if(e<1||e>r.children.length-1){const t=`CHOOSE; out of bounds option = ${(0,I.anonymize)(e)}`;return(0,Q.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.applyContinuation",A.ErrorType.VALUE,t),this.popContextTransition(N.valueErrorOper)}return this.popContextTransition(r.children[e])}return(0,a.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",(0,M.isErrorOper)(s)),this.popContextTransition(s)}const i=t.locals;return i[n]=e,n+1<r.children.length?this.nextHoleTransition(t,r.children[n+1]):this.dispatchFunction(i,r.data,r.position)}case G.TermKind.CallName:{const r=t.locals;return this.locals=r.locals,this.caller=r.caller,this.restoreStack(r),this.visitedNames=r.visitedNames,this.popContextTransition(e)}case G.TermKind.Let:{const n=t.holeIndex,a=r.children.length-1;if(n>=a){const r=t.locals;return this.restoreStack(r),this.popContextTransition(e)}if(r.data.rec){const t=this.stackEnv.getCount()-a+n;this.stackEnv.getValue(t).value=e,this.stackEnv=this.stackEnv.setValue(t,e)}else this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),e),this.stackMapNumPushed+=1;return n+1>=a&&this.isLetTcoPossible()?this.popContextTransition(r.children[n+1]):this.nextHoleTransition(t,r.children[n+1])}case G.TermKind.Array:{const n=(0,V.dereferenceOper)(this,e,x.writeOperType),{rows:a,cols:i}=r.data,o=t.holeIndex,s=o%i,u=i===s+1,l=(o-s)/i,c=t.locals;if(c[l][s]=(0,q.coerceOper)(this,n,x.writeOperType),a===l+1&&u)return this.popContextTransition((0,C.arrayOper)(a,i,c));const d=u?l+1:l,g=u?0:s+1;return this.nextHoleTransition(t,r.children[d][g])}case G.TermKind.CallLambda:{const r=t.locals;return this.locals=r.locals,this.caller=r.caller,this.restoreStack(r),this.usage.lambdaDepth-=1,this.popContextTransition(e)}case G.TermKind.CallFirstOrderFunc:{const r=t.locals;return this.locals=r.locals,this.caller=r.caller,this.restoreStack(r),this.popContextTransition(e)}case G.TermKind.PostStep:{const r=t.locals;return this.stepConfig?.postStep(r,e),this.popContextTransition(e)}default:return(0,n.assertNever)("calc.runtime.FormulaEvaluationMachine.applyContinuation",r)}}reduceFormula(e){switch(e.kind){case G.TermKind.CellRef:return this.updateTermTransition(this.evalCellRefTerm(e));case G.TermKind.StructRef:return this.updateTermTransition(this.evalStructRefTerm(e));case G.TermKind.App:{const t=e.data.funName;if(!(0,G.isOperatorName)(t)){const e=(0,G.worksheetFunctionNameToId)(t);if(e!==ee.WorksheetFuncId._UDF){const t=this.globals.getWorksheetFunc(e);if(t.kind===f.ResultKind.Failure)return(0,d.throwEvaluationError)(t.reason)}}if(0===e.children.length){const r=new B.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(e.position),this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(t,e.data.funType,e.data.isFormulaRoot,[]);return this.updateTermTransition(r)}return this.pushContextTransition(e,e.children[0],[])}case G.TermKind.CallLambda:{const t=this.isCallLambdaTcoPossible();if(this.usage.lambdaCalls[0]+1>(this.globals.limits.maxLambdaCalls??1/0))return(0,d.throwEvaluationError)((0,i.limitExceeded)(i.LimitKind.LambdaCalls));if(!t&&this.usage.lambdaDepth+1>(this.globals.limits.maxLambdaDepth??1/0))return(0,d.throwEvaluationError)((0,i.limitExceeded)(i.LimitKind.LambdaDepth));t||(this.usage.lambdaDepth+=1),this.usage.lambdaCalls[0]+=1;const r=this.stackEnv;this.stackEnv=e.data.capturedStackEnv;const n=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=e.data.capturedStackMap;const a=this.locals;this.locals=(0,d.evalLocalsLambda)(e.data.capturedLocals,this.locals);const o=this.caller;return this.switchCaller(e.data.caller,t),t?this.updateTermTransition(e.children):this.pushContextTransition(e,e.children,{locals:a,caller:o,stackEnv:r,stackMap:n})}case G.TermKind.CallFirstOrderFunc:{const t=this.locals;this.locals=(0,o.evalLocalsFirstOrderFunc)(e.data.source,this.locals);const r=this.caller;this.switchCaller(e.data.caller,!1);const n=this.stackEnv;this.stackEnv=c.emptyStackEnv;const a=this.stackMapList();return this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.pushContextTransition(e,e.children,{locals:t,caller:r,stackEnv:n,stackMap:a})}case G.TermKind.CallMachine:return(0,m.callMachineTransition)(e.data.machine,this);case G.TermKind.Conditional:return this.pushContextTransition(e,e.children[0],void 0);case G.TermKind.Let:{const t=e.children.length-1;if(0===t)return this.updateTermTransition(e.children[0]);const r=this.stackEnv,n=this.stackMapList();if(this.stackMapLabels=e.data.varLabels,this.stackMapNumPushed=0,this.stackMapNext=n,e.data.rec){for(let e=0;e<t;e+=1)this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),new c.LazyOper(te));this.stackMapNumPushed+=t}return this.pushContextTransition(e,e.children[0],{stackEnv:r,stackMap:n})}case G.TermKind.Name:return this.updateTermTransition(this.evalNameTerm(e));case G.TermKind.CallName:{const t=e.data.loc,r=this.checkForNameCycle(t),n=this.stackFrameList(e.position),a=this.locals;this.locals=(0,d.evalLocalsName)((0,F.lexicalSourceName)(t),a);const i=this.caller;this.switchCaller(n,!1);const o=this.stackEnv;this.stackEnv=c.emptyStackEnv;const s=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0;const u=this.visitedNames;return this.visitedNames=r,this.pushContextTransition(e,e.children,{locals:a,caller:i,stackEnv:o,stackMap:s,visitedNames:u})}case G.TermKind.Udf:return this.updateTermTransition(this.evalUdfTerm(e));case G.TermKind.ReadStack:{const t=this.stackEnv.getValue(this.stackEnv.getCount()-1-e.data);return(0,a.assertTrue)("calc.runtime.FormulaEvaluationMachine.reduceFormula: ReadStack oper",void 0!==t),this.updateTermTransition(t instanceof c.LazyOper?t.value:t)}case G.TermKind.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((()=>[])));case G.TermKind.Lambda:return this.updateTermTransition(new K.LambdaOper(e.data.checkArity,e.position,e.data.params??[],this.locals,this.stackEnv,this.stackMapList(),e.children));case G.TermKind.Noop:return this.updateTermTransition(e.children);default:return(0,n.assertNever)("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}}dispatchFunction(e,t,r){const{funName:n,funType:a,isFormulaRoot:i}=t;(0,V.dereferenceOpers)(this,e,a);const o=new B.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(r),this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(n,a,i,e);return this.popContextTransition(o)}stackFrameList(e){return(0,u.stackFrameList)(this.locals.lexicalSource,e,this.stackEnv,this.stackMapList(),this.caller)}stackMapList(){return void 0!==this.stackMapLabels&&0!==this.stackMapNumPushed?(0,s.stackMapList)(this.stackMapLabels,this.stackMapNumPushed,this.stackMapNext):this.stackMapNext}noopTerm(e,t){return null!=this.stepConfig?(0,G.noopTerm)(e,t):e}pushContextTransition(e,t,r){const n=re(e,r);return this.continuation.push(n),this.updateTermTransition(t)}popContextTransition(e){return this.continuation.pop(),this.updateTermTransition(e)}nextHoleTransition(e,t){return e.holeIndex+=1,this.updateTermTransition(t)}updateTermTransition(e){if(this.term=e,null!=this.stepConfig&&!(0,G.isOperTerm)(e)&&void 0!==e.position&&e.kind!==G.TermKind.Name&&e.kind!==G.TermKind.Udf){const t=function(e,t,r,n,a){const i=(0,u.stackFrameList)(e,t,r,n,a);return{stack:new l.IterableStackFrame(i)}}(this.locals.lexicalSource,e.position,this.stackEnv,this.stackMapList(),this.caller);if(this.continuation.push(re(G.postStepTerm,t)),this.stepConfig.preStep(t)===i.StepAction.Break)return m.breakTransition}return m.nextTransition}switchCaller(e,t){(0,a.assertTrue)("calc.runtime.FormulaEvaluationMachine.switchCaller: correct nesting",e.caller===this.caller),t||(this.caller=e)}restoreStack({stackEnv:e,stackMap:t}){this.stackEnv=e,this.stackMapLabels=t?.labels,this.stackMapNumPushed=t?.numPushed??0,this.stackMapNext=t?.next}isLetTcoPossible(){const e=this.continuation[this.continuation.length-2];if(void 0===e)return!1;const t=e.context;return t.kind===G.TermKind.Let?e.holeIndex>=t.children.length-1:t.kind===G.TermKind.CallLambda||t.kind===G.TermKind.CallName}isCallLambdaTcoPossible(){const e=this.continuation[this.continuation.length-1];return void 0!==e&&e.context.kind===G.TermKind.CallLambda}getNameFormulaAsTerm(e,t){const r=this.globals.getNameFormula(e,t);if(r.kind===f.ResultKind.Failure)return(0,d.throwEvaluationError)(r.reason);const n=r.value;return null!=n?(0,z.compiledFormulaTerm)("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",n):void 0}checkForNameCycle(e){const t=this.visitedNames,r=t.map.getValue(e);if(void 0!==r){const e=(0,v.recordNameCycle)(r,t.current);return(0,d.throwEvaluationError)(e)}return this.visitedNames.map.getCount()+1>(this.globals.limits.maxNameChain??1/0)?(0,d.throwEvaluationError)((0,i.limitExceeded)(i.LimitKind.NameChain)):(0,v.appendVisitedName)(this.visitedNames,e)}evalNameTerm(e){const{resolution:t,precedents:r}=this.context.resolver.resolveName(this.locals,(0,Z.nameNode)((0,X.identNamePart)(e.data.name,!0),e.data.qualifier),e.data.source);if((0,g.safePush)(this.precedents.names,r),!(0,p.isSuccess)(t)){if(t.reason.kind===$.ResolveReasonKind.NoOriginSheet){const t=`error ref, no sheet, qualifier = ${(0,I.anonymize)(e.data.qualifier)}`;return(0,Q.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",A.ErrorType.REF,t),this.noopTerm(k.refErrorOper,e.position)}const r=e.children;return t.reason.kind===$.ResolveReasonKind.InvalidQualifier&&void 0!==r?r:(0,d.throwEvaluationError)(t.reason)}const n=t.value;let a;if(void 0===n||void 0===(a=this.getNameFormulaAsTerm(n,e.data.source))){const t=e.children;if(void 0===t){const t=`error ref, qualifier = ${(0,I.anonymize)(e.data.qualifier)}`;return(0,Q.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",A.ErrorType.NAME,t),this.noopTerm(E.nameErrorOper,e.position)}return t}return(0,G.callNameTerm)(n,this.noopTerm(a,i.runtimePositionFormulaRoot),e.position)}evalCellRefTerm(e){const{resolution:t}=this.context.resolver.resolveCellRef(this.locals,(0,J.cellRefNode)(e.data.ref,e.data.qualifier));if(!(0,p.isSuccess)(t)){if(t.reason.kind===$.ResolveReasonKind.NoOriginSheet){const t=`error ref, no sheet, qualifier = ${(0,I.anonymize)(e.data.qualifier)}`;return(0,Q.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",A.ErrorType.REF,t),k.refErrorOper}return(0,d.throwEvaluationError)(t.reason)}const r=t.value;if(!r){const t=`error ref, qualifier = ${(0,I.anonymize)(e.data.qualifier)}`;return(0,Q.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",A.ErrorType.REF,t),k.refErrorOper}return(0,R.range3DOper)(r.sheet,r.range)}evalStructRefTerm(e){const{resolution:t,precedents:r}=this.context.resolver.resolveStructRef(this.locals,e.data);if((0,g.safePush)(this.precedents.names,r),!(0,p.isSuccess)(t)){if(t.reason.kind===$.ResolveReasonKind.NoOriginSheet){const t=`error ref, no sheet, struct ref = ${(0,I.anonymize)(e.data)}`;return(0,Q.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",A.ErrorType.REF,t),k.refErrorOper}if(t.reason.kind===$.ResolveReasonKind.EmptyIntersection){const t=`error ref, empty intersection, struct ref = ${(0,I.anonymize)(e.data)}`;return(0,Q.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",A.ErrorType.VALUE,t),N.valueErrorOper}return(0,d.throwEvaluationError)(t.reason)}const n=t.value;if(!n){const t=`error ref, struct ref = ${(0,I.anonymize)(e.data)}`;return(0,Q.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",A.ErrorType.REF,t),k.refErrorOper}return(0,R.range3DOper)(n.sheet,n.range)}evalUdfTerm(e){const{resolution:t,precedents:r}=this.context.resolver.resolveUserDefinedFunc(this.locals,(0,Z.nameNode)((0,X.identNamePart)(e.data.name,!0),e.data.qualifier));if((0,g.safePush)(this.precedents.udfs,r),!(0,p.isSuccess)(t)){const r=e.children;if(t.reason.kind===$.ResolveReasonKind.InvalidQualifier&&void 0!==r)return r;(0,d.throwEvaluationError)(t.reason)}const n=t.value;if(!n){const t=e.children;if(void 0===t){const t=`UDF resolution, qualifier = ${(0,I.anonymize)(e.data.qualifier)}`;return(0,Q.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",A.ErrorType.NAME,t),this.noopTerm(E.nameErrorOper,e.position)}return t}if(n.length>1){const t="UDF resolution, ambiguous name";return(0,Q.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",A.ErrorType.NAME,t),this.noopTerm(E.nameErrorOper,e.position)}const a=n[0],i=this.globals.getUserDefinedFunc(a);return(0,p.isSuccess)(i)||(0,d.throwEvaluationError)(i.reason),new B.UdfOper(a,i.value)}constructor(e,t,r,n,i,o,s,u,l,d,g){this.context=e,this.stepConfig=t,this.locals=r,this.precedents=n,this.visitedCells=i,this.visitedNames=o,this.usage=s,this.target=u,this.isNested=l,this.runStatus=!1,this.stackEnv=c.emptyStackEnv,this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.continuation=[],d.kind!==G.TermKind.CallLambda&&d.kind!==G.TermKind.CallFirstOrderFunc?(this.term=null!=t?(0,G.noopTerm)(d,void 0):d,this.caller=void 0):((0,a.assertTrue)("calc.runtime.FormulaEvaluationMachine.constructor: no preStep for CallTerm",void 0===d.position),this.term=d,this.caller=d.data.caller.caller),this.initialLambdaDepth=s.lambdaDepth,g.length>0&&(this.stackEnv=g.reduce(((e,{value:t})=>e.setValue(e.getCount(),t)),this.stackEnv),this.stackMapLabels=g.map((({label:e})=>e)),this.stackMapNumPushed=g.length)}}t.createFormulaEvaluationMachine=function(e,t,r,n,o,s,u,l){const{contextNames:c=[]}=r,g=l.annotations[l.node.label],m=(g?.kind===Y.AnnotationKind.FormulaRoot?g.contextNames:void 0)??[];return(0,a.assertTrue)("calc.runtime.FormulaEvaluationMachine.createFormulaEvaluationMachine: contextNames",m.length===c.length&&c.every(((e,t)=>e.label===m[t].label))),new ne(e,t,r,n,o,s,(0,d.evalUsage)([0],0),u,!1,(0,G.noopTerm)((0,z.compiledFormulaTerm)("calc.runtime.createFormulaEvaluationMachine",l),i.runtimePositionFormulaRoot),c)},t.createCallTermEvaluationMachine=function(e,t,r,n,a,i,o,s){return new ne(e,t,r,n,a,i,(0,d.evalUsage)(o.lambdaCalls,o.lambdaDepth),H.SignatureType.All,!0,s,[])}},3298:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionDispatcher=t.RestArgsOper=t.UdfOper=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6366),u=r(7496),l=r(7496),c=r(3109),d=r(5146),g=r(4171),m=r(3798),h=r(3798),p=r(3798),f=r(3798),S=r(3798),v=r(3798),F=r(6880),y=r(6880),b=r(6366),C=r(6366),A=r(6366),E=r(6067),T=r(6067),R=r(6067),k=r(6067),N=r(6067),I=r(6067),O=r(6067),P=r(6067),M=r(6067),D=r(6067),w=r(6067),L=r(6067),_=r(6067),x=r(6067),K=r(6067),W=r(6067),U=r(6067),G=r(6067),B=r(6067),V=r(6067),j=r(6067),H=r(6067),q=r(6067),z=r(6067),Q=r(472),$=r(6067),Y=r(6067),J=r(6067),X=r(6067),Z=r(6067),ee=r(6067),te=r(6067),re=r(472),ne=r(6067),ae=r(1819),ie=r(6067),oe=r(6067),se=r(6067),ue=r(9835),le=r(3228),ce=r(3228),de=r(3228),ge=r(3228),me=r(6067),he=r(6067),pe=r(6067),fe=r(6067),Se=r(2986),ve=r(5773),Fe=r(6366),ye=r(6366),be=r(6366),Ce=r(6366),Ae=r(6366),Ee=r(6067),Te=r(6366),Re=r(6366);class ke{getFallback(){return(0,a.assertFalse)("calc.runtime.UdfOper.getFallback")}getField(e){return(0,a.assertFalse)("calc.runtime.UdfOper.getField")}constructor(e,t){this.kind=me.OperKind.Rich,this.loc=e,this.arity=t.arity,this.func=t.func}}t.UdfOper=ke;class Ne{getFallback(){return(0,a.assertFalse)("calc.runtime.RestArgsOper.getFallback")}getField(e){return(0,a.assertFalse)("calc.runtime.RestArgsOper.getField")}constructor(e){this.opers=e,this.kind=me.OperKind.Rich}}function Ie(e,t,r,n){(0,i.assertTrue)("calc.runtime.compileCallLambda",e.checkArity(t.length));const a=[];{let r=0,n=0;for(const i of e.params){if(i.isRest){a.push(new Ne(t.slice(n))),n=t.length;continue}let o=n>=t.length?$.missingOper:t[n++];i.hasDef&&((0,w.isMissingOper)(o)&&(o=e.defsAndBody[r]),++r),a.push(o)}(0,i.assertTrue)("calc.runtime.compileCallLambda",n===t.length&&r===e.defsAndBody.length-1)}const o=n?a.map(((t,r)=>{const n=e.params[r];return void 0===n.paramNodeLabel&&void 0===n.paramNameLabel?t:(0,h.noopTerm)(t,(0,u.runtimePositionLambdaParam)(r,n.paramNodeLabel,n.paramNameLabel))})):a,s=a.map(((t,r)=>e.params[r].paramNodeLabel)),l=e.defsAndBody[e.defsAndBody.length-1],c=(0,h.letTerm)(o,!1,s,l,(0,u.runtimePositionLambdaRoot)(e.lambdaNodeLabel,e,t));return(0,h.callLambdaTerm)(e.locals,e.stackEnv,e.stackMap,r,c)}t.RestArgsOper=Ne;class Oe{get globals(){return this.context.globals}get numberFormatter(){return this.context.numberFormatter}get internalCaller(){return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.internalCaller",void 0!==this.internalSource),(0,c.stackFrameList)(this.internalSource,Oe.internalPosition,c.emptyStackEnv,void 0,this.caller)}get internalContext(){const e=this.internalCaller;return{stack:new c.IterableStackFrame(e)}}get calcingArray(){return this.locals.calcingArray}get originGridCell(){const e=this.locals.originGridCell;return(0,Fe.isSuccess)(e)?e.value:(0,c.throwEvaluationError)(e.reason)}get originSheet(){const e=this.locals.originSheet;return(0,Fe.isSuccess)(e)?e.value:(0,c.throwEvaluationError)(e.reason)}get reflectionGridCell(){const e=this.locals.reflectionGridCell;return(0,Fe.isSuccess)(e)?e.value:(0,c.throwEvaluationError)(e.reason)}get reflectionSheet(){const e=this.locals.reflectionSheet;return(0,Fe.isSuccess)(e)?e.value:(0,c.throwEvaluationError)(e.reason)}get followHyperlinks(){const e=this.locals.followHyperlinks;return(0,Fe.isSuccess)(e)?e.value:(0,c.throwEvaluationError)(e.reason)}makeChildDispatcher(e){return new Oe(this.context,this.stepConfig,this.locals,e,this.precedents,this.visitedCells,this.visitedNames,this.usage)}useAsFuncContext(e){return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.useAsFuncContext: caller shouldn't be set",void 0===this.internalSource),void 0!==e&&(this.internalSource=e),this}applyFunction(e,t){const r=this.makeChildDispatcher(this.internalCaller),n=(0,oe.getWorksheetFuncType)(e),a=t.some(W.isRangeOper)?t.slice(0):t;return(0,Se.dereferenceOpers)(r,a,n),r.termToFuncResult(r.dispatchFunction((0,v.worksheetFunctionIdToName)(e),n,!1,a))}applyLambda(e,t){return this.termToFuncResult(Ie(e,t,this.internalCaller,null!=this.stepConfig))}throwEvaluationError(e){throw new c.EvaluationError(e)}handleEvaluationError(e){if(e instanceof c.EvaluationError)return(0,c.handleEvaluationError)(this.context,this.visitedCells,e.reason)}applyOperatorOrFunction(e,t,r){if((0,v.isOperatorName)(e))return(0,g.applyOperator)(this.globals,(0,v.operatorNameToId)(e),t,r);const n=(0,v.worksheetFunctionNameToId)(e);if(n===ie.WorksheetFuncId._UDF){if(t[0]instanceof ae.LambdaOper){const e=t[0],r=t.slice(1);return e.checkArity(r.length)?((0,i.assertTrue)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: caller shouldn't be set",void 0===this.internalSource),Ie(e,r,this.caller,null!=this.stepConfig)):J.valueErrorOper}if(t[0]instanceof ke){const e=t[0];if(t.length-1!==e.arity)return J.valueErrorOper;const r=e.func(this.useAsFuncContext((0,T.lexicalSourceUDF)(e.loc)),t.slice(1));if(r.kind===me.OperKind.Error){const e="UDF function return value";(0,y.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",r.type,e)}return this.funcContextResultToTerm(r)}switch(t[0].kind){case me.OperKind.Error:return t[0];case me.OperKind.Number:return J.valueErrorOper;case me.OperKind.Rich:return(0,c.throwEvaluationError)((0,B.notImplemented)(["Rich UDF head"]));case me.OperKind.String:case me.OperKind.Boolean:case me.OperKind.Blank:case me.OperKind.Missing:return te.refErrorOper;case me.OperKind.Array:return(0,Re.isFeatureEnabled)(Te.FeatureName.CalcLambdaArrayLifting)?(0,a.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected array UDF head"):(0,c.throwEvaluationError)((0,B.notImplemented)(["Array UDF head"]));case me.OperKind.Range:return(0,Re.isFeatureEnabled)(Te.FeatureName.CalcLambdaCellValues)?(0,a.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected range UDF head"):(0,c.throwEvaluationError)((0,B.notImplemented)(["Range UDF head"]));default:return(0,o.assertNever)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",t[0])}}const s=this.globals.getWorksheetFunc(n);if(s.kind===ye.ResultKind.Failure)return(0,c.throwEvaluationError)(s.reason);const u=s.value;if(null==u){const e=`nonexistent worksheet function ${n}`;return(0,y.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",X.ErrorType.NAME,e),Z.nameErrorOper}try{const e=u(this.useAsFuncContext((0,R.lexicalSourceWSF)(n)),t);if(e.kind===me.OperKind.Error){const t=`worksheet function ${n} return value`;(0,y.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",e.type,t)}return this.funcContextResultToTerm(e)}catch(e){throw(0,Ae.prependErrorMessage)(e,`(in WSF ${(0,E.englishWorksheetFuncIdToName)(n)})`)}}termToFuncResult(e){switch(e.kind){case S.TermKind.CallLambda:case S.TermKind.CallFirstOrderFunc:return(0,ue.machineCall)(this.context.createCallTermEvaluationMachine(this.context,this.stepConfig,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,e));case S.TermKind.CallMachine:return(0,ue.machineCall)(e.data.machine)}return e}funcContextResultToTerm(e){return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.funcContextResultToTerm",void 0!==this.internalSource),(0,ue.isMachineCall)(e)?(0,m.callFirstOrderFuncTerm)(this.internalSource,this.caller,(0,f.callMachineTerm)(e.machine,Oe.internalPosition)):e}dispatchFunction(e,t,r,i){if(!(0,K.isValidArgsLength)(t,i.length)){const r=JSON.stringify(t),n=`calc.runtime.FunctionDispatcher.dispatchFunction: bad application of ${JSON.stringify(e)} to ${i.length} arguments, ftype = ${r}`;return(0,a.assertFalse)(n)}const o=i.length;let s=pe.SignatureType.None;for(let e=0;e<o;e+=1){const r=i[e],n=r.kind,a=(0,x.getArgType)(t,e,o);0==(n&a)&&(s|=n),(0,W.isRangeOper)(r)&&0==(t.flags&fe.FunctionFlags.Allow3dRef)&&0==(a&pe.SignatureType.Ref3D)&&!(0,_.isSheetIndex)(r.sheets)&&(s|=n),(0,D.isStringOper)(r)&&0==(t.flags&fe.FunctionFlags.AllowLStrs)&&r.value.length>255&&(s|=n)}if(s===pe.SignatureType.None)return this.applyOperatorOrFunction(e,i,r);if(0!=(s&me.OperKind.Array)){const r=r=>{const n=this.makeChildDispatcher(this.caller);return n.termToFuncResult(n.dispatchFunction(e,t,!1,r))},{machine:n}=(0,F.arrayLift)(this.useAsFuncContext(void 0),t,r,i);return(0,f.callMachineTerm)(n,void 0)}s&=~me.OperKind.Array;const u=[];for(let e=0;e<o;e+=1){let r=i[e];if(0!=(s&r.kind)){const a=(0,x.getArgType)(t,e,o);if(r=this.coerceOper(r,a),(0,U.isErrorOper)(r)&&0==(a&me.OperKind.Error))return r;if((0,W.isRangeOper)(r)&&0==(t.flags&fe.FunctionFlags.Allow3dRef)&&0==(a&pe.SignatureType.Ref3D)&&!(0,_.isSheetIndex)(r.sheets)){const e=`3D reference, oper = ${(0,n.anonymize)(r)}`;return(0,y.traceErrorOper)("calc.runtime.FunctionDispatcher.dispatchFunction",X.ErrorType.VALUE,e),J.valueErrorOper}if((0,D.isStringOper)(r)&&0==(t.flags&fe.FunctionFlags.AllowLStrs)&&r.value.length>255){const e=`LStr, oper = ${(0,n.anonymize)(r)}`;return(0,y.traceErrorOper)("calc.runtime.FunctionDispatcher.dispatchFunction",X.ErrorType.VALUE,e),J.valueErrorOper}}u[e]=r}return this.applyOperatorOrFunction(e,u,r)}getAvailableFormula(e){const t=this.globals.getCellFormula(e);return(0,Fe.isSuccess)(t)?(0,b.isNone)(t.value)?void 0:t.value:(0,c.throwEvaluationError)(t.reason)}getNameFormula(e,t,r){const{resolution:n,precedents:a}=this.context.resolver.resolveName(this.locals,(0,V.nameNode)((0,H.identNamePart)(t,!0),e),r);if((0,A.safePush)(this.precedents.names,a),!(0,Fe.isSuccess)(n))switch(n.reason.kind){case z.ResolveReasonKind.NoOriginSheet:case z.ResolveReasonKind.InvalidQualifier:return;default:return(0,c.throwEvaluationError)(n.reason)}const i=n.value;if(!i)return;const o=this.globals.getNameFormula(i,r);(0,Fe.isSuccess)(o)||(0,c.throwEvaluationError)(o.reason);const s=o.value;return(0,b.isNone)(s)?void 0:[i,s.node]}getCellRef(e,t,r,n){const a={originGridCell:(0,be.success)(r.range),originSheet:(0,be.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:n},{resolution:i}=this.context.resolver.resolveCellRef(a,(0,j.cellRefNode)(t,e));if(!(0,Fe.isSuccess)(i))switch(i.reason.kind){case z.ResolveReasonKind.NoOriginSheet:case z.ResolveReasonKind.InvalidQualifier:return;default:return(0,c.throwEvaluationError)(i.reason)}const o=i.value;if(o)return(0,Y.range3DOper)(o.sheet,o.range)}getStructRef(e,t,r){const n={originGridCell:(0,be.success)(r.range),originSheet:(0,be.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},{resolution:a,precedents:i}=this.context.resolver.resolveStructRef(n,(0,q.structRefNode)(e,t));if((0,A.safePush)(this.precedents.names,i),!(0,Fe.isSuccess)(a))switch(a.reason.kind){case z.ResolveReasonKind.NoOriginSheet:case z.ResolveReasonKind.InvalidQualifier:case z.ResolveReasonKind.InvalidStructRef:case z.ResolveReasonKind.EmptyIntersection:return;default:return(0,c.throwEvaluationError)(a.reason)}const o=a.value;if(o)return(0,Y.range3DOper)(o.sheet,o.range)}dereferenceOper(e,t){return(0,Se.dereferenceOper)(this,e,t)}dereferenceOpers(e,t){(0,Se.dereferenceOpers)(this,e,t)}getCellFormula(e){this.precedents.cells.push(e);const t=this.globals.getCellValue(e);return(0,Fe.isSuccess)(t)?this.getAvailableFormula(e):(0,c.throwEvaluationError)(t.reason)}getSheetIndex(e,t){const r=this.globals.getSheetIndex(e,t);return(0,Fe.isSuccess)(r)?(this.precedents.special|=he.SpecialPrecs.OwnDocSheets,null==r.value?void 0:(0,O.sheetIndex)(e,r.value)):(0,c.throwEvaluationError)(r.reason)}getSheetRangePosition(e){this.precedents.special|=he.SpecialPrecs.OwnDocSheets;const t=this.globals.getSheetRangeIndexes(e);return(0,Fe.isSuccess)(t)?t.value.position:(0,c.throwEvaluationError)(t.reason)}getSheetRangeIndexes(e){if(void 0!==e.index&&e.index===e.index2)return[e.index];this.precedents.special|=he.SpecialPrecs.OwnDocSheets;const t=this.globals.getSheetRangeIndexes(e);return(0,Fe.isSuccess)(t)?t.value.sheets:(0,c.throwEvaluationError)(t.reason)}dereferenceAllOpersInner(e,t,r=!1){const n=[],a=[];for(let o=0;o<e.length;o+=1){const s=e[o];if(!(0,W.isRangeOper)(s)){a.push(s);continue}const u=[],l=e=>{const r=(0,Se.getCellValuesAsArray)(this,e,n,!0);void 0!==r&&u.push(t(r,e))},g=this.getSheetRangeIndexes(s.sheets);for(let e=0;e<g.length;e+=1){const t=(0,O.sheetIndex)(s.sheets.document,g[e]);for(let e=0;e<s.ranges.length;e+=1){const n=s.ranges[e];if(!r){l((0,P.sheetGridRange)(t,n));continue}const a=this.globals.tryGetHiddenRows(t,n.row,n.row+n.rows);if(!(0,Fe.isSuccess)(a))return(0,c.throwEvaluationError)(a.reason);const o=a.value;if(0===o.length){l((0,P.sheetGridRange)(t,n));continue}const u=(e,r)=>{const a=(0,I.gridRange)(e,n.col,r-e,n.cols);l((0,P.sheetGridRange)(t,a))};for(let e=0;e<o.length;e+=1){const{start:r,end:a}=o[e],s=0===e?n.row:o[e-1].end;(0,i.assertTrue)("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",s<=r&&r<a&&a<=n.row+n.rows),s!==r&&u(s,r);const l=(0,I.gridRange)(r,n.col,a-r,n.cols);this.precedents.cells.push((0,P.sheetGridRange)(t,l))}const d=o[o.length-1].end;d!==n.row+n.rows&&u(d,n.row+n.rows)}}a.push({kind:d.DerefOperKind.RangeValues,arrays:u})}return n.length>0?(0,c.throwEvaluationError)((0,c.unevaluated)(n)):a}dereferenceAllOpers(e,t){return this.dereferenceAllOpersInner(e,C.identity,t)}dereferenceAllOpersAndFormulae(e,t){return this.dereferenceAllOpersInner(e,((e,t)=>new s.NonstrictSparseArray2D(e.rows,e.cols,e.denseRows,e.denseCols,((r,n)=>{const a=e.get(r,n),i=(0,k.sheetGridCell)(t.sheet,(0,N.gridCell)(t.range.row+r,t.range.col+n));return[a,this.getAvailableFormula(i)]}),(()=>[e.getSparse(),void 0])).strict()),t)}parseFormula(e,t,r,n){const a=this.context.parser.parseFormula((0,Q.parseLocals)(r.lexicalKind,t,{refStyle:e}),n);if(!(0,Fe.isSuccess)(a))return a;const i=this.context.analyzer.checkFormula(r,a.value);return(0,Fe.isSuccess)(i)?(0,L.isWellFormed)(i.value)?(i.value,i):(0,Ce.failure)((0,l.illFormedFormula)("ill-formed indirect formula","indirect")):i}getRandom(){this.precedents.special|=he.SpecialPrecs.Calc;const e=this.internalContext,t=this.globals.getRandom(e);return(0,Fe.isSuccess)(t)||(0,c.throwEvaluationError)(t.reason),t.value}getTime(e){this.precedents.special|=he.SpecialPrecs.Time;const t=this.globals.getTime(e,ce.GetTimeKind.Volatile);return(0,Fe.isSuccess)(t)||(0,c.throwEvaluationError)(t.reason),t.value}coerceOper(e,t){return(0,ve.coerceOper)(this,e,t)}parseGeneral(e,t){const r=this.numberFormatter.parseGeneral(e,!1,t,ce.GetTimeKind.NonVolatile);return(0,Fe.isSuccess)(r)||(0,c.throwEvaluationError)(r.reason),r.value?.value}parseDate(e){const t=this.numberFormatter.parseDate(e,ce.GetTimeKind.NonVolatile);return(0,Fe.isSuccess)(t)||(0,c.throwEvaluationError)(t.reason),t.value?.value}getBinaryOperator(e){const t=(0,se.getOperatorType)(e),r=[ee.falseOper,ee.falseOper];return(n,a)=>{r[0]=n,r[1]=a,(0,Se.dereferenceOpers)(this,r,t);const o=this.dispatchFunction((0,v.operatorIdToName)(e),t,!1,r);return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.getBinaryOperator",(0,p.isOperTerm)(o)),o}}getUnaryOperator(e){const t=(0,se.getOperatorType)(e),r=[ee.falseOper];return n=>{r[0]=n,(0,Se.dereferenceOpers)(this,r,t);const a=this.dispatchFunction((0,v.operatorIdToName)(e),t,!1,r);return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.getUnaryOperator",(0,p.isOperTerm)(a)),a}}isInFilterMode(e){this.precedents.special|=he.SpecialPrecs.InFilterMode;for(const t of e)if((0,W.isRangeOper)(t))for(const e of this.getSheetRangeIndexes(t.sheets)){const r=this.globals.isInFilterMode((0,O.sheetIndex)(t.sheets.document,e));if(!(0,Fe.isSuccess)(r))return(0,c.throwEvaluationError)(r.reason);if(r.value)return!0}return!1}printFormula(e,t){const r=(0,k.sheetGridCell)(e.source.range.sheet,t),n=(0,ne.adjustFormulaOrigin)(this.globals,(0,re.analyzeLocalsGrid)(M.LexicalKind.Cell,(0,G.sheetGridRangeAnchor)(e.source.range)),t,e.formula);if(!(0,Fe.isSuccess)(n))return(0,c.throwEvaluationError)(n.reason);const a=this.context.printer.printFormula((0,Ee.printLocalsGrid)(e.source,r,{refStyle:this.config.refStyle}),n.value);return(0,Fe.isSuccess)(a)?a.value:(0,c.throwEvaluationError)(a.reason)}applyFormat(e,t,r,n){let a;if("number"==typeof t){const r=this.globals.getKnownFormat(e,t);if(!(0,Fe.isSuccess)(r))return(0,c.throwEvaluationError)(r.reason);a=r.value}else{const r=(0,de.getFormatString)(this.context.numberFormatter,this.globals,e,t,n);if(!(0,Fe.isSuccess)(r))switch(r.reason.kind){case le.FormatReasonKind.PreviousFormatFailure:case le.FormatReasonKind.NotFormatString:return;default:return(0,c.throwEvaluationError)(r.reason)}a=r.value}const i=(0,ge.applyFormatAndRenderToString)(this.context.numberFormatter,a,r);return(0,Fe.isSuccess)(i)?"string"==typeof i.value?i.value:void 0:(0,c.throwEvaluationError)(i.reason)}constructor(e,t,r,n,a,i,o,s){this.context=e,this.stepConfig=t,this.locals=r,this.caller=n,this.precedents=a,this.visitedCells=i,this.visitedNames=o,this.usage=s,this.internalSource=void 0;const u=e.globals.config.refStyle;this.config={localeInfo:e.globals.config.localeInfo,get refStyle(){return a.special|=he.SpecialPrecs.RefStyle,u},mathpack:e.globals.config.mathpack,date1904:e.globals.config.date1904,dateCompatibility:e.globals.config.dateCompatibility,timezone:e.globals.config.timezone,datepack:e.globals.config.datepack},this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}}t.FunctionDispatcher=Oe,Oe.internalPosition=u.runtimePositionFirstOrderFunc},5945:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNameEvaluationMachine=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6067),u=r(6067),l=r(6067),c=r(3109),d=r(4488);class g{evalName(){const e=this.context.globals.getNameFormula(this.name,u.NameSource.Plain);if(e.kind===i.ResultKind.Failure)return o.Pledge.reject(e.reason);const t=e.value;if(null==t)return o.Pledge.resolve(void 0);const r=(0,c.bottomEvalPrecedents)(),n=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,c.evalLocalsName)((0,s.lexicalSourceName)(this.name),(0,c.evalLocalsGrid)(this.origin)),r,d.emptyVisitedCells,(0,d.appendVisitedName)(d.emptyVisitedNames,this.name),l.SignatureType.All,t);return o.Pledge.fromMachine(n).catch(this.receiveFailure())}receiveFailure(){return e=>{if(e.kind===c.RuntimeInternalReasonKind.Unevaluated){const t=`calc.runtime.NameEvaluationMachine.receiveFailure: unexpected reason ${(0,n.anonymize)(e)}`;return(0,a.assertFalse)(t)}return o.Pledge.reject(e)}}constructor(e,t,r,n){this.context=e,this.stepConfig=t,this.name=r,this.origin=n}}t.createNameEvaluationMachine=function(e,t,r,n){return o.Pledge.try((()=>new g(e,t,r,n).evalName()))}},1235:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EvaluationRuntime=t.runtimeTimer=t.calculateNextDeadline=t.createSchedule=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(7496),u=r(6366),l=r(6366),c=r(6366),d=r(6366),g=r(6366);function m(e){if(void 0===e.yieldIntervalMs&&void 0===e.endTimeMs)return;if(void 0===e.yieldIntervalMs)return e.endTimeMs;const t=(0,u.now)()+e.yieldIntervalMs;return void 0===e.endTimeMs?t:(0,l.fastMin)(e.endTimeMs,t)}t.createSchedule=function(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:(0,u.now)()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:e=>setTimeout(e,0)}},t.calculateNextDeadline=m,t.runtimeTimer=function(){return{doTimeout:e=>void 0!==e&&(0,u.now)()>=e}};const h={kind:s.ReasonKind.Timeout},p={kind:s.ReasonKind.Breakpoint};t.EvaluationRuntime=class{evaluateAsync(e){if(this.context.globals.interruptToken[0]===s.Interrupt.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{const t=this.evaluate(m(e));return Array.isArray(t)?Promise.resolve(t):((0,i.assertTrue)("calc.runtime.EvaluationRuntime.evaluateAsync",t.kind===s.ReasonKind.Timeout),new Promise(((t,r)=>e.scheduleFunction((()=>{try{t(this.evaluateAsync(e))}catch(e){r(e)}})))))}catch(e){return Promise.reject(e)}}evaluateSync(e){const t=r=>{if(this.context.globals.interruptToken[0]===s.Interrupt.Stop||this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),this.results;const n=this.evaluate(r);if(Array.isArray(n))return n;switch(n.kind){case s.ReasonKind.Timeout:return(0,s.paused)((r=>t(r??m(e))));case s.ReasonKind.Breakpoint:return(0,s.breaked)((()=>t(m(e))));default:return(0,a.assertNever)("calc.runtime.EvaluationRuntime.evaluateSync",n)}};return t(m(e))}evaluate(e){const t=()=>this.context.timer.doTimeout(e);try{for(;this.results.length<this.machineRuntimes.length;){const e=this.machineRuntimes[this.results.length].run(t);if(e.kind===c.TransitionKind.Next)return h;if(e.kind===c.TransitionKind.Break)return p;this.pushResult(e)}return this.results}catch(e){const t=`calc.runtime.EvaluationRuntime.evaluate: unhandled error ${(0,d.messageFromError)(e)}`;return(0,o.assertFalse)(t)}}pushResult(e){return this.results.push(e),c.nextTransition}generatePartialResults(){for(;this.results.length<this.machineRuntimes.length;)this.results.push((0,g.failure)(s.stopped))}constructor(e,t){(0,n.assertPositiveInteger)("calc.runtime.EvaluationRuntime",t.length),this.context=e,this.machineRuntimes=t.map((e=>new c.MachineRuntime(e))),this.results=[]}}},3109:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CellEvaluationResultKind=t.IterableStackFrame=t.IterableStackValue=t.stackFrameList=t.stackMapList=t.emptyStackEnv=t.LazyOper=t.evalLocalsSlice=t.evalLocalsFirstOrderFunc=t.evalLocalsLambda=t.evalLocalsName=t.evalLocalsGrid=t.evalUsage=t.bottomEvalPrecedents=t.handleEvaluationError=t.throwEvaluationError=t.EvaluationError=t.unevaluated=t.RuntimeInternalReasonKind=void 0;const n=r(7496),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6366),l=r(6067),c=r(6067),d=r(6366),g=r(6067),m=r(6366),h=r(6366),p=r(6366),f=r(6366),S=r(6366);var v,F;function y(e){throw new t.EvaluationError(e)}!function(e){e.Unevaluated="Unevaluated"}(v||(t.RuntimeInternalReasonKind=v={})),t.unevaluated=function(e){return 0===e.length&&(0,u.assertFalse)("calc.runtime.unevaluated: expected nonempty array"),{kind:v.Unevaluated,anchors:e}},t.EvaluationError=(0,o.createFailureErrorClass)("EvaluationError"),t.throwEvaluationError=y;class b{next(){return(0,d.callMachineTransition)(this.machine,this)}receiveResult(e){if(!(0,p.isSuccess)(e))return e;switch(e.value.kind){case F.ReadFailure:return e.value.failure;case F.WroteFailure:return(0,m.failure)((0,n.previousFailure)(e.value.source.range))}return f.successUndefined}constructor(e){this.machine=e,this.runStatus=!1}}t.handleEvaluationError=function(e,t,r){if(r.kind===v.Unevaluated){if(t.map.getCount()+1>(e.globals.limits.maxCellChain??1/0))return(0,m.failure)((0,n.limitExceeded)(n.LimitKind.CellChain));const a=r.anchors.map((r=>new b(e.createCellEvaluationMachine(e,void 0,t,r))));return(0,d.callMachineTransition)(new d.AllMachine(a),(0,d.nextOnSuccessReceiver)())}return(0,m.failure)(r)},t.bottomEvalPrecedents=function(){return(0,c.precedents)([],[],[],g.SpecialPrecs.None,l.PrecsBound.Lower)},t.evalUsage=function(e,t){return{lambdaCalls:e,lambdaDepth:t}},t.evalLocalsGrid=function(e){const t=(0,a.sheetGridRangeAnchor)(e.range),r=(0,h.success)(t.range),i=(0,h.success)(t.sheet);return(0,n.evalLocals)(e,r,i,e.kind===s.LexicalKind.Range,r,i,e.kind===s.LexicalKind.Cell,!0,!1,(0,h.success)(!1),void 0)},t.evalLocalsName=function(e,t){const r=e.name.scope;let a;if(void 0!==r.index)a=(0,h.success)(r);else{const e=t.originSheet;if(!(0,p.isSuccess)(e))return y(e.reason);a=(0,i.isDocumentLocEqual)(e.value.document,r.document)?e:(0,h.success)(r)}const o=t.originGridCell;return(0,n.evalLocals)(e,o,a,t.calcingArray,o,a,!1,!1,!0,(0,h.success)(!1),void 0)},t.evalLocalsLambda=function(e,t){return(0,n.evalLocals)(e.lexicalSource,e.originGridCell,e.originSheet,t.calcingArray,t.reflectionGridCell,t.reflectionSheet,t.implicitIntersect,e.allowUnqualifiedCell,e.wrapCellReferences,(0,h.success)(!1),void 0)},t.evalLocalsFirstOrderFunc=function(e,{originGridCell:t,originSheet:r,calcingArray:a,reflectionGridCell:i,reflectionSheet:o,implicitIntersect:s,allowUnqualifiedCell:u,wrapCellReferences:l,followHyperlinks:c}){return(0,n.evalLocals)(e,t,r,a,i,o,s,u,l,c,void 0)},t.evalLocalsSlice=function({lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:a,reflectionGridCell:i,reflectionSheet:o,implicitIntersect:s,allowUnqualifiedCell:u,wrapCellReferences:l,followHyperlinks:c,contextNames:d}){return(0,n.evalLocals)(e,t,r,a,i,o,s,u,l,c,d)};class C{get value(){return void 0===this._value?this.fallback():this._value}set value(e){this._value=e}get valueOrUndefined(){return this._value}constructor(e){this.fallback=e}}t.LazyOper=C,t.emptyStackEnv=S.RedBlackMapTree.create(((e,t)=>e-t)),t.stackMapList=function(e,t,r){return{labels:e,numPushed:t,next:r}},t.stackFrameList=function(e,t,r,n,a){return{stackDepth:1+(a?.stackDepth??0),lexicalSource:e,position:t,localValues:new A(r,n),caller:a}};class A{*[Symbol.iterator](){let e=this.stackEnv.getCount()-1;for(let t=this.stackMap;void 0!==t;t=t.next)for(let r=t.numPushed-1;r>=0;r--){const a=t.labels[r],i=this.stackEnv.getValue(e--);if(void 0===a||void 0===i)continue;const o=i instanceof C?i.valueOrUndefined:i;void 0!==o&&(yield(0,n.stackValue)(a,o))}}constructor(e,t){this.stackEnv=e,this.stackMap=t}}t.IterableStackValue=A;class E{*[Symbol.iterator](){for(let e=this.leafFrame;void 0!==e;e=e.caller)yield e}constructor(e){this.leafFrame=e}}t.IterableStackFrame=E,function(e){e[e.ReadFailure=0]="ReadFailure",e[e.ReadOper=1]="ReadOper",e[e.WroteFailure=2]="WroteFailure",e[e.WroteOper=3]="WroteOper"}(F||(t.CellEvaluationResultKind=F={}))},4596:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEvaluator=t.evalName=t.evalCellsAsync=t.evalCells=t.evalFormula=t.evaluationMachineContext=t.runtimeEvaluationContext=void 0;const n=r(472),a=r(6366),i=r(6366),o=r(6366),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(3228),g=r(472),m=r(3070),h=r(9662),p=r(5945),f=r(1235),S=r(3109),v=r(6366),F=r(9835),y=r(7496),b=r(4488);function C(e){return{globals:e,timer:(0,f.runtimeTimer)(),machineContext:A(e)}}function A(e){return{globals:e,resolver:(0,u.createResolver)(e),numberFormatter:(0,d.createNumberFormatter)(e),parser:(0,g.createParser)(e),printer:(0,s.createPrinter)(e),analyzer:(0,n.createAnalyzer)(e),createCellEvaluationMachine:m.createCellEvaluationMachine,createFormulaEvaluationMachine:h.createFormulaEvaluationMachine,createCallTermEvaluationMachine:h.createCallTermEvaluationMachine}}function E(e){if(Array.isArray(e)){const t=e[0];if(t.kind===o.ResultKind.Success){if((0,l.isRangeOper)(t.value)||(0,c.isMissingOper)(t.value)){const e=`calc.runtime.evalFormula: expected ReadOper; given ${(0,a.anonymize)(t)}`;return(0,i.assertFalse)(e)}return t}return t}return e.kind===o.ResultKind.Paused?(0,y.paused)((t=>E(e.resume(t)))):(0,y.breaked)((()=>E(e.resume())))}function T(e,t,r){const n=C(e),a=(0,S.bottomEvalPrecedents)(),i=(0,h.createFormulaEvaluationMachine)(n.machineContext,t.stepConfig,(0,S.evalLocalsSlice)(t),a,b.emptyVisitedCells,b.emptyVisitedNames,F.readOperType,r),o=new f.EvaluationRuntime(n,[i]),s=(0,f.createSchedule)(t.schedulerConfig??e.schedulerConfig);return E(o.evaluateSync(s))}function R(e,t,r){const n=C(e),a=[];for(let e=0;e<r.length;e+=1)a.push(new v.VoidMachine((0,m.createCellEvaluationMachine)(n.machineContext,t,b.emptyVisitedCells,r[e])));return new f.EvaluationRuntime(n,a)}function k(e,t,r){if(0===r.length)return[];const n=R(e,t.stepConfig,r),a=(0,f.createSchedule)(t.schedulerConfig??e.schedulerConfig);return n.evaluateSync(a)}function N(e,t,r){if(0===r.length)return Promise.resolve([]);const n=R(e,void 0,r),a=(0,f.createSchedule)(t.schedulerConfig??e.schedulerConfig);return n.evaluateAsync(a)}function I(e){return Array.isArray(e)?e[0]:e.kind===o.ResultKind.Paused?(0,y.paused)((t=>I(e.resume(t)))):(0,y.breaked)((()=>I(e.resume())))}function O(e,t,r,n){const a=C(e),i=(0,p.createNameEvaluationMachine)(a.machineContext,t.stepConfig,r,n),o=new f.EvaluationRuntime(a,[i]),s=(0,f.createSchedule)(t.schedulerConfig??e.schedulerConfig);return I(o.evaluateSync(s))}t.runtimeEvaluationContext=C,t.evaluationMachineContext=A,t.evalFormula=T,t.evalCells=k,t.evalCellsAsync=N,t.evalName=O,t.createEvaluator=function(e){return{evalFormula:(t,r)=>T(e,t,r),evalCells:(t,r)=>k(e,t,r),evalName:(t,r,n)=>O(e,t,r,n),evalCellsAsync:(t,r)=>N(e,t,r)}}},5146:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.isRangeValues=t.rangeValues=t.DerefOperKind=void 0,function(e){e.RangeValues="RangeValues"}(r||(t.DerefOperKind=r={})),t.rangeValues=function(e){return{kind:r.RangeValues,arrays:e}},t.isRangeValues=function(e){return e.kind===r.RangeValues}},9835:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.refToVal=t.ArrayMachine=t.earlyReturn=t.EarlyReturnKind=t.ThenMachine=t.isMachineCall=t.machineCall=t.MachineCallKind=t.readOperType=t.singleReadOperType=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6366),s=r(6366),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6366),m=r(6366),h=r(6366),p=r(6366),f=r(6067),S=r(6067);var v,F;function y(e){return e.kind===v.MachineCall}t.singleReadOperType=f.OperKind.Number|f.OperKind.String|f.OperKind.Boolean|f.OperKind.Error|f.OperKind.Blank|f.OperKind.Rich,t.readOperType=t.singleReadOperType|f.OperKind.Array,function(e){e.MachineCall="MachineCall"}(v||(t.MachineCallKind=v={})),t.machineCall=function(e){return{kind:v.MachineCall,machine:e}},t.isMachineCall=y,t.ThenMachine=class{next(){try{if(void 0===this.oper1){const e=this.f1();if(y(e))return(0,s.callMachineTransition)(e.machine,this);this.oper1=e}if(void 0===this.oper2){const e=this.f2(this.oper1);if(y(e))return(0,s.callMachineTransition)(e.machine,this);this.oper2=e}return(0,g.success)(this.oper2)}catch(e){return this.context.handleEvaluationError(e)??(0,m.failure)((0,h.javaScriptError)(e))}}receiveResult(e){return(0,p.isSuccess)(e)?(void 0===this.oper1?this.oper1=e.value:void 0===this.oper2&&(this.oper2=e.value),o.nextTransition):e}constructor(e,t,r){this.context=e,this.f1=t,this.f2=r,this.runStatus=!1,this.oper1=void 0,this.oper2=void 0}},function(e){e.EarlyReturn="EarlyReturn"}(F||(t.EarlyReturnKind=F={})),t.earlyReturn=function(e){return{kind:F.EarlyReturn,value:e}},t.ArrayMachine=class{next(){try{if(void 0!==this.toDeref){const e=this.coercer(this.toDeref,this.opers.length,this.row.length);if(e.kind===F.EarlyReturn)return e.value;this.row.push(e),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return(0,g.success)((0,n.arrayOper)(this.rows,this.cols,this.opers));const e=this.func(this.opers.length,this.row.length);return y(e)?(0,s.callMachineTransition)(e.machine,this):(this.toDeref=e,o.nextTransition)}catch(e){return this.context.handleEvaluationError(e)??(0,m.failure)((0,h.javaScriptError)(e))}}receiveResult(e){return(0,p.isSuccess)(e)?(this.toDeref=e.value,o.nextTransition):e}constructor(e,t,r,n,a){this.context=e,this.rows=t,this.cols=r,this.func=n,this.coercer=a,this.runStatus=!1,this.toDeref=void 0,this.row=[],this.opers=[]}},t.refToVal=function(e,t,r){if(!(0,l.isRangeOper)(t))return t;if(!(0,c.isSheetIndex)(t.sheets))return i.valueErrorOper;if(!r)return 1===t.ranges.length&&(0,d.isGridCell)(t.ranges[0])?e.dereferenceOper(t,S.SignatureType.All&~f.OperKind.Range):e.dereferenceOper(t,f.OperKind.Array);const n=e.dereferenceOper(t,S.SignatureType.All&~(f.OperKind.Range|f.OperKind.Array));return(0,u.isArrayOper)(n)?a.naErrorOper:n}},4171:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyOperator=t.cmpNum=t.cmpStr=t.cmpBool=t.cmpInt=void 0;const n=r(6366),a=r(6880),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6366),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(6067),E=r(6067),T=r(6067),R=r(6880);function k(e,r,n){return(0,t.cmpInt)(e,r.value-n.value)}function N(e,r,n,a){return(0,t.cmpInt)(r,e.stringCompareCI(n.value,a.value))}function I(e,r,n,a){return(0,t.cmpInt)(r,e.compare(n,a))}function O(e,t,r){if((0,v.isSheetIndex)(t.sheets))if((0,v.isSheetIndex)(r.sheets))if((0,F.isDocumentLocEqual)(t.sheets.document,r.sheets.document)){if(t.sheets.index===r.sheets.index)return(0,S.sheetIndex)(t.sheets.document,t.sheets.index);{const i=`different sheet, range1 = ${(0,n.anonymize)(t)}, range2 = ${(0,n.anonymize)(r)}`;(0,a.traceErrorOper)(e,s.ErrorType.VALUE,i)}}else{const i=`different document, range1 = ${(0,n.anonymize)(t)}, range2 = ${(0,n.anonymize)(r)}`;(0,a.traceErrorOper)(e,s.ErrorType.VALUE,i)}else(0,a.traceErrorOper)(e,s.ErrorType.VALUE,`3D reference, range2 = ${(0,n.anonymize)(r)}`);else(0,a.traceErrorOper)(e,s.ErrorType.VALUE,`3D reference, range1 = ${(0,n.anonymize)(t)}`)}t.cmpInt=T.applyComparison,t.cmpBool=k,t.cmpStr=N,t.cmpNum=I,t.applyOperator=function(e,r,S,v=!1){const{mathpack:F}=e.config;if(1===S.length){const e=S[0];switch(r){case p.OperatorId.Percent:return F.percent(e);case p.OperatorId.Neg:return F.neg(e);case p.OperatorId.Pos:return e;default:{const e=`calc.runtime.applyOperator: bad application of ${r} to 1 argument`;return h.ulsLogger.ULS.assertTag(593372496,i.LogCategory.msoulscat_ES_EWAJS,!1,e)}}}if(2===S.length){const T=S[0],P=S[1];switch(r){case p.OperatorId.Add:{const e=F.add(T,P);return v&&(0,b.isNumberOper)(e)?F.checkAlmostCancellation(T,e):e}case p.OperatorId.Sub:{const e=F.sub(T,P);return v&&(0,b.isNumberOper)(e)?F.checkAlmostCancellation(T,e):e}case p.OperatorId.Mul:return F.mul(T,P);case p.OperatorId.Div:return F.div(T,P);case p.OperatorId.Pow:return F.power(T,P);case p.OperatorId.Concat:return(0,d.stringOper)((T.value+P.value).substring(0,o.cellStringLimit));case p.OperatorId.Eq:case p.OperatorId.Ne:case p.OperatorId.Lt:case p.OperatorId.Le:case p.OperatorId.Gt:case p.OperatorId.Ge:return(0,m.booleanOper)(function(e,r,n,a){const{localeInfo:i,mathpack:o}=e.config;if(n.kind!==a.kind){if((0,y.isBlankOper)(n))switch(a.kind){case f.OperKind.Number:return I(o,r,o.zero,a);case f.OperKind.String:return N(i,r,R.emptyStringOper,a);case f.OperKind.Boolean:return k(r,g.falseOper,a)}if((0,y.isBlankOper)(a))switch(n.kind){case f.OperKind.Number:return I(o,r,n,o.zero);case f.OperKind.String:return N(i,r,n,R.emptyStringOper);case f.OperKind.Boolean:return k(r,n,g.falseOper)}return(0,t.cmpInt)(r,n.kind-a.kind)}switch(n.kind){case f.OperKind.Number:return I(o,r,n,a);case f.OperKind.String:return N(i,r,n,a);case f.OperKind.Boolean:return k(r,n,a);case f.OperKind.Blank:return(0,t.cmpInt)(r,0);default:return!1}}(e,r,T,P));case p.OperatorId.Range:return function(e,t){const r=O("calc.runtime.applyRangeOp",e,t);if(null==r)return u.valueErrorOper;const n=(0,C.gridRangesJoin)(e.ranges),a=(0,C.gridRangesJoin)(t.ranges),i=[(0,A.gridRangeJoin)(n,a)];return(0,l.rangeSeqOper)(r,i)}(T,P);case p.OperatorId.Isect:return function(e,t){const r=O("calc.runtime.applyIsectOp",e,t);if(null==r)return u.valueErrorOper;const i=[];for(let r=0;r<e.ranges.length;r+=1)for(let n=0;n<t.ranges.length;n+=1){const a=(0,E.gridRangeIsect)(e.ranges[r],t.ranges[n]);null!=a&&i.push(a)}if(0===i.length){const r=`empty intersection, range1 = ${(0,n.anonymize)(e)}, range2 = ${(0,n.anonymize)(t)}`;return(0,a.traceErrorOper)("calc.runtime.applyIsectOp",s.ErrorType.NULL,r),c.nullErrorOper}return(0,l.rangeSeqOper)(r,i)}(T,P);case p.OperatorId.Union:return function(e,t){const r=O("calc.runtime.applyUnionOp",e,t);return null==r?u.valueErrorOper:(0,l.rangeSeqOper)(r,e.ranges.concat(t.ranges))}(T,P);case p.OperatorId.And:return(0,m.booleanOper)(T.value&&P.value);case p.OperatorId.Or:return(0,m.booleanOper)(T.value||P.value);case p.OperatorId.Xor:return(0,m.booleanOper)(T.value!==P.value);case p.OperatorId.Min:return F.cond2(T,P)<=0?T:P;case p.OperatorId.Max:return F.cond2(T,P)>=0?T:P;default:{const e=`calc.runtime.applyOperator: bad application of ${r} to 2 arguments`;return h.ulsLogger.ULS.assertTag(593372497,i.LogCategory.msoulscat_ES_EWAJS,!1,e)}}}const T=`calc.runtime.applyOperator: bad application of ${r} to ${S.length} arguments`;return h.ulsLogger.ULS.assertTag(593372498,i.LogCategory.msoulscat_ES_EWAJS,!1,T)}},7496:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runtimePositionFirstOrderFunc=t.runtimePositionFormulaRoot=t.runtimePositionEtaLambdaBody=t.runtimePositionLambdaParam=t.runtimePositionLambdaRoot=t.runtimePositionLetVal=t.breaked=t.paused=t.limitExceeded=t.previousNameFailure=t.previousFailure=t.cellCycle=t.nameCycle=t.evalLocals=t.evalGlobals=t.userDefinedFunc=t.stopped=t.cellFormula=t.cellWellFormedFormula=t.pendingValue=t.finalValue=t.illFormedFormula=t.LimitKind=t.StepAction=t.RuntimePositionKind=t.stackValue=t.Interrupt=t.CellKind=t.interval=t.compileLocalsName=t.compileLocalsGrid=t.createCompileGlobals=t.ReasonKind=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6067),s=r(6067),u=r(6067),l=r(3228),c=r(6366),d=r(6366),g=r(6366),m=r(6067);var h,p,f,S,v,F;!function(e){e.Timeout="Timeout",e.Breakpoint="Breakpoint",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"}(h||(h={})),t.ReasonKind={...o.ReasonKind,...h,...l.FormatReasonKind,...m.ResolveReasonKind},t.createCompileGlobals=function(e){return{config:e}},t.compileLocalsGrid=function(e,t,r){return{config:r??void 0,lexicalKind:e,originGridCell:(0,c.success)(t),allowUnqualifiedCell:!0,emitStepInfo:!1}},t.compileLocalsName=function(e,t){return{config:t??void 0,lexicalKind:u.LexicalKind.NameManager,originGridCell:(0,c.success)(e),allowUnqualifiedCell:!1,emitStepInfo:!1}},t.interval=(0,i.typedInstanceCreator)()(((e,t)=>((0,n.assertPositiveInteger)("calc.runtime.interval: end",t),(0,a.assertIndex)("calc.runtime.interval: start",e,t),{start:e,end:t}))),function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue"}(p||(t.CellKind=p={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(f||(t.Interrupt=f={})),t.stackValue=(0,i.typedInstanceCreator)()(((e,t)=>({label:e,value:t}))),function(e){e.LetVar="LetVar",e.LambdaRoot="LambdaRoot",e.LambdaParam="LambdaParam",e.EtaLambdaBody="EtaLambdaBody",e.FormulaRoot="FormulaRoot",e.FirstOrderFunc="FirstOrderFunc"}(S||(t.RuntimePositionKind=S={})),function(e){e.Continue="Continue",e.Break="Break"}(v||(t.StepAction=v={})),function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"}(F||(t.LimitKind=F={})),t.illFormedFormula=function(e,r,n){return{kind:t.ReasonKind.IllFormedFormula,message:e,mode:r,diagnostics:n}},t.finalValue=function(e){return{kind:p.FinalValue,oper:e}},t.pendingValue=function(e){return{kind:p.PendingValue,anchor:e}},t.cellWellFormedFormula=function(e,t){return{source:e,formula:t}},t.cellFormula=function(e,t){return{source:e,formula:t}},t.stopped={kind:t.ReasonKind.Stopped},t.userDefinedFunc=function(e,t){return{arity:e,func:t}},t.evalGlobals=function(e,t,r,n,a,i,o,u,l,c,d,m,h,p,S,v,F,y,b,C,A,E,T,R,k,N,I,O,P,M){return{config:e,getDocumentLoc:t,getSheetIndex:r,getSheetName:n,getSheetRangeIndexes:a,getNameLoc:i,getUserDefinedFuncLoc:o,getCellValue:u,getCellValues:l,getWorksheetFunc:c,getUserDefinedFunc:d,getNameFormula:m,getCellFormula:h,getUsedRange:p,interruptToken:[f.Continue],tryGetHiddenRows:S,tryGetHiddenCols:v,isInFilterMode:F,getKnownFormat:y,getIformat:b,getFormatString:C,getRandom:A,getTime:E,schedulerConfig:null!=P?P:{},limits:null!=M?M:{},setCellValue:T,setCellValues:R,setCellFailure:k,getContainingTable:N,getStructRefColumn:I,getStructRefSpecialRef:O,getIntersectingTables:()=>(0,g.failure)((0,s.notImplemented)(["getIntersectingTables"]))}},t.evalLocals=(0,i.typedInstanceCreator)()(((e,t,r,n,a,i,o,s,u,l,c)=>({lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:a,reflectionSheet:i,implicitIntersect:o,allowUnqualifiedCell:s,wrapCellReferences:u,followHyperlinks:l,contextNames:c}))),t.nameCycle=function(e){return{kind:t.ReasonKind.NameCycle,names:e}},t.cellCycle=function(e){return{kind:t.ReasonKind.CellCycle,cells:e}},t.previousFailure=function(e){return{kind:t.ReasonKind.PreviousFailure,range:e}},t.previousNameFailure=function(e){return{kind:t.ReasonKind.PreviousNameFailure,name:e}},t.limitExceeded=function(e){return{kind:t.ReasonKind.LimitExceeded,limit:e}},t.paused=function(e){return{kind:d.ResultKind.Paused,reason:t.ReasonKind.Timeout,resume:e}},t.breaked=function(e){return{kind:d.ResultKind.Breaked,resume:e}},t.runtimePositionLetVal=function(e,t){return{kind:S.LetVar,varNamePosition:e,varBinderPosition:t}},t.runtimePositionLambdaRoot=function(e,t,r){return{kind:S.LambdaRoot,lambdaNodePosition:e,head:t,args:r}},t.runtimePositionLambdaParam=function(e,t,r){return{kind:S.LambdaParam,idx:e,paramNodePosition:t,paramNamePosition:r}},t.runtimePositionEtaLambdaBody=function(e){return{kind:S.EtaLambdaBody,wsfId:e}},t.runtimePositionFormulaRoot={kind:S.FormulaRoot},t.runtimePositionFirstOrderFunc={kind:S.FirstOrderFunc}},3798:function(e,t,r){"use strict";var n,a;Object.defineProperty(t,"__esModule",{value:!0}),t.transformBottomUp=t.isOperTerm=t.postStepTerm=t.callMachineTerm=t.callFirstOrderFuncTerm=t.callLambdaTerm=t.callNameTerm=t.noopTerm=t.conditionalTerm=t.readStackTerm=t.structRefTerm=t.cellRefTerm=t.udfTerm=t.nameTerm=t.appTerm=t.letTerm=t.lambdaTerm=t.arrayTerm=t.isOperatorName=t.worksheetFunctionNameToId=t.worksheetFunctionIdToName=t.operatorNameToId=t.operatorIdToName=t.TermKind=void 0;const i=r(6366),o=r(6366),s=r(6366),u=r(6366),l=r(6366);var c;function d(e,t){return{kind:e,data:void 0,children:void 0,position:t}}function g(e,t,r,n){const a=d(c.Array,n);return a.children=r,a.data={rows:e,cols:t},a}function m(e,t,r,n){(0,u.assertTrue)("calc.runtime.lambdaTerm: defsAndBody",r.length===1+t.reduce(((e,t)=>e+(t.hasDef?1:0)),0)),(0,u.assertTrue)("calc.runtime.lambdaTerm: params",t.every(((e,t,r)=>!(e.hasDef&&e.isRest||e.isRest&&t!==r.length-1))));const a=d(c.Lambda,n);return a.children=r,a.data={checkArity:e,params:t},a}function h(e,t,r,n,a){(0,u.assertTrue)("calc.runtime.letTerm",e.length===r.length);const i=d(c.Let,a);return i.children=[...e,n],i.data={rec:t,varLabels:r},i}!function(e){e[e.Array=-2147483648]="Array",e[e.Lambda=-2147483647]="Lambda",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.Conditional=-2147483640]="Conditional",e[e.StructRef=-2147483639]="StructRef",e[e.Noop=-2147483638]="Noop",e[e.CallLambda=-2147483637]="CallLambda",e[e.CallName=-2147483636]="CallName",e[e.CallFirstOrderFunc=-2147483635]="CallFirstOrderFunc",e[e.CallMachine=-2147483634]="CallMachine",e[e.PostStep=-2147483633]="PostStep"}(c||(t.TermKind=c={})),n=(0,i.makeNewtypeIso)(o.identity,o.identity),t.operatorIdToName=n.wrap,t.operatorNameToId=n.unwrap,a=(0,i.makeNewtypeIso)((e=>-e),(e=>-e)),t.worksheetFunctionIdToName=a.wrap,t.worksheetFunctionNameToId=a.unwrap,t.isOperatorName=function(e){return e>0},t.arrayTerm=g,t.lambdaTerm=m,t.letTerm=h;const p=[];function f(e,t,r,n=p,a,i){const o=d(c.App,i);return o.children=a,o.data={funName:e,funType:t,isFormulaRoot:r,args:n},o}function S(e,t,r,n,a){const i=d(c.Name,a);return i.data={name:e,qualifier:t,source:r},i.children=n,i}function v(e,t,r,n){const a=d(c.Udf,n);return a.data={name:e,qualifier:t},a.children=r,a}function F(e,t,r,n,a,i){const o=d(c.Conditional,i);return o.children=[n,...a],o.data={funName:e,funType:t,isFormulaRoot:r,args:p},o}function y(e,t){const r=d(c.Noop,t);return r.children=e,r}function b(e){return e.kind>0}t.appTerm=f,t.nameTerm=S,t.udfTerm=v,t.cellRefTerm=function(e,t,r){const n=d(c.CellRef,r);return n.data={ref:e,qualifier:t},n},t.structRefTerm=function(e,t){const r=d(c.StructRef,t);return r.data=e,r},t.readStackTerm=function(e,t){const r=d(c.ReadStack,t);return r.data=e,r},t.conditionalTerm=F,t.noopTerm=y,t.callNameTerm=function(e,t,r){const n=d(c.CallName,r);return n.children=t,n.data={loc:e},n},t.callLambdaTerm=function(e,t,r,n,a){const i=d(c.CallLambda,void 0);return i.children=a,i.data={capturedLocals:e,capturedStackEnv:t,capturedStackMap:r,caller:n},i},t.callFirstOrderFuncTerm=function(e,t,r){const n=d(c.CallFirstOrderFunc,void 0);return n.children=r,n.data={source:e,caller:t},n},t.callMachineTerm=function(e,t){const r=d(c.CallMachine,t);return r.data={machine:e},r},t.postStepTerm=d(c.PostStep,void 0),t.isOperTerm=b,t.transformBottomUp=function(e,t){function r(e){if(b(e))return l.Pledge.resolve(e);switch(e.kind){case c.Let:return l.Pledge.all(e.children.map(n)).bind((t=>h(t.slice(0,t.length-1),e.data.rec,e.data.varLabels,t[t.length-1],e.position)));case c.App:return l.Pledge.all(e.children.map(n)).bind((t=>f(e.data.funName,e.data.funType,e.data.isFormulaRoot,e.data.args,t,e.position)));case c.Conditional:return l.Pledge.all(e.children.map(n)).bind((([t,...r])=>F(e.data.funName,e.data.funType,e.data.isFormulaRoot,t,r,e.position)));case c.Lambda:return l.Pledge.all(e.children.map(n)).bind((t=>m(e.data.checkArity,e.data.params,t,e.position)));case c.Array:return l.Pledge.all(e.children.map((e=>l.Pledge.all(e.map(n))))).bind((t=>g(e.data.rows,e.data.cols,t,e.position)));case c.Name:return(void 0===e.children?l.Pledge.resolve(void 0):n(e.children)).bind((t=>S(e.data.name,e.data.qualifier,e.data.source,t,e.position)));case c.Udf:return(void 0===e.children?l.Pledge.resolve(void 0):n(e.children)).bind((t=>v(e.data.name,e.data.qualifier,t,e.position)));case c.CellRef:case c.StructRef:case c.ReadStack:return l.Pledge.resolve(e);case c.Noop:return n(e.children).bind((t=>y(t,e.position)));default:return(0,s.assertNever)("calc.runtime.transformBottomUp",e)}}function n(e){return l.Pledge.resolve(e).bind(r).bind(t)}return l.Pledge.settleOrThrow(n(e))}},6880:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayLift=t.makeStrict=t.broadcastWriteOper=t.isEmptyStringOper=t.emptyStringOper=t.traceErrorOper=t.writeOperType=t.singleWriteOperType=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6366),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6366),S=r(9835),v=r(6067),F=r(6067),y=r(6366),b=r(6366),C=r(6067),A=r(6067);t.singleWriteOperType=v.OperKind.Number|v.OperKind.String|v.OperKind.Boolean|v.OperKind.Error|v.OperKind.Rich,t.writeOperType=t.singleWriteOperType|v.OperKind.Array,t.traceErrorOper=function(e,t,r){const n=`${e}: generated Excel error, type ${t}; ${r}`;b.ulsLogger.ULS.traceTag(596120270,C.LogCategory.msoulscat_ES_EWAJS,A.TraceLevel.Verbose,n)},t.emptyStringOper=(0,c.stringOper)(""),t.isEmptyStringOper=function(e){return(0,p.isStringOper)(e)&&""===e.value},t.broadcastWriteOper=function(e,t,r){const i=(0,g.isArrayOper)(r)?(0,a.broadcastArray)(r.rows,r.cols,e,t,r.opers,u.naErrorOper):(0,n.constantArray)(e,t,r);return(0,l.arrayOper)(e,t,i)},t.makeStrict=function(e){const t=e=>e&~(v.OperKind.Array|v.OperKind.Range);return(0,F.functionType)(e.minArgs,e.maxArgs,e.headTypes.map(t),e.restTypes.map(t),e.tailTypes.map(t),e.returnType,e.staticPrecs,e.flags)},t.arrayLift=function(e,t,r,n){let a=0,l=0;for(let e=0;e<n.length;e+=1){const r=n[e];(0,g.isArrayOper)(r)&&0==((0,d.getArgType)(t,e,n.length)&v.OperKind.Array)?(a=(0,f.fastMax)(a,r.rows),l=(0,f.fastMax)(l,r.cols)):(a=(0,f.fastMax)(a,1),l=(0,f.fastMax)(l,1))}const c=n.map(((r,n,c)=>function(e,t,r,n,a){switch(n.kind){case v.OperKind.Missing:case v.OperKind.Blank:return(0,i.constantArray2D)(t,r,e.zero);case v.OperKind.Array:return 0!=(a&v.OperKind.Array)?(0,i.constantArray2D)(t,r,n):(0,o.broadcastArray2D)(t,r,new s.StrictArray2D(n.rows,n.cols,n.opers),u.naErrorOper);case v.OperKind.Range:default:return(0,i.constantArray2D)(t,r,n)}}(e.mathpack,a,l,r,(0,d.getArgType)(t,n,c.length))));return(0,S.machineCall)(new S.ArrayMachine(e,a,l,((e,t)=>r(c.map((r=>r.get(e,t))))),(t=>{const r=e.coerceOper((0,S.refToVal)(e,t,!0),S.readOperType);return(0,y.assertTrue)("calc.runtime.arrayLift",!(0,m.isMissingOper)(r)&&!(0,h.isRangeOper)(r)),(0,g.isArrayOper)(r)?r.opers[0][0]:r})))}},1819:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LambdaOper=t.RecordOper=void 0;const n=r(6067),a=r(6067);t.RecordOper=class{getFallback(){return this._fallback}getField(e){return this._fields.getValue(e)}constructor(e,t=n.valueErrorOper){this._fields=e,this._fallback=t,this.kind=a.OperKind.Rich}},t.LambdaOper=class{getFallback(){return n.valueErrorOper}getField(e){}constructor(e,t,r,n,i,o,s){this.checkArity=e,this.lambdaNodeLabel=t,this.params=r,this.locals=n,this.stackEnv=i,this.stackMap=o,this.defsAndBody=s,this.kind=a.OperKind.Rich}}},4488:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recordNameCycle=t.appendVisitedName=t.emptyVisitedNames=t.recordCellCycle=t.appendVisitedCell=t.emptyVisitedCells=void 0;const n=r(6366),a=r(7496),i=r(6366);function o(e,t,r){return void 0===e?void 0===t?0:-1:void 0===t?1:r(e,t)}function s(e,t){return e<t?-1:e===t?0:1}function u(e,t){return"string"==typeof e?"string"!=typeof t?1:s(e,t):"string"==typeof t||e<t?-1:e===t?0:1}function l(e,t){let r;return 0!==(r=s(e.name,t.name))?r:o(e.path,t.path,s)}function c(e,t){return{current:e,map:t}}function d(e,t){return{current:e,map:t}}t.emptyVisitedCells=c(void 0,n.RedBlackMapTree.create((function(e,t){let r;return 0!=(r=e.range.col-t.range.col)||0!=(r=e.range.row-t.range.row)||0!==(r=u(e.sheet.index,t.sheet.index))?r:l(e.sheet.document,t.sheet.document)}))),t.appendVisitedCell=function(e,t){return(0,i.assertTrue)("calc.runtime.appendVisitedCell",t.previous===e.current),c(t,e.map.setValue(t.cell,t))},t.recordCellCycle=function(e,t){const r=[],n=(0,a.cellCycle)(r);for(let a=t;r.push(a.cell),a.cycle=n,a!==e;a=a.previous);return r.reverse(),n},t.emptyVisitedNames=d(void 0,n.RedBlackMapTree.create((function(e,t){let r;return 0!==(r=s(e.name,t.name))||0!==(r=o(e.scope.index,t.scope.index,u))?r:l(e.scope.document,t.scope.document)}))),t.appendVisitedName=function(e,t){const r={name:t,previous:e.current};return d(r,e.map.setValue(t,r))},t.recordNameCycle=function(e,t){const r=[];for(let n=t;r.push(n.name),n!==e;n=n.previous);return r.reverse(),(0,a.nameCycle)(r)}},9176:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=void 0;const n=r(6240),a=r(9679),i=r(3106);t.createAnalyzer=function(e){return{checkFormula:(t,r)=>(0,n.checkFormula)(e,t,r),checkFormulaWithDiagnostics:(t,r)=>(0,n.checkFormulaWithDiagnostics)(e,t,r),autocorrectFormula:(t,r)=>(0,a.autocorrectFormula)(e,t,r),resolveStaticPrecedents:(t,r)=>(0,i.resolveStaticPrecedents)(e,t,r)}}},9679:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocorrectFormula=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(6067),E=r(6067),T=r(6366),R=r(6366),k=r(6366),N=r(6366),I=r(6366),O=r(6366),P=r(6067),M=r(6067),D=r(6067),w=r(6067),L=r(6067),_=r(6067),x=r(6067),K=r(6067),W=r(6067),U=r(6067),G=r(6067),B=r(6067),V={getDocumentLoc:()=>(0,T.assertFalse)("calc.analyze.autocorrectFormula: default getDocumentLoc"),getSheetIndex:()=>(0,T.assertFalse)("calc.analyze.autocorrectFormula: default getSheetIndex"),getSheetName:()=>(0,T.assertFalse)("calc.analyze.autocorrectFormula: default getSheetName"),getNameLoc:()=>(0,T.assertFalse)("calc.analyze.autocorrectFormula: default getNameLoc"),getUserDefinedFuncLoc:()=>(0,T.assertFalse)("calc.analyze.autocorrectFormula: default getUserDefinedFuncLoc"),getSheetRangeIndexes:()=>(0,T.assertFalse)("calc.analyze.autocorrectFormula: default getSheetRangeIndexes"),getContainingTable:()=>(0,T.assertFalse)("calc.analyze.autocorrectFormula: default getContainingTable"),getStructRefColumn:()=>(0,T.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefColumn"),getStructRefSpecialRef:()=>(0,T.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefSpecialRef")},j=(0,A.createFailureErrorClass)("AutocorrectError"),H={...(0,P.binaryVisitor)((0,M.constVisitor)(!1),((e,t)=>e||t)),badSequenceNode:(e,t,r)=>!0,badCharsNode:(e,t,r)=>!0};class q extends D.IdentityVisitor{autocorrect(){return(0,w.reduceBottomUp)(H,this.f)?this.f.node:(0,w.reduceBottomUp)(this,this.f)}literalNode(e,t,r){return t||(this.seenUnclosed=!0),!this.locals.allowUnqualifiedCell&&e.kind===G.OperKind.Error&&e.type===B.ErrorType.REF&&this.qualifyCellRef()?(0,s.cellRefNode)((0,b.cellRefError)(),this.qualifyCellRef(),r):(0,g.literalNode)(e,t,r)}nameNode(e,t,r){const n=(0,m.nameNode)(e,t,r),a=(0,p.flattenNameParts)(e).parts,i={...this.locals,allowUnqualifiedCell:!0},{headResolved:o,fieldsResolved:s}=this.resolver.resolveDottedName(i,n,this.f.annotations);if((0,x.canDenoteCellRef)(i,t,a)){const[e,t,...r]=a;if(o.kind===L.ResolvedKind.ResolvedCellRef){const{ref:n,qualifier:i,label:u}=o.node,{ref:l,qualifier:c}=this.cellRefNode(n,i,u);(0,R.assertTrue)("calc.analyze.autocorrectFormula: resolved CellRefKind correct",n.kind===e.ref.kind),(0,R.assertTrue)("calc.analyze.autocorrectFormula: autocorrect doesn't change CellRefKind",l.kind===n.kind),(0,R.assertTrue)("calc.analyze.autocorrectFormula: autocorrect doesn't generate ErrorQualifier",c?.kind!==F.QualifierKind.Error),(0,R.assertTrue)("calc.analyze.autocorrectFormula: all flattened field parts resolved",a.length===1+s.length);const d=(e,{rhs:t,canDenoteNamedObject:r,label:n,qualifiedLabel:a})=>(0,S.fieldRefNamePart)(e,t,r,n,a);return(0,m.nameNode)(r.reduce(d,d((0,f.cellRefNamePart)(l,e.asWhole,e.label,e.qualifiedLabel),t)),c,u)}this.throwIfResolutionUnknown(o.resolution)}if(this.locals.allowRelativeQualifier&&void 0===t){if(o.kind===L.ResolvedKind.ResolvedName&&(0,N.isSuccess)(o.resolution)&&o.resolution.value&&void 0!==o.resolution.value.scope.index)return(0,m.nameNode)(e,this.qualifySheetName(o.resolution.value.scope),r);this.throwIfResolutionUnknown(o.resolution)}if(t&&(t.kind===F.QualifierKind.Sheet||t.kind===F.QualifierKind.Ident)){if(o.kind===L.ResolvedKind.ResolvedName&&(0,N.isSuccess)(o.resolution)&&o.resolution.value&&void 0===o.resolution.value.scope.index&&o.qualifierResolution===F.QualifierKind.Sheet)return(0,m.nameNode)(e,this.qualifyBookName(o.resolution.value.scope),r);this.throwIfResolutionUnknown(o.resolution)}return n}arrayNode(e,t,r){return t||(this.seenUnclosed=!0),(0,i.arrayNode)(e,t,r)}appNode(e,t,r,n){const i=this.appNodeBase(e,r,n);return r||(this.seenUnclosed=!0),(0,C.isOperatorNode)(e)||(this.seenParen=!0),(0,C.isOperatorNode)(e)&&t.some(E.isMissingNode)&&(this.seenMissingOperand=!0),(0,a.appNode)(e,t,i,n)}letNode(e,t,r,n,a,i){const o=this.appNodeBase(e,a,i);return a||(this.seenUnclosed=!0),this.seenParen=!0,(0,c.letNode)(e,t,r,n,o,i)}lambdaNode(e,t,r,n,a,i){const o=this.appNodeBase(e,a,i);return a||(this.seenUnclosed=!0),this.seenParen=!0,(0,d.lambdaNode)(e,t,r,n,o,i)}parenNode(e,t,r){return t||(this.seenUnclosed=!0),this.seenParen=!0,(0,o.parenNode)(e,t,r)}cellRefNode(e,t,r){return e.isBracketed&&"("===this.localeInfo.rcLeftBracket&&(this.seenParen=!0),this.locals.allowUnqualifiedCell||void 0!==t?(0,s.cellRefNode)(e,t,r):(0,s.cellRefNode)(e,this.qualifyCellRef(),r)}fieldRefNode(e,t,r){return t.isClosed||(this.seenUnclosed=!0),(0,l.fieldRefNode)(e,t,r)}structRefNode(e,t,r){if(t.isClosed||(this.seenUnclosed=!0),void 0!==e&&e.qualifier){const{resolution:n,qualifierResolution:a}=this.resolver.resolveName(this.locals,e,W.NameSource.StructRef);if((0,N.isSuccess)(n)&&n.value&&a===F.QualifierKind.Sheet)return(0,h.structRefNode)((0,m.nameNode)(e.parts,void 0,e.label),t,r);this.throwIfResolutionUnknown(n)}return(0,h.structRefNode)(e,t,r)}qualifyCellRef(){const e=this.locals.originSheet;if(!(0,N.isSuccess)(e))throw new j(e.reason);if(void 0===e.value.index)return;const t=this.globals.getSheetName(e.value.document,e.value.index);if(!(0,N.isSuccess)(t))throw new j(t.reason);return(0,u.sheetQualifier)(t.value,void 0,(0,U.shouldQuoteQualifier)(this.localeInfo,this.refStyle,t.value))}qualifySheetName(e){const t=this.globals.getSheetName(e.document,e.index);if(!(0,N.isSuccess)(t))throw new j(t.reason);return(0,u.sheetQualifier)(t.value,void 0,(0,U.shouldQuoteQualifier)(this.localeInfo,this.refStyle,t.value))}qualifyBookName({document:e}){return(0,y.identQualifier)(e.name,(0,U.shouldQuoteQualifier)(this.localeInfo,this.refStyle,e.name))}appNodeBase(e,t,r){return t||!(0,C.isOperatorNode)(e)&&this.isFormulaRoot(r)&&!this.seenParen&&!this.seenUnclosed&&!this.seenMissingOperand}isFormulaRoot(e){return this.f.annotations[e]?.kind===v.AnnotationKind.FormulaRoot}throwIfResolutionUnknown(e){if(!(0,N.isSuccess)(e)&&e.reason.kind!==_.ResolveReasonKind.NoOriginSheet&&e.reason.kind!==_.ResolveReasonKind.InvalidQualifier&&e.reason.kind!==_.ResolveReasonKind.InvalidCellRef&&e.reason.kind!==_.ResolveReasonKind.InvalidStructRef&&e.reason.kind!==_.ResolveReasonKind.EmptyIntersection)throw new j(e.reason)}constructor(e,t,r){super(),this.f=r,this.seenUnclosed=!1,this.seenParen=!1,this.seenMissingOperand=!1;const n=function(e){return{config:e.config,getDocumentLoc:e.getDocumentLoc?.bind(e)??V.getDocumentLoc,getSheetIndex:e.getSheetIndex?.bind(e)??V.getSheetIndex,getSheetName:e.getSheetName?.bind(e)??V.getSheetName,getNameLoc:e.getNameLoc?.bind(e)??V.getNameLoc,getUserDefinedFuncLoc:e.getUserDefinedFuncLoc?.bind(e)??V.getUserDefinedFuncLoc,getSheetRangeIndexes:e.getSheetRangeIndexes?.bind(e)??V.getSheetRangeIndexes,getContainingTable:e.getContainingTable?.bind(e)??V.getContainingTable,getStructRefColumn:e.getStructRefColumn?.bind(e)??V.getStructRefColumn,getStructRefSpecialRef:e.getStructRefSpecialRef?.bind(e)??V.getStructRefSpecialRef}}(e);this.globals=n,this.locals=t,this.resolver=(0,K.createResolver)(n),this.localeInfo=t.config?.localeInfo??e.config.localeInfo,this.refStyle=t.config?.refStyle??e.config.refStyle}}t.autocorrectFormula=function(e,t,r){try{const{spans:a,annotations:i,depthUpperBound:o}=r,s=new q(e,t,r).autocorrect();return(0,O.success)((0,n.formula)(s,a,i,o))}catch(e){return e instanceof j?(0,k.failure)(e.reason):(0,k.failure)((0,I.javaScriptError)(e))}}},6240:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkFormula=t.checkFormulaWithDiagnostics=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6366),u=r(6366),l=r(7247),c=r(6366),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(6067),E=r(6067),T=r(6067),R=r(6067),k=r(6067),N=r(6067),I=r(6067),O=r(6067),P=r(6067),M=r(6067),D=r(6067),w=r(6067),L=r(6067),_=r(6067),x=r(6366),K=r(6366),W=r(6366),U=r(6067),G=r(6366),B=r(6067),V=r(6067),j=r(6067),H={};function q(e,t){return{context:e,result:t}}const z=b.OperKind.String|b.OperKind.Boolean|b.OperKind.Error,Q=($=e=>0!=(e.kind&z),e=>e.kind===E.NodeKind.Literal&&$(e.oper));var $;function Y(e,t,r,n=!1){n||(e.errorData=e.reportError(t,r,e.errorData))}function J(e,t){return t!==b.OperKind.Range||0!=(e&b.OperKind.Range)}function X(e,t){if(t.kind===E.NodeKind.Literal)switch(Y(e,t,l.baseErrors.Unclosed_literal,t.isClosed),t.oper.kind){case b.OperKind.Number:case b.OperKind.Boolean:case b.OperKind.String:case b.OperKind.Error:return;case b.OperKind.Missing:break;default:return(0,n.assertNever)("calc.analyze.checker.checkArrayElement: literal kind",t.oper)}Y(e,t,l.baseErrors.Illegal_array_literal_element)}function Z(e,t,r,n,i){return G.Pledge.try((()=>{if(e.earlyExit&&!e.isOk())throw H;return ne(e,t,i)})).bind((i=>(J(i.result,r)||((0,a.assertTrue)("calc.analyze.checker.check: typeSource passed",void 0!==n),Y(e,t,{kind:l.TypeError.Types_not_related,typeGiven:i.result,typeExpected:r,typeSource:n})),i.result=r,i)))}function ee(e,t,r){if(r.kind===E.NodeKind.Ident){const n=(0,S.getBoundName)(e.localeInfo,r.whole);return Y(e,r,l.baseErrors.Invalid_binder,n.indexOf(".")<0),Y(e,r,l.baseErrors.Duplicate_binder,!t.contains(n)),t.setValue(n,!0)}return Y(e,r,r.kind===E.NodeKind.Missing?l.baseErrors.Missing_binder:l.baseErrors.Invalid_binder),t}const te=e=>0===e.args.length?e:e.args[e.args.length-1];function re(e,t){return G.Pledge.try((()=>(Y(e,t,l.baseErrors.Unclosed_application,t.isClosed),(0,p.isWSFNode)(t.head)?function(e,t){return G.Pledge.try((()=>{const r=t.head.id,n=(0,L.getWorksheetFuncType)(r),{minArgs:i,maxArgs:u,headTypes:d,restTypes:h,tailTypes:p,flags:f}=n,S=t.args,v=S.length,y=(0,m.getArguments)(t.args).length;if(Y(e,t.head,l.baseErrors.Invalid_function_name,(0==(f&A.FunctionFlags.OnlyParsedDuringLoad)||e.locals.workbookLoad)&&0==(f&A.FunctionFlags.Chart)&&(0==(f&A.FunctionFlags.Macro)||e.locals.lexicalKind===U.LexicalKind.NameManager)),y<i)switch(r){case w.WorksheetFuncId.IF:case w.WorksheetFuncId.LET:case w.WorksheetFuncId.LETREC:case w.WorksheetFuncId.LAMBDA:break;default:const n=S[v-1];Y(e,void 0===n?t:n,{kind:l.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:y,numArgsExpected:i})}if(y>u){const n=S[v-1];Y(e,void 0===n?t:n,{kind:l.TypeError.Excess_function_arguments,funcId:r,numArgsGiven:y,numArgsExpected:u})}else if(h.length>1&&y>d.length+h.length){const n=(y-d.length)%h.length;n>p.length&&Y(e,te(t),{kind:l.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:y,numArgsExpected:y+(h.length-n)})}let b;if(t.kind===E.NodeKind.App)b=(0,m.getArguments)(t.args).map(((t,a)=>Z(e,t,(0,g.getArgType)(n,a,y),{kind:l.TypeSourceKind.WSFArgument,funcId:r,argIndex:a,numArgsGiven:y})));else if(t.kind===E.NodeKind.Let)b=[...t.vars.map((({binder:e})=>e.arg)),...t.body?[t.body.arg]:[]].map((t=>ne(e,t)));else{const r=t.params.map((({name:e})=>e.arg.def?.rhs)).filter(s.isDefined),n=t.body?[t.body.arg]:[];b=[...r.map((t=>ne(e,t,l.baseErrors.Missing_default_expression))),...n.map((t=>ne(e,t)))]}return G.Pledge.all(b).bind((r=>(function(e,t){const r=t.head.id,n=(0,m.getArguments)(t.args).length;switch(r){case w.WorksheetFuncId.IF:const i=e.locals.lexicalKind===U.LexicalKind.NameManager?1:2;return void(n<i&&Y(e,te(t),{kind:l.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:n,numArgsExpected:i}));case w.WorksheetFuncId._UDF:return Y(e,t,l.baseErrors.Unexpected_application_head);case w.WorksheetFuncId.LET:case w.WorksheetFuncId.LETREC:{(0,a.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",t.kind===E.NodeKind.Let);let i=c.RedBlackMapTree.create(e.localeInfo.stringCompareCI);for(const{name:r}of t.vars)i=ee(e,i,r.arg.name);for(const r of t.badArgs)Y(e,r.arg,l.baseErrors.Invalid_binder);Y(e,te(t),{kind:l.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:n,numArgsExpected:(0,o.fastMax)(3,n+1+n%2)},n>=3&&void 0!==t.body);break}case w.WorksheetFuncId.LAMBDA:{(0,a.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",t.kind===E.NodeKind.Lambda);let i=c.RedBlackMapTree.create(e.localeInfo.stringCompareCI),o=!1;for(const{name:r}of t.params)Y(e,r.arg.name,l.baseErrors.Unclosed_bracket,r.arg.name.isClosed),void 0!==r.arg.def&&Y(e,r.arg.name,l.baseErrors.Binder_requires_brackets,r.arg.name.isBracketed),r.arg.isOptional?o=!0:Y(e,r.arg,l.baseErrors.Mandatory_binder_after_optional,!o),i=ee(e,i,r.arg.name.name);for(const r of t.badArgs)Y(e,r.arg,l.baseErrors.Invalid_binder);n>=1&&void 0!==t.body?void 0!==t.body&&(0,F.isMissingLiteralNode)(t.body.arg)&&Y(e,t.body.arg,l.baseErrors.Invalid_body):Y(e,te(t),{kind:l.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:n,numArgsExpected:n+1});break}}}(e,t),q(e,n.returnType))))}))}(e,t):(0,d.isOperatorNode)(t.head)?function(e,t){return G.Pledge.try((()=>{const{head:r,args:n}=t,a=r.id,i=(0,D.getOperatorType)(a),o=n.length,s=o===i.minArgs;return Y(e,r,{kind:l.TypeError.Incorrect_number_of_operator_arguments,opId:a},s),G.Pledge.all(n.map(((t,r)=>G.Pledge.try((()=>Z(e,t,(0,g.getArgType)(i,r,o),{kind:l.TypeSourceKind.OperatorArgument,opId:a,argIndex:r,numArgsGiven:o},{kind:l.SyntaxError.Missing_operation_argument,opId:a})))))).bind((t=>s&&!n.some(v.isMissingNode)?q(e,i.returnType):q(e,C.SignatureType.All)))}))}(e,t):function(e,t){return G.Pledge.try((()=>{const r=t.head,n=t.args,a=n.length,i=(0,m.getArguments)(n).length,o=n[a-1],s=(0,_.higherOrderFunctionType)().maxArgs-1;return i>s&&Y(e,void 0===o?t:o,{kind:l.SyntaxError.Excess_higher_order_function_arguments,numArgsGiven:i,numArgsExpected:s}),G.Pledge.all(n.map((t=>Z(e,t,C.SignatureType.All,void 0)))).bind((t=>ne(e,r).bind((t=>(J(t.result,b.OperKind.Range)||0!=(t.result&(b.OperKind.Array|b.OperKind.Rich))||Y(e,r,Q(r)||r.kind===E.NodeKind.Array?l.baseErrors.Unexpected_application_head:l.baseErrors.Unexpected_application_head_with_fix),q(e,C.SignatureType.All))))))}))}(e,t))))}function ne(e,t,r,a=!1){return G.Pledge.try((()=>{if(e.earlyExit&&!e.isOk())throw H;switch(t.kind){case E.NodeKind.App:case E.NodeKind.Let:case E.NodeKind.Lambda:return re(e,t);case E.NodeKind.Array:return function(e,t){return G.Pledge.try((()=>{Y(e,t,l.baseErrors.Unclosed_array,t.isClosed);const r=t.nodes.length>0&&!(1===t.nodes.length&&1===t.nodes[0].length&&(0,v.isMissingNode)(t.nodes[0][0]));if(Y(e,t,l.baseErrors.Empty_array_literal,r),!r)return q(e,b.OperKind.Array);const n=t.nodes[0].length;for(let r=0;r<t.nodes.length;r+=1){const a=t.nodes[r],i=a.length;Y(e,t,l.baseErrors.Irregular_array_shape,i===n);for(let t=0;t<i;t+=1)X(e,a[t])}return q(e,b.OperKind.Array)}))}(e,t);case E.NodeKind.BadChars:case E.NodeKind.BadSequence:return function(e,t){return G.Pledge.try((()=>{if(t.kind===E.NodeKind.BadSequence){switch(t.type){case T.BadType.Unexpected:Y(e,t,l.baseErrors.Bad_node,t.contents.some((e=>e.kind===E.NodeKind.BadChars||e.kind===E.NodeKind.BadSequence)));break;case T.BadType.StructRef:Y(e,t.contents[0]??t,l.baseErrors.Invalid_struct_ref_table_name);break;case T.BadType.FieldRef:return void Y(e,t,l.baseErrors.Unexpected_field_ref)}return G.Pledge.all(t.contents.map((t=>ne(e,t))))}switch(t.type){case T.BadType.Unexpected:switch(t.chars){case")":return Y(e,t,l.baseErrors.Unexpected_closing_paren);case e.localeInfo.rightBrace:return Y(e,t,l.baseErrors.Unexpected_closing_brace);case e.localeInfo.rightBracket:return Y(e,t,l.baseErrors.Unexpected_closing_bracket);case".":return Y(e,t,l.baseErrors.Unexpected_dot);default:return Y(e,t,{kind:l.SyntaxError.Unexpected_character,text:t.chars})}case T.BadType.NumberLiteral:return Y(e,t,l.baseErrors.Invalid_number_literal);case T.BadType.StringLiteral:return Y(e,t,l.baseErrors.Invalid_string_literal);case T.BadType.ErrorLiteral:return Y(e,t,l.baseErrors.Invalid_error_literal);case T.BadType.FieldName:case T.BadType.ParamName:return Y(e,t,l.baseErrors.Bad_node);case T.BadType.Qualifier:return Y(e,t,l.baseErrors.Invalid_qualifier);default:(0,n.assertNever)("calc.analyze.diagnoseBadNode",t)}}))}(e,t).bind((()=>q(e,C.SignatureType.All)));case E.NodeKind.Missing:return!1!==r&&Y(e,t,r??l.baseErrors.Bad_node),q(e,C.SignatureType.All);case E.NodeKind.CellRef:return e.locals.allowRelativeQualifier||t.qualifier?.kind!==R.QualifierKind.Relative?e.locals.allowUnqualifiedCell||void 0!==t.qualifier?t.qualifier?.kind===R.QualifierKind.Document||t.qualifier?.kind===R.QualifierKind.Bad?(Y(e,t,l.baseErrors.Invalid_qualifier),q(e,C.SignatureType.All)):t.ref.kind===O.CellRefKind.Bad?(Y(e,t,l.baseErrors.Invalid_cell_ref),q(e,C.SignatureType.All)):q(e,b.OperKind.Range):(Y(e,t,l.baseErrors.Invalid_unqualified_cell),q(e,C.SignatureType.All)):(Y(e,t,l.baseErrors.Invalid_rel_sheet_qualifier_in_cell),q(e,C.SignatureType.All));case E.NodeKind.Literal:return Y(e,t,l.baseErrors.Unclosed_literal,t.isClosed),(0,h.isErrorOper)(t.oper)&&Y(e,t,l.baseErrors.Invalid_error_literal,!((i=t.oper.type)>M.ErrorType.GETTING_DATA&&i!==M.ErrorType.BUSY&&i!==M.ErrorType.EXTERNAL)),q(e,t.oper.kind|((0,h.isErrorOper)(t.oper)&&t.oper.type===M.ErrorType.REF?b.OperKind.Range:0));case E.NodeKind.Name:{const{qualifier:r}=t;if((a||!e.locals.allowRelativeQualifier)&&r?.kind===R.QualifierKind.Relative)return Y(e,t,l.baseErrors.Invalid_rel_sheet_qualifier_in_name),q(e,C.SignatureType.All);if(!e.locals.workbookLoad&&r?.kind===R.QualifierKind.Document&&!r.isQuoted)return Y(e,t,l.baseErrors.Invalid_qualifier),q(e,C.SignatureType.All);if(r?.kind===R.QualifierKind.SheetRange||r?.kind===R.QualifierKind.Bad)return Y(e,t,l.baseErrors.Invalid_qualifier),q(e,C.SignatureType.All);const n=(0,N.flattenNameParts)(t.parts).parts,i=e.annotations[n[0].label],o=e.annotations[t.label],s=o?.kind===I.AnnotationKind.AppHeadName;return i?.kind===I.AnnotationKind.LocalNameUse?Y(e,t,l.baseErrors.Invalid_name,(0,V.canDenoteLocalName)(r,n)):Y(e,t,a?l.baseErrors.Invalid_struct_ref_table_name:l.baseErrors.Invalid_name,t.parts.canDenoteNamedObject||(0,j.canDenoteUserDefinedFunc)(s,r,t.parts)||(0,B.canDenoteCellRef)(e.locals,r,n)),q(e,C.SignatureType.All)}case E.NodeKind.Paren:return Y(e,t,l.baseErrors.Unclosed_paren,t.isClosed),Y(e,t,l.baseErrors.Empty_parenthesis,!(0,v.isMissingNode)(t.node)),ne(e,t.node,!1);case E.NodeKind.FieldRef:return Y(e,t,l.baseErrors.Unclosed_bracket,t.rhs.isClosed),Y(e,t,l.baseErrors.Unexpected_field_ref,!(0,v.isMissingNode)(t.lhs)&&!(0,y.isNumberLiteralNode)(t.lhs)),t.rhs.field.kind!==E.NodeKind.Ident&&Y(e,t.rhs.field,t.rhs.field.kind===E.NodeKind.Missing?l.baseErrors.Missing_field_name:l.baseErrors.Invalid_field_name),ne(e,t.lhs,!1).bind((t=>q(e,C.SignatureType.All)));case E.NodeKind.StructRef:if(Y(e,t,l.baseErrors.Missing_struct_ref_table_name,void 0!==t.lhs||e.locals.allowImplicitTable),void 0===t.rhs.innerRef);else{const r=t=>{switch(t?.kind){case void 0:break;case k.StructRefKind.RangeOpRef:r(t.lhs),r(t.rhs);break;case k.StructRefKind.CommaOpRef:Y(e,t,l.baseErrors.Invalid_struct_ref_comma_parts,(0,f.isCommaOpRefWellFormed)(t)),t.refs.forEach(r);break;case k.StructRefKind.SpecialRef:case k.StructRefKind.ColumnRef:Y(e,t,l.baseErrors.Unclosed_bracket,t.isClosed);break;case k.StructRefKind.ThisRowOpRef:r(t.ref);break;case k.StructRefKind.MissingRef:Y(e,t,l.baseErrors.Invalid_struct_ref_missing_part);break;case k.StructRefKind.BadRef:Y(e,t,l.baseErrors.Unclosed_bracket,t.isClosed),Y(e,t,l.baseErrors.Invalid_struct_ref_bad_part)}};r(t.rhs.innerRef)}return Y(e,t,l.baseErrors.Unclosed_bracket,t.rhs.isClosed),(void 0===t.lhs?G.Pledge.resolve(void 0):ne(e,t.lhs,void 0,!0)).bind((t=>q(e,C.SignatureType.All)));default:return(0,n.assertNever)("calc.analyze.checker.infer: unhandled formula case",t)}var i}))}const ae={ok:!0,isOk:i.identity,collect:(e,t,r)=>!1};function ie(e,t,{annotations:r},n,a=!0){const i={globals:e,locals:t,localeInfo:t.config?.localeInfo??e.config.localeInfo,annotations:r,reportError:n.collect,isOk:()=>n.isOk(i.errorData),earlyExit:a,errorData:n.ok};return i}function oe(e,t){try{const r=G.Pledge.settleOrThrow(Z(e,t.node,C.SignatureType.All,void 0,l.baseErrors.Empty_formula));return function(e,t){const r=t.annotations[t.node.label];function a(t){for(const r of t)Y(e,r,l.baseErrors.Unclosed_comment,r.isClosed)}function i(e){const r=t.spans[e];null!=r&&(r.preComments&&a(r.preComments),r.postComments&&a(r.postComments))}r?.kind===I.AnnotationKind.FormulaRoot&&void 0!==r.syntaxFeatures&&r.syntaxFeatures[P.SyntaxFeature.Comments]&&G.Pledge.settleOrThrow(function e(t){return G.Pledge.try((()=>{switch(i(t.label),t.kind){case E.NodeKind.Literal:case E.NodeKind.Missing:case E.NodeKind.BadChars:break;case E.NodeKind.App:case E.NodeKind.Let:case E.NodeKind.Lambda:return t.head.kind===E.NodeKind.Operator&&i(t.head.label),G.Pledge.all(t.args.map(e));case E.NodeKind.Array:return G.Pledge.all((0,u.safeConcat)([],t.nodes.map((t=>t.map(e)))));case E.NodeKind.BadSequence:return G.Pledge.all(t.contents.map(e));case E.NodeKind.CellRef:case E.NodeKind.Name:t.qualifier&&i(t.qualifier.label);break;case E.NodeKind.Paren:return e(t.node);case E.NodeKind.FieldRef:return i(t.rhs.label),i(t.rhs.field.label),e(t.lhs);case E.NodeKind.StructRef:return t.lhs?e(t.lhs):void 0;case E.NodeKind.Var:i(t.name.label);break;case E.NodeKind.Param:if(i(t.name.label),i(t.name.name.label),t.def)return i(t.def.label),e(t.def.rhs);break;default:return(0,n.assertNever)("calc.analyze.checker.comments",t)}}))}(t.node))}(e,t),r}catch(t){if(t===H)return q(e,C.SignatureType.All);throw t}}t.checkFormulaWithDiagnostics=function(e,t,r){try{const n=oe(ie(e,t,r,{ok:void 0,isOk:e=>void 0===e,collect:(e,t,r)=>{const n=r??[];return(n[e.label]??(n[e.label]=[])).push(t),n}},!1),r).context.errorData,a={...r,isWellFormed:void 0===n};return(0,W.success)([a,n])}catch(e){return(0,x.failure)((0,K.javaScriptError)(e))}},t.checkFormula=function(e,t,r){try{const n=oe(ie(e,t,r,ae),r).context.errorData;return(0,W.success)({...r,isWellFormed:n})}catch(e){return(0,x.failure)((0,K.javaScriptError)(e))}}},7247:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatDiagnostic=t.baseErrors=t.TypeSourceKind=t.TypeError=t.SyntaxError=void 0;const n=r(6067),a=r(6067),i=r(6366);var o,s,u;!function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_bracket="Unclosed_bracket",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Unclosed_comment="Unclosed_comment",e.Invalid_number_literal="Invalid_number_literal",e.Invalid_string_literal="Invalid_string_literal",e.Invalid_error_literal="Invalid_error_literal",e.Invalid_function_name="Invalid_function_name",e.Invalid_name="Invalid_name",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_operation_argument",e.Bad_node="Bad_node",e.Invalid_qualifier="Invalid_qualifier",e.Invalid_cell_ref="Invalid_cell_ref",e.Invalid_binder="Invalid_binder",e.Missing_binder="Missing_binder",e.Duplicate_binder="Duplicate_binder",e.Invalid_body="Invalid_body",e.Mandatory_binder_after_optional="Mandatory_binder_after_optional",e.Missing_default_expression="Missing_default_expression",e.Binder_requires_brackets="Binder_requires_brackets",e.Invalid_field_name="Invalid_field_name",e.Missing_field_name="Missing_field_name",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Invalid_unqualified_cell="Invalid_unqualified_cell",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unexpected_character="Unexpected_character",e.Unexpected_field_ref="Unexpected_field_ref",e.Unexpected_dot="Unexpected_dot",e.Invalid_struct_ref_table_name="Invalid_struct_ref_table_name",e.Missing_struct_ref_table_name="Missing_struct_ref_table_name",e.Invalid_struct_ref_comma_parts="Invalid_struct_ref_comma_parts",e.Invalid_struct_ref_missing_part="Invalid_struct_ref_missing_part",e.Invalid_struct_ref_bad_part="Invalid_struct_ref_bad_part",e.Excess_higher_order_function_arguments="Excess_higher_order_function_arguments"}(o||(t.SyntaxError=o={})),function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_operator_arguments",e.Excess_function_arguments="Excess_function_arguments",e.Insufficient_function_arguments="Insufficient_function_arguments"}(s||(t.TypeError=s={})),function(e){e.WSFArgument="WSFArgument",e.OperatorArgument="OperatorArgument"}(u||(t.TypeSourceKind=u={})),t.baseErrors={[o.Unclosed_application]:{kind:o.Unclosed_application},[o.Unclosed_paren]:{kind:o.Unclosed_paren},[o.Unclosed_bracket]:{kind:o.Unclosed_bracket},[o.Unclosed_array]:{kind:o.Unclosed_array},[o.Unclosed_literal]:{kind:o.Unclosed_literal},[o.Unclosed_comment]:{kind:o.Unclosed_comment},[o.Invalid_number_literal]:{kind:o.Invalid_number_literal},[o.Invalid_string_literal]:{kind:o.Invalid_string_literal},[o.Invalid_error_literal]:{kind:o.Invalid_error_literal},[o.Invalid_function_name]:{kind:o.Invalid_function_name},[o.Invalid_name]:{kind:o.Invalid_name},[o.Illegal_array_literal_element]:{kind:o.Illegal_array_literal_element},[o.Empty_array_literal]:{kind:o.Empty_array_literal},[o.Irregular_array_shape]:{kind:o.Irregular_array_shape},[o.Empty_parenthesis]:{kind:o.Empty_parenthesis},[o.Bad_node]:{kind:o.Bad_node},[o.Invalid_qualifier]:{kind:o.Invalid_qualifier},[o.Invalid_cell_ref]:{kind:o.Invalid_cell_ref},[o.Invalid_binder]:{kind:o.Invalid_binder},[o.Missing_binder]:{kind:o.Missing_binder},[o.Duplicate_binder]:{kind:o.Duplicate_binder},[o.Invalid_body]:{kind:o.Invalid_body},[o.Mandatory_binder_after_optional]:{kind:o.Mandatory_binder_after_optional},[o.Missing_default_expression]:{kind:o.Missing_default_expression},[o.Binder_requires_brackets]:{kind:o.Binder_requires_brackets},[o.Invalid_field_name]:{kind:o.Invalid_field_name},[o.Missing_field_name]:{kind:o.Missing_field_name},[o.Empty_formula]:{kind:o.Empty_formula},[o.Invalid_rel_sheet_qualifier_in_cell]:{kind:o.Invalid_rel_sheet_qualifier_in_cell},[o.Invalid_rel_sheet_qualifier_in_name]:{kind:o.Invalid_rel_sheet_qualifier_in_name},[o.Invalid_unqualified_cell]:{kind:o.Invalid_unqualified_cell},[o.Unexpected_closing_paren]:{kind:o.Unexpected_closing_paren},[o.Unexpected_closing_brace]:{kind:o.Unexpected_closing_brace},[o.Unexpected_closing_bracket]:{kind:o.Unexpected_closing_bracket},[o.Unexpected_field_ref]:{kind:o.Unexpected_field_ref},[o.Unexpected_dot]:{kind:o.Unexpected_dot},[o.Invalid_struct_ref_table_name]:{kind:o.Invalid_struct_ref_table_name},[o.Missing_struct_ref_table_name]:{kind:o.Missing_struct_ref_table_name},[o.Invalid_struct_ref_comma_parts]:{kind:o.Invalid_struct_ref_comma_parts},[o.Invalid_struct_ref_missing_part]:{kind:o.Invalid_struct_ref_missing_part},[o.Invalid_struct_ref_bad_part]:{kind:o.Invalid_struct_ref_bad_part},[s.Unexpected_application_head]:{kind:s.Unexpected_application_head},[s.Unexpected_application_head_with_fix]:{kind:s.Unexpected_application_head_with_fix}},t.formatDiagnostic=function(e){switch(e.kind){case s.Insufficient_function_arguments:case s.Excess_function_arguments:return`${e.kind}: ${(0,n.englishWorksheetFuncIdToName)(e.funcId)}`;case o.Missing_operation_argument:case s.Incorrect_number_of_operator_arguments:return`${e.kind}: ${(0,a.englishOperatorIdToName)(e.opId)}`;case o.Unexpected_character:return`${e.kind}: ${(0,i.anonymizeFormulaString)(e.text)}`;case s.Types_not_related:return`${e.kind}: ${function(e){const{kind:t,argIndex:r}=e;switch(e.kind){case u.WSFArgument:return JSON.stringify({kind:t,funcId:(0,n.englishWorksheetFuncIdToName)(e.funcId),argIndex:r});case u.OperatorArgument:return JSON.stringify({kind:t,opId:(0,a.englishOperatorIdToName)(e.opId),argIndex:r})}}(e.typeSource)}`;default:return e.kind}}},3106:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveStaticPrecedents=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6366),u=r(6366),l=r(6366),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(6067),E=r(6067),T=r(6067),R=r(6067),k=r(6067),N=r(1323),I={getDocumentLoc:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getDocumentLoc"),getSheetIndex:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetIndex"),getSheetName:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetName"),getNameLoc:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getNameLoc"),getUserDefinedFuncLoc:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getUserDefinedFuncLoc"),getSheetRangeIndexes:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetRangeIndexes"),getContainingTable:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getContainingTable"),getStructRefColumn:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefColumn"),getStructRefSpecialRef:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefSpecialRef")},O=(0,A.createFailureErrorClass)("ResolveStaticPrecedentsError");class P extends R.IdentityVisitor{appNode(e,t,r,n){if(e.kind===g.NodeKind.WSF){const r=e.id;let n=(0,y.getWorksheetFuncType)(r).staticPrecs;switch(r){case b.WorksheetFuncId.LOOKUP:case b.WorksheetFuncId.SUMIF:case b.WorksheetFuncId.AVERAGEIF:const e=({label:e})=>{const t=this.resolutions[e],r=t?.kind===v.ResolvedKind.ResolvedCellRef||t?.kind===v.ResolvedKind.ResolvedStructRef?t.resolution:void 0;return r?.kind===o.ResultKind.Success?r.value:void 0},a=(t,r)=>{const n=e(t),a=e(r);return void 0!==n&&void 0!==a&&(0,h.isSheetGridRange)(n)&&(0,h.isSheetGridRange)(a)&&(0,E.isDocumentLocEqual)(n.sheet.document,a.sheet.document)&&n.range.rows===a.range.rows&&n.range.cols===a.range.cols};(t.length<3||t[2].kind===g.NodeKind.Literal||t[2].kind===g.NodeKind.Array||a(t[2],r===b.WorksheetFuncId.LOOKUP?t[1]:t[0]))&&(n&=~C.SpecialPrecs.AllCells)}n!==C.SpecialPrecs.None&&(this.ownSpecial|=n)}return super.appNode(e,t,r,n)}nameNode(e,t,r){const n=this.resolver.resolveDottedName(this.locals,(0,d.nameNode)(e,t,r),this.annotations);this.resolutions[r]=n,(0,a.safePush)(this.names,n.precedents.names),(0,a.safePush)(this.udfs,n.precedents.udfs);const{headResolved:o}=n;switch(o.kind){case v.ResolvedKind.ResolvedName:if(!(0,i.isSuccess)(o.resolution)){this.handleResolutionError(o.resolution.reason);break}void 0!==o.resolution.value&&(this.nameSpecial|=C.SpecialPrecs.All);break;case v.ResolvedKind.ResolvedUserDefinedFunc:if(!(0,i.isSuccess)(o.resolution)){this.handleResolutionError(o.resolution.reason);break}break;case v.ResolvedKind.ResolvedCellRef:this.pushResolvedGridRef(o.resolution)}return super.nameNode(e,t,r)}cellRefNode(e,t,r){const n=this.resolver.resolveCellRef(this.locals,(0,c.cellRefNode)(e,t,r));this.resolutions[r]=n;const{resolution:a}=n;return this.pushResolvedGridRef(a),super.cellRefNode(e,t,r)}structRefNode(e,t,r){const n=this.resolver.resolveStructRef(this.locals,(0,m.structRefNode)(e,t,r));this.resolutions[r]=n,(0,a.safePush)(this.names,n.precedents);const{resolution:i}=n;return this.pushResolvedGridRef(i),super.structRefNode(e,t,r)}pushResolvedGridRef(e){if(e.kind!==o.ResultKind.Success)return this.handleResolutionError(e.reason);if(void 0!==e.value){const t=e.value;if((0,h.isSheetGridRange)(t))this.cells.push(t);else{this.ownSpecial|=C.SpecialPrecs.OwnDocSheets;const e=this.globals.getSheetRangeIndexes(t.sheet);if(!(0,i.isSuccess)(e))throw new O(e.reason);(0,a.safePush)(this.cells,e.value.sheets.map((e=>(0,p.sheetGridRange)((0,f.sheetIndex)(t.sheet.document,e),t.range))))}}}handleResolutionError(e){switch(e.kind){case F.ResolveReasonKind.NoOriginSheet:case F.ResolveReasonKind.InvalidStructRef:case F.ResolveReasonKind.InvalidCellRef:case F.ResolveReasonKind.InvalidQualifier:case F.ResolveReasonKind.EmptyIntersection:return}throw new O(e)}constructor(e,t,r){super(),this.locals=t,this.annotations=r,this.cells=[],this.names=[],this.udfs=[],this.nameSpecial=C.SpecialPrecs.None,this.ownSpecial=C.SpecialPrecs.None,this.resolutions=[],this.globals=function(e){return{config:e.config,getDocumentLoc:e.getDocumentLoc?.bind(e)??I.getDocumentLoc,getSheetIndex:e.getSheetIndex?.bind(e)??I.getSheetIndex,getSheetName:e.getSheetName?.bind(e)??I.getSheetName,getNameLoc:e.getNameLoc?.bind(e)??I.getNameLoc,getUserDefinedFuncLoc:e.getUserDefinedFuncLoc?.bind(e)??I.getUserDefinedFuncLoc,getSheetRangeIndexes:e.getSheetRangeIndexes?.bind(e)??I.getSheetRangeIndexes,getContainingTable:e.getContainingTable?.bind(e)??I.getContainingTable,getStructRefColumn:e.getStructRefColumn?.bind(e)??I.getStructRefColumn,getStructRefSpecialRef:e.getStructRefSpecialRef?.bind(e)??I.getStructRefSpecialRef}}(e),this.resolver=(0,S.createResolver)(this.globals)}}t.resolveStaticPrecedents=function(e,t,r){try{const n=new P(e,t,r.annotations);return(0,k.reduceBottomUp)(n,r),(0,s.success)((0,N.staticPrecedents)(n.cells,n.names,n.udfs,n.nameSpecial|n.ownSpecial,n.ownSpecial,T.PrecsBound.Upper,n.resolutions))}catch(e){return e instanceof O?(0,u.failure)(e.reason):(0,u.failure)((0,l.javaScriptError)(e))}}},1323:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.analyzeLocalsName=t.analyzeLocalsGrid=t.createAnalyzeGlobals=t.staticPrecedents=t.summarizeFormulaDiagnostics=t.diagnostics=void 0;const n=r(3345),a=r(6067),i=n.__importStar(r(7247));t.diagnostics=i;const o=r(6366);t.summarizeFormulaDiagnostics=function(e){if(void 0===e)return;const t={};return Object.keys(e).forEach((r=>{e[Number(r)].forEach((e=>{const r=i.formatDiagnostic(e);t[r]=(t[r]??0)+1}))})),t},t.staticPrecedents=function(e,t,r,n,a,i,o){return{cells:e,names:t,udfs:r,special:n,ownSpecial:a,bound:i,resolutions:o}},t.createAnalyzeGlobals=function(e,t){return{config:e,getSheetName:t}},t.analyzeLocalsGrid=function(e,t,r,n=!1){return{config:r??void 0,lexicalKind:e,originGridCell:(0,o.success)(t.range),originSheet:(0,o.success)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:n}},t.analyzeLocalsName=function(e,t,r=!1){return{config:t??void 0,lexicalKind:a.LexicalKind.NameManager,originGridCell:(0,o.success)(e.range),originSheet:(0,o.success)(e.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:r}}},472:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.token=t.tokenizeFormulaModule=t.analyzeServiceTypes=t.analyzeService=t.parserService=t.parseServiceTypes=t.stopUsingThis=t.createParser=t.parseResultHelper=t.isUnbracketedFieldName=t.createAnalyzer=t.PackageName=void 0;const n=r(3345);t.PackageName="excel-online-calc-syntax";var a=r(9176);Object.defineProperty(t,"createAnalyzer",{enumerable:!0,get:function(){return a.createAnalyzer}}),n.__exportStar(r(1323),t),n.__exportStar(r(6898),t);var i=r(7250);Object.defineProperty(t,"isUnbracketedFieldName",{enumerable:!0,get:function(){return i.isUnbracketedFieldName}});var o=r(6930);Object.defineProperty(t,"parseResultHelper",{enumerable:!0,get:function(){return o.parseResultHelper}});var s=r(9838);Object.defineProperty(t,"createParser",{enumerable:!0,get:function(){return s.createParser}}),t.stopUsingThis=n.__importStar(r(837)),t.parseServiceTypes=n.__importStar(r(6898)),t.parserService=n.__importStar(r(9838)),t.analyzeService=n.__importStar(r(9176)),t.analyzeServiceTypes=n.__importStar(r(1323)),t.tokenizeFormulaModule=n.__importStar(r(6805)),t.token=n.__importStar(r(1817))},5634:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBracketedTokens=t.parseIdentContinue=t.parseEnd=t.parseEscape=t.parseAtOp=t.parseRangeOp=t.parseDotSepTokenNotFollowedByLeftBracket=t.parseRightBracket=t.parseLeftBracket=t.parseRightSQuote=t.parseLeftSQuote=t.parseRightBrace=t.parseLeftBrace=t.parseRightParen=t.parseLeftParen=t.parseAssignToken=t.parseDotSepToken=t.parseQualSep=t.parseColSep=t.parseRowSep=t.parseListSep=t.parseCharIndex=t.parseSpacesOnly=t.parseWhitespace=t.isWhitespaceToken=t.isCommentToken=t.isBracketToken=t.isRightBracketToken=t.isLeftBracketToken=t.isRefErrorToken=t.isAtOpToken=t.isRangeOpToken=t.isListSepToken=t.isDotSepToken=void 0;const n=r(6366),a=r(6366),i=r(6067),o=r(6067),s=r(1817),u=r(3153),l=r(6067);function c(e){return e.kind===s.TokenKind.Sep&&e.value===s.SepId.Dot}function d(e){return e.kind===s.TokenKind.Operator&&e.value===o.OperatorId.Range}function g(e){return e.kind===s.TokenKind.Operator&&e.value===o.OperatorId.At}function m(e){return e.kind===s.TokenKind.Left&&e.value===s.DelimId.Bracket}function h(e){return(e.kind===s.TokenKind.Left||e.kind===s.TokenKind.Right)&&e.value===s.DelimId.Bracket}function p(e){return e.kind===s.TokenKind.Spaces||e.kind===s.TokenKind.SingleLineComment||e.kind===s.TokenKind.MultiLineComment}function f(e){return(0,u.take)(((t,r)=>r.kind===s.TokenKind.Sep&&r.value===e?r:void 0))}function S(e){return(0,u.take)(((t,r)=>r.kind===s.TokenKind.Left&&r.value===e?r:void 0))}function v(e){return(0,u.take)(((t,r)=>r.kind===s.TokenKind.Right&&r.value===e?r:void 0))}t.isDotSepToken=c,t.isListSepToken=function(e){return e.kind===s.TokenKind.Sep&&e.value===s.SepId.List},t.isRangeOpToken=d,t.isAtOpToken=g,t.isRefErrorToken=function(e){return e.kind===s.TokenKind.Literal&&e.oper.kind===l.OperKind.Error&&e.oper.type===i.ErrorType.REF},t.isLeftBracketToken=m,t.isRightBracketToken=function(e){return e.kind===s.TokenKind.Right&&e.value===s.DelimId.Bracket},t.isBracketToken=h,t.isCommentToken=function(e){return e.kind===s.TokenKind.SingleLineComment||e.kind===s.TokenKind.MultiLineComment},t.isWhitespaceToken=p,t.parseWhitespace=(0,u.many)((0,u.take)(((e,t)=>p(t)?t:void 0))),t.parseSpacesOnly=(0,u.opt)((0,u.take)(((e,t)=>t.kind===s.TokenKind.Spaces?t.chars:void 0)),""),t.parseCharIndex=function(e,t,r,i,o){const s=e[t];if(null==s){const r=`calc.parse.pStart: internal error: expected token at ${t} in ${(0,n.anonymize)(e)}`;return(0,a.assertFalse)(r)}return i(s.start,t)},t.parseListSep=f(s.SepId.List),t.parseRowSep=f(s.SepId.Row),t.parseColSep=f(s.SepId.Col),t.parseQualSep=f(s.SepId.Qual),t.parseDotSepToken=f(s.SepId.Dot),t.parseAssignToken=f(s.SepId.Assign),t.parseLeftParen=S(s.DelimId.Paren),t.parseRightParen=v(s.DelimId.Paren),t.parseLeftBrace=S(s.DelimId.Brace),t.parseRightBrace=v(s.DelimId.Brace),t.parseLeftSQuote=S(s.DelimId.SQuote),t.parseRightSQuote=v(s.DelimId.SQuote),t.parseLeftBracket=S(s.DelimId.Bracket),t.parseRightBracket=v(s.DelimId.Bracket),t.parseDotSepTokenNotFollowedByLeftBracket=(0,u.takePeek)(((e,t,r)=>c(t)&&!m(r)?t:void 0)),t.parseRangeOp=(0,u.take)(((e,t)=>d(t)?t:void 0)),t.parseAtOp=(0,u.take)(((e,t)=>g(t)?t:void 0)),t.parseEscape=(0,u.take)(((e,t)=>t.kind===s.TokenKind.Escape?t:void 0)),t.parseEnd=(0,u.take)(((e,t)=>t.kind===s.TokenKind.End?t:void 0)),t.parseIdentContinue=(0,u.apply)((0,u.many1)((0,u.take)(((e,t)=>t.isIdentContinue?t:void 0))),((e,t)=>{const r=t[0];return 1===t.length?r:(0,s.identToken)(r.start,t.map((e=>e.chars)).join(""))}));const F=(0,u.take)(((e,t)=>h(t)||t.kind===s.TokenKind.End?void 0:t)),y=(0,u.lazy)((()=>(0,u.flatten)((0,u.many)((0,u.any)((0,u.many1)(F),(0,u.concat)((0,u.tuple)(t.parseLeftBracket),y,(0,u.opt)((0,u.tuple)(t.parseRightBracket),[])))))));t.parseBracketedTokens=(0,u.apply)((0,u.tuple)(t.parseLeftBracket,y,t.parseCharIndex,(0,u.opt)(t.parseRightBracket,void 0)),((e,[t,r,n,a])=>(r.push((0,s.endToken)(n)),[r,void 0!==a])))},7250:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFieldRef=t.isUnbracketedFieldName=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(1817),u=r(3153),l=r(4354),c=r(2736),d=r(5634),g=r(6366),m=r(6366),h=r(6366),p=r(6366),f=r(6366),{codePointQuestionMark:S,codePointBackslash:v,codePointUnderscore:F}=f.codePoint;function y(e,t){function r(t){return t!==S&&t!==v&&e.isIdentContinue(t)}if(0===t.length)return!1;const n=(0,m.stringCodePointAt)(t,0);if((a=n)===F||a===v||!e.isIdentStart(a)&&!e.isNumeral(a))return!1;var a;for(const e of(0,h.codePointIterator)(t,(0,p.numCodeUnits)(n)))if(!r(e))return!1;return!0}t.isUnbracketedFieldName=y;const b=(0,u.take)(((e,t)=>(0,d.isBracketToken)(t)||t.kind===s.TokenKind.Escape||t.kind===s.TokenKind.End?void 0:t.chars)),C=(0,u.take)(((e,t)=>t.kind!==s.TokenKind.Ident||t.chars!==e.localeInfo.leftBracket&&t.chars!==e.localeInfo.rightBracket&&"'"!==t.chars?void 0:t.chars)),A=(0,u.any)(b,(0,u.right)(d.parseEscape,C)),E=(0,u.apply)((0,u.tuple)((0,u.many)(A),d.parseEnd),((e,[t,r])=>t.join(""))),T=(0,u.applyTake)(d.parseBracketedTokens,((e,[t,r])=>{const n=(0,u.runParser)(E,t,0,e);if(!(0,g.isSuccess)(n))return;const s=t[0].start,l=t[t.length-1].start,d=n.value.output;if(d.length>255){const r=t.map((e=>e.chars)).join("");return[(0,i.badCharsNode)(a.BadType.FieldName,r,(0,c.addSpan)(e,s,l,"","")),!1,!0]}return[(0,o.identNode)(d,(0,c.addSpan)(e,s,l,"","")),!0,r]})),R=(0,u.apply)(d.parseIdentContinue,((e,t)=>{const r=t.start,n=t.start+t.chars.length;return!y(e.localeInfo,t.chars)||t.chars.length>255?[(0,i.badCharsNode)(a.BadType.FieldName,t.chars,(0,c.addSpan)(e,r,n,"","")),!1,!0]:[(0,o.identNode)(t.chars,(0,c.addSpan)(e,r,n,"","")),!1,!0]}));t.parseFieldRef=(0,u.apply)((0,u.tuple)(d.parseCharIndex,d.parseWhitespace,d.parseDotSepToken,(0,u.any)(R,T),d.parseCharIndex),((e,[t,r,a,[i,o,s],u])=>{const d=(0,c.addSpan)(e,a.start,u,r,""),g=(0,n.fieldRef)(i,o,s,!1,d);return(0,l.fieldRefTerm)(r.length>0,g,t,u)}))},5237:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSpParam=t.runFormulaParser=t.parseFormula=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(1817),E=r(3153),T=r(4354),R=r(2736),k=r(5634),N=r(5214),I=r(5724),O=r(7250),P=r(4689),M=r(6366),D=r(6067),w=r(6366),L=r(6366),_=r(6366),x=r(6067),K=r(6366),W=r(6067),U=r(6067),G=(0,E.apply)((0,E.tuple)(k.parseWhitespace,(0,E.lazy)((()=>t.parseFormula)),k.parseWhitespace),((e,[t,r,n])=>{const a=(0,R.getNodeSpan)(e,r);return(0,i.assertTrue)("calc.parse.parseSpFormula",!(a.pre.length>0&&t.length>0)),(0,i.assertTrue)("calc.parse.parseSpFormula",!(a.post.length>0&&n.length>0)),t.length>0&&([a.pre,a.preComments]=(0,R.addWhitespace)(e,t)),n.length>0&&([a.post,a.postComments]=(0,R.addWhitespace)(e,n)),r})),B=(0,E.apply)((0,E.tuple)(k.parseLeftParen,(0,R.withDelim)({delimId:A.DelimId.Paren,listSep:R.ListSep.Union},G),(0,E.opt)(k.parseRightParen,void 0),k.parseCharIndex),((e,[t,r,n,a])=>(0,u.parenNode)(r,void 0!==n,(0,R.addSpan)(e,t.start,a,"","")))),V=(0,E.many1)(G,(0,E.right)(k.parseColSep,G)),j=(0,E.many1)(V,(0,E.right)(k.parseRowSep,V)),H=(0,E.apply)((0,E.tuple)(k.parseLeftBrace,(0,R.withDelim)({delimId:A.DelimId.Brace,listSep:R.ListSep.Union},j),(0,E.opt)(k.parseRightBrace,void 0),k.parseCharIndex),((e,[t,r,n,a])=>(0,l.arrayNode)(r,void 0!==n,(0,R.addSpan)(e,t.start,a,"",""))));function q(e){return(0,E.takePeek)(((t,r,n)=>e(r)?(0,p.badCharsNode)(o.BadType.Unexpected,r.chars,(0,R.addSpan)(t,r.start,n.start,"","")):void 0))}const z=(0,E.apply)((0,E.tuple)(k.parseCharIndex,q(k.isLeftBracketToken),(0,R.withDelim)({delimId:A.DelimId.Bracket,listSep:R.ListSep.Union},G),(0,E.opt)(q(k.isRightBracketToken),void 0),k.parseCharIndex),((e,[t,r,n,a,i])=>{const s=[r,n];return null!=a&&s.push(a),(0,f.badSequenceNode)(o.BadType.Unexpected,s,(0,R.addSpan)(e,t,i,"",""))})),Q=(0,E.takePeek)(((e,t,r)=>{switch(t.kind){case A.TokenKind.End:case A.TokenKind.Operator:case A.TokenKind.Spaces:case A.TokenKind.SingleLineComment:case A.TokenKind.MultiLineComment:return;case A.TokenKind.Sep:if(t.value===A.SepId.Dot)return;if(t.value===A.SepId.Qual||t.value===A.SepId.Assign)break;if(e.delim.delimId===A.DelimId.Brace||t.value!==A.SepId.Col&&t.value!==A.SepId.Row)return;break;case A.TokenKind.Right:if(t.value!==A.DelimId.SQuote&&e.delim.stack[t.value])return}return(0,p.badCharsNode)(o.BadType.Unexpected,t.chars,(0,R.addSpan)(e,t.start,r.start,"",""))})),$=(0,E.any)(N.parseRef,I.parseLiteral,B,H,O.parseFieldRef,P.parseStructRef,z,N.parseUnqualBadRef,Q);function Y(e){return(0,E.tuple)(k.parseLeftParen,(0,R.withDelim)({delimId:A.DelimId.Paren,listSep:R.ListSep.Arg},(0,E.apply)((0,E.many1)(e,(0,E.right)(k.parseListSep,e)),((e,t)=>t.map((e=>e.kind===v.NodeKind.Missing?(0,F.literalNode)(U.missingOper,!0,e.label):e))))),(0,E.opt)(k.parseRightParen,void 0),k.parseCharIndex)}const J=(0,E.apply)(Y(G),((e,[t,r,n,a])=>(0,T.argsTerm)(r,void 0!==n,t.start,a))),X=(0,E.apply)(Y((0,E.any)((0,E.lazy)((()=>t.parseSpParam)),G)),((e,[t,r,n,a])=>(0,T.lambdaArgsTerm)(r,void 0!==n,t.start,a))),Z=(0,E.take)(((e,t)=>t.kind!==A.TokenKind.Operator||t.value!==b.OperatorId.Percent&&t.value!==b.OperatorId.Pound?void 0:t)),ee=(0,E.take)(((e,t)=>t.kind===A.TokenKind.Operator||(0,k.isDotSepToken)(t)?t:function(e,t){return t.kind===A.TokenKind.Sep&&t.value===A.SepId.List&&e.delim.listSep===R.ListSep.Union?(0,A.operatorToken)(t.start,e.localeInfo.listSeparator,b.OperatorId.Union):void 0}(e,t))),te=(0,E.many)((0,E.take)(((e,t)=>(0,k.isWhitespaceToken)(t)?t:void 0))),re=(0,E.any)((0,E.concat)((0,E.bind)((0,E.any)($,Z),((e,t)=>{const r=(0,T.isWSFNode)(e.localeInfo,t);return r?.id===C.WorksheetFuncId.LAMBDA?(0,E.concat)((0,E.parseSucceed)([t]),(0,E.opt)((0,E.tuple)(X),[])):(0,E.parseSucceed)([t])})),(0,E.many)((0,E.any)(J,O.parseFieldRef,P.parseStructRef))),(0,E.tuple)(ee)),ne=(0,E.flatten)((0,E.many1)(re,(0,E.concat)(te,re)));t.parseFormula=(0,E.apply)((0,E.tuple)((0,E.opt)(ne,void 0),k.parseCharIndex),((e,[t,r])=>{if(null==t){const t=(0,R.addSpan)(e,r,r,"","");return(0,h.missingNode)("",t)}const n=t;return n.push((0,A.endToken)(r)),(0,T.runOperatorPrecedenceParser)(e,n)})),t.runFormulaParser=function(e,t,r,i,o,u,l,c){const d=c.length-1;if(d<0){const e="calc.parse.runTokenParser: internal error: expected at least 1 token";return(0,a.assertFalse)(e)}if(c[d].kind!==A.TokenKind.End){const e=`calc.parse.runTokenParser: internal error: array[n] !== End in ${(0,n.anonymize)(c)}`;return(0,a.assertFalse)(e)}const g=(0,R.makeState)(e,t,r,i,o),m=(0,E.runParser)(G,c,0,g);if(!(0,M.isSuccess)(m)||m.value.index<d){const e=`calc.parse.runTokenParser: internal error: consumed ${(0,M.isSuccess)(m)?m.value.index:0} out of ${d} in ${(0,n.anonymize)(c)}`;return(0,a.assertFalse)(e)}const h=m.value.output,p=g.spans,f=(0,D.buildAnnotations)(e,h,u,void 0===l?void 0:{[y.SyntaxFeature.Comments]:!0===l[y.SyntaxFeature.Comments],[y.SyntaxFeature.Statements]:!0===l[y.SyntaxFeature.Statements]});return(0,s.formula)(h,p,f)};const{codePointFullStop:ae}=_.codePoint,ie=(0,E.apply)((0,E.many1)((0,E.take)(((e,t)=>t.isIdentContinue||(0,k.isDotSepToken)(t)?t:void 0))),((e,t)=>{const r=t[0].start,n=t.map((e=>e.chars)).join(""),a=(0,R.addSpan)(e,r,r+n.length,"","");return function(e,t){if(!e.localeInfo.isIdentStart((0,L.stringCodePointAt)(t,0)))return!1;for(const r of(0,w.codePointIterator)(t))if(r!==ae&&!e.localeInfo.isIdentContinue(r))return!1;const r=(0,x.parseCellRef)(e.localeInfo,e.refStyle,e.origin,t,0);if(void 0!==r&&r.i===t.length){const n=r.refStyle===m.RefStyle.A1?(0,A.cellRefA1Token)(0,t,r.row,r.col):(0,A.cellRefR1C1Token)(0,t,r.row,r.col,r.enLocale);if((0,N.isCompleteCellRefToken)(e,n))return!1}return!0}(e,n)?(0,S.identNode)(n,a):(0,p.badCharsNode)(o.BadType.ParamName,n,a)})),oe=(0,E.applyTake)((0,E.tuple)(k.parseCharIndex,k.parseLeftBracket,k.parseCharIndex,k.parseSpacesOnly,(0,E.opt)(ie,void 0),k.parseSpacesOnly,k.parseCharIndex,(0,E.opt)(k.parseRightBracket,void 0),k.parseCharIndex),((e,[t,r,n,a,i,o,s,u,l])=>{if(void 0!==i){const t=(0,R.getNodeSpan)(e,i);t.pre=a,t.post=o}const d=i??(0,h.missingNode)(a+o,(0,R.addSpan)(e,n,s,"",""));return(0,c.paramName)(d,!0,void 0!==u,(0,R.addSpan)(e,t,l,"",""))})),se=(0,E.applyTake)((0,E.tuple)(k.parseCharIndex,N.parseRef,k.parseCharIndex),((e,[t,r,n])=>{const a=r.kind===T.TermKind.MaybeWSFTerm?r.node:r;if((0,W.isUnqualifiedNameNode)(a))return(0,c.paramName)((0,S.identNode)(a.whole,a.label),!1,!0,(0,R.addSpan)(e,t,n,"",""))})),ue=(0,E.apply)((0,E.tuple)(k.parseWhitespace,k.parseCharIndex,k.parseAssignToken,k.parseWhitespace,(0,E.lazy)((()=>t.parseFormula)),k.parseCharIndex),((e,[t,r,n,a,i,o])=>{const s=(0,R.getNodeSpan)(e,i);return[s.pre,s.preComments]=(0,R.addWhitespace)(e,a),(0,d.paramDefault)(i,(0,R.addSpan)(e,r,o,t,""))})),le=(0,E.lazy)((()=>(0,K.isFeatureEnabled)(K.FeatureName.CalcLambdaDefaultParameters)?ue:(0,E.parseFail)()));t.parseSpParam=(0,E.applyTake)((0,E.tuple)(k.parseWhitespace,k.parseCharIndex,(0,E.bind)((0,E.any)(se,oe),((e,t)=>t.isClosed?(0,E.apply)((0,E.opt)(le,void 0),((e,r)=>[t,r])):(0,E.parseSucceed)([t,void 0]))),k.parseCharIndex,k.parseWhitespace,(0,E.peek)(((e,t)=>t))),((e,[t,r,[n,a],i,o,s])=>{if(void 0!==a||s.kind===A.TokenKind.End&&n.isBracketed||(0,k.isListSepToken)(s)&&n.isClosed)return(0,g.paramNode)(n,a,(0,R.addSpan)(e,r,i,t,o))}))},5724:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLiteral=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(1817),l=r(3153),c=r(4354),d=r(2736),g=r(5634),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=(0,l.take)(((e,t)=>t.kind===u.TokenKind.Literal&&t.oper.kind!==f.OperKind.Boolean?t:t.kind===u.TokenKind.CellRef&&function(e){return e.refStyle===n.RefStyle.A1&&null==e.col&&"object"==typeof e.row&&e.row.kind===a.PosKind.Rel}(t)?(0,u.literalToken)(t.start,t.chars,e.mathpack.fromNumber(t.row.index+e.origin.row+1)):void 0)),v=(0,l.take)(((e,t)=>t.kind===u.TokenKind.Literal&&t.oper.kind===f.OperKind.Boolean?t:void 0));t.parseLiteral=(0,l.apply)((0,l.tuple)((0,l.any)(S,(0,l.left)(v,(0,l.fails)(g.parseDotSepTokenNotFollowedByLeftBracket))),g.parseCharIndex),((e,[t,r])=>{const n=(0,d.addSpan)(e,t.start,r,"","");if((0,u.isBadNumberOper)(t.oper))return(0,s.badCharsNode)(i.BadType.NumberLiteral,t.chars,n);if((0,u.isBadErrorOper)(t.oper))return(0,s.badCharsNode)(i.BadType.ErrorLiteral,t.chars,n);if((0,h.isStringOper)(t.oper)&&t.oper.value.length>m.cellStringLimit)return(0,s.badCharsNode)(i.BadType.StringLiteral,t.chars,n);const a=(0,o.literalNode)(t.oper,t.hasRight,n);return(0,p.isBooleanOper)(t.oper)?(0,c.maybeWSFTerm)(a,t.chars):a}))},4354:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runOperatorPrecedenceParser=t.isWSFNode=t.maybeWSFTerm=t.structRefTerm=t.fieldRefTerm=t.argsTerm=t.lambdaArgsTerm=t.TermKind=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(6067),E=r(6067),T=r(6067),R=r(6067),k=r(6067),N=r(6067),I=r(6067),O=r(6067),P=r(1817),M=r(3153),D=r(2736),w=r(6067),L=r(6067),_=r(6067),x=r(6067),K=r(5634),W=r(6366),U=r(6366),G=r(6067);var B;function V(e,t,r,n){return{kind:B.FieldRefTerm,hasDotPreSpace:e,rhs:t,start:r,end:n}}function j(e){return e.kind!==P.TokenKind.Operator&&e.kind!==P.TokenKind.Sep&&e.kind!==P.TokenKind.End&&e.kind!==P.TokenKind.Spaces&&e.kind!==P.TokenKind.SingleLineComment&&e.kind!==P.TokenKind.MultiLineComment&&!(e.kind in B)}function H(e){return e.kind===P.TokenKind.Spaces||e.kind===P.TokenKind.SingleLineComment||e.kind===P.TokenKind.MultiLineComment}function q(e,t){return j(t=t.kind===B.MaybeWSFTerm?t.node:t)?(0,D.getNodeSpan)(e,t).start:t.start}!function(e){e.LambdaArgsTerm="LambdaArgsTerm",e.ArgsTerm="ArgsTerm",e.FieldRefTerm="FieldRefTerm",e.StructRefTerm="StructRefTerm",e.MaybeWSFTerm="MaybeWSFTerm"}(B||(t.TermKind=B={})),t.lambdaArgsTerm=function(e,t,r,n){return{kind:B.LambdaArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.argsTerm=function(e,t,r,n){return{kind:B.ArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.fieldRefTerm=V,t.structRefTerm=function(e,t,r){return{kind:B.StructRefTerm,rhs:e,start:t,end:r}},t.maybeWSFTerm=function(e,t){return{kind:B.MaybeWSFTerm,node:e,whole:t}};const z=(0,M.many)((0,M.take)(((e,t)=>H(t)?t:void 0))),Q=(0,M.many1)((0,M.take)(((e,t)=>H(t)?t:void 0))),$=(0,M.peek)(((e,t)=>t)),Y=function(e,t,r,a,o){const s=e[t];if(null==s){const r=`calc.parse.pStart: internal error: expected term at ${t} in ${(0,n.anonymize)(e)}`;return(0,i.assertFalse)(r)}return a(q(r,s),t)};function J(e){return(0,M.apply)((0,M.tuple)(z,Y,(0,M.take)(e),Y,z),((e,[t,r,n,a,i])=>(0,u.operatorNode)(n,(0,D.addSpan)(e,r,a,t,i))))}function X(e){return(0,M.apply)((0,M.tuple)(z,Y,(0,M.take)(e),Y),((e,[t,r,n,a])=>(0,u.operatorNode)(n,(0,D.addSpan)(e,r,a,t,""))))}function Z(e){return(0,M.apply)((0,M.tuple)(Y,(0,M.take)(e),Y,z),((e,[t,r,n,a])=>(0,u.operatorNode)(r,(0,D.addSpan)(e,t,n,"",a))))}const ee=J(((e,t)=>t.kind!==P.TokenKind.Operator||t.value!==N.OperatorId.Add&&t.value!==N.OperatorId.Sub?void 0:t.value)),te=Z(((e,t)=>{if(t.kind===P.TokenKind.Operator){if(t.value===N.OperatorId.Add)return N.OperatorId.Pos;if(t.value===N.OperatorId.Sub)return N.OperatorId.Neg}})),re=Z(((e,t)=>t.kind===P.TokenKind.Operator&&t.value===N.OperatorId.At?t.value:void 0)),ne=X(((e,t)=>t.kind===P.TokenKind.Operator&&t.value===N.OperatorId.Pound?t.value:void 0)),ae=(0,M.take)(((e,t)=>t.kind===B.StructRefTerm?t:void 0)),ie=J(((e,t)=>t.kind!==P.TokenKind.Operator||t.value!==N.OperatorId.Mul&&t.value!==N.OperatorId.Div?void 0:t.value)),oe=J(((e,t)=>t.kind===P.TokenKind.Operator&&t.value===N.OperatorId.Pow?t.value:void 0)),se=X(((e,t)=>t.kind===P.TokenKind.Operator&&t.value===N.OperatorId.Percent?t.value:void 0)),ue=J(((e,t)=>t.kind===P.TokenKind.Operator&&t.value===N.OperatorId.Concat?t.value:void 0)),le=J(((e,t)=>t.kind===P.TokenKind.Operator&&t.value>=N.OperatorId.Eq&&t.value<=N.OperatorId.Ge?t.value:void 0)),ce=J(((e,t)=>t.kind===P.TokenKind.Operator&&t.value===N.OperatorId.Range?t.value:void 0)),de=J(((e,t)=>t.kind===P.TokenKind.Operator&&t.value===N.OperatorId.Union?t.value:void 0)),ge=(0,M.applyTake)((0,M.tuple)(Q,$),((e,[t,r])=>{if(!(r.kind===P.TokenKind.End||r.kind===P.TokenKind.Operator&&r.value!==N.OperatorId.At||r.kind===P.TokenKind.Sep&&(0,K.isDotSepToken)(r))){if(1!==t.length||t[0].kind!==P.TokenKind.Spaces)return t;const n=q(e,r),a=(0,D.addSpan)(e,n,n,t[0].chars,"");return(0,u.operatorNode)(N.OperatorId.Isect,a)}})),me=(0,M.take)(((e,t)=>t.kind===P.TokenKind.Sep&&(0,K.isDotSepToken)(t)?t:void 0)),he=(0,M.take)(((e,t)=>t.kind===B.ArgsTerm?t:void 0)),pe=(0,M.take)(((e,t)=>t.kind===B.LambdaArgsTerm?t:void 0)),fe=(0,M.take)(((e,t)=>t.kind===B.ArgsTerm||t.kind===B.FieldRefTerm?t:void 0)),Se={[I.WorksheetFuncId.LETREC]:U.FeatureName.CalcLetRecFunction};function ve(e,t){if(t.kind===B.MaybeWSFTerm&&void 0!==t.whole){const r=(0,w.getWorksheetFuncId)(e,t.whole);if(void 0===r)return;if((0,a.assertTrue)("calc.parse.parseWSFName: unexpected UDF",r!==I.WorksheetFuncId._UDF),0!=((0,O.getWorksheetFuncType)(r).flags&G.FunctionFlags.Internal))return;const n=Se[r];if(void 0!==n&&!(0,U.isFeatureEnabled)(n))return;return(0,g.wsfNode)(r,t.whole,t.node.label)}}t.isWSFNode=ve;const Fe=(0,M.take)(((e,t)=>ve(e.localeInfo,t))),ye=(0,M.take)(((e,t)=>{const r=ve(e.localeInfo,t);return r?.id===I.WorksheetFuncId.LAMBDA?r:void 0})),be=(0,M.apply)((0,M.tuple)(ye,pe),((e,[t,r])=>{const n=(0,D.getNodeSpan)(e,t).start,a=r.nodes,i=(t.id,[]);let s;const u=[];for(let e=0;e<a.length;e+=1){const t=a[e];t.kind===o.NodeKind.Param?i.push((0,b.lambdaParam)((0,F.indexedArg)(t,e))):e===a.length-1?s=(0,F.indexedArg)(t,e):u.push((0,F.indexedArg)(t,e))}const l=(0,D.addSpan)(e,n,r.end,"","");return(0,h.lambdaNode)(t,i,s,u,r.isClosed,l)})),Ce=(0,M.apply)((0,M.tuple)(Fe,he),((e,[t,r])=>{const n=(0,D.getNodeSpan)(e,t).start,a=r.nodes;switch(t.id){case I.WorksheetFuncId.LET:case I.WorksheetFuncId.LETREC:{t.id;const i=[],l=[];let c;for(let t=0;t<a.length;t+=1){const r=a[t];t!==a.length-1?!(t+1<a.length&&(0,_.isUnqualifiedNameNode)(r))||t+3<a.length&&(s=e.refStyle,u=a[t+2],!((0,_.isUnqualifiedNameNode)(u)||s===v.RefStyle.A1&&u.kind===o.NodeKind.CellRef&&void 0===u.qualifier&&u.ref.kind===f.CellRefKind.Single&&u.ref.col.kind===S.PosKind.Rel&&u.ref.row.kind===S.PosKind.Rel))&&(0,_.isUnqualifiedNameNode)(a[t+1])?l.push((0,F.indexedArg)(r,t)):(i.push((0,y.letVar)((0,F.indexedArg)((0,T.varNode)((0,E.identNode)(r.whole,r.parts.label),r.label),t),(0,F.indexedArg)(a[t+1],t+1))),t+=1):c=(0,F.indexedArg)(r,t)}const d=(0,D.addSpan)(e,n,r.end,"","");return(0,m.letNode)(t,i,c,l,r.isClosed,d)}case I.WorksheetFuncId.LAMBDA:return(0,i.assertFalse)("calc.parse.parseWSFApp: unexpected LAMBDA+ArgTerm")}var s,u;return Re(e,t,a,r.isClosed,n,r.end)}));function Ae(e,t,r){return(0,M.apply)((0,M.tuple)((0,M.many)(e),t),((e,[t,n])=>t.reduceRight(r(e),n)))}function Ee(e,t,r){return(0,M.apply)((0,M.tuple)(e,(0,M.many)(t)),((e,[t,n])=>n.reduce(r(e),t)))}function Te(e){return(t,[r,n])=>{if(i=r,Array.isArray(i)){const i=(0,D.getNodeSpan)(e,t);(0,a.assertTrue)("calc.parse.makeAppNodeInfix",0===i.post.length),[i.post,i.postComments]=(0,D.addWhitespace)(e,r);const o=(0,D.getNodeSpan)(e,n),u=(0,D.addSpan)(e,i.start,o.end,"","");return(0,R.badSequenceNode)(s.BadType.Unexpected,[t,n],u)}var i;const o=(0,D.getNodeSpan)(e,t).start,u=(0,D.getNodeSpan)(e,n).end,c=(0,D.addSpan)(e,o,u,"","");return(0,l.appNode)(r,[t,n],!0,c)}}function Re(e,t,r,n,a,i){const o=(0,D.addSpan)(e,a,i,"","");return(0,l.appNode)(t,r,n,o)}function ke(e){return(t,r)=>{const n=(0,D.getNodeSpan)(e,t).start;switch(r.kind){case B.ArgsTerm:return Re(e,t,r.nodes,r.isClosed,n,r.end);case B.FieldRefTerm:{const a=(0,D.addSpan)(e,n,r.end,"",""),{start:i,end:o,pre:u}=(0,D.getNodeSpan)(e,r.rhs);if((0,L.isNumberLiteralNode)(t)){const n=(0,D.addSpan)(e,i,i,"",""),u=(0,A.missingNode)("",n),l=r.rhs.label,d=(0,D.addSpan)(e,i,o,"",""),g=!1,m=(0,C.fieldRef)(r.rhs.field,r.rhs.isBracketed,r.rhs.isClosed,g,d);return(0,R.badSequenceNode)(s.BadType.FieldRef,[t,(0,c.fieldRefNode)(u,m,l)],a)}const l=!r.rhs.isBracketed&&(0,x.shouldFieldRefBeBracketed)(t,r.rhs,u),d=(0,C.fieldRef)(r.rhs.field,r.rhs.isBracketed,r.rhs.isClosed,l,r.rhs.label);return(0,c.fieldRefNode)(t,d,a)}case B.StructRefTerm:{const a=(0,D.addSpan)(e,n,r.end,"","");switch(t.kind){case o.NodeKind.Name:return(0,p.structRefNode)(t,r.rhs,a);case o.NodeKind.Missing:return(0,p.structRefNode)(void 0,r.rhs,a)}return(0,R.badSequenceNode)(s.BadType.StructRef,[t,(0,p.structRefNode)(void 0,r.rhs,(0,D.addSpan)(e,r.start,r.end,"",""))],a)}case o.NodeKind.Operator:return Re(e,r,[t],!0,n,(0,D.getNodeSpan)(e,r).end)}}}function Ne(e){let t=!0;return(r,n)=>{const a=(0,D.getNodeSpan)(e,n).start,i=(0,D.getNodeSpan)(e,r).end,o=(0,D.addSpan)(e,a,i,"","");if((n.id===N.OperatorId.Pos||n.id===N.OperatorId.Neg)&&t&&(t=!1,(0,L.isNumberLiteralNode)(r)&&""===(0,D.getNodeSpan)(e,n).post)){const t=n.id===N.OperatorId.Pos?r.oper:e.mathpack.neg(r.oper);return(0,d.literalNode)(t,!0,o)}return(0,l.appNode)(n,[r],!0,o)}}const Ie=(0,M.take)(((e,t)=>t.kind===B.MaybeWSFTerm?t.node:j(t)?t:void 0)),Oe=(0,M.apply)((0,M.tuple)(z,me,Y,z),((e,[t,r,n,a])=>(0,k.badCharsNode)(s.BadType.Unexpected,r.chars,(0,D.addSpan)(e,r.start,n,t,a)))),Pe=(0,M.apply)((0,M.tuple)(Y,z,me,Y),((e,[t,r,n,a])=>{const i=(0,D.addSpan)(e,a,a,"",""),o=(0,D.addSpan)(e,n.start,a,r,""),s=(0,C.fieldRef)((0,A.missingNode)("",i),!1,!0,!1,o);return V(r.length>0,s,t,a)})),Me=(0,M.lazy)((()=>(0,M.apply)((0,M.tuple)(Y,(0,M.many)((0,M.any)(be,Ce,Ie,Oe),(0,M.any)(be,Ce,Ie,(0,M.right)((0,M.succeeds)(re),xe))),Y),((e,[t,r,n])=>{if(1===r.length)return r[0];const a=(0,D.addSpan)(e,t,n,"","");return 0===r.length?(0,A.missingNode)("",a):(0,R.badSequenceNode)(s.BadType.Unexpected,r,a)})))),De=Ee((0,M.lazy)((()=>(0,M.any)((0,M.right)((0,M.succeeds)(re),xe),(0,M.right)((0,M.succeeds)(te),We),Me))),(0,M.any)(ne,ae),ke),we=Ee(De,(0,M.tuple)(ce,De),Te),Le=Ee(we,(0,M.tuple)(ge,we),Te),_e=Ee(Le,(0,M.any)(fe,Pe),ke),xe=Ae(re,_e,Ne),Ke=Ee(xe,(0,M.tuple)(de,xe),Te),We=Ae(te,Ke,Ne),Ue=Ee(We,se,ke),Ge=Ee(Ue,(0,M.tuple)(oe,Ue),Te),Be=Ee(Ge,(0,M.tuple)(ie,Ge),Te),Ve=Ee(Be,(0,M.tuple)(ee,Be),Te),je=Ee(Ve,(0,M.tuple)(ue,Ve),Te),He=Ee(je,(0,M.tuple)(le,je),Te);t.runOperatorPrecedenceParser=function(e,t){let r=t.length-1;if(r<1){const e="calc.parse.runTermParser: internal error: expected at least 1 term";return(0,i.assertFalse)(e)}if(t[r].kind!==P.TokenKind.End){const e=`calc.parse.runTermParser: internal error: array[n].kind !== End in ${(0,n.anonymize)(t)}`;return(0,i.assertFalse)(e)}if(1===r&&j(t[0]))return t[0];if(H(t[0])){const e=`calc.parse.runTermParser: internal error: array[0].kind === Spaces/comment in ${(0,n.anonymize)(t)}`;return(0,i.assertFalse)(e)}if(H(t[r-1])){const e=`calc.parse.runTermParser: internal error: array[n-1].kind === Spaces/comment in ${(0,n.anonymize)(t)}`;return(0,i.assertFalse)(e)}for(;;){const a=(0,M.runParser)(He,t,0,e);if((0,W.isSuccess)(a)&&a.value.index>=r)return a.value.output;if(!(0,W.isSuccess)(a)||0===a.value.index||1===a.value.index&&j(t[0])){const e=`calc.parse.runTermParser: internal error: consumed ${(0,W.isSuccess)(a)?a.value.index:0} out of ${r} in ${(0,n.anonymize)(t)}`;return(0,i.assertFalse)(e)}r=(t=[a.value.output,...t.slice(a.value.index)]).length-1}}},6427:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseQualifier=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(3153),d=r(2736),g=r(5634),m=r(1817),h=r(6366),p=r(6067),f=r(6067),S=r(6366);function v(e){return e.kind===m.TokenKind.Literal&&e.oper.kind===p.OperKind.Boolean}const{codePointFullStop:F}=h.codePoint,y=(0,c.opt)((0,c.takePeek)(((e,t,r)=>t.kind!==m.TokenKind.Spaces||(0,g.isWhitespaceToken)(r)?void 0:t.chars)),""),b=(0,c.take)(((e,t)=>t.isIdentContinue&&!v(t)&&t.chars.length>0&&t.chars.charCodeAt(0)!==F?t.chars:void 0)),C=(0,c.take)(((e,t)=>t.isIdentContinue||(0,g.isDotSepToken)(t)?t.chars:void 0)),A=(0,c.apply)((0,c.many1)(b,C),((e,t)=>t.join(""))),E=(0,c.take)(((e,t)=>t.kind===m.TokenKind.Ident?t.chars:void 0)),T=(e,t)=>(t.path??"")+e.leftBracket+t.document+e.rightBracket;function R(e,t,r,i,o,u){let l,c;if(null==t)null==i?(l=(0,n.identQualifier)(r,o,u),c=r):(l=(0,a.sheetRangeQualifier)(r,i,void 0,o,u),c=`${r}:${i}`);else{const n=T(e.localeInfo,t);null==i?(l=(0,s.sheetQualifier)(r,t,o,u),c=`${n}${r}`):(l=(0,a.sheetRangeQualifier)(r,i,t,o,u),c=`${n}${r}:${i}`)}return[l,o?(0,f.quoteQualifier)(c):c]}const k=(0,c.take)(((e,t)=>t.kind===m.TokenKind.Ident||(0,g.isRangeOpToken)(t)?t.chars:void 0)),N=(0,c.apply)((0,c.tuple)(g.parseCharIndex,(0,c.many)(k),g.parseLeftBracket,(0,c.many1)(k),g.parseRightBracket,g.parseCharIndex),((e,[t,r,n,a,i,o])=>{const s=r.join(""),l=a.join("");return(0,u.documentQualifier)(l,""!==s?s:void 0,!0,(0,d.addSpan)(e,t,o,"",""))})),I=(0,c.apply)((0,c.tuple)(g.parseCharIndex,g.parseLeftBracket,(0,c.many1)(C),g.parseRightBracket,g.parseCharIndex),((e,[t,r,n,a,i])=>{const o=n.join("");return(0,u.documentQualifier)(o,void 0,!1,(0,d.addSpan)(e,t,i,"",""))})),O=(0,c.apply)((0,c.tuple)(g.parseCharIndex,(0,c.opt)(I,void 0),A,(0,c.opt)((0,c.right)(g.parseRangeOp,A),void 0),g.parseCharIndex),((e,[t,r,n,a,i])=>R(e,r,n,a,!1,(0,d.addSpan)(e,t,i,"","")))),P=(0,c.apply)((0,c.tuple)(g.parseLeftSQuote,(0,c.opt)(N,void 0),E,(0,c.opt)((0,c.right)(g.parseRangeOp,E),void 0),g.parseRightSQuote,g.parseCharIndex),((e,[t,r,n,a,i,o])=>R(e,r,n,a,!0,(0,d.addSpan)(e,t.start,o,"","")))),M=(0,c.apply)(I,((e,t)=>[t,T(e.localeInfo,t)])),D=(0,c.apply)((0,c.tuple)(g.parseLeftSQuote,N,g.parseRightSQuote,g.parseCharIndex),((e,[t,r,n,a])=>[(0,u.documentQualifier)(r.document,r.path,!0,(0,d.addSpan)(e,t.start,a,"","")),(0,f.quoteQualifier)(T(e.localeInfo,r))])),w=(0,c.take)(((e,t)=>t.kind===m.TokenKind.End||t.kind===m.TokenKind.Right&&t.value===m.DelimId.SQuote?void 0:t.chars)),L=(0,c.apply)((0,c.tuple)(g.parseLeftSQuote,(0,c.many)(w),(0,c.opt)((0,c.tuple)(g.parseRightSQuote,(0,c.opt)((0,c.tuple)(g.parseQualSep,y),[void 0,""])),[void 0,[void 0,""]]),g.parseCharIndex),((e,[t,r,[n,[a,i]],o])=>{const s=void 0!==n,u=void 0!==a,c=`'${r.join("")}${s?"'":""}${u?"!":""}`,g=(0,d.addSpan)(e,t.start,o-i.length,"",i);return[(0,l.badQualifier)(c,!0,s,u,g),c]})),_=(0,c.takePeek)(((e,t,r)=>{if((0,g.isRefErrorToken)(t)){const n=(0,d.addSpan)(e,t.start,r.start,"","");return[(0,i.errorQualifier)(n),t.chars]}})),x=(0,c.peek)(((e,t)=>{const r=(0,d.addSpan)(e,t.start,t.start,"","");return[(0,o.relativeQualifier)(r),""]})),K=(0,c.apply)((0,c.tuple)((0,c.any)(O,P,M,D,x),g.parseQualSep,y),((e,[[t,r],n,a])=>{const i=(0,d.getNodeSpan)(e,t);return i.end+=1,(0,S.assertTrue)("calc.parse.parseGoodQualifier",i.end===n.start+n.chars.length),(0,S.assertTrue)("calc.parse.parseGoodQualifier",0===i.post.length),i.post=a,[t,`${r}!`]})),W=(0,c.take)(((e,t)=>t.isIdentContinue||(0,g.isDotSepToken)(t)||v(t)||function(e){return e.kind===m.TokenKind.Literal&&(0,m.isNumberLikeOper)(e.oper)}(t)?t.chars:void 0)),U=(0,c.apply)((0,c.tuple)(g.parseCharIndex,(0,c.many)(W),g.parseQualSep,g.parseCharIndex,y),((e,[t,r,n,a,i])=>{const o=`${r.join("")}!`,s=(0,d.addSpan)(e,t,a,"",i);return[(0,l.badQualifier)(o,!1,!0,!0,s),o]}));t.parseQualifier=(0,c.any)(_,K,U,L)},5214:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseRef=t.parseUnqualBadRef=t.isCompleteCellRefToken=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(6067),E=r(6067),T=r(6067),R=r(6067),k=r(6067),N=r(6067),I=r(6067),O=r(6067),P=r(6067),M=r(6067),D=r(6067),w=r(6067),L=r(6067),_=r(1817),x=r(3153),K=r(4354),W=r(2736),U=r(6067),G=r(5634),B=r(6427),V=r(6067),j=r(6366),H=r(7250);function q(e,t){return e.refStyle===t.refStyle&&!t.isBadLocale&&t.row!==L.SpecialPos.A1BadDollar&&t.col!==L.SpecialPos.A1BadDollar}function z(e){return e.refStyle===o.RefStyle.R1C1||"object"==typeof e.row&&"object"==typeof e.col}function Q(e,t){return t.kind===_.TokenKind.CellRef&&q(e,t)&&z(t)}t.isCompleteCellRefToken=Q;const $=(0,m.pos)(s.PosKind.Rel,0);function Y(e){return e===L.SpecialPos.RCNoNum?$:e}function J(e,t){if(e.row!==L.SpecialPos.A1BadDollar&&e.col!==L.SpecialPos.A1BadDollar){const r=e.refStyle===o.RefStyle.R1C1&&!e.isIdentContinue;if(null!=e.row&&null!=e.col)return(0,h.cellRefSingle)(Y(e.row),Y(e.col),r,t);if(null!=e.row){const n=Y(e.row);return(0,p.cellRefRow)(n,n,r,t)}if(null!=e.col){const n=Y(e.col);return(0,f.cellRefCol)(n,n,r,t)}}const r=`calc.parse.cellRefToken2cellRef: bad token ${(0,n.anonymize)(e)}`;return(0,a.assertFalse)(r)}function X(e,t){return t.isIdentContinue&&e.localeInfo.isIdentStart((0,j.stringCodePointAt)(t.chars,0))}const Z=(0,x.take)(((e,t)=>Q(e,t)&&!X(e,t)||(0,G.isRefErrorToken)(t)?t:void 0)),ee=(0,x.take)(((e,t)=>Q(e,t)&&X(e,t)?t:void 0)),te=(0,x.apply)((0,x.tuple)((0,x.any)(Z,(0,x.withState)((e=>e.cellRefMustBeCellRefNode?ee:(0,x.left)(ee,(0,x.fails)((0,x.any)(G.parseIdentContinue,G.parseDotSepTokenNotFollowedByLeftBracket)))))),G.parseCharIndex),((e,[t,r])=>{const n=t.kind===_.TokenKind.CellRef?J(t,(0,W.addSpan)(e,t.start,r,"","")):(0,S.cellRefError)((0,W.addSpan)(e,t.start,r,"","")),a=t.kind===_.TokenKind.CellRef?t.chars:void 0;return(0,K.maybeWSFTerm)((0,v.cellRefNode)(n,void 0,(0,W.addSpan)(e,t.start,r,"","")),a)})),re=(0,x.takePeek)(((e,t,r)=>t.kind!==_.TokenKind.CellRef||!q(e,t)||function(e,t,r){return r.kind===_.TokenKind.Left&&r.value===_.DelimId.Paren&&t.isIdentContinue&&null!=(0,U.getWorksheetFuncId)(e.localeInfo,t.chars)}(e,t,r)||r.isIdentContinue?void 0:[t,r.start])),ne=(0,x.bind)((0,x.tuple)(re,G.parseSpacesOnly,G.parseRangeOp,G.parseSpacesOnly,re),((e,[[t,r],n,a,i,[o,s]])=>{const l=(0,W.addSpan)(e,t.start,r,"",n),c=(0,W.addSpan)(e,o.start,s,i,""),d=J(t,l),g=J(o,c);let m;if(d.kind===u.CellRefKind.Single&&g.kind===u.CellRefKind.Single){const r=(0,W.addSpan)(e,t.start,s,"","");m=(0,F.cellRefRange)(d,g,r)}else if(0===n.length&&0===i.length)if(d.kind===u.CellRefKind.Row&&g.kind===u.CellRefKind.Row){const r=d.isBracketed||g.isBracketed,n=(0,W.addSpan)(e,t.start,s,"","");m=(0,p.cellRefRow)(d.row1,g.row1,r,n)}else if(d.kind===u.CellRefKind.Col&&g.kind===u.CellRefKind.Col){const r=d.isBracketed||g.isBracketed,n=(0,W.addSpan)(e,t.start,s,"","");m=(0,f.cellRefCol)(d.col1,g.col1,r,n)}if(null==m)return(0,x.parseFail)();const h=(0,K.maybeWSFTerm)((0,v.cellRefNode)(m,void 0,(0,W.addSpan)(e,t.start,s,"","")),void 0);return t.isIdentContinue&&o.isIdentContinue?(0,x.peek)(((e,t)=>t.kind===_.TokenKind.Sep&&t.value===_.SepId.Qual?void 0:h)):(0,x.parseSucceed)(h)})),ae=(0,x.any)(ne,te);t.parseUnqualBadRef=(0,x.apply)((0,x.take)(((e,t)=>t.kind===_.TokenKind.CellRef?t:void 0)),((e,t)=>{const r=t.start+t.chars.length,n=t.refStyle===o.RefStyle.R1C1&&!t.isIdentContinue;return(0,K.maybeWSFTerm)((0,v.cellRefNode)((0,R.cellRefBad)(t.chars,n,(0,W.addSpan)(e,t.start,r,"","")),void 0,(0,W.addSpan)(e,t.start,r,"","")),t.chars)}));const ie=(0,x.take)(((e,t)=>t.kind===_.TokenKind.Ident&&e.localeInfo.isIdentStart((0,j.stringCodePointAt)(t.chars,0))||t.kind===_.TokenKind.CellRef&&X(e,t)?t:void 0)),oe=(0,x.take)(((e,t)=>t.kind===_.TokenKind.Literal&&t.oper.kind===V.OperKind.Boolean?t:void 0)),se=(0,x.any)(ie,(0,x.left)(oe,(0,x.succeeds)(G.parseDotSepTokenNotFollowedByLeftBracket))),ue=(0,x.peek)(((e,t)=>(0,G.isLeftBracketToken)(t))),le=(0,x.tuple)((0,x.many1)(se,G.parseIdentContinue),(0,x.many)((0,x.any)(G.parseIdentContinue,G.parseDotSepTokenNotFollowedByLeftBracket)),ue,G.parseCharIndex),ce=(0,x.apply)(le,(function(e,[t,r,n,u]){const c=t[0],d=1===t.length&&r[0]?.kind===_.TokenKind.Sep,g=c.kind!==_.TokenKind.CellRef||(m=c).refStyle===o.RefStyle.A1&&null==m.row&&"object"==typeof m.col&&m.col.kind===s.PosKind.Rel||function(e,t){return t.refStyle===o.RefStyle.A1&&e.refStyle===o.RefStyle.A1&&t.isIdentContinue||t.refStyle===o.RefStyle.R1C1&&(0,w.isR1C1IdentStart)(t.row,t.col)}(e,c)&&d;var m;if(n||function(e,t,r){return 0===r.length||1===t.length&&t[0].kind===_.TokenKind.Literal||r.some(((t,r)=>r%2==0?t.kind!==_.TokenKind.Sep:t.kind===_.TokenKind.Sep||!(0,H.isUnbracketedFieldName)(e.localeInfo,t.chars)))}(e,t,r)){const n=[...t,...r].map((e=>e.chars)).join(""),a=(0,W.addSpan)(e,c.start,u,"",""),i=(0,W.addSpan)(e,c.start,u,"",""),o=(0,y.identNamePart)(n,g,a,i),s=(0,b.nameNode)(o,void 0,(0,W.addSpan)(e,c.start,u,"",""));return(0,K.maybeWSFTerm)(s,s.whole)}let h,p=g,f=0,S=r[f]?.start??u,v=(0,W.addSpan)(e,c.start,S,"",""),F=(0,W.addSpan)(e,c.start,S,"","");if(1===t.length&&c.kind===_.TokenKind.CellRef)if(q(e,c))if(z(c)){const t=J(c,(0,W.addSpan)(e,c.start,S,"",""));h=(0,C.cellRefNamePart)(t,c.chars,v,F)}else h=(0,y.identNamePart)(c.chars,p,v,F);else p=!1,h=(0,y.identNamePart)(c.chars,p,v,F);else{let n=t.map((e=>e.chars)).join("");(0===e.localeInfo.stringCompareCI(n,"_xlpm")||0===e.localeInfo.stringCompareCI(n,"_xleta"))&&f+1<r.length&&(n+="."+r[f+1].chars,f+=2,S=r[f]?.start??u,v=(0,W.addSpan)(e,c.start,S,"",""),F=(0,W.addSpan)(e,c.start,S,"","")),h=(0,y.identNamePart)(n,p,v,F)}let E=h;for(;f+1<r.length;f+=2){const t=r[f],n=r[f+1],a=r[f+2]?.start??u;E=(0,A.fieldRefNamePart)(E,(0,k.fieldRef)((0,M.identNode)(n.chars,(0,W.addSpan)(e,n.start,a,"","")),!1,!0,!1,(0,W.addSpan)(e,t.start,a,"","")),f+2>=r.length?g:p,(0,W.addSpan)(e,c.start,a,"",""),(0,W.addSpan)(e,c.start,a,"",""))}if(f<r.length){const t=r[f],n=r[f+1]?.start??u,a=(0,k.fieldRef)((0,I.missingNode)("",(0,W.addSpan)(e,n,n,"","")),!1,!0,!1,(0,W.addSpan)(e,t.start,n,"",""));E=(0,A.fieldRefNamePart)(E,a,g,(0,W.addSpan)(e,c.start,n,"",""),(0,W.addSpan)(e,c.start,n,"","")),f+=1}(0,i.assertTrue)("calc.parse.pUnqualName: i == tailTokens",f===r.length),E.kind===l.NamePartKind.CellRefNamePart&&(0,a.assertFalse)("calc.parse.pUnqualName: expected lhs.kind !== NamePartKind.CellRefNamePart");const T=(0,b.nameNode)(E,void 0,(0,W.addSpan)(e,c.start,u,"",""));return(0,K.maybeWSFTerm)(T,T.whole)})),de=(0,x.opt)((0,x.any)(ae,ce,t.parseUnqualBadRef),{node:void 0}),ge=(0,x.any)(ae,(0,x.right)((0,x.fails)(ce),t.parseUnqualBadRef)),me=(0,x.bind)(B.parseQualifier,((e,[t,r])=>(0,x.apply)(t.kind===c.QualifierKind.SheetRange?(0,W.cellRefMustBeCellRefNode)(t.isQuoted?de:ge):t.kind===c.QualifierKind.Error?(0,W.cellRefMustBeCellRefNode)(de):de,((e,{node:n})=>{if(null==n)return t.kind===c.QualifierKind.Error?(0,E.literalNode)(D.refErrorOper,!0,t.label):(0,O.badCharsNode)(g.BadType.Qualifier,r,t.label);const a=(0,W.getNodeSpan)(e,t).start,o=(0,W.getNodeSpan)(e,n).end;if(n.kind===d.NodeKind.Name){const r=(0,W.addSpan)(e,a,o,"","");if(t.kind===c.QualifierKind.Error){const e=(0,E.literalNode)(D.refErrorOper,!0,t.label);return(0,P.badSequenceNode)(g.BadType.Unexpected,[e,n],r)}return(0,i.assertTrue)("calc.parse.pQualRef: sheet-range-name quoted",t.kind!==c.QualifierKind.SheetRange||t.isQuoted),t.kind===c.QualifierKind.SheetRange&&void 0===t.document&&(t=(0,N.identQualifier)(`${t.sheet1}:${t.sheet2}`,t.isQuoted,t.label)),(0,b.nameNode)(function(e,t,r){let n=t;for(;(0,W.getSpan)(e,n.qualifiedLabel).start=r,n.kind===l.NamePartKind.FieldRefNamePart;)n=n.lhs;return t}(e,n.parts,a),t,r)}const s=(0,W.addSpan)(e,a,o,"","");return t.kind===c.QualifierKind.Ident&&(t=(0,T.sheetQualifier)(t.name,void 0,t.isQuoted,t.label)),(0,v.cellRefNode)(n.ref,t,s)})))),he=(0,x.apply)((0,x.any)(ae,ce),((e,t)=>t.node.kind===d.NodeKind.CellRef&&t.node.ref.kind===u.CellRefKind.Error?(0,E.literalNode)(D.refErrorOper,!0,t.node.label):t));t.parseRef=(0,x.any)(me,he)},6930:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseResultHelper=void 0;const n=r(6366),a=r(6366),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6366),C=r(6067),A=r(6067),E=r(6067),T=r(6067),R=r(6366),k=r(6366),N=r(6366),I=r(6067),O=r(6067);function P(e,t){const r=e[t];return(0,n.assertTrue)("ParseResultHelper.getFormulaSpan: expected span to be defined",void 0!==r),r}class M extends A.IdentityVisitor{letNode(e,t,r,n,a,i){if(this.caretInNode(r?.arg))this.pushNames(t);else for(let r=0;r<t.length;r+=1){const{binder:n}=t[r];if(this.caretInNode(n.arg)){this.pushNames(e.id===y.WorksheetFuncId.LET?t.slice(0,r):t);break}}return super.letNode(e,t,r,n,a,i)}lambdaNode(e,t,r,n,a,i){if(this.caretInNode(r?.arg))this.pushNames(t);else for(let e=0;e<t.length;e+=1){const{name:r}=t[e];if(void 0!==r.arg.def&&this.caretInNode(r.arg.def.rhs)){this.pushNames(t.slice(0,e));break}}return super.lambdaNode(e,t,r,n,a,i)}caretInNode(e){if(void 0===e)return!1;const t=this.formula.spans[e.label];return void 0!==t&&this.caretPosition>=t.start&&this.caretPosition<=t.end}pushNames(e){(0,R.safePush)(this.references,e.map((({name:e})=>e.arg.wholeName)).filter(k.isDefined).reverse())}constructor(e,t){super(),this.formula=e,this.caretPosition=t,this.references=[]}}function D(e,t,r,n,y=!1,A,R){if(!(0,b.isSuccess)(e))return!1;try{!function(e,t,r,n,a,S,v){if(null==e||null==n)return;const F={};null!=r?r.forEach((e=>{F[e]=!0})):F["*"]=!0;const y={};{let t=0;const r=[],n={...T.voidVisitor,letNode(n,a,i,o,s,u){for(const{name:e}of a)y[e.arg.label]=t;r.push({letCount:t,span:P(e.spans,u)}),t+=1},lambdaNode(n,a,i,o,s,u){for(const{name:e}of a)y[e.arg.label]=t;r.push({letCount:t,span:P(e.spans,u)}),t+=1}};(0,E.reduceBottomUp)(n,e),r.sort(((e,t)=>e.span.start-t.span.start));const a={};for(let e=0;e<r.length;e+=1)a[r[e].letCount]=e;for(const e of Object.keys(y).map(Number))y[e]=a[y[e]]}const A={literalNode(e,t,r){const a=C.identityVisitor.literalNode(e,t,r);return R("literal")&&n("literal",{label:r,value:a,valueKind:e.kind}),a},missingNode(e,t){const r=C.identityVisitor.missingNode(e,t);return R("literal")&&n("literal",{label:t,value:(0,f.literalNode)(O.missingOper,!0,t),valueKind:I.OperKind.Missing}),r},arrayNode:(e,t,r)=>C.identityVisitor.arrayNode(e,t,r),appNode(e,t,r,n){const a=C.identityVisitor.appNode(e,t,r,n);return N(e,0,r,n),a},letNode(e,t,r,a,i,o){const s=(0,m.letNode)(e,t,r,a,i,o);N(e,s.args,i,o);for(const{name:e}of t)R("letName")&&n("letName",{label:e.arg.label,name:e.arg.wholeName,number:y[e.arg.label],qualifier:void 0});return s},lambdaNode(e,t,r,a,o,s){const u=(0,i.lambdaNode)(e,t,r,a,o,s);N(e,u.args,o,s);for(const{name:e}of t)R("letName")&&n("letName",{label:e.arg.name.name.label,name:e.arg.wholeName,number:y[e.arg.label],qualifier:void 0});return u},parenNode:(e,t,r)=>C.identityVisitor.parenNode(e,t,r),nameNode(t,r,a){const i=(0,h.nameNode)(t,r,a),o=e.annotations[t.label],s=e.annotations[a];if(s?.kind===d.AnnotationKind.AppHeadName);else if(o?.kind===d.AnnotationKind.LocalNameUse){const e=y[o.label];R("letName")&&null!=e&&n("letName",{label:a,name:o.name,number:e,qualifier:void 0})}else if(R("namedRange")){const e=i.whole.split(".");n("namedRange",{label:a,name:e[0],names:e.slice(1),qualifier:k(i)})}return i},cellRefNode(t,r,a){const i=(0,g.cellRefNode)(t,r,a);return R("range")&&function(t){if(null!=e&&null!=n)switch(t.ref.kind){case u.CellRefKind.Error:break;case u.CellRefKind.Col:const r=t.ref;n("range",{label:t.label,type:"col",startIndex:r.col1,endIndex:r.col2,span:P(e.spans,r.label),qualifier:k(t)});break;case u.CellRefKind.Row:const a=t.ref;n("range",{label:t.label,type:"row",startIndex:a.row1,endIndex:a.row2,span:P(e.spans,a.label),qualifier:k(t)});break;case u.CellRefKind.Single:const i=t.ref;n("range",{label:t.label,type:"cell",row:i.row,col:i.col,span:P(e.spans,i.label),qualifier:k(t)});break;case u.CellRefKind.Range:const o=t.ref;n("range",{label:t.label,type:"range",top:o.ref1.row,left:o.ref1.col,bottom:o.ref2.row,right:o.ref2.col,topLeftSpan:P(e.spans,o.ref1.label),bottomRightSpan:P(e.spans,o.ref2.label),qualifier:k(t)})}}(i),i},fieldRefNode:(e,t,r)=>C.identityVisitor.fieldRefNode(e,t,r),structRefNode(t,r,a){const i=(0,p.structRefNode)(t,r,a);if(R("structRefRange")){if(null==v||null==S)return i;const{resolution:r}=v.resolveStructRef(S,i);if(!(0,b.isSuccess)(r)||void 0===r.value)return i;const o=r.value;n("structRefRange",{label:a,type:"range",top:(0,l.pos)(c.PosKind.Rel,o.range.row),left:(0,l.pos)(c.PosKind.Rel,o.range.col),bottom:(0,l.pos)(c.PosKind.Rel,o.range.row+o.range.rows-1),right:(0,l.pos)(c.PosKind.Rel,o.range.col+o.range.cols-1),span:P(e.spans,a),qualifier:void 0!==t?k(t):void 0,name:void 0!==t?t.whole:void 0})}return i},badSequenceNode:(e,t,r)=>C.identityVisitor.badSequenceNode(e,t,r),badCharsNode:(e,t,r)=>C.identityVisitor.badCharsNode(e,t,r),operatorNode:(e,t)=>C.identityVisitor.operatorNode(e,t),wsfNode:(e,t,r)=>C.identityVisitor.wsfNode(e,t,r)};function R(e){return F[e]||F["*"]}function k(e){if(null!=e.qualifier){const t={};switch(e.qualifier.kind){case s.QualifierKind.Sheet:const r=e.qualifier;t.type="Sheet",t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case s.QualifierKind.SheetRange:const n=e.qualifier;t.type="SheetRange",t.sheet1=n.sheet1,t.sheet2=n.sheet2,null!=n.document&&(t.document=n.document.document,null!=n.document.path&&(t.documentPath=n.document.path));break;case s.QualifierKind.Ident:const a=e.qualifier;t.type="Ident",t.name=a.name;break;case s.QualifierKind.Document:const i=e.qualifier;t.type="Document",t.document=i.document,null!=i.path&&(t.documentPath=i.path)}return t}}function N(e,t,r,a){if(null!=n)switch(e.kind){case o.NodeKind.Operator:R("operator")&&n("operator",{label:a,value:e.id});break;case o.NodeKind.WSF:case o.NodeKind.Name:R("function")&&n("function",{label:a,name:e.whole,isClosed:r,args:[]})}}(0,E.reduceBottomUp)(A,e)}(e.value,n??(0,S.getEnglishLocaleInfo)(),t,r,0,A,R)}catch(e){const t=`ParseResultHelper.traverse: unhandled error ${(0,N.messageFromError)(e)}`;a.ulsLogger.ULS.traceTag(507381982,v.LogCategory.msoulscat_ES_EWAJS,F.TraceLevel.Warning,t)}return!0}t.parseResultHelper={isSuccess:b.isSuccess,traverse:D,extractReferences:function(e,t,r=!1,n,a){if(!(0,b.isSuccess)(e))return;const i=[];return D(e,["range","namedRange","letName","literal","function","structRefRange"],((t,r)=>{const n={kind:t,ref:r,span:P(e.value.spans,r.label)};i.push(n)}),t,r,n,a),i.sort(((e,t)=>{let r;return 0!=(r=e.span.start-t.span.start)||0!=(r=t.span.end-e.span.end)?r:0})),i},extractLetVariables:function(e,t){if((0,b.isSuccess)(e))try{const r=new M(e.value,t);return(0,E.reduceBottomUp)(r,e.value),r.references.reverse()}catch(e){const t=`ParseResultHelper.extractLetVariables: unhandled error ${(0,N.messageFromError)(e)}`;return a.ulsLogger.ULS.traceTag(507381983,v.LogCategory.msoulscat_ES_EWAJS,F.TraceLevel.Warning,t),[]}}}},4689:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseStructRef=void 0;const n=r(3153),a=r(4354),i=r(5634),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(2736),p=r(1817),f=r(6366),S=(0,n.take)(((e,t)=>t.isIdentContinue||t.kind===p.TokenKind.Spaces?t:void 0)),v=(0,n.apply)((0,n.many1)(S),((e,t)=>{const r=t[0];return 1===t.length?r:(0,p.identToken)(r.start,t.map((e=>e.kind===p.TokenKind.Escape?"":e.chars)).join(""))})),F=(0,n.take)(((e,t)=>t.isIdentContinue||t.kind===p.TokenKind.Spaces||t.kind===p.TokenKind.Escape||(0,i.isListSepToken)(t)||(0,i.isRangeOpToken)(t)?t:void 0)),y=(0,n.apply)((0,n.many1)(F),((e,t)=>{const r=t[0];return 1===t.length?r:(0,p.identToken)(r.start,t.map((e=>e.kind===p.TokenKind.Escape?"":e.chars)).join(""))})),b=(0,n.take)(((e,t)=>t.kind===p.TokenKind.SpecialRef?t:void 0)),C=(0,n.apply)((0,n.tuple)(i.parseCharIndex,b,i.parseCharIndex),((e,[t,r,n])=>(0,l.specialRef)(r.value,!1,!0,(0,h.addSpan)(e,t,n,"","")))),A=(0,n.apply)((0,n.tuple)(i.parseCharIndex,i.parseLeftBracket,b,(0,n.opt)(i.parseRightBracket,void 0),i.parseCharIndex),((e,[t,r,n,a,i])=>(0,l.specialRef)(n.value,!0,void 0!==a,(0,h.addSpan)(e,t,i,"","")))),E=(0,n.any)(C,A),T=(0,n.apply)((0,n.tuple)(i.parseCharIndex,v,i.parseCharIndex),((e,[t,r,n])=>(0,o.columnRef)(r.chars,!1,!0,(0,h.addSpan)(e,t,n,"","")))),R=(0,n.apply)((0,n.tuple)(i.parseCharIndex,i.parseLeftBracket,(0,n.opt)(y,void 0),(0,n.opt)(i.parseRightBracket,void 0),i.parseCharIndex),((e,[t,r,n,a,i])=>(0,o.columnRef)(n?.chars??"",!0,void 0!==a,(0,h.addSpan)(e,t,i,"","")))),k=(0,n.apply)((0,n.tuple)(i.parseCharIndex,y,i.parseCharIndex),((e,[t,r,n])=>(0,o.columnRef)(r.chars,!1,!0,(0,h.addSpan)(e,t,n,"","")))),N=(0,n.any)(T,R),I=(0,n.apply)(i.parseCharIndex,((e,t)=>(0,g.missingRef)((0,h.addSpan)(e,t,t,"","")))),O=(0,n.any)(N,I),P=(0,n.take)(((e,t)=>"#"===t.chars?t:void 0)),M=(0,n.apply)((0,n.many1)(P,S),((e,t)=>(0,p.unexpectedToken)(t[0].start,t.map((e=>e.chars)).join("")))),D=(0,n.apply)((0,n.many1)(P,F),((e,t)=>(0,p.unexpectedToken)(t[0].start,t.map((e=>e.chars)).join("")))),w=(0,n.apply)((0,n.tuple)(i.parseCharIndex,M,i.parseCharIndex),((e,[t,r,n])=>(0,m.badRef)(r.chars,!1,!0,(0,h.addSpan)(e,t,n,"","")))),L=(0,n.apply)((0,n.tuple)(i.parseCharIndex,i.parseLeftBracket,D,(0,n.opt)(i.parseRightBracket,void 0),i.parseCharIndex),((e,[t,r,n,a,i])=>(0,m.badRef)(n.chars,!0,void 0!==a,(0,h.addSpan)(e,t,i,"","")))),_=(0,n.any)(w,L),x=(0,n.apply)((0,n.tuple)(i.parseCharIndex,O,i.parseRangeOp,O,i.parseCharIndex),((e,[t,r,n,a,i])=>(0,u.rangeOpRef)(r,a,(0,h.addSpan)(e,t,i,"","")))),K=(0,n.any)(x,N),W=(0,n.any)(E,_,x,N,I),U=(0,n.apply)((0,n.tuple)(i.parseCharIndex,W,(0,n.many1)((0,n.tuple)(i.parseListSep,W)),i.parseCharIndex),((e,[t,r,n,a])=>(0,c.commaOpRef)([r,...n.map((([e,t])=>t))],(0,h.addSpan)(e,t,a,"","")))),G=(0,n.apply)((0,n.tuple)(i.parseCharIndex,i.parseAtOp,(0,n.opt)(K,void 0),i.parseCharIndex),((e,[t,r,n,a])=>(0,d.thisRowOpRef)(n,(0,h.addSpan)(e,t,a,"","")))),B=(0,n.apply)(i.parseSpacesOnly,(()=>{})),V=(0,n.any)((0,n.left)(B,i.parseEnd),(0,n.left)(k,i.parseEnd),(0,n.left)(U,i.parseEnd),(0,n.left)(G,i.parseEnd),(0,n.left)(x,i.parseEnd),(0,n.left)(E,i.parseEnd),(0,n.left)(_,i.parseEnd),(0,n.left)(R,i.parseEnd));t.parseStructRef=(0,n.applyTake)((0,n.tuple)(i.parseCharIndex,i.parseBracketedTokens,i.parseCharIndex),((e,[t,[r,i],o])=>{const u=(0,n.runParser)(V,r,0,e);return(0,f.isSuccess)(u)?(0,a.structRefTerm)((0,s.structRef)(u.value.output,i,(0,h.addSpan)(e,t,o,"","")),t,o):void 0}))},3153:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concat=t.flatten=t.middle=t.right=t.left=t.tuple=t.many1=t.many=t.reduce=t.applyTake=t.takePeek=t.peek=t.take=t.fails=t.succeeds=t.opt=t.any=t.withState=t.apply=t.bind=t.parseFail=t.parseSucceed=t.warnSucceedOrFail=t.setDebugging=t.lazy=t.runParser=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6366);t.runParser=function(e,t,r,s){let u;if(function(e){let t=e;for(;null!=t;)t=t()}(e(t,r,s,(function(e,t){u=(0,i.success)({output:e,index:t})}),(function(){u=(0,o.failure)(void 0)}))),null==u){const e=`calc.parse.runParser: internal error: parser did not call resolve or reject on ${(0,a.anonymize)(t)}`;return(0,n.assertFalse)(e)}return u},t.lazy=function(e){let t;return function(r,n,a,i,o){const s=t??(t=e());return()=>s(r,n,a,i,o)}};let u=!1;function l(e){return function(t,r,n,a,i){return a(e,r)}}t.setDebugging=function(e){u=e},t.warnSucceedOrFail=function(e,t){return function(r,n,a,i,o){return e(r,n,a,((e,n)=>(u&&console.warn(`${t} succeeded, returning index ${n} (of ${r.length}) with`,e),i(e,n))),(()=>(u&&console.warn(`${t} failed at index ${n} (of ${r.length})`),o)))}},t.parseSucceed=l;const c=(e,t,r,n,a)=>a;function d(){return c}function g(e,t){return function(r,n,a,i,o){return e(r,n,a,((e,n)=>t(a,e)(r,n,a,i,o)),o)}}function m(e,t){return function(r,n,a,i,o){return e(r,n,a,((e,r)=>i(t(a,e),r)),o)}}function h(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(()=>t(r,n,a,i,o)))}}function p(e,t){return function(r,n,a,i,o){const s=r[n];if(null==s)return o;const u=e(a,s);return null==u?o:i(u,n+t)}}function f(e,t,r){return function(i,o,s,u,l){let c=r,d=o;function g(){return e(i,d,s,m,h)}function m(e,r){if(r<=d){const e=(0,a.anonymize)(i),t=`calc.parse.reduce: internal error: no progress made at index ${d} on ${e}`;return(0,n.assertFalse)(t)}return c=t(s,e,c),d=r,g}function h(){return u(c,d)}return g}}function S(e,t){return f(e,(function(e,t,r){return r.push(t),r}),t)}function v(...e){if(0===e.length)return l([]);if(1===e.length)return m(e[0],((e,t)=>[t]));const t=e.length;return function(r,n,a,i,o){let s=n;const u=[];function l(){return e[u.length](r,s,a,c,o)}function c(e,r){return s=r,u.push(e),u.length<t?l:i(u,s)}return l}}function F(e){return m(e,((e,t)=>(0,s.safeConcat)([],t)))}t.parseFail=d,t.bind=g,t.apply=m,t.withState=function(e){return(t,r,n,a,i)=>e(n)(t,r,n,a,i)},t.any=function(...e){return 0===e.length?d():e.reduce(h)},t.opt=function(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(()=>i(t,n)))}},t.succeeds=function(e){return function(t,r,n,a,i){return e(t,r,n,(()=>a(!0,r)),i)}},t.fails=function(e){return function(t,r,n,a,i){return e(t,r,n,i,(()=>a(!0,r)))}},t.take=function(e){return p(e,1)},t.peek=function(e){return p(e,0)},t.takePeek=function(e){return function(t,r,n,a,i){const o=t[r],s=t[r+1];if(null==o||null==s)return i;const u=e(n,o,s);return null==u?i:a(u,r+1)}},t.applyTake=function(e,t){return function(r,n,a,i,o){return e(r,n,a,((e,r)=>{const n=t(a,e);return null==n?o:i(n,r)}),o)}},t.reduce=f,t.many=function(e,t){return void 0===t?function(t,r,n,a,i){return S(e,[])(t,r,n,a,i)}:function(r,n,a,i,o){return e(r,n,a,((e,n)=>S(t,[e])(r,n,a,i,o)),(()=>i([],n)))}},t.many1=function(e,t=e){return g(e,((e,r)=>S(t,[r])))},t.tuple=v,t.left=function(e,t){return m(v(e,t),((e,[t])=>t))},t.right=function(e,t){return m(v(e,t),((e,[,t])=>t))},t.middle=function(e,t,r){return m(v(e,t,r),((e,[,t])=>t))},t.flatten=F,t.concat=function(...e){return F(v(...e))}},9838:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=void 0;const n=r(6805),a=r(5237),i=r(6898),o=r(6067),s=r(6366),u=r(6366),l=r(6366),c=r(6366),{codePointEqualsSign:d,codePointPlusSign:g,codePointMinusSign:m,codePointAtSign:h}=c.codePoint,p={[d]:1,[g]:0,[m]:0,[h]:-1};function f(e,t,r,i){const o=t.config?.localeInfo??e.config.localeInfo,s=t.config?.refStyle??e.config.refStyle,u=e.config.mathpack,c=(0,n.tokenizeFormula)(o,u,s,t.originGridCell.value,r,i,t.syntaxFeatures),d=(0,a.runFormulaParser)(o,u,s,t.lexicalKind,t.originGridCell.value,t.contextNames,t.syntaxFeatures,c);return(0,l.success)(d)}t.createParser=function(e){return{parseFormula:(t,r,n)=>function(e,t,r,n=0){try{const a=n>=0&&n<r.length?p[r.charCodeAt(n)]:void 0;return null==a?(0,s.failure)((0,i.notFormulaString)("first character is not '=', '+', '-' or '@'")):a<0?(0,s.failure)((0,o.notImplemented)(["Lotus 1-2-3 syntax"])):f(e,t,r,n+a)}catch(e){return(0,s.failure)((0,u.javaScriptError)(e))}}(e,t,r,n),parseFormulaExpression:(t,r,n)=>function(e,t,r,n=0){try{return f(e,t,r,n)}catch(e){return(0,s.failure)((0,u.javaScriptError)(e))}}(e,t,r,n)}}},2736:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cellRefMustBeCellRefNode=t.withDelim=t.addSpan=t.addWhitespace=t.getSpan=t.getNodeSpan=t.makeState=t.ListSep=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(1817),s=r(6067),u=r(6067),l=r(6067),c=r(5634);var d;!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(d||(t.ListSep=d={})),t.makeState=function(e,t,r,n,a){return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:n,origin:a,delim:{delimId:void 0,listSep:d.Union,stack:{[o.DelimId.Paren]:!1,[o.DelimId.Brace]:!1,[o.DelimId.Bracket]:!1}},cellRefMustBeCellRefNode:!1,label:1,spans:[]}},t.getNodeSpan=function(e,t){const r=e.spans[t.label];if(null==r){const e=`calc.parse.getNodeSpan: internal error: expected node to have a span; given ${(0,n.anonymize)(t)}`;(0,a.assertFalse)(e)}return r},t.getSpan=function(e,t){const r=e.spans[t];return(0,i.assertTrue)("calc.parse.getSpan: internal error: expected label to have a span",null!=r),r};const g=[];function m(e,t){const r="string"==typeof t?g:t.filter(c.isCommentToken);return["string"==typeof t?t:t.map((e=>e.chars)).join(""),r.length>0?r.map((t=>function(e,t){const r=h(e,t.start,t.start+t.chars.length,"","");return t.kind===o.TokenKind.SingleLineComment?(0,s.singleLineComment)(t.chars,r):(0,u.multiLineComment)(t.chars,t.isClosed,r)}(e,t))):void 0]}function h(e,t,r,n,a){const i=e.label;e.label+=1;const[o,s]=m(e,n),[u,c]=m(e,a);return e.spans[i]=(0,l.formulaSpan)(t,r,o,u,s,c),i}function p(e,t,r){return(n,a,i,o,s)=>{const u=e(i);return r(n,a,i,((e,r)=>(t(i,u),o(e,r))),(()=>(t(i,u),s)))}}t.addWhitespace=m,t.addSpan=h,t.withDelim=function({delimId:e,listSep:t},r){return p((r=>{const n=r.delim;return r.delim={delimId:e,listSep:t,stack:{...n.stack,[e]:!0}},n}),((e,t)=>e.delim=t),r)},t.cellRefMustBeCellRefNode=function(e){return p((e=>{const t=e.cellRefMustBeCellRefNode;return e.cellRefMustBeCellRefNode=!0,t}),((e,t)=>e.cellRefMustBeCellRefNode=t),e)}},6898:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notFormulaString=t.ReasonKind=t.parseLocals=t.createParseGlobals=void 0;const n=r(6067),a=r(6366);var i;t.createParseGlobals=function(e){return{config:e}},t.parseLocals=function(e,t,r,n,i){return{config:r??void 0,lexicalKind:e,originGridCell:(0,a.success)(t),contextNames:n,syntaxFeatures:i}},function(e){e.NotFormulaString="NotFormulaString"}(i||(i={})),t.ReasonKind={...n.ReasonKind,...i},t.notFormulaString=function(e){return{kind:t.ReasonKind.NotFormulaString,message:e}}},1817:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rangeOperatorToken=t.geOperatorToken=t.leOperatorToken=t.neOperatorToken=t.gtOperatorToken=t.ltOperatorToken=t.eqOperatorToken=t.concatOperatorToken=t.percentOperatorToken=t.powOperatorToken=t.divOperatorToken=t.mulOperatorToken=t.subOperatorToken=t.addOperatorToken=t.operatorToken=t.identOrBooleanToken=t.literalToken=t.cellRefR1C1Token=t.cellRefA1Token=t.specialRefToken=t.assignSepToken=t.dotSepToken=t.qualSepToken=t.rowSepToken=t.colSepToken=t.listSepToken=t.rightSQuoteToken=t.rightBraceToken=t.rightBracketToken=t.rightParenToken=t.leftSQuoteToken=t.leftBraceToken=t.leftBracketToken=t.leftParenToken=t.identToken=t.multiLineCommentToken=t.singleLineCommentToken=t.escapeToken=t.unexpectedToken=t.spacesToken=t.endToken=t.badErrorOper=t.isBadErrorOper=t.badNumberOper=t.isNumberLikeOper=t.isBadNumberOper=t.TokenOperKind=t.SepId=t.DelimId=t.TokenKind=void 0,t.appendToken=t.poundOperatorToken=t.atOperatorToken=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6366),d=r(6366),g=r(6067),{codePointAsterisk:m,codePointMinusSign:h,codePointPlusSign:p,codePointSlash:f,codePointSpace:S}=d.codePoint;var v,F,y,b;function C(e){return e.kind===b.BadNumber||e.kind===l.OperKind.Number}function A(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:n}}function E(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:!1,value:n}}function T(e,t,r,n,a,i,o){return{kind:v.CellRef,start:e,chars:t,isIdentContinue:r,row:n,col:a,refStyle:i,isBadLocale:o}}function R(e,t,r,n=!0){const a=r.kind===l.OperKind.Boolean||C(r)&&function(e){for(const t of(0,c.codePointIterator)(e))if(t===p||t===h||t===m||t===S||t===f)return!1;return!0}(t);return{kind:v.Literal,start:e,chars:t,isIdentContinue:a,oper:r,hasRight:n}}function k(e,t,r){return{kind:v.Operator,start:e,chars:t,isIdentContinue:!1,value:r}}function N(e){const t=n.operatorStrings[e];if(null==t)throw new Error(`operatorTokenMaker: invalid operator ${e}`);return r=>k(r,t,e)}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected",e[e.Escape=12]="Escape",e[e.SingleLineComment=13]="SingleLineComment",e[e.MultiLineComment=14]="MultiLineComment"}(v||(t.TokenKind=v={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(F||(t.DelimId=F={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual",e[e.Dot=5]="Dot",e[e.Assign=6]="Assign"}(y||(t.SepId=y={})),function(e){e.BadNumber="BadNumber",e.BadError="BadError"}(b||(t.TokenOperKind=b={})),t.isBadNumberOper=function(e){return e.kind===b.BadNumber},t.isNumberLikeOper=C,t.badNumberOper={kind:b.BadNumber},t.isBadErrorOper=function(e){return e.kind===b.BadError},t.badErrorOper={kind:b.BadError},t.endToken=e=>A(v.End,e,"",!1),t.spacesToken=(e,t)=>A(v.Spaces,e,t,!1),t.unexpectedToken=(e,t)=>A(v.Unexpected,e,t,!1),t.escapeToken=(e,t)=>A(v.Escape,e,t,!1),t.singleLineCommentToken=(e,t)=>A(v.SingleLineComment,e,t,!1),t.multiLineCommentToken=(e,t,r)=>({kind:v.MultiLineComment,start:e,chars:t,isIdentContinue:!1,isClosed:r}),t.identToken=(e,t)=>A(v.Ident,e,t,!0),t.leftParenToken=e=>E(v.Left,e,"(",F.Paren),t.leftBracketToken=(e,t)=>E(v.Left,e,t,F.Bracket),t.leftBraceToken=(e,t)=>E(v.Left,e,t,F.Brace),t.leftSQuoteToken=e=>E(v.Left,e,"'",F.SQuote),t.rightParenToken=e=>E(v.Right,e,")",F.Paren),t.rightBracketToken=(e,t)=>E(v.Right,e,t,F.Bracket),t.rightBraceToken=(e,t)=>E(v.Right,e,t,F.Brace),t.rightSQuoteToken=e=>E(v.Right,e,"'",F.SQuote),t.listSepToken=(e,t)=>E(v.Sep,e,t,y.List),t.colSepToken=(e,t)=>E(v.Sep,e,t,y.Col),t.rowSepToken=(e,t)=>E(v.Sep,e,t,y.Row),t.qualSepToken=e=>E(v.Sep,e,"!",y.Qual),t.dotSepToken=e=>E(v.Sep,e,".",y.Dot),t.assignSepToken=e=>E(v.Sep,e,":=",y.Assign),t.specialRefToken=(e,t,r)=>E(v.SpecialRef,e,t,r),t.cellRefA1Token=function(e,t,r,n){return T(e,t,(null==r||"object"==typeof r&&r.kind===o.PosKind.Rel)&&(null==n||"object"==typeof n&&n.kind===o.PosKind.Rel),r,n,i.RefStyle.A1,!1)},t.cellRefR1C1Token=function(e,t,r,n,a=!1){return T(e,t,!(r!==g.SpecialPos.RCNoNum&&null!=r&&r.kind!==o.PosKind.Abs||n!==g.SpecialPos.RCNoNum&&null!=n&&n.kind!==o.PosKind.Abs),r,n,i.RefStyle.R1C1,a)},t.literalToken=R,t.identOrBooleanToken=function(e,r,n){return 0===e.stringCompareCI(e.falseName,n)?R(r,n,s.falseOper):0===e.stringCompareCI(e.trueName,n)?R(r,n,u.trueOper):(0,t.identToken)(r,n)},t.operatorToken=k,t.addOperatorToken=N(a.OperatorId.Add),t.subOperatorToken=N(a.OperatorId.Sub),t.mulOperatorToken=N(a.OperatorId.Mul),t.divOperatorToken=N(a.OperatorId.Div),t.powOperatorToken=N(a.OperatorId.Pow),t.percentOperatorToken=N(a.OperatorId.Percent),t.concatOperatorToken=N(a.OperatorId.Concat),t.eqOperatorToken=N(a.OperatorId.Eq),t.ltOperatorToken=N(a.OperatorId.Lt),t.gtOperatorToken=N(a.OperatorId.Gt),t.neOperatorToken=N(a.OperatorId.Ne),t.leOperatorToken=N(a.OperatorId.Le),t.geOperatorToken=N(a.OperatorId.Ge),t.rangeOperatorToken=N(a.OperatorId.Range),t.atOperatorToken=N(a.OperatorId.At),t.poundOperatorToken=N(a.OperatorId.Pound),t.appendToken=function(e,t,r){return r.push(t),t.start+e}},6805:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizeFormula=void 0;const n=r(6366),a=r(6366),i=r(1817),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6366),m=r(6067),h=r(6067),p=r(5430),f=r(6366),S=r(6366),v=r(6366),F=r(6366),y=r(6366),b=r(6366),C=r(5634),{codePointAsterisk:A,codePointAtSign:E,codePointColon:T,codePointDoubleQuote:R,codePointExclamationMark:k,codePointHash:N,codePointLeftParen:I,codePointQuestionMark:O,codePointRightParen:P,codePointSingleQuote:M,codePointFullStop:D,codePointDigitZero:w,codePointSlash:L,codePointMinusSign:_,codePointSpace:x,codePointInvertedExclamationMark:K,codePointInvertedQuestionMark:W,codePointLeftSingleQuotationMark:U,codePointRightSingleQuotationMark:G}=F.codePoint;let B;function V(e){if(!B){B=(0,g.makeStringMap)();for(const e of Object.getOwnPropertyNames(j))B[e.charCodeAt(0)]=!0;for(const e of Object.getOwnPropertyNames(H))B[e.charCodeAt(0)]=!0}return!0===B[e]}const j={"+":i.addOperatorToken,"-":i.subOperatorToken,"*":i.mulOperatorToken,"/":i.divOperatorToken,"^":i.powOperatorToken,"%":i.percentOperatorToken,"&":i.concatOperatorToken,"=":i.eqOperatorToken,"<":i.ltOperatorToken,">":i.gtOperatorToken,":":i.rangeOperatorToken,".":i.dotSepToken,"@":i.atOperatorToken,"#":i.poundOperatorToken},H={"<>":i.neOperatorToken,"<=":i.leOperatorToken,">=":i.geOperatorToken};function q(e,t,r){if(t<e.length-1){const n=H[e.substring(t,t+2)];if(null!=n)return(0,i.appendToken)(2,n(t),r)}const a=j[e.charAt(t)];return null!=a?(0,i.appendToken)(1,a(t),r):(0,n.assertFalse)("calc.parse.tokenizeOperator: internal error: expected operator")}function z(e,t,r,n,a){const o=(0,d.parseNumberLiteral)(e,t,r,n,!1,!1,!1);if(void 0===o)return;const{value:s,i:u}=o,l=r.substring(n,u);return(0,i.appendToken)(u-n,(0,i.literalToken)(n,l,s??i.badNumberOper,!0),a),u}const Q=(e,t)=>e.charCodeAt(t)!==R,$=(e,t)=>e.charCodeAt(t)===R;function Y(e,t,r){const[n,a]=(0,p.scanEscapedWhile)(e,t+1,Q,'"',$),o=e.substring(t,a+1);return a<e.length?(0,i.appendToken)(a+1-t,(0,i.literalToken)(t,o,(0,s.stringOper)(n),!0),r):(0,i.appendToken)(a-t,(0,i.literalToken)(t,o,(0,s.stringOper)(n),!1),r)}function J(e,t,r,n){for(let a=1;a<e.errorNames.length;a+=1){const s=e.errorNames[a];if(null==s)continue;const u=t.substring(r,r+s.length);if(0===e.stringCompareCI(s,u))return(0,i.appendToken)(s.length,(0,i.literalToken)(r,u,(0,o.errorOper)(a)),n)}let a=r+1,s=!1;for(;a<t.length;){const n=(0,S.stringCodePointAt)(t,a);if(a!==r+1||n!==K&&n!==W)if(!(a>r+1)||n!==L&&n!==_&&n!==x||s)if(a>r+1&&n===D)a+=1;else{if(a>r+1&&n===w){a+=1,a<t.length&&t.charCodeAt(a)===k&&(a+=1);break}if(n===k||n===O){a!==r+1&&(a+=1);break}if(!e.isIdentContinue(n)||e.isNumeral(n)){if(n!==U&&n!==G)break;a+=1}else a+=(0,f.numCodeUnits)(n)}else s=!0,a+=1;else a+=1}for(;a>r+1&&t.charCodeAt(a-1)===x;)--a;if(a>r+1){const e=t.substring(r,a);return(0,i.appendToken)(a-r,(0,i.literalToken)(r,e,i.badErrorOper),n)}}function X(e,t,r,n){for(let a=1;a<e.specialRefNames.length;a+=1){const o=e.specialRefNames[a];if(null==o)continue;const s=t.substring(r,r+o.length);if(0===e.stringCompareCI(o,s))return(0,i.appendToken)(o.length,(0,i.specialRefToken)(r,s,a),n)}}function Z(e,t,r){const n=t.charCodeAt(r);return!((0,l.isSpace)(n)||n===M||n===N||n===T||n===E||(0,y.stringStartsWith)(t,e.listSeparator,r)||(0,y.stringStartsWith)(t,e.leftBracket,r)||(0,y.stringStartsWith)(t,e.rightBracket,r))}const ee=(e,t)=>(0,l.isSpace)((0,S.stringCodePointAt)(e,t)),te=(e,t)=>!(0,c.isLineBreak)((0,S.stringCodePointAt)(e,t)),re=(e,t)=>!(t+1<e.length&&e.charCodeAt(t)===A&&e.charCodeAt(t+1)===L);function ne(e,t,r,n){let a=r,o=0;const s=(t,r)=>Z(e,t,r),u=(t,r)=>!Z(e,t,r),c=(0,p.makeProgressAsserter)("calc.parse.tokenizeBracketedRef",a);for(;a<t.length;){c(a);const r=(0,S.stringCodePointAt)(t,a);if(n.length>0&&n[n.length-1].kind===i.TokenKind.Escape&&u(t,a))a=(0,i.appendToken)((0,f.numCodeUnits)(r),(0,i.identToken)(a,(0,v.stringFromCodePoint)(r)),n);else if(r!==E){if(r===N){const r=X(e,t,a,n);if(null!=r){a=r;continue}}if(r!==M)if((0,y.stringStartsWith)(t,e.rightBracket,a)){if(a=(0,i.appendToken)(e.rightBracket.length,(0,i.rightBracketToken)(a,e.rightBracket),n),o-=1,0===o)return a}else if(s(t,a)){const[e,r]=(0,p.scanWhile)(t,a,s);a=(0,i.appendToken)(r-a,(0,i.identToken)(a,e),n)}else if((0,l.isSpace)(r)){const[e,r]=(0,p.scanWhile)(t,a,ee);a=(0,i.appendToken)(r-a,(0,i.spacesToken)(a,e),n)}else r!==T?(0,y.stringStartsWith)(t,e.listSeparator,a)?a=(0,i.appendToken)(e.listSeparator.length,(0,i.listSepToken)(a,e.listSeparator),n):(0,y.stringStartsWith)(t,e.leftBracket,a)&&o<2?(a=(0,i.appendToken)(e.leftBracket.length,(0,i.leftBracketToken)(a,e.leftBracket),n),o+=1):a=(0,i.appendToken)((0,f.numCodeUnits)(r),(0,i.unexpectedToken)(a,(0,v.stringFromCodePoint)(r)),n):a=(0,i.appendToken)(1,(0,i.rangeOperatorToken)(a),n);else a=(0,i.appendToken)(1,(0,i.escapeToken)(a,"'"),n)}else a=(0,i.appendToken)(1,(0,i.atOperatorToken)(a),n)}return a}function ae(e,t,r,n){let a=(0,i.appendToken)(1,(0,i.leftSQuoteToken)(r),n);const o=(t,r)=>function(e,t,r){const n=t.charCodeAt(r);return n!==M&&n!==T&&n!==A&&n!==O&&!(0,y.stringStartsWith)(t,e.leftBracket,r)&&!(0,y.stringStartsWith)(t,e.rightBracket,r)}(e,t,r),s=(e,t)=>e.charCodeAt(t)===M,u=(0,p.makeProgressAsserter)("calc.parse.tokenizeQuotedQualifier",a);for(;a<t.length;){u(a);const r=(0,S.stringCodePointAt)(t,a);if(r===M&&!(a+1<t.length&&t.charCodeAt(a+1)===M))return(0,i.appendToken)(1,(0,i.rightSQuoteToken)(a),n);if(r!==T)if((0,y.stringStartsWith)(t,e.leftBracket,a))a=(0,i.appendToken)(e.leftBracket.length,(0,i.leftBracketToken)(a,e.leftBracket),n);else if((0,y.stringStartsWith)(t,e.rightBracket,a))a=(0,i.appendToken)(e.rightBracket.length,(0,i.rightBracketToken)(a,e.rightBracket),n);else if((0,p.getEscapedSkip)(t,a,o,"'",s)>0){const[e,r]=(0,p.scanEscapedWhile)(t,a,o,"'",s);a=(0,i.appendToken)(r-a,(0,i.identToken)(a,e),n)}else a=(0,i.appendToken)((0,f.numCodeUnits)(r),(0,i.unexpectedToken)(a,(0,v.stringFromCodePoint)(r)),n);else a=(0,i.appendToken)(1,(0,i.rangeOperatorToken)(a),n)}return a}function ie(e,t,r,n,a,o){const s=(0,u.parseCellRef)(e,t,r,n,a);if(null!=s){const e=s.i,t=n.substring(e,a),r=s.refStyle===m.RefStyle.A1?(0,i.cellRefA1Token)(a,t,s.row,s.col):(0,i.cellRefR1C1Token)(a,t,s.row,s.col,s.enLocale);return(0,i.appendToken)(e-a,r,o)}}function oe(e,t,r,n){let a=n.length-1,o=n[a];if(null==o)return!0;if(o.kind===i.TokenKind.Sep&&o.value===i.SepId.Dot)return!1;if((0,y.stringStartsWith)(t,e.decimalSeparator,r)){for(;null!=o&&(0,C.isWhitespaceToken)(o);)o=n[--a];return null==o||o.kind!==i.TokenKind.Ident&&o.kind!==i.TokenKind.CellRef&&o.kind!==i.TokenKind.Right&&(o.kind!==i.TokenKind.Literal||(0,i.isNumberLikeOper)(o.oper))}return e.isNumeral((0,S.stringCodePointAt)(t,r))}function se(e,t,r,n){let a=e[t],i=t+1;for(;i<e.length;i+=1){const t=e[i];if(t.kind!==r)break;a=n(a,t)}return[a,i]}t.tokenizeFormula=function(e,t,r,n,o,s,u){const[c,d]=function(e,t,r,n,o,s,u){const c=[],d=[];let g=s;const m=!0===u?.[h.SyntaxFeature.Comments],F=!0===u?.[h.SyntaxFeature.Statements],C=!(0,y.stringStartsWith)(e.statementSeparator,e.columnSeparator)&&!(0,y.stringStartsWith)(e.statementSeparator,e.rowSeparator),E=!(0,y.stringStartsWith)(e.statementSeparator,e.listSeparator)&&!(0,y.stringStartsWith)(e.statementSeparator,e.decimalSeparator),T=(0,p.makeProgressAsserter)("calc.parse.tokenize",g);for(;g<o.length;){T(g);const s=ie(e,r,n,o,g,c);if(null!=s){g=s;continue}const u=(0,S.stringCodePointAt)(o,g),h=d.length>0&&d[d.length-1].delim===i.DelimId.Brace;if(oe(e,o,g,c)){const r=z(e,t,o,g,c);if(null!=r){g=r;continue}}if(u!==R)if(!e.isIdentContinue(u)||(0,y.stringStartsWith)(o,e.listSeparator,g)||h&&(0,y.stringStartsWith)(o,e.columnSeparator,g)||h&&(0,y.stringStartsWith)(o,e.rowSeparator,g))if(u!==N)if((0,l.isSpace)(u)){const[e,t]=(0,p.scanWhile)(o,g,ee);g=(0,i.appendToken)(t-g,(0,i.spacesToken)(g,e),c)}else if(u!==I)if(u!==P)if((0,y.stringStartsWith)(o,e.leftBrace,g))d.push({delim:i.DelimId.Brace,lastParen:d.length>0?d[d.length-1].lastParen:void 0,lastBrace:d.length}),g=(0,i.appendToken)(e.leftBrace.length,(0,i.leftBraceToken)(g,e.leftBrace),c);else if((0,y.stringStartsWith)(o,e.rightBrace,g)){const t=d.length>0?d[d.length-1].lastBrace:void 0;void 0!==t&&(d.length=t),g=(0,i.appendToken)(e.rightBrace.length,(0,i.rightBraceToken)(g,e.rightBrace),c)}else if((0,y.stringStartsWith)(o,e.leftBracket,g))g=ne(e,o,g,c);else if((0,y.stringStartsWith)(o,e.rightBracket,g))g=(0,i.appendToken)(e.rightBracket.length,(0,i.rightBracketToken)(g,e.rightBracket),c);else{if(h){if(F&&C&&(0,y.stringStartsWith)(o,e.statementSeparator,g))break;if((0,y.stringStartsWith)(o,e.columnSeparator,g)){g=(0,i.appendToken)(e.columnSeparator.length,(0,i.colSepToken)(g,e.columnSeparator),c);continue}if((0,y.stringStartsWith)(o,e.rowSeparator,g)){g=(0,i.appendToken)(e.rowSeparator.length,(0,i.rowSepToken)(g,e.rowSeparator),c);continue}}if(F&&(0,y.stringStartsWith)(o,e.statementSeparator,g)&&(E||0===d.length))break;if((0,y.stringStartsWith)(o,e.listSeparator,g))g=(0,i.appendToken)(e.listSeparator.length,(0,i.listSepToken)(g,e.listSeparator),c);else if(u!==k)if(u!==M){if(u===L&&g+1<o.length&&m){const e=o.charCodeAt(g+1);if(e===L){const[e,t]=(0,p.scanWhile)(o,g,te);g=(0,i.appendToken)(t-g,(0,i.singleLineCommentToken)(g,e),c);continue}if(e===A){let[e,t]=(0,p.scanWhile)(o,g+2,re);const r=(0,y.stringStartsWith)(o,"*/",t);(0,a.assertTrue)("calc.parse.tokenize: /**/",r||t===o.length),t+=r?2:0,e="/*"+e+(r?"*/":""),g=(0,i.appendToken)(t-g,(0,i.multiLineCommentToken)(g,e,r),c);continue}}if(V(u)){if((0,y.stringStartsWith)(o,":=",g)&&(0,b.isFeatureEnabled)(b.FeatureName.CalcLambdaDefaultParameters)){g=(0,i.appendToken)(2,(0,i.assignSepToken)(g),c);continue}g=q(o,g,c)}else g=(0,i.appendToken)((0,f.numCodeUnits)(u),(0,i.unexpectedToken)(g,(0,v.stringFromCodePoint)(u)),c)}else g=ae(e,o,g,c);else g=(0,i.appendToken)(1,(0,i.qualSepToken)(g),c)}else{const e=d.length>0?d[d.length-1].lastParen:void 0;void 0!==e&&(d.length=e),g=(0,i.appendToken)(1,(0,i.rightParenToken)(g),c)}else d.push({delim:i.DelimId.Paren,lastParen:d.length,lastBrace:d.length>0?d[d.length-1].lastBrace:void 0}),g=(0,i.appendToken)(1,(0,i.leftParenToken)(g),c);else{const t=J(e,o,g,c);if(null!=t){g=t;continue}g=q(o,g,c)}else{const[t,r]=(0,p.scanWhile)(o,g,((t,r)=>e.isIdentContinue((0,S.stringCodePointAt)(t,r))));g=(0,i.appendToken)(r-g,(0,i.identOrBooleanToken)(e,g,t),c)}else g=Y(o,g,c)}return[c,g]}(e,t,r,n,o,s,u),g=[];let m=0;for(;m<c.length;){const e=c[m];if(e.kind!==i.TokenKind.Unexpected)g.push(e),m+=1;else{const[e,t]=se(c,m,i.TokenKind.Unexpected,((e,t)=>{const r=e,n=t;return(0,i.unexpectedToken)(r.start,r.chars+n.chars)}));g.push(e),m=t}}return g.push((0,i.endToken)(d)),g}},5430:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scanEscapedWhile=t.getEscapedSkip=t.scanWhile=t.makeProgressAsserter=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366);function s(e,t,r,n,a){return r(e,t)?1:(0,o.stringStartsWith)(e,n,t)&&t+n.length<e.length&&a(e,t+n.length)?2:0}t.makeProgressAsserter=function(e,t){let r=t-1;return function(t){if(t<=r){const r=`${e}: internal error: no progress made at index ${t}`;return(0,n.assertFalse)(r)}r=t}},t.scanWhile=function(e,t,r){let n=t;for(;n<e.length&&r(e,n);)n+=(0,a.numCodeUnits)((0,i.stringCodePointAt)(e,n));return[e.substring(t,n),n]},t.getEscapedSkip=s,t.scanEscapedWhile=function(e,t,r,n,o){const u=[];let l=t,c=t;for(;c<e.length;){const t=s(e,c,r,n,o);if(0===t)break;2===t&&(l!==c&&u.push(e.substring(l,c)),l=c+n.length,c+=n.length),c+=(0,a.numCodeUnits)((0,i.stringCodePointAt)(e,c))}return l!==c&&u.push(e.substring(l,c)),[u.join(""),c]}},837:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3345);n.__exportStar(r(1817),t),n.__exportStar(r(6805),t)},5177:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzeGlobals=t.staticPrecedents=t.summarizeFormulaDiagnostics=t.diagnostics=t.analyzeLocalsName=t.analyzeLocalsGrid=t.createAnalyzer=void 0;var n=r(472);Object.defineProperty(t,"createAnalyzer",{enumerable:!0,get:function(){return n.createAnalyzer}}),Object.defineProperty(t,"analyzeLocalsGrid",{enumerable:!0,get:function(){return n.analyzeLocalsGrid}}),Object.defineProperty(t,"analyzeLocalsName",{enumerable:!0,get:function(){return n.analyzeLocalsName}}),Object.defineProperty(t,"diagnostics",{enumerable:!0,get:function(){return n.diagnostics}}),Object.defineProperty(t,"summarizeFormulaDiagnostics",{enumerable:!0,get:function(){return n.summarizeFormulaDiagnostics}}),Object.defineProperty(t,"staticPrecedents",{enumerable:!0,get:function(){return n.staticPrecedents}}),Object.defineProperty(t,"createAnalyzeGlobals",{enumerable:!0,get:function(){return n.createAnalyzeGlobals}})},222:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormulaFormatToUnion=t.cellFormatToInferredFormat=t.namedObjectToNamedObjectData=t.namedObjectDataToNamedObject=t.readOperToCellValue=t.cellValueToReadOper=t.createExcludeCellSet=t.gridCellToCellLocation=t.sheetGridRangeToLocation=t.sheetGridRangeToHiddenCols=t.sheetGridRangeToHiddenRows=t.sheetGridRangeToCellSet=t.unusedCellsUpdateToUsedRange=t.sheetCellLocationToGridCell=t.sheetRangeLocationToGridRange=t.localeInfoFromData=t.createLocaleInfo=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6366),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(429),E=r(6468),T=r(2393),R=r(6869),k=r(6067),N=r(6067),I=r(6067),O=r(6067),P=r(6067),M=r(6067),D=r(9207),w=r(9207),L=r(5013),_=r(5013),x=r(5013),K=r(6366),W=r(6366),U=r(3519),G=r(6933),B=r(6067),V=r(6067);function j(e,t){const r=(0,i.makeStringCompareCI)("en-US"),{getWorksheetFuncId:n,getWorksheetFuncName:o}=function(e,t,r){const n=(0,h.getEnglishWorksheetFuncIdToName)().slice();return(0,U.filterCheck)(t,U.chWorksheetFunctionName,r,"localeData.worksheetFunctionNames").forEach((e=>n[e.functionId]=e.functionName)),(0,p.createWorksheetFuncNameCallbacks)(e,n)}(r,e.worksheetFunctionNames,t),s=(v=e.thousandsData,(0,a.isNone)(v)?e=>e>0&&e%3==0:(0,f.createIsThousandsPositionCallback)(v));var v;const F=function(e,t){const r=m.englishErrorNames.slice();return(0,U.filterCheck)(e,U.chErrorTypeName,t,"localeData.errorTypeNames").forEach((e=>r[e.errorType]=e.errorName)),r}(e.errorTypeNames,t),{lcid:y}=e,b=y===S.LCID.Thailand,C=y===S.LCID.Korea,A=y===S.LCID.Japan,E=y===S.LCID.ChinaT||y===S.LCID.HongKong,T=y===S.LCID.China,R=C||A||T||E,k=y===S.LCID.Hindi||y===S.LCID.Tamil,N=y===S.LCID.Thailand||y===S.LCID.Vietnam||k,I=(y&S.LCID.LANG)==(S.LCID.Hebrew&S.LCID.LANG)||(y&S.LCID.LANG)==(S.LCID.Arabic&S.LCID.LANG)||y===S.LCID.Syriac||N,O=";"===e.listSeparator||";"===e.decimalSeparator?";;":";";return{...e,cultureTag:{primary:e.cultureTagPrimary,userDefault:e.cultureTagUserDefault,instLang:e.cultureTagInstLang,userCurrent:e.cultureTagUserCurrent},leftBracket:"[",rightBracket:"]",rcLeftBracket:e.leftBracket,rcRightBracket:e.rightBracket,getWorksheetFuncId:n,getWorksheetFuncName:o,isNumeral:u.isNumeral,getOrdinal:l.getOrdinal,getNumberShape:c.getNumberShape,isThousandsPosition:s,isIdentStart:d.isIdentStart,isIdentContinue:g.isIdentContinue,stringCompareCI:r,errorNames:F,statementSeparator:O,isThai:b,isEastAsia:R,isKorea:C,isJapan:A,isChinaT:E,isChinaS:T,isComplexScript:I}}function H(e,t){return(0,a.isNone)(t)?{index:e,length:1}:{index:e,length:(0,o.fastAbs)(t-e)+1}}function q(e,t){const{index:r,length:n}=H(t.row,t.lastRow),{index:a,length:i}=H(t.column,t.lastColumn);return(0,b.sheetGridRange)((0,y.sheetIndex)(e,t.sheetId),(0,v.gridRange)(r,a,n,i))}function z(e){return(0,M.isSheetGridCell)(e)?(0,A.sheetRangeLocation)(e.sheet.index,e.range.row,e.range.col):(0,A.sheetRangeLocation)(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}t.createLocaleInfo=j,t.localeInfoFromData=function(e){return j(e,{})},t.sheetRangeLocationToGridRange=q,t.sheetCellLocationToGridCell=function(e,t){const{row:r,column:n}=t;return(0,C.sheetGridCell)((0,y.sheetIndex)(e,t.sheetId),(0,F.gridCell)(r,n))},t.unusedCellsUpdateToUsedRange=function(e,t){const{sheetId:r,usedRange:a}=t;return(0,n.isDefined)(a)?q(e,{sheetId:r,...a}):(0,R.sheetUsedRange)((0,y.sheetIndex)(e,r),T.emptyUsedRange)},t.sheetGridRangeToCellSet=function({sheet:e,range:t},r,n){const a=function(e,t,r){const n=(0,_.createFromProduct)({row:t}),a=(0,_.createFromProduct)({col:r}),i=(0,L.unionProduct)(n,a);return(0,x.exceptProduct)((0,E.createCellSetFromRange)(e),i)}(t,r,n);return{sheet:e,set:a}},t.sheetGridRangeToHiddenRows=function({sheet:e,range:t},r){return{sheet:e,range:t,hidden:r}},t.sheetGridRangeToHiddenCols=function({sheet:e,range:t},r){return{sheet:e,range:t,hidden:r}},t.sheetGridRangeToLocation=z,t.gridCellToCellLocation=function({row:e,col:t}){return{row:e,column:t}},t.createExcludeCellSet=function(e,t,r,n){let i=D.empty;if((0,a.isNone)(n))return i;for(let a=0;a<n.length;a+=1){const o=n[a];if(e<=o&&o<e+t){let e=1;for(;a+e<n.length&&n[a+e]===o+e;)e+=1;a+=e-1,i=(0,w.union)(i,r((0,s.pair)(o,o+e)))}}return i},t.cellValueToReadOper=function(e,t){switch(typeof t){case"string":return(0,O.stringOper)(t);case"boolean":return(0,P.booleanOper)(t);case"number":return e.fromNumber(t)}switch(t.kind){case"Blank":return k.blankOper;case"Error":return(0,N.errorOper)(t.type);default:return}},t.readOperToCellValue=function(e,t){switch(t.kind){case B.OperKind.String:case B.OperKind.Boolean:return t.value;case B.OperKind.Number:return e.toNumber(t);case B.OperKind.Error:return(0,A.errorValue)(t.type);case B.OperKind.Blank:return A.blankValue;default:return}},t.namedObjectDataToNamedObject=function(e,t,r,n){if(!(0,a.isNone)(n))switch(n.kind){case"NamedValue":switch(typeof n.value){case"string":return(0,G.namedValue)((0,O.stringOper)(n.value));case"boolean":return(0,G.namedValue)((0,P.booleanOper)(n.value));case"number":return(0,G.namedValue)(e.fromNumber(n.value))}return"Error"===n.value.kind?(0,G.namedValue)((0,N.errorOper)(n.value.type)):(0,K.assertNever)("calc.calc.namedObjectDataToNamedObject: NamedValue",n.value.kind);case"NamedFormula":return(0,G.namedFormula)(n.formulaBarText);case"NamedRange":{const e=q(r,n.range);return(0,G.namedRange)((0,I.range3DOper)(e.sheet,e.range))}case"NamedTable":{const e=q(r,n.range);return(0,G.namedTable)(e,n.hasHeadersRow,n.hasTotalsRow,n.columns,t)}case"NamedFailure":return(0,G.namedFailure)(n.failureReason,(0,a.isNone)(n.objectKind)?void 0:n.objectKind);default:return(0,K.assertNever)("calc.calc.namedObjectDataToNamedObject: kind",n)}},t.namedObjectToNamedObjectData=function(e,t,r){if(r)switch(r.kind){case"NamedValue":switch(r.value.kind){case B.OperKind.Number:return(0,A.namedValueData)(e.toNumber(r.value));case B.OperKind.String:case B.OperKind.Boolean:return(0,A.namedValueData)(r.value.value);case B.OperKind.Error:return(0,A.namedValueData)(r.value.type);default:return}case"NamedFormula":return(0,A.namedFormulaData)(r.fmla);case"NamedRange":{const e=(0,b.sheetGridRange)((0,y.sheetIndex)(t,r.value.sheets.index),r.value.ranges[0]);return(0,A.namedRangeData)(z(e))}case"NamedTable":{const e=r.specialRefRanges[V.SpecialRefId.Data],t=[];return r.columnIndexes.forEach(((e,r)=>(t.push((0,A.columnData)(e,r)),!0))),(0,A.namedTableData)(z(e),r.hasHeadersRow,r.hasTotalsRow,t)}case"NamedFailure":return(0,A.namedFailureData)(r.failureReason,r.objectKind);default:return(0,K.assertNever)("calc.calc.namedObjectToNamedObjectData: kind",r)}},t.cellFormatToInferredFormat=function(e){if(void 0!==e)return(0,R.isOutputFormatUnavailable)(e.format)?(0,A.inferredFormat)({kind:e.format.kind},e.valueType,e.decimals):(0,A.inferredFormat)(e.format,e.valueType,e.decimals)},t.evalFormulaFormatToUnion=function(e){if(null!=e)switch(e.kind){case"Origin":return{kind:R.SpecialFormat.Origin};case"Iformat":return(0,W.assertTrue)("calc.calc.evalFormulaFormatToUnion: iformat","number"==typeof e.iformat),e.iformat;case"Known":return(0,W.assertTrue)("calc.calc.evalFormulaFormatToUnion: knownFormat","number"==typeof e.knownFormat),{kind:R.SpecialFormat.Known,knownFormat:e.knownFormat};case"Inferred":return{kind:R.SpecialFormat.Inferred};case"Aggregate":return{kind:R.SpecialFormat.Aggregate};default:return(0,K.assertNever)("calc.calc.evalFormulaFormatToUnion: kind",e.kind)}}},7989:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExceLintExperiment=void 0;const n=r(6067),a=r(6067),i=r(859),o=r(6366),s=r(6067),u=r(6366),l=r(6366),c=r(6067),d=r(6067),g=r(6366),m=r(6067);t.ExceLintExperiment=class{get done(){return!0}setContext({documents:e}){try{l.ulsLogger.ULS.traceTag(578588694,c.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,"calc.calc.RecalcService: ExceLint experiment setContext started");const t=function(e){const t=e.getServerDocument(),r=[];for(const i of e.getServerAvailableCells()){let u="UndefinedSheet";if(void 0!==t){const r=e.getSheetName(t,i.sheetIdx.index);r.kind===g.ResultKind.Success&&(u=r.value)}const l=e.getServerUsedRange(i.sheetIdx);if(l.kind===g.ResultKind.Failure||void 0===l.value)continue;const c=l.value.sheet,d={...l.value.range};d.cols=Math.min(d.cols,75),d.rows=Math.min(d.rows,1e3);const h=[],p=[],f=[];let S=0;for(let t=d.row,r=d.row+d.rows-1;t<=r;t+=1){const r=[],i=[],s=[];for(let u=d.col,l=d.col+d.cols-1;u<=l;u+=1){const l=(0,n.sheetGridCell)(c,(0,a.gridCell)(t,u)),d=e.getServerValue(l),m=d.kind===g.ResultKind.Success?JSON.stringify(d.value):"";i.push(m);const h=e.getServerFormat(l),p=h.kind===g.ResultKind.Success?(0,o.fnv1a)(JSON.stringify(h.value)).toString():"";s.push(p);const f=e.getServerFormula(l),v=f.kind===g.ResultKind.Success?f.value?.[1].compiledFmla?.getValue():void 0,F=v?.kind===g.ResultKind.Success?f.value?.[1].fmla??"":"";""!==F&&(S+=1),r.push(F)}h.push(r),p.push(i),f.push(s)}if(0===S)continue;const v={sheetName:u,usedRangeAddress:(0,s.formatGridRange)(e.config.localeInfo,d,m.RefStyle.A1,u),values:p,formulas:h,styles:f};r.push(v)}return{workbookName:"PartialWorkbook",worksheets:r}}(e);this.result=(0,i.detect_errors)(t,void 0,void 0,this.timeLimitMS)}catch(e){this.result=`ExceLint experiment crashed with error: ${e}`}}step(){}get report(){return void 0===this.result||"string"==typeof this.result?[]:Object.keys(this.result.worksheets).map((e=>{const t=this.result.worksheets[e],r=t.exampleFixes.map(((e,r)=>{const n=t.proposedFixes[r][0],a=e.rangeSizes,i=a.reduce(((e,t)=>e+t),0);return{anomalousnessIndex:n,categories:e.bin,sizeOfCellRange:i,sizeOfEachSFRRange:a,redactedFormulaForEachSFR:e.formulas.map(u.anonymizeFormulaString),stylesDiffer:!e.sameFormat,operatorsDiffer:null,direction:e.direction}})),n=r.map((e=>e.sizeOfEachSFRRange.length)).reduce(((e,t)=>e+t),0);return{totalFormulas:t.numFormulaCells,totalSimilarFormulaRanges:n,numberOfAdjacentSFRs:r.length,numberOfAnomalousRanges:t.suspiciousRanges,numberOfCellsInAnomalousRanges:t.suspiciousCells,anomalies:r,elapsedTimeSeconds:t.elapsedTimeSeconds,proposedFixesTimeSeconds:t.proposedFixesTimeSeconds,adjustProposedFixesTimeSeconds:t.adjustProposedFixesTimeSeconds,adjustFormatProposedFixesTimeSeconds:t.adjustFormatProposedFixesTimeSeconds,exampleFixesTimeSeconds:t.exampleFixesTimeSeconds,numCountingTimeSeconds:t.numCountingTimeSeconds,columns:t.columns,rows:t.rows}})).filter((e=>e.totalFormulas>0))}get resultLogMessage(){return"string"==typeof this.result?this.result:void 0===this.result?"ExceLint experiment return <undefined>":`ExceLint experiment done. Result: ${JSON.stringify(this.report)}`}get failedLogMessage(){return this.resultLogMessage+" BTW, experiment ran out of time budget"}constructor(e=75){this.timeLimitMS=e,this.result=void 0}}},6855:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrecisionExperiment=t.PrecisionStopReason=t.PrecisionMessageKind=t.precisionValue=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6366),g=r(6366),m=r(6366),h=r(6366),p=r(6366),f=r(6366),S=r(9207),v=r(9207),F=r(6366),y=r(6366),b=r(6869),C=r(2393),A=r(6468),E=r(5013),T=r(5013),R=r(6067),k=r(6366),N=r(6067),I=r(6366),O=r(6366),P=r(6067),M=r(6067),D=r(6067),w=r(6067),L=r(6067),_=r(6366),x=r(8072),K=r(637);function W(e,t){switch(t.kind){case N.OperKind.Number:return{kind:"n",magnitude:(0,f.anonymizeMagnitude)(e.toNumber(t))};case N.OperKind.String:return{kind:"s"};case N.OperKind.Boolean:return{kind:"b"};case N.OperKind.Error:return{kind:"e",type:(0,R.englishErrorTypeToName)(t.type)};case N.OperKind.Rich:return{kind:"r"};case N.OperKind.Array:return{kind:"a"};case N.OperKind.Blank:return{kind:"z"};default:return(0,k.assertNever)("calc.calc.precisionValue",t)}}var U,G;function B(e,t){const r=e[t.sheet.index];return void 0!==r&&(0,E.meetsProduct)(r,(0,A.createCellSetFromRange)(t.range))}function V(e,t){const r=e[t.sheet.index]??v.empty;e[t.sheet.index]=(0,T.unionProduct)(r,(0,A.createCellSetFromRange)(t.range))}t.precisionValue=W,function(e){e.EvalStatistics="EvalStatistics",e.PrintFormulaStatistics="PrintFormulaStatistics",e.UnhandledFailure="UnhandledFailure"}(U||(t.PrecisionMessageKind=U={})),function(e){e.Success="Success",e.Timeout="Timeout"}(G||(t.PrecisionStopReason=G={}));const j={[w.OperatorId.Add]:.05,[w.OperatorId.Sub]:.069,[w.OperatorId.Eq]:.097,[w.OperatorId.Mul]:.1,[w.OperatorId.Div]:.11,[w.OperatorId.Concat]:.36,[w.OperatorId.Gt]:.65,[w.OperatorId.Ne]:.79,[w.OperatorId.Lt]:.89,[w.OperatorId.Le]:1.6,[w.OperatorId.Ge]:1.9,[w.OperatorId.Percent]:2.9,[w.OperatorId.At]:6.2,[w.OperatorId.Pow]:13,[w.OperatorId.Range]:67},H={[L.WorksheetFuncId.IF]:.076,[L.WorksheetFuncId.SUM]:.11,[L.WorksheetFuncId.IFERROR]:.5,[L.WorksheetFuncId.COUNTIF]:.77,[L.WorksheetFuncId.AND]:.82,[L.WorksheetFuncId.VLOOKUP]:1.5,[L.WorksheetFuncId.AVERAGE]:1.5,[L.WorksheetFuncId.HOUR]:1.9,[L.WorksheetFuncId.MINUTE]:1.9,[L.WorksheetFuncId.TEXT]:2,[L.WorksheetFuncId.OR]:2,[L.WorksheetFuncId.NOW]:2.1,[L.WorksheetFuncId.ISBLANK]:2.3,[L.WorksheetFuncId.CONCATENATE]:2.6,[L.WorksheetFuncId.SUMIF]:2.7,[L.WorksheetFuncId.COUNTIFS]:3.3,[L.WorksheetFuncId.LEFT]:3.4,[L.WorksheetFuncId.ISNUMBER]:3.7,[L.WorksheetFuncId.MID]:3.9,[L.WorksheetFuncId.COUNTA]:4,[L.WorksheetFuncId.MONTH]:4.2,[L.WorksheetFuncId.SECOND]:4.3,[L.WorksheetFuncId.LEN]:4.9,[L.WorksheetFuncId.WEEKNUM]:5,[L.WorksheetFuncId.DAY]:5.2,[L.WorksheetFuncId.ROUND]:5.4,[L.WorksheetFuncId.FIND]:5.8,[L.WorksheetFuncId.NETWORKDAYS]:6.2,[L.WorksheetFuncId.COUNT]:6.2,[L.WorksheetFuncId.YEAR]:6.3,[L.WorksheetFuncId.INT]:6.4,[L.WorksheetFuncId.RIGHT]:6.7,[L.WorksheetFuncId.ABS]:7,[L.WorksheetFuncId.CONCAT]:7.2,[L.WorksheetFuncId.CHAR]:7.4,[L.WorksheetFuncId.MAX]:8,[L.WorksheetFuncId.ROW]:8.1,[L.WorksheetFuncId.WEEKDAY]:9.1,[L.WorksheetFuncId.DAYS]:9.2,[L.WorksheetFuncId.MIN]:9.8,[L.WorksheetFuncId.SEARCH]:9.8,[L.WorksheetFuncId.WORKDAY]:11,[L.WorksheetFuncId.DATEDIF]:12,[L.WorksheetFuncId.TIME]:13,[L.WorksheetFuncId.HYPERLINK]:13,[L.WorksheetFuncId.IFS]:13,[L.WorksheetFuncId.ISERROR]:13,[L.WorksheetFuncId.COUNTBLANK]:14,[L.WorksheetFuncId.TODAY]:14,[L.WorksheetFuncId.VALUE]:18,[L.WorksheetFuncId.ROUNDUP]:18,[L.WorksheetFuncId.MATCH]:19,[L.WorksheetFuncId.DATE]:20,[L.WorksheetFuncId.SUBSTITUTE]:20,[L.WorksheetFuncId.INDIRECT]:22,[L.WorksheetFuncId.INDEX]:23,[L.WorksheetFuncId.TRIM]:24,[L.WorksheetFuncId.UPPER]:25,[L.WorksheetFuncId.SUMIFS]:28,[L.WorksheetFuncId.EXACT]:29,[L.WorksheetFuncId.NOT]:32,[L.WorksheetFuncId.PRODUCT]:35,[L.WorksheetFuncId.ROUNDDOWN]:37,[L.WorksheetFuncId.AVERAGEIF]:38,[L.WorksheetFuncId.ISTEXT]:40,[L.WorksheetFuncId.ISOWEEKNUM]:41,[L.WorksheetFuncId.EOMONTH]:42,[L.WorksheetFuncId.MROUND]:45,[L.WorksheetFuncId.COLUMN]:45,[L.WorksheetFuncId.ROWS]:46,[L.WorksheetFuncId.TIMEVALUE]:52,[L.WorksheetFuncId.TRUNC]:53,[L.WorksheetFuncId.LOOKUP]:59,[L.WorksheetFuncId.NA]:59,[L.WorksheetFuncId.DAYS360]:61,[L.WorksheetFuncId.RANK]:67,[L.WorksheetFuncId.EDATE]:72,[L.WorksheetFuncId.MOD]:82,[L.WorksheetFuncId.OFFSET]:83,[L.WorksheetFuncId.STDEV]:87,[L.WorksheetFuncId.SUBTOTAL]:91},q=(0,P.binaryVisitor)({...(0,M.constVisitor)(.01),nameNode:()=>1,operatorNode:e=>j[e]??100,wsfNode:e=>H[e]??100},d.fastMax);t.PrecisionExperiment=class{get done(){return void 0!==this.result}get resultLogMessage(){return this.createResultLogMessage(G.Success)}get failedLogMessage(){return this.createResultLogMessage(G.Timeout)}get readonlyDebugLog(){return this.log}setContext(e){this.stateId=e.stateId,this.docs=e.documents,this.docs.reconfigure({yieldIntervalMs:e.stepBudget/2,totalTimeMs:e.totalBudget},this.docs.limits,this.docs.maxDereferenceCells,this.docs.isServerWorkbookLoad),this.runtime=new F.MachineRuntime(this.sampleCells().bind((({evalCells:e,printCells:t})=>y.Pledge.all([...e.map(this.testEval),...t.map(this.testPrint)]))).catch((e=>{this.log.push({kind:U.UnhandledFailure,reason:e})})))}step(){if(this.result)return;const e=this.runtime.step();this.result=e.kind===_.TransitionKind.Break||e.kind===_.TransitionKind.Next?void 0:e}sampleCells(){const e=[],t=[],r=[];return this.docs.getServerAvailableCells().forEach((({sheetIdx:n})=>(r.push(y.Pledge.try((()=>{this.docs.forEachServerNonBlankCellInSet(n,S.dense,(r=>{const a=(0,u.sheetGridCell)(n,r),{samplePrecisionEvalRate:i,samplePrecisionPrintFormulaRate:o,samplePrecisionPrintValueRate:s}=this.config;if(i>0){const t=this.getWeight(a),r=void 0===t?void 0:i>=1?1:(0,g.fastMin)(1,i*t);void 0!==r&&this.rng.next()<r&&(V(this.sampledSets,a),e.push({cell:a,p:r}))}const l=(0,d.fastMax)(o,s);if(l>0){const e=this.rng.next();if(e<l){const r=this.isValueCell(a)?s:o;e<r&&t.push({cell:a,p:r})}}return!0}))}))),!0))),y.Pledge.all(r).bind((()=>({evalCells:e,printCells:t})))}getWeight(e){const t=this.getFormula(e);if(!(0,I.isSuccess)(t))return this.onUnavailableObject(t.reason);const[,r]=t.value;return void 0!==r.compiledFmla?function(e){return(0,I.isSuccess)(e)?(0,D.reduceBottomUp)(q,e.value):1}(r.compiledFmla.getValue()):void 0}isValueCell(e){const t=this.getFormula(e);return(0,I.isSuccess)(t)?void 0===t.value[1].compiledFmla:(this.onUnavailableObject(t.reason),!1)}resumeToPledge(e,t){return y.Pledge.try((()=>{try{this.p=t;const r=e();return Array.isArray(r)?r:this.resumeToPledge(r.resume,t)}finally{this.p=void 0}}))}getFormula(e){const t=this.docs.getEditedFormula(e);if(!(0,I.isSuccess)(t))return t;const[r,n]=t.value??[e.range,C.blankCellGridFormula],a=(0,c.lexicalSourceGrid)(n.lexicalKind,(0,l.sheetGridRange)(e.sheet,r));return(0,O.success)([a,n])}onRangeFailure(e,t,r,n,a){const i={samples:[],failures:[t]};this.log.push({kind:U.EvalStatistics,stats:i})}onNameFailure(){}onNumberFormatFailure(){}onInferFormatFailure(){}onReturnCellValue(){}onUnavailableObject(e){const t=(0,s.unavailable)([e]);this.onUnavailable(t)}onUnavailable(e){this.log.push({kind:U.UnhandledFailure,reason:e})}hasWrongPrecedent(e){return e.cells.some((e=>B(this.precisionWrongSets,e)))}onSetCellValue(e,t,r,n,a){const i=this.getFormula(e);if(!(0,I.isSuccess)(i))return this.onUnavailableObject(i.reason);const[o,s]=i.value,u=this.hasWrongPrecedent(r);return this.logPrecisionResult(e,t,o,s,u)}onSetCellValues(e,t,r,a,i){const s=this.getFormula((0,o.sheetGridRangeAnchor)(e));if(!(0,I.isSuccess)(s))return this.onUnavailableObject(s.reason);const[l,c]=s.value,d=this.hasWrongPrecedent(r);(0,n.forEachCellInRange)(e.range,((r,n,a)=>(this.logPrecisionResult((0,u.sheetGridCell)(e.sheet,r),t[n][a],l,c,d),!0)))}logPrecisionResult(e,t,r,n,a){const i=this.docs.allServerAvailable(e);if(!(0,I.isSuccess)(i))return this.onUnavailableObject(i.reason);if(!0!==i.value)return;const o=this.docs.getServerValue(e);if(!(0,I.isSuccess)(o))return this.onUnavailableObject(o.reason);const s=B(this.sampledSets,e),u=this.precisionResult(t,o.value.oper,r,n,s,a);(function(e){return void 0===e.sampled})(u)||V(this.precisionWrongSets,e);const l={samples:[u],failures:[]};this.log.push({kind:U.EvalStatistics,stats:l})}precisionResult(e,t,r,n,o,s){const u=this.p,{mathpack:l}=this.docs.config,c=W(l,t),[d,g]=this.docs.anonymizeFormula(r,n);if((0,a.isReadOperEqual)(l,e,t,!0))return{expected:c,formula:d,functions:g,root:o,cascaded:s,p:u};const m=W(l,e);if((0,i.isNumberOper)(t)&&(0,i.isNumberOper)(e)){const r=l.toNumber(t),n=l.toNumber(e);return{expected:c,sampled:m,relMagnitude:(0,f.anonymizeMagnitude)(0===r?n:(n-r)/r),formula:d,functions:g,root:o,cascaded:s,p:u}}return{expected:c,sampled:m,formula:d,functions:g,root:o,cascaded:s,p:u}}createResultLogMessage(e){if(0===this.log.length&&e===G.Success)return;const t={samples:[],failures:{}},r={samples:[],failures:{}},n={};for(const e of this.log)switch(e.kind){case U.EvalStatistics:t.samples.push(...e.stats.samples);for(const r of e.stats.failures)(0,x.incrementFailure)(t.failures,r);break;case U.PrintFormulaStatistics:r.samples.push(...e.stats.samples);for(const t of e.stats.failures)(0,x.incrementFailure)(r.failures,t);break;case U.UnhandledFailure:(0,x.incrementFailure)(n,e.reason);break;default:(0,k.assertNever)("calc.calc.PrecisionExperiment.createResultMessage",e)}return["PrecisionExperiment",e,`stateId = ${this.stateId}`,`evalStats = ${JSON.stringify(t)}`,`printStats = ${JSON.stringify(r)}`,`unhandledFailures = ${JSON.stringify(n)}`].join(", ")}constructor(e){this.sampledSets={},this.precisionWrongSets={},this.log=[],this.result=void 0,this.testEval=({cell:e,p:t})=>this.resumeToPledge((()=>this.docs.evaluate(b.ComputeKind.EditedCell,[e],K.VolatileMode.PrecisionTest)),t),this.testPrint=({cell:e,p:t})=>y.Pledge.try((()=>{const r=this.getFormula(e);if(!(0,I.isSuccess)(r))return this.onUnavailableObject(r.reason);const[n,a]=r.value;let i;if(void 0===a.compiledFmla){const t=this.docs.getServerValue(e);if(!(0,I.isSuccess)(t))return this.onUnavailableObject(t.reason);i=this.docs.renderValueBarText(e,t.value.oper,a.fmla)}else{const e=a.compiledFmla.getValue();i=(0,I.isSuccess)(e)?this.docs.printFormulaBarText(n,a.origin,e.value):e}if(!(0,I.isSuccess)(i))return void this.log.push({kind:U.PrintFormulaStatistics,stats:{samples:[],failures:[i.reason]}});const o=(0,p.anonymizeFormulaString)(a.fmla),s=i.value===a.fmla?{expected:o,p:t}:{expected:o,sampled:(0,p.anonymizeFormulaString)(i.value),p:t};this.log.push({kind:U.PrintFormulaStatistics,stats:{samples:[s],failures:[]}})})),this.config={samplePrecisionEvalRate:e.samplePrecisionEvalRate??0,samplePrecisionPrintFormulaRate:e.samplePrecisionPrintFormulaRate??0,samplePrecisionPrintValueRate:e.samplePrecisionPrintValueRate??0,rngSeed:e.rngSeed??0|(0,m.now)()},this.rng=new h.JSF32(this.config.rngSeed)}}},9739:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Messages=void 0,function(e){e.Root="calc.exp.UnitExperiment",e.Default="uninitialised",e.Initialised="init",e.Failure="fail",e.UnifyBound="unifyBound"}(r||(t.Messages=r={}))},3770:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runSolverStep=t.numberFormatFromCellFormat=t.valueTypeFromCellFormat=t.updateFormatStatsFromCellFormat=t.isInterestingFormat=t.makeSolverContext=t.ConstraintKind=t.UnitExperimentSettings=void 0;const n=r(1335),a=r(8210),i=r(9739),o=r(4430),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6366),g=r(6366),m=r(6366),h=r(6468),p=r(6869),f=r(5013),S=r(3228),v=r(3228),F=r(6366),y=r(6366);var b,C;t.UnitExperimentSettings={get UnitlessTimeAndDate(){return(0,y.getTypedFeatureGate)("Microsoft.Office.Excel.UnitlessTimeAndDate")},get IgnoreDivMul(){return(0,y.getTypedFeatureGate)("Microsoft.Office.Excel.UnitExpIgnoreDivMul")}},function(e){e[e.RangeEquality=0]="RangeEquality",e[e.StagedRangeEquality=1]="StagedRangeEquality",e[e.UnitEquality=2]="UnitEquality",e[e.FormatEquality=3]="FormatEquality"}(b||(t.ConstraintKind=b={})),function(e){e[e.Solved=0]="Solved",e[e.Failed=1]="Failed",e[e.Deferred=2]="Deferred",e[e.Staged=3]="Staged"}(C||(C={}));const A={kind:C.Solved},E=e=>({kind:C.Failed,error:e}),T=e=>({kind:C.Deferred,constraint:e}),R=(0,a.fromConstants)({error:1}),k=(0,a.fromConstants)({}),N=(0,a.fromConstants)({currency:1}),I=(0,a.fromConstants)({date:1}),O=(0,a.fromConstants)({time:1});function P(e,t){return void 0===t.link&&(t.link=e.uf.makePoint(t.unit)),t.link}function M(e,t,r,n){return(0,g.assertTrue)(i.Messages.Root,0===r.varCount),e.uf.union(void 0===n?e.uf.makePoint(r):n,t,!0),A}function D(e,t,r,n,o){return t===e.errorUnit?((0,g.assertTrue)(i.Messages.Root,r===e.errorPoint),void 0!==o&&e.uf.union(e.errorPoint,o,!0),A):n===e.errorUnit?((0,g.assertTrue)(i.Messages.Root,o===e.errorPoint),void 0!==r&&e.uf.union(e.errorPoint,r,!0),A):0===t.varCount?0===n.varCount?(0,a.areSignaturesEqual)(t,n)?A:(void 0!==r&&e.uf.union(e.errorPoint,r,!0),void 0!==o&&e.uf.union(e.errorPoint,o,!0),E([t,n])):((0,g.assertTrue)(i.Messages.Root,void 0!==o),M(e,o,t,r)):1===n.varCount?((0,g.assertTrue)(i.Messages.Root,void 0!==r),(0,g.assertTrue)(i.Messages.Root,void 0!==o),e.uf.union(r,o),A):((0,g.assertTrue)(i.Messages.Root,void 0!==r),M(e,r,n,o))}function w(e,t,r){if(!(0,a.isSimpleUnit)(t))return T({kind:b.UnitEquality,unit:t,target:r});const n=P(e,r),[o,s]=e.uf.findWithDescriptor(n);if(1===t.varCount){(0,g.assertTrue)(i.Messages.Root,void 0!==t.name);const r=e.symbolContext.getTable().getValue(t.name);(0,g.assertTrue)(i.Messages.Root,void 0!==r);const[n,a]=e.uf.findWithDescriptor(P(e,r));return D(e,a,n,s,o)}return D(e,t,void 0,s,o)}function L(e,t){if(t===p.SpecialFormat.Unavailable||0===t)return!1;const r=K(e,t);if(void 0===r)return!1;const n=r?.valueType;return void 0!==n&&n!==v.FormatValueType.General&&(n!==v.FormatValueType.Currency&&n!==v.FormatValueType.Accounting||void 0!==r.currencySymbol)}function _(e,t,r,n){n?r.referencedFormatCells+=1:r.allFormatCells+=1;const a=K(e,t),i=n?r.enriched.referencedFormatTypes:r.enriched.allFormatTypes,o=a?.valueType;if(void 0!==o&&(i[o]=(i[o]??0)+1),o===v.FormatValueType.Currency||o===v.FormatValueType.Accounting){const e=n?r.enriched.referencedCurrencyTypes:r.enriched.allCurrencyTypes,t=a?.currencySymbol,i=a?.culture?.culture,o=void 0===t?"none":t===S.FormatCurrency.LocaleInfo?"defaultSymbol":t+"_"+i;e[o]=(e[o]??0)+1}}function x(e,t){return K(e,t)?.valueType}function K(e,t){if("number"==typeof t){const r=e.getIformat(t);return(0,F.isSuccess)(r)?r.value:void 0}return t}function W(e,t,r){const a=e.typeContext.types[t.index];if(void 0===a)return(0,d.assertFalse)(i.Messages.Root);const o=a.getValue(r);if(void 0===o){const i=(0,s.sheetGridCell)(t,r),o=e.typeContext.formats(i);if((0,F.isSuccess)(o)){if(!L(e.typeContext,o.value)||e.typeContext.isStringValue(i)){const i=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=a.setValue(r,(0,n.primitiveUnitType)(i)),i}let s=U(e,o.value);return void 0===s?s=e.symbolContext.freshSymbol().unit:_(e.typeContext,o.value,e.stats,!0),e.typeContext.types[t.index]=a.setValue(r,(0,n.primitiveUnitType)(s)),s}const u=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=a.setValue(r,(0,n.primitiveUnitType)(u)),u}return o.kind===n.TypeKind.Scalar?o.unit:void 0}function U(e,r){const n=x(e.typeContext,r);if(void 0!==n)switch(n){case v.FormatValueType.Currency:case v.FormatValueType.Accounting:return N;case v.FormatValueType.Percentage:return k;case v.FormatValueType.Date:return t.UnitExperimentSettings.UnitlessTimeAndDate?k:I;case v.FormatValueType.Time:return t.UnitExperimentSettings.UnitlessTimeAndDate?k:O;default:return}}function G(e,t){const r=U(e,t.format);if(void 0===r)return A;const n=W(e,t.cell.sheet,t.cell.range);if(void 0===n)return A;if(!(0,a.isSimpleUnit)(n))return T(t);if(1===n.varCount){(0,g.assertTrue)(i.Messages.Root,void 0!==n.name);const t=e.symbolContext.getTable().getValue(n.name);(0,g.assertTrue)(i.Messages.Root,void 0!==t);const[a,o]=e.uf.findWithDescriptor(P(e,t));return D(e,o,a,r,void 0)}return D(e,n,void 0,r,void 0)}function B(e){const t=e.symbolContext.getTable();return r=>{const n=t.getValue(r);if(void 0!==n&&void 0!==n.link)return void 0===n.ufSubstitution&&(n.ufSubstitution=e.uf.findWithDescriptor(n.link)[1]),n.ufSubstitution}}t.makeSolverContext=function(e,t,r){const n=new o.UF,i=n.makePoint(R),s=(0,a.createPoisonApplication)(R);return{symbolContext:e,typeContext:t,stats:r,uf:n,errorPoint:i,errorUnit:R,apply:s}},t.isInterestingFormat=L,t.updateFormatStatsFromCellFormat=_,t.valueTypeFromCellFormat=x,t.numberFormatFromCellFormat=K,t.runSolverStep=function(e){return e.kind===n.ExperimentState.SolvingSimple?e.constraintCursor===e.constraints.length?function(e){const{apply:t,errorUnit:r}=e.context,i={kind:n.ExperimentState.SolvingFull,context:e.context,stats:e.stats,constraints:e.deferred,constraintCursor:0,unifyNF:(e,n)=>{const o=t(i.substitution,e);if(o===r)return;const s=t(i.substitution,n);if(s===r)return;const u=(0,a.unify)(t,o,s);u.kind!==a.UnificationResultKind.Subst?(i.stats.errorCount+=1,i.stats.enriched.errors.push({error:[t(i.substitution,e),t(i.substitution,n)]})):i.substitution=(0,a.compose)(t,u.substitution,i.substitution)},substitution:B(e.context)};return i}(e):function(e){const{constraints:t,context:r,constraintCursor:n,deferred:a}=e,i=t[n];let o;switch(i.kind){case b.UnitEquality:o=function(e,t){return w(e,t.unit,t.target)}(r,i);break;case b.FormatEquality:o=G(r,i);break;case b.RangeEquality:o=function(e,t){const r=t.type.resolution;if(!(0,c.isSheetIndex)(r.sheet))return A;if((0,l.isGridCell)(r.range)){const n=W(e,r.sheet,r.range);return void 0===n?A:w(e,n,t.target)}const n=e.typeContext.available[r.sheet.index];if(void 0===n)return A;const a=n.usedRange;if(void 0===a)return A;const i=(0,u.gridRangeIsect)(r.range,a);if(void 0===i)return A;const o=(0,f.intersectProduct)((0,f.intersectProduct)((0,h.createCellSetFromRange)(i),h.availableReadProduct),n.availableCells),s=[];return(0,h.forEachCellInSet)(o,(e=>(s.push(e),!0))),{kind:C.Staged,constraint:{kind:b.StagedRangeEquality,cursor:0,index:n.sheetIdx,cells:s,target:t.target},output:void 0}}(r,i);break;case b.StagedRangeEquality:o=function(e,t){const{cursor:r,cells:n}=t;if(r>=n.length)return A;const a=n[r],i=W(e,t.index,a),o=void 0===i?A:w(e,i,t.target);return t.cursor+=1,{kind:C.Staged,constraint:t,output:o}}(r,i)}switch(o.kind){case C.Deferred:a.push(o.constraint);break;case C.Failed:e.stats.errorCount+=1,e.stats.enriched.errors.push({error:o.error});break;case C.Staged:if(t[n]=o.constraint,void 0!==o.output)switch(o.output.kind){case C.Deferred:a.push(o.output.constraint);break;case C.Failed:e.stats.errorCount+=1,e.stats.enriched.errors.push({error:o.output.error})}return e}return e.constraintCursor+=1,e}(e):function(e){const{constraints:t,context:r,constraintCursor:n,unifyNF:a}=e,o=t[n];switch(o.kind){case b.UnitEquality:a(o.unit,o.target.unit);break;case b.FormatEquality:const t=U(r,o.format);if(void 0===t)break;const n=W(r,o.cell.sheet,o.cell.range);if(void 0===n)break;a(t,n);break;default:return e.constraintCursor+=1,(0,m.assertNever)(i.Messages.Root,o)}return e.constraintCursor+=1,e}(e)}},1335:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentState=t.isResolvedReferenceType=t.primitiveUnitType=t.primitiveType=t.topType=t.bottomType=t.oneType=t.errorType=t.dimensionlessNumberType=t.dimensionLess=t.numberType=t.stringType=t.boolType=t.typeFromDimensions=t.joinDimensions=t.getLiftingDimensionsFromTypes=t.dimensionsFromType=t.makeArrayType=t.makeResolvedReferenceType=t.makeReferenceType=t.makePrimitiveType=t.TypeKind=void 0;const n=r(6067),a=r(8210),i=r(6067),o=r(6067);var s,u;function l(e,t=void 0){return{kind:s.Scalar,flags:e,unit:t}}function c(e){return{kind:s.Reference,reference:e,resolution:void 0}}function d(e,t){return{kind:s.Array,elementType:e,dimensions:t}}function g(e){return{kind:s.Union,flags:e}}function m(e){switch(e.kind){case s.Reference:const t=e.resolution?.range;return void 0!==t&&(!!(0,n.isGridCell)(t)||{rows:t.rows,columns:t.cols,exact:!0});case s.Array:return e.dimensions;case s.Scalar:return!0;case s.Union:return!1}}function h(e,t){return"object"==typeof e?"object"==typeof t?{rows:Math.max(e.rows,t.rows),columns:Math.max(e.columns,t.columns),exact:e.exact&&t.exact}:{...e,exact:e.exact&&t}:"object"==typeof t?{...t,exact:t.exact&&e}:e&&t}!function(e){e[e.Scalar=0]="Scalar",e[e.Reference=1]="Reference",e[e.Array=2]="Array",e[e.Union=3]="Union"}(s||(t.TypeKind=s={})),t.makePrimitiveType=l,t.makeReferenceType=c,t.makeResolvedReferenceType=function(e,t){const r=c(e);return r.resolution=t,r},t.makeArrayType=d,t.dimensionsFromType=m,t.getLiftingDimensionsFromTypes=function(e,t){return h(m(e),m(t))},t.joinDimensions=h,t.typeFromDimensions=function(e,t){return!0===t?e:d(e,t)},t.boolType=l(i.OperKind.Boolean),t.stringType=l(i.OperKind.String),t.numberType=l(i.OperKind.Number),t.dimensionLess=(0,a.fromConstants)({}),t.dimensionlessNumberType=l(i.OperKind.Number,t.dimensionLess),t.errorType=l(i.OperKind.Error),t.oneType=l(i.OperKind.Missing|i.OperKind.Blank),t.bottomType=g(o.SignatureType.None),t.topType=g(o.SignatureType.All),t.primitiveType=l(i.OperKind.Number|i.OperKind.Boolean|i.OperKind.String),t.primitiveUnitType=e=>l(i.OperKind.Number|i.OperKind.Boolean|i.OperKind.String,e),t.isResolvedReferenceType=function(e){return void 0!==e.resolution},function(e){e[e.Checking=0]="Checking",e[e.SolvingSimple=1]="SolvingSimple",e[e.SolvingFull=2]="SolvingFull"}(u||(t.ExperimentState=u={}))},4430:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UF=void 0,t.UF=class{makePoint(e){const t=this.roots.length;return this.roots.push(t),this.backlinks.push(t),this.descriptors.push(e),this.ranks.push(0),t}find(e){const t=this.roots;let r=e;for(;t[r]!==r;)t[r]=t[t[r]],r=t[r];return r}findWithDescriptor(e){const t=this.find(e);return[t,this.descriptors[t]]}union(e,t,r=!1){const n=this.find(e),a=this.find(t);if(n===a)return;const i=this.roots,o=this.backlinks,s=this.ranks;if(r){const e=o[a];return o[a]=o[n],o[n]=e,i[a]=n,void(s[n]<=s[a]&&(s[n]=s[a]+1))}if(s[n]<s[a]){const e=o[n];o[n]=o[a],o[a]=e,i[n]=a}else{const e=o[a];o[a]=o[n],o[n]=e,i[a]=n,s[n]===s[a]&&(s[n]+=1)}}forEachInClass(e,t){const r=this.backlinks;let n=e;for(t(n);r[n]!==e;)n=r[n],t(n)}constructor(){this.roots=[],this.backlinks=[],this.descriptors=[],this.ranks=[]}}},3697:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnitExperiment=void 0;const n=r(6366),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(8210),h=r(9739),p=r(1335),f=r(3770),S=r(3770),v=r(6366),F=r(6366),y=r(6366),b=r(6067),C=r(6366),A=r(6366),E=r(6366),T=r(6067),R=r(6067),k=r(6067),N=r(6366),I=r(6067),O=r(6067),P=r(6067),M=r(6067),D=r(6468),w=r(5013);t.UnitExperiment=class{get done(){return this.isDone}freshCheckingState(e){this.lastStepMessage="freshCheckingState";const t=[],r={};e.getServerAvailableCells().forEach((n=>{const a=e.getServerUsedRange(n.sheetIdx);if(a.kind!==A.ResultKind.Success)return this.isDone=!0,void(this.statsMessage="Unit experiment: getServerUsedRange failed");const i={...n,usedRange:a.value?.range};r[n.sheetIdx.index]=i,t.push(i)}));const n=void 0===e.getServerDocument()?()=>(0,C.failure)(void 0):t=>e.getIformat(e.getServerDocument(),t);return{kind:p.ExperimentState.Checking,locale:e.config.localeInfo,mathpack:e.config.mathpack,resolver:(0,g.createResolver)(e),documentTypeContext:{formats:t=>e.getServerFormat(t),types:{},available:r,getIformat:n,isStringValue:t=>{if(void 0===e.getServerDocument())return!1;const r=e.getServerValue(t);return r.kind===A.ResultKind.Success&&r.value.oper.kind===T.OperKind.String}},constraints:[],stats:{formulaCells:0,referencedFormatCells:0,allFormatCells:0,totalCells:0,errorCount:0,enriched:{errors:[],referencedFormatTypes:{},allFormatTypes:{},referencedCurrencyTypes:{},allCurrencyTypes:{}}},sheets:t,mutableState:{symbolContext:L.init(),ranges:void 0,cells:void 0,sheetCursor:0,rangeCursor:0,cellCursor:0}}}freshSolvingState(e){return this.lastStepMessage="freshSolvingState",{kind:p.ExperimentState.SolvingSimple,stats:e.stats,context:(0,S.makeSolverContext)(e.mutableState.symbolContext,e.documentTypeContext,e.stats),constraints:e.constraints,constraintCursor:0,deferred:[]}}step(){if(!this.isDone){if(void 0===this.documentContext)return this.isDone=!0,(0,n.assertNever)(`${h.Messages.Root}.${h.Messages.Initialised}`,this.documentContext);void 0===this.state&&(this.state=this.freshCheckingState(this.documentContext));try{const e=this.state;switch(e.kind){case p.ExperimentState.Checking:return e.mutableState.sheetCursor<e.sheets.length?void(this.state=this.runCheckStep(this.documentContext,e)):void(this.state=this.freshSolvingState(e));case p.ExperimentState.SolvingSimple:return this.lastStepMessage="SolvingSimple",void(this.state=(0,S.runSolverStep)(e));case p.ExperimentState.SolvingFull:return e.constraintCursor<e.constraints.length?(this.lastStepMessage="SolvingFull",void(this.state=(0,S.runSolverStep)(e))):(this.lastStepMessage="done SolvingFull",this.isDone=!0,void(this.statsMessage=this.statsForLogging(e.stats)))}}catch(e){return this.statsMessage=`${h.Messages.Root}.${h.Messages.Failure}: ${(0,y.messageFromError)(e)}`,void(this.isDone=!0)}}}setContext({documents:e}){this.documentContext=e}initialiseSheetStep(e){this.lastStepMessage="initialiseSheetStep";const{mutableState:t,sheets:r}=e,{sheetCursor:n}=t,a=r[n],i=a.usedRange,o=[];if(void 0!==i){const e=(0,w.intersectProduct)(a.availableCells,D.availableReadProduct);(0,D.forEachRangeInSet)(e,(e=>{const t=(0,O.gridRangeIsect)(e,i);if(void 0!==t){if((0,P.gridRangeSize)(t)<250)return o.push(t),!0;(0,I.forEachTileInRange)(t,15,(e=>(o.push(e),!0)))}return!0}))}return t.ranges=o,t.rangeCursor=0,e.documentTypeContext.types[a.sheetIdx.index]=(0,b.makeGridRangeTable)(),e}initialiseRangeCells(e,t){this.lastStepMessage="initialiseRangeCells";const{mutableState:r,stats:n,sheets:i}=t,{sheetCursor:o}=r,s=[],u=i[o],l=r.ranges[r.rangeCursor];return e.forEachServerNonBlankCellInSet(u.sheetIdx,(0,D.createCellSetFromRange)(l),(r=>{const i=(0,a.sheetGridCell)(u.sheetIdx,r),o=e.getServerFormula(i);o.kind===A.ResultKind.Success&&void 0!==o.value?.[1].compiledFmla&&(s.push(o.value[1]),n.formulaCells+=1);const l=e.getServerFormat(i);return l.kind===A.ResultKind.Success&&(0,S.isInterestingFormat)(t.documentTypeContext,l.value)&&(0,S.updateFormatStatsFromCellFormat)(t.documentTypeContext,l.value,n,!1),n.totalCells+=1,!0})),r.cells=s,r.cellCursor=0,t}checkCell(e,t){this.lastStepMessage="checkCell";const{sheets:r,constraints:n,stats:i,mutableState:o}=t,{cells:s,sheetCursor:u,cellCursor:l}=o,c=r[u],d=s[l],g=d.compiledFmla.getValue();if(g.kind===A.ResultKind.Success){const r=(0,a.sheetGridCell)(c.sheetIdx,d.origin),o=function(e,t,r){const{constraints:n,locale:a,mathpack:i,resolver:o,documentTypeContext:s}=e,u=s.types[t.sheet.index],l=e.mutableState.symbolContext.copy(),c={origin:t,locale:a,mathpack:i,resolver:o,symbolContext:l,pushConstraint:e=>void 0!==e&&(n.push(e),!0)},d=function(e,t){return(0,R.reducePledge)(new B(e),t)}(c,r),g=W(c,d);let m=U(c,void 0===g?p.topType:g);if(m.kind===p.TypeKind.Reference){const e=l.freshSymbol(),t={kind:S.ConstraintKind.RangeEquality,type:m,target:e};m=(0,p.primitiveUnitType)(e.unit),n.push(t)}return e.mutableState.symbolContext=l,m.kind===p.TypeKind.Array?u:u.setValue(t.range,m)}(t,r,g.value);t.documentTypeContext.types[c.sheetIdx.index]=o;const s=e.getServerFormat(r);s.kind===A.ResultKind.Success&&(0,S.isInterestingFormat)(t.documentTypeContext,s.value)&&(n.push({kind:S.ConstraintKind.FormatEquality,cell:r,format:s.value}),(0,S.updateFormatStatsFromCellFormat)(t.documentTypeContext,s.value,i,!0))}return t.mutableState.cellCursor+=1,t}runCheckStep(e,t){if(!function(e){return void 0!==e.mutableState.ranges}(t))return this.initialiseSheetStep(t);const{mutableState:r}=t;return r.rangeCursor===r.ranges.length?(r.ranges=void 0,r.sheetCursor+=1,t):function(e){return void 0!==e.mutableState.cells}(t)?r.cellCursor<t.mutableState.cells.length?this.checkCell(e,t):(r.cells=void 0,r.rangeCursor+=1,t):this.initialiseRangeCells(e,t)}statsForLogging(e){return JSON.stringify(e)}get resultLogMessage(){return this.statsMessage??`${h.Messages.Root}.${h.Messages.Default}`}get failedLogMessage(){const e=this.state?.kind,t=this.state?.kind===p.ExperimentState.Checking&&0===this.state?.mutableState.cellCursor;return`Units experiment timed out. Last step: ${this.lastStepMessage}. Experiment state: ${void 0!==e?p.ExperimentState[e]:"NotStarted"}. isCellCursorZero: ${t}. Number of constraints: ${this.state?.constraints.length}. Stats: ${this.statsForLogging(this.state?.stats)}`}constructor(){this.isDone=!1,this.lastStepMessage="before started"}};class L{static init(){return new L(0,v.RedBlackMapTree.create(((e,t)=>e.localeCompare(t))))}getTable(){return this.table}freshSymbol(e){const t=`${void 0===e?"gen":e}@${this.seed+=1}`,r={unit:(0,m.fromVar)(t),link:void 0,ufSubstitution:void 0};return this.table=this.table.setValue(t,r),r}copy(){return new L(this.seed,this.table)}constructor(e,t){this.seed=e,this.table=t}}function _(e,t,r){switch(e.kind){case p.TypeKind.Array:if(e.elementType.kind===p.TypeKind.Reference)return;return r?_(e.elementType,t,!1):void 0;case p.TypeKind.Reference:return{kind:S.ConstraintKind.RangeEquality,type:e,target:t};case p.TypeKind.Scalar:return void 0===e.unit?void 0:{kind:S.ConstraintKind.UnitEquality,unit:e.unit,target:t};case p.TypeKind.Union:return;default:return(0,n.assertNever)(h.Messages.Root,e)}}function x(e,t,r){switch(t.kind){case p.TypeKind.Array:if(t.elementType.kind===p.TypeKind.Reference)return;return r?x(e,t.elementType,!1):void 0;case p.TypeKind.Reference:const a=e.symbolContext.freshSymbol(),i={kind:S.ConstraintKind.RangeEquality,type:t,target:a};return[a.unit,i];case p.TypeKind.Scalar:return void 0===t.unit?void 0:[t.unit,void 0];case p.TypeKind.Union:return;default:return(0,n.assertNever)(h.Messages.Root,t)}}function K(e){const t=e.length;if(0===t)return p.topType;let r=p.bottomType;const n=e[0].length;for(let t=0;t<e.length;t+=1){const n=e[t];for(let e=0;e<n.length;e+=1)a=r,i=n[e],r=a===p.bottomType?i:i===p.bottomType||a===p.topType?a:i===p.topType?i:a.kind===p.TypeKind.Scalar&&i.kind===p.TypeKind.Scalar&&void 0===a.unit&&void 0===i.unit?(0,p.makePrimitiveType)(a.flags|i.flags):p.topType}var a,i;return(0,p.makeArrayType)(r,{rows:t,columns:n,exact:!0})}function W(e,t){if(t.kind===p.TypeKind.Reference&&!(0,p.isResolvedReferenceType)(t)){const r=function(e,t){const r=(0,d.resolveLocalsGrid)(e.origin),{resolution:n}=e.resolver.resolveCellRef(r,t.reference);return!!(0,E.isSuccess)(n)&&(!n.value||n.value)}(e,t);return"object"==typeof r?(0,p.makeResolvedReferenceType)(t.reference,r):r?p.errorType:void 0}if(t.kind===p.TypeKind.Array){const r=W(e,t.elementType);return void 0===r?r:r===t.elementType?t:(0,p.makeArrayType)(r,t.dimensions)}return t}function U(e,t){switch(t.kind){case p.TypeKind.Scalar:if(void 0===t.unit){const r=e.symbolContext.freshSymbol();return(0,p.makePrimitiveType)(t.flags,r.unit)}return t;case p.TypeKind.Array:let r=t;const a=[];for(;r.kind===p.TypeKind.Array;)a.push(r.dimensions),r=r.elementType;const i=U(e,r);return a.reduceRight(p.makeArrayType,i);case p.TypeKind.Reference:case p.TypeKind.Union:return t;default:return(0,n.assertNever)(h.Messages.Root,t)}}function G(e,t,r,n,a){const i=e.symbolContext.freshSymbol(),o=_(t,i,n),s=_(r,i,n);if(void 0!==o&&void 0!==s||a&&(void 0!==o||void 0!==s))return e.pushConstraint(o),e.pushConstraint(s),i}class B{literalNode(e){return N.Pledge.resolve(function(e){switch(e.kind){case T.OperKind.Number:return p.numberType;case T.OperKind.String:return p.stringType;case T.OperKind.Boolean:return p.boolType;case T.OperKind.Error:return p.errorType;default:return p.oneType}}(e))}arrayNode(e){return N.Pledge.all(e.map((e=>N.Pledge.all(e.map(this.lazyVisitFormulaNode))))).bind(K)}appNode(e,t){return e.kind===s.NodeKind.Operator?N.Pledge.all(t.map((e=>this.lazyVisitFormulaNode(e).bind((t=>[t,e]))))).bind((t=>function(e,t,r){switch(t){case i.OperatorId.Add:case i.OperatorId.Sub:case i.OperatorId.Mul:case i.OperatorId.Div:case i.OperatorId.Pow:case i.OperatorId.Eq:case i.OperatorId.Ne:case i.OperatorId.Lt:case i.OperatorId.Le:case i.OperatorId.Gt:case i.OperatorId.Ge:case i.OperatorId.Range:case i.OperatorId.Isect:case i.OperatorId.Union:case i.OperatorId.Concat:case i.OperatorId.And:case i.OperatorId.Or:case i.OperatorId.Xor:case i.OperatorId.Min:case i.OperatorId.Max:return function(e,t,r){if(r.length<2)return p.topType;const a=W(e,r[0][0]),o=W(e,r[1][0]);if(void 0===a||void 0===o)return p.topType;const s=(0,p.getLiftingDimensionsFromTypes)(a,o);if(!1===s)return p.topType;const u="object"==typeof s;switch(t){case i.OperatorId.Add:case i.OperatorId.Sub:case i.OperatorId.Min:case i.OperatorId.Max:{const t=G(e,a,o,u,!0);return(0,p.typeFromDimensions)(void 0===t?p.numberType:(0,p.makePrimitiveType)(T.OperKind.Number,t.unit),s)}case i.OperatorId.Eq:case i.OperatorId.Ne:case i.OperatorId.Lt:case i.OperatorId.Le:case i.OperatorId.Gt:case i.OperatorId.Ge:return G(e,a,o,u,!1),(0,p.typeFromDimensions)(p.boolType,s);case i.OperatorId.Mul:case i.OperatorId.Div:if(f.UnitExperimentSettings.IgnoreDivMul)return p.numberType;{const r=e.symbolContext.freshSymbol(),n=e.symbolContext.freshSymbol(),l=_(a,r,u),c=_(o,n,u);if(e.pushConstraint(l),e.pushConstraint(c),void 0===l&&void 0===c)return(0,p.typeFromDimensions)(p.numberType,s);const d=t===i.OperatorId.Mul?(0,m.prod)(r.unit,n.unit):(0,m.prod)(r.unit,(0,m.inv)(n.unit));return(0,p.typeFromDimensions)((0,p.makePrimitiveType)(T.OperKind.Number,d),s)}case i.OperatorId.Pow:const[,l]=r[1];if((0,M.isNumberLiteralNode)(l)){const t=e.mathpack.toNumber(l.oper);if((0,F.isInteger)(t)){const r=x(e,a,"object"==typeof s);return void 0===r?(0,p.typeFromDimensions)(p.numberType,s):(e.pushConstraint(r[1]),(0,p.typeFromDimensions)((0,p.makePrimitiveType)(T.OperKind.Number,(0,m.pow)(r[0],t,p.dimensionLess)),s))}}return p.topType;case i.OperatorId.Range:case i.OperatorId.Isect:case i.OperatorId.Union:return p.topType;case i.OperatorId.Concat:return(0,p.typeFromDimensions)(p.stringType,s);case i.OperatorId.And:case i.OperatorId.Or:case i.OperatorId.Xor:return(0,p.typeFromDimensions)(p.boolType,s);default:return(0,n.assertNever)(h.Messages.Root,t)}}(e,t,r);case i.OperatorId.Percent:case i.OperatorId.Neg:case i.OperatorId.Pos:case i.OperatorId.At:case i.OperatorId.Pound:return function(e,t,r){if(r.length<1)return p.topType;const[a]=r[0],o=W(e,a);if(void 0===o)return p.topType;const s=(0,p.dimensionsFromType)(o);if(!1===s)return p.topType;switch(t){case i.OperatorId.Percent:return(0,p.typeFromDimensions)(p.dimensionlessNumberType,s);case i.OperatorId.Neg:case i.OperatorId.Pos:const r=x(e,o,"object"==typeof s);return void 0===r?(0,p.typeFromDimensions)(p.numberType,s):(e.pushConstraint(r[1]),(0,p.typeFromDimensions)((0,p.makePrimitiveType)(T.OperKind.Number,r[0]),s));case i.OperatorId.At:case i.OperatorId.Pound:return p.topType;default:return(0,n.assertNever)(h.Messages.Root,t)}}(e,t,r);default:return(0,n.assertNever)(h.Messages.Root,t)}}(this.context,e.id,t))):e.kind===s.NodeKind.WSF?N.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((t=>function(e,t,r){switch(t){case o.WorksheetFuncId.SUM:case o.WorksheetFuncId.AVERAGE:case o.WorksheetFuncId.MAX:case o.WorksheetFuncId.MIN:if(0===r.length)return p.topType;const t=e.symbolContext.freshSymbol();let n=!0;return r.forEach((r=>{const a=W(e,r);a&&e.pushConstraint(_(a,t,!0))&&(n=!1)})),n?p.numberType:(0,p.makePrimitiveType)(T.OperKind.Number,t.unit);case o.WorksheetFuncId.IF:if(r.length<2)return p.topType;const a=W(e,r[0]),i=W(e,r[1]),s=W(e,void 0===r[2]?p.boolType:r[2]);if(void 0===a)return void 0!==i&&void 0!==s&&G(e,i,s,!0,!1),p.topType;const u=(0,p.dimensionsFromType)(a),l="object"==typeof u;if(void 0===i||void 0===s)return p.topType;const c=G(e,i,s,!0,!0),d=c?(0,p.primitiveUnitType)(c.unit):p.primitiveType;return l?(0,p.makeArrayType)(d,u):d;default:return p.topType}}(this.context,e.id,t))):N.Pledge.resolve(p.topType)}letNode(e,t,r,n){return N.Pledge.resolve(p.topType)}lambdaNode(e,t,r,n){return N.Pledge.resolve(p.topType)}parenNode(e){return this.lazyVisitFormulaNode(e)}nameNode(e,t){return N.Pledge.resolve(p.topType)}cellRefNode(e,t){return N.Pledge.resolve((0,p.makeReferenceType)((0,u.cellRefNode)(e,t)))}fieldRefNode(e,t){return N.Pledge.resolve(p.topType)}structRefNode(e,t){return N.Pledge.resolve(p.topType)}missingNode(e){return N.Pledge.resolve(p.topType)}badSequenceNode(e,t){return N.Pledge.resolve(p.topType)}badCharsNode(e,t){return N.Pledge.resolve(p.topType)}operatorNode(e,t){return N.Pledge.resolve((0,l.operatorNode)(e,t))}wsfNode(e,t,r){return N.Pledge.resolve((0,c.wsfNode)(e,t,r))}constructor(e){this.context=e,this.visitFormulaNode=e=>(0,k.visitFormulaNode)(this,e),this.lazyVisitFormulaNode=e=>N.Pledge.resolve(e).bind(this.visitFormulaNode)}}},8210:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unify=t.compose=t.createPoisonApplication=t.UnificationResultKind=t.substituteVariable=t.serialiseMeasure=t.toUnitConstraint=t.shuffleNormalForms=t.pow=t.inv=t.prod=t.areSignaturesEqual=t.isSimpleUnit=t.fromVar=t.fromConstants=t.makeSignature=t.someVar=t.everyVar=t.someConst=t.everyConst=void 0;const n=r(6366),a=r(6366),i=r(9739);function o(e,t){for(const r in e)if(!t(r,e[r]))return!1;return!0}const s=(e,t)=>!o(e,((e,r)=>!t(e,r)));function u(e,t){let r=0;!function(e,t){for(const t in e)e[t],r+=1}(t.vars),(0,n.assertTrue)(e,void 0===t.name||1===t.varCount),(0,n.assertTrue)(e,t.varCount===r)}function l(e,t,r){const n={varCount:e,vars:t,consts:r,name:void 0};return u(i.Messages.Root,n),n}function c(){}function d(){return new c}t.everyConst=(e,t)=>o(e.consts,t),t.someConst=(e,t)=>s(e.consts,t),t.everyVar=(e,t)=>o(e.vars,t),t.someVar=(e,t)=>s(e.vars,t),t.makeSignature=l;const g=d();function m(){return l(0,{},d())}function h(e){return l(0,{},e)}t.fromConstants=h,t.fromVar=function(e){const t=l(1,{[e]:1},g);return t.name=e,t};const p=()=>!1;function f(e,r){return(0,t.everyVar)(e,((e,t)=>r.vars[e]===t))&&(0,t.everyConst)(e,((e,t)=>r.consts[e]===t))}function S(e,t){const r=m(),{vars:n,consts:a}=e,{vars:o,consts:s}=t;for(const e in n){const t=n[e]-(o[e]??0);0!==t&&(r.vars[e]=t,r.varCount+=1)}for(const e in a){const t=a[e]-(s[e]??0);0!==t&&(r.consts[e]=t)}for(const e in o)void 0===n[e]&&(r.vars[e]=-o[e],r.varCount+=1);for(const e in s)void 0===a[e]&&(r.consts[e]=-s[e]);return u(i.Messages.Root,r),r}function v(e,t,r,n){return r?1===t?e:`${e}^${t}`:-1===t?e:`${e}^${t*n}`}function F(e,t,r){const{vars:n,consts:a}=t,i=n[e];if(void 0===i)return t;let o=0;const{vars:s,consts:u}=m();for(const t in n){const a=r.vars[t],u=void 0===a?0:a,l=(t===e?0:n[t])+u*i;0!==l&&(o+=1,s[t]=l)}for(const e in r.vars)void 0===n[e]&&(o+=1,s[e]=i*r.vars[e]);for(const e in a){const t=r.consts[e],n=a[e]+i*(void 0===t?0:t);0!==n&&(u[e]=n)}for(const e in r.consts)void 0===a[e]&&(u[e]=i*r.consts[e]);return l(o,s,u)}var y;t.isSimpleUnit=function(e){if(0===e.varCount)return!0;if(void 0!==e.name)return!0;if(1===e.varCount&&(e.consts===g||(0,t.everyConst)(e,p))){const t=function(e,t){for(const t in e.vars)return 1===e.vars[t]?t:void 0}(e);return void 0!==t&&(e.name=t,!0)}return!1},t.areSignaturesEqual=function(e,t){return f(e,t)&&f(t,e)},t.prod=function(e,t){const r=m(),{vars:n,consts:a}=e,{vars:o,consts:s}=t;for(const e in n){const t=n[e]+(o[e]??0);0!==t&&(r.vars[e]=t,r.varCount+=1)}for(const e in a){const t=a[e]+(s[e]??0);0!==t&&(r.consts[e]=t)}for(const e in o)void 0===n[e]&&(r.vars[e]=o[e],r.varCount+=1);for(const e in s)void 0===a[e]&&(r.consts[e]=s[e]);return u(i.Messages.Root,r),r},t.inv=function(e){const t=m(),{vars:r,consts:n}=e;for(const e in r)t.vars[e]=-r[e];for(const e in n)t.consts[e]=-n[e];return t.varCount=e.varCount,u(i.Messages.Root,t),t},t.pow=function(e,t,r){if(0===t)return r;const n=m(),{vars:a,consts:o}=e;for(const e in a)n.vars[e]=a[e]*t;for(const e in o)n.consts[e]=o[e]*t;return n.varCount=e.varCount,u(i.Messages.Root,n),n},t.shuffleNormalForms=function(e,r){const a=m(),o=m(),s=a.vars,l=o.consts;for(const t in e.vars){const n=e.vars[t]-(r.vars[t]??0);0!==n&&(s[t]=n,a.varCount+=1)}for(const t in r.vars)void 0===e.vars[t]&&(s[t]=-r.vars[t],a.varCount+=1);for(const t in r.consts){const n=r.consts[t]-(e.consts[t]??0);0!==n&&(l[t]=n)}for(const t in e.consts)void 0===r.consts[t]&&(l[t]=-e.consts[t]);return u(i.Messages.Root,a),u(i.Messages.Root,o),(0,n.assertTrue)(i.Messages.Root,(0,t.everyConst)(a,p)),{vars:a,consts:o}},t.toUnitConstraint=S,t.serialiseMeasure=function(e){const t=[],r=[];for(const n in e.vars){const a=e.vars[n];a>0?t.push([n,a]):r.push([n,a])}for(const n in e.consts){const a=e.consts[n];a>0?t.push([n,a]):r.push([n,a])}if(0===r.length)return 0===t.length?"1":t.map((([e,t])=>v(e,t,!0,1))).join("*");let n=r.map((([e,t])=>v(e,t,!1,-1))).join("*");return r.length>1&&(n="("+n+")"),0===t.length?`1/${n}`:`${t.map((([e,t])=>v(e,t,!0,1))).join("*")}/${n}`},t.substituteVariable=F,function(e){e[e.Fail=0]="Fail",e[e.Subst=1]="Subst"}(y||(t.UnificationResultKind=y={}));const b=()=>{},C={kind:y.Subst,substitution:b},A=e=>({kind:y.Subst,substitution:e}),E={kind:y.Fail},T=e=>e<0?-e:e;function R(e,t,r){const n={};return r===b?t:t===b?r:a=>{const i=n[a];if(void 0!==i)return i;const o=r(a);return n[a]=void 0===o?t(a):e(t,o)}}function k(e,t){return r=>e===r?t:void 0}function N(e,r,o){if(e>=100)return(0,a.assertFalse)(i.Messages.UnifyBound);if(0===o.varCount)return(0,t.everyConst)(o,p)?C:E;if(1===o.varCount){let e;for(const t in o.vars){e=t;break}(0,n.assertTrue)(i.Messages.Root,void 0!==e);const t=o.vars[e],r={};for(const e in o.consts){const n=o.consts[e];if(n%t!=0)return E;r[e]=-n/t}return A(k(e,h(r)))}let s,u,c=0;const{vars:d,consts:g,varCount:m}=o;for(const e in d){const t=d[e],r=T(t);(void 0===u||r<u)&&(c=t,u=r,s=e)}(0,n.assertTrue)(i.Messages.Root,void 0!==s),(0,n.assertTrue)(i.Messages.Root,0!==c);const f={},S={};for(const e in d)if(e===s)f[e]=1;else{const t=d[e];f[e]=-Math.floor(t/c)}for(const e in g){const t=g[e];S[e]=-Math.floor(t/c)}const v=l(m,f,S),b=N(e+1,r,F(s,o,v));return b.kind===y.Fail?b:A(R(r,b.substitution,k(s,v)))}t.createPoisonApplication=function(e){return(t,r)=>{if(0===r.varCount||t===b)return r;let n=r;for(const a in r.vars){const r=t(a);if(r===e)return e;void 0!==r&&(n=F(a,n,r))}return n}},t.compose=R,t.unify=(e,t,r)=>N(0,e,S(t,r))},941:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logMissingJSFeatures=t.getMissingJSFeatures=void 0;const n=r(6366),a=r(6067),i=r(6067),o=r(6366),s=[{name:"self",test:()=>"undefined"!=typeof self},{name:"setImmediate",test:()=>"function"==typeof setImmediate},{name:"fetch",test:()=>"function"==typeof fetch},{name:"Set",test:()=>"function"==typeof Set},{name:"Map",test:()=>"function"==typeof Map},{name:"WeakMap",test:()=>"function"==typeof WeakMap},{name:"Symbol",test:()=>"function"==typeof Symbol},{name:"WebAssembly",test:()=>"object"==typeof WebAssembly},{name:"Atomics",test:()=>"object"==typeof Atomics},{name:"BigInt",test:()=>"function"==typeof BigInt},{name:"String.startsWith",test:()=>"function"==typeof"".startsWith},{name:"String.codePointAt",test:()=>"function"==typeof"".codePointAt},{name:"Object.assign",test:()=>"function"==typeof Object.assign},{name:"Object.setPrototypeOf",test:()=>"function"==typeof Object.setPrototypeOf},{name:"Number.EPSILON",test:()=>"number"==typeof Number.EPSILON},{name:"Number.isFinite",test:()=>"function"==typeof Number.isFinite},{name:"Number.parseInt",test:()=>"function"==typeof Number.parseInt},{name:"Math.acosh",test:()=>"function"==typeof Math.acosh},{name:"Math.hypot",test:()=>"function"==typeof Math.hypot},{name:"Math.log1p",test:()=>"function"==typeof Math.log1p},{name:"Math.trunc",test:()=>"function"==typeof Math.trunc},{name:"Promise.finally",test:()=>"function"==typeof Promise.resolve().finally},{name:"RegExp_flags",test:()=>(new RegExp("x","i"),!0)},{name:"RegExp.flags",test:()=>"string"==typeof/x/.flags},{name:"Array.of",test:()=>"function"==typeof Array.of},{name:"Array.entries",test:()=>"function"==typeof[].entries},{name:"Array.find",test:()=>"function"==typeof[].find},{name:"performance",test:()=>"object"==typeof performance},{name:"performance.now",test:()=>"function"==typeof performance.now},{name:"performance.timeOrigin",test:()=>"number"==typeof performance.timeOrigin},{name:"performance.memory",test:()=>"object"==typeof performance.memory}];function u(){return s.map((({name:e,test:t})=>{try{return t()?"":e}catch{return e}})).filter((e=>e.length>0))}t.getMissingJSFeatures=u,t.logMissingJSFeatures=function(e){e().then((e=>{const t={main:u(),worker:e},r=`calc.calc.logMissingJSFeatures: missing = ${JSON.stringify(t)}`;n.ulsLogger.ULS.traceTag(561534152,a.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,r)})).catch((e=>{const t=`calc.calc.logMissingJSFeatures: threw ${(0,o.messageFromError)(e)}`;n.ulsLogger.ULS.traceTag(561534153,a.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,t)}))}},1585:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbook=t.EvalOnClonePropsFromPartialWBDocumentCollection=t.EvalOnClonePropsFromPartialWB=t.MaxStateIdDifferenceForGC=void 0;const n=r(8073),a=r(8073),i=r(8073),o=r(8073),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(6067),E=r(6869),T=r(6366),R=r(6366),k=r(6366),N=r(6468),I=r(2393),O=r(3519),P=r(6366),M=r(6366),D=r(6366),w=r(8760),L=r(6366),_=r(5013),x=r(5013),K=r(6366),W=r(4068),U=r(3725),G=r(3228),B=r(3228),V=r(6067),j=r(6366),H=r(6366),q=r(6366),z=r(6366),Q=r(6366),$=r(6067),Y=r(6067),J=r(6067),X=r(6855),Z=r(3319),ee=r(6366),te=r(637),re=r(8072),ne=r(6366),ae=r(1276),ie=r(6067),oe=r(472),se=r(472),ue=r(472),le=r(472),ce=r(472),de=r(472),ge=2*h.sheetCols;t.MaxStateIdDifferenceForGC=17;const me=(0,S.gridRange)(0,0,v.sheetRows,h.sheetCols);function he(e,t){let r;return t.kind===i.ReasonKind.Unavailable&&t.objects.length>0&&"kind"in t.objects[0]&&(r=t.objects[0].kind),(0,Q.failure)({cell:e,kind:t.kind,innerKind:r})}const pe=(0,$.binaryVisitor)({...(0,Y.constVisitor)(!1),wsfNode:e=>e===A.WorksheetFuncId.HYPERLINK},((e,t)=>e||t));var fe,Se;!function(e){e.EvalFinished="EvalFinished",e.EvalTimedOut="EvalTimedOut",e.StateIdAdvanced="StateIdAdvanced",e.EditReceived="EditReceived",e.SetSheetNames="SetSheetNames",e.SetLangConfig="SetLangConfig"}(fe||(fe={})),t.EvalOnClonePropsFromPartialWB=class{constructor(e,t){this.formatResults=t,this.resultsPromise=new ee.ResolvablePromise,this.stateId=-1,this.cloneLazy=new te.ResettableLazy((()=>e.createSnapshotSync()))}},t.EvalOnClonePropsFromPartialWBDocumentCollection=class{constructor(e,t){this.formatResults=t,this.resultsPromise=new ee.ResolvablePromise,this.stateId=-1,this.cloneLazy=new te.ResettableLazy((()=>e.clone(w.voidCallback,I.CloningTarget.Client)))}},function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.EvalFormula=2]="EvalFormula",e[e.BeforeCompute=3]="BeforeCompute",e[e.ComputeCellValue=4]="ComputeCellValue",e[e.AfterCompute=5]="AfterCompute",e[e.ComputeEvalOnClone=6]="ComputeEvalOnClone",e[e.ComputeEvalFormula=7]="ComputeEvalFormula",e[e.RecalcFinished=8]="RecalcFinished",e[e.CompleteDataQuery=9]="CompleteDataQuery",e[e.MaybeCollectGarbage=10]="MaybeCollectGarbage",e[e.RunExperiment=11]="RunExperiment",e[e.TestAdvanceState=12]="TestAdvanceState"}(Se||(Se={}));class ve{reconfigure(e){this.config=e,this.rng=new L.JSF32(void 0!==e.rngSeed?e.rngSeed:0),this.docs.reconfigure(e,e,e.maxDereferenceCells??ge,e.isServerWorkbookLoad??!1)}getDocs(){return this.docs}setWorksheetFuncOverrides(e){this.docs.setWorksheetFuncOverrides(e)}onNameFailure(e,t,r){r.computeKind!==E.ComputeKind.EvalFormula&&this.outputMessageLog.push({kind:E.OutputMessageKind.NameFailure,stateId:this.stateId,name:e,reason:t})}onRangeFailure(e,t,r,n,a){a.computeKind!==E.ComputeKind.EvalFormula&&this.outputMessageLog.push({kind:E.OutputMessageKind.RangeFailure,stateId:this.stateId,cellKind:n,range:e,reason:t})}onNumberFormatFailure(e){this.outputMessageLog.push({kind:E.OutputMessageKind.NumberFormatFailure,stateId:this.stateId,reason:e})}onInferFormatFailure(e,t){this.outputMessageLog.push({kind:E.OutputMessageKind.InferFormatFailure,stateId:this.stateId,range:e,reason:t})}onUnavailableObject(e){const t=(0,l.unavailable)([e]);this.onUnavailable(t)}onUnavailable(e){this.outputMessageLog.push({kind:E.OutputMessageKind.UnhandledFailure,stateId:this.stateId,reason:e})}onSetCellValue(e,t,r,n,a){if(a.computeKind===E.ComputeKind.EvalFormula)return;const i=this.outputCell(e,t,n,this.printFormulaProperties);void 0!==i?(this.outputMessageLog.push({kind:E.OutputMessageKind.RecalcStatistics,message:E.RecalcStatisticsMessage.ChangedCell,stateId:this.stateId,cellKind:n}),n!==E.ComputedCellKind.EditedCell&&n!==E.ComputedCellKind.DependentCell||this.outputMessageLog.push({kind:E.OutputMessageKind.CellWrite,stateId:this.stateId,cellKind:n,cell:e,...i,formatted:this.formatValue(n,e,t)})):this.outputMessageLog.push({kind:E.OutputMessageKind.RecalcStatistics,message:E.RecalcStatisticsMessage.UnchangedCell,stateId:this.stateId,cellKind:n})}onSetCellValues(e,t,r,n,a){if(a.computeKind===E.ComputeKind.EvalFormula)return;const i=this.outputRange(e,t,n);void 0!==i&&(n!==E.ComputedCellKind.EditedCell&&n!==E.ComputedCellKind.DependentCell||this.outputMessageLog.push({kind:E.OutputMessageKind.RangeWrite,stateId:this.stateId,cellKind:n,range:e,...i,formatted:t.map(((t,r)=>t.map(((t,a)=>this.formatValue(n,(0,m.sheetGridCell)(e.sheet,(0,y.gridCell)(e.range.row+r,e.range.col+a)),t)))))}))}onReturnCellValue(e,t,r){const n=this.outputCell(e,t,r,(()=>this.printValueProperties(e,t)));void 0!==n?(this.outputMessageLog.push({kind:E.OutputMessageKind.RecalcStatistics,message:E.RecalcStatisticsMessage.ChangedCell,stateId:this.stateId,cellKind:E.ComputedCellKind.EditedCell}),r===E.ComputedCellKind.EditedCell&&this.outputMessageLog.push({kind:E.OutputMessageKind.CellWrite,stateId:this.stateId,cellKind:E.ComputedCellKind.EditedCell,cell:e,...n,formatted:this.formatValue(r,e,t)})):this.outputMessageLog.push({kind:E.OutputMessageKind.RecalcStatistics,message:E.RecalcStatisticsMessage.UnchangedCell,stateId:this.stateId,cellKind:E.ComputedCellKind.EditedCell})}createSnapshot(e,t=I.CloningTarget.Client){return new Promise((r=>{this.scheduler.addTask(Se.CompleteDataQuery,U.QueuePos.Back,{onRun:()=>{let n=!1;const a=this.docs.clone(w.voidCallback,t);void 0!==this.latestSnapshot&&-1!==this.latestSnapshotID&&this.latestSnapshot.compareVersion(a)||(n=!0,this.latestSnapshot=a,this.latestSnapshotID=e),ae.x10Logger.log({kind:"snapshotCreation",payload:n}),r({snapshot:this.latestSnapshot,correspondingId:this.latestSnapshotID})},onDeleted:()=>{r(void 0)}})}))}createSnapshotSync(e=I.CloningTarget.Client){return this.docs.clone(w.voidCallback,e)}outputCell(e,t,r,n){let a;if(r===E.ComputedCellKind.EditedCell||r===E.ComputedCellKind.DependentCell){const r=this.docs.testAndSetClientValue(e,t);a=(0,H.isSuccess)(r)?r.value?t:void 0:void this.onUnavailableObject(r.reason)}const i=this.outputFormat(e,r),o=this.outputFormulaProperties(e,r,n);return void 0!==a||void 0!==i||void 0!==o?{value:t,format:i,formulaBarText:o?.formulaBarText,hasHyperlink:o?.hasHyperlink}:void 0}outputRange(e,t,r){if(r===E.ComputedCellKind.EditedCell||r===E.ComputedCellKind.DependentCell){const r=this.docs.setClientValue(e,t);(0,H.isSuccess)(r)||this.onUnavailableObject(r.reason)}const n=t.map(((t,n)=>t.map(((t,a)=>this.outputFormat((0,m.sheetGridCell)(e.sheet,(0,y.gridCell)(e.range.row+n,e.range.col+a)),r))))),a=this.outputFormulaProperties(e,r,this.printFormulaProperties);return{values:t,formats:n,formulaBarText:a?.formulaBarText}}outputFormat(e,t){if(t!==E.ComputedCellKind.EditedCell)return;const r=this.docs.getEditedFormat(e);if(!(0,H.isSuccess)(r))return void this.onUnavailableObject(r.reason);const n=this.docs.testAndSetClientFormat(e,r.value);if(!(0,H.isSuccess)(n))return void this.onUnavailableObject(n.reason);if(!n.value)return;const a=r.value;if(a===E.SpecialFormat.Unavailable)return{format:(0,l.unavailable)([{kind:E.UnavailableKind.CellFormat}]),valueType:B.FormatValueType.Custom,decimals:0};const i=this.docs.resolveCellFormat(e.sheet.document,a);return(0,H.isSuccess)(i)?{format:"number"==typeof a?a:a.formatString,valueType:i.value.valueType,decimals:i.value.decimals}:void 0}outputFormulaProperties(e,t,r){if(t!==E.ComputedCellKind.EditedCell)return;const n=r(e);if(void 0===n)return;const{formulaBarText:a,hasHyperlink:i,isFormula:o}=n,s=this.docs.testAndSetClientFormula(e,a,i);if(!(0,H.isSuccess)(s))return void this.onUnavailableObject(s.reason);const{hasFmlaChanged:u,hasHyperlinkChanged:l}=s.value;return u||l?{formulaBarText:u?a:void 0,hasHyperlink:l?i:void 0,isFormula:o}:void 0}formatValue(e,t,r,n){const a=n??this.docs,i=a.formatValueCell(t,r);if((0,H.isSuccess)(i))return i.value;a===this.docs&&this.outputMessageLog.push({kind:E.OutputMessageKind.FormatValueFailure,stateId:this.stateId,cellKind:e,range:t,reason:i.reason})}getAvailableFormula(e){const t=this.docs.getEditedFormula(e);if(!(0,H.isSuccess)(t))return t;if(void 0===t.value)return(0,Q.failure)({kind:E.UnavailableKind.CellMissingFormula});const[r,n]=t.value;if(void 0===n.compiledFmla)return(0,Q.failure)({kind:E.UnavailableKind.CellEvaluatingValue});const a=(0,f.lexicalSourceGrid)(n.lexicalKind,(0,p.sheetGridRange)(e.sheet,r));return(0,q.success)([a,n])}formulaHasHyperlink(e){if(e.lexicalKind!==b.LexicalKind.Cell)return!1;const t=e?.compiledFmla.getValue();return(0,H.isSuccess)(t)?(0,J.reduceBottomUp)(pe,t.value):void 0}handleSetCellContents(e,t,r,n,a,i,o,s,u,c,d){let g,h,p,f=void 0!==u?(0,l.unavailable)([{kind:E.UnavailableKind.ClientFailure,reason:u}]):void 0,S=o;void 0!==n?(g=n,(0,R.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: formula edit",void 0!==a),h=a):void 0===r?((0,R.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: format edit",!e&&void 0===a&&void 0!==o&&void 0===f),g=!1,h=void 0):((0,R.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: inferred edit",!e&&void 0===f&&S===E.SpecialFormat.Weak),({isFormula:g,oper:h,cellFailure:f,cellFormat:S,inferredFormat:p}=this.parseInferredEdit(t,r,i,f,S,d)));const v=void 0!==d?d.cloneLazy.getValue():this.docs,F=v.setCellContents(e,t,r,g,i,h,f,S,s,c);if(F.kind===z.ResultKind.Failure)return this.onUnavailableObject(F.reason);if(v.onCellModified(e),!e){const e=(0,m.sheetGridCell)(t.sheet,i);let n=void 0===r?(0,q.success)(void 0):g?v.inferFormulaFormat(e):void 0!==p&&p!==V.KnownFormat.General?v.resolveValueFormat(t.sheet.document,p):(0,q.success)(void 0);n.kind!==z.ResultKind.Success&&(this.onInferFormatFailure(e,n.reason),n=(0,q.success)(E.SpecialFormat.Unavailable)),void 0!==n.value&&v.fillInferredFormat(t,n.value),void 0!==d?(d.stateId=this.stateId,this.enqueueEvalFormulaComputeCellValuesOnDocs(t,v,d)):this.enqueueBeforeCompute(c)}}parseInferredEdit(e,t,r,n,a,i){const o=i?i.cloneLazy.getValue().parseInferredEdit((0,m.sheetGridCell)(e.sheet,r),t,this.getVolatileMode()):this.docs.parseInferredEdit((0,m.sheetGridCell)(e.sheet,r),t,this.getVolatileMode());if(!(0,H.isSuccess)(o))return{isFormula:!1,oper:C.blankOper,cellFailure:o.reason,cellFormat:E.SpecialFormat.Unavailable};const s=t.length>0?t.charAt(0):"";switch("="!==s&&"+"!==s&&"-"!==s||o.value.kind!==G.EditKind.Formula&&o.value.kind!==G.EditKind.Number||k.ulsLogger.ULS.dnmTraceTag(541189698,W.LogCategory.msoulscat_ES_EWAJS,W.TraceLevel.Info,JSON.stringify({startChar:s,editKind:String(o.value.kind)})),o.value.kind){case G.EditKind.Formula:return{isFormula:!0,oper:C.blankOper,cellFailure:n,cellFormat:a};case G.EditKind.String:case G.EditKind.Other:return{isFormula:!1,oper:o.value.value,cellFailure:n,cellFormat:a};case G.EditKind.Number:return{isFormula:!1,oper:o.value.value,cellFailure:n,cellFormat:a,inferredFormat:o.value.format}}}handleSetRangeFormula(e,t,r,n,a){const i=(0,O.isFormulaText)(r);(0,R.assertTrue)("calc.calc.PartialWorkbook: handleSetRangeFormula",""===r&&!e||i);const o=e?void 0:C.blankOper,s=e?void 0:E.SpecialFormat.Weak,u=e?void 0:E.SpecialStyle.Weak,l=this.docs.setRangeFormula(e,t,r,n,o,s,u,a);if(l.kind===z.ResultKind.Failure)return this.onUnavailableObject(l.reason);this.docs.onCellModified(e),e||this.enqueueBeforeCompute(a)}handleEditPaste(e,t,r,n){const a=(0,p.sheetGridRange)(t.sheet,(0,S.gridRange)(t.range.row,t.range.col,r.range.rows,r.range.cols)),i=this.docs.copyRange(r);if(i.kind===z.ResultKind.Failure)return this.onUnavailableObject(i.reason);const o=this.docs.pasteRange(a,i.value);if(o.kind===z.ResultKind.Failure)return this.onUnavailableObject(o.reason);this.docs.onCellModified(!1),this.enqueueBeforeCompute(n)}handleAssumeRecalcFinal(e){this.scheduler.getCount(Se.BeforeCompute)<0||this.scheduler.addTask(Se.ComputeCellValue,U.QueuePos.Front,(()=>{const t=this.docs.assumeRecalcFinal(e);if(t.kind===z.ResultKind.Failure)return this.onUnavailableObject(t.reason)}))}evalFormula(e,t,r,n,a){return new Promise((i=>{const s=()=>i({value:(0,Q.failure)(o.stopped)});this.scheduler.deleteTasks(Se.EvalFormula,void 0),this.scheduler.addTask(Se.EvalFormula,U.QueuePos.Back,{onRun:()=>{if(!a&&!this.trySetStateId(Se.EvalFormula,e))return s();this.enqueueComputeEvalFormula(t,r,n,a,i)},onDeleted:s}),this.enqueueRecalcFinished()}))}enqueueBeforeCompute(e){this.scheduler.deleteTasks(Se.BeforeCompute,void 0),this.scheduler.addTask(Se.BeforeCompute,U.QueuePos.Back,(()=>{this.enqueueAfterCompute(),this.restrictToViewport(this.docs.getNonDirtyEditedCells(),e,E.ComputeKind.EditedCell,this.scheduleAvailableValues),this.restrictToViewport(this.docs.getDirtyEditedCells(),e,E.ComputeKind.EditedCell,this.scheduleAvailableFormulas),this.restrictToViewport(this.docs.getDirtyDependentCells(),e,E.ComputeKind.DependentCell,this.scheduleAvailableFormulas)}))}withEvalTiming(e){const t=this.docs.schedulerConfig.totalTimeMs;if(void 0===t)return e();const r=(0,P.now)();let n;try{n=e()}finally{this.stateEvalTime+=(0,M.fastMax)(1,(0,P.now)()-r),this.stateEvalTime>=t&&(this.deleteComputeTasks(fe.EvalTimedOut),this.outputMessageLog.push({kind:E.OutputMessageKind.RecalcStatistics,stateId:this.stateId,message:E.RecalcStatisticsMessage.StateTimedOut}),n=[])}return n}enqueueEvalFormulaComputeCellValuesOnDocs(e,t,r){const a=[];(0,N.forEachCellInSet)(e.set,(t=>(a.push((0,m.sheetGridCell)(e.sheet,t)),!0)));let u=(0,ie.makeGridRangeTable)();const c=(t,r,n)=>{(0,d.isSheetIndexEqual)(t.sheet,e.sheet)&&(0,x.meetsProduct)(e.set,(0,N.createCellSetFromRange)(t.range))&&(0,s.forEachCellInRange)(t.range,(e=>(u=u.setValue(e,r),!0)))};let g=()=>t.evaluate(E.ComputeKind.EvalFormula,a,this.getVolatileMode(),c);const h={onRun:()=>{const e=this.withEvalTiming(g);if(Array.isArray(e)){const o=e.map(((e,o)=>{const s=a[o].range;if(!(0,H.isSuccess)(e)){if(e.reason.kind===i.ReasonKind.Stopped)return he(s,e.reason);const t=(0,l.unavailable)([{kind:E.UnavailableKind.EvalFailure,reason:e.reason}]);return this.onUnavailable(t),he(s,t)}const c=t.getCellValue(a[o]);if(!(0,H.isSuccess)(c))return he(s,u.getValue(s)??c.reason);try{(0,R.assertTrue)("calc.calc.PartialWorkbook: FinalValue after evalCell",c.value.kind===n.CellKind.FinalValue)}catch(e){const t=(0,l.unavailable)([{kind:E.UnavailableKind.EvalFailure,reason:(0,j.javaScriptError)(e)}]);return this.onUnavailable(t),he(s,t)}const d=c.value.oper;if(!0===r.formatResults){const e=this.formatValue(E.ComputedCellKind.EditedCell,a[o],d,t);return(0,q.success)({cell:s,value:d,formatted:e})}return!1===r.formatResults?(0,q.success)({cell:s,value:d,formatted:void 0}):(0,q.success)((0,D.pair)(a[o].range,d))}));r.resultsPromise.resolve({stateId:r.stateId,results:o})}else g=e.resume,this.scheduler.addTask(Se.ComputeEvalOnClone,U.QueuePos.Front,h)},onDeleted:()=>r.resultsPromise.resolve({stateId:r.stateId,results:(0,ne.arrayFill)(new Array(a.length),(0,Q.failure)(o.stopped))})};this.scheduler.addTask(Se.ComputeEvalOnClone,U.QueuePos.Front,h)}enqueueComputeCellValue(e,t){const r=t===E.ComputeKind.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?(0,K.ulsStopwatchFactory)("calc.calc.PartialWorkbook: recalc edited"):void 0;let n,a=!0,o=()=>this.docs.evaluate(t,[e],this.getVolatileMode());const s=()=>{if(a){a=!1,n=this.shouldSample(this.config.sampleCellEvalStopwatchRate)?(0,K.ulsStopwatchFactory)("calc.calc.PartialWorkbook: cell eval"):void 0;const t=this.docs.getEditedFormula(e);if(!(0,H.isSuccess)(t))return this.onUnavailableObject(t.reason);if(void 0===t.value)return}else this.outputMessageLog.push({kind:E.OutputMessageKind.RecalcStatistics,stateId:this.stateId,message:E.RecalcStatisticsMessage.ContinueComputation});const t=this.withEvalTiming(o);if(Array.isArray(t)){n?.stop(),r?.stop();for(const e of t)(0,H.isSuccess)(e)||e.reason.kind===i.ReasonKind.Stopped||this.onUnavailableObject({kind:E.UnavailableKind.EvalFailure,reason:e.reason})}else o=t.resume,this.scheduler.addTask(Se.ComputeCellValue,U.QueuePos.Front,s)};this.scheduler.addTask(Se.ComputeCellValue,U.QueuePos.Back,s)}enqueueComputeEvalFormula(e,t,r,n=this.docs,a){const i=this.getVolatileMode();let s=()=>n.evalFormula(e,t,r,i);const u={onRun:()=>{const e=s();e.kind===z.ResultKind.Paused||e.kind===z.ResultKind.Breaked?(s=e.resume,this.scheduler.addTask(Se.ComputeEvalFormula,U.QueuePos.Front,u)):a(e.value)},onDeleted:()=>a({value:(0,Q.failure)(o.stopped)})};this.scheduler.addTask(Se.ComputeEvalFormula,U.QueuePos.Back,u)}enqueueReturnCellValue(e,t){const r=this.getVolatileMode();this.scheduler.addTask(Se.ComputeCellValue,U.QueuePos.Back,(()=>{this.docs.evalValue(e,t,r)}))}enqueueAfterCompute(){this.scheduler.deleteTasks(Se.AfterCompute,fe.EditReceived);const e=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?(0,K.ulsStopwatchFactory)("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.scheduler.addTask(Se.AfterCompute,U.QueuePos.Back,{onRun:()=>{e?.stop(fe.EvalFinished),this.outputMessageLog.push({kind:E.OutputMessageKind.RecalcStatistics,message:E.RecalcStatisticsMessage.EditFinished,stateId:this.stateId})},onDeleted:t=>{e?.stop(t)}})}enqueueRecalcFinished(){this.scheduler.deleteTasks(Se.RecalcFinished,void 0),this.scheduler.addTask(Se.RecalcFinished,U.QueuePos.Back,(()=>{this.outputMessageLog.push({kind:E.OutputMessageKind.RecalcStatistics,message:E.RecalcStatisticsMessage.RecalcFinished,stateId:this.stateId})}))}promoteCellContents(e,t,r,n){this.scheduler.addTask(Se.ServerUpdate,U.QueuePos.Back,(()=>{if(!this.trySetStateId(Se.ServerUpdate,e))return;const a=this.docs.promoteServerAvailability(r,n);if(a.kind===z.ResultKind.Failure)return this.onUnavailableObject(a.reason);this.docs.onCellModified(!0),a.value||this.outputMessageLog.push({kind:E.OutputMessageKind.UpdateRequest,stateId:this.stateId,range:t})}))}writeCellContents(e,t,r,n,a,i,o,s,u,l){this.scheduler.addTask(Se.ServerUpdate,U.QueuePos.Back,(()=>{(l||this.trySetStateId(Se.ServerUpdate,e))&&this.handleSetCellContents(!0,t,r,n,i,a,o,s,u,void 0,l)}))}editCellContents(e,t,r,n,a,i=C.blankOper,o=(0,p.sheetGridRange)(t.sheet,me),s){this.lastViewport=o,this.scheduler.addTask(Se.ClientEdit,U.QueuePos.Back,(()=>{this.trySetStateId(Se.ClientEdit,e)&&this.handleSetCellContents(!1,t,r,n,i,a,E.SpecialFormat.Weak,E.SpecialStyle.Weak,void 0,o,s)})),this.enqueueRecalcFinished()}editCellContentsOnClone(e,t,r,n,a){this.editCellContents(this.stateId,e,t,r,n,void 0,void 0,a)}editCellFormats(e,t,r,n,a=(0,p.sheetGridRange)(t.sheet,me)){this.lastViewport=a,this.scheduler.addTask(Se.ClientEdit,U.QueuePos.Back,(()=>{if(!this.trySetStateId(Se.ClientEdit,e))return;const i="SetFormat"===r.kind?this.docs.resolveEditFormat(t.sheet.document,r.format):"RibbonFormat"===r.kind?this.docs.resolveRibbonFormat(t.sheet.document,r.ribbon,(0,m.sheetGridCell)(t.sheet,n)):"ChangeDecimals"===r.kind?this.docs.resolveChangeDecimals(t.sheet.document,r.changeDecimals,(0,m.sheetGridCell)(t.sheet,n)):(0,T.assertNever)("calc.calc.PartialWorkbook: editCellFormats",r);(0,H.isSuccess)(i)||(0,N.forEachRangeInSet)(t.set,(e=>(this.onInferFormatFailure((0,p.sheetGridRange)(t.sheet,e),i.reason),!0))),(0,H.isSuccess)(i)&&void 0===i.value||this.handleSetCellContents(!1,t,void 0,void 0,void 0,(0,y.gridCell)(0,0),(0,H.isSuccess)(i)?i.value:E.SpecialFormat.Unavailable,void 0,void 0,a)})),this.enqueueRecalcFinished()}writeArrayFormula(e,t,r,n=(0,c.gridRangeAnchor)(t.range),a=!1){this.scheduler.addTask(Se.ServerUpdate,U.QueuePos.Back,(()=>{this.trySetStateId(Se.ServerUpdate,e)&&this.handleSetRangeFormula(!0,t,r,n,void 0)}))}editArrayFormula(e,t,r,n=(0,c.gridRangeAnchor)(t.range),a=(0,p.sheetGridRange)(t.sheet,me)){this.lastViewport=a,this.scheduler.addTask(Se.ClientEdit,U.QueuePos.Back,(()=>{this.trySetStateId(Se.ClientEdit,e)&&this.handleSetRangeFormula(!1,t,r,n,a)})),this.enqueueRecalcFinished()}editPaste(e,t,r,n,a=(0,p.sheetGridRange)(r.sheet,me)){this.scheduler.addTask(Se.ClientEdit,U.QueuePos.Back,(()=>{this.trySetStateId(Se.ClientEdit,e)&&this.handleEditPaste(t,r,n,a)})),this.enqueueRecalcFinished()}assumeRecalcFinal(e,t){this.scheduler.addTask(Se.ClientEdit,U.QueuePos.Back,(()=>{this.stateId===e&&this.handleAssumeRecalcFinal(t)}))}testAdvanceState(e){this.scheduler.addTask(Se.TestAdvanceState,U.QueuePos.Back,(()=>{this.trySetStateId(Se.TestAdvanceState,e)}))}step(){if(!this.scheduler.runTask())return{queueEmpty:!0,messages:[]};const e=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:!1,messages:e}}trySetStateId(e,t){if(t<this.stateId)return!1;if(e===Se.ClientEdit&&(this.deleteComputeTasks(fe.EditReceived),this.stateEvalTime=0),t>this.stateId){if(this.stateId!==-1/0){const e=this.config.sampleWorkbookStatisticsRate;void 0!==e&&this.shouldSample(e)&&this.outputMessageLog.push({kind:E.OutputMessageKind.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics(),p:e})}const e=1;this.stateChanges===e&&this.enqueueRunExperiments(Z.ExperimentKind.OneShot),this.stateChanges>=e&&0===this.scheduler.getCount(Se.RunExperiment)&&this.enqueueRunExperiments(Z.ExperimentKind.Recurring);const r=this.config.samplePrecisionEvalRate??0,n=this.config.samplePrecisionPrintFormulaRate??0,a=this.config.samplePrecisionPrintValueRate??0;if(this.stateChanges>=e&&(r>0||n>0||a>0)&&this.numPrecisionFailures<ve.maxPrecisionFailures&&0===this.scheduler.getCount(Se.RunExperiment)){const e=this.config.experimentFactories,t=e?.stepBudget??10,i=e?.totalBudget??1e4,o=new X.PrecisionExperiment({samplePrecisionEvalRate:r,samplePrecisionPrintFormulaRate:n,samplePrecisionPrintValueRate:a}),s={stateId:this.stateId,documents:this.docs.clone(o),stepBudget:t,totalBudget:i,viewport:this.lastViewport};o.setContext(s),this.enqueueRunExperiment("PrecisionExperiment",t,i,Z.ExperimentKind.Precision,o,(()=>this.numPrecisionFailures=0),(()=>this.numPrecisionFailures+=1))}this.deleteComputeTasks(fe.StateIdAdvanced),this.lastViewport=void 0;const i=this.stateId;this.stateId=t,this.docs.advanceState(i),this.outputMessageLog.push({kind:E.OutputMessageKind.StateAdvanced,stateId:this.stateId}),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.enqueueMaybeCollectGarbage()}return!0}deleteComputeTasks(e){this.scheduler.deleteTasks(Se.BeforeCompute,void 0),this.scheduler.deleteTasks(Se.ComputeCellValue,void 0),this.scheduler.deleteTasks(Se.AfterCompute,e),e!==fe.EvalTimedOut&&this.scheduler.deleteTasks(Se.ComputeEvalFormula,void 0)}enqueueRunExperiment(e,t,r,n,a,i,o){let s=0,u=0;const l=(t,r,i,o)=>{const s=a.failedLogMessage;void 0!==s&&this.outputMessageLog.push({experimentName:e,kind:E.OutputMessageKind.ExperimentRunResult,experimentKind:n,logMessage:s,timeoutReason:{budgetType:t,budget:r,elapsedTime:i,stepsCount:o}})},c=()=>{if(a.done){const t=a.resultLogMessage;return void 0!==t&&this.outputMessageLog.push({experimentName:e,kind:E.OutputMessageKind.ExperimentRunResult,experimentKind:n,logMessage:t}),void i()}const d=(0,P.now)();let g=d;for(let e=0;e<1e3&&g===d;e+=1){a.step(),u+=1;const e=(0,P.now)(),r=e-g;if(r>=t&&!a.done)return l("stepBudget",t,r,u),void o();g=e}if(s+=g>d?g-d:1,s>=r&&!a.done)return l("totalBudget",r,s,u),void o();this.scheduler.addTask(Se.RunExperiment,U.QueuePos.Front,c)};this.scheduler.addTask(Se.RunExperiment,U.QueuePos.Back,c)}enqueueRunExperiments(e){if(!this.config.experimentFactories)return;const{stepBudget:t,totalBudget:r,factories:n}=this.config.experimentFactories,a=n.filter((t=>t.kind===e&&(t.numFailures??0)<(t.maxFailures??3)));if(0===a.length)return;const i={stateId:this.stateId,documents:this.docs.clone(w.voidCallback,e===Z.ExperimentKind.OneShot?I.CloningTarget.Server:I.CloningTarget.Client),stepBudget:t,totalBudget:r,viewport:this.lastViewport};for(const n of a){const a=n.create();a&&(a.setContext(i),this.enqueueRunExperiment(n.experimentName,n.stepBudget??t,r,e,a,(()=>n.numFailures=0),(()=>n.numFailures=(n.numFailures??0)+1)))}}setSheetNames(e,t,r){this.scheduler.addTask(Se.ServerUpdate,U.QueuePos.Back,(()=>{if(!this.trySetStateId(Se.ServerUpdate,r))return;const n=this.docs.setSheetNames(e,t);n.kind===z.ResultKind.Failure&&this.onUnavailableObject(n.reason),this.deleteComputeTasks(fe.SetSheetNames)}))}setLangConfig(e,t){this.scheduler.addTask(Se.ServerUpdate,U.QueuePos.Back,(()=>{if(!this.trySetStateId(Se.ServerUpdate,e))return;const r=this.docs.config.localeInfo!==t.localeInfo,n=this.docs.config.refStyle!==t.refStyle;this.docs.setConfig(t),r&&this.docs.clearCompiledNumberFormats(),(r||n)&&(this.docs.clearCompiledFormulas(),this.deleteComputeTasks(fe.SetLangConfig))}))}setNumberFormats(e,t,r,n){this.scheduler.addTask(Se.ServerUpdate,U.QueuePos.Back,(()=>{if(!this.trySetStateId(Se.ServerUpdate,n))return;const a=this.docs.setNumberFormats(e,t,r);return a.kind===z.ResultKind.Failure?this.onUnavailable(a.reason):void 0}))}writeNamedObject(e,t,r,n){this.scheduler.addTask(Se.ServerUpdate,U.QueuePos.Back,(()=>{if(!this.trySetStateId(Se.ServerUpdate,e))return;const a=this.docs.setNamedObject(!0,(0,F.nameLoc)(t,r),n);return a.kind===z.ResultKind.Failure?this.onUnavailable(a.reason):void 0}))}writeUndefinedNames(e,t){this.scheduler.addTask(Se.ServerUpdate,U.QueuePos.Back,(()=>{if(!this.trySetStateId(Se.ServerUpdate,e))return;const r=this.docs.setUndefinedNames(t);return r.kind===z.ResultKind.Failure?this.onUnavailable(r.reason):void 0}))}promoteNamedObjects(e,t,r){this.scheduler.addTask(Se.ServerUpdate,U.QueuePos.Back,(()=>{if(!this.trySetStateId(Se.ServerUpdate,e))return;const n=this.docs.promoteNamedObjects(t,r);if(n.kind===z.ResultKind.Failure)return this.onUnavailable(n.reason);n.value||this.outputMessageLog.push({kind:E.OutputMessageKind.UpdateNamesRequest,stateId:this.stateId,scope:t})}))}extendUnusedRange(e,t){this.scheduler.addTask(Se.ServerUpdate,U.QueuePos.Back,(()=>{if(!this.trySetStateId(Se.ServerUpdate,t))return;const r=this.docs.extendServerUnused(e.sheet,e.range);if(r.kind===z.ResultKind.Failure)return this.onUnavailableObject(r.reason);this.docs.onCellModified(!0)}))}writeHiddenRows(e,t){this.scheduler.addTask(Se.ServerUpdate,U.QueuePos.Back,(()=>{if(!this.trySetStateId(Se.ServerUpdate,e))return;const r=this.docs.writeHiddenRows(t.sheet,t.range,t.hidden);return r.kind===z.ResultKind.Failure?this.onUnavailableObject(r.reason):void 0}))}writeHiddenCols(e,t){this.scheduler.addTask(Se.ServerUpdate,U.QueuePos.Back,(()=>{if(!this.trySetStateId(Se.ServerUpdate,e))return;const r=this.docs.writeHiddenCols(t.sheet,t.range,t.hidden);return r.kind===z.ResultKind.Failure?this.onUnavailableObject(r.reason):void 0}))}writeInFilterMode(e,t){this.scheduler.addTask(Se.ServerUpdate,U.QueuePos.Back,(()=>{if(!this.trySetStateId(Se.ServerUpdate,e))return;const r=this.docs.writeInFilterMode(t.sheet,t.inFilterMode);return r.kind===z.ResultKind.Failure?this.onUnavailableObject(r.reason):void 0}))}getStatistics(){return{queueSize:this.scheduler.getCount(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}}enqueueMaybeCollectGarbage(){this.scheduler.deleteTasks(Se.MaybeCollectGarbage,void 0),this.scheduler.addTask(Se.MaybeCollectGarbage,U.QueuePos.Back,(()=>{if(this.stateChangesSinceLastGC<t.MaxStateIdDifferenceForGC)return;const e=this.stateId-t.MaxStateIdDifferenceForGC;this.docs.collectGarbage(e),this.outputMessageLog.push({kind:E.OutputMessageKind.GarbageCollected,minStateIdKept:e}),this.stateChangesSinceLastGC=0}))}shouldSample(e){return void 0!==e&&this.rng.next()<=e}translateEnglishFormula(e,t){const r=this.englishParser.parseFormula((0,ue.parseLocals)(b.LexicalKind.Cell,t.range),e);if(!(0,H.isSuccess)(r))return r;const n=this.englishAnalyzer.checkFormula((0,ce.analyzeLocalsGrid)(b.LexicalKind.Cell,(0,m.sheetGridCell)(t.sheet,t.range)),r.value);if(!(0,H.isSuccess)(n))return n;if(!(0,u.isWellFormed)(n.value))return(0,Q.failure)((0,a.illFormedFormula)("ill-formed formula"));const i=this.docs.printFormulaBarText((0,f.lexicalSourceGrid)(b.LexicalKind.Cell,t),t.range,n.value);return(0,H.isSuccess)(i)?(0,q.success)(i.value):i}restrictToViewport(e,t,r,n){if(void 0!==t){const{sheet:a,range:i}=t,o=(0,N.createCellSetFromRange)(i);for(const t of e)(0,d.isSheetIndexEqual)(a,t.sheet)&&n((0,E.sheetCellSet)(a,(0,_.intersectProduct)(t.set,o)),r)}else for(const t of e)n(t,r)}getVolatileMode(){return this.config.volatileMode??te.VolatileMode.Estimation}constructor(e,t={}){this.scheduler=new U.PriorityScheduler,this.englishParser=(0,oe.createParser)((0,se.createParseGlobals)(re.initialRecalcServiceConfig)),this.englishAnalyzer=(0,le.createAnalyzer)((0,de.createAnalyzeGlobals)(re.initialRecalcServiceConfig)),this.outputMessageLog=[],this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.latestSnapshotID=-1,this.numPrecisionFailures=0,this.printFormulaProperties=e=>{const t=(0,g.sheetGridRangeAnchor)(e),r=this.getAvailableFormula(t);if(!(0,H.isSuccess)(r))return void this.onUnavailableObject(r.reason);const[n,a]=r.value,i=a.compiledFmla.getValue(),o=(0,H.isSuccess)(i)?this.docs.printFormulaBarText(n,t.range,i.value):i;return{formulaBarText:o.kind===z.ResultKind.Success?o.value:void this.outputMessageLog.push({kind:E.OutputMessageKind.PrintFormulaFailure,stateId:this.stateId,range:e,reason:o.reason}),hasHyperlink:this.formulaHasHyperlink(a),isFormula:!0}},this.printValueProperties=(e,t)=>{const r=this.docs.getEditedFormula(e);if(!(0,H.isSuccess)(r))return void this.onUnavailableObject(r.reason);const n=r.value?.[1].fmla??"",a=this.docs.renderValueBarText(e,t,n);return{formulaBarText:(0,H.isSuccess)(a)?a.value:void this.outputMessageLog.push({kind:E.OutputMessageKind.PrintFormulaFailure,stateId:this.stateId,range:e,reason:a.reason}),hasHyperlink:!1,isFormula:!1}},this.scheduleAvailableFormulas=(e,t)=>{const r=this.docs.forEachEditedNonBlankCellInSet(e.sheet,e.set,(r=>{const n=(0,m.sheetGridCell)(e.sheet,r),a=this.docs.getEditedFormula(n);return a.kind===z.ResultKind.Failure?(this.onUnavailableObject(a.reason),!0):(void 0!==a.value&&void 0!==a.value[1].compiledFmla&&this.enqueueComputeCellValue(n,t),!0)}));(0,H.isSuccess)(r)||this.onUnavailableObject(r.reason)},this.scheduleAvailableValues=(e,t)=>{const r=this.docs.forEachEditedCellInSet(e.sheet,e.set,(r=>{const n=(0,m.sheetGridCell)(e.sheet,r),a=this.docs.getEditedFormula(n);return a.kind===z.ResultKind.Failure?(this.onUnavailableObject(a.reason),!0):(void 0!==a.value&&void 0!==a.value[1].compiledFmla||this.enqueueReturnCellValue(n,t),!0)}));(0,H.isSuccess)(r)||this.onUnavailableObject(r.reason)},this.docs=new w.PartialWorkbookDocumentCollection(e,this,t,t,t.maxDereferenceCells??ge,t.isServerWorkbookLoad??!1),this.reconfigure(t)}}t.PartialWorkbook=ve,ve.maxPrecisionFailures=3},1674:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPartialWorkbook=t.blankStyle=t.genFmt=t.knownFormatData=t.kfToIformat=t.englishLocaleData=t.defaultConfig=t.mathpack=t.locale=t.createRange=t.assertMessageOrder=void 0;const n=r(6869),a=r(6366),i=r(8073),o=r(6067),s=r(6468),u=r(6067),l=r(1585),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6366),S=r(3228),v=r(3228),F=r(429),y=r(3319),b=r(6366);var C;!function(e){e.EditedPhase="EditedPhase",e.DependentPhase="DependentPhase",e.StatisticsPhase="StatisticsPhase",e.Finished="Finished"}(C||(C={}));const A={kind:C.EditedPhase,stateId:-1/0},E=Object.getOwnPropertyNames(n.OutputMessageKind);function T(e,t){const r={};return e.forEach((e=>r[e]=t)),r}const R={[C.EditedPhase]:{[n.OutputMessageKind.StateAdvanced]:()=>C.EditedPhase,[n.OutputMessageKind.RecalcStatistics]:(e,t)=>{if(t.message===n.RecalcStatisticsMessage.ChangedCell){if(t.cellKind===n.ComputedCellKind.EditedCell)return C.EditedPhase;if(t.cellKind===n.ComputedCellKind.DependentCell)return C.DependentPhase;if(t.cellKind===n.ComputedCellKind.IndependentCell)return C.EditedPhase;if(t.cellKind===n.ComputedCellKind.UnknownNonEditedCell)return e(`a different message.cellKind than ${t.cellKind}`);(0,a.assertNever)("calc.calc.partialWorkbook.testutilsutils.transitions",t.cellKind)}if(t.message===n.RecalcStatisticsMessage.UnchangedCell){if(t.cellKind===n.ComputedCellKind.EditedCell)return C.EditedPhase;if(t.cellKind===n.ComputedCellKind.DependentCell)return C.DependentPhase;if(t.cellKind===n.ComputedCellKind.IndependentCell)return C.EditedPhase;if(t.cellKind===n.ComputedCellKind.UnknownNonEditedCell)return e(`a different message.cellKind than ${t.cellKind}`);(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}return t.message===n.RecalcStatisticsMessage.ContinueComputation?C.EditedPhase:t.message===n.RecalcStatisticsMessage.EditFinished||t.message===n.RecalcStatisticsMessage.StateTimedOut?C.StatisticsPhase:t.message===n.RecalcStatisticsMessage.RecalcFinished?C.Finished:void(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.message)},...T([n.OutputMessageKind.CellWrite,n.OutputMessageKind.RangeWrite],((e,t)=>t.cellKind===n.ComputedCellKind.EditedCell?C.EditedPhase:t.cellKind===n.ComputedCellKind.DependentCell?C.DependentPhase:void(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind))),[n.OutputMessageKind.RangeFailure]:(e,t)=>t.cellKind===n.ComputedCellKind.EditedCell?C.EditedPhase:t.cellKind===n.ComputedCellKind.DependentCell?C.DependentPhase:t.cellKind===n.ComputedCellKind.IndependentCell?C.EditedPhase:t.cellKind===n.ComputedCellKind.UnknownNonEditedCell?C.DependentPhase:void(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind),[n.OutputMessageKind.PrintFormulaFailure]:()=>C.EditedPhase,[n.OutputMessageKind.InferFormatFailure]:()=>C.EditedPhase,[n.OutputMessageKind.FormatValueFailure]:()=>C.EditedPhase,...T([n.OutputMessageKind.GarbageCollected,n.OutputMessageKind.Alert,n.OutputMessageKind.ExperimentRunResult,n.OutputMessageKind.UpdateRequest,n.OutputMessageKind.WorkbookStatistics,n.OutputMessageKind.UnhandledFailure,n.OutputMessageKind.NumberFormatFailure,n.OutputMessageKind.NameFailure,n.OutputMessageKind.UpdateNamesRequest],(()=>C.EditedPhase))},[C.DependentPhase]:{[n.OutputMessageKind.RecalcStatistics]:(e,t)=>{if(t.message===n.RecalcStatisticsMessage.ChangedCell){if(t.cellKind===n.ComputedCellKind.EditedCell)return e(`a different cellKind than ${t.cellKind}`);if(t.cellKind===n.ComputedCellKind.DependentCell)return C.DependentPhase;if(t.cellKind===n.ComputedCellKind.IndependentCell)return C.DependentPhase;if(t.cellKind===n.ComputedCellKind.UnknownNonEditedCell)return e(`a different cellKind than ${t.cellKind}`);(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}if(t.message===n.RecalcStatisticsMessage.UnchangedCell){if(t.cellKind===n.ComputedCellKind.EditedCell)return e(`a different cellKind than ${t.cellKind}`);if(t.cellKind===n.ComputedCellKind.DependentCell)return C.DependentPhase;if(t.cellKind===n.ComputedCellKind.IndependentCell)return C.DependentPhase;if(t.cellKind===n.ComputedCellKind.UnknownNonEditedCell)return e(`a different cellKind than ${t.cellKind}`);(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}return t.message===n.RecalcStatisticsMessage.ContinueComputation?e(`a different message.message than ${t.message}`):t.message===n.RecalcStatisticsMessage.EditFinished?C.StatisticsPhase:t.message===n.RecalcStatisticsMessage.StateTimedOut||t.message===n.RecalcStatisticsMessage.RecalcFinished?e(`a different message.message than ${t.message}`):void(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.message)},...T([n.OutputMessageKind.CellWrite,n.OutputMessageKind.RangeWrite],((e,t)=>t.cellKind===n.ComputedCellKind.EditedCell?e(`a different message.cellKind than ${t.cellKind}`):t.cellKind===n.ComputedCellKind.DependentCell?C.DependentPhase:void(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind))),[n.OutputMessageKind.RangeFailure]:(e,t)=>t.cellKind===n.ComputedCellKind.EditedCell?t.reason.kind===i.ReasonKind.CellCycle?C.DependentPhase:e(`the current state to be ${C.EditedPhase}, or ${C.DependentPhase} and failure ${i.ReasonKind.CellCycle}`):t.cellKind===n.ComputedCellKind.IndependentCell||t.cellKind===n.ComputedCellKind.DependentCell||t.cellKind===n.ComputedCellKind.UnknownNonEditedCell?C.DependentPhase:void(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind),[n.OutputMessageKind.FormatValueFailure]:()=>C.DependentPhase,...T([n.OutputMessageKind.GarbageCollected,n.OutputMessageKind.Alert,n.OutputMessageKind.ExperimentRunResult],((e,t)=>e(`a different message.kind than ${t.kind}`))),...T([n.OutputMessageKind.StateAdvanced,n.OutputMessageKind.UpdateRequest,n.OutputMessageKind.WorkbookStatistics,n.OutputMessageKind.UnhandledFailure,n.OutputMessageKind.NumberFormatFailure,n.OutputMessageKind.NameFailure,n.OutputMessageKind.PrintFormulaFailure,n.OutputMessageKind.InferFormatFailure,n.OutputMessageKind.UpdateNamesRequest],((e,t)=>e(`a different message.kind than ${t.kind}`)))},[C.StatisticsPhase]:{[n.OutputMessageKind.RecalcStatistics]:(e,t)=>t.message===n.RecalcStatisticsMessage.ChangedCell||t.message===n.RecalcStatisticsMessage.UnchangedCell||t.message===n.RecalcStatisticsMessage.ContinueComputation||t.message===n.RecalcStatisticsMessage.EditFinished||t.message===n.RecalcStatisticsMessage.StateTimedOut?e(`a different message.message than ${t.message}`):t.message===n.RecalcStatisticsMessage.RecalcFinished?C.Finished:void(0,a.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.message),...T([n.OutputMessageKind.GarbageCollected,n.OutputMessageKind.Alert,n.OutputMessageKind.ExperimentRunResult],((e,t)=>e(`a different message.kind than ${t.kind}`))),...T([n.OutputMessageKind.CellWrite,n.OutputMessageKind.RangeWrite,n.OutputMessageKind.RangeFailure,n.OutputMessageKind.PrintFormulaFailure,n.OutputMessageKind.InferFormatFailure,n.OutputMessageKind.FormatValueFailure,n.OutputMessageKind.StateAdvanced,n.OutputMessageKind.UpdateRequest,n.OutputMessageKind.WorkbookStatistics,n.OutputMessageKind.NumberFormatFailure,n.OutputMessageKind.UnhandledFailure,n.OutputMessageKind.NameFailure,n.OutputMessageKind.UpdateNamesRequest],((e,t)=>e(`a different message.kind than ${t.kind}`)))},[C.Finished]:T(E,(e=>e("no message once recalc finished")))};function k(e,t,r){const{stateId:a,kind:i}=e,o=function(e,t){switch(t.kind){case n.OutputMessageKind.GarbageCollected:return expect(t.minStateIdKept).toBeLessThanOrEqual(e),e;case n.OutputMessageKind.Alert:return e;case n.OutputMessageKind.ExperimentRunResult:return t.experimentKind===y.ExperimentKind.OneShot&&expect(e).toEqual(1),e;default:return expect(e).toBeLessThanOrEqual(t.stateId),t.stateId}}(a,t);return{kind:(0,R[i][t.kind])((function(n){return expect({state:e,message:t,index:r}).toEqual(n)}),t,i),stateId:o}}t.assertMessageOrder=function(e){e.reduce(k,A)},t.createRange=function(e,t){return[(0,o.sheetGridRange)(e,t),(0,n.sheetCellSet)(e,(0,s.createCellSetFromRange)(t))]},t.locale=(0,c.getEnglishLocaleInfo)(),t.mathpack=u.xlMathpack,t.defaultConfig={localeInfo:t.locale,mathpack:t.mathpack,refStyle:d.RefStyle.A1,date1904:!1,dateCompatibility:!0,timezone:m.tzUTC,datepack:h.xlDatepack},t.englishLocaleData=(0,F.localeData)([{functionId:0,functionName:"COUNT"}],[{errorType:1,errorName:"#NULL!"}],"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";",[3,0],",",1033,1,2,!1," ",!1,"Paren",!0,!1,"$",2,"MDY","/","-",!0,!1,!1,!0,":",null,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["AM/PM","A/P","上午/下午",null,"General","$"],[null,";","#","0",".","%",",",":","/","/"," ","-","+","(",")",null,"\\","*","y","m","d","h","m","s","E","/",'"',"[","]","@","?","_","r","a","g","e",null,null,null,null,null,null,"B","N","ว","ด","ป","b","ค","ช","น","ท","๐",null],["Black","White","Red","Green","Blue","Yellow","Magenta","Cyan","Color"],["DBNum1","DBNum2","DBNum3","DBNum4"],(0,b.partialArray)({[g.SpecialRefId.All]:"#All",[g.SpecialRefId.Data]:"#Data",[g.SpecialRefId.Headers]:"#Headers",[g.SpecialRefId.Totals]:"#Totals",[g.SpecialRefId.ThisRow]:"#This Row"}),"dddd, mmmm dd, yyyy","h:mm:ss AM/PM","en-US","en-US","en-US","en-US"),t.kfToIformat=e=>Math.abs(e),t.knownFormatData=(0,f.numEnumArray)(p.KnownFormat).filter((e=>(0,S.isKnownFormatDefined)(e,(0,c.getEnglishLocaleInfo)()))).map((e=>(0,F.numberFormat)((0,t.kfToIformat)(e),(0,v.getKnownFormat)(t.locale,e),!0))),t.genFmt=(0,t.kfToIformat)(p.KnownFormat.General),t.blankStyle=n.SpecialStyle.Blank,t.createPartialWorkbook=function(e,r,n){const a=new l.PartialWorkbook({...t.defaultConfig,localeInfo:n?.localeOverride??t.locale},r);return a.setWorksheetFuncOverrides(n?.worksheetFuncOverrides??{}),(n?.setNumberFormats??1)&&a.setNumberFormats(e,t.knownFormatData,!1,-1/0),a}},7432:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookDocument=void 0;const n=r(6067),a=r(6067),i=r(6366),o=r(2393),s=r(6468),u=r(6869),l=r(6366),c=r(6366),d=r(6366),g=r(6366),m=r(5013),h=r(5013),p=r(6448),f=r(8713);class S{clone(e=o.CloningTarget.Server){let t;if(this.grids){t=(0,i.makeStringMap)();for(const r in this.grids){const n=this.grids[r];t[r]=n.clone(e)}}return new S(this.document,this.stringCompareCI,this.formats.clone(),this.styles.clone(),this.sheets.clone(),t,void 0,this.nameManager.clone())}getReadonlyNameManager(){return this.nameManager}getReadonlySheets(){return this.sheets}setClientValue(e,t,r){const n=this.getGridById(e.sheet.index);return n.kind===l.ResultKind.Failure?n:(0,c.success)(n.value.setClientValue(e.range,t,r))}setClientFormula(e,t,r){const n=this.getGridById(e.sheet.index);return n.kind===l.ResultKind.Failure?n:(0,c.success)(n.value.setClientFormula(e.range,e.range,t,r))}setRecalcFailure(e,t){const r=this.getGridById(e);return r.kind===l.ResultKind.Failure?r:(0,c.success)(r.value.setRecalcFailure(t))}setRecalcEditTaint(e,t){const r=this.getGridById(e);return r.kind===l.ResultKind.Failure?r:(0,c.success)(r.value.setRecalcEditTaint(t))}setRecalcValue(e,t){const r=this.getGridById(e.sheet.index);return r.kind===l.ResultKind.Failure?r:(0,c.success)(r.value.setRecalcValue(e.range,t))}setEditedFormat(e,t){const r=this.getGridById(e.sheet.index);return r.kind===l.ResultKind.Failure?r:(0,c.success)(r.value.setEditedFormat(e.range,t))}setClientFormat(e,t,r){const n=this.getGridById(e.sheet.index);return n.kind===l.ResultKind.Failure?n:(0,c.success)(n.value.setClientFormat(e.range,t,r))}setHiddenRows(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:(0,c.success)(n.value.setHiddenRows(t,r))}setHiddenCols(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:(0,c.success)(n.value.setHiddenCols(t,r))}setMergeCell(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.setMergeCell(e.range))}setInFilterMode(e,t){const r=this.getGridById(e);return r.kind===l.ResultKind.Failure?r:(0,c.success)(r.value.setInFilterMode(t))}setCellContents(e,t,r,a,i,o,s,u,d){const g=this.getGridById(t.sheet.index);if(g.kind===l.ResultKind.Failure)return g;const m=void 0!==u&&(0,n.isSheetIndexEqual)(t.sheet,u.sheet)?u.range:void 0;return(0,c.success)(g.value.setCellContents(e,t.set,r,a,i,o,s,m,d))}setRangeFormula(e,t,r,a,i,o,s,u){const d=this.getGridById(t.sheet.index);if(d.kind===l.ResultKind.Failure)return d;const g=void 0!==s&&(0,n.isSheetIndexEqual)(t.sheet,s.sheet)?s.range:void 0;return(0,c.success)(d.value.setRangeFormula(e,t.range,r,a,i,o,g,u))}copyRange(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.copyRange(e.range))}pasteRange(e,t,r){const n=this.getGridById(e.sheet.index);return n.kind===l.ResultKind.Failure?n:(0,c.success)(n.value.pasteRange(e.range,t,r))}assumeRecalcFinal(e,t){const r=this.getGridById(e.sheet.index);return r.kind===l.ResultKind.Failure?r:(0,c.success)(r.value.assumeRecalcFinal(e.set,t))}getDirtyEditedCells(){const e=[];return this.forEachSheet(((t,r)=>{e.push((0,u.sheetCellSet)(t.sheetIndex,r.getDirtyEditedCells()))})),e}getNonDirtyEditedCells(){const e=[];return this.forEachSheet(((t,r)=>{e.push((0,u.sheetCellSet)(t.sheetIndex,r.getNonDirtyEditedCells()))})),e}getDirtyDependentCells(){const e=[];return this.forEachSheet(((t,r)=>{e.push((0,u.sheetCellSet)(t.sheetIndex,r.getDirtyDependentCells()))})),e}setNamedObject(e,t,r,n){return this.nameManager.setNamedObject(e,t,r,n)}setUndefinedNames(e){return this.nameManager.setUndefinedNames(e)}promoteNamedObjects(e,t){return this.nameManager.promoteNamedObjects(e,t)}setSheetNames(e){const t=this.grids??this.oldGrids,r=(0,i.makeStringMap)();for(const{sheetId:n}of e)r[n]=t?.[n]??o.PartialWorkbookGrid.create();return new S(this.document,this.stringCompareCI,this.formats,this.styles,this.sheets.setSheetNames(e),r,void 0,this.nameManager.setSheetNames(e))}extendServerUnused(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:(0,c.success)(n.value.extendServerUnused(t,r))}promoteServerAvailability(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:(0,c.success)(n.value.promoteServerAvailability(t,r))}getNameLoc(e,t,r){return this.nameManager.getNameLoc(e,t,r)}getNameFormula(e,t){return this.nameManager.getNameFormula(e,t)}hasRecalcNameFailure(e){return this.nameManager.hasRecalcNameFailure(e)}setRecalcNameFailure(e){return this.nameManager.setRecalcNameFailure(e)}getContainingTable(e){const t=this.nameManager.getContainingTable(e);if(t.kind===l.ResultKind.Failure||void 0!==t.value)return t;const r=this.getGridById(e.sheet.index);if(r.kind===l.ResultKind.Failure)return(0,d.failure)((0,a.unavailable)([r.reason]));const n=(0,m.intersectProduct)((0,s.createCellSetFromRange)(e.range),s.availableSetProduct);return(0,h.meetsProduct)(n,r.value.getServerAvailability())?g.successUndefined:(0,d.failure)((0,a.unavailable)([{kind:u.UnavailableKind.ContainingTable,range:e}]))}getNamedRanges(e){const t=this.nameManager.getNamedRanges(e);if(t.kind===l.ResultKind.Failure||void 0!==t.value)return t;const r=this.getGridById(e.sheet.index);if(r.kind===l.ResultKind.Failure)return(0,d.failure)((0,a.unavailable)([r.reason]));const n=(0,m.intersectProduct)((0,s.createCellSetFromRange)(e.range),s.availableSetProduct);return(0,h.meetsProduct)(n,r.value.getServerAvailability())?(0,c.success)([]):(0,d.failure)((0,a.unavailable)([{kind:u.UnavailableKind.NamedRanges,range:e}]))}getIntersectingTables(e){return this.nameManager.getIntersectingTables(e)}getStructRefColumn(e,t){return this.nameManager.getStructRefColumn(e,t)}getStructRefSpecialRef(e,t){return this.nameManager.getStructRefSpecialRef(e,t)}getEditedFormula(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.getEditedFormula(e.range))}forEachEditedFormula(e,t){const r=this.getGridById(e.sheet.index);return r.kind===l.ResultKind.Failure?r:(0,c.success)(r.value.forEachEditedFormula(e.range,t))}getEditedValue(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.getEditedValue(e.range))}forEachEditedValue(e,t){const r=this.getGridById(e.sheet.index);return r.kind===l.ResultKind.Failure?r:(0,c.success)(r.value.forEachEditedValue(e.range,t))}getEditedFormat(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.getEditedFormat(e.range))}forEachEditedFormat(e,t){const r=this.getGridById(e.sheet.index);return r.kind===l.ResultKind.Failure?r:(0,c.success)(r.value.forEachEditedFormat(e.range,t))}getEditedStyle(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.getEditedStyle(e.range))}isInFilterMode(e){const t=this.getGridById(e);return t.kind===l.ResultKind.Failure?t:t.value.isInFilterMode()}getHiddenRows(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?o.hiddennessFullyUnavailable:n.value.getHiddenRows(t,r)}tryGetHiddenRows(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:n.value.tryGetHiddenRows(t,r)}getHiddenCols(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?o.hiddennessFullyUnavailable:n.value.getHiddenCols(t,r)}tryGetHiddenCols(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:n.value.tryGetHiddenCols(t,r)}getMergeCell(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.getMergeCell(e.range))}getServerFormat(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.getServerFormat(e.range))}getServerStyle(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.getServerStyle(e.range))}getClientFormat(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.getClientFormat(e.range))}getClientValue(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.getClientValue(e.range))}getRecalcValues(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.getRecalcValues(e.range))}forEachRecalcValue(e,t){const r=this.getGridById(e.sheet.index);return r.kind===l.ResultKind.Failure?r:(0,c.success)(r.value.forEachRecalcValue(e.range,t))}getServerValue(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.getServerValue(e.range))}getServerFormula(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.getServerFormula(e.range))}getClientFormula(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.getClientFormula(e.range))}getServerUsedRange(e){const t=this.getGridById(e);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.getServerUsedRange())}allServerAvailable(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.allServerAvailable(e.range))}allEditedAvailable(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.allEditedAvailable(e.range))}forEachRecalcDirty(e,t){const r=this.getGridById(e.sheet.index);return r.kind===l.ResultKind.Failure?r:(0,c.success)(r.value.forEachRecalcDirty(e.range,t))}hasRecalcDirty(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.hasRecalcDirty(e.range))}hasRecalcFailure(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.hasRecalcFailure(e.range))}hasEditedEditTaint(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.hasEditedEditTaint(e.range))}hasRecalcEditTaint(e){const t=this.getGridById(e.sheet.index);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.hasRecalcEditTaint(e.range))}forEachEditedNonBlankCellInSet(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:(0,c.success)(n.value.forEachEditedNonBlankCellInSet(t,r))}forEachServerNonBlankCellInSet(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:(0,c.success)(n.value.forEachServerNonBlankCellInSet(t,r))}forEachEditedCellInSet(e,t,r){const n=this.getGridById(e);return n.kind===l.ResultKind.Failure?n:(0,c.success)(n.value.forEachEditedCellInSet(t,r))}getSheetIndex(e){const t=this.sheets.getSheetByName(e);return t.kind===l.ResultKind.Failure||void 0===t.value?t:(0,c.success)(t.value.sheetIndex)}getSheetName(e){const t=this.sheets.getSheetById(e);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.name)}getEditedUsedRange(e){const t=this.getGridById(e);return t.kind===l.ResultKind.Failure?t:(0,c.success)(t.value.getEditedUsedRange())}getSheetRangeIds(e){return this.sheets.getSheetRangeIds(e)}getIformat(e){return this.formats.getIformat(e)}getIformats(){return this.formats.getIformats()}getKnownFormat(e){return this.formats.getKnownFormat(e)}getFormatString(e){return this.formats.getFormatString(e)}resolveCellStyle(e){return this.styles.resolveCellStyle(e)}setNumberFormats(e,t){this.formats.setNumberFormats(e,t)}setStyles(e,t){this.styles.setStyles(e,t)}setFonts(e,t){this.styles.setFonts(e,t)}setFills(e,t){this.styles.setFills(e,t)}setBorders(e,t){this.styles.setBorders(e,t)}onCellModified(e,t){this.forEachSheet(((r,n)=>{n.onCellModified(e,t)})),this.nameManager.onCellModified(e)}collectGarbage(e,t){this.forEachSheet(((r,n)=>{n.collectGarbage(e,t)})),this.nameManager.collectGarbage(e)}advanceState(e,t){this.forEachSheet(((r,n)=>{n.advanceState(e,t)})),this.nameManager.advanceState(e),this.sheets.advanceState(e),this.oldGrids=this.grids,this.grids=void 0}clearCompiledFormulas(){this.forEachSheet(((e,t)=>{t.clearCompiledFormulas()})),this.nameManager.resetLazyData()}clearCompiledNumberFormats(){this.formats.clearCompiledNumberFormats()}getGridStatistics(){let e=o.emptyGridStatistics;return this.forEachSheet(((t,r)=>e=(0,o.mergeGridStatistics)(e,r.getStatistics()))),e}getNameStatistics(){return this.nameManager.getNameStatistics()}getServerAvailableCells(){const e=[];return this.forEachSheet(((t,r)=>{e.push({sheetIdx:t.sheetIndex,availableCells:r.getServerAvailability()})})),e}forEachSheet(e){const t=this.grids;t&&this.sheets.forEachSheet(((r,n)=>{const a=t[n];a&&e(r,a)}))}getGridById(e){const t=this.grids;if(!t)return(0,d.failure)({kind:u.UnavailableKind.SheetNames});const r=t[e];return void 0===r?(0,d.failure)({kind:u.UnavailableKind.SheetId,document:this.document,sheetId:e}):(0,c.success)(r)}constructor(e,t,r,n,a=new f.PartialWorkbookSheets(e,t),i,o,s=new p.PartialWorkbookNameManager(e,t)){this.document=e,this.stringCompareCI=t,this.formats=r,this.styles=n,this.sheets=a,this.grids=i,this.oldGrids=o,this.nameManager=s}}t.PartialWorkbookDocument=S},8760:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookDocumentCollection=t.voidCallback=void 0;const n=r(7432),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6067),b=r(6067),C=r(6067),A=r(6067),E=r(6067),T=r(6067),R=r(6067),k=r(2393),N=r(6067),I=r(6067),O=r(6067),P=r(6468),M=r(6869),D=r(6869),w=r(472),L=r(472),_=r(472),x=r(472),K=r(8073),W=r(8073),U=r(8073),G=r(8073),B=r(8073),V=r(8073),j=r(8073),H=r(8073),q=r(8073),z=r(8073),Q=r(8073),$=r(8073),Y=r(8073),J=r(472),X=r(472),Z=r(8073),ee=r(6067),te=r(6067),re=r(6067),ne=r(6067),ae=r(6067),ie=r(6067),oe=r(6067),se=r(6067),ue=r(6067),le=r(6067),ce=r(6067),de=r(6067),ge=r(6067),me=r(637),he=r(6067),pe=r(6067),fe=r(8073),Se=r(6366),ve=r(6366),Fe=r(6366),ye=r(6366),be=r(6366),Ce=r(6366),Ae=r(6366),Ee=r(6366),Te=r(8073),Re=r(6067),ke=r(6067),Ne=r(6067),Ie=r(6366),Oe=r(6067),Pe=r(3228),Me=r(3228),De=r(3228),we=r(3228),Le=r(3228),_e=r(3228),xe=r(3228),Ke=r(3228),We=r(3228),Ue=r(3228),Ge=r(3228),Be=r(3228),Ve=r(6067),je=r(6366),He=r(6366),qe=r(6366),ze=r(6366),Qe=r(6366),$e=r(6067),Ye=r(6366),Je=r(6067),Xe=r(6933),Ze=r(8813),et=r(3228),tt=r(6366),rt=r(6067),nt=r(6067),at=r(5775),it=r(3228),ot=r(3228),st=r(3219),ut=(0,i.gridCell)(0,0);class lt extends rt.ConstVisitor{wsfNode(e){this.fns.push((0,T.englishWorksheetFuncIdToName)(e))}operatorNode(e){this.fns.push((0,R.englishOperatorIdToName)(e))}constructor(){super(void 0),this.fns=[]}}function ct(e){const t=new lt;return(0,nt.reduceBottomUp)(t,e),t.fns}const dt=(0,O.precedents)([],[],[],Ve.SpecialPrecs.None,I.PrecsBound.Exact);t.voidCallback={onNameFailure:()=>{},onRangeFailure:()=>{},onNumberFormatFailure:()=>{},onInferFormatFailure:()=>{},onUnavailableObject:()=>{},onUnavailable:()=>{},onSetCellValue:()=>{},onSetCellValues:()=>{},onReturnCellValue:()=>{}};class gt{clone(e=t.voidCallback,r=k.CloningTarget.Server){const n=new gt(this.config,e,this.schedulerConfig,this.limits,this.maxDereferenceCells,this.isServerWorkbookLoad);return n.documentLoc=this.documentLoc,n.document=this.document?.clone(r),n.worksheetFuncOverrides=this.worksheetFuncOverrides,n.userDefinedFuncOverrides=this.userDefinedFuncOverrides,n.version=this.version,n}compareVersion(e){return this.version===e.version}getSingleReadonlyDocument(){return this.document}reconfigure(e,t,r,n){this.schedulerConfig=e,this.limits=t,this.maxDereferenceCells=r,this.isServerWorkbookLoad=n,this.advanceVersion()}setConfig(e){this.config=e}forEachDocument(e){void 0!==this.document&&e(this.document)}getDocumentLoc(e,t){const r=this.documentLoc;return void 0===r||void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?(0,ze.failure)((0,E.unavailable)([{kind:M.UnavailableKind.DocumentLoc,document:(0,u.documentLoc)(e,t)}])):(0,qe.success)(r)}getNameLoc(e,t,r){const n=this.getDocument(e.document);return n.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([n.reason])):n.value.getNameLoc(e.index,t,r)}getUserDefinedFuncLoc(e,t){if(void 0!==this.userDefinedFuncOverrides[t]){const r=(0,m.userDefinedFuncLoc)(e,t);return(0,qe.success)([r])}return(0,ze.failure)((0,S.notImplemented)(["call UDF"]))}getCellFormat(e){const t=this.allEditedAvailable(e);if(t.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([t.reason]));if(!0!==t.value)return(0,ze.failure)((0,E.unavailable)([{kind:M.UnavailableKind.GridRange,unavailableCells:t.value,range:e}]));const r=this.getEditedFormat(e);return r.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([r.reason])):r.value===D.SpecialFormat.Unavailable?(0,ze.failure)((0,E.unavailable)([{kind:M.UnavailableKind.CellFormat}])):(0,qe.success)(r.value)}getCellStyle(e){const t=this.allEditedAvailable(e);if(!(0,He.isSuccess)(t))return(0,ze.failure)((0,E.unavailable)([t.reason]));if(!0!==t.value)return(0,ze.failure)((0,E.unavailable)([{kind:M.UnavailableKind.GridRange,unavailableCells:t.value,range:e}]));const r=this.getEditedStyle(e);return(0,He.isSuccess)(r)?r.value===D.SpecialStyle.Unavailable?(0,ze.failure)((0,E.unavailable)([{kind:M.UnavailableKind.CellStyle}])):this.resolveCellStyle(e.sheet.document,r.value):(0,ze.failure)((0,E.unavailable)([r.reason]))}getIformat(e,t){const r=this.getDocument(e);if(r.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([r.reason]));const n=r.value.getIformat(t);if(n.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([n.reason]));const a=n.value.getValue();return a.kind===je.ResultKind.Failure?(0,ze.failure)((0,We.previousFormatFailure)((0,Pe.formatLocIFormat)(e,t))):a}getIformats(e,t,r){const n=this.getDocument(e);if(n.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([n.reason]));const a=n.value.getIformats(),i=[];for(let e=t,n=(0,Fe.fastMin)(a.length,r);e<n;e+=1){const t=a[e];void 0!==t&&i.push({iformat:e,formatString:t.formatString,builtIn:t.builtIn})}return(0,qe.success)(i)}getKnownFormat(e,t){const r=this.getDocument(e);if(r.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([r.reason]));const n=r.value.getKnownFormat(t);if(n.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([n.reason]));const a=n.value.getValue();return a.kind===je.ResultKind.Failure?(0,ze.failure)((0,We.previousFormatFailure)((0,Me.formatLocKnownFormat)(e,t))):a}getFormatString(e,t){const r=this.getDocument(e);if(r.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([r.reason]));const n=r.value.getFormatString(t);return n.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([n.reason])):n}getNameFormula(e,t){const r=this.getDocument(e.scope.document);if(r.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([r.reason]));const n=r.value.getNameFormula(e,t);if(n.kind===je.ResultKind.Failure)return n;if(void 0===n.value)return(0,qe.success)(void 0);const a=n.value.lazyData.getValue();if((0,He.isSuccess)(a))return a;const i=this.hasRecalcNameFailure(e);return(0,He.isSuccess)(i)?i.value||this.setNameFailure(e,a.reason):this.cb.onUnavailable(i.reason),(0,ze.failure)((0,j.previousNameFailure)(e))}getCellFormula(e){const t=this.getEditedFormula(e);if(t.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([t.reason]));if(void 0===t.value)return(0,qe.success)(void 0);const[r,n]=t.value;if(void 0===n.compiledFmla)return(0,qe.success)(void 0);const a=(0,o.sheetGridRange)(e.sheet,r),i=this.readCompiledFmla(a,n.compiledFmla);return(0,He.isSuccess)(i)?(0,qe.success)((0,W.cellFormula)((0,l.lexicalSourceGrid)(n.lexicalKind,a),i.value)):i}setCellValue(e,t,r){const n=this.setRecalcValue(e,t);if(n.kind===je.ResultKind.Failure)return this.cb.onUnavailableObject(n.reason);const a=this.propagateEditTaint(e,r);if(a.kind===je.ResultKind.Failure)return this.cb.onUnavailableObject(a.reason);this.cb.onSetCellValue(e,t,r,a.value,this.evalParams)}setCellValues(e,t,r){const n=this.setClientValue(e,t);if(n.kind===je.ResultKind.Failure)return this.cb.onUnavailableObject(n.reason);const a=this.setRecalcValue(e,t);if(a.kind===je.ResultKind.Failure)return this.cb.onUnavailableObject(a.reason);const i=this.propagateEditTaint(e,r);if(i.kind===je.ResultKind.Failure)return this.cb.onUnavailableObject(i.reason);this.cb.onSetCellValues(e,t,r,i.value,this.evalParams)}getWorksheetFunc(e){if((0,he.isVolatileFunc)(e)){let t=!1;const r=this.evalParams.volatileMode;switch(e){case pe.WorksheetFuncId.RAND:case pe.WorksheetFuncId.RANDBETWEEN:case pe.WorksheetFuncId.RANDARRAY:case pe.WorksheetFuncId.NOW:t=r===me.VolatileMode.GroundTruth;break;case pe.WorksheetFuncId.TODAY:t=r===me.VolatileMode.GroundTruth||r===me.VolatileMode.Estimation;break;default:t=void 0===pe.WorksheetFuncId[e]}if(!t)return(0,ze.failure)((0,E.unavailable)([{kind:M.UnavailableKind.VolatileFunction,name:(0,T.englishWorksheetFuncIdToName)(e)}]))}const t=this.worksheetFuncOverrides[e]??(0,fe.getWorksheetFunc)(e);return null!=t?(0,qe.success)(t):(0,ze.failure)((0,S.notImplemented)([(0,T.englishWorksheetFuncIdToName)(e)]))}getUserDefinedFunc(e){const t=e.id;return void 0!==this.userDefinedFuncOverrides[t]?(0,qe.success)(this.userDefinedFuncOverrides[t]):(0,ze.failure)((0,S.notImplemented)(["call UDF"]))}getSheetRangeIndexes(e){return this.getSheetRangeIds(e)}setCellFailure(e,t,r){const n=this.setRecalcFailure(e.sheet,(0,P.createCellSetFromRange)(e.range));if(n.kind===je.ResultKind.Failure)return this.cb.onUnavailableObject(n.reason);const a=this.setClientValue(e,k.clientValueUnknownOper);if(a.kind===je.ResultKind.Failure)return this.cb.onUnavailableObject(a.reason);const i=this.setRecalcValue(e,N.blankOper);if(i.kind===je.ResultKind.Failure)return this.cb.onUnavailableObject(i.reason);const o=this.propagateEditTaint(e,r);if(o.kind===je.ResultKind.Failure)return this.cb.onUnavailableObject(o.reason);const s=this.evalParams;s.onRangeFailure?.(e,t,r),this.cb.onRangeFailure(e,t,r,o.value,s)}getUsedRange(e){const t=this.getEditedUsedRange(e);return t.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([t.reason])):t}getSheetName(e,t){const r=this.getDocument(e);if(r.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([r.reason]));const n=r.value.getSheetName(t);return n.kind===je.ResultKind.Failure||void 0===n.value?n:(0,qe.success)(n.value)}getSheetIndex(e,t){const r=this.getDocument(e);if(r.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([r.reason]));const n=r.value.getSheetIndex(t);return n.kind===je.ResultKind.Failure||void 0===n.value?n:(0,qe.success)(n.value.index)}getContainingTable(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([t.reason])):t.value.getContainingTable(e)}getNamedRanges(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([t.reason])):t.value.getNamedRanges(e)}getStructRefColumn(e,t){const r=this.getDocument(e.scope.document);return r.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([r.reason])):r.value.getStructRefColumn(e,t)}getStructRefSpecialRef(e,t){const r=this.getDocument(e.scope.document);return r.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([r.reason])):r.value.getStructRefSpecialRef(e,t)}getIntersectingTables(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([t.reason])):t.value.getIntersectingTables(e)}getNamedObject(e,t){const r=this.getDocument(e.scope.document);if(r.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([r.reason]));const n=r.value.getNameFormula(e,t);return n.kind===je.ResultKind.Failure?n:(0,qe.success)(n.value?.obj)}getHiddenRows(e,t,r){const n=this.getDocument(e.document);return n.kind===je.ResultKind.Failure?k.hiddennessFullyUnavailable:n.value.getHiddenRows(e.index,t,r)}tryGetHiddenRows(e,t,r){const n=this.getDocument(e.document);if(n.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([n.reason]));const a=n.value.tryGetHiddenRows(e.index,t,r);return a.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([a.reason])):a}getHiddenCols(e,t,r){const n=this.getDocument(e.document);return n.kind===je.ResultKind.Failure?k.hiddennessFullyUnavailable:n.value.getHiddenCols(e.index,t,r)}tryGetHiddenCols(e,t,r){const n=this.getDocument(e.document);if(n.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([n.reason]));const a=n.value.tryGetHiddenCols(e.index,t,r);return a.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([a.reason])):a}getMergeCell(e){const t=this.allEditedAvailable(e);if(t.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([t.reason]));if(!0!==t.value)return(0,ze.failure)((0,E.unavailable)([{kind:M.UnavailableKind.GridRange,unavailableCells:t.value,range:e}]));const r=this.getDocument(e.sheet.document);if(r.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([r.reason]));const n=r.value.getMergeCell(e);return n.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([n.reason])):n}isInFilterMode(e){const t=this.getDocument(e.document);if(t.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([t.reason]));const r=t.value.isInFilterMode(e.index);return r.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([r.reason])):r}getRandom(){return(0,Ae.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: getRandom",this.evalParams.volatileMode===me.VolatileMode.GroundTruth),(0,qe.success)(this.config.mathpack.fromNumber(this.random.next()))}getTime(e,t){return(0,me.getTimeImpl)(this.config,e,t,this.evalParams.volatileMode)}withEvalParams(e,t){const r=this.evalParams;this.evalParams=e;try{const r=t();return Array.isArray(r)?r:r.kind===je.ResultKind.Paused?(0,H.paused)((()=>this.withEvalParams(e,r.resume))):(0,Y.breaked)((()=>this.withEvalParams(e,r.resume)))}finally{this.evalParams=r}}withEvalParamsEvalFormula(e,t){const r=this.evalParams;this.evalParams=e;try{const r=t();return r.kind===je.ResultKind.Paused?(0,H.paused)((()=>this.withEvalParamsEvalFormula(e,r.resume))):r.kind===je.ResultKind.Breaked?(0,Y.breaked)((()=>this.withEvalParamsEvalFormula(e,r.resume))):r}finally{this.evalParams=r}}evaluate(e,t,r,n){return this.withEvalParams({computeKind:e,computeCells:t,volatileMode:r,onRangeFailure:n},(()=>this.evaluator.evalCells({},t)))}evalFormula(e,t,r,n){const i={lexicalKind:a.LexicalKind.Other,originGridCell:(0,qe.success)(t.range),originSheet:(0,qe.success)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:!1,emitStepInfo:!1,contextNames:void 0},o={lexicalSource:{kind:a.LexicalKind.Other},originGridCell:(0,qe.success)(t.range),originSheet:(0,qe.success)(t.sheet),calcingArray:!1,reflectionGridCell:(0,qe.success)(t.range),reflectionSheet:(0,qe.success)(t.sheet),implicitIntersect:!1,allowUnqualifiedCell:!0,wrapCellReferences:!1,followHyperlinks:(0,qe.success)(!1),contextNames:void 0},s=(e,n)=>{if(n.kind===je.ResultKind.Paused)return(0,H.paused)((()=>s(e,n.resume())));if(n.kind===je.ResultKind.Breaked)return(0,Y.breaked)((()=>s(e,n.resume())));if(!(0,He.isSuccess)(n))return(0,qe.success)({value:n});const a=this.evalFormulaFormat(t,e,n.value,r);return(0,qe.success)({value:(0,qe.success)(n.value),formatted:a})};return this.withEvalParamsEvalFormula({computeKind:D.ComputeKind.EvalFormula,computeCells:[t],volatileMode:n},(()=>{const t=this.parser.parseFormula(i,e),r=this.checkFormula(i,t,e,D.FormulaMode.EvalFormula),n=this.compileFormula(i,r);return(0,He.isSuccess)(n)?s(n.value,this.evaluator.evalFormula(o,n.value)):(0,qe.success)({value:n})}))}evalFormulaFormat(e,t,r,n){if(void 0===n)return;if("number"==typeof n)return this.formatValueIformat(e.sheet.document,n,r);if(n.kind===D.SpecialFormat.Known)return this.formatValueKnownFormat(e.sheet.document,n.knownFormat,r);let a=r;if(this.renderBlanksAsZerosEnabled&&(0,A.isBlankOper)(r)&&(n.kind===D.SpecialFormat.Origin||n.kind===D.SpecialFormat.Inferred||n.kind===D.SpecialFormat.Edit)&&n.renderBlanksAsZeros&&(a=this.config.mathpack.zero),n.kind===D.SpecialFormat.Origin||n.kind===D.SpecialFormat.Aggregate){const t=this.ensureCellExists(e);return(0,ye.isNone)(t)||!(0,He.isSuccess)(t)?t:n.kind===D.SpecialFormat.Origin?this.formatValueCell(e,a):this.formatValueAggregate(e,a)}return n.kind===D.SpecialFormat.Inferred?this.applyInferredFormat(e,t,a):n.kind===D.SpecialFormat.Edit?this.applyEditFormat(e,t,a,n.isWholeFormula):(0,Ce.assertNever)("calc.calc.PartialWorkbookDocumentCollection.evalFormulaFormat",n)}evalValue(e,t,r){const n=this.evalParams;this.evalParams={computeKind:t,computeCells:[e],volatileMode:r};try{const t=this.getEditedFormula(e);if(!(0,He.isSuccess)(t))return this.cb.onUnavailableObject(t.reason);if(void 0!==t.value?.[1].compiledFmla)return;const r=this.hasRecalcDirty(e);if(!(0,He.isSuccess)(r))return this.cb.onUnavailableObject(r.reason);if(r.value)return;const n=this.tryGetCellValue(e.range,e.sheet);if(void 0===n)return;(0,Ae.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.evalValue",n.kind===Q.CellKind.FinalValue),this.cb.onReturnCellValue(e,n.oper,D.ComputedCellKind.EditedCell)}finally{this.evalParams=n}}advanceVersion(){return this.version++,this.version}setUserDefinedFuncOverrides(e){this.userDefinedFuncOverrides=e,this.advanceVersion()}setWorksheetFuncOverrides(e){this.worksheetFuncOverrides=e,this.advanceVersion()}setSheetNames(e,t){const r=this.ensureDocument(e);return r.kind===je.ResultKind.Failure?r:(this.document=r.value.setSheetNames(t),(0,qe.success)(void 0))}advanceState(e){void 0!==this.document&&this.document.advanceState(e,this.advanceVersion())}onCellModified(e){if(void 0!==this.document)return this.document.onCellModified(e,this.advanceVersion())}getServerDocument(){return this.documentLoc}allServerAvailable(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.allServerAvailable(e)}forEachEditedNonBlankCellInSet({index:e,document:t},r,n){const a=this.getDocument(t);return a.kind===je.ResultKind.Failure?a:a.value.forEachEditedNonBlankCellInSet(e,r,n)}forEachServerNonBlankCellInSet({index:e,document:t},r,n){const a=this.getDocument(t);return a.kind===je.ResultKind.Failure?a:a.value.forEachServerNonBlankCellInSet(e,r,n)}forEachEditedCellInSet({index:e,document:t},r,n){const a=this.getDocument(t);return a.kind===je.ResultKind.Failure?a:a.value.forEachEditedCellInSet(e,r,n)}clearCompiledFormulas(){if(void 0!==this.document)return this.document.clearCompiledFormulas()}clearCompiledNumberFormats(){if(void 0!==this.document)return this.document.clearCompiledNumberFormats()}getGridStatistics(){return void 0!==this.document?this.document.getGridStatistics():k.emptyGridStatistics}getNameStatistics(){return void 0!==this.document?this.document.getNameStatistics():Xe.emptyNameStatistics}collectGarbage(e){if(void 0!==this.document)return this.document.collectGarbage(e,this.advanceVersion())}getEditedFormula(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.getEditedFormula(e)}forEachEditedFormula(e,t){const r=this.getDocument(e.sheet.document);return r.kind===je.ResultKind.Failure?r:r.value.forEachEditedFormula(e,t)}getEditedValue(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.getEditedValue(e)}forEachEditedValue(e,t){const r=this.getDocument(e.sheet.document);return r.kind===je.ResultKind.Failure?r:r.value.forEachEditedValue(e,t)}getEditedFormat(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.getEditedFormat(e)}forEachEditedFormat(e,t){const r=this.getDocument(e.sheet.document);return r.kind===je.ResultKind.Failure?r:r.value.forEachEditedFormat(e,t)}getEditedStyle(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.getEditedStyle(e)}getServerFormat(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.getServerFormat(e)}getServerStyle(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.getServerStyle(e)}getClientFormat(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.getClientFormat(e)}getClientValue(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.getClientValue(e)}getRecalcValues(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.getRecalcValues(e)}forEachRecalcValue(e,t){const r=this.getDocument(e.sheet.document);return r.kind===je.ResultKind.Failure?r:r.value.forEachRecalcValue(e,t)}getServerValue(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.getServerValue(e)}getServerFormula(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.getServerFormula(e)}getClientFormula(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.getClientFormula(e)}getServerUsedRange(e){const t=this.getDocument(e.document);if(t.kind===je.ResultKind.Failure)return t;const r=t.value.getServerUsedRange(e.index);return r.kind===je.ResultKind.Failure||void 0===r.value?r:(0,qe.success)((0,o.sheetGridRange)(e,r.value))}getServerAvailableCells(){const e=[];return this.forEachDocument((t=>{(0,ve.safePush)(e,t.getServerAvailableCells())})),e}promoteServerAvailability({sheet:e,set:t},r){const n=this.getDocument(e.document);return n.kind===je.ResultKind.Failure?n:n.value.promoteServerAvailability(e.index,t,r)}extendServerUnused(e,t){const r=this.getDocument(e.document);return r.kind===je.ResultKind.Failure?r:r.value.extendServerUnused(e.index,t,this.advanceVersion())}setCellContents(e,t,r,n,i,o,u,l,c,d){const g=this.getDocument(t.sheet.document);if(g.kind===je.ResultKind.Failure)return g;const m=void 0===r?void 0:n?this.compileFmla(e,a.LexicalKind.Cell,(0,s.sheetGridCell)(t.sheet,i),void 0,r):""===r?k.blankCellGridFormula:{fmla:r,lexicalKind:a.LexicalKind.Cell,origin:i,compiledFmla:void 0,hasHyperlink:k.SpecialBoolean.ClientValueUnknown};return g.value.setCellContents(e,t,m,o,u,l,c,d,this.advanceVersion())}setRangeFormula(e,t,r,n,i,o,u,l){const c=this.getDocument(t.sheet.document);if(c.kind===je.ResultKind.Failure)return c;const d=""===r?k.blankRangeGridFormula:this.compileFmla(e,a.LexicalKind.Range,(0,s.sheetGridCell)(t.sheet,n),(0,v.gridRangeAnchor)(t.range),r);return c.value.setRangeFormula(e,t,d,i,o,u,l,this.advanceVersion())}copyRange(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.copyRange(e)}pasteRange(e,t){const r=this.getDocument(e.sheet.document);return r.kind===je.ResultKind.Failure?r:r.value.pasteRange(e,t,this.advanceVersion())}assumeRecalcFinal(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.assumeRecalcFinal(e,this.advanceVersion())}getDirtyEditedCells(){return this.document?this.document.getDirtyEditedCells():[]}getNonDirtyEditedCells(){return this.document?this.document.getNonDirtyEditedCells():[]}getDirtyDependentCells(){return this.document?this.document.getDirtyDependentCells():[]}setNamedObject(e,t,r){const n=this.getDocument(t.scope.document);return n.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([n.reason])):n.value.setNamedObject(e,t,r,this.compileNamedObject)}setUndefinedNames(e){const t=this.getDocument(e.document);return t.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([t.reason])):t.value.setUndefinedNames(e)}promoteNamedObjects(e,t){const r=this.getDocument(e.document);return r.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([r.reason])):r.value.promoteNamedObjects(e,t)}setNumberFormats(e,t,r){const n=this.ensureDocument(e);if(n.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([n.reason]));const a=[];return t.forEach((({iformat:e,formatString:t,builtIn:r})=>{const n=this.compileNumberFormat(t,r);a[e]={formatString:t,builtIn:r,compiledFormat:n}})),(0,qe.success)(n.value.setNumberFormats(a,r))}setStyles(e,t,r){const n=this.ensureDocument(e);return n.kind===je.ResultKind.Failure?n:(0,qe.success)(n.value.setStyles(t,r))}setFonts(e,t,r){const n=this.ensureDocument(e);return n.kind===je.ResultKind.Failure?n:(0,qe.success)(n.value.setFonts(t,r))}setFills(e,t,r){const n=this.ensureDocument(e);return n.kind===je.ResultKind.Failure?n:(0,qe.success)(n.value.setFills(t,r))}setBorders(e,t,r){const n=this.ensureDocument(e);return n.kind===je.ResultKind.Failure?n:(0,qe.success)(n.value.setBorders(t,r))}writeHiddenRows(e,t,r){const n=this.getDocument(e.document);return n.kind===je.ResultKind.Failure?n:n.value.setHiddenRows(e.index,t,r)}writeHiddenCols(e,t,r){const n=this.getDocument(e.document);return n.kind===je.ResultKind.Failure?n:n.value.setHiddenCols(e.index,t,r)}writeMergeCell(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.setMergeCell(e)}writeInFilterMode(e,t){const r=this.getDocument(e.document);return r.kind===je.ResultKind.Failure?r:r.value.setInFilterMode(e.index,t)}resolveCellFormat(e,t){if("number"!=typeof t)return(0,qe.success)(t);const r=this.getDocument(e);if(!(0,He.isSuccess)(r))return(0,ze.failure)((0,E.unavailable)([r.reason]));const n=r.value.getIformat(t);return(0,He.isSuccess)(n)?n.value.getValue():(0,ze.failure)((0,E.unavailable)([n.reason]))}resolveCellStyle(e,t){const r=this.getDocument(e);if(!(0,He.isSuccess)(r))return(0,ze.failure)((0,E.unavailable)([r.reason]));const n=r.value.resolveCellStyle(t);return(0,He.isSuccess)(n)?(0,qe.success)(n.value):(0,ze.failure)((0,E.unavailable)([n.reason]))}resolveValueFormat(e,t){if("string"==typeof t)return this.resolveStringFormat(e,t);const r=this.getKnownFormat(e,t);if(!(0,He.isSuccess)(r))return r;const n=this.getFormatString(e,r.value.formatString);return(0,He.isSuccess)(n)?(0,qe.success)(n.value??r.value):n}resolveStringFormat(e,t){const r=this.getFormatString(e,t);return(0,He.isSuccess)(r)?void 0!==r.value?(0,qe.success)(r.value):this.formatter.createFormat(t,!1):r}resolveObjectFormat(e,t){const r=this.getFormatString(e,t.formatString);return(0,He.isSuccess)(r)?void 0!==r.value?(0,qe.success)(r.value):(0,qe.success)(t):r}resolveEditFormat(e,t){return"number"==typeof t?(0,qe.success)(t):this.resolveStringFormat(e,t)}resolveRibbonFormat(e,t,r){let n;switch(t){case ot.RibbonFormat.GalleryShortDate:case ot.RibbonFormat.GalleryLongDate:{const e=this.getCellFormat(r);if(!(0,He.isSuccess)(e))return e;const t=this.resolveCellFormat(r.sheet.document,e.value);if(!(0,He.isSuccess)(t))return t;n=t.value;break}}const a=(0,it.getRibbonFormat)(this.config.localeInfo,t,n);return this.resolveStringFormat(e,a)}resolveChangeDecimals(e,t,r){const n=this.getCellFormat(r);if(!(0,He.isSuccess)(n))return n;const a=this.resolveCellFormat(r.sheet.document,n.value);if(!(0,He.isSuccess)(a))return a;const i=this.formatter.changeFormatDecimals(a.value,t);return(0,He.isSuccess)(i)?void 0===i.value?Qe.successUndefined:this.resolveObjectFormat(e,i.value):i}parseInferredEdit(e,t,r){const n=this.getCellFormat(e);if(!(0,He.isSuccess)(n))return n;const a=this.resolveCellFormat(e.sheet.document,n.value);if(!(0,He.isSuccess)(a))return a;const i=this.evalParams;this.evalParams={computeKind:D.ComputeKind.ParseEdit,computeCells:[e],volatileMode:r};try{return this.formatter.parseEdit(t,a.value)}finally{this.evalParams=i}}inferFormulaFormat(e){const t=this.getEditedFormula(e);if(!(0,He.isSuccess)(t))return(0,qe.success)(void this.cb.onUnavailableObject(t.reason));if(void 0===t.value||void 0===t.value[1].compiledFmla)return(0,qe.success)(void this.cb.onUnavailableObject({kind:M.UnavailableKind.CellEvaluatingValue}));const r=t.value[1].compiledFmla.getValue();if(!(0,He.isSuccess)(r))return r;const n=(0,l.lexicalSourceGrid)(t.value[1].lexicalKind,(0,o.sheetGridRange)(e.sheet,t.value[0])),a=r.value;return this.formatter.evalFormat((0,Ue.evalFormatLocalsGrid)(n),a)}fillInferredFormat(e,t){let r=t,n=t===D.SpecialFormat.Unavailable?(0,qe.success)(D.SpecialFormat.Unavailable):this.resolveCellFormat(e.sheet.document,t);if(!(0,He.isSuccess)(n)){const t=n.reason;(0,P.forEachRangeInSet)(e.set,(r=>{const n=(0,o.sheetGridRange)(e.sheet,r);return this.cb.onInferFormatFailure(n,t),!0})),n=(0,qe.success)(D.SpecialFormat.Unavailable),r=D.SpecialFormat.Unavailable}const a=n.value;(0,P.forEachCellInSet)(e.set,(t=>{const n=(0,s.sheetGridCell)(e.sheet,t),i=this.getEditedFormat(n);if(!(0,He.isSuccess)(i))return this.cb.onUnavailableObject(i.reason),!0;if(i.value===D.SpecialFormat.Unavailable)return!0;const o=this.resolveCellFormat(e.sheet.document,i.value);if(!(0,He.isSuccess)(o))return this.cb.onInferFormatFailure(n,o.reason),!0;if((0,Be.shouldInstallFormat)(a===D.SpecialFormat.Unavailable?void 0:a,o.value)){const e=this.setEditedFormat(n,r);(0,He.isSuccess)(e)||this.cb.onUnavailableObject(e.reason)}return!0}))}anonymizeFormula(e,t){const r=t.compiledFmla?.getValue();return void 0!==r&&(0,He.isSuccess)(r)?[(0,ke.anonymizeFormula)(this.config,r.value,e),ct(r.value)]:[(0,Ie.anonymizeFormulaString)(t.fmla),[]]}compileFmla(e,t,r,n,a){return{fmla:a,lexicalKind:t,origin:n??r.range,compiledFmla:new me.ResettableLazy((()=>{const i=this.parser.parseFormula((0,J.parseLocals)(t,r.range),a),o=e?i:this.autocorrectFormula((0,L.analyzeLocalsGrid)(t,r),i),s=e&&this.isServerWorkbookLoad,u=this.checkFormula((0,L.analyzeLocalsGrid)(t,r,void 0,s),o,a,e?D.FormulaMode.ServerCellFormula:D.FormulaMode.EditCellFormula),l=this.adjustFormulaOrigin(u,r,n);return this.compileFormula((0,q.compileLocalsGrid)(t,r.range),l)})),hasHyperlink:k.SpecialBoolean.ClientValueUnknown}}compileFormula(e,t){return(0,He.isSuccess)(t)?this.compiler.compileFormula(e,t.value):t}checkFormula(e,t,r,n){if(!(0,He.isSuccess)(t))return t;const a=this.analyzer.checkFormulaWithDiagnostics(e,t.value);if(!(0,He.isSuccess)(a))return a;if(!(0,f.isWellFormed)(a.value[0])){const e="calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+(0,Ie.anonymizeFormulaString)(r);return(0,ze.failure)((0,K.illFormedFormula)(e,n,(0,x.summarizeFormulaDiagnostics)(a.value[1])))}return(0,qe.success)(a.value[0])}autocorrectFormula(e,t){return(0,He.isSuccess)(t)?this.analyzer.autocorrectFormula(e,t.value):t}adjustFormulaOrigin(e,t,r){if(!(0,He.isSuccess)(e)||void 0===r)return e;const n=(0,$e.resolveLocalsGrid)(t);return(0,Oe.adjustFormulaOrigin)(this,n,r,e.value)}compileNumberFormat(e,t){return new me.ResettableLazy((()=>{const r=this.formatter.createFormat(e,t);return(0,He.isSuccess)(r)||this.cb.onNumberFormatFailure(r.reason),r}))}compileKnownFormats(){return(0,Se.numEnumMap)(Je.KnownFormat,(e=>this.compileNumberFormat((0,et.getKnownFormat)(this.config.localeInfo,e),!1)))}printFormulaBarText(e,t,r){return this.printer.printFormula((0,Re.printLocalsGrid)(e,(0,s.sheetGridCell)(e.range.sheet,t)),r)}renderValueBarText(e,t,r){const n=this.getEditedResolvedFormat(e);return(0,He.isSuccess)(n)?this.formatter.renderFormulaBar(e.sheet.document,t,n.value,(0,tt.stringStartsWith)(r,"'")):n}formatValueCell(e,t){if((0,A.isBlankOper)(t))return(0,qe.success)((0,_e.formattedValue)([],void 0,xe.Alignment.Left,Ke.Clip.All));const r=this.getEditedResolvedFormat(e);return(0,He.isSuccess)(r)?this.formatter.applyFormat(r.value,t,!0):r}formatValueAggregate(e,t){if(!(0,h.isNumberOper)(t))return(0,qe.success)((0,Le.hashesValue)(we.aggregationError,void 0));let r;if((0,h.isNumberOper)(t)&&0===this.config.mathpack.cond(t))r=this.getKnownFormat(e.sheet.document,Je.KnownFormat.General);else{if(r=this.getEditedResolvedFormat(e),!(0,He.isSuccess)(r))return r;const{valueType:t}=r.value;t===De.FormatValueType.Text?r=this.getKnownFormat(e.sheet.document,Je.KnownFormat.General):t===De.FormatValueType.Time&&(r=this.getKnownFormat(e.sheet.document,Je.KnownFormat.AbsHMMSS))}return(0,He.isSuccess)(r)?this.formatter.applyFormat(r.value,t,!0):r}formatValueIformat(e,t,r){const n=this.getIformat(e,t);return(0,He.isSuccess)(n)?this.formatter.applyFormat(n.value,r,!0):n}formatValueKnownFormat(e,t,r){const n=this.getKnownFormat(e,t);return(0,He.isSuccess)(n)?this.formatter.applyFormat(n.value,r,!0):n}getEditedResolvedFormat(e){const t=this.getEditedFormat(e);return(0,He.isSuccess)(t)?t.value===D.SpecialFormat.Unavailable?(0,ze.failure)((0,E.unavailable)([{kind:M.UnavailableKind.CellFormat}])):this.resolveCellFormat(e.sheet.document,t.value):(0,ze.failure)((0,E.unavailable)([t.reason]))}getDocument(e){return void 0!==this.documentLoc&&void 0!==this.document&&(0,p.isDocumentLocEqual)(this.documentLoc,e)?(0,qe.success)(this.document):(0,ze.failure)({kind:M.UnavailableKind.DocumentLoc,document:e})}ensureDocument(e){return void 0===this.documentLoc&&void 0===this.document&&(this.documentLoc=e,this.document=new n.PartialWorkbookDocument(e,this.config.localeInfo.stringCompareCI,new Ze.PartialWorkbookFormats(this.compileKnownFormats()),new at.PartialWorkbookStyles)),this.getDocument(e)}tryGetCellValues(e,t){const r=(0,o.sheetGridRange)(t,e),{row:n,col:a,rows:u,cols:l}=e,c=this.getRecalcValues(r);if(c.kind===je.ResultKind.Failure)return void this.cb.onUnavailableObject(c.reason);let d=!1;for(let e=0;e<u;e+=1){const r=c.value[e];for(let o=0;o<l;o+=1){const{failure:u}=r[o];void 0!==u&&(this.setCellFailure((0,s.sheetGridCell)(t,(0,i.gridCell)(n+e,a+o)),u,dt),d=!0)}}if(d)return;const g=e=>(0,B.finalValue)(e.oper),m=c.value.map((e=>e.map(g))),h=this.forEachRecalcDirty(r,(e=>{const r=(0,s.sheetGridCell)(t,e),i=this.getEditedFormula(r);if(i.kind===je.ResultKind.Failure)return this.cb.onUnavailableObject(i.reason),!1;if(void 0===i.value)return this.setCellFailure(r,(0,E.unavailable)([{kind:M.UnavailableKind.CellMissingFormula}]),dt),d=!0,!0;const[u,l]=i.value;if(void 0===l.compiledFmla)return this.cb.onUnavailableObject({kind:M.UnavailableKind.CellEvaluatingValue}),!1;const c=this.readCompiledFmla((0,o.sheetGridRange)(t,u),l.compiledFmla);return(0,He.isSuccess)(c)?(m[e.row-n][e.col-a]=(0,V.pendingValue)((0,s.sheetGridCell)(t,(0,v.gridRangeAnchor)(u))),!0):(d=!0,!0)}));if((0,He.isSuccess)(h)){if(h.value&&!d)return m}else this.cb.onUnavailableObject(h.reason)}tryGetCellValue(e,t){const r=this.tryGetCellValues(e,t);return void 0===r?void 0:r[0][0]}makeGetCellValues(e){return t=>{const r=this.allEditedAvailable(t);if(r.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([r.reason]));if(!0!==r.value)return(0,ze.failure)((0,E.unavailable)([{kind:M.UnavailableKind.GridRange,range:t,unavailableCells:r.value}]));const n=this.hasRecalcFailure(t);if(n.kind===je.ResultKind.Failure)return(0,ze.failure)((0,E.unavailable)([n.reason]));if(n.value)return(0,ze.failure)((0,G.previousFailure)(t));if((0,C.gridRangeSize)(t.range)>this.maxDereferenceCells)return(0,ze.failure)((0,E.unavailable)([{kind:M.UnavailableKind.GridRangeSize,range:t}]));const a=e(t.range,t.sheet);return void 0===a?(0,ze.failure)((0,G.previousFailure)(t)):(0,qe.success)(a)}}readCompiledFmla(e,t){const r=t.getValue();return(0,He.isSuccess)(r)?r:(this.setCellFailure(e,r.reason,dt),r.reason.kind===$.ReasonKind.Unavailable?(r.reason,r):(0,ze.failure)((0,E.unavailable)([{kind:M.UnavailableKind.CellFormula,reason:r.reason}])))}getEditedUsedRange(e){const t=this.getDocument(e.document);if(t.kind===je.ResultKind.Failure)return t;const r=t.value.getEditedUsedRange(e.index);return r.kind===je.ResultKind.Failure||void 0===r.value?r:(0,qe.success)((0,o.sheetGridRange)(e,r.value))}getSheetRangeIds(e){const t=this.getDocument(e.document);return t.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([t.reason])):t.value.getSheetRangeIds(e)}allEditedAvailable(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.allEditedAvailable(e)}forEachRecalcDirty(e,t){const r=this.getDocument(e.sheet.document);return r.kind===je.ResultKind.Failure?r:r.value.forEachRecalcDirty(e,t)}hasRecalcDirty(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.hasRecalcDirty(e)}hasRecalcFailure(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.hasRecalcFailure(e)}hasEditedEditTaint(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.hasEditedEditTaint(e)}hasRecalcEditTaint(e){const t=this.getDocument(e.sheet.document);return t.kind===je.ResultKind.Failure?t:t.value.hasRecalcEditTaint(e)}setEditedFormat(e,t){const r=this.getDocument(e.sheet.document);return r.kind===je.ResultKind.Failure?r:r.value.setEditedFormat(e,t)}setClientFormat(e,t){const r=this.getDocument(e.sheet.document);return r.kind===je.ResultKind.Failure?r:r.value.setClientFormat(e,t,this.advanceVersion())}setRecalcFailure(e,t){const r=this.getDocument(e.document);return r.kind===je.ResultKind.Failure?r:r.value.setRecalcFailure(e.index,t)}testAndSetClientValue(e,t){const r=this.getClientValue(e);if(r.kind===je.ResultKind.Failure)return r;const n=(0,k.isClientValueUnknownOper)(r.value.oper)||!(0,F.isReadOperEqual)(this.config.mathpack,r.value.oper,t,!0);if(n){const r=this.setClientValue(e,t);if(r.kind===je.ResultKind.Failure)return r}return(0,qe.success)(n)}testAndSetClientFormat(e,t){const r=this.getClientFormat(e);if(r.kind===je.ResultKind.Failure)return r;const n=t!==r.value;if(n){const r=this.setClientFormat(e,t);if(r.kind===je.ResultKind.Failure)return r}return(0,qe.success)(n)}testAndSetClientFormula(e,t,r){const n=this.getClientFormula((0,b.sheetGridRangeAnchor)(e));if(n.kind===je.ResultKind.Failure)return n;const[a,i]=n.value??[e.range,k.blankClientGridFormula],s=(0,v.gridRangeAnchor)(e.range),u=void 0!==t&&t!==i.fmla||void 0!==i.compiledFmla&&!(0,y.isGridCellEqual)(s,i.origin),l=void 0!==r&&r!==i.hasHyperlink;if(u||l){const{compiledFmla:n}=i,u=this.setClientFormula((0,o.sheetGridRange)(e.sheet,a),{fmla:t??i.fmla,compiledFmla:n,origin:void 0!==t?s:i.origin,hasHyperlink:r??i.hasHyperlink});if(u.kind===je.ResultKind.Failure)return u}return(0,qe.success)({hasFmlaChanged:u,hasHyperlinkChanged:l})}setRecalcEditTaint(e,t){const r=this.getDocument(e.document);return r.kind===je.ResultKind.Failure?r:r.value.setRecalcEditTaint(e.index,t)}propagateEditTaint(e,t){const r=this.hasEditedEditTaint(e);if(r.kind===je.ResultKind.Failure)return r;if(r.value)return(0,qe.success)(D.ComputedCellKind.EditedCell);for(const r of t.cells){const t=this.hasRecalcEditTaint(r);if(t.kind===je.ResultKind.Failure)return t;if(t.value){const t=this.setRecalcEditTaint(e.sheet,(0,P.createCellSetFromRange)(e.range));return t.kind===je.ResultKind.Failure?t:(0,qe.success)(D.ComputedCellKind.DependentCell)}}if(0!=(t.special&(Ve.SpecialPrecs.Calc|Ve.SpecialPrecs.Time))){const t=this.setRecalcEditTaint(e.sheet,(0,P.createCellSetFromRange)(e.range));return t.kind===je.ResultKind.Failure?t:(0,qe.success)(D.ComputedCellKind.DependentCell)}return t.bound===I.PrecsBound.Exact||void 0!==this.evalParams&&this.evalParams.computeKind===D.ComputeKind.EditedCell?(0,qe.success)(D.ComputedCellKind.IndependentCell):(0,qe.success)(D.ComputedCellKind.UnknownNonEditedCell)}setClientValue(e,t){const r=this.getDocument(e.sheet.document);return r.kind===je.ResultKind.Failure?r:r.value.setClientValue(e,t,this.advanceVersion())}setRecalcValue(e,t){const r=this.getDocument(e.sheet.document);return r.kind===je.ResultKind.Failure?r:r.value.setRecalcValue(e,t)}setClientFormula(e,t){const r=this.getDocument(e.sheet.document);return r.kind===je.ResultKind.Failure?r:r.value.setClientFormula(e,t,this.advanceVersion())}hasRecalcNameFailure(e){const t=this.getDocument(e.scope.document);return t.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([t.reason])):t.value.hasRecalcNameFailure(e)}setRecalcNameFailure(e){const t=this.getDocument(e.scope.document);return t.kind===je.ResultKind.Failure?(0,ze.failure)((0,E.unavailable)([t.reason])):t.value.setRecalcNameFailure(e)}setNameFailure(e,t){const r=this.setRecalcNameFailure(e);if(r.kind===je.ResultKind.Failure)return this.cb.onUnavailable(r.reason);this.cb.onNameFailure(e,t,this.evalParams)}applyInferredFormat(e,t,r){const n=this.getInferredFormat(e,t);return(0,He.isSuccess)(n)?void 0===n.value?this.formatValueKnownFormat(e.sheet.document,Je.KnownFormat.General,r):"number"==typeof n.value?this.formatValueIformat(e.sheet.document,n.value,r):this.formatter.applyFormat(n.value,r,!0):n}applyEditFormat(e,t,r,n){if(t.node.kind===te.NodeKind.CellRef&&!n)return this.applyInferredFormat(e,t,r);const a=this.ensureCellExists(e);if((0,ye.isNone)(a)||!(0,He.isSuccess)(a))return a;const i=this.getEditedResolvedFormat(e);if(!(0,He.isSuccess)(i))return i;const o=this.getInferredFormat(e,t);if(!(0,He.isSuccess)(o))return o;let s;if(void 0===o.value)s=void 0;else if("number"==typeof o.value){const t=this.getIformat(e.sheet.document,o.value);if(!(0,He.isSuccess)(t))return t;s=t.value}else s=o.value;const u=(0,et.getKnownFormat)(this.config.localeInfo,Je.KnownFormat.General)===i.value.formatString;return(n||u)&&(0,be.isDefined)(s)&&(0,Be.shouldInstallFormat)(s,i.value)?this.formatter.applyFormat(s,r,!0):this.formatter.applyFormat(i.value,r,!0)}getInferredFormat(e,t){const r={lexicalSource:{kind:a.LexicalKind.Other},originGridCell:(0,qe.success)(e.range),originSheet:(0,qe.success)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1};return this.formatter.evalFormat(r,t)}ensureCellExists(e){const t=this.allEditedAvailable(e);if((0,He.isSuccess)(t))return!0!==t.value?(0,ze.failure)((0,E.unavailable)([{kind:M.UnavailableKind.GridRange,unavailableCells:t.value,range:e}])):(0,qe.success)(!0);this.cb.onUnavailableObject(t.reason)}constructor(e,t,r,n,i,o){this.cb=t,this.schedulerConfig=r,this.limits=n,this.maxDereferenceCells=i,this.isServerWorkbookLoad=o,this.renderBlanksAsZerosEnabled=(0,st.isChangeGateEnabled)("OfficeVSO:7042222_renderBlanksAsZeros"),this.random=new Ye.JSF32(4294967296*Math.random()),this.worksheetFuncOverrides={},this.userDefinedFuncOverrides={},this.version=0,this.interruptToken=[U.Interrupt.Continue],this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.compileNamedObject=(e,t,r)=>{const n=e?D.FormulaMode.ServerNamedFormula:D.FormulaMode.EditNamedFormula;switch(r.kind){case"NamedFormula":{const t=r.fmla,i=this.parser.parseFormula((0,J.parseLocals)(a.LexicalKind.NameManager,ut),t);(0,Ae.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: isServerUpdate",e);const o=e&&this.isServerWorkbookLoad,s=(0,_.analyzeLocalsName)((0,d.originCell)((0,g.documentScope)(this.documentLoc),ut),void 0,o),u=i,l=this.checkFormula(s,u,t,n);return this.compileFormula((0,z.compileLocalsName)(ut),l)}case"NamedValue":case"NamedRange":case"NamedTable":{let e,n;if("NamedRange"===r.kind){const a=r.value;(0,Ae.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",(0,p.isDocumentLocEqual)(r.value.sheets.document,t.scope.document));const i=a.sheets,o=this.getDocument(i.document);if(!(0,He.isSuccess)(o))return this.cb.onUnavailableObject(o.reason),(0,ze.failure)((0,E.unavailable)([o.reason]));const u=o.value.getSheetName(i.index);if(!(0,He.isSuccess)(u))return this.cb.onUnavailable(u.reason),u;const l=r.value.ranges[0];e=(0,ne.formula)((0,ae.cellRefNode)((0,ie.cellRefRange)((0,oe.cellRefSingle)((0,ue.pos)(le.PosKind.Abs,l.row),(0,ue.pos)(le.PosKind.Abs,l.col)),(0,oe.cellRefSingle)((0,ue.pos)(le.PosKind.Abs,l.row+l.rows-1),(0,ue.pos)(le.PosKind.Abs,l.col+l.cols-1))),(0,se.sheetQualifier)(u.value)),[],[],1),n=(0,s.sheetGridCell)(i,ut)}else"NamedTable"===r.kind?(e=(0,ne.formula)((0,ce.structRefNode)((0,de.nameNode)((0,ee.identNamePart)(t.name)),(0,ge.structRef)(void 0)),[],[],1),n=(0,d.originCell)((0,g.documentScope)(this.documentLoc),ut)):(e=(0,ne.formula)((0,re.literalNode)(r.value,!0),[],[],1),n=(0,d.originCell)((0,g.documentScope)(this.documentLoc),ut));const a=this.analyzer.checkFormula((0,_.analyzeLocalsName)(n),e);return(0,He.isSuccess)(a)&&(0,f.isWellFormed)(a.value)?this.compileFormula((0,z.compileLocalsName)(ut),(0,qe.success)(a.value)):(0,Ee.assertFalse)(`calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula ${(0,ke.anonymizeFormula)(this.config,e,(0,c.lexicalSourceName)(t))}`)}case"NamedFailure":return(0,ze.failure)((0,E.unavailable)([{kind:M.UnavailableKind.ClientFailure,reason:r.failureReason}]));default:return(0,Ce.assertNever)("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",r)}},this.config=e,this.parser=(0,X.createParser)(this),this.printer=(0,Ne.createPrinter)(this),this.analyzer=(0,w.createAnalyzer)(this),this.formatter=(0,Ge.createNumberFormatter)(this),this.compiler=(0,Z.createCompiler)(this),this.evaluator=(0,Te.createEvaluator)(this)}}t.PartialWorkbookDocumentCollection=gt},1167:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFailureOutputMessage=void 0;const n=r(6869),a=[n.OutputMessageKind.RangeFailure,n.OutputMessageKind.NameFailure,n.OutputMessageKind.NumberFormatFailure,n.OutputMessageKind.PrintFormulaFailure,n.OutputMessageKind.InferFormatFailure,n.OutputMessageKind.FormatValueFailure,n.OutputMessageKind.UnhandledFailure];t.isFailureOutputMessage=function(e){return a.includes(e.kind)}},8813:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookFormats=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6869);class s{clone(){const e=new s(this.knownFormats);return Object.keys(this.iformats).map(Number).forEach((t=>{e.iformats[t]=this.iformats[t]})),Object.keys(this.formatStrings).forEach((t=>{e.formatStrings[t]=this.formatStrings[t]})),e}clearCompiledNumberFormats(){this.iformats.forEach((e=>{e.compiledFormat.reset()})),Object.keys(this.knownFormats).map((e=>Number(e))).forEach((e=>{this.knownFormats[e].reset()})),this.formatStrings=(0,n.makeStringMap)(),Object.keys(this.iformats).map(Number).forEach((e=>{const t=this.iformats[e];this.formatStrings[t.formatString]=e}))}getIformat(e){const t=this.iformats[e];return void 0===t?(0,i.failure)({kind:o.UnavailableKind.NumberFormat,iformat:e}):(0,a.success)(t.compiledFormat)}getIformats(){return this.iformats}getKnownFormat(e){return(0,a.success)(this.knownFormats[e])}getFormatString(e){return(0,a.success)(this.formatStrings[e])}setNumberFormats(e,t){t||(this.iformats=[],this.formatStrings=(0,n.makeStringMap)()),Object.keys(e).map(Number).forEach((t=>{const r=this.iformats[t];void 0!==r&&delete this.formatStrings[r.formatString];const n=e[t];this.iformats[t]=n,this.formatStrings[n.formatString]=t}))}constructor(e){this.iformats=[],this.formatStrings=(0,n.makeStringMap)(),this.knownFormats=e}}t.PartialWorkbookFormats=s},2393:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookGrid=t.CloningTarget=t.usedRangeIsect=t.usedRangeJoin=t.denseUsedRange=t.emptyUsedRange=t.mergeGridStatistics=t.emptyGridStatistics=t.hiddennessFullyUnavailable=t.isBlankGridValue=t.blankGridValue=t.isClientValueUnknownOper=t.clientValueUnknownOper=t.ClientOperKind=t.blankClientGridFormula=t.isBlankGridFormula=t.blankRangeGridFormula=t.blankCellGridFormula=t.SpecialString=t.SpecialBoolean=t.isBlankCellFormat=t.blankCellFormat=void 0;const n=r(8073),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6468),S=r(6067),v=r(6366),F=r(6366),y=r(9207),b=r(9207),C=r(9207),A=r(9207),E=r(9207),T=r(5013),R=r(5013),k=r(5013),N=r(5013),I=r(5013),O=r(5013),P=r(5013),M=r(5013),D=r(6869),w=r(6869),L=r(6366),_=r(6366),x=r(6366);function K(e){return Array.isArray(e)}var W,U,G;function B(e){return e.kind===G.ClientValueUnknown}function V(e,t){return(0,s.isBlankOper)(e)&&void 0===t}function j(e,t,r){return e.setValue(t,r,(e=>e.fmla!==r.fmla||e.lexicalKind!==r.lexicalKind||void 0!==e.compiledFmla&&!(0,u.isGridCellEqual)(e.origin,r.origin)||null==e.compiledFmla!=(null==r.compiledFmla)))}function H(e,r){return e.forEachMeets(r,((r,n)=>{if(n.fmla.length>0){const a=n.lexicalKind===c.LexicalKind.Cell?t.blankCellGridFormula:t.blankRangeGridFormula;e=e.setValue(r,a)}return!0})),e}function q(e,r){return e.forEachMeets(r,((r,n)=>((n.fmla===U.ClientValueUnknown||n.fmla.length>0)&&(e=e.setValue(r,t.blankClientGridFormula)),!0))),e}function z(e,t,r,n){const a=(0,T.intersectProduct)(t,f.availableReadProduct),i=(0,P.project)((0,T.intersectProduct)(r,a),"row","col");return(0,f.forEachCellInSet)((0,M.exceptProduct)(t,i),(t=>(e=e.setValue(t,n),!0))),e}t.blankCellFormat=0,t.isBlankCellFormat=e=>0===e,function(e){e.ClientValueUnknown="ClientValueUnknown"}(W||(t.SpecialBoolean=W={})),function(e){e[e.ClientValueUnknown=0]="ClientValueUnknown"}(U||(t.SpecialString=U={})),t.blankCellGridFormula={fmla:"",lexicalKind:c.LexicalKind.Cell,origin:(0,h.gridCell)(0,0),compiledFmla:void 0,hasHyperlink:!1},(0,F.staticAssertExtends)(),t.blankRangeGridFormula={fmla:"",lexicalKind:c.LexicalKind.Range,origin:(0,h.gridCell)(0,0),compiledFmla:void 0,hasHyperlink:!1},(0,F.staticAssertExtends)(),t.isBlankGridFormula=(e,t)=>""===e&&!t,t.blankClientGridFormula=t.blankCellGridFormula,function(e){e.ClientValueUnknown="ClientValueUnknown"}(G||(t.ClientOperKind=G={})),t.clientValueUnknownOper={kind:G.ClientValueUnknown},t.isClientValueUnknownOper=B,t.blankGridValue={oper:p.blankOper,failure:void 0},(0,F.staticAssertExtends)(),t.isBlankGridValue=V,t.hiddennessFullyUnavailable={hidden:[],available:[]};const Q={values:(0,S.makeGridRangeTable)(),formats:(0,S.makeGridRangeTable)(),styles:(0,S.makeGridRangeTable)(),formulae:(0,S.makeGridRangeTable)(),dirty:y.empty};function $(e,r){return e===t.emptyUsedRange?r:r===t.emptyUsedRange?e:(0,o.gridRangeJoin)(e,r)}function Y(e,r){return e===t.emptyUsedRange||r===t.emptyUsedRange?t.emptyUsedRange:(0,i.gridRangeIsect)(e,r)}var J;t.emptyGridStatistics={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverStylesNodeCount:0,serverValuesNodeCount:0,serverDirtySetSubspaceCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedStylesNodeCount:0,editedValuesNodeCount:0,editedDirtySetSubspaceCount:0,clientFormulaeNodeCount:0,clientFormatsNodeCount:0,clientValuesNodeCount:0,recalcValuesNodeCount:0,recalcDirtySetSubspaceCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0,hiddenColsNodeCount:0},t.mergeGridStatistics=function(e,t){return{serverFormulaeNodeCount:e.serverFormulaeNodeCount+t.serverFormulaeNodeCount,serverFormatsNodeCount:e.serverFormatsNodeCount+t.serverFormatsNodeCount,serverStylesNodeCount:e.serverStylesNodeCount+t.serverStylesNodeCount,serverValuesNodeCount:e.serverValuesNodeCount+t.serverValuesNodeCount,serverDirtySetSubspaceCount:e.serverDirtySetSubspaceCount+t.serverDirtySetSubspaceCount,editedFormulaeNodeCount:e.editedFormulaeNodeCount+t.editedFormulaeNodeCount,editedFormatsNodeCount:e.editedFormatsNodeCount+t.editedFormatsNodeCount,editedStylesNodeCount:e.editedStylesNodeCount+t.editedStylesNodeCount,editedValuesNodeCount:e.editedValuesNodeCount+t.editedValuesNodeCount,editedDirtySetSubspaceCount:e.editedDirtySetSubspaceCount+t.editedDirtySetSubspaceCount,clientFormulaeNodeCount:e.clientFormulaeNodeCount+t.clientFormulaeNodeCount,clientFormatsNodeCount:e.clientFormatsNodeCount+t.clientFormatsNodeCount,clientValuesNodeCount:e.clientValuesNodeCount+t.clientValuesNodeCount,recalcValuesNodeCount:e.recalcValuesNodeCount+t.recalcValuesNodeCount,recalcDirtySetSubspaceCount:e.recalcDirtySetSubspaceCount+t.recalcDirtySetSubspaceCount,recalcFailuresSetSubspaceCount:e.recalcFailuresSetSubspaceCount+t.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:e.recalcTaintSetSubspaceCount+t.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:e.availabilitySetSubspaceCount+t.availabilitySetSubspaceCount,availabilityHistorySize:e.availabilityHistorySize+t.availabilityHistorySize,hiddenRowsNodeCount:e.hiddenRowsNodeCount+t.hiddenRowsNodeCount,hiddenColsNodeCount:e.hiddenColsNodeCount+t.hiddenColsNodeCount}},t.emptyUsedRange=void 0,t.denseUsedRange=(0,m.gridRange)(0,0,d.sheetRows,g.sheetCols),t.usedRangeJoin=$,t.usedRangeIsect=Y,function(e){e[e.Server=0]="Server",e[e.Client=1]="Client"}(J||(t.CloningTarget=J={}));class X{static create(){return new X}clone(e=J.Server){const t=new X(this.serverContents,this.serverAvailability,this.serverUsed,this.hiddenRows,this.hiddenRowsAvailability,this.hiddenCols,this.hiddenColsAvailability,this.mergeCells,this.inFilterMode,this.filterModeAvailable);return e===J.Client&&(t.editedContents=this.editedContents,t.clientContents=this.clientContents,t.recalcValues=this.recalcValues,t.recalcDirty=this.recalcDirty,t.recalcFailures=this.recalcFailures,t.editedTaint=this.editedTaint,t.recalcTaint=this.recalcTaint,t.editedAvailability=this.editedAvailability),t}advanceState(e,r){this.oldAvailabilities[e]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=y.empty,this.serverUsed=t.denseUsedRange,this.hiddenRows=this.hiddenRowsAvailability=y.empty,this.hiddenCols=this.hiddenColsAvailability=y.empty,this.inFilterMode=this.filterModeAvailable=!1,this.rollBackToServerState(r)}rollBackToServerState(e){this.editedContents=this.serverContents,this.editedAvailability=this.serverAvailability,this.editedUsed=this.serverUsed,this.editedTaint=y.empty,this.rollBackToEditedState(e)}rollBackToEditedState(e){this.setClientContents(this.editedContents,e),this.recalcValues=this.editedContents.values,this.recalcFailures=y.empty,this.recalcDirty=this.editedContents.dirty,this.recalcTaint=this.editedTaint}allServerAvailable(e){return this.allAvailable(e,this.serverAvailability)}allEditedAvailable(e){return this.allAvailable(e,this.editedAvailability)}allAvailable(e,t){const r=(0,f.createCellSetFromRange)(e),n=(0,T.intersectProduct)(r,f.availableReadProduct),a=(0,T.intersectProduct)(t,n),i=(0,P.project)((0,M.exceptProduct)(n,a),"row","col"),o=(0,R.compareProduct)(a,n);return!!(void 0!==o&&o>=0)||i}forEachRecalcDirty(e,t){return(0,f.forEachCellInSet)((0,T.intersectProduct)(this.recalcDirty,(0,f.createCellSetFromRange)(e)),t)}hasRecalcDirty(e){return(0,I.meetsProduct)(this.recalcDirty,(0,f.createCellSetFromRange)(e))}hasRecalcFailure(e){return(0,I.meetsProduct)(this.recalcFailures,(0,f.createCellSetFromRange)(e))}hasEditedEditTaint(e){return(0,I.meetsProduct)(this.editedTaint,(0,f.createCellSetFromRange)(e))}hasRecalcEditTaint(e){return(0,I.meetsProduct)(this.recalcTaint,(0,f.createCellSetFromRange)(e))}getEditedUsedRange(){return this.editedUsed}getServerUsedRange(){return this.serverUsed}getServerAvailability(){return this.serverAvailability}getHiddenRows(e,t){const r=f.bspFactory.row((0,v.pair)(e,t)),a=(0,b.intersect)(this.hiddenRowsAvailability,r),i=[];(0,f.forEachRow)(a,(([e,t])=>(i.push((0,n.interval)(e,t)),!0)));const o=[];return(0,f.forEachRow)((0,b.intersect)(this.hiddenRows,a),(([e,t])=>(o.push((0,n.interval)(e,t)),!0))),{hidden:o,available:i}}tryGetHiddenRows(e,t){const r=this.getHiddenRows(e,t);return 1===r.available.length&&r.available[0].start===e&&r.available[0].end===t?(0,L.success)(r.hidden):(0,_.failure)({kind:D.UnavailableKind.HiddenRows})}setHiddenRows(e,t){const r=f.bspFactory.row((0,v.pair)(e.row,e.row+e.rows));this.hiddenRows=(0,A.union)((0,C.except)(this.hiddenRows,r),(0,b.intersect)(t,r)),this.hiddenRowsAvailability=(0,A.union)(this.hiddenRowsAvailability,r)}getHiddenCols(e,t){const r=f.bspFactory.col((0,v.pair)(e,t)),a=(0,b.intersect)(this.hiddenColsAvailability,r),i=[];(0,f.forEachCol)(a,(([e,t])=>(i.push((0,n.interval)(e,t)),!0)));const o=[];return(0,f.forEachCol)((0,b.intersect)(this.hiddenCols,a),(([e,t])=>(o.push((0,n.interval)(e,t)),!0))),{hidden:o,available:i}}tryGetHiddenCols(e,t){const r=this.getHiddenCols(e,t);return 1===r.available.length&&r.available[0].start===e&&r.available[0].end===t?(0,L.success)(r.hidden):(0,_.failure)({kind:D.UnavailableKind.HiddenCols})}setHiddenCols(e,t){const r=f.bspFactory.col((0,v.pair)(e.col,e.col+e.cols));this.hiddenCols=(0,A.union)((0,C.except)(this.hiddenCols,r),(0,b.intersect)(t,r)),this.hiddenColsAvailability=(0,A.union)(this.hiddenColsAvailability,r)}setMergeCell(e){this.mergeCells=this.mergeCells.setValue(e,!0)}getMergeCell(e){let t;return this.mergeCells.forEachGe(e,(e=>(t=e,!0))),t}isInFilterMode(){return this.filterModeAvailable?(0,L.success)(this.inFilterMode):(0,_.failure)({kind:D.UnavailableKind.InFilterMode})}setInFilterMode(e){this.inFilterMode=e,this.filterModeAvailable=!0}forEachNonBlankSetCellInSet(e,r,n,o){const s=(0,T.intersectProduct)(e,f.availableSetProduct);return(0,f.forEachRangeInSet)((0,T.intersectProduct)(n,s),(e=>o.formulae.forEachMeets(e,((n,o)=>!!(0,t.isBlankGridFormula)(o.fmla,void 0!==o.compiledFmla)||(0,a.forEachCellInRange)((0,i.gridRangeIsect)(e,n),r)))))}forEachReadableCellInSet(e,t,r){const n=(0,T.intersectProduct)(e,f.availableReadProduct);return(0,f.forEachRangeInSet)((0,T.intersectProduct)(r,n),(e=>(0,a.forEachCellInRange)(e,t)))}forEachEditedNonBlankCellInSet(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.editedAvailability,this.editedContents)}forEachServerNonBlankCellInSet(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.serverAvailability,this.serverContents)}forEachEditedCellInSet(e,t){return this.forEachReadableCellInSet(e,t,this.editedAvailability)}promoteServerAvailability(e,t){const r=(0,T.intersectProduct)(e,f.availableSetProduct),n=this.oldAvailabilities[t];if(void 0===n)return!1;const a=(0,R.compareProduct)(n,r);return void 0!==a&&a>=0&&(this.unionAvailability(!0,(0,T.intersectProduct)(e,f.availableAllProduct)),this.unionTaint(!0,y.empty),this.unionUsed(!0,(0,f.cellSetBounds)(e)),!0)}extendServerUnused(e,r){const n=e===t.emptyUsedRange?y.empty:(0,f.createCellSetFromRange)(e),a=(0,O.complementProduct)(n);let{values:i,formats:o,styles:s,formulae:u,dirty:l}=this.serverContents;(0,f.forEachRangeInSet)(a,(e=>(i.forEachLe(e,((e,r)=>(V(r.oper,r.failure)||(i=i.setValue(e,t.blankGridValue)),!0))),o.forEachLe(e,((e,r)=>((0,t.isBlankCellFormat)(r)||(o=o.setValue(e,t.blankCellFormat)),!0))),s.forEachLe(e,((e,t)=>(t!==w.SpecialStyle.Blank&&(s=s.setValue(e,w.SpecialStyle.Blank)),!0))),!0))),(0,f.forEachRangeInSet)(a,(e=>(u=H(u,e),!0))),l=(0,M.exceptProduct)(l,a),this.setContents(!0,{values:i,formats:o,styles:s,formulae:u,dirty:l},r);const c=(0,T.intersectProduct)(a,f.availableReadProduct);this.serverAvailability=this.editedAvailability=(0,k.unionProduct)(this.serverAvailability,c),this.editedTaint=this.recalcTaint=y.empty;let d=this.serverUsed;d=Y(d,e),this.serverUsed=this.editedUsed=d}setRecalcFailure(e){this.recalcFailures=(0,k.unionProduct)(this.recalcFailures,e)}setRecalcEditTaint(e){this.recalcTaint=(0,k.unionProduct)(this.recalcTaint,e)}setRecalcValue(e,t){(0,a.forEachCellInRange)(e,((e,r,n)=>(this.recalcValues=this.recalcValues.setValue(e,{oper:K(t)?t[r][n]:t,failure:void 0}),!0))),this.recalcDirty=(0,M.exceptProduct)(this.recalcDirty,(0,f.createCellSetFromRange)(e))}setClientContents(e,t){this.clientContents=e}setClientValue(e,t,r){let{values:n}=this.clientContents;(0,a.forEachCellInRange)(e,((e,r,a)=>(n=n.setValue(e,{oper:K(t)?t[r][a]:t,failure:void 0}),!0))),this.setClientContents({...this.clientContents,values:n},r)}setClientFormula(e,t,r,n){let{formulae:i}=this.clientContents;i=q(i,e),void 0!==t?i=i.setValue(t,r):(0,a.forEachCellInRange)(e,(e=>(i=i.setValue(e,r),!0))),this.setClientContents({...this.clientContents,formulae:i},n)}setClientFormat(e,t,r){let{formats:n}=this.clientContents;(0,a.forEachCellInRange)(e,(e=>(n=n.setValue(e,t),!0))),this.setClientContents({...this.clientContents,formats:n},r)}getRecalcValues(e){const{row:r,col:n,rows:a,cols:i}=e,o=new Array(a);for(let e=0;e<a;e+=1)o[e]=(0,x.arrayFill)(new Array(i),t.blankGridValue);return this.recalcValues.forEachLe(e,((e,t)=>(o[e.row-r][e.col-n]=t,!0))),o}forEachRecalcValue(e,t){return this.recalcValues.forEachMeets(e,t)}getClientValue(e){return this.clientContents.values.getValue(e)??t.blankGridValue}getServerValue(e){return this.serverContents.values.getValue(e)??t.blankGridValue}getEditedValue(e){return this.editedContents.values.getValue(e)??t.blankGridValue}forEachEditedValue(e,t){return this.editedContents.values.forEachMeets(e,t)}getServerFormula(e){return this.getFormula(e,this.serverContents.formulae)}getClientFormula(e){return this.getFormula(e,this.clientContents.formulae)}setEditedFormat(e,t){this.editedContents={...this.editedContents,formats:this.editedContents.formats.setValue(e,t)}}getEditedFormat(e){return this.editedContents.formats.getValue(e)??t.blankCellFormat}forEachEditedFormat(e,t){return this.editedContents.formats.forEachMeets(e,t)}getServerFormat(e){return this.serverContents.formats.getValue(e)??t.blankCellFormat}getEditedStyle(e){return this.editedContents.styles.getValue(e)??w.SpecialStyle.Blank}getServerStyle(e){return this.serverContents.styles.getValue(e)??w.SpecialStyle.Blank}getClientFormat(e){return this.clientContents.formats.getValue(e)??t.blankCellFormat}getEditedFormula(e){return this.getFormula(e,this.editedContents.formulae)}forEachEditedFormula(e,t){return this.editedContents.formulae.forEachMeets(e,t)}getFormula(e,r){let n;return r.forEachGe(e,((e,r)=>!!(0,t.isBlankGridFormula)(r.fmla,void 0!==r.compiledFmla)||(n=[e,r],!1))),n}setContents(e,t,r){e&&(this.serverContents=t),this.editedContents=t,e&&this.setClientContents(this.editedContents,r),this.recalcValues=this.editedContents.values,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=y.empty}unionAvailability(e,t){let r=e?this.serverAvailability:this.editedAvailability;r=(0,k.unionProduct)(r,t),e&&(this.serverAvailability=r),this.editedAvailability=r}unionTaint(e,t){this.editedTaint=e?y.empty:(0,k.unionProduct)(this.editedTaint,t),this.recalcTaint=this.editedTaint}unionUsed(e,t){let r=e?this.serverUsed:this.editedUsed;r=$(r,t),e&&(this.serverUsed=r),this.editedUsed=r}setCellContents(e,t,r,n,a,i,o,s,u){this.setCommon(e,t,void 0,r,n,a,i,o,s,u)}setRangeFormula(e,t,r,n,a,i,o,s){const u=(0,f.createCellSetFromRange)(t);this.setCommon(e,u,t,r,n,void 0,a,i,o,s)}setCommon(e,r,n,a,i,o,s,u,l,c){let{values:d,formats:g,styles:m,formulae:h,dirty:p}=e?this.serverContents:this.editedContents;const S=void 0===a&&void 0!==i||void 0!==a?.compiledFmla;let v=a;void 0!==a&&((0,f.forEachRangeInSet)(r,(e=>(h=H(h,e),!0))),(0,t.isBlankGridFormula)(a.fmla,void 0!==a.compiledFmla)&&(v=void 0));const F=void 0!==v&&void 0===n?a:void 0,b=void 0!==v&&void 0!==n?a:void 0;let C=i;void 0!==i&&V(i,o)&&((0,f.forEachRangeInSet)(r,(e=>(d.forEachLe(e,((e,r)=>(V(r.oper,r.failure)||(d=d.setValue(e,t.blankGridValue)),!0))),!0))),p=S?(0,k.unionProduct)(p,r):(0,M.exceptProduct)(p,r),C=void 0);const A=void 0!==C?{oper:C,failure:o}:void 0;let E=s;void 0!==s&&(0,t.isBlankCellFormat)(s)&&((0,f.forEachRangeInSet)(r,(e=>(g.forEachLe(e,((e,r)=>((0,t.isBlankCellFormat)(r)||(g=g.setValue(e,t.blankCellFormat)),!0))),!0))),E=void 0);const R=E===w.SpecialFormat.Weak?void 0:E,N=E===w.SpecialFormat.Weak?E:void 0;let I=u;void 0!==u&&u===w.SpecialStyle.Blank&&((0,f.forEachRangeInSet)(r,(e=>(m.forEachLe(e,((e,t)=>(t!==w.SpecialStyle.Blank&&(m=m.setValue(e,w.SpecialStyle.Blank)),!0))),!0))),I=void 0);const O=I===w.SpecialStyle.Weak?void 0:I,D=I===w.SpecialStyle.Weak?I:void 0;let L=r;if(!e){const e=(0,T.intersectProduct)(r,f.availableSetProduct),t=(0,P.project)((0,T.intersectProduct)(this.editedAvailability,e),"row","col"),n=(0,T.intersectProduct)(r,void 0!==l?(0,f.createCellSetFromRange)(l):y.empty);L=(0,k.unionProduct)(t,n)}if(void 0===F&&void 0===R&&void 0===O&&void 0===A||((0,f.forEachCellInSet)(L,(e=>(void 0!==F&&(h=j(h,e,F)),void 0!==R&&(g=g.setValue(e,R)),void 0!==O&&(m=m.setValue(e,O)),void 0!==A&&(d=d.setValue(e,A)),!0))),void 0===F&&void 0===A||(p=S?(0,k.unionProduct)(p,L):(0,M.exceptProduct)(p,L))),void 0!==b){h=j(h,n,b);const e=(0,f.createCellSetFromRange)(n);p=S?(0,k.unionProduct)(p,e):(0,M.exceptProduct)(p,e)}void 0!==N&&(g=z(g,L,e?this.serverAvailability:this.editedAvailability,w.SpecialFormat.Unavailable)),void 0!==D&&(m=function(e,t,r){const n=(0,T.intersectProduct)(t,f.availableReadProduct),a=(0,P.project)((0,T.intersectProduct)(r,n),"row","col");return(0,f.forEachCellInSet)((0,M.exceptProduct)(t,a),(t=>(e=e.setValue(t,w.SpecialStyle.Unavailable),!0))),e}(m,L,e?this.serverAvailability:this.editedAvailability));const _=void 0===i?y.empty:L,x=void 0===a?y.empty:L,K=void 0===s?y.empty:L,W=void 0===i&&void 0===s?y.empty:L;e||((0,f.forEachRangeInSet)(_,(e=>(this.setClientValue(e,t.clientValueUnknownOper,c),!0))),void 0!==a&&(void 0!==n?this.setClientFormula(n,n,a,c):(0,f.forEachRangeInSet)(x,(e=>(this.setClientFormula(e,void 0,a,c),!0)))),s===w.SpecialFormat.Weak?this.setClientContents({...this.clientContents,formats:z(this.clientContents.formats,K,this.editedAvailability,w.SpecialFormat.ClientValueUnknown)},c):(0,f.forEachRangeInSet)(K,(e=>(this.setClientFormat(e,w.SpecialFormat.ClientValueUnknown,c),!0)))),this.setContents(e,{values:d,formats:g,styles:m,formulae:h,dirty:p},c),this.unionAvailability(e,(0,T.intersectProduct)(_,f.availableAllProduct)),e||(this.editedAvailability=(0,M.exceptProduct)(this.editedAvailability,(0,M.exceptProduct)(r,L))),this.unionTaint(e,W),this.unionUsed(e,(0,f.cellSetBounds)(r))}copyRange(e){function t(t,r){return t.forEachLe(e,((e,t)=>(r=r.setValue(e,t),!0))),r}let{values:r,formats:n,styles:a,formulae:o}=Q;const{values:s,formats:u,styles:c,formulae:d}=this.editedContents;r=t(s,r),n=t(u,n),a=t(c,a),d.forEachMeets(e,((t,r)=>(o=o.setValue((0,i.gridRangeIsect)(t,e),r),!0)));const g=(0,l.gridRangeAnchor)(e),m=(0,T.intersectProduct)(this.editedAvailability,(0,f.createCellSetFromRange)(e)),h=Y(this.editedUsed,e);return{origin:g,formats:n,styles:a,values:r,formulae:o,availability:m,used:h}}pasteRange(e,r,n){const a=(0,f.createCellSetFromRange)(e),i=(0,m.gridRange)(r.origin.row,r.origin.col,e.rows,e.cols);let{values:o,formats:s,styles:u,formulae:l,dirty:c}=this.editedContents;const d=this.editedUsed,g=e.row-r.origin.row,h=e.col-r.origin.col;function p(e){return(0,m.gridRange)(e.row+g,e.col+h,e.rows,e.cols)}function S(t,r,n){return r.forEachMeets(e,((e,t)=>(r=r.setValue(e,n),!0))),t.forEachLe(i,((e,t)=>(r=r.setValue(p(e),t),!0))),r}const v=$(d,r.used!==t.emptyUsedRange?p(r.used):t.emptyUsedRange),F=Y(v,e);o=S(r.values,o,t.blankGridValue),F!==t.emptyUsedRange&&this.setClientValue(F,t.clientValueUnknownOper,n),s=S(r.formats,s,t.blankCellFormat),u=S(r.styles,u,w.SpecialStyle.Blank),F!==t.emptyUsedRange&&this.setClientFormat(F,w.SpecialFormat.ClientValueUnknown,n),l=S(r.formulae,l,t.blankCellGridFormula),c=(0,M.exceptProduct)(c,a);{let{formulae:t}=this.clientContents;t=q(t,e),l.forEachLe(e,((e,{origin:r,compiledFmla:n})=>(void 0!==n&&(c=(0,k.unionProduct)(c,(0,f.createCellSetFromRange)(e))),t=t.setValue(e,{fmla:U.ClientValueUnknown,origin:r,compiledFmla:n,hasHyperlink:W.ClientValueUnknown}),!0))),this.setClientContents({...this.clientContents,formulae:t},n)}const b=!1;var C;this.setContents(b,{values:o,formats:s,styles:u,formulae:l,dirty:c},n),this.editedAvailability=(0,M.exceptProduct)(this.editedAvailability,a),this.unionAvailability(b,(C=r.availability,(0,f.translateAvailabilitySet)(C,g,h))),this.unionTaint(b,F===t.emptyUsedRange?y.empty:(0,f.createCellSetFromRange)(F)),this.unionUsed(b,v)}assumeRecalcFinal(e,t){this.recalcDirty=(0,M.exceptProduct)(this.recalcDirty,e)}getDirtyEditedCells(){return(0,T.intersectProduct)(this.recalcDirty,this.editedTaint)}getNonDirtyEditedCells(){return(0,M.exceptProduct)(this.editedTaint,this.recalcDirty)}getDirtyDependentCells(){return(0,M.exceptProduct)(this.recalcDirty,this.editedTaint)}onCellModified(e,r){const n=e?this.serverContents:this.editedContents;this.setContents(e,n,r),this.unionAvailability(e,y.empty),this.unionTaint(e,y.empty),this.unionUsed(e,t.emptyUsedRange)}clearCompiledFormulas(){for(const e of[this.serverContents.formulae,this.editedContents.formulae])e.forEach(((e,t)=>(void 0!==t.compiledFmla&&t.compiledFmla.reset(),!0)))}getStatistics(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverStylesNodeCount:this.serverContents.styles.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),serverDirtySetSubspaceCount:(0,N.getSubspaceCount)(this.serverContents.dirty),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedStylesNodeCount:this.editedContents.styles.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),editedDirtySetSubspaceCount:(0,N.getSubspaceCount)(this.editedContents.dirty),clientFormulaeNodeCount:this.clientContents.formulae.getCount(),clientFormatsNodeCount:this.clientContents.formats.getCount(),clientValuesNodeCount:this.clientContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),recalcDirtySetSubspaceCount:(0,N.getSubspaceCount)(this.recalcDirty),recalcFailuresSetSubspaceCount:(0,N.getSubspaceCount)(this.recalcFailures),recalcTaintSetSubspaceCount:(0,N.getSubspaceCount)(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:(0,N.getSubspaceCount)(this.editedAvailability),hiddenRowsNodeCount:(0,E.getNodeCount)(this.hiddenRows)+(0,E.getNodeCount)(this.hiddenRowsAvailability),hiddenColsNodeCount:(0,E.getNodeCount)(this.hiddenCols)+(0,E.getNodeCount)(this.hiddenColsAvailability)}}collectGarbage(e,r){let n=y.empty;for(const t in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(t)){const r=Number(t);if(r>=e){n=(0,k.unionProduct)(n,this.oldAvailabilities[r]);continue}delete this.oldAvailabilities[r],this.availabilityHistorySize-=1}function a(e){return(0,I.meetsProduct)((0,T.intersectProduct)((0,f.createCellSetFromRange)(e),f.availableSetProduct),n)}function i(e,r){return!(0,t.isBlankGridFormula)(r.fmla,void 0!==r.compiledFmla)&&a(e)}function o(e,r){return!(0,t.isBlankCellFormat)(r)&&a(e)}function s(e,t){return t!==w.SpecialStyle.Blank&&a(e)}function u(e,t){return!(!B(t.oper)&&V(t.oper,t.failure))&&a(e)}const l=(0,P.project)(n,"row","col");this.serverContents={formulae:this.serverContents.formulae.filter(i),formats:this.serverContents.formats.filter(o),styles:this.serverContents.styles.filter(s),values:this.serverContents.values.filter(u),dirty:(0,T.intersectProduct)(this.serverContents.dirty,l)},this.editedContents={formulae:this.editedContents.formulae.filter(i),formats:this.editedContents.formats.filter(o),styles:this.editedContents.styles.filter(s),values:this.editedContents.values.filter(u),dirty:(0,T.intersectProduct)(this.editedContents.dirty,l)},this.setClientContents({formulae:this.clientContents.formulae.filter(i),formats:this.clientContents.formats.filter(o),values:this.clientContents.values.filter(u)},r),this.recalcValues=this.recalcValues.filter(u),this.recalcDirty=(0,T.intersectProduct)(this.recalcDirty,l)}constructor(e=Q,r=y.empty,n=t.denseUsedRange,a=y.empty,i=y.empty,o=y.empty,s=y.empty,u=(0,S.makeGridRangeTable)(),l=!1,c=!1){this.oldAvailabilities={},this.availabilityHistorySize=0,this.serverContents=e,this.serverAvailability=r,this.serverUsed=n,this.hiddenRows=a,this.hiddenRowsAvailability=i,this.hiddenCols=o,this.hiddenColsAvailability=s,this.mergeCells=u,this.inFilterMode=l,this.filterModeAvailable=c,this.rollBackToServerState(0)}}t.PartialWorkbookGrid=X},6869:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isOutputFormatUnavailable=t.OutputMessageKind=t.FormulaMode=t.SpecialStyle=t.SpecialFormat=t.SetMessageKind=t.mergeRecalcStatistics=t.RecalcStatisticsMessage=t.emptyRecalcStatistics=t.ComputedCellKind=t.ComputeKind=t.sheetInFilterMode=t.sheetHiddenRows=t.sheetUsedRange=t.createSheetCellSetFromRange=t.sheetCellSet=t.UnavailableKind=void 0;const n=r(6468),a=r(6366);var i,o,s,u,l,c,d,g,m;function h(e,t){return{sheet:e,set:t}}function p(e,t){return{...e,[t]:(e[t]??0)+1}}!function(e){e.DocumentLoc="DocumentLoc",e.SheetId="SheetId",e.SheetNames="SheetNames",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.CellStyle="CellStyle",e.HiddenRows="HiddenRows",e.HiddenCols="HiddenCols",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.EvalFailure="EvalFailure",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.StyleId="StyleId",e.FontId="FontId",e.FillId="FillId",e.BorderId="BorderId",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.TimeGranularity="TimeGranularity",e.GetTimeKind="GetTimeKind",e.ColumnName="ColumnName",e.ContainingTable="ContainingTable",e.NamedRanges="NamedRanges"}(i||(t.UnavailableKind=i={})),t.sheetCellSet=h,t.createSheetCellSetFromRange=function(e){return h(e.sheet,(0,n.createCellSetFromRange)(e.range))},t.sheetUsedRange=function(e,t){return{sheet:e,range:t}},t.sheetHiddenRows=function(e,t,r){return{sheet:e,range:t,hidden:r}},t.sheetInFilterMode=function(e,t){return{sheet:e,inFilterMode:t}},function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.EvalFormula="EvalFormula",e.ParseEdit="ParseEdit"}(o||(t.ComputeKind=o={})),function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"}(s||(t.ComputedCellKind=s={})),t.emptyRecalcStatistics={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0},function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"}(u||(t.RecalcStatisticsMessage=u={})),t.mergeRecalcStatistics=function(e,t){switch(t.message){case u.ChangedCell:return{...e,changedCellCount:p(e.changedCellCount,t.cellKind),calculatedCellCount:p(e.calculatedCellCount,t.cellKind)};case u.UnchangedCell:return{...e,calculatedCellCount:p(e.calculatedCellCount,t.cellKind)};case u.ContinueComputation:return{...e,continueCount:e.continueCount+1};case u.StateTimedOut:return{...e,stateTimedOut:!0};case u.EditFinished:return{...e,editFinishedCount:e.editFinishedCount+1};case u.RecalcFinished:return{...e,recalcFinishedCount:e.recalcFinishedCount+1};default:return(0,a.assertNever)("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",t)}},function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(l||(t.SetMessageKind=l={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Aggregate="Aggregate",e.Inferred="Inferred",e.Known="Known",e.Edit="Edit"}(c||(t.SpecialFormat=c={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.Blank="Blank"}(d||(t.SpecialStyle=d={})),function(e){e.EvalFormula="eval-formula",e.ServerCellFormula="server-cell-formula",e.EditCellFormula="edit-cell-formula",e.ServerNamedFormula="server-named-formula",e.EditNamedFormula="edit-named-formula"}(g||(t.FormulaMode=g={})),function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.NumberFormatFailure="NumberFormatFailure",e.PrintFormulaFailure="PrintFormulaFailure",e.InferFormatFailure="InferFormatFailure",e.FormatValueFailure="FormatValueFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.Alert="Alert",e.RecalcStatistics="RecalcStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"}(m||(t.OutputMessageKind=m={})),t.isOutputFormatUnavailable=function(e){return"object"==typeof e}},6448:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookNameManager=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6366),d=r(6366),g=r(6366),m=r(6366),h=r(6366),p=r(6366),f=r(6366),S=r(6067),v=r(6067),F=r(6067),y=r(6366),b=r(6933),C=r(6067),A=r(6067),E=r(6366),T=r(6869);class R{clone(){let e;if(this.sheetScopedNames){e=(0,c.makeStringMap)();for(const t in this.sheetScopedNames){const r=this.sheetScopedNames[t];e[t]=r.clone()}}return new R(this.document,this.stringCompareCI,e,void 0,this.globalNames.clone())}setNamedObject(e,t,r,a){const i=this.getNameFormula(t,n.NameSource.StructRef);void 0!==r&&"NamedTable"===r.kind&&(0,f.isSuccess)(i)&&void 0!==i.value&&"NamedTable"===i.value.obj.kind&&(0,b.isNamedTableRangeEqual)(i.value.obj,r)&&(r=(0,b.mergeNamedTables)(i.value.obj,r));const o=this.getNamesBySheetId(t.scope.index);return o.kind===h.ResultKind.Failure?o:o.value.setNamedObject(e,t,r,a,this.onWriteNamedObject)}setUndefinedNames(e){const t=this.getNamesBySheetId(e.index);return t.kind===h.ResultKind.Failure?t:(0,g.success)(t.value.setUndefinedNames())}promoteNamedObjects(e,t){const r=this.getNamesBySheetId(e.index);return r.kind===h.ResultKind.Failure?r:r.value.promoteNamedObjects(t,this.onWriteNamedObject)}setSheetNames(e){const t=this.sheetScopedNames??this.oldSheetScopedNames,r=(0,c.makeStringMap)();for(const{sheetId:n}of e)r[n]=t?.[n]??new b.PartialWorkbookNames(this.stringCompareCI,(0,i.sheetIndex)(this.document,n));return new R(this.document,this.stringCompareCI,r,void 0,this.globalNames)}getNameLoc(e,t,r){const n=this.getNamesBySheetId(e);if(n.kind===h.ResultKind.Failure)return n;const a=n.value.getNameLoc(t,r);return a.kind,h.ResultKind.Failure,a}getAvailableNamesInScope(e){const t=this.getAllDocumentNames(),r=this.getNamesBySheetId(e);return r.kind===h.ResultKind.Success&&(0,d.safePush)(t,r.value.getAvailableNames((0,l.nameScope)(this.document,e))),t}getAllDocumentNames(){return this.globalNames.getAvailableNames((0,a.documentScope)(this.document))}getAvailableTableColumns(e){const t=this.getNameFormula(e,n.NameSource.StructRef),r=[];if(t.kind!==h.ResultKind.Success||void 0===t.value||"NamedTable"!==t.value.obj.kind)return{cols:r,isPartial:!0};const a=!t.value.obj.allColumnNamesAvailable;return t.value.obj.columnNames.forEach((e=>(r.push(e),!0))),{cols:r,isPartial:a}}getNameFormula(e,t){const r=this.getNamesBySheetId(e.scope.index);return r.kind===h.ResultKind.Failure?r:r.value.getNameFormula(e.name,t)}hasRecalcNameFailure(e){const t=this.getNamesBySheetId(e.scope.index);return t.kind===h.ResultKind.Failure?t:(0,g.success)(t.value.hasRecalcFailure(e.name))}setRecalcNameFailure(e){const t=this.getNamesBySheetId(e.scope.index);return t.kind===h.ResultKind.Failure?t:(0,g.success)(t.value.setRecalcFailure(e.name))}getNamesBySheetId(e){if(void 0===e)return(0,g.success)(this.globalNames);if(!this.sheetScopedNames)return(0,m.failure)((0,F.unavailable)([{kind:T.UnavailableKind.SheetNames}]));const t=this.sheetScopedNames[e];return void 0===t?(0,m.failure)((0,F.unavailable)([{kind:T.UnavailableKind.SheetId,document:this.document,sheetId:e}])):(0,g.success)(t)}getContainingTable(e){const t=this.getNamesBySheetId(e.sheet.index);return t.kind===h.ResultKind.Failure?t:(0,g.success)(t.value.getContainingTable(e.range))}getNamedRanges(e){const t=this.getNamesBySheetId(e.sheet.index);return t.kind===h.ResultKind.Failure?t:(0,g.success)(t.value.getNamedRanges(e.range))}getIntersectingTables(e){const t=this.getNamesBySheetId(e.sheet.index);return t.kind===h.ResultKind.Failure?t:(0,g.success)(t.value.getIntersectingTables(e.range))}getStructRefColumn(e,t){const r=this.getNameFormula(e,n.NameSource.StructRef);if(r.kind===h.ResultKind.Failure)return r;if(void 0===r.value)return(0,g.success)(void 0);if("NamedTable"!==r.value.obj.kind)return(0,m.failure)((0,C.invalidStructRef)(A.InvalidStructRefReason.NamedObjectNotTable));const a=r.value.obj;let i;if("string"==typeof t)i=a.columnNames.getEntry(t);else{const e=a.columnIndexes.getValue(t);i=void 0===e?void 0:(0,E.entry)(e,t)}if(void 0===i)return a.allColumnNamesAvailable?(0,g.success)(void 0):(0,m.failure)((0,F.unavailable)([{kind:T.UnavailableKind.ColumnName,table:e,columnNameOrIndex:t}]));const{sheet:l,range:c}=a.specialRefRanges[S.SpecialRefId.Data],d=(0,o.sheetGridRange)(l,(0,s.gridRange)(c.row,i.value,c.rows,1));return(0,g.success)((0,u.structRefColumnLoc)(i.key,d,a.hasHeadersRow,a.hasTotalsRow))}getStructRefSpecialRef(e,t){const r=this.getNameFormula(e,n.NameSource.StructRef);return r.kind===h.ResultKind.Failure?r:void 0===r.value?(0,g.success)(void 0):"NamedTable"!==r.value.obj.kind?(0,m.failure)((0,C.invalidStructRef)(A.InvalidStructRefReason.NamedObjectNotTable)):(0,g.success)(r.value.obj.specialRefRanges[t])}onCellModified(e){this.forEachSheetScope((t=>{t.onCellModified(e)})),this.globalNames.onCellModified(e)}collectGarbage(e){this.forEachSheetScope((t=>{t.collectGarbage(e)})),this.globalNames.collectGarbage(e)}advanceState(e){this.forEachSheetScope((t=>{t.advanceState(e)})),this.globalNames.advanceState(e),this.oldSheetScopedNames=this.sheetScopedNames,this.sheetScopedNames=void 0}resetLazyData(){this.forEachSheetScope((e=>{e.resetLazyData()})),this.globalNames.resetLazyData()}getNameStatistics(){let e=this.globalNames.getStatistics();return this.forEachSheetScope((t=>e=(0,b.mergeNameStatistics)(e,t.getStatistics()))),e}forEachSheetScope(e){for(const t in this.sheetScopedNames)Object.prototype.hasOwnProperty.call(this.sheetScopedNames,t)&&e(this.sheetScopedNames[t])}constructor(e,t,r,n,i){this.document=e,this.stringCompareCI=t,this.sheetScopedNames=r,this.oldSheetScopedNames=n,this.onWriteNamedObject=(e,t,r)=>{if("NamedRange"===t.kind){const n=t.value;(0,y.assertTrue)("calc.calc.PartialWorkbookDocument.onWriteNamedObject: bad range",(0,v.isDocumentLocEqual)(t.value.sheets.document,e.scope.document));const a=this.getNamesBySheetId(n.sheets.index);if(a.kind===h.ResultKind.Failure)return a;a.value.onWriteNamedRange(e,t,r)}if("NamedTable"===t.kind){const n=this.getNamesBySheetId(t.specialRefRanges[S.SpecialRefId.All].sheet.index);if(n.kind===h.ResultKind.Failure)return n;n.value.onWriteNamedTable(e,t,r)}return p.successUndefined},this.globalNames=i??new b.PartialWorkbookNames(t,(0,a.documentScope)(e))}}t.PartialWorkbookNameManager=R},6933:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookNames=t.isNamedTableRangeEqual=t.mergeNameStatistics=t.emptyNameStatistics=t.namedFailure=t.namedFormula=t.mergeNamedTables=t.namedTable=t.namedRange=t.namedValue=void 0;const n=r(6366),a=r(6067),i=r(6067),o=r(6067),s=r(6366),u=r(637),l=r(6366),c=r(6366),d=r(6366),g=r(6366),m=r(6366),h=r(6366),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6366),b=r(6067),C=r(6869);t.namedValue=(0,s.typedInstanceCreator)()((e=>({kind:"NamedValue",value:e}))),t.namedRange=(0,s.typedInstanceCreator)()((e=>({kind:"NamedRange",value:e})));const A=l.RedBlackMapTree.create(((e,t)=>e-t));t.namedTable=function(e,t,r,n,a){const{sheet:s,range:u}=e,c=t?(0,o.gridRange)(u.row-1,u.col,1,u.cols):void 0,d=r?(0,o.gridRange)(u.row+u.rows,u.col,1,u.cols):void 0,g=(0,v.gridRangeJoinOpt)((0,v.gridRangeJoinOpt)(c,e.range),d),m=n.reduce(((t,r)=>((0,y.assertTrue)("calc.calc.namedTable: column names in range",r.column>=e.range.col&&r.column<e.range.col+e.range.cols),t.setValue(r.column,r.name))),A);let h=l.RedBlackMapTree.create(a);m.forEach(((e,t)=>(h=h.setValue(t,e),!0)));const f=m.getCount()===e.range.cols;return{kind:"NamedTable",specialRefRanges:{[p.SpecialRefId.Data]:e,[p.SpecialRefId.Headers]:c?(0,i.sheetGridRange)(s,c):void 0,[p.SpecialRefId.Totals]:d?(0,i.sheetGridRange)(s,d):void 0,[p.SpecialRefId.All]:(0,i.sheetGridRange)(s,g)},columnNames:h,columnIndexes:m,allColumnNamesAvailable:f,hasHeadersRow:t,hasTotalsRow:r}},t.mergeNamedTables=function(e,t){let r=e.columnNames,n=e.columnIndexes;t.columnIndexes.forEach(((t,n)=>{const a=e.columnIndexes.getValue(t);return void 0!==a&&(r=r.remove(a)),!0})),t.columnIndexes.forEach(((e,t)=>(r=r.setValue(t,e),n=n.setValue(e,t),!0)));const a=n.getCount()===t.specialRefRanges[p.SpecialRefId.All].range.cols;return{...t,columnNames:r,columnIndexes:n,allColumnNamesAvailable:a}},t.namedFormula=(0,s.typedInstanceCreator)()((e=>({kind:"NamedFormula",fmla:e}))),t.namedFailure=(0,s.typedInstanceCreator)()(((e,t)=>({kind:"NamedFailure",failureReason:e,objectKind:t})));const E=(0,b.makeGridRangeTable)(),T=(0,b.makeGridRangeTable)();t.emptyNameStatistics={namesCount:0,tablesCount:0,rangesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0},t.mergeNameStatistics=function(e,t){return{namesCount:e.namesCount+t.namesCount,tablesCount:e.tablesCount+t.tablesCount,rangesCount:e.rangesCount+t.rangesCount,recalcFailuresCount:e.recalcFailuresCount+t.recalcFailuresCount,scopes:e.scopes+t.scopes,allAvailableScopes:e.allAvailableScopes+t.allAvailableScopes}},t.isNamedTableRangeEqual=function(e,t){return(0,f.isSheetGridRangeEqual)(e.specialRefRanges[p.SpecialRefId.Data],t.specialRefRanges[p.SpecialRefId.Data])&&e.hasHeadersRow===t.hasHeadersRow&&e.hasTotalsRow===t.hasTotalsRow};class R{static create(e){return new R(l.RedBlackMapTree.create(e),!1,E,T)}update(e,t,r,n){return e!==this.names||t!==this.allAvailable||r!==this.tables||n!==this.ranges?new R(e,t,r,n):this}getEntry(e,t,r){const n=this.names.getEntry(t);return void 0===n?this.allAvailable?(0,c.success)(void 0):(0,d.failure)((0,F.unavailable)([{kind:C.UnavailableKind.NameLoc,name:(0,a.nameLoc)(e,t),source:r}])):(0,c.success)(!1!==n.value?n:void 0)}getEntryIfDefined(e){const t=this.names.getEntry(e);if(void 0!==t)return!1!==t.value?t:void 0}setValue(e,t){return this.update(this.names.setValue(e,t),this.allAvailable,this.tables,this.ranges)}remove(e){return this.update(this.allAvailable?this.names.remove(e):this.names.setValue(e,!1),this.allAvailable,this.tables,this.ranges)}getContainingTable(e){let t;return this.tables.forEachGe(e,((e,r)=>(t=r,!1))),t}getIntersectingTables(e){const t=[];return this.tables.forEachMeets(e,((e,r)=>(t.push(r),!0))),t}getNamedRanges(e){return this.ranges.getValue(e)??[]}getAvailableNames(e){const t=[];return this.names.forEach(((r,n)=>(!1!==n&&t.push((0,a.nameLoc)(e,r)),!0))),t}forEachAvailableName(e){return this.names.forEach(((t,r)=>e(t,!1===r?void 0:r)))}setUndefined(){return this.update(this.names,!0,this.tables,this.ranges)}getStatistics(e){return{namesCount:this.names.getCount(),tablesCount:this.tables.getCount(),rangesCount:this.ranges.getCount(),recalcFailuresCount:e,scopes:1,allAvailableScopes:this.allAvailable?1:0}}collectGarbage(){return this.update(this.allAvailable?this.names.filter(((e,t)=>!1!==t)):this.names,this.allAvailable,this.tables,this.ranges)}resetLazyData(){this.names.forEach(((e,t)=>(!1!==t&&t.lazyData.reset(),!0)))}onWriteNamedTable(e,t,r){const n=t.specialRefRanges[p.SpecialRefId.All].range;return this.update(this.names,this.allAvailable,"remove"===r?this.tables.remove(n):this.tables.setValue(n,e),this.ranges)}onWriteNamedRange(e,t,r){const n=t.value.ranges[0],a=this.ranges.getValue(n)??[],i="remove"===r?a.filter((t=>(0,S.isNameScopeEqual)(e.scope,t.scope)&&e.name===t.name)):[...a,e];return this.update(this.names,this.allAvailable,this.tables,0===i.length?this.ranges.remove(n):this.ranges.setValue(n,i))}constructor(e,t,r,n){this.names=e,this.allAvailable=t,this.tables=r,this.ranges=n}}class k{clone(){const e=new k(this.stringCompareCI,this.scope);return e.contents=this.contents,e}advanceState(e){this.oldContents=this.contents,this.oldStateId=this.isCurrent?e:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures}getStatistics(){return this.contents.getStatistics(this.recalcFailures.getCount())}collectGarbage(e){void 0===this.oldStateId||this.oldStateId<e?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()}getNameLoc(e,t){const r=this.contents.getEntry(this.scope,e,t);return(0,g.isSuccess)(r)?(0,c.success)(void 0!==r.value?(0,a.nameLoc)(this.scope,r.value.key):void 0):r}getNameFormula(e,t){const r=this.contents.getEntry(this.scope,e,t);return(0,g.isSuccess)(r)?(0,c.success)(void 0!==r.value?r.value.value:void 0):r}getContainingTable(e){return this.contents.getContainingTable(e)}getIntersectingTables(e){return this.contents.getIntersectingTables(e)}getNamedRanges(e){return this.contents.getNamedRanges(e)}allAvailable(){return this.contents.allAvailable}getAvailableNames(e){return this.contents.getAvailableNames(e)}hasRecalcFailure(e){return this.recalcFailures.contains(e)}setRecalcFailure(e){this.recalcFailures=this.recalcFailures.setValue(e,!0)}onCellModified(e){this.recalcFailures=this.emptyRecalcFailures}resetLazyData(){this.contents.resetLazyData(),this.oldContents!==this.contents&&this.oldContents.resetLazyData()}setNamedObject(e,t,r,n,i){const o=this.contents.getEntryIfDefined(t.name);if(void 0!==o){const e=i((0,a.nameLoc)(this.scope,o.key),o.value.obj,"remove");if(e.kind===m.ResultKind.Failure)return e}if(this.contents=void 0===r?this.contents.remove(t.name):this.contents.setValue(t.name,{obj:r,lazyData:new u.ResettableLazy((()=>n(e,t,r)))}),this.isCurrent=this.isChanged=!0,void 0!==r){const e=i(t,r,"add");if(e.kind===m.ResultKind.Failure)return e}return h.successUndefined}setUndefinedNames(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0}promoteNamedObjects(e,t){if(this.isChanged||e!==this.oldStateId)return(0,c.success)(!1);this.contents=this.oldContents,this.isCurrent=!0;let r=(0,c.success)(!0);return this.contents.forEachAvailableName(((e,n)=>{if(void 0===n)return!0;const i=t((0,a.nameLoc)(this.scope,e),n.obj,"add");return i.kind===m.ResultKind.Success||(r=i,!1)})),r}onWriteNamedTable(e,t,r){this.contents=this.contents.onWriteNamedTable(e,t,r)}onWriteNamedRange(e,t,r){this.contents=this.contents.onWriteNamedRange(e,t,r)}forEachAvailableName(e){return this.contents.forEachAvailableName(e)}constructor(e,t){this.stringCompareCI=e,this.scope=t,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=R.create(e),this.emptyRecalcFailures=this.recalcFailures=n.ArrayMapTree.create(e)}}t.PartialWorkbookNames=k},6468:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.translateAvailabilitySet=t.forEachCellInSet=t.forEachRangeInSet=t.forEachCol=t.forEachRow=t.availableAllProduct=t.availableReadProduct=t.availableSetProduct=t.cellSetBounds=t.createCellSetFromRange=t.bspFactory=t.availabilityOperations=t.anyAvailability=t.AvailabilityKind=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6366),u=r(9207),l=r(9207),c=r(9207),d=r(9207),g=r(9207),m=r(9207),h=r(4759),p=r(5013),f=r(5013),S=r(5013);var v;!function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"}(v||(t.AvailabilityKind=v={})),t.anyAvailability=[v.AvailableSet,v.AvailableRead+1];const F=[0,a.sheetRows],y=[0,i.sheetCols];t.availabilityOperations=(0,h.boundedParetoSetOperations)(1,t.anyAvailability[0]+1,t.anyAvailability[1],t.anyAvailability,"Availability operations, alpha = 1");const b=(0,h.boundedParetoSetOperations)(.2,F[0]+1,F[1],F,"Row operations, alpha = 0.2"),C=(0,h.boundedParetoSetOperations)(.35,y[0]+1,y[1],y,"Col operations, alpha = 0.35"),A={availability:t.availabilityOperations,row:b,col:C};function E(e,t){return e!==c.dense?(0,l.forEachKey)(e,t):t(A.row.top)}function T(e,t){return e!==c.dense?(0,l.forEachKey)(e,t):t(A.col.top)}function R(e,t){return(0,f.forEachProduct)(e,(e=>E(e.row,(r=>{const[a,i]=r;return T(e.col,(e=>{const[r,o]=e;return t((0,n.gridRange)(a,r,i-a,o-r))}))}))),"row","col")}t.bspFactory={availability:(0,u.createFromKey)(A.availability),row:(0,u.createFromKey)(A.row),col:(0,u.createFromKey)(A.col)},t.createCellSetFromRange=function(e){return(0,p.createFromProduct)({row:t.bspFactory.row([e.row,e.row+e.rows]),col:t.bspFactory.col([e.col,e.col+e.cols])})},t.cellSetBounds=function(e){if(e===d.empty)return;const t=e===c.dense?void 0:e.root.bounds.row,r=e===c.dense?void 0:e.root.bounds.col,[a,i]=void 0===t?A.row.top:function(e){const t=[];return E(e,(e=>(t.push(e),!0))),t.reduce(s.ivlJoin)}((0,g.fromUntyped)(A.row,t)),[o,u]=void 0===r?A.col.top:function(e){const t=[];return T(e,(e=>(t.push(e),!0))),t.reduce(s.ivlJoin)}((0,g.fromUntyped)(A.col,r));return(0,n.gridRange)(a,o,i-a,u-o)},t.availableSetProduct=(0,p.createFromProduct)({availability:t.bspFactory.availability([v.AvailableSet,v.AvailableSet+1])}),t.availableReadProduct=(0,p.createFromProduct)({availability:t.bspFactory.availability([v.AvailableRead,v.AvailableRead+1])}),t.availableAllProduct=(0,p.createFromProduct)({availability:t.bspFactory.availability([v.AvailableSet,v.AvailableRead+1])}),t.forEachRow=E,t.forEachCol=T,t.forEachRangeInSet=R,t.forEachCellInSet=function(e,t){return R(e,(e=>(0,o.forEachCellInRange)(e,t)))},t.translateAvailabilitySet=function(e,r,n){let a=d.empty;return(0,f.forEachProduct)(e,(e=>{let i=d.empty;E(e.row,(([e,n])=>(i=(0,m.union)(i,t.bspFactory.row([e+r,n+r])),!0)));let o=d.empty;T(e.col,(([e,r])=>(o=(0,m.union)(o,t.bspFactory.col([e+n,r+n])),!0)));const s=(0,p.createFromProduct)({row:i,col:o,availability:e.availability});return a=(0,S.unionProduct)(a,s),!0}),"row","col","availability"),a}},8713:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookSheets=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6067),u=r(6067),l=r(6366),c=r(6366),d=r(6366),g=r(6067),m=r(6869);class h{clone(){return new h(this.document,this.stringCompareCI,this.sheetPosToId,this.sheetNameToId,this.data,void 0)}setSheetNames(e){const t=this.data??this.oldData,r=(0,o.makeStringMap)(),a=[],i=[];for(let n=0;n<e.length;n+=1){const{sheetName:o,sheetId:u}=e[n];a[n]=u,i.push([o,u]);const l=t?.[u];if(void 0===l){const e=(0,s.sheetIndex)(this.document,u);r[u]={pos:n,name:o,sheetIndex:e}}else r[u]={...l,pos:n,name:o}}const u=n.ArrayMapTree.create(this.stringCompareCI).setValues(i);return new h(this.document,this.stringCompareCI,a,u,r,void 0)}advanceState(e){this.oldData=this.data,this.sheetPosToId=void 0,this.sheetNameToId=void 0,this.data=void 0}getSheetRangeIds(e){let t,r;if(!this.sheetPosToId)return(0,d.failure)((0,g.unavailable)([{kind:m.UnavailableKind.SheetNames}]));if(void 0===e.index)t=0,r=this.sheetPosToId.length;else{const n=this.getSheetById(e.index);if(!(0,c.isSuccess)(n))return n;const o=this.getSheetById(e.index2);if(!(0,c.isSuccess)(o))return o;t=(0,a.fastMin)(n.value.pos,o.value.pos),r=(0,i.fastMax)(n.value.pos,o.value.pos)+1}const n=[];for(let e=t;e<r;e+=1)n.push(this.sheetPosToId[e]);return(0,l.success)((0,u.sheetRangeIndexes)(n,t))}getSheetById(e){if(!this.data)return(0,d.failure)((0,g.unavailable)([{kind:m.UnavailableKind.SheetNames}]));const t=this.data[e];return void 0===t?(0,d.failure)((0,g.unavailable)([{kind:m.UnavailableKind.SheetId,document:this.document,sheetId:e}])):(0,l.success)(t)}getSheetByName(e){if(!this.sheetNameToId)return(0,d.failure)((0,g.unavailable)([{kind:m.UnavailableKind.SheetNames}]));const t=this.sheetNameToId.getValue(e);return void 0===t?(0,l.success)(void 0):this.getSheetById(t)}forEachSheet(e){if(this.sheetPosToId&&this.data)for(const t of this.sheetPosToId){const r=this.data[t];r&&e(r,t)}}constructor(e,t,r,n,a,i){this.document=e,this.stringCompareCI=t,this.sheetPosToId=r,this.sheetNameToId=n,this.data=a,this.oldData=i}}t.PartialWorkbookSheets=h},5775:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookStyles=t.blankStyleValue=void 0;const n=r(6366),a=r(6366),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6869),m={type:d.BorderLineType.None,color:{argb:"00000000"}};t.blankStyleValue={font:{name:"Calibri",bold:!1,italic:!1,underline:c.FontUnderline.None,strikethrough:!1,verticalAlign:l.FontVerticalAlignment.None,size:11,color:{argb:"ff000000"}},fill:{kind:s.FillKind.Pattern,pattern:u.PatternType.None,fgColor:{argb:"00000000"},bgColor:{argb:"00000000"}},border:{top:m,bottom:m,left:m,right:m},alignment:{horizontal:i.HorizontalAlignment.Automatic,vertical:o.VerticalAlignment.Bottom,textRotation:0,wrapText:!1,indent:0,relativeIndent:0,shrinkToFit:!1,readingOrder:0}};class h{clone(){function e(e,t){Object.keys(e).map(Number).forEach((r=>{t[r]=e[r]}))}const t=new h;return e(this.styles,t.styles),e(this.fonts,t.fonts),e(this.fills,t.fills),e(this.borders,t.borders),t}resolveCellStyle(e){if(e===g.SpecialStyle.Blank)return(0,n.success)(t.blankStyleValue);const r=this.styles[e];if(void 0===r)return(0,a.failure)({kind:g.UnavailableKind.StyleId,styleId:e});const{fontId:i,fillId:o,borderId:s,alignment:u}=r,l=void 0!==i?this.fonts[i]:t.blankStyleValue.font;if(void 0===l)return(0,a.failure)({kind:g.UnavailableKind.FontId,fontId:i});const c=void 0!==o?this.fills[o]:t.blankStyleValue.fill;if(void 0===c)return(0,a.failure)({kind:g.UnavailableKind.FillId,fillId:o});const d=void 0!==s?this.borders[s]:t.blankStyleValue.border;return void 0===d?(0,a.failure)({kind:g.UnavailableKind.BorderId,borderId:s}):(0,n.success)({font:l,fill:c,border:d,alignment:u})}setStyles(e,t){t||(this.styles=[]),Object.keys(e).map(Number).forEach((t=>{this.styles[t]=e[t]}))}setFonts(e,t){t||(this.fonts=[]),Object.keys(e).map(Number).forEach((t=>{this.fonts[t]=e[t]}))}setFills(e,t){t||(this.fills=[]),Object.keys(e).map(Number).forEach((t=>{this.fills[t]=e[t]}))}setBorders(e,t){t||(this.borders=[]),Object.keys(e).map(Number).forEach((t=>{this.borders[t]=e[t]}))}constructor(){this.styles=[],this.fonts=[],this.fills=[],this.borders=[]}}t.PartialWorkbookStyles=h},3725:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityScheduler=t.QueuePos=void 0;const n=r(6366);var a;!function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"}(a||(t.QueuePos=a={})),t.PriorityScheduler=class{deleteTasks(e,t){const r=this.taskDeqs[e];if(!r)return;let n;for(;n=r.popFront();)"function"!=typeof n&&n.onDeleted&&n.onDeleted(t)}addTask(e,t,r){const i=this.taskDeqs[e]??(this.taskDeqs[e]=new n.Deque);t===a.Back?i.pushBack(r):i.pushFront(r),e<this.minPriority&&(this.minPriority=e)}runTask(){for(let e=this.minPriority;e<this.taskDeqs.length;e+=1){this.minPriority=e;const t=this.taskDeqs[e]?.popFront();if(t)return"function"==typeof t?t():t.onRun(),!0}return!1}getCount(e){return void 0!==e?this.taskDeqs[e]?.getCount()??0:this.taskDeqs.reduce(((e,t)=>t?e+t.getCount():e),0)}constructor(){this.minPriority=0,this.taskDeqs=[]}}},7753:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recalcServiceInsideInit=t.RecalcServiceImpl=void 0;const n=r(3345).__importStar(r(4067)),a=r(4068),i=r(6366),o=r(6366),s=r(6366),u=r(6366),l=r(6366),c=r(6067),d=r(6067),g=r(429),m=r(6468),h=r(1585),p=r(2393),f=r(6869),S=r(6067),v=r(6067),F=r(9207),y=r(5013),b=r(6366),C=r(6366),A=r(6366),E=r(6366),T=r(8073),R=r(6366),k=r(3519),N=r(6366),I=r(6366),O=r(3319),P=r(1172),M=r(6366),D=r(6366),w=r(6366),L=r(6366),_=r(6366),x=r(941),K=r(222),W=r(8072),U=r(637),G=r(5405);class B{setOutputStateId(e){e<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=e)}pushCellWrite(e,t){(e!==f.ComputedCellKind.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)}pushRangeWrite(e,t){(0,u.safePush)(e!==f.ComputedCellKind.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas,t)}pushRangeFailure(e,t){(e!==f.ComputedCellKind.DependentCell?this.editedRangeFailures:this.dependentRangeFailures).push(t)}pushUpdateRequest(e){this.rangeUpdateRequests.push(e)}pushUpdateNameRequest(e){this.namesUpdateRequests.push(e.index)}pushRecalcFinished(e){this.recalcFinished=this.recalcFinished||e}isRecalcFinished(){return this.recalcFinished}flush(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest((0,g.updateRequest)(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.editedRangeFailures.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,[],this.editedRangeFailures),this.editedRangeDeltas=[],this.editedRangeFailures=[]),(this.dependentRangeDeltas.length>0||this.dependentRangeFailures.length>0)&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[],this.dependentRangeFailures),this.dependentRangeDeltas=[],this.dependentRangeFailures=[]),this.recalcFinished&&(this.onRecalcResults((0,g.recalcResults)(this.currentOutputStateId,"Dependents",!0,[],[],[])),this.recalcFinished=!1)}sendRecalcResults(e,t,r,n){for(let a=0;a<(0,s.fastMax)((0,s.fastMax)(t.length,r.length),n.length);a+=10)this.onRecalcResults((0,g.recalcResults)(this.currentOutputStateId,e,!1,t.slice(a,a+10),r.slice(a,a+10),n.slice(a,a+10)))}constructor(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.currentOutputStateId=r,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.editedRangeFailures=[],this.dependentRangeFailures=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.recalcFinished=!1}}function V({kind:e}){return{kind:e}}class j{get document(){return this.dataTransformer.document}get mathpack(){return this.dataTransformer.getLangConfig().mathpack}ping(){}setInputStateId(e,t){const r=e-this.currentInputStateId;return r<0?(this.logInputStateIdDecrease(t),!1):(0!==r&&(this.flushInputLogs(),this.currentInputStateId=e),!0)}setOutputStateId(e){const t=e-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(0!==t&&(this.flushOutputLogs(),this.currentOutputStateId=e),!0)}clearAsyncResumeRecalc(){void 0!==this.recalcLoop&&this.recalcLoop.stop()}resumeRecalc(){this.flushInputLogs(),this.clearAsyncResumeRecalc(),this.recalcLoop=this.asyncLoopFactory((()=>{const{messages:e,queueEmpty:t}=this.dataModel.step();return e.length>0&&this.processRecalcResults(e),t?void 0:1}),{costThreshold:1,timeThreshold:this.config.yieldIntervalMs});const e=this.recalcLoop;return(0,N.promiseFinally)(this.recalcLoop.promise,(()=>{this.recalcLoop===e&&(this.recalcLoop=void 0)}))}async testResumeRecalc(e){if(await this.resumeRecalc(),void 0!==e){const t=`calc.calc.RecalcService: resumeRecalc finished; resumeId = ${e}`;C.ulsLogger.ULS.traceTag(574128980,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,t)}}processRecalcResults(e){const t=new B(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId);for(const r of e)if(r.kind!==f.OutputMessageKind.GarbageCollected)if(r.kind!==f.OutputMessageKind.Alert)if(r.kind!==f.OutputMessageKind.ExperimentRunResult){if(this.setOutputStateId(r.stateId))switch(t.setOutputStateId(r.stateId),r.kind){case f.OutputMessageKind.CellWrite:{const{cell:e,value:n,format:a,cellKind:o,formulaBarText:s,formatted:u,hasHyperlink:l}=r,{sheet:c,range:d}=e,g=this.cellWriteToRangeDelta(c.index,d.row,d.col,n,a,s,u,l,"messages.<index>.value");(0,i.isDefined)(g)&&t.pushCellWrite(o,g);break}case f.OutputMessageKind.RangeWrite:{const{range:e,values:n,cellKind:a,formulaBarText:i,formatted:o,formats:s}=r,{sheet:u,range:l}=e;t.pushRangeWrite(a,this.rangeWriteToRangeDeltas(u.index,l,n,s,i,o,"messages.<index>.values"));break}case f.OutputMessageKind.NameFailure:this.nameFailures.push(r);break;case f.OutputMessageKind.RangeFailure:{const{range:e,cellKind:n,reason:a}=r;t.pushRangeFailure(n,this.rangeFailure(e,a)),this.rangeFailures.push(r);break}case f.OutputMessageKind.NumberFormatFailure:this.numberFormatFailures.push(r);break;case f.OutputMessageKind.PrintFormulaFailure:this.printFormulaFailures.push(r);break;case f.OutputMessageKind.InferFormatFailure:this.inferFormatFailures.push(r);break;case f.OutputMessageKind.FormatValueFailure:{const{range:e,cellKind:n,reason:a}=r;t.pushRangeFailure(n,this.rangeFailure(e,a)),this.formatValueFailures.push(r);break}case f.OutputMessageKind.UnhandledFailure:this.unhandledFailures.push(r);break;case f.OutputMessageKind.UpdateRequest:t.pushUpdateRequest((0,K.sheetGridRangeToLocation)(r.range));break;case f.OutputMessageKind.UpdateNamesRequest:t.pushUpdateNameRequest(r.scope);break;case f.OutputMessageKind.RecalcStatistics:t.pushRecalcFinished(r.message===f.RecalcStatisticsMessage.RecalcFinished),this.recalcStatistics=(0,f.mergeRecalcStatistics)(this.recalcStatistics,r);break;case f.OutputMessageKind.WorkbookStatistics:this.logWorkbookStats(r.stateId,r.stats,r.p);break;case f.OutputMessageKind.StateAdvanced:break;default:return(0,b.assertNever)("calc.calc.RecalcServiceImpl.processRecalcResults",r)}}else this.logExperimentRunResult(r.experimentName,JSON.stringify({message:r.logMessage,timeoutReason:r.timeoutReason}));else this.onAlert(r.message);else this.onGC(r.minStateIdKept);t.isRecalcFinished()&&this.flushOutputLogs(),t.flush()}logExperimentRunResult(e,t){C.ulsLogger.ULS.traceTag(594409422,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,`calc.calc.RecalcService: ${e} done; ${t}`),"UnitExperiment"===e&&C.ulsLogger.ULS.traceTag(538567681,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,`calc.calc.RecalcService: UnitExperiment done: ${t}`)}logAllFailureStats(){const e=this.nameFailures;this.nameFailures=[];const t=this.rangeFailures;this.rangeFailures=[];const r=this.numberFormatFailures;this.numberFormatFailures=[];const n=this.printFormulaFailures;this.printFormulaFailures=[];const i=this.inferFormatFailures;this.inferFormatFailures=[];const o=this.formatValueFailures;this.formatValueFailures=[];const s=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(e,595194337,"name",a.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",a.TraceLevel.Info),this.logGenFailureStats(r,590484946,"format",a.TraceLevel.Info),this.logGenFailureStats(n,592730065,"print-formula",a.TraceLevel.Info),this.logGenFailureStats(i,590484947,"infer-format",a.TraceLevel.Info),this.logCellFailureStats(o,590484948,"format-value",a.TraceLevel.Info),this.logGenFailureStats(s,595194338,"unhandled",a.TraceLevel.Warning)}logGenFailureStats(e,t,r,n){if(0===e.length)return;const i={};for(const{reason:t}of e)(0,W.incrementFailure)(i,t);const o=`calc.calc.RecalcService: recalc ${r} failures; stateId = ${this.currentOutputStateId}, stats = ${JSON.stringify(i)}`;C.ulsLogger.ULS.traceTag(t,a.LogCategory.msoulscat_ES_EWAJS,n,o),this.logJavaScriptFailures(e,r)}logCellFailureStats(e,t,r,n){if(0===e.length)return;const i={};for(const{reason:t,cellKind:r}of e){const e=i[r]??(i[r]={});(0,W.incrementFailure)(e,t)}Object.getOwnPropertyNames(i).sort().forEach((e=>{const o=i[e],s=`calc.calc.RecalcService: recalc ${r} failures; stateId = ${this.currentOutputStateId}, cell kind = ${e}, stats = ${JSON.stringify(o)}`;C.ulsLogger.ULS.traceTag(t,a.LogCategory.msoulscat_ES_EWAJS,n,s)})),this.logJavaScriptFailures(e,r)}logJavaScriptFailures(e,t){for(const{reason:r}of e)if(r.kind===T.ReasonKind.JavaScriptError){const e=`calc.calc.RecalcService: recalc ${t} JavaScript error: ${(0,I.messageFromError)(r.error)}`;C.ulsLogger.ULS.traceTag(595658721,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,e)}}logIgnoredStats(e,t,r,n){if(0===Object.getOwnPropertyNames(n).length)return;const i=`calc.calc.RecalcService: ignored ${r} data; stateId = ${t}, stats = ${JSON.stringify(n)}`;C.ulsLogger.ULS.traceTag(e,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,i)}logIgnoredInputStats(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}}logIgnoredOutputStats(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}}logRecalcStats(){if(this.currentOutputStateId===-1/0)return;if(this.lastRecalcStatsStateId===this.currentOutputStateId&&this.recalcStatistics===f.emptyRecalcStatistics)return;const e=this.recalcStatistics;this.recalcStatistics=f.emptyRecalcStatistics,this.lastRecalcStatsStateId=this.currentOutputStateId;const t=this.config.sampleRecalcStatisticsRate;if(!this.dataModel.shouldSample(t))return;const r=`calc.calc.RecalcService: recalc statistics; stateId = ${this.currentOutputStateId}, stats = ${JSON.stringify(e)}, p = ${JSON.stringify(t)}`;C.ulsLogger.ULS.traceTag(595654593,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,r)}logUnavailableStats(){if(this.currentOutputStateId===-1/0)return;if(0===this.rangeFailures.length)return;const e=(0,P.computeUnavailableCellsStats)(this.rangeFailures);if(0===e.numOfUnavailableCellsInTheSameSheet&&0===e.numOfUnavailableCellsInDifferentSheet&&0===e.totalNumOfUnavailableCells)return;const t=`calc.calc.RecalcService: unavailable cells statistics; stateId = ${this.currentOutputStateId}, stats = ${JSON.stringify(e)}`;C.ulsLogger.ULS.traceTag(589632004,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,t)}logWorkbookStats(e,t,r){const n=`calc.calc.RecalcService: workbook statistics; stateId = ${e}, stats = ${JSON.stringify(t)}, p = ${JSON.stringify(r)}`;C.ulsLogger.ULS.traceTag(595359882,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,n)}logInputStateIdDecrease(e){(0,k.incrementStat)(this.ignoredInputStats,`${e}: input stateId went backwards`)}logOutputStateIdDecrease(){(0,k.incrementStat)(this.ignoredOutputStats,"output stateId went backwards")}flushInputLogs(){this.logIgnoredInputStats()}flushOutputLogs(){this.logUnavailableStats(),this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats()}cellWriteToRangeDelta(e,t,r,n,a,o,s,u,l){if(!(0,k.check)(n,k.chReadOper,this.ignoredOutputStats,l))return;const c=(0,K.readOperToCellValue)(this.mathpack,n),d=(0,K.cellFormatToInferredFormat)(a);return(0,i.isDefined)(o)||(0,i.isDefined)(c)||(0,i.isDefined)(d)||(0,i.isDefined)(s)||(0,i.isDefined)(u)?(0,g.rangeDelta)((0,g.sheetRangeLocation)(e,t,r),(0,g.cellDataDelta)(o,c,d,s,u)):void 0}rangeWriteToRangeDeltas(e,t,r,n,a,o,s){const u=`${s}.<index>.<index>`,{row:l,col:c,rows:d,cols:g}=t,m=[];for(let t=0;t<d;t+=1)for(let s=0;s<g;s+=1){const d=this.cellWriteToRangeDelta(e,l+t,c+s,r[t][s],n[t][s],0===t&&0===s?a:void 0,o[t][s],void 0,u);(0,i.isDefined)(d)&&m.push(d)}return m}rangeFailure(e,t){return(0,g.rangeFailure)((0,K.sheetGridRangeToLocation)(e),V(t))}setA1ReferenceStyle(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setA1ReferenceStyle(this.dataModel,this.currentInputStateId,e)}setLocale(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setLocaleInfo(this.dataModel,this.currentInputStateId,e,this.ignoredInputStats)}setWorkbookProps(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setWorkbookProps(this.dataModel,this.currentInputStateId,e,this.ignoredInputStats)}setNumberFormats(e,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(this.document,(0,k.filterCheck)(e,k.chNumberFormat,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)}updateSheetNames(e,t){this.setInputStateId(e,"sheetNames")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateSheetNames(this.dataModel,e,t,this.ignoredInputStats))}updateNamedObjects(e,t){this.setInputStateId(e,"namedObjectsUpdates")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateNamedObjects(this.dataModel,e,t,this.ignoredInputStats))}updateUnusedCells(e,t){if(!this.setInputStateId(e,"unusedCellsUpdates"))return;this.clearAsyncResumeRecalc();const r=(0,k.filterCheck)(t,k.chUnusedCellsUpdate,this.ignoredInputStats,"unusedCellsUpdates");for(const t of r)this.dataModel.extendUnusedRange((0,K.unusedCellsUpdateToUsedRange)(this.document,t),e)}updateRanges(e,t){this.setInputStateId(e,"rangeUpdates")&&(this.clearAsyncResumeRecalc(),this.applyRangeUpdates(e,t))}updateArrays(e,t){if(!this.setInputStateId(e,"arrayUpdates"))return;this.clearAsyncResumeRecalc();const r=(0,k.filterCheck)(t,k.chArrayUpdate,this.ignoredInputStats,"arrayUpdates");for(const t of r){const{range:r,data:n,fromStateId:a}=t,o=(0,K.sheetRangeLocationToGridRange)(this.document,r);if((0,i.isDefined)(n)){const{formulaBarText:t,isSpilled:r}=n,a=(0,v.gridRangeAnchor)(o.range);this.dataModel.writeArrayFormula(e,o,t,a,r)}else(0,i.isDefined)(a)}}editRangeFormulas(e,t){this.setInputStateId(e,"rangeFormulaEdits")&&(this.clearAsyncResumeRecalc(),this.applyRangeFormulaEdits(t,e))}evalOnClonedModel(e,t,r){return this.evalOnClonedModelOnSnapshot(e,t,void 0,r)}evalOnClonedModelOnSnapshot(e,t,r=void 0,n){(0,E.assertPositiveInteger)("edits array should not be empty",t.length);const a=void 0===r?new h.EvalOnClonePropsFromPartialWB(this.dataModel,n):new h.EvalOnClonePropsFromPartialWBDocumentCollection(r,n);return this.applyRangeUpdates(-1,e,a),this.applyRangeFormulaEdits(t,-1,a),a.resultsPromise.toPromise()}applyRangeUpdates(e,t,r){const n=(0,k.filterCheck)(t,k.chRangeUpdate,this.ignoredInputStats,"rangeUpdates");for(const t of n){const{range:n,excludeRows:a,excludeColumns:s,data:u,fromStateId:l}=t,c=(0,K.sheetRangeLocationToGridRange)(this.document,n),d=c.range,g=(0,K.createExcludeCellSet)(d.row,d.rows,m.bspFactory.row,a),h=(0,K.createExcludeCellSet)(d.col,d.cols,m.bspFactory.col,s),F=(0,K.sheetGridRangeToCellSet)(c,g,h),y=(0,i.isDefined)(u)?(0,K.cellValueToReadOper)(this.mathpack,u.value):S.blankOper;(0,A.assertTrue)("calc.calc.RecalcService: updateRanges oper",null!=y);const b=(0,v.gridRangeAnchor)(d);if((0,i.isDefined)(u)){const t=u.iformat,n="ArrayFormula"===u.kind?void 0:u.formulaBarText??void 0,a=u.failureReason??void 0,i="CellFormula"===u.kind;this.dataModel.writeCellContents(e,F,n,i,b,y,t,f.SpecialStyle.Blank,a,r)}else if((0,o.isNone)(l))this.dataModel.writeCellContents(e,F,"",!1,b,S.blankOper,p.blankCellFormat,void 0,void 0,r);else{if(r)throw new Error("Promote cell data is unsupported for cloned models.");this.dataModel.promoteCellContents(e,c,F,l)}r||(this.dataModel.writeHiddenRows(e,(0,K.sheetGridRangeToHiddenRows)(c,g)),this.dataModel.writeHiddenCols(e,(0,K.sheetGridRangeToHiddenCols)(c,h)))}}localizeEnglishFormula(e,t){const r=this.dataModel.translateEnglishFormula(e,(0,K.sheetCellLocationToGridCell)(this.document,t));return Promise.resolve(r)}applyRangeFormulaEdits(e,t,r){const n=(0,k.filterCheck)(e,k.chRangeFormulaEdit,this.ignoredInputStats,"rangeFormulaEdits");for(const e of n){const{kind:n,range:a,formulaBarText:o,value:s,origin:u,viewport:l}=e;let d=F.empty;a.forEach((e=>{d=(0,y.unionProduct)(d,(0,m.createCellSetFromRange)((0,K.sheetRangeLocationToGridRange)(this.document,e).range))}));const g=(0,K.sheetRangeLocationToGridRange)(this.document,a[0]),h=(0,i.isDefined)(u)?(0,c.gridCell)(u.row,u.column):(0,v.gridRangeAnchor)(g.range),p=(0,i.isDefined)(l)?(0,K.sheetRangeLocationToGridRange)(this.document,l):void 0;let S;(0,i.isDefined)(s)?(S=(0,K.cellValueToReadOper)(this.mathpack,s),(0,A.assertTrue)("calc.calc.RecalcService: editRangeFormulas oper",null!=S)):S=void 0;const b="CellFormula"===n||"Value"!==n&&void 0;r?this.dataModel.editCellContentsOnClone((0,f.sheetCellSet)(g.sheet,d),o,b,h,r):this.dataModel.editCellContents(t,(0,f.sheetCellSet)(g.sheet,d),o,b,h,S,p)}}editRangeFormats(e,t){if(!this.setInputStateId(e,"rangeFormatEdits"))return;this.clearAsyncResumeRecalc();const r=(0,k.filterCheck)(t,k.chRangeFormatEdit,this.ignoredInputStats,"rangeFormatEdits");for(const t of r){const{range:r,operation:n,origin:a,viewport:s}=t,u="SetFormat"!==n.kind||(0,o.isNone)(n.format)?"RibbonFormat"!==n.kind||(0,o.isNone)(n.ribbon)?"ChangeDecimals"!==n.kind||(0,o.isNone)(n.changeDecimals)?void 0:{kind:n.kind,changeDecimals:n.changeDecimals}:{kind:n.kind,ribbon:n.ribbon}:{kind:n.kind,format:n.format};(0,A.assertTrue)("calc.calc.RecalcService: editRangeFormats operation",null!=u);let l=F.empty;r.forEach((e=>{l=(0,y.unionProduct)(l,(0,m.createCellSetFromRange)((0,K.sheetRangeLocationToGridRange)(this.document,e).range))}));const d=(0,K.sheetRangeLocationToGridRange)(this.document,r[0]),g=null!=a?(0,c.gridCell)(a.row,a.column):(0,v.gridRangeAnchor)(d.range),h=(0,i.isDefined)(s)?(0,K.sheetRangeLocationToGridRange)(this.document,s):void 0;this.dataModel.editCellFormats(e,(0,f.sheetCellSet)(d.sheet,l),u,g,h)}}editArrayFormulas(e,t){if(!this.setInputStateId(e,"arrayFormulaEdits"))return;this.clearAsyncResumeRecalc();const r=(0,k.filterCheck)(t,k.chArrayFormulaEdit,this.ignoredInputStats,"arrayFormulaEdits");for(const t of r){const{range:r,formulaBarText:n,origin:a,viewport:o}=t,s=(0,K.sheetRangeLocationToGridRange)(this.document,r),u=(0,i.isDefined)(a)?(0,c.gridCell)(a.row,a.column):(0,c.gridCell)(r.row,r.column),l=(0,i.isDefined)(o)?(0,K.sheetRangeLocationToGridRange)(this.document,o):void 0;this.dataModel.editArrayFormula(e,s,n,u,l)}}editRangePaste(e,t){if(!this.setInputStateId(e,"editRangePaste"))return;this.clearAsyncResumeRecalc();const r=(0,k.filterCheck)(t,k.chPasteEdit,this.ignoredInputStats,"pasteEdits");for(const t of r){const{kind:r,source:n,target:a,viewport:o}=t,s=(0,K.sheetRangeLocationToGridRange)(this.document,n),u=(0,K.sheetCellLocationToGridCell)(this.document,a),l=(0,i.isDefined)(o)?(0,K.sheetRangeLocationToGridRange)(this.document,o):void 0;this.dataModel.editPaste(e,r,u,s,l)}}setConfig(e){const t=Array.isArray(e.runExperiments)?{stepBudget:e.experimentStepBudget??10,totalBudget:e.experimentTotalBudget??1e4,factories:(0,O.getExperimentFactories)(e.runExperiments)}:void 0;this.config={yieldIntervalMs:10,totalTimeMs:e.totalEvalTimeMs??1e4,maxCellChain:2*d.sheetCols,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionEvalRate:e.samplePrecisionEvalRate??.02,samplePrecisionPrintFormulaRate:e.samplePrecisionPrintFormulaRate??.001,samplePrecisionPrintValueRate:e.samplePrecisionPrintValueRate??1e-4,sampleRecalcStatisticsRate:e.sampleRecalcStatisticsRate??.2,sampleWorkbookStatisticsRate:e.sampleWorkbookStatisticsRate??.1,sampleCellEvalStopwatchRate:e.sampleCellEvalStopwatchRate??.003,sampleRecalcEditedStopwatchRate:e.sampleRecalcEditedStopwatchRate??1,sampleRecalcViewportStopwatchRate:e.sampleRecalcViewportStopwatchRate??1,rngSeed:e.rngSeed??1e3*Date.now(),volatileMode:null!=e.volatileMode?U.VolatileMode[e.volatileMode]:U.VolatileMode.Estimation,experimentFactories:t}}reconfigure(e){this.setConfig(e),this.dataModel.reconfigure(this.config)}clearCache(){this.clearAsyncResumeRecalc(),this.dataModel=new h.PartialWorkbook(this.dataTransformer.getLangConfig(),this.config),this.recalcStatistics=f.emptyRecalcStatistics,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=this.lastRecalcStatsStateId=-1/0}evalFormula(e,t,r,n){return(0,k.check)(r,k.chSheetCellLocation,this.ignoredInputStats,"origin")?(0,k.check)(n,k.chEvalFormulaFormat,this.ignoredInputStats,"format")?this.dataModel.evalFormula(e,t,(0,K.sheetCellLocationToGridCell)(this.document,r),(0,K.evalFormulaFormatToUnion)(n)).then((({value:e,formatted:t})=>{let r,n;if((0,M.isSuccess)(e)){if(!(0,k.check)(e.value,k.chReadOper,this.ignoredOutputStats,"evalFormula"))throw new Error("ignored output");const t=(0,K.readOperToCellValue)(this.mathpack,e.value);(0,A.assertTrue)("calc.calc.RecalcService.evalFormula",void 0!==t),r=(0,D.success)(t)}else r=(0,w.failure)(V(e.reason));return n=void 0===t?void 0:(0,M.isSuccess)(t)?t:(0,w.failure)(V(t.reason)),(0,g.evalFormulaData)(r,n)})):Promise.reject(new Error("ignored format")):Promise.reject(new Error("ignored input"))}evalFormulaOnSnapshotImpl(e,t,r,n){return this.dataModel.evalFormula(-1,e,t,r,n)}testAdvanceState(e){this.setInputStateId(e,"testAdvanceState")&&(this.dataModel.testAdvanceState(e),this.clearAsyncResumeRecalc())}getMissingJSFeatures(){return(0,x.getMissingJSFeatures)()}constructor(e,t,r,n,a,i={},o="Local"){this.onRecalcResults=e,this.onUpdateRequest=t,this.onGC=r,this.onAlert=n,this.asyncLoopFactory=a,this.twConfig=i,this.dataTransformer=new W.RecalcServiceDataTransformer,this.currentInputStateId=-1/0,this.currentOutputStateId=-1/0,this.lastRecalcStatsStateId=-1/0,this.recalcStatistics=f.emptyRecalcStatistics,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.printFormulaFailures=[],this.inferFormatFailures=[],this.formatValueFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.initCalcThreadInside=async(e,t,r)=>(0,l.initCalcInThread)(e,t,r,this.twConfig),this.setConfig({}),this.dataModel=new h.PartialWorkbook(this.dataTransformer.getLangConfig(),this.config)}}t.RecalcServiceImpl=j;const H=(0,_.mixin)(j,(e=>new G.RecalcSideGrid(e)),["getSheetNames","getRangeValues","getRangeFormats","getRangeFormulae","getIntersectingTables","getIformats","discardSnapshot","createIGridExportEndpoint","getHiddenRows","getHiddenCols","evalFormulaOnSnapshot","evalClonedModelOnSnapshot","getCorrespondingSnapshotID"]);if((0,L.getTypedFeatureGate)("TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL")&&(self.__retries=(self.__retries??-1)+1,0===self.__retries))throw"";t.recalcServiceInsideInit=({config:e,connection:t})=>n.Endpoint.createInside(t,(r=>new H(((...e)=>r.post.onRecalcResults(...e)),((...e)=>r.post.onUpdateRequest(...e)),((...e)=>r.post.onGC(...e)),((...e)=>r.post.onAlert(...e)),R.asyncLoop,e,t.createMode)))},2327:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRecalcService=void 0;const n=r(3345).__importStar(r(4067)),a=r(4068),i=r(6366),o=r(7753),s=r(6366),u=r(6366),l=r(6366),c=r(1861),d=r(115),g=r(6366),m=r(6366),h=r(941);t.createRecalcService=async function(e,...[t,r]){const[p,f]="boolean"==typeof t?t?[(new c.PluginSchedulerSingleton).instance(),(new c.GridImportManagerSingleton).instance()]:[void 0,void 0]:[t,r];let S=-1/0,v=!1;const F={onRecalcResults(e){},onUpdateRequest(e){},onGC(e){S=e},onAlert(e){if(v)return;const t=document.createElement("div"),r=document.createElement("p");r.textContent=e,t.appendChild(r);const n=document.createElement("button");n.textContent="OK",t.appendChild(n),t.setAttribute("style","position: fixed; top: 0; left: 30%; right: 30%; background: red; color: white; font-size: 16px; font-weight: bold; z-index: 1000; padding: 3em; white-space: pre-line;"),n.onclick=()=>{document.body.removeChild(t)},document.body.appendChild(t),v=!0}},y=await n.createWorker({id:"RecalcService",createMode:e},{local:o.recalcServiceInsideInit,thread:{scriptUrl:(0,g.getCalcAbsUrlOrThrow)(),insideInitName:"excelOnlineCalc.calc.recalcServiceInsideInit"}},(()=>F)),b=[];let C="Requested";function A(e="Requested"){C=e,y.close()}y.onClose=()=>{for(const e of b)try{e()}catch(e){i.ulsLogger.ULS.traceTag(539341771,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`calc.calc.createRecalcService.service.onClose: callback threw ${(0,s.messageFromError)(e)}`)}const e=`calc.calc.createRecalcService.service.onClose: recalc service closed; reason = ${C}`;i.ulsLogger.ULS.traceTag(561534148,a.LogCategory.msoulscat_ES_EWAJS,"Requested"===C?a.TraceLevel.Info:a.TraceLevel.Warning,e)};try{if("Thread"===y.createMode){const e=await(0,m.initCalcThread)(y);b.push((()=>e.close())),(0,h.logMissingJSFeatures)(y.call.getMissingJSFeatures)}y.call.ping.callTimeout=3e4;let e=3,t=0,r=()=>{};(0,u.promiseLoop)((async()=>{if(await new Promise((e=>setTimeout(e,1e3))),y.hasBeenClosed())return;const o=y.call.ping.callTimeout,s=(0,l.now)();try{await y.call.ping()}catch(u){if(!n.WorkerError.isWorkerError(u)||"Timeout"!==u.info.cause)throw u;const c=(0,l.now)()-s;t+=1,t>=e&&A("Unresponsive");const d=y.hasBeenClosed(),g={timeout:o,waitTime:c,timeoutCount:t,hasBeenClosed:d},m=`calc.calc.RecalcService: unresponsive; ${JSON.stringify(g)}`;return i.ulsLogger.ULS.traceTag(561534149,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,m),r(o,c,t,d),!0}return t=0,!0}),!0).catch((e=>{const t=`calc.calc.RecalcService: ping loop threw an error: ${(0,s.messageFromError)(e)}`;i.ulsLogger.ULS.traceTag(561534150,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,t)})),y.post.updateRanges.onPostMessageError=n.dispatchWorkerError;const o={setOnRecalcResults(e){F.onRecalcResults=e},setOnUpdateRequest(e){F.onUpdateRequest=e},setOnUnresponsive(e){r=e},setA1ReferenceStyle(...e){y.post.setA1ReferenceStyle(...e),void 0!==p&&p.doNotify(d.NotificationKind.setA1ReferenceStyle,e)},setLocale(...e){y.post.setLocale(...e),void 0!==p&&p.doNotify(d.NotificationKind.setLocale,e)},setWorkbookProps(...e){y.post.setWorkbookProps(...e),void 0!==p&&p.doNotify(d.NotificationKind.setWorkbookProps,e)},updateSheetNames(...e){y.post.updateSheetNames(...e),void 0!==p&&p.doNotify(d.NotificationKind.updateSheetNames,e)},updateNamedObjects(...e){y.post.updateNamedObjects(...e),void 0!==p&&p.doNotify(d.NotificationKind.updateNamedObjects,e)},setNumberFormats:y.post.setNumberFormats,updateUnusedCells:y.post.updateUnusedCells,updateRanges:y.post.updateRanges,updateArrays:y.post.updateArrays,editRangeFormulas:y.post.editRangeFormulas,editRangeFormats:y.post.editRangeFormats,editArrayFormulas:y.post.editArrayFormulas,editRangePaste:y.post.editRangePaste,resumeRecalc:y.post.resumeRecalc,reconfigure(t){y.call.ping.callTimeout=t.responsivenessPingTimeout??3e4,e=t.responsivenessPingAttempts??3,y.post.reconfigure(t)},clearCache(){y.post.clearCache(),S=-1/0},testAdvanceState:y.post.testAdvanceState,testResumeRecalc:y.call.testResumeRecalc,close:A,stateIdAvailable:e=>e>=S,evalFormula:y.call.evalFormula,evalOnClonedModel:y.call.evalOnClonedModel,localizeEnglishFormula:(...e)=>y.call.localizeEnglishFormula(...e),createIGridExportEndpoint:(e,t)=>(b.push(t),y.call.createIGridExportEndpoint.transfer([e.port],e))};return void 0!==f&&f.onGridExporterCreated(o),o}catch(e){throw A("Error"),e}}},3519:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chNamedRangeData=t.chNamedFormulaData=t.chNamedValueData=t.chNamedValue=t.chUnusedCellsUpdate=t.chArrayUpdate=t.chArrayData=t.chRangeUpdate=t.chCellData=t.chCellFormat=t.chCellValue=t.chError=t.chBlank=t.chSheetCellLocation=t.chSheetRangeLocation=t.chRangeLocation=t.chCellLocation=t.chCol=t.chRow=t.chSheetName=t.chSheetId=t.chNumberFormat=t.chErrorTypeName=t.chWorksheetFunctionName=t.chFormulaText=t.isFormulaText=t.oneOfChecker=t.eqChecker=t.chArray=t.chBoolean=t.chNonemptyString=t.chString=t.chNatural=t.chInteger=t.chFiniteNumber=t.chPossiblyInfiniteNumber=t.chNever=t.intChecker=t.typeofChecker=t.taggedUnionChecker=t.arrayChecker=t.depAllChecker=t.allChecker=t.objectChecker=t.fromChecker=t.optChecker=t.filterCheck=t.check=t.checker=t.incrementStat=void 0,t.chReadOper=t.chEvalFormulaFormat=t.chWorkbookProps=t.chLocaleData=t.chPasteEdit=t.chArrayFormulaEdit=t.chRangeFormatEdit=t.chRangeFormulaEdit=t.chNamedObjectsUpdate=t.chNamedObject=t.chNamedObjectData=t.chNamedFailureData=t.chNamedTableScope=t.chNamedTableData=t.chColumnData=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6366),u=r(6366),l=r(6067),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(6067),y=r(6366),b=r(3228);function C(e,t){e[t]=(e[t]??0)+1}function A(e,t,r){return e.push(`${t.join(".")}: expected ${r}`),!1}function E(e,t){return(r,n,i)=>(0,a.isDefined)(r)&&e(r)||A(n,i,t)}function T(e,t,r,n){const a=[],i=t(e,a,[n]);for(const e of a)C(r,e);return i}function R(e){return(t,r,n)=>!!(0,i.isNone)(t)||e(t,r,n)}function k(e){return(t,r,n)=>{if((0,i.isNone)(t))return A(r,n,"non-null object");const a=n.length;try{let i=!0;for(const o in e)n[a]=o,i=i&&e[o](t[o],r,n);return i}finally{n.length=a}}}function N(...e){return(t,r,n)=>e.reduce(((e,a)=>e&&a(t,r,n)),!0)}function I(e,...t){return(r,n,a)=>t.reduce(((e,t)=>e&&t(r)(r,n,a)),e(r,n,a))}function O(e){return(t,r,n)=>{if(!Array.isArray(t))return A(r,n,"Array");n.push("<index>");try{return t.reduce(((t,a)=>t&&e(a,r,n)),!0)}finally{n.pop()}}}function P(e){const t=`one of ${JSON.stringify(Object.getOwnPropertyNames(e).sort())}`;return(r,n,a)=>{if((0,i.isNone)(r))return A(n,a,"non-null object");const o=a.length;try{const o="string"==typeof r.kind||"number"==typeof r.kind?e[r.kind]:void 0;return(0,i.isNone)(o)?(a.push("kind"),A(n,a,t)):o(r,n,a)}finally{a.length=o}}}function M(e){const t=`typeof one of ${JSON.stringify(Object.getOwnPropertyNames(e).sort())}`;return(r,n,a)=>{const o=e[typeof r];return(0,i.isNone)(o)?A(n,a,t):o(r,n,a)}}function D(e){return"number"==typeof e&&e>-1/0&&e<1/0}function w(e){return(0|e)===e||Math.floor(e)===e}function L(e,t,r=(0!==e?`integer >= ${e} and < ${t}`:`natural < ${t}`)){return E((r=>"number"==typeof r&&r>=e&&r<t&&w(r)),r)}function _(e){return E((t=>t===e),JSON.stringify(e))}function x(...e){const t=Object.create(null),r=Object.create(null);for(const n of e)"number"==typeof n?r[n]=!0:t[n]=!0;return E((e=>{switch(typeof e){case"string":case"symbol":return!0===t[e];case"number":return!0===r[e]}return!1}),`one of ${JSON.stringify(e.slice().sort())}`)}function K(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}t.incrementStat=C,t.checker=E,t.check=T,t.filterCheck=function(e,r,n,a){if(!T(e,t.chArray,n,a))return[];const i=`${a}.<index>`;return e.filter((e=>T(e,r,n,i)))},t.optChecker=R,t.fromChecker=function(e){return(t,r,n)=>e(t,r,n)},t.objectChecker=k,t.allChecker=N,t.depAllChecker=I,t.arrayChecker=O,t.taggedUnionChecker=P,t.typeofChecker=M,t.intChecker=L,t.chNever=E((e=>!1),"never"),t.chPossiblyInfiniteNumber=E((function(e){return"number"==typeof e&&!isNaN(e)}),"number (non-NaN)"),t.chFiniteNumber=E(D,"finite number"),t.chInteger=E((e=>D(e)&&w(e)),"integer"),t.chNatural=L(0,1/0,"natural"),t.chString=E((e=>"string"==typeof e),"string"),t.chNonemptyString=E((e=>"string"==typeof e&&e.length>0),"nonempty string"),t.chBoolean=E((e=>"boolean"==typeof e),"boolean"),t.chArray=E((e=>Array.isArray(e)),"Array"),t.eqChecker=_,t.oneOfChecker=x,t.isFormulaText=K,t.chFormulaText=E((e=>"string"==typeof e&&K(e)),"formula text"),t.chWorksheetFunctionName=k({functionId:t.chNatural,functionName:t.chNonemptyString});const W=E((e=>"string"==typeof e&&e.length>1&&(0,y.stringStartsWith)(e,"#")),"error name");t.chErrorTypeName=k({errorType:t.chNatural,errorName:W}),t.chNumberFormat=k({iformat:t.chNatural,formatString:t.chString,builtIn:t.chBoolean}),t.chSheetId=E((e=>"string"==typeof e||D(e)),"string or finite number"),t.chSheetName=k({sheetId:t.chSheetId,sheetName:t.chString}),t.chRow=L(0,c.sheetRows),t.chCol=L(0,d.sheetCols),t.chCellLocation=k({row:t.chRow,column:t.chCol});const U=E((e=>null==e.lastRow||e.lastRow>=e.row),"lastRow >= row"),G=E((e=>null==e.lastColumn||e.lastColumn>=e.column),"lastColumn >= column"),B=N(t.chCellLocation,k({lastRow:R(t.chRow),lastColumn:R(t.chCol)}));t.chRangeLocation=I(B,(e=>U),(e=>G)),t.chSheetRangeLocation=N(t.chRangeLocation,k({sheetId:t.chSheetId})),t.chSheetCellLocation=N(t.chSheetRangeLocation,k({lastRow:R(t.chNever),lastColumn:R(t.chNever)})),t.chBlank=k({kind:_("Blank")}),t.chError=k({kind:_("Error"),type:t.chNatural}),t.chCellValue=M({number:t.chFiniteNumber,string:t.chString,boolean:t.chBoolean,object:P({Blank:t.chBlank,Error:t.chError})}),t.chCellFormat=M({number:t.chNatural,string:t.chString}),t.chCellData=N(k({value:t.chCellValue,iformat:t.chNatural,failureReason:R(t.chString)}),P({CellFormula:k({formulaBarText:t.chFormulaText}),ArrayFormula:k({formulaBarText:R(t.chNever)}),Value:k({formulaBarText:t.chString})})),t.chRangeUpdate=k({range:t.chSheetRangeLocation,excludeRows:R(O(t.chRow)),excludeColumns:R(O(t.chCol)),data:R(t.chCellData),fromStateId:R(t.chInteger)}),t.chArrayData=k({isSpilled:t.chBoolean,formulaBarText:t.chFormulaText}),t.chArrayUpdate=k({range:t.chSheetRangeLocation,data:R(t.chArrayData),fromStateId:R(t.chInteger)}),t.chUnusedCellsUpdate=k({sheetId:t.chSheetId,usedRange:R(t.chRangeLocation)}),t.chNamedValue=M({number:t.chFiniteNumber,string:t.chString,boolean:t.chBoolean,object:P({Error:t.chError})}),t.chNamedValueData=k({kind:_("NamedValue"),value:t.chNamedValue}),t.chNamedFormulaData=k({kind:_("NamedFormula"),formulaBarText:t.chFormulaText}),t.chNamedRangeData=k({kind:_("NamedRange"),range:t.chSheetRangeLocation}),t.chColumnData=k({column:t.chNatural,name:t.chNonemptyString});const V=e=>(e.lastRow??e.row)-e.row+1,j=e=>(e.lastColumn??e.column)-e.column+1,H=E((e=>(!e.hasHeadersRow||e.range.row>0)&&(!e.hasTotalsRow||e.range.row+V(e.range)<c.sheetRows)),"enough rows for headers and totals"),q=E((e=>{const t=e.range.column,r=e.range.column+j(e.range);return e.columns.every((e=>e.column>=t&&e.column<r))}),"column names in range");t.chNamedTableData=I(k({kind:_("NamedTable"),range:t.chSheetRangeLocation,hasHeadersRow:t.chBoolean,hasTotalsRow:t.chBoolean,columns:O(t.chColumnData)}),(e=>H),(e=>q)),t.chNamedTableScope=e=>E((t=>"NamedTable"!==t.data?.kind||null==e),"NamedTable at global scope"),t.chNamedFailureData=k({kind:_("NamedFailure"),failureReason:t.chString,objectKind:R(x("NamedValue","NamedFormula","NamedRange","NamedTable"))}),t.chNamedObjectData=P({NamedValue:t.chNamedValueData,NamedFormula:t.chNamedFormulaData,NamedRange:t.chNamedRangeData,NamedTable:t.chNamedTableData,NamedFailure:t.chNamedFailureData});const z=k({name:t.chString,data:R(t.chNamedObjectData)});t.chNamedObject=e=>I(z,(r=>(0,t.chNamedTableScope)(e))),t.chNamedObjectsUpdate=k({scope:R(t.chSheetId),objects:R(t.chArray),fromStateId:R(t.chInteger)});const Q=E((e=>e.length>0),"a non-empty array"),$=E((e=>e.every((t=>t.sheetId===e[0].sheetId))),"ranges on the same sheet"),Y=I(O(t.chSheetRangeLocation),(e=>Q),(e=>$));t.chRangeFormulaEdit=N(k({range:Y,origin:R(t.chCellLocation),viewport:R(t.chSheetRangeLocation)}),P({CellFormula:k({formulaBarText:t.chFormulaText,value:R(t.chNever)}),Value:k({formulaBarText:t.chString,value:t.chCellValue}),Inferred:k({formulaBarText:t.chString,value:R(t.chNever)})}));const J=P({SetFormat:k({format:t.chCellFormat}),RibbonFormat:k({ribbon:x(...(0,u.strEnumArray)(b.RibbonFormat))}),ChangeDecimals:k({changeDecimals:L(-20,20)})});t.chRangeFormatEdit=k({range:Y,operation:J,origin:R(t.chCellLocation),viewport:R(t.chSheetRangeLocation)}),t.chArrayFormulaEdit=k({range:t.chSheetRangeLocation,formulaBarText:E((e=>"string"==typeof e&&(0===e.length||K(e))),"empty string or text denoting formula"),origin:R(t.chCellLocation),viewport:R(t.chSheetRangeLocation)});const X=E((e=>{const t=j(e.source),r=V(e.source);return e.target.column+t<=d.sheetCols&&e.target.row+r<=c.sheetRows}),"(target,source) in range");t.chPasteEdit=I(k({kind:x("CopyPaste"),target:t.chSheetCellLocation,source:t.chSheetRangeLocation,viewport:R(t.chSheetRangeLocation)}),(e=>X));const Z=E((e=>2===e.length),"2 AM/PM symbols"),ee=E((e=>7===e.length),"7 day symbols"),te=E((e=>12===e.length),"12 month symbols");function re(e){const t=(0,s.numEnumMap)(e,o.identity);return E((e=>e.every(((e,r)=>null==e||r in t))),"indexes in enum")}const ne=re(F.SpecialRefId),ae=re(p.PictureSpecial),ie=re(f.PictureSingle),oe=re(S.PictureColor),se=re(v.PictureDbnum);t.chLocaleData=k({worksheetFunctionNames:t.chArray,thousandsData:O(t.chNatural),errorTypeNames:t.chArray,specialRefNames:I(O(R(t.chNonemptyString)),(e=>ne)),trueName:t.chNonemptyString,falseName:t.chNonemptyString,rowLetter:t.chNonemptyString,columnLetter:t.chNonemptyString,leftBrace:t.chNonemptyString,rightBrace:t.chNonemptyString,leftBracket:t.chNonemptyString,rightBracket:t.chNonemptyString,decimalSeparator:t.chNonemptyString,listSeparator:t.chNonemptyString,columnSeparator:t.chNonemptyString,rowSeparator:t.chNonemptyString,thousandsSeparator:t.chString,lcid:t.chNatural,country:t.chNatural,numberDecimals:t.chNatural,isExpSepBySpace:t.chBoolean,fractionSeparator:t.chNonemptyString,isPercentSepBySpace:t.chBoolean,currencyFormat:x(g.CurrencyFormat.Paren,g.CurrencyFormat.Lead,g.CurrencyFormat.Intern,g.CurrencyFormat.Trail),isCurrencySymbolLead:t.chBoolean,isCurrencySepBySpace:t.chBoolean,currencySymbol:t.chString,currencyDecimals:t.chNatural,dateOrder:x(m.DateOrder.MDY,m.DateOrder.DMY,m.DateOrder.YMD,m.DateOrder.MYD,m.DateOrder.DYM,m.DateOrder.YDM),dateSeparator:t.chString,dateAltSeparator:t.chString,year4Digits:t.chBoolean,month2Digits:t.chBoolean,day2Digits:t.chBoolean,longDateFormat:t.chBoolean,timeSeparator:t.chString,timeAltSeparator:R(t.chString),hour2Digits:t.chBoolean,clock24Hour:t.chBoolean,isAMPMSepBySpace:t.chBoolean,ampmSymbols:I(O(t.chString),(e=>Z)),dayNameShort:I(O(t.chString),(e=>ee)),dayNameLong:I(O(t.chString),(e=>ee)),monthNameShort:I(O(t.chString),(e=>te)),monthNameLong:I(O(t.chString),(e=>te)),pictureSpecial:I(O(R(t.chNonemptyString)),(e=>ae)),pictureSingle:I(O(R(t.chNonemptyString)),(e=>ie)),pictureColor:I(O(R(t.chNonemptyString)),(e=>oe)),pictureDbnum:I(O(R(t.chNonemptyString)),(e=>se)),sysDateFormat:t.chString,sysTimeFormat:t.chString,cultureTagPrimary:t.chNonemptyString,cultureTagUserDefault:t.chNonemptyString,cultureTagInstLang:t.chNonemptyString,cultureTagUserCurrent:t.chNonemptyString});const ue=k({yr:t.chInteger,mon:L(1,13),dom:L(1,6),wdy:L(1,8),hour:L(0,24),min:L(0,60),sec:L(0,60),fracSec:_(0),rounding:L(0,4)}),le=I(k({bias:t.chFiniteNumber,standardDate:R(ue),standardBias:t.chFiniteNumber,daylightDate:R(ue),daylightBias:t.chFiniteNumber}),(e=>E((e=>(0,i.isNone)(e.standardDate)===(0,i.isNone)(e.daylightDate)),"standardDate iff daylightDate")));t.chWorkbookProps=k({date1904:R(t.chBoolean),dateCompatibility:R(t.chBoolean),timezone:R(le)}),t.chEvalFormulaFormat=R(P({Origin:k({iformat:R(t.chNever),knownFormat:R(t.chNever)}),Iformat:k({iformat:t.chNatural,knownFormat:R(t.chNever)}),Known:k({iformat:R(t.chNever),knownFormat:x(...(0,n.numEnumArray)(h.KnownFormat))}),Inferred:k({iformat:R(t.chNever),knownFormat:R(t.chNever)}),Aggregate:k({iformat:R(t.chNever),knownFormat:R(t.chNever)})}));const ce={[l.OperKind.Number]:!0,[l.OperKind.String]:!0,[l.OperKind.Boolean]:!0,[l.OperKind.Error]:!0,[l.OperKind.Array]:!1,[l.OperKind.Blank]:!0,[l.OperKind.Rich]:!1};t.chReadOper=E((e=>ce[e.kind]),"supported ReadOper")},8072:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.incrementFailure=t.RecalcServiceDataTransformer=t.initialRecalcServiceConfig=void 0;const n=r(6067),a=r(6067),i=r(6366),o=r(6067),s=r(3519),u=r(3519),l=r(222),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6869),f=r(472),S=r(3228),v=r(8073),F=r(8073),y=r(6366);t.initialRecalcServiceConfig={localeInfo:(0,o.getEnglishLocaleInfo)(),mathpack:d.xlMathpack,refStyle:c.RefStyle.A1,timezone:m.tzUTC,date1904:!1,dateCompatibility:!0,datepack:h.xlDatepack},t.RecalcServiceDataTransformer=class{getLangConfig(){return this.langConfig}setA1ReferenceStyle(e,t,r){this.langConfig={...this.langConfig,refStyle:r?c.RefStyle.A1:c.RefStyle.R1C1},e.setLangConfig(t,this.langConfig)}setLocaleInfo(e,t,r,n){(0,u.check)(r,u.chLocaleData,n,"localeData")&&(this.langConfig={...this.langConfig,localeInfo:(0,l.createLocaleInfo)(r,n)},e.setLangConfig(t,this.langConfig))}setWorkbookProps(e,r,n,a){(0,u.check)(n,u.chWorkbookProps,a,"workbookProps")&&(this.langConfig={...this.langConfig,date1904:n.date1904??t.initialRecalcServiceConfig.date1904,dateCompatibility:n.dateCompatibility??t.initialRecalcServiceConfig.dateCompatibility,timezone:n.timezone??t.initialRecalcServiceConfig.timezone},e.setLangConfig(r,this.langConfig))}updateSheetNames(e,t,r,n){e.setSheetNames(this.document,(0,u.filterCheck)(r,u.chSheetName,n,"sheetNames"),t)}updateNamedObjects(e,t,r,n){const o=(0,u.filterCheck)(r,u.chNamedObjectsUpdate,n,"namedObjectsUpdates");for(const r of o){const{scope:o,objects:s,fromStateId:c}=r,d=(0,a.nameScope)(this.document,(0,i.isDefined)(o)?o:void 0);if((0,i.isDefined)(s)){const r=(0,u.filterCheck)(s,(0,u.chNamedObject)(o),n,"namedObjectsUpdates.<index>.objects");for(const n of r){const{name:r,data:a}=n;e.writeNamedObject(t,d,r,(0,l.namedObjectDataToNamedObject)(this.langConfig.mathpack,this.langConfig.localeInfo.stringCompareCI,this.document,a))}}else(0,i.isDefined)(c)?e.promoteNamedObjects(t,d,c):e.writeUndefinedNames(t,d)}}constructor(){this.document=(0,n.documentLoc)(void 0,""),this.langConfig=t.initialRecalcServiceConfig}},t.incrementFailure=function(e,t){switch(t.kind){case F.ReasonKind.NotImplemented:for(const r of t.features)(0,s.incrementStat)(e,`${F.ReasonKind.NotImplemented} ${r}`);break;case F.ReasonKind.IllFormedFormula:(0,s.incrementStat)(e,`${F.ReasonKind.IllFormedFormula} ${t.mode??""} ${JSON.stringify({diagnostics:t.diagnostics??{},message:t.mode===p.FormulaMode.ServerCellFormula||t.mode===p.FormulaMode.ServerNamedFormula?t.message:void 0})}`);break;case F.ReasonKind.Unavailable:for(const r of t.objects){const t=[F.ReasonKind.Unavailable];if("string"==typeof r.kind&&r.kind in p.UnavailableKind){const e=r;switch(t.push(e.kind),e.kind){case p.UnavailableKind.SheetId:t.push(e.sheetId);break;case p.UnavailableKind.NameLoc:t.push(e.source),t.push(void 0===e.name.scope.index?"global":"sheet");break;case p.UnavailableKind.ClientFailure:t.push(e.reason);break;case p.UnavailableKind.CellFormula:case p.UnavailableKind.EvalFailure:t.push(e.reason.kind);break;case p.UnavailableKind.VolatileFunction:t.push(e.name);break;case p.UnavailableKind.TimeGranularity:t.push(g.TimeGranularity[e.granularity]);break;case p.UnavailableKind.GetTimeKind:t.push(e.getTimeKind)}}else t.push(JSON.stringify(r));(0,s.incrementStat)(e,t.join(" "))}break;case F.ReasonKind.LimitExceeded:(0,s.incrementStat)(e,`${t.kind} ${v.LimitKind[t.limit]}`);break;case S.FormatReasonKind.NotFormatString:case S.FormatReasonKind.NotValueString:(0,s.incrementStat)(e,`${t.kind} ${t.message}`);break;case F.ReasonKind.InvalidQualifier:case F.ReasonKind.InvalidCellRef:case F.ReasonKind.InvalidStructRef:(0,s.incrementStat)(e,`${t.kind} ${t.reason}`);break;case F.ReasonKind.Internal:(0,s.incrementStat)(e,`${t.kind} ${t.message}`);break;case F.ReasonKind.JavaScriptError:case f.ReasonKind.NotFormulaString:case F.ReasonKind.CellCycle:case F.ReasonKind.NameCycle:case F.ReasonKind.Stopped:case F.ReasonKind.PreviousFailure:case F.ReasonKind.PreviousNameFailure:case S.FormatReasonKind.PreviousFormatFailure:(0,s.incrementStat)(e,t.kind);break;default:(0,y.assertNever)("calc.calc.incrementFailure",t)}}},3319:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerExperimentFactory=t.getExperimentFactories=t.ExperimentKind=void 0;const n=r(4068),a=r(6366),i=r(6366),o=r(7989),s=r(3697);class u{static create(e){if("number"==typeof e)return new u(e);{const t=`calc.calc.TestExperiment: expected number; given ${e}`;a.ulsLogger.ULS.traceTag(591974878,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,t)}}setContext(){}step(){const e=(0,i.now)();for(;(0,i.now)()<e+this.stepDelay;);this.iters+=1,this.iters>1&&(this.done=!0)}constructor(e){this.stepDelay=e,this.done=!1,this.resultLogMessage="TestExperiment",this.failedLogMessage="TestExperiment exceeded budget",this.iters=0}}var l;!function(e){e.OneShot="OneShot",e.Recurring="Recurring",e.Precision="Precision"}(l||(t.ExperimentKind=l={}));const c={TestExperiment:e=>({experimentName:"TestExperiment",kind:l.OneShot,create:()=>u.create(e)}),ExceLintExperiment:()=>({experimentName:"ExceLintExperiment",kind:l.OneShot,create:()=>new o.ExceLintExperiment}),UnitExperiment:()=>({experimentName:"UnitExperiment",kind:l.OneShot,create:()=>new s.UnitExperiment,stepBudget:80})};t.getExperimentFactories=function(e){return e.map((({name:e,param:t})=>c[e]?.(t))).filter((e=>void 0!==e))},t.registerExperimentFactory=function(e,t){c[e]=t}},429:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copyPasteRangePasteEdit=t.rangePasteEdit=t.arrayFormulaEdit=t.rangeFormatEdit=t.formatEditChangeDecimals=t.formatEditRibbonFormat=t.formatEditSetFormat=t.formatEditOperation=t.RibbonFormat=t.inferredRangeFormulaEdit=t.valueRangeFormulaEdit=t.cellFormulaRangeFormulaEdit=t.rangeFormulaEdit=t.namedObjectsPromote=t.undefinedNamesWrite=t.namedObjectsWrite=t.namedObjectsUpdate=t.namedObject=t.namedFailureData=t.namedTableData=t.columnData=t.namedRangeData=t.namedFormulaData=t.namedValueData=t.unusedCellsUpdate=t.arrayPromote=t.arrayWrite=t.arrayUpdate=t.arrayData=t.rangePromote=t.rangeWrite=t.rangeUpdate=t.valueCellData=t.arrayFormulaCellData=t.cellFormulaCellData=t.cellData=t.sheetCellLocation=t.sheetRangeLocation=t.rangeLocation=t.cellLocation=t.getCellFormatKind=t.getCellValueKind=t.richValue=t.errorValue=t.blankValue=t.sheetName=t.numberFormat=t.localeData=t.errorTypeName=t.worksheetFunctionName=void 0,t.RecalcServiceCreateMode=t.workbookProps=t.recalcServiceConfig=t.runExperiment=t.updateRequest=t.evalFormulaData=t.evalFormulaFormatAggregate=t.evalFormulaFormatInferred=t.evalFormulaFormatKnown=t.evalFormulaFormatIformat=t.evalFormulaFormatOrigin=t.evalFormulaFormat=t.recalcResults=t.rangeFailure=t.arrayDelta=t.rangeDelta=t.cellDataDelta=t.inferredFormat=void 0;const n=r(6366),a=r(3228);var i;Object.defineProperty(t,"RibbonFormat",{enumerable:!0,get:function(){return a.RibbonFormat}}),t.worksheetFunctionName=(0,n.typedInstanceCreator)()(((e,t)=>({functionId:e,functionName:t}))),t.errorTypeName=(0,n.typedInstanceCreator)()(((e,t)=>({errorType:e,errorName:t}))),t.localeData=(0,n.typedInstanceCreator)()(((e,t,r,n,a,i,o,s,u,l,c,d,g,m,h,p,f,S,v,F,y,b,C,A,E,T,R,k,N,I,O,P,M,D,w,L,_,x,K,W,U,G,B,V,j,H,q,z,Q,$,Y,J,X,Z,ee)=>({worksheetFunctionNames:e,errorTypeNames:t,specialRefNames:Q,trueName:r,falseName:n,rowLetter:a,columnLetter:i,leftBrace:o,rightBrace:s,leftBracket:u,rightBracket:l,decimalSeparator:c,listSeparator:d,columnSeparator:g,rowSeparator:m,thousandsData:h,thousandsSeparator:p,lcid:f,country:S,numberDecimals:v,isExpSepBySpace:F,fractionSeparator:y,isPercentSepBySpace:b,currencyFormat:C,isCurrencySymbolLead:A,isCurrencySepBySpace:E,currencySymbol:T,currencyDecimals:R,dateOrder:k,dateSeparator:N,dateAltSeparator:I,year4Digits:O,month2Digits:P,day2Digits:M,longDateFormat:D,timeSeparator:w,timeAltSeparator:L,hour2Digits:_,clock24Hour:x,isAMPMSepBySpace:K,ampmSymbols:W,dayNameShort:U,dayNameLong:G,monthNameShort:B,monthNameLong:V,pictureSpecial:j,pictureSingle:H,pictureColor:q,pictureDbnum:z,sysDateFormat:$,sysTimeFormat:Y,cultureTagPrimary:J,cultureTagUserDefault:X,cultureTagInstLang:Z,cultureTagUserCurrent:ee}))),t.numberFormat=(0,n.typedInstanceCreator)()(((e,t,r)=>({iformat:e,formatString:t,builtIn:r}))),t.sheetName=(0,n.typedInstanceCreator)()(((e,t)=>({sheetId:e,sheetName:t}))),t.blankValue={kind:"Blank"},t.errorValue=(0,n.typedInstanceCreator)()((e=>({kind:"Error",type:e}))),t.richValue=(0,n.typedInstanceCreator)()((e=>({kind:"Rich",fields:e}))),t.getCellValueKind=function(e){return"object"==typeof e?e.kind:typeof e},t.getCellFormatKind=function(e){return"object"==typeof e?e.kind:typeof e},t.cellLocation=(0,n.typedInstanceCreator)()(((e,t)=>({row:e,column:t}))),t.rangeLocation=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({row:e,column:t,lastRow:r,lastColumn:n}))),t.sheetRangeLocation=(0,n.typedInstanceCreator)()(((e,t,r,n,a)=>({sheetId:e,row:t,column:r,lastRow:n,lastColumn:a}))),t.sheetCellLocation=(0,n.typedInstanceCreator)()(((e,t,r)=>({sheetId:e,row:t,column:r,lastRow:void 0,lastColumn:void 0}))),t.cellData=(0,n.typedInstanceCreator)()(((e,t,r,n,a)=>({formulaBarText:e,value:t,iformat:r,failureReason:n,kind:a}))),t.cellFormulaCellData=function(e,r,n,a){return(0,t.cellData)(e,r,n,a,"CellFormula")},t.arrayFormulaCellData=function(e,r,n){return(0,t.cellData)(void 0,e,r,n,"ArrayFormula")},t.valueCellData=function(e,r,n,a){return(0,t.cellData)(e,r,n,a,"Value")},t.rangeUpdate=(0,n.typedInstanceCreator)()(((e,t,r,n,a)=>({range:e,data:t,fromStateId:r,excludeRows:n,excludeColumns:a}))),t.rangeWrite=(0,n.typedInstanceCreator)()(((e,r,n,a)=>(0,t.rangeUpdate)(e,r,void 0,n,a))),t.rangePromote=function(e,r,n,a){return(0,t.rangeUpdate)(e,void 0,r,n,a)},t.arrayData=(0,n.typedInstanceCreator)()(((e,t)=>({isSpilled:e,formulaBarText:t}))),t.arrayUpdate=(0,n.typedInstanceCreator)()(((e,t,r)=>({range:e,data:t,fromStateId:r}))),t.arrayWrite=function(e,r){return(0,t.arrayUpdate)(e,r,void 0)},t.arrayPromote=function(e,r){return(0,t.arrayUpdate)(e,void 0,r)},t.unusedCellsUpdate=(0,n.typedInstanceCreator)()(((e,t)=>({sheetId:e,usedRange:t}))),t.namedValueData=(0,n.typedInstanceCreator)()((e=>({kind:"NamedValue",value:e}))),t.namedFormulaData=(0,n.typedInstanceCreator)()((e=>({kind:"NamedFormula",formulaBarText:e}))),t.namedRangeData=(0,n.typedInstanceCreator)()((e=>({kind:"NamedRange",range:e}))),t.columnData=(0,n.typedInstanceCreator)()(((e,t)=>({column:e,name:t}))),t.namedTableData=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({kind:"NamedTable",range:e,hasHeadersRow:t,hasTotalsRow:r,columns:n}))),t.namedFailureData=(0,n.typedInstanceCreator)()(((e,t)=>({kind:"NamedFailure",failureReason:e,objectKind:t}))),t.namedObject=(0,n.typedInstanceCreator)()(((e,t)=>({name:e,data:t}))),t.namedObjectsUpdate=(0,n.typedInstanceCreator)()(((e,t,r)=>({scope:e,objects:t,fromStateId:r}))),t.namedObjectsWrite=function(e,r){return(0,t.namedObjectsUpdate)(e,r,void 0)},t.undefinedNamesWrite=function(e){return(0,t.namedObjectsUpdate)(e,void 0,void 0)},t.namedObjectsPromote=function(e,r){return(0,t.namedObjectsUpdate)(e,void 0,r)},t.rangeFormulaEdit=(e,t,r,n,a,i="Inferred")=>({range:Array.isArray(e)?e:[e],formulaBarText:t,value:r,origin:n,viewport:a,kind:i}),t.cellFormulaRangeFormulaEdit=function(e,r,n,a){return(0,t.rangeFormulaEdit)(e,r,void 0,n,a,"CellFormula")},t.valueRangeFormulaEdit=function(e,r,n,a){return(0,t.rangeFormulaEdit)(e,r,n,void 0,a,"Value")},t.inferredRangeFormulaEdit=function(e,r,n,a){return(0,t.rangeFormulaEdit)(e,r,void 0,n,a,"Inferred")},t.formatEditOperation=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({kind:e,format:t,ribbon:r,changeDecimals:n}))),t.formatEditSetFormat=function(e){return(0,t.formatEditOperation)("SetFormat",e,void 0,void 0)},t.formatEditRibbonFormat=function(e){return(0,t.formatEditOperation)("RibbonFormat",void 0,e,void 0)},t.formatEditChangeDecimals=function(e){return(0,t.formatEditOperation)("ChangeDecimals",void 0,void 0,e)},t.rangeFormatEdit=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({range:e,operation:t,origin:r,viewport:n}))),t.arrayFormulaEdit=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({range:e,formulaBarText:t,origin:r,viewport:n}))),t.rangePasteEdit=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({kind:e,target:t,source:r,viewport:n}))),t.copyPasteRangePasteEdit=function(e,r,n){const a=(0,t.sheetCellLocation)(e.sheetId,e.row,e.column);return(0,t.rangePasteEdit)("CopyPaste",a,r,n)},t.inferredFormat=(0,n.typedInstanceCreator)()(((e,t,r)=>({format:e,category:t,decimals:r}))),t.cellDataDelta=(0,n.typedInstanceCreator)()(((e,t,r,n,a)=>({formulaBarText:e,value:t,format:r,formatted:n,hasHyperlink:a}))),t.rangeDelta=(0,n.typedInstanceCreator)()(((e,t)=>({range:e,data:t}))),t.arrayDelta=(0,n.typedInstanceCreator)()(((e,t)=>({range:e,data:t}))),t.rangeFailure=(0,n.typedInstanceCreator)()(((e,t)=>({range:e,reason:t}))),t.recalcResults=(0,n.typedInstanceCreator)()(((e,t,r,n,a,i)=>({stateId:e,priorityGroup:t,isFinished:r,rangeDeltas:n,arrayDeltas:a,rangeFailures:i}))),t.evalFormulaFormat=(0,n.typedInstanceCreator)()(((e,t,r)=>({kind:e,iformat:t,knownFormat:r}))),t.evalFormulaFormatOrigin=function(){return(0,t.evalFormulaFormat)("Origin")},t.evalFormulaFormatIformat=function(e){return(0,t.evalFormulaFormat)("Iformat",e)},t.evalFormulaFormatKnown=function(e){return(0,t.evalFormulaFormat)("Known",void 0,e)},t.evalFormulaFormatInferred=function(){return(0,t.evalFormulaFormat)("Inferred")},t.evalFormulaFormatAggregate=function(){return(0,t.evalFormulaFormat)("Aggregate")},t.evalFormulaData=function(e,t){return{value:e,formatted:t}},t.updateRequest=(0,n.typedInstanceCreator)()(((e,t,r)=>({rangeUpdateRanges:e,arrayUpdateRanges:t,namesUpdateScopes:r}))),t.runExperiment=(0,n.typedInstanceCreator)()(((e,t)=>({name:e,param:t}))),t.recalcServiceConfig=(0,n.typedInstanceCreator)()(((e,t,r,n,a,i,o,s,u,l,c=(null==l?void 0:l/(l>=1?1:10)),d)=>({totalEvalTimeMs:e,samplePrecisionEvalRate:t,samplePrecisionPrintFormulaRate:l,samplePrecisionPrintValueRate:c,sampleRecalcStatisticsRate:s,sampleWorkbookStatisticsRate:n,sampleRecalcEditedStopwatchRate:a,sampleRecalcViewportStopwatchRate:i,sampleCellEvalStopwatchRate:o,rngSeed:r,volatileMode:d,runExperiments:u}))),t.workbookProps=(0,n.typedInstanceCreator)()(((e,t,r)=>({date1904:e,dateCompatibility:t,timezone:r}))),function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(i||(t.RecalcServiceCreateMode=i={}))},5405:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertX10RangeFormulaEditsToCalcRangeFormulaEdits=t.convertX10UpdatesToCalcUpdates=t.RecalcSideGrid=void 0;const n=r(3345),a=r(6366),i=r(6366),o=r(6366),s=r(6366),u=r(6366),l=r(6366),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(6067),F=r(8338),y=r(2393),b=n.__importStar(r(4067)),C=r(429),A=r(222),E=r(6869),T=r(6468),R=r(5013),k=r(6067);function N(e,t){return e.map((e=>{if(!(0,a.isDefined)(e.data))return{data:void 0,range:(0,A.sheetGridRangeToLocation)(e.range)};const r=(0,A.readOperToCellValue)(t,e.data.value);return{data:{kind:e.data.kind,formulaBarText:e.data.formulaBarText,value:r??C.blankValue,iformat:e.data.iformat,failureReason:void 0===r?"unsupported Oper serialization":void 0},range:(0,A.sheetGridRangeToLocation)(e.range)}}))}function I(e,t){return e.map((e=>{const[r,...n]=e.range,i=[(0,A.sheetGridRangeToLocation)(r),...n.map((e=>(0,A.sheetGridRangeToLocation)(e)))];return{kind:e.kind,range:i,formulaBarText:e.formulaBarText,value:(0,a.isDefined)(e.value)?(0,A.readOperToCellValue)(t,e.value):void 0,origin:(0,a.isDefined)(e.origin)?(0,A.gridCellToCellLocation)(e.origin):void 0}}))}(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),t.RecalcSideGrid=class{async createIGridExportEndpoint(e){await b.Endpoint.createInside(e,(()=>this))}discardSnapshot(e){return void 0!==this.snapshotPromises[e]&&(delete this.snapshotPromises[e],!0)}async evalClonedModelOnSnapshot(e,t,r,n){const{snapshot:a}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===a)return(0,s.failure)((0,f.unavailable)(["evalOnClonedModel"]));const i=N(t,a.config.mathpack),o=I(r,a.config.mathpack),l=this.calcGrid.evalOnClonedModelOnSnapshot(i,o,a,n);return this.calcGrid.resumeRecalc(),(0,u.success)(await l)}async evalFormulaOnSnapshot(e,t,r,n={kind:E.SpecialFormat.Origin}){const{snapshot:a}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===a)return(0,s.failure)((0,f.unavailable)(["evalFormula"]));const i=this.calcGrid.evalFormulaOnSnapshotImpl(t,r,n,a);this.calcGrid.resumeRecalc();const o=function(e){if(e.value.kind===l.ResultKind.Failure&&e.value.reason.kind===p.ReasonKind.Unavailable){const t=e.value.reason.objects;for(let e=0;e<t.length;e++){const r=t[e];r.kind===E.UnavailableKind.GridRange&&(t[e]={...r,unavailableCells:!0})}}return e}(await i);return(0,u.success)(o)}async getSheetNames(e){const{snapshot:t}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===t)return(0,s.failure)((0,f.unavailable)(["getSheetNames"]));const r={document:this.calcGrid.document,sheets:new Array},n=t.getSheetRangeIndexes((0,c.allSheetsRange)(this.calcGrid.document));if(!(0,o.isSuccess)(n))return n;for(const e of n.value.sheets){const n=t.getSheetName(this.calcGrid.document,e);if(!(0,o.isSuccess)(n))return n;r.sheets.push({sheetIndex:(0,h.sheetIndex)(this.calcGrid.document,e),sheetName:n.value})}return(0,u.success)(r)}async getCorrespondingSnapshotID(e){const t=await this.getOrCreateSnapshot(e);return void 0===t?-1:t.correspondingId}async getOrCreateSnapshot(e){return void 0===this.snapshotPromises[e]&&(this.snapshotPromises[e]=this.calcGrid.dataModel.createSnapshot(e),this.calcGrid.resumeRecalc().catch((e=>{setTimeout((()=>{throw e}))}))),this.snapshotPromises[e]}getRangeFormats(e,t){return this.getRangeData(e,t,"formats")}getRangeValues(e,t){return this.getRangeData(e,t,"values")}getRangeFormulae(e,t){return this.getRangeData(e,t,"formulae")}async getRangeData(e,t,r){const{snapshot:n}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===n)return(0,s.failure)((0,f.unavailable)(["getRangeData/getOrCreateSnapshot"]));const a=n.allEditedAvailable(t);if(a.kind!==l.ResultKind.Success)return(0,s.failure)((0,f.unavailable)(["getRangeData/allEditedAvailable"]));let i=(0,T.createCellSetFromRange)(t.range);!0!==a.value&&(i=(0,R.exceptProduct)(i,a.value));const o=e=>{const r=[];return(0,T.forEachRangeInSet)(i,(n=>{const a=e((0,m.sheetGridRange)(t.sheet,n),(e=>{i=(0,R.exceptProduct)(i,(0,T.createCellSetFromRange)(e))}),((e,t)=>{r.push([[e.row,e.col],t])}));return a.kind===l.ResultKind.Success&&a.value}))?(0,u.success)(r):(0,s.failure)((0,f.unavailable)(["getRangeData/extractData"]))},c={formulae:()=>o(((e,t,r)=>n.forEachEditedFormula(e,((e,{lexicalKind:n,compiledFmla:a,fmla:i,origin:o})=>(n!==g.LexicalKind.Range&&(0,S.isGridCell)(e)?(0,y.isBlankGridFormula)(i,void 0!==a)||r(e,{kind:void 0!==a?F.FormulaKind.CellFormula:F.FormulaKind.Value,formulaBarText:i,origin:(0,v.isGridCellEqual)(o,e)?void 0:o}):t(e),!0))))),formats:()=>o(((e,t,r)=>n.forEachEditedFormat(e,((e,n)=>(n===E.SpecialFormat.Unavailable?t(e):(0,y.isBlankCellFormat)(n)||r(e,"number"==typeof n?n:n.formatString),!0))))),values:()=>o(((e,t,r)=>n.forEachRecalcValue(e,((e,n)=>(void 0!==n.failure?t(e):(0,y.isBlankGridValue)(n.oper,n.failure)||r(e,n.oper),!0)))))}[r]();if(c.kind!==l.ResultKind.Success)return c;const d=[];return(0,T.forEachRangeInSet)(i,(e=>(d.push(e),!0))),(0,u.success)({nonEmptyCells:c.value,availableRanges:d})}async getIntersectingTables(e,t){const{snapshot:r}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===r)return(0,s.failure)((0,f.unavailable)(["getIntersectingTables/getOrCreateSnapshot"]));const n=r.allServerAvailable(t);if(n.kind!==l.ResultKind.Success)return(0,s.failure)((0,f.unavailable)(["getIntersectingTables/allServerAvailable"]));const a=r.getIntersectingTables(t);if(!(0,o.isSuccess)(a))return(0,s.failure)((0,f.unavailable)(["getIntersectingTables/getIntersectingTables"]));const i=[];for(const e of a.value){const t=r.getNamedObject(e,d.NameSource.Plain);if(t.kind!==l.ResultKind.Success)return t;if("NamedTable"!==t.value?.kind)continue;const n=[];t.value.columnIndexes.forEach(((e,t)=>(n.push({column:e,name:t}),!0))),i.push({name:e.name,dataRange:t.value.specialRefRanges[k.SpecialRefId.Data].range,hasHeadersRow:t.value.hasHeadersRow,hasTotalsRow:t.value.hasTotalsRow,columns:n})}const c=(0,T.createCellSetFromRange)(t.range),g=!0===n.value?c:(0,R.exceptProduct)(c,n.value),m=[];return(0,T.forEachRangeInSet)(g,(e=>(m.push(e),!0))),(0,u.success)({tables:i,availableRanges:m})}async getIformats(e,t,r,n){const{snapshot:a}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===a)return(0,s.failure)((0,f.unavailable)(["getIformats/getOrCreateSnapshot"]));const i=a.getIformats(t,r,n);return(0,o.isSuccess)(i)?(0,u.success)({availableFormats:i.value}):(0,s.failure)((0,f.unavailable)(["getIformats/getIntersectingTables"]))}async getHiddenRows(e,t,r,n){const{snapshot:a}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};return void 0===a?y.hiddennessFullyUnavailable:a.getHiddenRows(t,r,n)}async getHiddenCols(e,t,r,n){const{snapshot:a}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};return void 0===a?y.hiddennessFullyUnavailable:a.getHiddenCols(t,r,n)}constructor(e){this.calcGrid=e,this.snapshotPromises=[]}},t.convertX10UpdatesToCalcUpdates=N,t.convertX10RangeFormulaEditsToCalcRangeFormulaEdits=I},1172:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeUnavailableCellsStats=void 0;const n=r(6869),a=r(6468),i=r(6067),o=r(6067),s=r(5013),u=r(6366),l=r(9207);t.computeUnavailableCellsStats=function(e){const t=(0,u.makeStringMap)(),r=(0,u.makeStringMap)();for(const a of e){const e=a.range;if(a.reason.kind===i.LangReasonKind.Unavailable)for(const i of a.reason.objects)i.kind===n.UnavailableKind.GridRange&&((0,o.isSheetIndexEqual)(i.range.sheet,e.sheet)?t[i.range.sheet.index]=(0,s.unionProduct)(t[i.range.sheet.index]??l.empty,!0!==i.unavailableCells?i.unavailableCells:l.empty):r[i.range.sheet.index]=(0,s.unionProduct)(r[i.range.sheet.index]??l.empty,!0!==i.unavailableCells?i.unavailableCells:l.empty))}let c=0,d=0,g=0;const m=(0,u.makeStringMap)();for(const e in t){const r=t[e]??l.empty;m[e]=(0,s.unionProduct)(m[e]??l.empty,r),(0,a.forEachRangeInSet)(r,(e=>(c+=e.rows*e.cols,!0)))}for(const e in r){const t=r[e]??l.empty;m[e]=(0,s.unionProduct)(m[e]??l.empty,t),(0,a.forEachRangeInSet)(t,(e=>(d+=e.rows*e.cols,!0)))}for(const e in m){const t=m[e]??l.empty;(0,a.forEachRangeInSet)(t,(e=>(g+=e.rows*e.cols,!0)))}return{numOfUnavailableCellsInTheSameSheet:c,numOfUnavailableCellsInDifferentSheet:d,totalNumOfUnavailableCells:g}}},637:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeImpl=t.VolatileMode=t.asyncLazy=t.ResettableLazy=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6869),s=r(6067),u=r(6067),l=r(6067),c=r(3228),d=r(6067),g=r(6067);class m{getValue(){return void 0===this.value&&(this.value=this.valueCreationFunc()),this.value}force(){void 0===this.value&&(this.value=this.valueCreationFunc())}reset(){this.value=void 0}constructor(e){this.valueCreationFunc=e,this.value=void 0}}var h;t.ResettableLazy=m,t.asyncLazy=function(e){return new m(e)},function(e){e.GroundTruth="GroundTruth",e.Estimation="Estimation",e.PrecisionTest="PrecisionTest"}(h||(t.VolatileMode=h={}));const p=()=>new Date;t.getTimeImpl=function(e,t,r,m=h.Estimation,f=p){switch(m){case h.PrecisionTest:return(0,a.failure)((0,g.unavailable)([{kind:o.UnavailableKind.GetTimeKind,getTimeKind:r}]));case h.Estimation:switch(r){case c.GetTimeKind.NonVolatile:return(0,a.failure)((0,g.unavailable)([{kind:o.UnavailableKind.GetTimeKind,getTimeKind:r}]));case c.GetTimeKind.ValueCell:case c.GetTimeKind.Volatile:}case h.GroundTruth:}const{mathpack:S,datepack:v}=e,F=f(),y=v.utcToLocal(e,(0,s.dateTime)(F.getUTCFullYear(),F.getUTCMonth()+1,F.getUTCDate(),F.getUTCHours(),F.getUTCMinutes(),F.getUTCSeconds(),F.getUTCDay()+1,F.getUTCMilliseconds(),u.Rounding.Round1000ths),e.timezone);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: to local",!1!==y);const{yr:b,rounding:C}=y;let{mon:A,dom:E,hour:T,min:R,sec:k,fracSec:N}=y;t<l.TimeGranularity.Instant&&(N=0,k=0,R=0,T=0),t<l.TimeGranularity.Day&&(E=1,A=1);const I=(0,s.dateTime)(b,A,E,T,R,k,1,N,C),O=v.toNum(e,I);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,d.isErrorOper)(O));const P=S.toNumber(O);if(m===h.GroundTruth)return(0,i.success)(O);const M=v.toNum(e,y);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,d.isErrorOper)(M));const D=S.toNumber(M);let w;switch(t){case l.TimeGranularity.Instant:w=D;break;case l.TimeGranularity.Day:w=P+1;break;case l.TimeGranularity.Year:{const t=(0,s.dateTime)(b+1,A,E,T,R,k,1,N,C),r=v.toNum(e,t);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,d.isErrorOper)(r)),w=S.toNumber(r);break}}const L=10/1440;return D<P+L||D>w-L?(0,a.failure)((0,g.unavailable)([{kind:o.UnavailableKind.TimeGranularity,granularity:t}])):(0,i.success)(O)}},4663:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chFiniteNumber=t.check=t.chBoolean=t.arrayChecker=t.incrementFailure=t.registerExperimentFactory=t.ExperimentKind=t.UnitExperiment=t.blankStyleValue=t.forEachProduct=t.project=t.compareProduct=t.intersectProduct=t.exceptProduct=t.meetsProduct=t.unionProduct=t.union=t.dense=t.empty=t.namedTable=t.namedFormula=t.makeGridRangeTable=t.forEachRangeInSet=t.forEachCellInSet=t.bspFactory=t.createCellSetFromRange=t.PartialWorkbook=t.blankStyle=t.knownFormatData=t.genFmt=t.locale=t.createRange=t.mathpack=t.englishLocaleData=t.blankCellFormat=t.CloningTarget=t.sheetInFilterMode=t.sheetHiddenRows=t.UnavailableKind=t.OutputMessageKind=t.isFailureOutputMessage=t.SpecialFormat=t.SpecialStyle=t.ComputeKind=t.ComputedCellKind=t.createSheetCellSetFromRange=t.sheetCellSet=t.voidCallback=t.VolatileMode=t.PartialWorkbookDocumentCollection=void 0,t.optChecker=t.oneOfChecker=t.objectChecker=t.chPossiblyInfiniteNumber=void 0;const n=r(3345),a=n.__importStar(r(637)),i=n.__importStar(r(1167)),o=n.__importStar(r(6869)),s=n.__importStar(r(8760)),u=n.__importStar(r(1585)),l=n.__importStar(r(2393)),c=n.__importStar(r(1674)),d=n.__importStar(r(6468)),g=r(6366),m=r(6366),h=n.__importStar(r(5775)),p=n.__importStar(r(6933)),f=n.__importStar(r(3319)),S=n.__importStar(r(3519)),v=n.__importStar(r(3697)),F=n.__importStar(r(8072));t.PartialWorkbookDocumentCollection=s.PartialWorkbookDocumentCollection,t.VolatileMode=a.VolatileMode,t.voidCallback=s.voidCallback,t.sheetCellSet=o.sheetCellSet,t.createSheetCellSetFromRange=o.createSheetCellSetFromRange,t.ComputedCellKind=o.ComputedCellKind,t.ComputeKind=o.ComputeKind,t.SpecialStyle=o.SpecialStyle,t.SpecialFormat=o.SpecialFormat,t.isFailureOutputMessage=i.isFailureOutputMessage,t.OutputMessageKind=o.OutputMessageKind,t.UnavailableKind=o.UnavailableKind,t.sheetHiddenRows=o.sheetHiddenRows,t.sheetInFilterMode=o.sheetInFilterMode,t.CloningTarget=l.CloningTarget,t.blankCellFormat=l.blankCellFormat,t.englishLocaleData=c.englishLocaleData,t.mathpack=c.mathpack,t.createRange=c.createRange,t.locale=c.locale,t.genFmt=c.genFmt,t.knownFormatData=c.knownFormatData,t.blankStyle=c.blankStyle,t.PartialWorkbook=u.PartialWorkbook,t.createCellSetFromRange=d.createCellSetFromRange,t.bspFactory=d.bspFactory,t.forEachCellInSet=d.forEachCellInSet,t.forEachRangeInSet=d.forEachRangeInSet;var y=r(6067);Object.defineProperty(t,"makeGridRangeTable",{enumerable:!0,get:function(){return y.makeGridRangeTable}}),t.namedFormula=p.namedFormula,t.namedTable=p.namedTable,t.empty=g.bspSet.empty,t.dense=g.bspSet.dense,t.union=g.bspSet.union,t.unionProduct=m.productSet.unionProduct,t.meetsProduct=m.productSet.meetsProduct,t.exceptProduct=m.productSet.exceptProduct,t.intersectProduct=m.productSet.intersectProduct,t.compareProduct=m.productSet.compareProduct,t.project=m.productSet.project,t.forEachProduct=m.productSet.forEachProduct,t.blankStyleValue=h.blankStyleValue,t.UnitExperiment=v.UnitExperiment,t.ExperimentKind=f.ExperimentKind,t.registerExperimentFactory=f.registerExperimentFactory,t.incrementFailure=F.incrementFailure,t.arrayChecker=S.arrayChecker,t.chBoolean=S.chBoolean,t.check=S.check,t.chFiniteNumber=S.chFiniteNumber,t.chPossiblyInfiniteNumber=S.chPossiblyInfiniteNumber,t.objectChecker=S.objectChecker,t.oneOfChecker=S.oneOfChecker,t.optChecker=S.optChecker},8728:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copyPasteRangePasteEdit=t.rangePasteEdit=t.arrayFormulaEdit=t.rangeFormatEdit=t.formatEditChangeDecimals=t.formatEditRibbonFormat=t.formatEditSetFormat=t.formatEditOperation=t.RibbonFormat=t.inferredRangeFormulaEdit=t.valueRangeFormulaEdit=t.cellFormulaRangeFormulaEdit=t.rangeFormulaEdit=t.columnData=t.namedTableData=t.namedObjectsPromote=t.undefinedNamesWrite=t.namedObjectsWrite=t.namedObjectsUpdate=t.namedObject=t.namedFailureData=t.namedRangeData=t.namedFormulaData=t.namedValueData=t.unusedCellsUpdate=t.arrayPromote=t.arrayWrite=t.arrayUpdate=t.arrayData=t.rangePromote=t.rangeWrite=t.rangeUpdate=t.valueCellData=t.arrayFormulaCellData=t.cellFormulaCellData=t.cellData=t.sheetCellLocation=t.sheetRangeLocation=t.rangeLocation=t.cellLocation=t.getCellFormatKind=t.getCellValueKind=t.richValue=t.errorValue=t.blankValue=t.sheetName=t.numberFormat=t.localeData=t.errorTypeName=t.worksheetFunctionName=void 0,t.internal=t.RecalcServiceDataTransformer=t.getTime=t.recalcServiceInsideInit=t.readOperToCellValue=t.cellValueToReadOper=t.localeInfoFromData=t.RecalcServiceCreateMode=t.createRecalcService=t.workbookProps=t.recalcServiceConfig=t.runExperiment=t.updateRequest=t.evalFormulaFormatAggregate=t.evalFormulaFormatInferred=t.evalFormulaFormatKnown=t.evalFormulaFormatIformat=t.evalFormulaFormatOrigin=t.evalFormulaFormat=t.evalFormulaData=t.recalcResults=t.rangeFailure=t.arrayDelta=t.rangeDelta=t.cellDataDelta=t.inferredFormat=void 0;const n=r(3345),a=n.__importStar(r(429)),i=n.__importStar(r(2327)),o=n.__importStar(r(222)),s=n.__importStar(r(7753)),u=n.__importStar(r(637)),l=n.__importStar(r(4663)),c=n.__importStar(r(8072));t.worksheetFunctionName=a.worksheetFunctionName,t.errorTypeName=a.errorTypeName,t.localeData=a.localeData,t.numberFormat=a.numberFormat,t.sheetName=a.sheetName,t.blankValue=a.blankValue,t.errorValue=a.errorValue,t.richValue=a.richValue,t.getCellValueKind=a.getCellValueKind,t.getCellFormatKind=a.getCellFormatKind,t.cellLocation=a.cellLocation,t.rangeLocation=a.rangeLocation,t.sheetRangeLocation=a.sheetRangeLocation,t.sheetCellLocation=a.sheetCellLocation,t.cellData=a.cellData,t.cellFormulaCellData=a.cellFormulaCellData,t.arrayFormulaCellData=a.arrayFormulaCellData,t.valueCellData=a.valueCellData,t.rangeUpdate=a.rangeUpdate,t.rangeWrite=a.rangeWrite,t.rangePromote=a.rangePromote,t.arrayData=a.arrayData,t.arrayUpdate=a.arrayUpdate,t.arrayWrite=a.arrayWrite,t.arrayPromote=a.arrayPromote,t.unusedCellsUpdate=a.unusedCellsUpdate,t.namedValueData=a.namedValueData,t.namedFormulaData=a.namedFormulaData,t.namedRangeData=a.namedRangeData,t.namedFailureData=a.namedFailureData,t.namedObject=a.namedObject,t.namedObjectsUpdate=a.namedObjectsUpdate,t.namedObjectsWrite=a.namedObjectsWrite,t.undefinedNamesWrite=a.undefinedNamesWrite,t.namedObjectsPromote=a.namedObjectsPromote,t.namedTableData=a.namedTableData,t.columnData=a.columnData,t.rangeFormulaEdit=a.rangeFormulaEdit,t.cellFormulaRangeFormulaEdit=a.cellFormulaRangeFormulaEdit,t.valueRangeFormulaEdit=a.valueRangeFormulaEdit,t.inferredRangeFormulaEdit=a.inferredRangeFormulaEdit,t.RibbonFormat=a.RibbonFormat,t.formatEditOperation=a.formatEditOperation,t.formatEditSetFormat=a.formatEditSetFormat,t.formatEditRibbonFormat=a.formatEditRibbonFormat,t.formatEditChangeDecimals=a.formatEditChangeDecimals,t.rangeFormatEdit=a.rangeFormatEdit,t.arrayFormulaEdit=a.arrayFormulaEdit,t.rangePasteEdit=a.rangePasteEdit,t.copyPasteRangePasteEdit=a.copyPasteRangePasteEdit,t.inferredFormat=a.inferredFormat,t.cellDataDelta=a.cellDataDelta,t.rangeDelta=a.rangeDelta,t.arrayDelta=a.arrayDelta,t.rangeFailure=a.rangeFailure,t.recalcResults=a.recalcResults,t.evalFormulaData=a.evalFormulaData,t.evalFormulaFormat=a.evalFormulaFormat,t.evalFormulaFormatOrigin=a.evalFormulaFormatOrigin,t.evalFormulaFormatIformat=a.evalFormulaFormatIformat,t.evalFormulaFormatKnown=a.evalFormulaFormatKnown,t.evalFormulaFormatInferred=a.evalFormulaFormatInferred,t.evalFormulaFormatAggregate=a.evalFormulaFormatAggregate,t.updateRequest=a.updateRequest,t.runExperiment=a.runExperiment,t.recalcServiceConfig=a.recalcServiceConfig,t.workbookProps=a.workbookProps,t.createRecalcService=i.createRecalcService,t.RecalcServiceCreateMode=a.RecalcServiceCreateMode,t.localeInfoFromData=o.localeInfoFromData,t.cellValueToReadOper=o.cellValueToReadOper,t.readOperToCellValue=o.readOperToCellValue,t.recalcServiceInsideInit=s.recalcServiceInsideInit,t.getTime=u.getTimeImpl,t.RecalcServiceDataTransformer=c.RecalcServiceDataTransformer,t.internal=l},4955:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExcelOnlineCalcNewPackagesNames=void 0;const n=r(6366),a=r(6067),i=r(472),o=r(3228),s=r(8073),u=r(3271),l=`${n.PackageName}, ${a.PackageName},\n  ${i.PackageName}, ${o.PackageName}, ${s.PackageName}, ${u.PackageName}`;t.getExcelOnlineCalcNewPackagesNames=function(){return l}},1912:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pair=t.ResultKind=t.arrayFill=t.stringEndsWith=t.stringStartsWith=t.isInteger=t.messageFromError=t.assertIndex=t.assertPositiveInteger=t.assertPositiveLength=t.assertFalse=t.assertTrue=t.assertNatural=t.assertNever=t.Pledge=t.JSF32=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.now=t.makeStringMap=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.numEnumMap=t.numEnumArray=t.identity=t.fastAbs=t.fastMax=t.fastMin=void 0;var n=r(6366);Object.defineProperty(t,"fastMin",{enumerable:!0,get:function(){return n.fastMin}}),Object.defineProperty(t,"fastMax",{enumerable:!0,get:function(){return n.fastMax}}),Object.defineProperty(t,"fastAbs",{enumerable:!0,get:function(){return n.fastAbs}}),Object.defineProperty(t,"identity",{enumerable:!0,get:function(){return n.identity}}),Object.defineProperty(t,"numEnumArray",{enumerable:!0,get:function(){return n.numEnumArray}}),Object.defineProperty(t,"numEnumMap",{enumerable:!0,get:function(){return n.numEnumMap}}),Object.defineProperty(t,"safePush",{enumerable:!0,get:function(){return n.safePush}}),Object.defineProperty(t,"safeConcat",{enumerable:!0,get:function(){return n.safeConcat}}),Object.defineProperty(t,"isDefined",{enumerable:!0,get:function(){return n.isDefined}}),Object.defineProperty(t,"isNone",{enumerable:!0,get:function(){return n.isNone}}),Object.defineProperty(t,"makeStringMap",{enumerable:!0,get:function(){return n.makeStringMap}}),Object.defineProperty(t,"now",{enumerable:!0,get:function(){return n.now}}),Object.defineProperty(t,"staticAssertExtends",{enumerable:!0,get:function(){return n.staticAssertExtends}}),Object.defineProperty(t,"staticAssertSame",{enumerable:!0,get:function(){return n.staticAssertSame}}),Object.defineProperty(t,"staticAssertIs",{enumerable:!0,get:function(){return n.staticAssertIs}}),Object.defineProperty(t,"staticAssertIsOptional",{enumerable:!0,get:function(){return n.staticAssertIsOptional}}),Object.defineProperty(t,"JSF32",{enumerable:!0,get:function(){return n.JSF32}}),Object.defineProperty(t,"Pledge",{enumerable:!0,get:function(){return n.Pledge}}),Object.defineProperty(t,"assertNever",{enumerable:!0,get:function(){return n.assertNever}}),Object.defineProperty(t,"assertNatural",{enumerable:!0,get:function(){return n.assertNatural}}),Object.defineProperty(t,"assertTrue",{enumerable:!0,get:function(){return n.assertTrue}}),Object.defineProperty(t,"assertFalse",{enumerable:!0,get:function(){return n.assertFalse}}),Object.defineProperty(t,"assertPositiveLength",{enumerable:!0,get:function(){return n.assertPositiveLength}}),Object.defineProperty(t,"assertPositiveInteger",{enumerable:!0,get:function(){return n.assertPositiveInteger}}),Object.defineProperty(t,"assertIndex",{enumerable:!0,get:function(){return n.assertIndex}}),Object.defineProperty(t,"messageFromError",{enumerable:!0,get:function(){return n.messageFromError}}),Object.defineProperty(t,"isInteger",{enumerable:!0,get:function(){return n.isInteger}}),Object.defineProperty(t,"stringStartsWith",{enumerable:!0,get:function(){return n.stringStartsWith}}),Object.defineProperty(t,"stringEndsWith",{enumerable:!0,get:function(){return n.stringEndsWith}}),Object.defineProperty(t,"arrayFill",{enumerable:!0,get:function(){return n.arrayFill}}),Object.defineProperty(t,"ResultKind",{enumerable:!0,get:function(){return n.ResultKind}}),Object.defineProperty(t,"pair",{enumerable:!0,get:function(){return n.pair}})},5293:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createIsThousandsPositionCallback=t.createWorksheetFuncNameCallbacks=t.operatorIdToName=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.calcConfig=t.PictureDbnum=t.PictureColor=t.PictureSingle=t.PictureSpecial=t.Country=t.LCID=t.localeInfo=t.ulsLogger=t.NulLogger=t.TraceLevel=t.LogCategory=t.FeatureName=t.getCalcAbsUrl=t.isCalcInit=t.initCalc=void 0;var n=r(6366);Object.defineProperty(t,"initCalc",{enumerable:!0,get:function(){return n.initCalc}}),Object.defineProperty(t,"isCalcInit",{enumerable:!0,get:function(){return n.isCalcInit}}),Object.defineProperty(t,"getCalcAbsUrl",{enumerable:!0,get:function(){return n.getCalcAbsUrl}}),Object.defineProperty(t,"FeatureName",{enumerable:!0,get:function(){return n.FeatureName}});var a=r(6067);Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return a.LogCategory}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return a.TraceLevel}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return a.NulLogger}}),Object.defineProperty(t,"ulsLogger",{enumerable:!0,get:function(){return a.ulsLogger}}),Object.defineProperty(t,"localeInfo",{enumerable:!0,get:function(){return a.localeInfo}}),Object.defineProperty(t,"LCID",{enumerable:!0,get:function(){return a.LCID}}),Object.defineProperty(t,"Country",{enumerable:!0,get:function(){return a.Country}}),Object.defineProperty(t,"PictureSpecial",{enumerable:!0,get:function(){return a.PictureSpecial}}),Object.defineProperty(t,"PictureSingle",{enumerable:!0,get:function(){return a.PictureSingle}}),Object.defineProperty(t,"PictureColor",{enumerable:!0,get:function(){return a.PictureColor}}),Object.defineProperty(t,"PictureDbnum",{enumerable:!0,get:function(){return a.PictureDbnum}}),Object.defineProperty(t,"calcConfig",{enumerable:!0,get:function(){return a.calcConfig}}),Object.defineProperty(t,"getEnglishLocaleInfo",{enumerable:!0,get:function(){return a.getEnglishLocaleInfo}}),Object.defineProperty(t,"englishWorksheetFuncIdToName",{enumerable:!0,get:function(){return a.englishWorksheetFuncIdToName}}),Object.defineProperty(t,"englishErrorTypeToName",{enumerable:!0,get:function(){return a.englishErrorTypeToName}}),Object.defineProperty(t,"englishOperatorIdToName",{enumerable:!0,get:function(){return a.englishOperatorIdToName}}),Object.defineProperty(t,"operatorIdToName",{enumerable:!0,get:function(){return a.operatorIdToName}}),Object.defineProperty(t,"createWorksheetFuncNameCallbacks",{enumerable:!0,get:function(){return a.createWorksheetFuncNameCallbacks}}),Object.defineProperty(t,"createIsThousandsPositionCallback",{enumerable:!0,get:function(){return a.createIsThousandsPositionCallback}})},8907:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.TimeGranularity=t.dateTime=t.tzUTC=t.tzData=t.Rounding=t.TimeDivision=void 0;var n=r(6067);Object.defineProperty(t,"TimeDivision",{enumerable:!0,get:function(){return n.TimeDivision}}),Object.defineProperty(t,"Rounding",{enumerable:!0,get:function(){return n.Rounding}}),Object.defineProperty(t,"tzData",{enumerable:!0,get:function(){return n.tzData}}),Object.defineProperty(t,"tzUTC",{enumerable:!0,get:function(){return n.tzUTC}}),Object.defineProperty(t,"dateTime",{enumerable:!0,get:function(){return n.dateTime}}),Object.defineProperty(t,"TimeGranularity",{enumerable:!0,get:function(){return n.TimeGranularity}}),Object.defineProperty(t,"xlDatepack",{enumerable:!0,get:function(){return n.xlDatepack}})},1175:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contextNameNode=t.fieldRefNamePart=t.cellRefNamePart=t.identNamePart=t.nameNode=t.parenNode=t.wsfNode=t.operatorNode=t.lambdaNode=t.lambdaParam=t.paramNode=t.paramDefault=t.paramName=t.flattenLambdaArgs=t.letNode=t.letVar=t.indexedArg=t.flattenLetArgs=t.appNode=t.arrayNode=t.literalNode=t.formulaSpan=t.singleLineComment=t.multiLineComment=t.formula=t.cellRefBad=t.cellRefCol=t.cellRefRow=t.cellRefRange=t.cellRefSingle=t.cellRefError=t.pos=t.badQualifier=t.sheetRangeQualifier=t.identQualifier=t.sheetQualifier=t.documentQualifier=t.relativeQualifier=t.errorQualifier=t.BadType=t.StructRefKind=t.SpecialRefId=t.NamePartKind=t.NodeKind=t.CommentKind=t.PosKind=t.CellRefKind=t.QualifierKind=t.SyntaxFeature=t.RefStyle=void 0,t.localNameDeclAnnotation=t.localNameUseAnnotation=t.formulaRootAnnotation=t.appHeadNameAnnotation=t.AnnotationKind=t.headNamePart=t.flattenNameParts=t.badSequenceNode=t.badCharsNode=t.missingNode=t.identNode=t.varNode=t.badRef=t.missingRef=t.thisRowOpRef=t.commaOpRef=t.rangeOpRef=t.columnRef=t.specialRef=t.structRef=t.structRefNode=t.fieldRef=t.fieldRefNode=t.cellRefNode=void 0;var n=r(6067);Object.defineProperty(t,"RefStyle",{enumerable:!0,get:function(){return n.RefStyle}}),Object.defineProperty(t,"SyntaxFeature",{enumerable:!0,get:function(){return n.SyntaxFeature}}),Object.defineProperty(t,"QualifierKind",{enumerable:!0,get:function(){return n.QualifierKind}}),Object.defineProperty(t,"CellRefKind",{enumerable:!0,get:function(){return n.CellRefKind}}),Object.defineProperty(t,"PosKind",{enumerable:!0,get:function(){return n.PosKind}}),Object.defineProperty(t,"CommentKind",{enumerable:!0,get:function(){return n.CommentKind}}),Object.defineProperty(t,"NodeKind",{enumerable:!0,get:function(){return n.NodeKind}}),Object.defineProperty(t,"NamePartKind",{enumerable:!0,get:function(){return n.NamePartKind}}),Object.defineProperty(t,"SpecialRefId",{enumerable:!0,get:function(){return n.SpecialRefId}}),Object.defineProperty(t,"StructRefKind",{enumerable:!0,get:function(){return n.StructRefKind}}),Object.defineProperty(t,"BadType",{enumerable:!0,get:function(){return n.BadType}}),Object.defineProperty(t,"errorQualifier",{enumerable:!0,get:function(){return n.errorQualifier}}),Object.defineProperty(t,"relativeQualifier",{enumerable:!0,get:function(){return n.relativeQualifier}}),Object.defineProperty(t,"documentQualifier",{enumerable:!0,get:function(){return n.documentQualifier}}),Object.defineProperty(t,"sheetQualifier",{enumerable:!0,get:function(){return n.sheetQualifier}}),Object.defineProperty(t,"identQualifier",{enumerable:!0,get:function(){return n.identQualifier}}),Object.defineProperty(t,"sheetRangeQualifier",{enumerable:!0,get:function(){return n.sheetRangeQualifier}}),Object.defineProperty(t,"badQualifier",{enumerable:!0,get:function(){return n.badQualifier}}),Object.defineProperty(t,"pos",{enumerable:!0,get:function(){return n.pos}}),Object.defineProperty(t,"cellRefError",{enumerable:!0,get:function(){return n.cellRefError}}),Object.defineProperty(t,"cellRefSingle",{enumerable:!0,get:function(){return n.cellRefSingle}}),Object.defineProperty(t,"cellRefRange",{enumerable:!0,get:function(){return n.cellRefRange}}),Object.defineProperty(t,"cellRefRow",{enumerable:!0,get:function(){return n.cellRefRow}}),Object.defineProperty(t,"cellRefCol",{enumerable:!0,get:function(){return n.cellRefCol}}),Object.defineProperty(t,"cellRefBad",{enumerable:!0,get:function(){return n.cellRefBad}}),Object.defineProperty(t,"formula",{enumerable:!0,get:function(){return n.formula}}),Object.defineProperty(t,"multiLineComment",{enumerable:!0,get:function(){return n.multiLineComment}}),Object.defineProperty(t,"singleLineComment",{enumerable:!0,get:function(){return n.singleLineComment}}),Object.defineProperty(t,"formulaSpan",{enumerable:!0,get:function(){return n.formulaSpan}}),Object.defineProperty(t,"literalNode",{enumerable:!0,get:function(){return n.literalNode}}),Object.defineProperty(t,"arrayNode",{enumerable:!0,get:function(){return n.arrayNode}}),Object.defineProperty(t,"appNode",{enumerable:!0,get:function(){return n.appNode}}),Object.defineProperty(t,"flattenLetArgs",{enumerable:!0,get:function(){return n.flattenLetArgs}}),Object.defineProperty(t,"indexedArg",{enumerable:!0,get:function(){return n.indexedArg}}),Object.defineProperty(t,"letVar",{enumerable:!0,get:function(){return n.letVar}}),Object.defineProperty(t,"letNode",{enumerable:!0,get:function(){return n.letNode}}),Object.defineProperty(t,"flattenLambdaArgs",{enumerable:!0,get:function(){return n.flattenLambdaArgs}}),Object.defineProperty(t,"paramName",{enumerable:!0,get:function(){return n.paramName}}),Object.defineProperty(t,"paramDefault",{enumerable:!0,get:function(){return n.paramDefault}}),Object.defineProperty(t,"paramNode",{enumerable:!0,get:function(){return n.paramNode}}),Object.defineProperty(t,"lambdaParam",{enumerable:!0,get:function(){return n.lambdaParam}}),Object.defineProperty(t,"lambdaNode",{enumerable:!0,get:function(){return n.lambdaNode}}),Object.defineProperty(t,"operatorNode",{enumerable:!0,get:function(){return n.operatorNode}}),Object.defineProperty(t,"wsfNode",{enumerable:!0,get:function(){return n.wsfNode}}),Object.defineProperty(t,"parenNode",{enumerable:!0,get:function(){return n.parenNode}}),Object.defineProperty(t,"nameNode",{enumerable:!0,get:function(){return n.nameNode}}),Object.defineProperty(t,"identNamePart",{enumerable:!0,get:function(){return n.identNamePart}}),Object.defineProperty(t,"cellRefNamePart",{enumerable:!0,get:function(){return n.cellRefNamePart}}),Object.defineProperty(t,"fieldRefNamePart",{enumerable:!0,get:function(){return n.fieldRefNamePart}}),Object.defineProperty(t,"contextNameNode",{enumerable:!0,get:function(){return n.contextNameNode}}),Object.defineProperty(t,"cellRefNode",{enumerable:!0,get:function(){return n.cellRefNode}}),Object.defineProperty(t,"fieldRefNode",{enumerable:!0,get:function(){return n.fieldRefNode}}),Object.defineProperty(t,"fieldRef",{enumerable:!0,get:function(){return n.fieldRef}}),Object.defineProperty(t,"structRefNode",{enumerable:!0,get:function(){return n.structRefNode}}),Object.defineProperty(t,"structRef",{enumerable:!0,get:function(){return n.structRef}}),Object.defineProperty(t,"specialRef",{enumerable:!0,get:function(){return n.specialRef}}),Object.defineProperty(t,"columnRef",{enumerable:!0,get:function(){return n.columnRef}}),Object.defineProperty(t,"rangeOpRef",{enumerable:!0,get:function(){return n.rangeOpRef}}),Object.defineProperty(t,"commaOpRef",{enumerable:!0,get:function(){return n.commaOpRef}}),Object.defineProperty(t,"thisRowOpRef",{enumerable:!0,get:function(){return n.thisRowOpRef}}),Object.defineProperty(t,"missingRef",{enumerable:!0,get:function(){return n.missingRef}}),Object.defineProperty(t,"badRef",{enumerable:!0,get:function(){return n.badRef}}),Object.defineProperty(t,"varNode",{enumerable:!0,get:function(){return n.varNode}}),Object.defineProperty(t,"identNode",{enumerable:!0,get:function(){return n.identNode}}),Object.defineProperty(t,"missingNode",{enumerable:!0,get:function(){return n.missingNode}}),Object.defineProperty(t,"badCharsNode",{enumerable:!0,get:function(){return n.badCharsNode}}),Object.defineProperty(t,"badSequenceNode",{enumerable:!0,get:function(){return n.badSequenceNode}}),Object.defineProperty(t,"flattenNameParts",{enumerable:!0,get:function(){return n.flattenNameParts}}),Object.defineProperty(t,"headNamePart",{enumerable:!0,get:function(){return n.headNamePart}}),Object.defineProperty(t,"AnnotationKind",{enumerable:!0,get:function(){return n.AnnotationKind}}),Object.defineProperty(t,"appHeadNameAnnotation",{enumerable:!0,get:function(){return n.appHeadNameAnnotation}}),Object.defineProperty(t,"formulaRootAnnotation",{enumerable:!0,get:function(){return n.formulaRootAnnotation}}),Object.defineProperty(t,"localNameUseAnnotation",{enumerable:!0,get:function(){return n.localNameUseAnnotation}}),Object.defineProperty(t,"localNameDeclAnnotation",{enumerable:!0,get:function(){return n.localNameDeclAnnotation}})},3288:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextFuncs=t.getWorksheetFunc=void 0;var n=r(8073);Object.defineProperty(t,"getWorksheetFunc",{enumerable:!0,get:function(){return n.getWorksheetFunc}}),Object.defineProperty(t,"nextFuncs",{enumerable:!0,get:function(){return n.nextFuncs}})},7591:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.packageVersion=void 0,t.packageVersion="60.0.12"},5854:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.nameScope=t.nameLoc=t.documentScope=t.originCell=t.sheetGridCube=t.sheetGridRange=t.sheetGridCell=t.sheetRangeIndexes=t.allSheetsRange=t.gridRange=t.gridCell=t.sheetRange=t.sheetIndex=t.structRefColumnLoc=t.documentLoc=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceRange=t.lexicalSourceCell=t.sheetCols=t.sheetRows=t.NameSource=t.LexicalKind=void 0;var n=r(6067);Object.defineProperty(t,"LexicalKind",{enumerable:!0,get:function(){return n.LexicalKind}}),Object.defineProperty(t,"NameSource",{enumerable:!0,get:function(){return n.NameSource}}),Object.defineProperty(t,"sheetRows",{enumerable:!0,get:function(){return n.sheetRows}}),Object.defineProperty(t,"sheetCols",{enumerable:!0,get:function(){return n.sheetCols}}),Object.defineProperty(t,"lexicalSourceCell",{enumerable:!0,get:function(){return n.lexicalSourceCell}}),Object.defineProperty(t,"lexicalSourceRange",{enumerable:!0,get:function(){return n.lexicalSourceRange}}),Object.defineProperty(t,"lexicalSourceGrid",{enumerable:!0,get:function(){return n.lexicalSourceGrid}}),Object.defineProperty(t,"lexicalSourceName",{enumerable:!0,get:function(){return n.lexicalSourceName}}),Object.defineProperty(t,"lexicalSourceWSF",{enumerable:!0,get:function(){return n.lexicalSourceWSF}}),Object.defineProperty(t,"lexicalSourceUDF",{enumerable:!0,get:function(){return n.lexicalSourceUDF}}),Object.defineProperty(t,"documentLoc",{enumerable:!0,get:function(){return n.documentLoc}}),Object.defineProperty(t,"structRefColumnLoc",{enumerable:!0,get:function(){return n.structRefColumnLoc}}),Object.defineProperty(t,"sheetIndex",{enumerable:!0,get:function(){return n.sheetIndex}}),Object.defineProperty(t,"sheetRange",{enumerable:!0,get:function(){return n.sheetRange}}),Object.defineProperty(t,"gridCell",{enumerable:!0,get:function(){return n.gridCell}}),Object.defineProperty(t,"gridRange",{enumerable:!0,get:function(){return n.gridRange}}),Object.defineProperty(t,"allSheetsRange",{enumerable:!0,get:function(){return n.allSheetsRange}}),Object.defineProperty(t,"sheetRangeIndexes",{enumerable:!0,get:function(){return n.sheetRangeIndexes}}),Object.defineProperty(t,"sheetGridCell",{enumerable:!0,get:function(){return n.sheetGridCell}}),Object.defineProperty(t,"sheetGridRange",{enumerable:!0,get:function(){return n.sheetGridRange}}),Object.defineProperty(t,"sheetGridCube",{enumerable:!0,get:function(){return n.sheetGridCube}}),Object.defineProperty(t,"originCell",{enumerable:!0,get:function(){return n.originCell}}),Object.defineProperty(t,"documentScope",{enumerable:!0,get:function(){return n.documentScope}}),Object.defineProperty(t,"nameLoc",{enumerable:!0,get:function(){return n.nameLoc}}),Object.defineProperty(t,"nameScope",{enumerable:!0,get:function(){return n.nameScope}}),Object.defineProperty(t,"userDefinedFuncLoc",{enumerable:!0,get:function(){return n.userDefinedFuncLoc}})},6613:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatScientificLeft=t.xlMathpack=t.ieeeMathpack=t.numberComponents=void 0;var n=r(6067);Object.defineProperty(t,"numberComponents",{enumerable:!0,get:function(){return n.numberComponents}}),Object.defineProperty(t,"ieeeMathpack",{enumerable:!0,get:function(){return n.ieeeMathpack}}),Object.defineProperty(t,"xlMathpack",{enumerable:!0,get:function(){return n.xlMathpack}}),Object.defineProperty(t,"formatScientificLeft",{enumerable:!0,get:function(){return n.formatScientificLeft}})},4598:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.englishXLSXKnownFormat=t.isKnownFormatDefined=t.getKnownFormat=t.evalFormatLocalsGrid=t.createFormatGlobals=t.NumberFormatSource=t.otherEdit=t.numberEdit=t.stringEdit=t.formulaEdit=t.EditKind=t.renderedValueToString=t.renderInfiniteWidth=t.memoizedRenderCallback=t.renderCallback=t.isHashesValue=t.hashesValue=t.renderedValue=t.formattedValue=t.formattedUnitFlexible=t.formattedUnitBlank=t.formattedUnitString=t.formattedUnitGeneral=t.FormattedUnitKind=t.Clip=t.GetTimeKind=t.Alignment=t.NamedColor=t.FormatCurrency=t.CultureTag=t.BidiDate=t.FormatValueType=t.formatLocIFormat=t.formatLocKnownFormat=t.FormatLocKind=t.previousFormatFailure=t.fractionOverflow=t.dateOverflow=t.aggregationError=t.tooWide=t.noFormatPart=t.notFormatString=t.notValueString=t.ReasonKind=t.FormatReasonKind=t.Calendar=t.NumberShape=t.DateOrder=t.CurrencyFormat=t.KnownFormat=void 0,t.toXLNumber=t.applyValueEdit=t.getValueEditOperKind=t.createNumberFormatter=t.shouldInstallFormat=t.getRibbonFormat=t.RibbonFormat=void 0;var n=r(6067);Object.defineProperty(t,"KnownFormat",{enumerable:!0,get:function(){return n.KnownFormat}}),Object.defineProperty(t,"CurrencyFormat",{enumerable:!0,get:function(){return n.CurrencyFormat}}),Object.defineProperty(t,"DateOrder",{enumerable:!0,get:function(){return n.DateOrder}}),Object.defineProperty(t,"NumberShape",{enumerable:!0,get:function(){return n.NumberShape}}),Object.defineProperty(t,"Calendar",{enumerable:!0,get:function(){return n.Calendar}});var a=r(3228);Object.defineProperty(t,"FormatReasonKind",{enumerable:!0,get:function(){return a.FormatReasonKind}}),Object.defineProperty(t,"ReasonKind",{enumerable:!0,get:function(){return a.ReasonKind}}),Object.defineProperty(t,"notValueString",{enumerable:!0,get:function(){return a.notValueString}}),Object.defineProperty(t,"notFormatString",{enumerable:!0,get:function(){return a.notFormatString}}),Object.defineProperty(t,"noFormatPart",{enumerable:!0,get:function(){return a.noFormatPart}}),Object.defineProperty(t,"tooWide",{enumerable:!0,get:function(){return a.tooWide}}),Object.defineProperty(t,"aggregationError",{enumerable:!0,get:function(){return a.aggregationError}}),Object.defineProperty(t,"dateOverflow",{enumerable:!0,get:function(){return a.dateOverflow}}),Object.defineProperty(t,"fractionOverflow",{enumerable:!0,get:function(){return a.fractionOverflow}}),Object.defineProperty(t,"previousFormatFailure",{enumerable:!0,get:function(){return a.previousFormatFailure}}),Object.defineProperty(t,"FormatLocKind",{enumerable:!0,get:function(){return a.FormatLocKind}}),Object.defineProperty(t,"formatLocKnownFormat",{enumerable:!0,get:function(){return a.formatLocKnownFormat}}),Object.defineProperty(t,"formatLocIFormat",{enumerable:!0,get:function(){return a.formatLocIFormat}}),Object.defineProperty(t,"FormatValueType",{enumerable:!0,get:function(){return a.FormatValueType}}),Object.defineProperty(t,"BidiDate",{enumerable:!0,get:function(){return a.BidiDate}}),Object.defineProperty(t,"CultureTag",{enumerable:!0,get:function(){return a.CultureTag}}),Object.defineProperty(t,"FormatCurrency",{enumerable:!0,get:function(){return a.FormatCurrency}}),Object.defineProperty(t,"NamedColor",{enumerable:!0,get:function(){return a.NamedColor}}),Object.defineProperty(t,"Alignment",{enumerable:!0,get:function(){return a.Alignment}}),Object.defineProperty(t,"GetTimeKind",{enumerable:!0,get:function(){return a.GetTimeKind}}),Object.defineProperty(t,"Clip",{enumerable:!0,get:function(){return a.Clip}}),Object.defineProperty(t,"FormattedUnitKind",{enumerable:!0,get:function(){return a.FormattedUnitKind}}),Object.defineProperty(t,"formattedUnitGeneral",{enumerable:!0,get:function(){return a.formattedUnitGeneral}}),Object.defineProperty(t,"formattedUnitString",{enumerable:!0,get:function(){return a.formattedUnitString}}),Object.defineProperty(t,"formattedUnitBlank",{enumerable:!0,get:function(){return a.formattedUnitBlank}}),Object.defineProperty(t,"formattedUnitFlexible",{enumerable:!0,get:function(){return a.formattedUnitFlexible}}),Object.defineProperty(t,"formattedValue",{enumerable:!0,get:function(){return a.formattedValue}}),Object.defineProperty(t,"renderedValue",{enumerable:!0,get:function(){return a.renderedValue}}),Object.defineProperty(t,"hashesValue",{enumerable:!0,get:function(){return a.hashesValue}}),Object.defineProperty(t,"isHashesValue",{enumerable:!0,get:function(){return a.isHashesValue}}),Object.defineProperty(t,"renderCallback",{enumerable:!0,get:function(){return a.renderCallback}}),Object.defineProperty(t,"memoizedRenderCallback",{enumerable:!0,get:function(){return a.memoizedRenderCallback}}),Object.defineProperty(t,"renderInfiniteWidth",{enumerable:!0,get:function(){return a.renderInfiniteWidth}}),Object.defineProperty(t,"renderedValueToString",{enumerable:!0,get:function(){return a.renderedValueToString}}),Object.defineProperty(t,"EditKind",{enumerable:!0,get:function(){return a.EditKind}}),Object.defineProperty(t,"formulaEdit",{enumerable:!0,get:function(){return a.formulaEdit}}),Object.defineProperty(t,"stringEdit",{enumerable:!0,get:function(){return a.stringEdit}}),Object.defineProperty(t,"numberEdit",{enumerable:!0,get:function(){return a.numberEdit}}),Object.defineProperty(t,"otherEdit",{enumerable:!0,get:function(){return a.otherEdit}}),Object.defineProperty(t,"NumberFormatSource",{enumerable:!0,get:function(){return a.NumberFormatSource}}),Object.defineProperty(t,"createFormatGlobals",{enumerable:!0,get:function(){return a.createFormatGlobals}}),Object.defineProperty(t,"evalFormatLocalsGrid",{enumerable:!0,get:function(){return a.evalFormatLocalsGrid}}),Object.defineProperty(t,"getKnownFormat",{enumerable:!0,get:function(){return a.getKnownFormat}}),Object.defineProperty(t,"isKnownFormatDefined",{enumerable:!0,get:function(){return a.isKnownFormatDefined}}),Object.defineProperty(t,"englishXLSXKnownFormat",{enumerable:!0,get:function(){return a.englishXLSXKnownFormat}}),Object.defineProperty(t,"RibbonFormat",{enumerable:!0,get:function(){return a.RibbonFormat}}),Object.defineProperty(t,"getRibbonFormat",{enumerable:!0,get:function(){return a.getRibbonFormat}}),Object.defineProperty(t,"shouldInstallFormat",{enumerable:!0,get:function(){return a.shouldInstallFormat}}),Object.defineProperty(t,"createNumberFormatter",{enumerable:!0,get:function(){return a.createNumberFormatter}}),Object.defineProperty(t,"getValueEditOperKind",{enumerable:!0,get:function(){return a.getValueEditOperKind}}),Object.defineProperty(t,"applyValueEdit",{enumerable:!0,get:function(){return a.applyValueEdit}}),Object.defineProperty(t,"toXLNumber",{enumerable:!0,get:function(){return a.toXLNumber}})},7608:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseResultHelper=t.createParser=t.notFormulaString=t.parseLocals=t.ReasonKind=t.createParseGlobals=void 0;var n=r(472);Object.defineProperty(t,"createParseGlobals",{enumerable:!0,get:function(){return n.createParseGlobals}}),Object.defineProperty(t,"ReasonKind",{enumerable:!0,get:function(){return n.ReasonKind}}),Object.defineProperty(t,"parseLocals",{enumerable:!0,get:function(){return n.parseLocals}}),Object.defineProperty(t,"notFormulaString",{enumerable:!0,get:function(){return n.notFormulaString}}),Object.defineProperty(t,"createParser",{enumerable:!0,get:function(){return n.createParser}}),Object.defineProperty(t,"parseResultHelper",{enumerable:!0,get:function(){return n.parseResultHelper}})},1424:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isMachineCall=t.machineCall=t.MachineCallKind=t.readOperType=t.singleReadOperType=t.DerefOperKind=t.VoidMachine=t.AllMachine=t.MachineRuntime=t.MachineCycle=t.nextOnSuccessReceiver=t.callMachineTransition=t.breakTransition=t.nextTransition=t.TransitionKind=void 0;var n=r(6366);Object.defineProperty(t,"TransitionKind",{enumerable:!0,get:function(){return n.TransitionKind}}),Object.defineProperty(t,"nextTransition",{enumerable:!0,get:function(){return n.nextTransition}}),Object.defineProperty(t,"breakTransition",{enumerable:!0,get:function(){return n.breakTransition}}),Object.defineProperty(t,"callMachineTransition",{enumerable:!0,get:function(){return n.callMachineTransition}}),Object.defineProperty(t,"nextOnSuccessReceiver",{enumerable:!0,get:function(){return n.nextOnSuccessReceiver}}),Object.defineProperty(t,"MachineCycle",{enumerable:!0,get:function(){return n.MachineCycle}}),Object.defineProperty(t,"MachineRuntime",{enumerable:!0,get:function(){return n.MachineRuntime}}),Object.defineProperty(t,"AllMachine",{enumerable:!0,get:function(){return n.AllMachine}}),Object.defineProperty(t,"VoidMachine",{enumerable:!0,get:function(){return n.VoidMachine}});var a=r(8073);Object.defineProperty(t,"DerefOperKind",{enumerable:!0,get:function(){return a.DerefOperKind}}),Object.defineProperty(t,"singleReadOperType",{enumerable:!0,get:function(){return a.singleReadOperType}}),Object.defineProperty(t,"readOperType",{enumerable:!0,get:function(){return a.readOperType}}),Object.defineProperty(t,"MachineCallKind",{enumerable:!0,get:function(){return a.MachineCallKind}}),Object.defineProperty(t,"machineCall",{enumerable:!0,get:function(){return a.machineCall}}),Object.defineProperty(t,"isMachineCall",{enumerable:!0,get:function(){return a.isMachineCall}})},3729:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEvaluator=t.createCompiler=t.RecordOper=t.LambdaOper=t.LimitKind=t.limitExceeded=t.createCompileGlobals=t.illFormedFormula=t.compileLocalsName=t.compileLocalsGrid=t.evalLocals=t.evalGlobals=t.previousNameFailure=t.previousFailure=t.breaked=t.paused=t.cellCycle=t.nameCycle=t.stopped=t.userDefinedFunc=t.cellFormula=t.cellWellFormedFormula=t.pendingValue=t.finalValue=t.runtimePositionFirstOrderFunc=t.runtimePositionFormulaRoot=t.runtimePositionEtaLambdaBody=t.runtimePositionLambdaParam=t.runtimePositionLambdaRoot=t.runtimePositionLetVal=t.RuntimePositionKind=t.StepAction=t.Interrupt=t.CellKind=t.interval=t.ReasonKind=t.extension=void 0;const n=r(3345);t.extension=n.__importStar(r(1424));var a=r(8073);Object.defineProperty(t,"ReasonKind",{enumerable:!0,get:function(){return a.ReasonKind}}),Object.defineProperty(t,"interval",{enumerable:!0,get:function(){return a.interval}}),Object.defineProperty(t,"CellKind",{enumerable:!0,get:function(){return a.CellKind}}),Object.defineProperty(t,"Interrupt",{enumerable:!0,get:function(){return a.Interrupt}}),Object.defineProperty(t,"StepAction",{enumerable:!0,get:function(){return a.StepAction}}),Object.defineProperty(t,"RuntimePositionKind",{enumerable:!0,get:function(){return a.RuntimePositionKind}}),Object.defineProperty(t,"runtimePositionLetVal",{enumerable:!0,get:function(){return a.runtimePositionLetVal}}),Object.defineProperty(t,"runtimePositionLambdaRoot",{enumerable:!0,get:function(){return a.runtimePositionLambdaRoot}}),Object.defineProperty(t,"runtimePositionLambdaParam",{enumerable:!0,get:function(){return a.runtimePositionLambdaParam}}),Object.defineProperty(t,"runtimePositionEtaLambdaBody",{enumerable:!0,get:function(){return a.runtimePositionEtaLambdaBody}}),Object.defineProperty(t,"runtimePositionFormulaRoot",{enumerable:!0,get:function(){return a.runtimePositionFormulaRoot}}),Object.defineProperty(t,"runtimePositionFirstOrderFunc",{enumerable:!0,get:function(){return a.runtimePositionFirstOrderFunc}}),Object.defineProperty(t,"finalValue",{enumerable:!0,get:function(){return a.finalValue}}),Object.defineProperty(t,"pendingValue",{enumerable:!0,get:function(){return a.pendingValue}}),Object.defineProperty(t,"cellWellFormedFormula",{enumerable:!0,get:function(){return a.cellWellFormedFormula}}),Object.defineProperty(t,"cellFormula",{enumerable:!0,get:function(){return a.cellFormula}}),Object.defineProperty(t,"userDefinedFunc",{enumerable:!0,get:function(){return a.userDefinedFunc}}),Object.defineProperty(t,"stopped",{enumerable:!0,get:function(){return a.stopped}}),Object.defineProperty(t,"nameCycle",{enumerable:!0,get:function(){return a.nameCycle}}),Object.defineProperty(t,"cellCycle",{enumerable:!0,get:function(){return a.cellCycle}}),Object.defineProperty(t,"paused",{enumerable:!0,get:function(){return a.paused}}),Object.defineProperty(t,"breaked",{enumerable:!0,get:function(){return a.breaked}}),Object.defineProperty(t,"previousFailure",{enumerable:!0,get:function(){return a.previousFailure}}),Object.defineProperty(t,"previousNameFailure",{enumerable:!0,get:function(){return a.previousNameFailure}}),Object.defineProperty(t,"evalGlobals",{enumerable:!0,get:function(){return a.evalGlobals}}),Object.defineProperty(t,"evalLocals",{enumerable:!0,get:function(){return a.evalLocals}}),Object.defineProperty(t,"compileLocalsGrid",{enumerable:!0,get:function(){return a.compileLocalsGrid}}),Object.defineProperty(t,"compileLocalsName",{enumerable:!0,get:function(){return a.compileLocalsName}}),Object.defineProperty(t,"illFormedFormula",{enumerable:!0,get:function(){return a.illFormedFormula}}),Object.defineProperty(t,"createCompileGlobals",{enumerable:!0,get:function(){return a.createCompileGlobals}}),Object.defineProperty(t,"limitExceeded",{enumerable:!0,get:function(){return a.limitExceeded}}),Object.defineProperty(t,"LimitKind",{enumerable:!0,get:function(){return a.LimitKind}}),Object.defineProperty(t,"LambdaOper",{enumerable:!0,get:function(){return a.LambdaOper}}),Object.defineProperty(t,"RecordOper",{enumerable:!0,get:function(){return a.RecordOper}}),Object.defineProperty(t,"createCompiler",{enumerable:!0,get:function(){return a.createCompiler}}),Object.defineProperty(t,"createEvaluator",{enumerable:!0,get:function(){return a.createEvaluator}})},3607:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFuncType=t.getOperatorType=t.unknownFunctionType=t.functionType=t.SpecialPrecs=t.WorksheetFuncId=t.OperatorId=t.FunctionFlags=t.SignatureType=void 0;var n=r(6067);Object.defineProperty(t,"SignatureType",{enumerable:!0,get:function(){return n.SignatureType}}),Object.defineProperty(t,"FunctionFlags",{enumerable:!0,get:function(){return n.FunctionFlags}}),Object.defineProperty(t,"OperatorId",{enumerable:!0,get:function(){return n.OperatorId}}),Object.defineProperty(t,"WorksheetFuncId",{enumerable:!0,get:function(){return n.WorksheetFuncId}}),Object.defineProperty(t,"SpecialPrecs",{enumerable:!0,get:function(){return n.SpecialPrecs}}),Object.defineProperty(t,"functionType",{enumerable:!0,get:function(){return n.functionType}}),Object.defineProperty(t,"unknownFunctionType",{enumerable:!0,get:function(){return n.unknownFunctionType}}),Object.defineProperty(t,"getOperatorType",{enumerable:!0,get:function(){return n.getOperatorType}}),Object.defineProperty(t,"getWorksheetFuncType",{enumerable:!0,get:function(){return n.getWorksheetFuncType}})},2534:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalAlignment=t.HorizontalAlignment=t.BorderLineType=t.PatternType=t.FillKind=t.FontVerticalAlignment=t.FontUnderline=void 0;var n=r(6067);Object.defineProperty(t,"FontUnderline",{enumerable:!0,get:function(){return n.FontUnderline}}),Object.defineProperty(t,"FontVerticalAlignment",{enumerable:!0,get:function(){return n.FontVerticalAlignment}}),Object.defineProperty(t,"FillKind",{enumerable:!0,get:function(){return n.FillKind}}),Object.defineProperty(t,"PatternType",{enumerable:!0,get:function(){return n.PatternType}}),Object.defineProperty(t,"BorderLineType",{enumerable:!0,get:function(){return n.BorderLineType}}),Object.defineProperty(t,"HorizontalAlignment",{enumerable:!0,get:function(){return n.HorizontalAlignment}}),Object.defineProperty(t,"VerticalAlignment",{enumerable:!0,get:function(){return n.VerticalAlignment}})},3707:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReadOperEqual=t.isWriteOper=t.isPrimitiveOper=t.isRichOper=t.isBlankOper=t.isMissingOper=t.isArrayOper=t.isRangeOper=t.isErrorOper=t.isBooleanOper=t.isStringOper=t.isNumberOper=t.isValidArgsLength=t.getArgType=t.getArguments=t.gridCellRange=t.sheetGridRangeAnchor=t.gridRangeAnchor=t.isWSFNode=t.isOperatorNode=t.isUnqualifiedNameNode=t.isWellFormed=t.isSheetGridRangeEqual=t.isSheetGridCellEqual=t.isGridRangeEqual=t.isGridCellEqual=t.isNameScopeEqual=t.isSheetIndexEqual=t.isDocumentLocEqual=t.gridRangeSize=t.gridRangeExcept=t.gridRangeCompare=t.gridCellImplicitIsect=t.gridRangeIsects=t.gridRangeIsect=t.gridRangesJoin=t.gridRangeJoinOpt=t.gridRangeJoin=t.forEachTileInRange=t.forEachCellInRange=t.isSheetGridCell=t.isGridCell=t.isSheetGridRange=t.isSheetIndex=t.javaScriptError=t.isSuccess=t.successUndefined=t.failure=t.success=t.ResultKind=void 0,t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=t.visitCellRef=t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=t.resolveGridRef=t.createResolver=t.resolvedDottedName=t.resolvedNever=t.resolvedStructRef=t.resolvedWorksheetFunc=t.resolvedLocalName=t.resolvedUserDefinedFunc=t.resolvedCellRef=t.resolvedName=t.ResolvedKind=t.emptyIntersection=t.InvalidStructRefReason=t.invalidStructRef=t.InvalidCellRefReason=t.invalidCellRef=t.InvalidQualifierReason=t.invalidQualifier=t.noOriginSheet=t.ResolveReasonKind=t.resolveLocalsGrid=t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.formatName=t.formatGridRange=t.formatQualifier=t.formatRangePos=t.formatCellPos=t.formatColRange=t.formatRowRange=t.formatCol=t.formatRow=t.resolvePosition=t.columnName=t.createFailureErrorClass=t.internal=t.unavailable=t.notImplemented=t.ReasonKind=void 0,t.isUnbracketedFieldName=t.shouldFieldRefBeBracketed=t.relabelFormula=t.createPrinter=t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=t.buildAnnotations=t.reducePledge=t.reduceBottomUp=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=void 0;var n=r(6366);Object.defineProperty(t,"ResultKind",{enumerable:!0,get:function(){return n.ResultKind}}),Object.defineProperty(t,"success",{enumerable:!0,get:function(){return n.success}}),Object.defineProperty(t,"failure",{enumerable:!0,get:function(){return n.failure}}),Object.defineProperty(t,"successUndefined",{enumerable:!0,get:function(){return n.successUndefined}}),Object.defineProperty(t,"isSuccess",{enumerable:!0,get:function(){return n.isSuccess}}),Object.defineProperty(t,"javaScriptError",{enumerable:!0,get:function(){return n.javaScriptError}});var a=r(6067);Object.defineProperty(t,"isSheetIndex",{enumerable:!0,get:function(){return a.isSheetIndex}}),Object.defineProperty(t,"isSheetGridRange",{enumerable:!0,get:function(){return a.isSheetGridRange}}),Object.defineProperty(t,"isGridCell",{enumerable:!0,get:function(){return a.isGridCell}}),Object.defineProperty(t,"isSheetGridCell",{enumerable:!0,get:function(){return a.isSheetGridCell}}),Object.defineProperty(t,"forEachCellInRange",{enumerable:!0,get:function(){return a.forEachCellInRange}}),Object.defineProperty(t,"forEachTileInRange",{enumerable:!0,get:function(){return a.forEachTileInRange}}),Object.defineProperty(t,"gridRangeJoin",{enumerable:!0,get:function(){return a.gridRangeJoin}}),Object.defineProperty(t,"gridRangeJoinOpt",{enumerable:!0,get:function(){return a.gridRangeJoinOpt}}),Object.defineProperty(t,"gridRangesJoin",{enumerable:!0,get:function(){return a.gridRangesJoin}}),Object.defineProperty(t,"gridRangeIsect",{enumerable:!0,get:function(){return a.gridRangeIsect}}),Object.defineProperty(t,"gridRangeIsects",{enumerable:!0,get:function(){return a.gridRangeIsects}}),Object.defineProperty(t,"gridCellImplicitIsect",{enumerable:!0,get:function(){return a.gridCellImplicitIsect}}),Object.defineProperty(t,"gridRangeCompare",{enumerable:!0,get:function(){return a.gridRangeCompare}}),Object.defineProperty(t,"gridRangeExcept",{enumerable:!0,get:function(){return a.gridRangeExcept}}),Object.defineProperty(t,"gridRangeSize",{enumerable:!0,get:function(){return a.gridRangeSize}}),Object.defineProperty(t,"isDocumentLocEqual",{enumerable:!0,get:function(){return a.isDocumentLocEqual}}),Object.defineProperty(t,"isSheetIndexEqual",{enumerable:!0,get:function(){return a.isSheetIndexEqual}}),Object.defineProperty(t,"isNameScopeEqual",{enumerable:!0,get:function(){return a.isNameScopeEqual}}),Object.defineProperty(t,"isGridCellEqual",{enumerable:!0,get:function(){return a.isGridCellEqual}}),Object.defineProperty(t,"isGridRangeEqual",{enumerable:!0,get:function(){return a.isGridRangeEqual}}),Object.defineProperty(t,"isSheetGridCellEqual",{enumerable:!0,get:function(){return a.isSheetGridCellEqual}}),Object.defineProperty(t,"isSheetGridRangeEqual",{enumerable:!0,get:function(){return a.isSheetGridRangeEqual}}),Object.defineProperty(t,"isWellFormed",{enumerable:!0,get:function(){return a.isWellFormed}}),Object.defineProperty(t,"isUnqualifiedNameNode",{enumerable:!0,get:function(){return a.isUnqualifiedNameNode}}),Object.defineProperty(t,"isOperatorNode",{enumerable:!0,get:function(){return a.isOperatorNode}}),Object.defineProperty(t,"isWSFNode",{enumerable:!0,get:function(){return a.isWSFNode}}),Object.defineProperty(t,"gridRangeAnchor",{enumerable:!0,get:function(){return a.gridRangeAnchor}}),Object.defineProperty(t,"sheetGridRangeAnchor",{enumerable:!0,get:function(){return a.sheetGridRangeAnchor}}),Object.defineProperty(t,"gridCellRange",{enumerable:!0,get:function(){return a.gridCellRange}}),Object.defineProperty(t,"getArguments",{enumerable:!0,get:function(){return a.getArguments}}),Object.defineProperty(t,"getArgType",{enumerable:!0,get:function(){return a.getArgType}}),Object.defineProperty(t,"isValidArgsLength",{enumerable:!0,get:function(){return a.isValidArgsLength}}),Object.defineProperty(t,"isNumberOper",{enumerable:!0,get:function(){return a.isNumberOper}}),Object.defineProperty(t,"isStringOper",{enumerable:!0,get:function(){return a.isStringOper}}),Object.defineProperty(t,"isBooleanOper",{enumerable:!0,get:function(){return a.isBooleanOper}}),Object.defineProperty(t,"isErrorOper",{enumerable:!0,get:function(){return a.isErrorOper}}),Object.defineProperty(t,"isRangeOper",{enumerable:!0,get:function(){return a.isRangeOper}}),Object.defineProperty(t,"isArrayOper",{enumerable:!0,get:function(){return a.isArrayOper}}),Object.defineProperty(t,"isMissingOper",{enumerable:!0,get:function(){return a.isMissingOper}}),Object.defineProperty(t,"isBlankOper",{enumerable:!0,get:function(){return a.isBlankOper}}),Object.defineProperty(t,"isRichOper",{enumerable:!0,get:function(){return a.isRichOper}}),Object.defineProperty(t,"isPrimitiveOper",{enumerable:!0,get:function(){return a.isPrimitiveOper}}),Object.defineProperty(t,"isWriteOper",{enumerable:!0,get:function(){return a.isWriteOper}}),Object.defineProperty(t,"isReadOperEqual",{enumerable:!0,get:function(){return a.isReadOperEqual}}),Object.defineProperty(t,"ReasonKind",{enumerable:!0,get:function(){return a.ReasonKind}}),Object.defineProperty(t,"notImplemented",{enumerable:!0,get:function(){return a.notImplemented}}),Object.defineProperty(t,"unavailable",{enumerable:!0,get:function(){return a.unavailable}}),Object.defineProperty(t,"internal",{enumerable:!0,get:function(){return a.internal}}),Object.defineProperty(t,"createFailureErrorClass",{enumerable:!0,get:function(){return a.createFailureErrorClass}}),Object.defineProperty(t,"columnName",{enumerable:!0,get:function(){return a.columnName}}),Object.defineProperty(t,"resolvePosition",{enumerable:!0,get:function(){return a.resolvePosition}}),Object.defineProperty(t,"formatRow",{enumerable:!0,get:function(){return a.formatRow}}),Object.defineProperty(t,"formatCol",{enumerable:!0,get:function(){return a.formatCol}}),Object.defineProperty(t,"formatRowRange",{enumerable:!0,get:function(){return a.formatRowRange}}),Object.defineProperty(t,"formatColRange",{enumerable:!0,get:function(){return a.formatColRange}}),Object.defineProperty(t,"formatCellPos",{enumerable:!0,get:function(){return a.formatCellPos}}),Object.defineProperty(t,"formatRangePos",{enumerable:!0,get:function(){return a.formatRangePos}}),Object.defineProperty(t,"formatQualifier",{enumerable:!0,get:function(){return a.formatQualifier}}),Object.defineProperty(t,"formatGridRange",{enumerable:!0,get:function(){return a.formatGridRange}}),Object.defineProperty(t,"formatName",{enumerable:!0,get:function(){return a.formatName}}),Object.defineProperty(t,"parseGridCellA1",{enumerable:!0,get:function(){return a.parseGridCellA1}}),Object.defineProperty(t,"parseGridRangeA1",{enumerable:!0,get:function(){return a.parseGridRangeA1}}),Object.defineProperty(t,"parseQualifier",{enumerable:!0,get:function(){return a.parseQualifier}}),Object.defineProperty(t,"wrapPosition",{enumerable:!0,get:function(){return a.wrapPosition}}),Object.defineProperty(t,"resolveLocalsGrid",{enumerable:!0,get:function(){return a.resolveLocalsGrid}}),Object.defineProperty(t,"ResolveReasonKind",{enumerable:!0,get:function(){return a.ResolveReasonKind}}),Object.defineProperty(t,"noOriginSheet",{enumerable:!0,get:function(){return a.noOriginSheet}}),Object.defineProperty(t,"invalidQualifier",{enumerable:!0,get:function(){return a.invalidQualifier}}),Object.defineProperty(t,"InvalidQualifierReason",{enumerable:!0,get:function(){return a.InvalidQualifierReason}}),Object.defineProperty(t,"invalidCellRef",{enumerable:!0,get:function(){return a.invalidCellRef}}),Object.defineProperty(t,"InvalidCellRefReason",{enumerable:!0,get:function(){return a.InvalidCellRefReason}}),Object.defineProperty(t,"invalidStructRef",{enumerable:!0,get:function(){return a.invalidStructRef}}),Object.defineProperty(t,"InvalidStructRefReason",{enumerable:!0,get:function(){return a.InvalidStructRefReason}}),Object.defineProperty(t,"emptyIntersection",{enumerable:!0,get:function(){return a.emptyIntersection}}),Object.defineProperty(t,"ResolvedKind",{enumerable:!0,get:function(){return a.ResolvedKind}}),Object.defineProperty(t,"resolvedName",{enumerable:!0,get:function(){return a.resolvedName}}),Object.defineProperty(t,"resolvedCellRef",{enumerable:!0,get:function(){return a.resolvedCellRef}}),Object.defineProperty(t,"resolvedUserDefinedFunc",{enumerable:!0,get:function(){return a.resolvedUserDefinedFunc}}),Object.defineProperty(t,"resolvedLocalName",{enumerable:!0,get:function(){return a.resolvedLocalName}}),Object.defineProperty(t,"resolvedWorksheetFunc",{enumerable:!0,get:function(){return a.resolvedWorksheetFunc}}),Object.defineProperty(t,"resolvedStructRef",{enumerable:!0,get:function(){return a.resolvedStructRef}}),Object.defineProperty(t,"resolvedNever",{enumerable:!0,get:function(){return a.resolvedNever}}),Object.defineProperty(t,"resolvedDottedName",{enumerable:!0,get:function(){return a.resolvedDottedName}}),Object.defineProperty(t,"createResolver",{enumerable:!0,get:function(){return a.createResolver}}),Object.defineProperty(t,"resolveGridRef",{enumerable:!0,get:function(){return a.resolveGridRef}}),Object.defineProperty(t,"visitFormulaNode",{enumerable:!0,get:function(){return a.visitFormulaNode}}),Object.defineProperty(t,"visitOperatorNode",{enumerable:!0,get:function(){return a.visitOperatorNode}}),Object.defineProperty(t,"visitWSFNode",{enumerable:!0,get:function(){return a.visitWSFNode}}),Object.defineProperty(t,"visitAppHeadNode",{enumerable:!0,get:function(){return a.visitAppHeadNode}}),Object.defineProperty(t,"visitQualifier",{enumerable:!0,get:function(){return a.visitQualifier}}),Object.defineProperty(t,"visitCellRef",{enumerable:!0,get:function(){return a.visitCellRef}}),Object.defineProperty(t,"IdentityVisitor",{enumerable:!0,get:function(){return a.IdentityVisitor}}),Object.defineProperty(t,"identityVisitor",{enumerable:!0,get:function(){return a.identityVisitor}}),Object.defineProperty(t,"ConstVisitor",{enumerable:!0,get:function(){return a.ConstVisitor}}),Object.defineProperty(t,"constVisitor",{enumerable:!0,get:function(){return a.constVisitor}}),Object.defineProperty(t,"voidVisitor",{enumerable:!0,get:function(){return a.voidVisitor}}),Object.defineProperty(t,"DelegatingVisitor",{enumerable:!0,get:function(){return a.DelegatingVisitor}}),Object.defineProperty(t,"BinaryVisitor",{enumerable:!0,get:function(){return a.BinaryVisitor}}),Object.defineProperty(t,"binaryVisitor",{enumerable:!0,get:function(){return a.binaryVisitor}}),Object.defineProperty(t,"ComposeVisitor",{enumerable:!0,get:function(){return a.ComposeVisitor}}),Object.defineProperty(t,"composeVisitor",{enumerable:!0,get:function(){return a.composeVisitor}}),Object.defineProperty(t,"reduceBottomUp",{enumerable:!0,get:function(){return a.reduceBottomUp}}),Object.defineProperty(t,"reducePledge",{enumerable:!0,get:function(){return a.reducePledge}}),Object.defineProperty(t,"buildAnnotations",{enumerable:!0,get:function(){return a.buildAnnotations}}),Object.defineProperty(t,"createSimplePrintGlobals",{enumerable:!0,get:function(){return a.createSimplePrintGlobals}}),Object.defineProperty(t,"printLocalsGrid",{enumerable:!0,get:function(){return a.printLocalsGrid}}),Object.defineProperty(t,"printLocalsName",{enumerable:!0,get:function(){return a.printLocalsName}}),Object.defineProperty(t,"createPrinter",{enumerable:!0,get:function(){return a.createPrinter}}),Object.defineProperty(t,"relabelFormula",{enumerable:!0,get:function(){return a.relabelFormula}}),Object.defineProperty(t,"shouldFieldRefBeBracketed",{enumerable:!0,get:function(){return a.shouldFieldRefBeBracketed}});var i=r(472);Object.defineProperty(t,"isUnbracketedFieldName",{enumerable:!0,get:function(){return i.isUnbracketedFieldName}})},34:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.blankOper=t.missingOper=t.range3DOper=t.rangeSeqOper=t.arrayOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.naErrorOper=t.numErrorOper=t.nameErrorOper=t.refErrorOper=t.valueErrorOper=t.div0ErrorOper=t.nullErrorOper=t.errorOper=t.booleanOper=t.stringOper=t.precedents=t.ErrorType=t.falseOper=t.trueOper=t.OperKind=t.PrecsBound=t.SpecialPrecs=void 0;var n=r(6067);Object.defineProperty(t,"SpecialPrecs",{enumerable:!0,get:function(){return n.SpecialPrecs}}),Object.defineProperty(t,"PrecsBound",{enumerable:!0,get:function(){return n.PrecsBound}}),Object.defineProperty(t,"OperKind",{enumerable:!0,get:function(){return n.OperKind}}),Object.defineProperty(t,"trueOper",{enumerable:!0,get:function(){return n.trueOper}}),Object.defineProperty(t,"falseOper",{enumerable:!0,get:function(){return n.falseOper}}),Object.defineProperty(t,"ErrorType",{enumerable:!0,get:function(){return n.ErrorType}}),Object.defineProperty(t,"precedents",{enumerable:!0,get:function(){return n.precedents}}),Object.defineProperty(t,"stringOper",{enumerable:!0,get:function(){return n.stringOper}}),Object.defineProperty(t,"booleanOper",{enumerable:!0,get:function(){return n.booleanOper}}),Object.defineProperty(t,"errorOper",{enumerable:!0,get:function(){return n.errorOper}}),Object.defineProperty(t,"nullErrorOper",{enumerable:!0,get:function(){return n.nullErrorOper}}),Object.defineProperty(t,"div0ErrorOper",{enumerable:!0,get:function(){return n.div0ErrorOper}}),Object.defineProperty(t,"valueErrorOper",{enumerable:!0,get:function(){return n.valueErrorOper}}),Object.defineProperty(t,"refErrorOper",{enumerable:!0,get:function(){return n.refErrorOper}}),Object.defineProperty(t,"nameErrorOper",{enumerable:!0,get:function(){return n.nameErrorOper}}),Object.defineProperty(t,"numErrorOper",{enumerable:!0,get:function(){return n.numErrorOper}}),Object.defineProperty(t,"naErrorOper",{enumerable:!0,get:function(){return n.naErrorOper}}),Object.defineProperty(t,"gettingDataErrorOper",{enumerable:!0,get:function(){return n.gettingDataErrorOper}}),Object.defineProperty(t,"spillErrorOper",{enumerable:!0,get:function(){return n.spillErrorOper}}),Object.defineProperty(t,"connectErrorOper",{enumerable:!0,get:function(){return n.connectErrorOper}}),Object.defineProperty(t,"blockedErrorOper",{enumerable:!0,get:function(){return n.blockedErrorOper}}),Object.defineProperty(t,"unknownErrorOper",{enumerable:!0,get:function(){return n.unknownErrorOper}}),Object.defineProperty(t,"fieldErrorOper",{enumerable:!0,get:function(){return n.fieldErrorOper}}),Object.defineProperty(t,"calcErrorOper",{enumerable:!0,get:function(){return n.calcErrorOper}}),Object.defineProperty(t,"busyErrorOper",{enumerable:!0,get:function(){return n.busyErrorOper}}),Object.defineProperty(t,"externalErrorOper",{enumerable:!0,get:function(){return n.externalErrorOper}}),Object.defineProperty(t,"arrayOper",{enumerable:!0,get:function(){return n.arrayOper}}),Object.defineProperty(t,"rangeSeqOper",{enumerable:!0,get:function(){return n.rangeSeqOper}}),Object.defineProperty(t,"range3DOper",{enumerable:!0,get:function(){return n.range3DOper}}),Object.defineProperty(t,"missingOper",{enumerable:!0,get:function(){return n.missingOper}}),Object.defineProperty(t,"blankOper",{enumerable:!0,get:function(){return n.blankOper}})},2529:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.argumentAssistancePluginDependenciesResolved=t.ArgumentAssistancePlugin=void 0;const n=r(3345),a=r(3942),i=r(3166),o=r(6067),s=r(7178),u=r(6067),l=r(6067),c=r(6067),d=r(6067),g=r(6366),m=r(3228),h=r(8338),p=r(8734),f=r(3465),S=r(637),v=r(9762),F=r(3423),y=r(6366),b=r(6366),C=r(7630),A=r(3219),E=r(6067),T=r(3338),R=r(9313),k=r(1339),N=R.PluginRegistry.create(C.PluginFactoryName.ArgumentAssistancePlugin,C.PluginGroup.Excel);let I=(()=>{let e,t,r,i=[N.x10Plugin()],v=[],y=[];return t=class{*run(e){this.lastRunTime=this.timer.now(),this.runStartTime=this.timer.now(),this.timeStamps=new Map;const t=yield{kind:a.ComputationRequestKind.GetActiveCell};if(t.kind!==a.ComputationRequestKind.GetActiveCell)return this.logFailure("failed to get active cell"),null;this.addTimeStamp("GetActiveCell");let r=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(this.addTimeStamp("ParseCellContentSync"),!(void 0!==r&&r.kind===a.ComputationRequestKind.ParseActiveCell&&(0,g.isSuccess)(r.result)||(r=yield{kind:a.ComputationRequestKind.ParseEdit,cell:t.activeCell,formulaBarText:e.content},this.addTimeStamp("ParseCellContentAsync"),r.kind===a.ComputationRequestKind.ParseEdit&&(0,g.isSuccess)(r.result))))return null;if(r.result.value.kind!==m.EditKind.Formula)return null;const{formula:n}=r.result.value,i=new p.ArgumentAssistanceVisitor(n,e.caretPosition,this.newNamedObjectsEnabled);if((0,o.reduceBottomUp)(i,n),this.addTimeStamp("ArgumentAssistanceVisitor"),void 0===i.assistedFunctionHead)return this.logTimeStamp(),null;const u=yield{kind:a.ComputationRequestKind.GetConfig};this.addTimeStamp("GetConfig");const l=u.kind===a.ComputationRequestKind.GetConfig?u.config.localeInfo.listSeparator:",",c=i.assistedFunctionHead;if(c.kind===E.NodeKind.Name){if(!this.newNamedObjectsEnabled)return null;const t=yield{kind:a.ComputationRequestKind.GetDefinedNamesInfo};if(t.kind!==a.ComputationRequestKind.GetDefinedNamesInfo)return this.logFailure("failed to get named objects info"),null;const r=t.definedNamesInfo.find((e=>e.name===c.whole));if(null==r?.reference)return null;const o=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:r.reference};if(o.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,g.isSuccess)(o.result)||o.result.value.kind!==m.EditKind.Formula)return null;const{formula:s}=o.result.value;if(!s.isWellFormed||"Lambda"!==s.node.kind||!s.node.isClosed)return null;const u=[];for(const e of s.node.params){const{name:t,isBracketed:r}=e.name.arg.name;if("Ident"!==t.kind)return this.logFailure(`unexpected parameter in lambda function: ${t.kind}`),null;const n=r?`[${t.whole}]`:t.whole;u.push(n)}const d=(0,f.getActiveParamIndex)(n,i.assistedFunctionArgs,e.caretPosition,this.fixHandlingWhiteSpace);return{kind:"Minimal",functionName:c.whole,listSeparator:l,parameters:{params:u,activeParam:d}}}const v=yield{kind:a.ComputationRequestKind.GetFunctionInfo,functionName:c.whole};if(this.addTimeStamp("GetFunctionInfo"),v.kind!==a.ComputationRequestKind.GetFunctionInfo)return this.logFailure(`failed to get function info for ${c.whole}`),null;const F=new S.ResettableLazy((()=>(0,f.createFunctionRenderingInfo)(v.functionInfo,n,i.assistedFunctionArgs,e.caretPosition,c.id,l,this.fixHandlingWhiteSpace))),y=s.functionExamples.getValue()[c.id];if(this.addTimeStamp("GetExampleString"),void 0===y)return this.logFailure(`no example found for function: ${c.whole}, id: ${c.id}`),this.addTimeStampAndLog("createFunctionRenderingInfoNoExample"),F.getValue();const b=yield{kind:a.ComputationRequestKind.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:y,kind:h.FormulaKind.CellFormula},useEnglishLocaleInfo:!0};if(this.addTimeStamp("ParseExample"),b.kind!==a.ComputationRequestKind.ParseCellFormula||!(0,g.isSuccess)(b.result)){this.logFailure(`failed to parse example for function: ${c.whole}`);const e=F.getValue();return this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseExample"),e}if(u.kind===a.ComputationRequestKind.GetConfig&&u.config.localeInfo.lcid===d.LCID.USA){const t=(0,f.createFunctionRenderingInfo)(v.functionInfo,n,i.assistedFunctionArgs,e.caretPosition,c.id,l,this.fixHandlingWhiteSpace,y,b.result.value);return this.addTimeStampAndLog("createFunctionRenderingInfoEnUs"),t}const C=yield{kind:a.ComputationRequestKind.PrintFormula,formula:b.result.value,origin:t.activeCell};if(this.addTimeStamp("localize example string"),C.kind!==a.ComputationRequestKind.PrintFormula||!(0,g.isSuccess)(C.result)){this.logFailure(`failed to pretty print localized example for function: ${c.whole}`);const e=F.getValue();return this.addTimeStampAndLog("createFunctionRenderingInfoFailedToPrintLocalizedExample"),e}const A=yield{kind:a.ComputationRequestKind.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:C.result.value,kind:h.FormulaKind.CellFormula},useEnglishLocaleInfo:!1};if(this.addTimeStamp("parse localized example string"),A.kind!==a.ComputationRequestKind.ParseCellFormula||!(0,g.isSuccess)(A.result)){this.logFailure(`failed to parse localized example for function: ${c.whole}`);const e=F.getValue();return this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseLocalizedExample"),e}const T=(0,f.createFunctionRenderingInfo)(v.functionInfo,n,i.assistedFunctionArgs,e.caretPosition,c.id,l,this.fixHandlingWhiteSpace,C.result.value,A.result.value);return this.addTimeStampAndLog("createFunctionRenderingInfoWithLocalizedExample"),T}logFailure(e){c.ulsLogger.ULS.traceTag(545388683,u.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,`ArgumentAssistancePlugin encountered a failure with msg ${e}`)}addTimeStampAndLog(e){this.addTimeStamp(e),this.logTimeStamp()}logTimeStamp(){this.timeStamps.set("Overall",this.timer.now()-this.runStartTime);const e={};this.timeStamps.forEach(((t,r)=>{e[r]=t})),c.ulsLogger.ULS.traceTag(540377222,u.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,`${JSON.stringify(e)}`)}addTimeStamp(e){this.timeStamps.set(e,this.timer.now()-this.lastRunTime),this.lastRunTime=this.timer.now()}constructor(){this.timer=(n.__runInitializers(this,y),F.defaultTimerInterface),this.lastRunTime=0,this.runStartTime=0,this.timeStamps=new Map,this.fixHandlingWhiteSpace=(0,b.isTypedChangeGateEnabled)("OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces"),this.newNamedObjectsEnabled=(0,A.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAuthoringWithNameManager",!1)&&(0,A.getBooleanFeatureGate)("Microsoft.Office.Excel.XLONameManager",!1)}},n.__setFunctionName(t,"ArgumentAssistancePlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[N.uiMessageHandler({kind:k.RequestKind.argumentAssistance})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,y),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,v),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=N.injectPluginFactory(),n.__runInitializers(t,v),t})();t.ArgumentAssistancePlugin=I,(0,i.registerPluginFactory)(I.factory),t.argumentAssistancePluginDependenciesResolved=(0,T.trackableAsyncLazy)((async()=>{let e;e=(0,y.getTypedFeatureGate)("Microsoft.Office.Excel.ArgumentAssistanceOnMainThread")?await v.dynamicPluginLoaderCreated.getValue():await v.workerThreadSpread.getValue(),await e.loadPluginScript("formula-authoring-strings",!0),await e.createAndAttachPlugin(C.PluginFactoryName.ArgumentAssistancePlugin),await v.schedulerWithRecalcServiceAttached.getValue()}),"argumentAssistancePluginDependenciesResolved")},3465:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBaseParamName=t.getParamNumberSuffix=t.getParamIndexToHighlight=t.getActiveParamIndex=t.createFunctionRenderingInfo=void 0;const n=r(6067);function a(e,t,r,n){let a=0;if(n)for(let n=0;n<t.length;n++){const i=e.spans[t[n].label];if(i&&i.start-i.pre.length<=r&&r<=i.end+i.post.length){a=n;break}}else for(let n=t.length-1;n>=0;n-=1){const i=e.spans[t[n].label]?.end;void 0!==i&&r<=i&&(a=n)}return a}function i(e,t,r,n=!1,a=!1){const i=t-1,o=r.restTypes.length,s=r.headTypes.length;if(e<s+o)return e;if(e>=s&&0===o)return-1;const u=(e-s)%o;return n?e<=i-r.tailTypes.length?e:i-r.tailTypes.length-(o-1)+u:s+(a&&0===u&&r.tailTypes.length>0?o:u)}function o(e,t,r){let n=i(e,t,r);return u(e,r)&&(n+=1),n}function s(e,t,r){return 1+Math.max(Math.floor((e-t)/r),0)}function u(e,t){return t.restTypes.length>0&&e>=t.headTypes.length+t.restTypes.length}function l(e){return e.match(/[^0-9\[\]]+/)}function c(e,t){return{params:e,activeParam:Math.min(t,e.length-1)}}t.createFunctionRenderingInfo=function(e,t,r,d,g,m,h,p,f){const S=a(t,r,d,h),v=e.Params.split("!");return{kind:"Full",functionName:e.NameDataStrings,functionDescription:e.Help,signatures:v.map(((t,r)=>function(e,t,r,a,d,g,m,h){const p=(0,n.getWorksheetFuncType)(d),f=""!==t?t.split(g+" ").filter((e=>"..."!==e)):[],S=function(e,t,r){const n=e.slice(),a=t.headTypes.length,i=t.restTypes.length;if(i>0){let e=s(r,a,i);for(let t=a;t<n.length;t+=i){for(let r=0;r<i;r+=1){const a=l(n[t+r]),o=e>1&&r%i==0?"[":"",s=e>1&&r%i==i-1?"]":"";n[t+r]=`${o}${a}${e}${s}`}e+=1}n.push("..."),u(r,t)&&n.splice(a,0,"...")}return n}(f,p,a),v=function(e,t){return void 0===e||void 0===t?null:t.node.args.map((r=>{const n=t.spans[r.label];return n?e.substring(n.start,n.end):""}))}(m,h),F=function(e,t,r,n){let a=e.split("!");if(a=0===n?a.slice(0,t.length):a.slice(-1*t.length),r.restTypes.length>0){for(let e=r.headTypes.length;e<a.length;e+=1){const r=l(t[e]),n=`${r}1,${r}2,... `;a[e]=n+a[e]}1===r.restTypes.length&&a.push(a[r.headTypes.length])}return a}(e.ParamsHelp,f,p,r),y=function(e,t){return e.filter((e=>"..."!==e)).slice(0,t.length).map((e=>function(e){return e.startsWith("[")&&!e.endsWith("]")?e+"]":!e.startsWith("[")&&e.endsWith("]")?"["+e:e}(e)))}(S,F);return{signatureParams:c(S,o(a,f.length,p)),descriptions:F,descriptionParams:c(y,i(a,y.length,p)),exampleParams:null!==v?c(v,i(a,v.length,p,!0)):null,exampleDescription:""}}(e,t,r,S,g,m,p,f))),activeSignature:0,listSeparator:m,isUDF:e.IsDynamicUdf,helpID:e.HelpId}},t.getActiveParamIndex=a,t.getParamIndexToHighlight=i,t.getParamNumberSuffix=s,t.getBaseParamName=l},8734:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArgumentAssistanceVisitor=void 0;const n=r(6366),a=r(6067),i=r(6067);class o extends i.IdentityVisitor{appNode(e,t,r,n){return(e.kind===a.NodeKind.WSF||this.newNamedObjectsEnabled&&e.kind===a.NodeKind.Name)&&this.updateAssistedFunction(e,t),super.appNode(e,t,r,n)}letNode(e,t,r,n,a,i){const o=super.letNode(e,t,r,n,a,i);return this.updateAssistedFunction(e,o.args),o}lambdaNode(e,t,r,n,a,i){const o=super.lambdaNode(e,t,r,n,a,i);return this.updateAssistedFunction(e,o.args),o}updateAssistedFunction(e,t){const r=this.parsedFormulaTree.spans[t[0].label],n=this.parsedFormulaTree.spans[t[t.length-1].label];let a=r.start,i=n.end;this.fixHandlingWhiteSpace&&(a-=r.pre.length,i+=n.post.length),this.caretPosition<=i&&this.caretPosition>=a&&(void 0===this.assistedFunctionHead||a>this.assistedFunctionScopeStart)&&(this.assistedFunctionHead=e,this.assistedFunctionArgs=t,this.assistedFunctionScopeStart=a)}constructor(e,t,r){super(),this.parsedFormulaTree=e,this.caretPosition=t,this.newNamedObjectsEnabled=r,this.assistedFunctionScopeStart=0,this.fixHandlingWhiteSpace=!1,this.fixHandlingWhiteSpace=(0,n.isTypedChangeGateEnabled)("OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces")}}t.ArgumentAssistanceVisitor=o},7178:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionExamples=void 0;const n=r(6067),a=r(637);t.functionExamples=new a.ResettableLazy((()=>({[n.WorksheetFuncId.ABS]:"=ABS(2)",[n.WorksheetFuncId.CUBEMEMBERPROPERTY]:`=CUBEMEMBERPROPERTY("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}","[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Time)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Fiscal)}].[2014]",$A$3)`,[n.WorksheetFuncId.CUBERANKEDMEMBER]:`=CUBERANKEDMEMBER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}",$D$4,1,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TopMonth)}")`,[n.WorksheetFuncId.BINOM_DIST_RANGE]:"=BINOM.DIST.RANGE(60,0.75,48)",[n.WorksheetFuncId.NETWORKDAYS_INTL]:"=NETWORKDAYS.INTL(DATE(2006,1,1),DATE(2006,1,31))",[n.WorksheetFuncId.AVERAGE_WEIGHTED]:"=AVERAGE.WEIGHTED(A1:A10, B1:B10, 5, 0.5)",[n.WorksheetFuncId.GAMMALN_PRECISE]:"=GAMMALN.PRECISE(4)",[n.WorksheetFuncId.CONFIDENCE_NORM]:"=CONFIDENCE.NORM(0.05,2.5,50)",[n.WorksheetFuncId.CEILING_PRECISE]:"=CEILING.PRECISE(4.3)",[n.WorksheetFuncId.FORECAST_LINEAR]:"=FORECAST.LINEAR(30,A2:A6,B2:B6)",[n.WorksheetFuncId.PERCENTRANK_EXC]:"=PERCENTRANK.EXC(A2:A11,2)",[n.WorksheetFuncId.PERCENTRANK_INC]:"=PERCENTRANK.INC(A2:A11,2)",[n.WorksheetFuncId.PERCENTILE_EXC]:"=PERCENTILE.EXC(B2:B10,0.25)",[n.WorksheetFuncId.PERCENTILE_INC]:"=PERCENTILE.INC(A2:A5,0.3)",[n.WorksheetFuncId.CUBEKPIMEMBER]:`=CUBEKPIMEMBER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MySalesKPI)}",1)`,[n.WorksheetFuncId.CHISQ_DIST_RT]:"=CHISQ.DIST.RT(18.307,10)",[n.WorksheetFuncId.FLOOR_PRECISE]:"=FLOOR.PRECISE(-3.2,-1)",[n.WorksheetFuncId.NEGBINOM_DIST]:"=NEGBINOM.DIST(10,5,0.25,TRUE)",[n.WorksheetFuncId.GETPIVOTDATA]:`=GETPIVOTDATA("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}", $A$3, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Region)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.South)}")`,[n.WorksheetFuncId.CUBESETCOUNT]:"=CUBESETCOUNT(A3)",[n.WorksheetFuncId.ERFC_PRECISE]:"=ERFC.PRECISE(1)",[n.WorksheetFuncId.CHISQ_INV_RT]:"=CHISQ.INV.RT(0.3, 2)",[n.WorksheetFuncId.CONFIDENCE_T]:"=CONFIDENCE.T(0.05,1,50)",[n.WorksheetFuncId.CEILING_MATH]:"=CEILING.MATH(24.3,5)",[n.WorksheetFuncId.HYPGEOM_DIST]:"=HYPGEOM.DIST(1,4,8,20,TRUE)",[n.WorksheetFuncId.LOGNORM_DIST]:"=LOGNORM.DIST(4,3.5,1.2,TRUE)",[n.WorksheetFuncId.NEGBINOMDIST]:"=NEGBINOMDIST(10,5,0.25)",[n.WorksheetFuncId.PERMUTATIONA]:"=PERMUTATIONA(3,2)",[n.WorksheetFuncId.POISSON_DIST]:"=POISSON.DIST(1, 2, TRUE)",[n.WorksheetFuncId.WEIBULL_DIST]:"=WEIBULL.DIST(105,20,100,TRUE)",[n.WorksheetFuncId.COVARIANCE_P]:"=COVARIANCE.P(A2:A6, B2:B6)",[n.WorksheetFuncId.COVARIANCE_S]:"=COVARIANCE.S(A3:A5,B3:B5)",[n.WorksheetFuncId.QUARTILE_EXC]:"=QUARTILE.EXC(A2:A12,1)",[n.WorksheetFuncId.QUARTILE_INC]:"=QUARTILE.INC(A2:A9,1)",[n.WorksheetFuncId.ECMA_CEILING]:"=ECMA.CEILING(1.5, 0.1)",[n.WorksheetFuncId.WORKDAY_INTL]:"=WORKDAY.INTL(DATE(2012,1,1),30,0)",[n.WorksheetFuncId.STOCKHISTORY]:"=STOCKHISTORY(MSFT,1-1-2020)",[n.WorksheetFuncId.ERF_PRECISE]:"=ERF.PRECISE(0.745)",[n.WorksheetFuncId.NUMBERVALUE]:"=NUMBERVALUE(0.035)",[n.WorksheetFuncId.HYPGEOMDIST]:"=HYPGEOMDIST(1,4,8,20)",[n.WorksheetFuncId.LOGNORMDIST]:"=LOGNORMDIST(4,3.5,1.2)",[n.WorksheetFuncId.LOGNORM_INV]:"=LOGNORM.INV(0.039084, 3.5, 1.2)",[n.WorksheetFuncId.NORM_S_DIST]:"=NORM.S.DIST(1.33, TRUE)",[n.WorksheetFuncId.STANDARDIZE]:"=STANDARDIZE(42,40,1.5)",[n.WorksheetFuncId.FORMULATEXT]:"=FORMULATEXT(A2)",[n.WorksheetFuncId.PERCENTRANK]:"=PERCENTRANK(A2:A11,2)",[n.WorksheetFuncId.CONCATENATE]:`=CONCATENATE("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Andreas)}", " ", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hauser)}")`,[n.WorksheetFuncId.ISO_CEILING]:"=ISO.CEILING(4.3)",[n.WorksheetFuncId.VALUETOTEXT]:`=VALUETOTEXT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SomeText)}")`,[n.WorksheetFuncId.ARRAYTOTEXT]:"=ARRAYTOTEXT(B1:B3)",[n.WorksheetFuncId.AVERAGEIFS]:'=AVERAGEIFS(B2:B5, B2:B5, ">70", B2:B5, "<90")',[n.WorksheetFuncId.COUNTBLANK]:"=COUNTBLANK(A2:B5)",[n.WorksheetFuncId.ERROR_TYPE]:"=ERROR.TYPE(#NULL!)",[n.WorksheetFuncId.CUBEMEMBER]:`=CUBEMEMBER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}",(B4, C6, D5),"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesFor2004)}")`,[n.WorksheetFuncId.ISOWEEKNUM]:"=ISOWEEKNUM(40977)",[n.WorksheetFuncId.SUBSTITUTE]:`=SUBSTITUTE("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesData)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cost)}")`,[n.WorksheetFuncId.SUMPRODUCT]:"=SUMPRODUCT(C2:C5,D2:D5)",[n.WorksheetFuncId.WEBSERVICE]:`=WEBSERVICE(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WebServiceLink)})`,[n.WorksheetFuncId.BINOM_DIST]:"=BINOM.DIST(6,10,0.5,FALSE)",[n.WorksheetFuncId.CHISQ_DIST]:"=CHISQ.DIST(0.5,1,TRUE)",[n.WorksheetFuncId.CONFIDENCE]:"=CONFIDENCE(0.05,2.5,50)",[n.WorksheetFuncId.EXPON_DIST]:"=EXPON.DIST(0.2,10,TRUE)",[n.WorksheetFuncId.FLOOR_MATH]:"=FLOOR.MATH(24.3,5)",[n.WorksheetFuncId.GAMMA_DIST]:"=GAMMA.DIST(4.79, 1.234, 7, TRUE)",[n.WorksheetFuncId.NORM_S_INV]:"=NORM.S.INV(0.908789)",[n.WorksheetFuncId.CHISQ_TEST]:"=CHISQ.TEST(A2:B4,A6:B8)",[n.WorksheetFuncId.PERCENTILE]:"=PERCENTILE(E2:E5,0.3)",[n.WorksheetFuncId.FIELDVALUE]:`=FIELDVALUE(A2, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Price)}")`,[n.WorksheetFuncId.AVERAGEIF]:'=AVERAGEIF(B2:B5,"<23000")',[n.WorksheetFuncId.BITLSHIFT]:"=BITLSHIFT(4,2)",[n.WorksheetFuncId.BITRSHIFT]:"=BITRSHIFT(13,2)",[n.WorksheetFuncId.DATEVALUE]:'=DATEVALUE("1/1/2008")',[n.WorksheetFuncId.FILTERXML]:'=FILTERXML(B3,"//rc/@title")',[n.WorksheetFuncId.CUBEVALUE]:`=CUBEVALUE(Sales,"[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Measures)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}]","[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Time)}].[2004]","[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AllProduct)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Beverages)}]")`,[n.WorksheetFuncId.ENCODEURL]:`=ENCODEURL("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EncodeURLExmapleLink)}")`,[n.WorksheetFuncId.HYPERLINK]:`=HYPERLINK("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HyperlinkExampleLink)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ClickForReport)}")`,[n.WorksheetFuncId.ISLOGICAL]:"=ISLOGICAL(TRUE)",[n.WorksheetFuncId.ISNONTEXT]:"=ISNONTEXT(A2)",[n.WorksheetFuncId.ISFORMULA]:"=ISFORMULA(A2)",[n.WorksheetFuncId.PDURATION]:"=PDURATION(2.5%,2000,2200)",[n.WorksheetFuncId.TIMEVALUE]:"=TIMEVALUE(0.1)",[n.WorksheetFuncId.TRANSPOSE]:"=TRANSPOSE(A2:F9)",[n.WorksheetFuncId.FREQUENCY]:"=FREQUENCY(A2:A20, B2:B5)",[n.WorksheetFuncId.BETA_DIST]:"=BETA.DIST(2,8,10,TRUE,1,3)",[n.WorksheetFuncId.BINOMDIST]:"=BINOMDIST(6,10,0.5,FALSE)",[n.WorksheetFuncId.BINOM_INV]:"=BINOM.INV(6,0.5,0.75)",[n.WorksheetFuncId.CHISQ_INV]:"=CHISQ.INV(0.3, 2)",[n.WorksheetFuncId.CRITBINOM]:"=CRITBINOM(6,0.5,0.75)",[n.WorksheetFuncId.EXPONDIST]:"=EXPONDIST(0.2,10,TRUE)",[n.WorksheetFuncId.F_DIST_RT]:"=F.DIST.RT(15.2069,6,4)",[n.WorksheetFuncId.FISHERINV]:"=FISHERINV(0.972955)",[n.WorksheetFuncId.GAMMADIST]:"=GAMMADIST(10.00001131,9,2,FALSE)",[n.WorksheetFuncId.GAMMA_INV]:"=GAMMA.INV(0.068094,9,2)",[n.WorksheetFuncId.NORM_DIST]:"=NORM.DIST(1, 0, 1, TRUE)",[n.WorksheetFuncId.T_DIST_2T]:"=T.DIST.2T(1.959999998,60)",[n.WorksheetFuncId.T_DIST_RT]:"=T.DIST.RT(1.959999998,60)",[n.WorksheetFuncId.INTERCEPT]:"=INTERCEPT(A2:A6, B2:B6)",[n.WorksheetFuncId.MODE_MULT]:"=MODE.MULT(A2:A13)",[n.WorksheetFuncId.MODE_SNGL]:"=MODE.SNGL(A2:A7)",[n.WorksheetFuncId.AGGREGATE]:"=AGGREGATE(12, 6, A1:A11, B1:B11)",[n.WorksheetFuncId.RANDARRAY]:"=RANDARRAY(5,3,1,100)",[n.WorksheetFuncId.COUNTIFS]:'=COUNTIFS(A2:A7,"<6",A2:A7,">1")',[n.WorksheetFuncId.DAVERAGE]:`=DAVERAGE(A4:E10, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:B2)`,[n.WorksheetFuncId.BAHTTEXT]:"=BAHTTEXT(1234)",[n.WorksheetFuncId.DPRODUCT]:`=DPRODUCT(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:F3)`,[n.WorksheetFuncId.INDIRECT]:"=INDIRECT(B&A)",[n.WorksheetFuncId.ISNUMBER]:"=ISNUMBER(A2)",[n.WorksheetFuncId.MINVERSE]:"=MINVERSE(A1:D4)",[n.WorksheetFuncId.RANK_AVG]:"=RANK.AVG(94,B2:B8)",[n.WorksheetFuncId.SUBTOTAL]:"=SUBTOTAL(9,A2:A5)",[n.WorksheetFuncId.BETADIST]:"=BETADIST(2,8,10,1,3)",[n.WorksheetFuncId.BETA_INV]:"=BETA.INV(0.685470581,8,10,1,3)",[n.WorksheetFuncId.F_INV_RT]:"=F.INV.RT(0.01,6,4)",[n.WorksheetFuncId.GAMMAINV]:"=GAMMAINV(0.65, 4, 2)",[n.WorksheetFuncId.NORMDIST]:"=NORMDIST(42,40,1.5,TRUE)",[n.WorksheetFuncId.NORM_INV]:"=NORM.INV(0.908789,40,1.5)",[n.WorksheetFuncId.NORMSINV]:"=NORMSINV(0.9088)",[n.WorksheetFuncId.SUMX2MY2]:"=SUMX2MY2(A3:A9,B3:B9)",[n.WorksheetFuncId.SUMX2PY2]:"=SUMX2PY2(A3:A9,B3:B9)",[n.WorksheetFuncId.FORECAST]:"=FORECAST(30,A2:A6,B2:B6)",[n.WorksheetFuncId.QUARTILE]:"=QUARTILE(A2:A9,1)",[n.WorksheetFuncId.TRIMMEAN]:"=TRIMMEAN(A2:A12,0.2)",[n.WorksheetFuncId.T_INV_2T]:"=T.INV.2T(0.546449,60)",[n.WorksheetFuncId.AVERAGEA]:"=AVERAGEA(A2:A6)",[n.WorksheetFuncId.TEXTJOIN]:"=TEXTJOIN(, , TRUE, A2:A8)",[n.WorksheetFuncId.SEQUENCE]:"=SEQUENCE(4,5)",[n.WorksheetFuncId.ADDRESS]:`=ADDRESS(2,3,1,FALSE,"[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Book1)}]${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sheet1)}")`,[n.WorksheetFuncId.AVERAGE]:"=AVERAGE(A2:A6)",[n.WorksheetFuncId.COLUMNS]:"=COLUMNS(C1:E4)",[n.WorksheetFuncId.COUNTIF]:'=COUNTIF(B2:B5,">55")',[n.WorksheetFuncId.DAYS360]:'=DAYS360("30-Jan-2011","1-Feb-2011")',[n.WorksheetFuncId.DCOUNTA]:`=DCOUNTA(A4:E10, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}", A1:F2)`,[n.WorksheetFuncId.DECIMAL]:"=DECIMAL(FF,16)",[n.WorksheetFuncId.DEGREES]:"=DEGREES(PI())",[n.WorksheetFuncId.DSTDEVP]:`=DSTDEVP(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.CUBESET]:`=CUBESET("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}","[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Product)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AllProducts)}].${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Children)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Products)}",1,"[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Measures)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesAmount)}]")`,[n.WorksheetFuncId.HLOOKUP]:`=HLOOKUP("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Axles)}", A1:C4, 2, TRUE)`,[n.WorksheetFuncId.IFERROR]:`=IFERROR(55/0, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ErrorInCalculation)}")`,[n.WorksheetFuncId.ISBLANK]:"=ISBLANK(A2)",[n.WorksheetFuncId.ISERROR]:"=ISERROR(#REF!)",[n.WorksheetFuncId.XLOOKUP]:`=XLOOKUP("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tom)}",A2:A9,C2:C9,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NotFound)}",0,1)`,[n.WorksheetFuncId.MDETERM]:"=MDETERM(A2:D5)",[n.WorksheetFuncId.PRODUCT]:"=PRODUCT(A2:A4)",[n.WorksheetFuncId.RADIANS]:"=RADIANS(270)",[n.WorksheetFuncId.RANK_EQ]:"=RANK.EQ(7,A2:A6,1)",[n.WorksheetFuncId.REPLACE]:'=REPLACE(2009,3,2,"10")',[n.WorksheetFuncId.STDEV_S]:"=STDEV.S(A2:A11)",[n.WorksheetFuncId.STDEV_P]:"=STDEV.P(A3:A12)",[n.WorksheetFuncId.UNICODE]:"=UNICODE(B)",[n.WorksheetFuncId.UNICHAR]:"=UNICHAR(66)",[n.WorksheetFuncId.VLOOKUP]:"=VLOOKUP(103, A2:B26, 2, FALSE)",[n.WorksheetFuncId.WEEKDAY]:"=WEEKDAY(39492)",[n.WorksheetFuncId.GAMMALN]:"=GAMMALN(4)",[n.WorksheetFuncId.BETAINV]:"=BETAINV(0.685470581,8,10,1,3)",[n.WorksheetFuncId.CHIDIST]:"=CHIDIST(18.307,10)",[n.WorksheetFuncId.COMBINA]:"=COMBINA(4,3)",[n.WorksheetFuncId.CEILING]:"=CEILING(2.5, 1)",[n.WorksheetFuncId.NORMINV]:"=NORMINV(0.908789,40,1.5)",[n.WorksheetFuncId.POISSON]:"=POISSON(1, 2, TRUE)",[n.WorksheetFuncId.WEIBULL]:"=WEIBULL(105,20,100,TRUE)",[n.WorksheetFuncId.SUMXMY2]:"=SUMXMY2(A3:A9,B3:B9)",[n.WorksheetFuncId.CHITEST]:"=CHITEST(A2:B4,A6:B8)",[n.WorksheetFuncId.PEARSON]:"=PEARSON(A3:A7,B3:B7)",[n.WorksheetFuncId.GEOMEAN]:"=GEOMEAN(A2:A8)",[n.WorksheetFuncId.HARMEAN]:"=HARMEAN(A2:A8)",[n.WorksheetFuncId.STDEVPA]:"=STDEVPA(A3:A12)",[n.WorksheetFuncId.DATEDIF]:'=DATEDIF("1/1/2001","1/1/2003","Y")',[n.WorksheetFuncId.ARABIC]:"=ARABIC(LVII)",[n.WorksheetFuncId.CHOOSE]:`=CHOOSE(3,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Wide)}",115,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.World)}",8)`,[n.WorksheetFuncId.COLUMN]:"=COLUMN(C9)",[n.WorksheetFuncId.COUNTA]:"=COUNTA(B2:B6)",[n.WorksheetFuncId.DCOUNT]:`=DCOUNT(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Age)}", A1:F2)`,[n.WorksheetFuncId.DOLLAR]:"=DOLLAR(1.2351, 4)",[n.WorksheetFuncId.DSTDEV]:`=DSTDEV(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.GROWTH]:"=GROWTH(#VALUE!)",[n.WorksheetFuncId.IMCOSH]:'=IMCOSH("4+3i")',[n.WorksheetFuncId.IMCSCH]:'=IMCSCH("4+3i")',[n.WorksheetFuncId.IMSECH]:'=IMSECH("4+3i")',[n.WorksheetFuncId.IMSINH]:'=IMSINH("4+3i")',[n.WorksheetFuncId.ISTEXT]:`=ISTEXT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Region1)}")`,[n.WorksheetFuncId.LINEST]:"=LINEST(B2:B10, A2:A10, FALSE, TRUE)",[n.WorksheetFuncId.LOGEST]:"=LOGEST(B2:B10, A2:A10, TRUE, TRUE)",[n.WorksheetFuncId.LOOKUP]:"=LOOKUP(4.19, A2:A6, B2:B6)",[n.WorksheetFuncId.XMATCH]:"=XMATCH(F2,C3:C9,1)",[n.WorksheetFuncId.MEDIAN]:"=MEDIAN(A2:A6)",[n.WorksheetFuncId.MINUTE]:"=MINUTE(0.53125)",[n.WorksheetFuncId.OFFSET]:"=OFFSET(D3,3,-2,1,1)",[n.WorksheetFuncId.PROPER]:`=PROPER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisIsATITLE)}")`,[n.WorksheetFuncId.SEARCH]:`=SEARCH("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.E)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Statements)}",6)`,[n.WorksheetFuncId.SECOND]:"=SECOND(0.700208333333333)",[n.WorksheetFuncId.SHEETS]:`=SHEETS(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.My3DRef)})`,[n.WorksheetFuncId.STDEVP]:"=STDEVP(A3:A12)",[n.WorksheetFuncId.SUMIFS]:`=SUMIFS(A2:A9, B2:B9, "<>${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bananas)}", C2:C9, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tom)}")`,[n.WorksheetFuncId.AVEDEV]:"=AVEDEV(A2:A8)",[n.WorksheetFuncId.CHIINV]:"=CHIINV(0.3, 2)",[n.WorksheetFuncId.COMBIN]:"=COMBIN(8,2)",[n.WorksheetFuncId.F_DIST]:"=F.DIST(15.2069,6,4,TRUE)",[n.WorksheetFuncId.FISHER]:"=FISHER(0.75)",[n.WorksheetFuncId.LOGINV]:"=LOGINV(0.039084, 3.5, 1.2)",[n.WorksheetFuncId.PERMUT]:"=PERMUT(100,3)",[n.WorksheetFuncId.T_DIST]:"=T.DIST(60,1,TRUE)",[n.WorksheetFuncId.CORREL]:"=CORREL(A2:A6, B2:B6)",[n.WorksheetFuncId.F_TEST]:"=F.TEST(A2:A6,B2:B6)",[n.WorksheetFuncId.T_TEST]:"=T.TEST(A2:A10,B2:B10,2,1)",[n.WorksheetFuncId.SKEW_P]:"=SKEW.P(A2:A11)",[n.WorksheetFuncId.Z_TEST]:"=Z.TEST(A2:A11,4)",[n.WorksheetFuncId.STDEVA]:"=STDEVA(A3:A12)",[n.WorksheetFuncId.MAXIFS]:`=MAXIFS(A2:A7,B2:B7,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB)}",D2:D7,">100")`,[n.WorksheetFuncId.MINIFS]:`=MINIFS(A2:A7,B2:B7,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB)}",D2:D7,">100")`,[n.WorksheetFuncId.CONCAT]:`=CONCAT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Andreas)}"," ", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hauser)}")`,[n.WorksheetFuncId.SWITCH]:`=SWITCH(WEEKDAY("10/10/2016"),1,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday)}",2,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)}",3,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tuesday)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoMatch)}")`,[n.WorksheetFuncId.FILTER]:`=FILTER(A5:D20,(C5:C20="${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Apple)}")*(A5:A20="${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.East)}"),"")`,[n.WorksheetFuncId.UNIQUE]:"=UNIQUE(A2:A12)",[n.WorksheetFuncId.SORTBY]:"=SORTBY(D2:D9,E2:E9,1)",[n.WorksheetFuncId.BITAND]:"=BITAND(1,5)",[n.WorksheetFuncId.BITXOR]:"=BITXOR(5,3)",[n.WorksheetFuncId.ACOSH]:"=ACOSH(10)",[n.WorksheetFuncId.ACOTH]:"=ACOTH(6)",[n.WorksheetFuncId.ATANH]:"=ATANH(-0.1)",[n.WorksheetFuncId.ATAN2]:"=ATAN2(4,0)",[n.WorksheetFuncId.CLEAN]:"=CLEAN(A2)",[n.WorksheetFuncId.COUNT]:"=COUNT(A2:A7)",[n.WorksheetFuncId.DVARP]:`=DVARP(A4:E10, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.EXACT]:`=EXACT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hello)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Goodbye)}")`,[n.WorksheetFuncId.FALSE]:"=FALSE()",[n.WorksheetFuncId.FIXED]:"=FIXED(-1234.567, -1, TRUE)",[n.WorksheetFuncId.IMCOT]:'=IMCOT("4+3i")',[n.WorksheetFuncId.IMCSC]:'=IMCSC("4+3i")',[n.WorksheetFuncId.IMSEC]:'=IMSEC("4+3i")',[n.WorksheetFuncId.IMTAN]:'=IMTAN("4+3i")',[n.WorksheetFuncId.INDEX]:"=INDEX(A2:B3,2,1)",[n.WorksheetFuncId.ISERR]:"=ISERR(#N/A)",[n.WorksheetFuncId.ISREF]:"=ISREF(A2)",[n.WorksheetFuncId.LOWER]:`=LOWER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EECummings)}")`,[n.WorksheetFuncId.MATCH]:"=MATCH(39,B2:B5,1)",[n.WorksheetFuncId.MMULT]:"=MMULT(A1:B3, C1:F2)",[n.WorksheetFuncId.MONTH]:"=MONTH(40648)",[n.WorksheetFuncId.RIGHT]:`=RIGHT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalePrice)}",5)`,[n.WorksheetFuncId.ROUND]:"=ROUND(2.149, 1)",[n.WorksheetFuncId.SHEET]:`=SHEET(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Table1)})`,[n.WorksheetFuncId.STDEV]:"=STDEV(A3:A12)",[n.WorksheetFuncId.SUMIF]:'=SUMIF(A2:A5,">160000")',[n.WorksheetFuncId.TODAY]:"=TODAY()",[n.WorksheetFuncId.TREND]:"=TREND(B2:B10, A2:A10, A11:A13, TRUE)",[n.WorksheetFuncId.TRUNC]:"=TRUNC(8.9)",[n.WorksheetFuncId.UPPER]:`=UPPER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KelliXu)}")`,[n.WorksheetFuncId.VALUE]:"=VALUE(1000)",[n.WorksheetFuncId.VAR_S]:"=VAR.S(A2:A11)",[n.WorksheetFuncId.VAR_P]:"=VAR.P(A2:A11)",[n.WorksheetFuncId.GAMMA]:"=GAMMA(-3.75)",[n.WorksheetFuncId.GAUSS]:"=GAUSS(2)",[n.WorksheetFuncId.FDIST]:"=FDIST(15.20686486,6,4)",[n.WorksheetFuncId.F_INV]:"=F.INV(0.01,6,4)",[n.WorksheetFuncId.FLOOR]:"=FLOOR(23.25, 0.1)",[n.WorksheetFuncId.TDIST]:"=TDIST(60, 1, 1)",[n.WorksheetFuncId.COVAR]:"=COVAR(A2:A6, B2:B6)",[n.WorksheetFuncId.FTEST]:"=FTEST(A2:A6,B2:B6)",[n.WorksheetFuncId.STEYX]:"=STEYX(A3:A9,B3:B9)",[n.WorksheetFuncId.SLOPE]:"=SLOPE(A3:A9,B3:B9)",[n.WorksheetFuncId.TTEST]:"=TTEST(A2:A10,B2:B10,2,1)",[n.WorksheetFuncId.DEVSQ]:"=DEVSQ(A2:A8)",[n.WorksheetFuncId.SUMSQ]:"=SUMSQ(3, 4)",[n.WorksheetFuncId.ZTEST]:"=ZTEST(A2:A11,6)",[n.WorksheetFuncId.LARGE]:"=LARGE(A2:B6,7)",[n.WorksheetFuncId.SMALL]:"=SMALL(A2:A10,4)",[n.WorksheetFuncId.MUNIT]:"=MUNIT(2)",[n.WorksheetFuncId.T_INV]:"=T.INV(0.75,2)",[n.WorksheetFuncId.ROMAN]:"=ROMAN(499,0)",[n.WorksheetFuncId.POWER]:"=POWER(5,2)",[n.WorksheetFuncId.ISPMT]:"=ISPMT(10%, 2, 5, 1000)",[n.WorksheetFuncId.VARPA]:"=VARPA(1, 2)",[n.WorksheetFuncId.AREAS]:"=AREAS(B2:D4)",[n.WorksheetFuncId.ASINH]:"=ASINH(10)",[n.WorksheetFuncId.BITOR]:"=BITOR(23,10)",[n.WorksheetFuncId.ACOS]:"=ACOS(-0.5)",[n.WorksheetFuncId.ACOT]:"=ACOT(2)",[n.WorksheetFuncId.ATAN]:"=ATAN(1)",[n.WorksheetFuncId.CELL]:`=CELL("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Address)}", C2)`,[n.WorksheetFuncId.CHAR]:"=CHAR(65)",[n.WorksheetFuncId.COSH]:"=COSH(EXP(1))",[n.WorksheetFuncId.COTH]:"=COTH(2)",[n.WorksheetFuncId.CSCH]:"=CSCH(2)",[n.WorksheetFuncId.DATE]:"=DATE(2008,1,2)",[n.WorksheetFuncId.DAYS]:'=DAYS("3/15/2011","2/1/2011")',[n.WorksheetFuncId.DGET]:`=DGET(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.DMAX]:`=DMAX(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}", A1:F3)`,[n.WorksheetFuncId.DMIN]:`=DMIN(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}", A1:F3)`,[n.WorksheetFuncId.DSUM]:`=DSUM(A4:E10,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}", A1:F3)`,[n.WorksheetFuncId.DVAR]:`=DVAR(A4:E10, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.FACT]:"=FACT(5)",[n.WorksheetFuncId.FIND]:`=FIND("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.M)}",A2)`,[n.WorksheetFuncId.HOUR]:"=HOUR(0.75)",[n.WorksheetFuncId.IFNA]:`=IFNA("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoNAError)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Error)}")`,[n.WorksheetFuncId.IPMT]:"=IPMT(10%, 3, 3, 8000)",[n.WorksheetFuncId.ISNA]:"=ISNA(#REF!)",[n.WorksheetFuncId.LEFT]:`=LEFT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalePrice)}",4)`,[n.WorksheetFuncId.MIRR]:"=MIRR(A2:A7, 0.1, 0.12)",[n.WorksheetFuncId.NPER]:"=NPER(0.12/12, -100, -1000, 10000, 1)",[n.WorksheetFuncId.PPMT]:"=PPMT(0.08, 10, 10, 200000)",[n.WorksheetFuncId.RAND]:"=RAND()",[n.WorksheetFuncId.RANK]:"=RANK(3.5,A2:A6,1)",[n.WorksheetFuncId.RATE]:"=RATE(4*12, -200, 8000)",[n.WorksheetFuncId.REPT]:'=REPT("*-", 3)',[n.WorksheetFuncId.ROWS]:"=ROWS(C1:E4)",[n.WorksheetFuncId.SECH]:"=SECH(0)",[n.WorksheetFuncId.SIGN]:"=SIGN(10)",[n.WorksheetFuncId.SINH]:"=SINH(2)",[n.WorksheetFuncId.SQRT]:"=SQRT(16)",[n.WorksheetFuncId.TANH]:"=TANH(0.5)",[n.WorksheetFuncId.TEXT]:'=TEXT(1234.567,"$#,##0.00")',[n.WorksheetFuncId.TIME]:"=TIME(16,48,10)",[n.WorksheetFuncId.TRIM]:`=TRIM("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuarterEarnings)}")`,[n.WorksheetFuncId.TRUE]:"=TRUE()",[n.WorksheetFuncId.TYPE]:`=TYPE("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Smith)}")`,[n.WorksheetFuncId.VARP]:"=VARP(A2:A11)",[n.WorksheetFuncId.YEAR]:"=YEAR(39634)",[n.WorksheetFuncId.INFO]:`=INFO("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numfile)}")`,[n.WorksheetFuncId.EVEN]:"=EVEN(1.5)",[n.WorksheetFuncId.FINV]:"=FINV(0.42, 2, 3)",[n.WorksheetFuncId.PROB]:"=PROB(A3:A6,B3:B6,2)",[n.WorksheetFuncId.KURT]:"=KURT(A2:A11)",[n.WorksheetFuncId.SKEW]:"=SKEW(A2:A11)",[n.WorksheetFuncId.MODE]:"=MODE(A2:A7)",[n.WorksheetFuncId.MINA]:"=MINA(A2:A6)",[n.WorksheetFuncId.MAXA]:"=MAXA(A2:A6)",[n.WorksheetFuncId.VARA]:"=VARA(1, 2)",[n.WorksheetFuncId.SORT]:"=SORT(A2:A17)",[n.WorksheetFuncId.ASIN]:"=ASIN(-0.5)",[n.WorksheetFuncId.BASE]:"=BASE(7,2)",[n.WorksheetFuncId.CODE]:`=CODE("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CodeA)}")`,[n.WorksheetFuncId.AND]:"=AND(A2>1,A2<100)",[n.WorksheetFuncId.COS]:"=COS(1.047)",[n.WorksheetFuncId.COT]:"=COT(30)",[n.WorksheetFuncId.CSC]:"=CSC(15)",[n.WorksheetFuncId.DAY]:"=DAY(40648)",[n.WorksheetFuncId.DDB]:"=DDB(2400,300,10*365,1)",[n.WorksheetFuncId.RTD]:`=RTD(mycomaddin.progid,,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ServerName)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Price)}")`,[n.WorksheetFuncId.EXP]:"=EXP(1)",[n.WorksheetFuncId.INT]:"=INT(8.9)",[n.WorksheetFuncId.IRR]:"=IRR(A2:A4,-10%)",[n.WorksheetFuncId.LEN]:`=LEN("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Excel)}")`,[n.WorksheetFuncId.LOG]:"=LOG(10)",[n.WorksheetFuncId.MAX]:"=MAX(A2:A6)",[n.WorksheetFuncId.MID]:`=MID("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FluidFlow)}",1,5)`,[n.WorksheetFuncId.MIN]:"=MIN(A2:A6)",[n.WorksheetFuncId.MOD]:"=MOD(3, 2)",[n.WorksheetFuncId.NOT]:"=NOT(A2>100)",[n.WorksheetFuncId.NPV]:"=NPV(0.1, -10000, 3000, 4200, 6800)",[n.WorksheetFuncId.PMT]:"=PMT(0.08/12,10,10000)",[n.WorksheetFuncId.ROW]:"=ROW(C10)",[n.WorksheetFuncId.RRI]:"=RRI(96,10000,11000)",[n.WorksheetFuncId.SEC]:"=SEC(30)",[n.WorksheetFuncId.SIN]:"=SIN(PI())",[n.WorksheetFuncId.SLN]:"=SLN(30000, 7500, 10)",[n.WorksheetFuncId.SUM]:"=SUM(A1:A3)",[n.WorksheetFuncId.SYD]:"=SYD(30000,7500,10,1)",[n.WorksheetFuncId.TAN]:"=TAN(0.785)",[n.WorksheetFuncId.VAR]:"=VAR(A2:A11)",[n.WorksheetFuncId.VDB]:"=VDB(2400, 300, 10*365, 0, 1)",[n.WorksheetFuncId.XOR]:"=XOR(3>0,2<9)",[n.WorksheetFuncId.ODD]:"=ODD(1.5)",[n.WorksheetFuncId.PHI]:"=PHI(0.75)",[n.WorksheetFuncId.RSQ]:"=RSQ(A3:A9, B3:B9)",[n.WorksheetFuncId.IFS]:`=IFS(A2>89,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsA)}",A2>79,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB)}",A2>69,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsC)}",A2>59,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsD)}",TRUE,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsF)}")`,[n.WorksheetFuncId.DB]:"=DB(1000000,100000,6,1,7)",[n.WorksheetFuncId.FV]:"=FV(0.06/12, 10, -200, -500, 1)",[n.WorksheetFuncId.IF]:`=IF(C2>B2,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OverBudget)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WithinBudget)}")`,[n.WorksheetFuncId.LN]:"=LN(86)",[n.WorksheetFuncId.NA]:"=NA()",[n.WorksheetFuncId.OR]:"=OR(A2>1,A2<100)",[n.WorksheetFuncId.PV]:"=PV(0.08/12, 12*20, 500, , 0)",[n.WorksheetFuncId.N]:`=N(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Even)})`,[n.WorksheetFuncId.T]:`=T("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hello)}")`,[n.WorksheetFuncId.ACCRINT]:"=ACCRINT(39508,39691,39569,0.1,1000,2,0)",[n.WorksheetFuncId.ACCRINTM]:"=ACCRINTM(39539,39614,0.1,1000,3)",[n.WorksheetFuncId.AMORDEGRC]:"=AMORDEGRC(2400,39679,39813,300,1,0.15,1)",[n.WorksheetFuncId.AMORLINC]:"=AMORLINC(2400,39679,39813,300,1,0.15,1)",[n.WorksheetFuncId.BESSELI]:"=BESSELI(1.5,1)",[n.WorksheetFuncId.BESSELJ]:"=BESSELJ(1.9,2)",[n.WorksheetFuncId.BESSELK]:"=BESSELK(1.5,1)",[n.WorksheetFuncId.BESSELY]:"=BESSELY(2.5,1)",[n.WorksheetFuncId.BIN2DEC]:"=BIN2DEC(1100100)",[n.WorksheetFuncId.BIN2HEX]:"=BIN2HEX(11111011, 4)",[n.WorksheetFuncId.BIN2OCT]:"=BIN2OCT(1001, 3)",[n.WorksheetFuncId.COMPLEX]:'=COMPLEX(3,4,"j")',[n.WorksheetFuncId.CONVERT]:'=CONVERT(1,"lbm","kg")',[n.WorksheetFuncId.COUPDAYBS]:'=COUPDAYBS("25-Jan-2011","15-Nov-2011",2,1)',[n.WorksheetFuncId.COUPDAYS]:'=COUPDAYS("25-Jan-2011","15-Nov-2011",2,1)',[n.WorksheetFuncId.COUPDAYSNC]:'=COUPDAYSNC("25-Jan-2011","15-Nov-2011",2,1)',[n.WorksheetFuncId.COUPNCD]:'=COUPNCD("25-Jan-2011","15-Nov-2011",2,1)',[n.WorksheetFuncId.COUPNUM]:'=COUPNUM("25-Jan-2011","15-Nov-2012",2,1)',[n.WorksheetFuncId.COUPPCD]:'=COUPPCD("25-Jan-2011","15-Nov-2011",2,1)',[n.WorksheetFuncId.CUMIPMT]:"=CUMIPMT(A2/12,A3*12,A4,13,24,0)",[n.WorksheetFuncId.CUMPRINC]:"=CUMPRINC(A2/12,A3*12,A4,13,24,0)",[n.WorksheetFuncId.DEC2BIN]:"=DEC2BIN(9, 4)",[n.WorksheetFuncId.DEC2HEX]:"=DEC2HEX(100,4)",[n.WorksheetFuncId.DEC2OCT]:"=DEC2OCT(58,3)",[n.WorksheetFuncId.DELTA]:"=DELTA(5,4)",[n.WorksheetFuncId.DISC]:'=DISC("7/1/2018","1/1/2048",97.975,100,1)',[n.WorksheetFuncId.DOLLARDE]:"=DOLLARDE(1.02,16)",[n.WorksheetFuncId.DOLLARFR]:"=DOLLARFR(1.125,16)",[n.WorksheetFuncId.DURATION]:'=DURATION("7/1/2018","1/1/2048",8%,9%,2,1)',[n.WorksheetFuncId.EDATE]:'=EDATE("15-Jan-2011",1)',[n.WorksheetFuncId.EFFECT]:"=EFFECT(0.0525,4)",[n.WorksheetFuncId.EOMONTH]:'=EOMONTH("1-Jan-2011",1)',[n.WorksheetFuncId.ERF]:"=ERF(0.745)",[n.WorksheetFuncId.ERFC]:"=ERFC(1)",[n.WorksheetFuncId.FACTDOUBLE]:"=FACTDOUBLE(6)",[n.WorksheetFuncId.FORECAST_ETS]:"=FORECAST.ETS(A62,$B$4:$B$60,$A$4:$A$60,1,1)",[n.WorksheetFuncId.FORECAST_ETS_CONFINT]:"=FORECAST.ETS.CONFINT(A62,$B$4:$B$60,$A$4:$A$60,0.95,1,1)",[n.WorksheetFuncId.FORECAST_ETS_SEASONALITY]:"=FORECAST.ETS.SEASONALITY($B$4:$B$60,$A$4:$A$60,1,1)",[n.WorksheetFuncId.FORECAST_ETS_STAT]:"=FORECAST.ETS.STAT($B$4:$B$60,$A$4:$A$60,1,J48,1,1)",[n.WorksheetFuncId.FVSCHEDULE]:"=FVSCHEDULE(1,{0.09,0.11,0.1})",[n.WorksheetFuncId.GCD]:"=GCD(24,36)",[n.WorksheetFuncId.GESTEP]:"=GESTEP(5,4)",[n.WorksheetFuncId.HEX2BIN]:"=HEX2BIN(F,8)",[n.WorksheetFuncId.HEX2DEC]:"=HEX2DEC(FFFFFFFF5B)",[n.WorksheetFuncId.HEX2OCT]:"=HEX2OCT(F, 3)",[n.WorksheetFuncId.IMABS]:'=IMABS("5+12i")',[n.WorksheetFuncId.IMAGE]:'=IMAGE("https://microsoft.com/abc.jpg", "Microsoft", 0)',[n.WorksheetFuncId.IMAGINARY]:'=IMAGINARY("3+4i")',[n.WorksheetFuncId.IMARGUMENT]:'=IMARGUMENT("3+4i")',[n.WorksheetFuncId.IMCONJUGATE]:'=IMCONJUGATE("3+4i")',[n.WorksheetFuncId.IMCOS]:'=IMCOS("1+i")',[n.WorksheetFuncId.IMDIV]:'=IMDIV("-238+240i","10+24i")',[n.WorksheetFuncId.IMEXP]:'=IMEXP("1+i")',[n.WorksheetFuncId.IMLN]:'=IMLN("3+4i")',[n.WorksheetFuncId.IMLOG10]:'=IMLOG10("3+4i")',[n.WorksheetFuncId.IMLOG2]:'=IMLOG2("3+4i")',[n.WorksheetFuncId.IMPOWER]:'=IMPOWER("2+3i", 3)',[n.WorksheetFuncId.IMPRODUCT]:'=IMPRODUCT("3+4i","5-3i")',[n.WorksheetFuncId.IMREAL]:'=IMREAL("6-9i")',[n.WorksheetFuncId.IMSIN]:'=IMSIN("4+3i")',[n.WorksheetFuncId.IMSQRT]:'=IMSQRT("1+i")',[n.WorksheetFuncId.IMSUB]:'=IMSUB("13+4i","5+3i")',[n.WorksheetFuncId.IMSUM]:'=IMSUM("3+4i","5-3i")',[n.WorksheetFuncId.INTRATE]:'=INTRATE("2/15/2008","5/15/2008",1000000,1014420,2)',[n.WorksheetFuncId.ISEVEN]:"=ISEVEN(2.5)",[n.WorksheetFuncId.ISODD]:"=ISODD(2.5)",[n.WorksheetFuncId.LAMBDA]:"=LAMBDA(a, b, SQRT((a^2+b^2)))",[n.WorksheetFuncId.LET]:`=LET(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Total)}, SUM(A1:A10), ${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Count)}, COUNT(A1:A10), ${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Total)} / ${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Count)})`,[n.WorksheetFuncId.LCM]:"=LCM(5,2)",[n.WorksheetFuncId.LOG10]:"=LOG10(86)",[n.WorksheetFuncId.MDURATION]:'=MDURATION("1/1/2008","1/1/2016",8%,9%,2,1)',[n.WorksheetFuncId.MROUND]:"=MROUND(10,3)",[n.WorksheetFuncId.MULTINOMIAL]:"=MULTINOMIAL(2,3,4)",[n.WorksheetFuncId.NETWORKDAYS]:'=NETWORKDAYS("10/1/2012","3/1/2013")',[n.WorksheetFuncId.NOMINAL]:"=NOMINAL(0.053543, 4)",[n.WorksheetFuncId.NOW]:"=NOW()",[n.WorksheetFuncId.OCT2BIN]:"=OCT2BIN(3,3)",[n.WorksheetFuncId.OCT2DEC]:"=OCT2DEC(54)",[n.WorksheetFuncId.OCT2HEX]:"=OCT2HEX(100,4)",[n.WorksheetFuncId.ODDFPRICE]:'=ODDFPRICE("11/11/2008","3/1/2021","10/15/2008","3/1/2009",7.85%,6.25%,100,2,1)',[n.WorksheetFuncId.ODDFYIELD]:'=ODDFYIELD("11/11/2008","3/1/2021","10/15/2008","3/1/2009",5.75%,84.5,100,2,0)',[n.WorksheetFuncId.ODDLPRICE]:'=ODDLPRICE("2/7/2008","6/15/2008","10/15/2007",3.75%,4.05%,100,2,0)',[n.WorksheetFuncId.ODDLYIELD]:'=ODDLYIELD("4/20/2008","6/15/2008","12/24/2007",3.75%,99.875,100,2,0)',[n.WorksheetFuncId.PI]:"=PI()",[n.WorksheetFuncId.PRICE]:'=PRICE("2/15/2008","11/15/2017",5.75%,6.5%,100,2,0)',[n.WorksheetFuncId.PRICEDISC]:'=PRICEDISC("2/16/2008","3/1/2008",5.25%,100,2)',[n.WorksheetFuncId.PRICEMAT]:'=PRICEMAT("2/15/2008","4/13/2008","11/11/2007",6.1%,6.1%,0)',[n.WorksheetFuncId.QUOTIENT]:"=QUOTIENT(5,2)",[n.WorksheetFuncId.RANDBETWEEN]:"=RANDBETWEEN(1,100)",[n.WorksheetFuncId.RECEIVED]:'=RECEIVED("2/15/2008","5/15/2008",1000000,5.75%,2)',[n.WorksheetFuncId.RECURSE]:"=RECURSE()",[n.WorksheetFuncId.ROUNDDOWN]:"=ROUNDDOWN(3.14159,3)",[n.WorksheetFuncId.ROUNDUP]:"=ROUNDUP(3.14159,3)",[n.WorksheetFuncId.SERIESSUM]:"=SERIESSUM(0.785398163,0,2,A4:A7)",[n.WorksheetFuncId.SQRTPI]:"=SQRTPI(1)",[n.WorksheetFuncId.TBILLEQ]:'=TBILLEQ("3/31/2008","6/1/2008",9.14%)',[n.WorksheetFuncId.TBILLPRICE]:'=TBILLPRICE("3/31/2008","6/1/2008",9%)',[n.WorksheetFuncId.TBILLYIELD]:'=TBILLYIELD("3/31/2008","6/1/2008",98.45%)',[n.WorksheetFuncId.TINV]:"=TINV(0.05464,60)",[n.WorksheetFuncId.WEEKNUM]:'=WEEKNUM("3/9/2012",2)',[n.WorksheetFuncId.WORKDAY]:'=WORKDAY("10/1/2008",151)',[n.WorksheetFuncId.XIRR]:"=XIRR(A3:A7, B3:B7, 0.1)",[n.WorksheetFuncId.XNPV]:"=XNPV(0.09, A2:A6, B2:B6)",[n.WorksheetFuncId.YEARFRAC]:'=YEARFRAC("1/1/2012","7/30/2012")',[n.WorksheetFuncId.YIELD]:'=YIELD("2/15/2008","11/15/2016",5.75%,95.04287,100,2,0)',[n.WorksheetFuncId.YIELDDISC]:'=YIELDDISC("2/16/2008","3/1/2008",99.795,100,2)',[n.WorksheetFuncId.YIELDMAT]:'=YIELDMAT("3/15/2008","11/3/2008","11/8/2007",6.25%,100.0123,0)',[n.WorksheetFuncId.TEXTSPLIT]:'=TEXTSPLIT("1,2,3;4,5,6",",",";")',[n.WorksheetFuncId.TEXTBEFORE]:'=TEXTBEFORE("Red riding hood\'s, red hood", "hood")',[n.WorksheetFuncId.TEXTAFTER]:'=TEXTAFTER("Red riding hood\'s, red hood", "hood")',[n.WorksheetFuncId.VSTACK]:"=VSTACK({1,2},{3,4},5)",[n.WorksheetFuncId.HSTACK]:"=HSTACK({1;2},{3;4},5)",[n.WorksheetFuncId.MAP]:"=MAP(A1:C2, LAMBDA(a, IF(a>4,a*a,a)))",[n.WorksheetFuncId.WRAPROWS]:"=WRAPROWS(A2:G2,3)",[n.WorksheetFuncId.SCAN]:"=SCAN(1, A1:C2, LAMBDA(a,b,a*b))",[n.WorksheetFuncId.MAKEARRAY]:"=MAKEARRAY(3, 3, LAMBDA(row,col, row*col))",[n.WorksheetFuncId.REDUCE]:"=REDUCE(, A1:C2, LAMBDA(a,b,a+b^2))",[n.WorksheetFuncId.NORMSDIST]:"=NORMDIST(A2,A3,A4,TRUE)",[n.WorksheetFuncId.CHOOSEROWS]:"=CHOOSEROWS(A2:B7,1,3,5,1)",[n.WorksheetFuncId.CHOOSECOLS]:"=CHOOSECOLS(A2:E7,1,3,5,1)",[n.WorksheetFuncId.DROP]:"=DROP(A2:C4,2)",[n.WorksheetFuncId.WRAPCOLS]:"=WRAPCOLS(A2:F2,3)",[n.WorksheetFuncId.TOCOL]:"=TOCOL(A2:D4)",[n.WorksheetFuncId.TAKE]:"=TAKE(A2:C4,2)",[n.WorksheetFuncId.TOROW]:"=TOROW(A2:D4)",[n.WorksheetFuncId.BYCOL]:`=BYCOL(A1:C2, LAMBDA(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array)}, MAX(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array)})))`,[n.WorksheetFuncId.BYROW]:`=BYROW(A1:C2, LAMBDA(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array)}, MAX(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array)})))`,[n.WorksheetFuncId.EXPAND]:"=EXPAND(A2:B3,3,3)",[n.WorksheetFuncId.DBCS]:'=DBCS("EXCEL")',[n.WorksheetFuncId.ASC]:'=ASC("EXCEL")',[n.WorksheetFuncId.LENB]:'=LENB("EXCEL")',[n.WorksheetFuncId.FURIGANA]:"=PHONETIC(C4)",[n.WorksheetFuncId.ISOMITTED]:`=LAMBDA(x,y, IF(ISOMITTED(y),"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingSecondArgument)}",x+y))(1,)`,[n.WorksheetFuncId.MIDB]:"=MIDB(A2,7,20)",[n.WorksheetFuncId.RIGHTB]:"=RIGHTB(A2,7)"})))},8346:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationDefinitionsMap=t.RegisterAnnotation=t.alFeatureNamePrefix=void 0;const n=r(9483),a=r(6366),i=r(9367),o=r(4636);t.alFeatureNamePrefix="x10";const s={[i.ALAnnotationKind.FormulaByExample]:{annotationType:n.FormulaByExampleAnnotation,isModelRequired:!1}};t.RegisterAnnotation={[i.ALAnnotationKind.FormulaByExample]:!0},t.AnnotationDefinitionsMap=(0,o.mapFromArrayOfDependantPairs)((0,a.strEnumArray)(i.ALAnnotationKind).map((e=>[e,{annotationName:s[e].annotationType.getTypeName(),featureName:`${t.alFeatureNamePrefix}_${e}`,isModelRequired:s[e].isModelRequired}])))},5563:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AugLoopService=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(7630),u=r(8346),l=r(9367),c=r(4636),d=r(637);t.AugLoopService=class{async registerALAnnotation(e){const t=this.registerAnnotationCallbacks[e].getValue();return"Failure"===(await t).kind&&this.registerAnnotationCallbacks[e].reset(),t}async sendSignal(e,t){try{const r=await this.augLoopInterop.sendSignal(e,`${u.alFeatureNamePrefix}_${s.PluginFactoryName[t]}`);return(0,i.isDefined)(r)?(0,a.success)(r):(0,n.failure)(r)}catch(e){return(0,n.failure)(e)}}constructor(e){this.augLoopInterop=e,this.registerAnnotationCallbacks=(0,c.mapFromArrayOfDependantPairs)((0,o.strEnumArray)(l.ALAnnotationKind).map((e=>[e,new d.ResettableLazy((async()=>{try{const t=u.AnnotationDefinitionsMap[e],r=await this.augLoopInterop.registerOnAnnotation(l.ALAnnotationKind[e],t.annotationName,t.featureName,t.isModelRequired);return(0,a.success)(r)}catch(e){return(0,n.failure)(e)}}))])))}}},9519:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getConvertEnum=t.speedUnitTypeEnums=t.informationUnitTypeEnums=t.areaUnitTypeEnums=t.volumeUnitTypeEnums=t.temperatureUnitTypeEnums=t.magnetismUnitTypeEnums=t.powerUnitTypeEnums=t.energyUnitTypeEnums=t.forceUnitTypeEnums=t.pressureUnitTypeEnums=t.timeUnitTypeEnums=t.distanceUnitTypeEnums=t.massUnitTypeEnums=void 0;const n=r(637);t.massUnitTypeEnums=new n.ResettableLazy((()=>[{value:"g",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gram)},{value:"sg",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Slug)},{value:"lbm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PoundM)},{value:"u",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Atomic)},{value:"ozm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ozm)},{value:"grain",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Grain)},{value:"cwt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CWeight)},{value:"uk_cwt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CWeightUk)},{value:"stone",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Stone)},{value:"ton",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ton)},{value:"uk_ton",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TonUk)}])),t.distanceUnitTypeEnums=new n.ResettableLazy((()=>[{value:"m",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Meter)},{value:"mi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMile)},{value:"Nmi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMile)},{value:"in",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Inch)},{value:"ft",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ft)},{value:"yd",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yd)},{value:"ang",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Angs)},{value:"Pica",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pica)},{value:"ell",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ell)},{value:"ly",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYr)},{value:"parsec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Parsec)},{value:"survey_mi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MileUs)}])),t.timeUnitTypeEnums=new n.ResettableLazy((()=>[{value:"yr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yr)},{value:"day",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Day)},{value:"hr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hour)},{value:"mn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Minute)},{value:"sec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sec)}])),t.pressureUnitTypeEnums=new n.ResettableLazy((()=>[{value:"Pa",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pascal)},{value:"atm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Atmos)},{value:"mmHg",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Merc)},{value:"psi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Psi)},{value:"Torr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Torr)}])),t.forceUnitTypeEnums=new n.ResettableLazy((()=>[{value:"N",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Newton)},{value:"dyn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Dyne)},{value:"lbf",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PoundF)},{value:"pond",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pond)}])),t.energyUnitTypeEnums=new n.ResettableLazy((()=>[{value:"J",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Joule)},{value:"e",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Erg)},{value:"cal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ItCal)},{value:"eV",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volt)},{value:"HPh",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorsePwHr)},{value:"Wh",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WattHr)},{value:"flb",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FtPound)},{value:"BTU",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Btu)},{value:"c",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThermCal)}])),t.powerUnitTypeEnums=new n.ResettableLazy((()=>[{value:"HP",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorsePw)},{value:"W",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Watt)},{value:"PS",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorseStr)}])),t.magnetismUnitTypeEnums=new n.ResettableLazy((()=>[{value:"T",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tessla)},{value:"ga",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gauss)}])),t.temperatureUnitTypeEnums=new n.ResettableLazy((()=>[{value:"C",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cels)},{value:"F",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Fahr)},{value:"K",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Kelv)},{value:"Rank",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Rankine)},{value:"Reau",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Reaumur)}])),t.volumeUnitTypeEnums=new n.ResettableLazy((()=>[{value:"tsp",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tsp)},{value:"tbs",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tbs)},{value:"oz",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Oz)},{value:"cup",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cup)},{value:"qt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.QuartUs)},{value:"gal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gal)},{value:"l",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Liter)},{value:"uk_pt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PintUk)},{value:"us_pt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PintUs)},{value:"ang^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AngsPow3)},{value:"barrel",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Barrel)},{value:"bushel",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bushel)},{value:"ft^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FootPow3)},{value:"GRT",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegTon)},{value:"in^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.InchPow3)},{value:"ly^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYrPow3)},{value:"mi^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMilePow3)},{value:"MTON",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MeasTon)},{value:"Nmi^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMilePow3)},{value:"Pica^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PicaPow3)},{value:"tspm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MdnTsp)},{value:"uk_gal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GalUk)},{value:"yd^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.YdPow3)},{value:"uk_qt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.QuartUk)}])),t.areaUnitTypeEnums=new n.ResettableLazy((()=>[{value:"uk_acre",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AcreUk)},{value:"us_acre",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AcreUs)},{value:"ang^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AngsPow2)},{value:"ar",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Are)},{value:"ft^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FootPow2)},{value:"ha",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hectare)},{value:"in^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.InchPow2)},{value:"ly^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYrPow2)},{value:"m^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MeterPow2)},{value:"Morgen",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Morgen)},{value:"mi^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMilePow2)},{value:"Nmi^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMilePow2)},{value:"Pica^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PicaPow2)},{value:"yd^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.YdPow2)}])),t.informationUnitTypeEnums=new n.ResettableLazy((()=>[{value:"bit",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bit)},{value:"byte",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Byte)}])),t.speedUnitTypeEnums=new n.ResettableLazy((()=>[{value:"admkn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AdmKnot)},{value:"kn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Knot)},{value:"m/hr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MSlashHr)},{value:"m/sec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MSlashSec)},{value:"mph",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MPH)}]));const a=new n.ResettableLazy((()=>[t.massUnitTypeEnums,t.distanceUnitTypeEnums,t.timeUnitTypeEnums,t.pressureUnitTypeEnums,t.forceUnitTypeEnums,t.energyUnitTypeEnums,t.powerUnitTypeEnums,t.magnetismUnitTypeEnums,t.temperatureUnitTypeEnums,t.volumeUnitTypeEnums,t.areaUnitTypeEnums,t.informationUnitTypeEnums,t.speedUnitTypeEnums]));t.getConvertEnum=function(e,t,r,n){const i=a.getValue().map((e=>e.getValue())),o=[].concat(...i);if(2===e)return o;if(3===e){const e=function(e,t,r){const n=e.spans[r[1].label].start,i=e.spans[r[1].label].end,o=t.substring(n,i).replace(/^"|"$/g,"")??"";if(""===o)return[];for(const e of a.getValue())if(e.getValue().find((e=>e.value===o)))return e.getValue();return[]}(t,r,n);return e.length>0?e:o}return[]}},5965:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteEnumPluginDependenciesResolved=t.AutocompleteEnumPlugin=void 0;const n=r(3345),a=r(3942),i=r(3166),o=r(6067),s=r(6067),u=r(6067),l=r(6366),c=r(3228),d=r(9762),g=r(6067),m=r(2820),h=r(27),p=r(6366),f=r(8564),S=r(9519),v=r(6067),F=r(7630),y=r(3338),b=r(9313),C=r(1339),A=b.PluginRegistry.create(F.PluginFactoryName.AutocompleteEnumPlugin,F.PluginGroup.Excel);let E=(()=>{let e,t,r,i=[A.x10Plugin()],d=[],y=[];return t=class{*run(e){const t=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,l.isSuccess)(t.result))return null;if(t.result.value.kind!==c.EditKind.Formula)return null;const{formula:r}=t.result.value,n=new h.AutoCompleteEnumVisitor(r,e.caretPosition);if((0,g.reduceBottomUp)(n,r),void 0===n.stringStartPosition||void 0===n.stringEndPosition||void 0===n.functionHead||void 0===n.argIndex||void 0===n.functionArgs||n.isInsideArrayNode)return null;const i=n.argIndex+1,{stringStartPosition:o,stringEndPosition:s,functionHead:u}=n,d=e.caretPosition===s?e.content.substring(o,s).toUpperCase():"";let m;if(u.id===v.WorksheetFuncId.CONVERT)m=(0,S.getConvertEnum)(i,r,e.content,n.functionArgs);else{const e=f.functionEnums.getValue();m=this.getEnumInfoByArg(i,e,u.id)}if((0,p.isNone)(m))return null;const F=yield{kind:a.ComputationRequestKind.GetConfig};if(F.kind!==a.ComputationRequestKind.GetConfig)return this.logFailure("failed to get config"),null;const y=F.config.localeInfo,b=this.getLocalizedEnumInfo(m,y);if(0===b.length)return this.logFailure("failed to get enum info for values/descriptions"),null;const{prefixedEnumInfo:C,notPrefixedEnumInfo:A}=this.getFilteredEnumInfo(d,u.id,b),E=this.shouldAddDoubleQuotes(u.id);return{items:[...this.generateCompletionItems(C,o,s,!0,E),...this.generateCompletionItems(A,o,s,!1,E)]}}generateCompletionItems(e,t,r,n,a){return e.map((e=>{const i=a?`"${e.value}"`:e.value;return{label:i,kind:F.CompletionItemKind.Enum,type:F.SuggestionKind.Simple,detail:e.description,textEdit:{newText:i,range:{start:{line:0,character:t},end:{line:0,character:r}}},isPrefixed:n}}))}getFilteredEnumInfo(e,t,r){let n=[],a=[];const i=e.replace(/^"|"$/g,"");if(this.shouldAddDoubleQuotes(t)&&e.endsWith('"')&&e.startsWith('"'))n=r.filter((e=>e.value.toUpperCase()===i));else{const e=(0,m.filterSuggestionsAccordingToPrefix)(i,r,(e=>e.value));n=e.prefixedSuggestions,a=e.notPrefixedSuggestions}return 0===n.length&&0===a.length&&a.push(...r),{prefixedEnumInfo:n,notPrefixedEnumInfo:a}}getEnumInfoByArg(e,t,r){const n=t[r];if(!(0,p.isNone)(n))return n[e]}getLocalizedEnumInfo(e,t){const r=e.map((e=>({value:"function"==typeof e.value?e.value(t):e.value,description:"function"==typeof e.description?e.description(t):e.description}))),n=r.length,a=r.filter((e=>{const{value:t,description:r}=e;return void 0!==t&&void 0!==r&&""!==t&&"undefined"!==t}));return e.length!==n&&this.logFailure("failed to get enum info for some values"),a}shouldAddDoubleQuotes(e){return e===v.WorksheetFuncId.COMPLEX||e===v.WorksheetFuncId.INFO||e===v.WorksheetFuncId.CONVERT||e===v.WorksheetFuncId.CELL}logFailure(e){u.ulsLogger.ULS.traceTag(508350686,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,`AutocompleteEnumPlugin encountered a failure with msg ${e}`)}constructor(){n.__runInitializers(this,y)}},n.__setFunctionName(t,"AutocompleteEnumPlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[A.uiMessageHandler({kind:C.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,y),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,d),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=A.injectPluginFactory(),n.__runInitializers(t,d),t})();t.AutocompleteEnumPlugin=E,(0,i.registerPluginFactory)(E.factory),t.autocompleteEnumPluginDependenciesResolved=(0,y.trackableAsyncLazy)((async()=>{const e=await d.autoCompletePluginsThread.getValue();await e.loadPluginScript("formula-authoring-strings",!0),await e.createAndAttachPlugin(F.PluginFactoryName.AutocompleteEnumPlugin),await d.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteEnumPluginDependenciesResolved")},27:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoCompleteEnumVisitor=void 0;const n=r(6067),a=r(3427);class i extends a.CaretInsideArrayNodeIdentityVisitor{appNode(e,t,r,a){return e.kind===n.NodeKind.WSF&&this.updateAssistedFunctionAndArgIndex(e,t),super.appNode(e,t,r,a)}updateAssistedFunctionAndArgIndex(e,t){for(let r=0;r<t.length;r++){const n=this.parsedFormulaTree.spans[t[r].label];if(n&&n.start-n.pre.length<=this.caretPosition&&this.caretPosition<=n.end+n.post.length&&void 0===this.functionHead){this.functionHead=e,this.argIndex=r,this.functionArgs=t,this.stringStartPosition=n.start,this.stringEndPosition=n.end;break}}}constructor(e,t){super(e,t)}}t.AutoCompleteEnumVisitor=i},8564:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionEnums=void 0;const n=r(6067),a=r(637),i=r(6067);t.functionEnums=new a.ResettableLazy((()=>({[n.WorksheetFuncId.ERROR_TYPE]:{1:[{value:e=>e.errorNames[i.ErrorType.NULL]??"",description:i.ErrorType.NULL.toString()},{value:e=>e.errorNames[i.ErrorType.DIV0]??"",description:i.ErrorType.DIV0.toString()},{value:e=>e.errorNames[i.ErrorType.VALUE]??"",description:i.ErrorType.VALUE.toString()},{value:e=>e.errorNames[i.ErrorType.REF]??"",description:i.ErrorType.REF.toString()},{value:e=>e.errorNames[i.ErrorType.NAME]??"",description:i.ErrorType.NAME.toString()},{value:e=>e.errorNames[i.ErrorType.NUM]??"",description:i.ErrorType.NUM.toString()},{value:e=>e.errorNames[i.ErrorType.NA]??"",description:i.ErrorType.NA.toString()}]},[n.WorksheetFuncId.SUBTOTAL]:{1:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PRODUCT)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEV)},{value:"8",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEVP)},{value:"9",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)},{value:"10",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VAR)},{value:"11",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VARP)},{value:"101",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"102",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"103",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"104",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"105",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"106",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PRODUCT)},{value:"107",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEV)},{value:"108",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEVP)},{value:"109",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)},{value:"110",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VAR)},{value:"111",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VARP)}]},[n.WorksheetFuncId.AGGREGATE]:{1:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PRODUCT)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEV)},{value:"8",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEVP)},{value:"9",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)},{value:"10",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VAR)},{value:"11",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VARP)},{value:"12",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"13",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MODE_SNGL)},{value:"14",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.LARGE)},{value:"15",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SMALL)},{value:"16",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PERCENTILE_INC)},{value:"17",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.QUARTILE_INC)},{value:"18",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PERCENTILE_EXC)},{value:"19",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.QUARTILE_EXC)}],2:[{value:"0",description:e=>FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))},{value:"1",description:e=>FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))},{value:"2",description:e=>FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrorValuesNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))},{value:"3",description:e=>FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsErrorValuesNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreNothing)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRows)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrorValues)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsErrorValues)}]},[n.WorksheetFuncId.CUBESET]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.None)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaAscending)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaDescending)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NaturalAscending)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NaturalDescending)}]},[n.WorksheetFuncId.VLOOKUP]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ApproximateMatch)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)}]},[n.WorksheetFuncId.HLOOKUP]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ApproximateMatch)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)}]},[n.WorksheetFuncId.XLOOKUP]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextSmallerItem)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextLargerItem)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WildcardCharacterMatch)}],6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchFirstToLast)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchLastToFirst)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchAscending)},{value:"-2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchDescending)}]},[n.WorksheetFuncId.RANK]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},[n.WorksheetFuncId.RANK_AVG]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},[n.WorksheetFuncId.RANK_EQ]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},[n.WorksheetFuncId.MATCH]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LessThan)},{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GreaterThan)}]},[n.WorksheetFuncId.XMATCH]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextSmallerItem)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextLargerItem)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WildcardCharacterMatch)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchFirstToLast)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchLastToFirst)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchAscending)},{value:"-2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchDescending)}]},[n.WorksheetFuncId.FINDN]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}],7:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnsTheFirstCharacterPositionOfTheString)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnsTheLastCharacterPositionOfTheString)}]},[n.WorksheetFuncId.TEXTBEFORE]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}]},[n.WorksheetFuncId.TEXTAFTER]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}]},[n.WorksheetFuncId.TEXTSPLIT]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreEmptyCells)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IncludeEmptyCells)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}]},[n.WorksheetFuncId.ACCRINT]:{6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ACCRINTM]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ADDRESS]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.R1C1Style)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.A1Style)}],3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Absolute)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AbsoluteRowRelativeColumn)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RelativeRowAbsoluteColumn)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Relative)}]},[n.WorksheetFuncId.AMORDEGRC]:{7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.AMORLINC]:{7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.BETA_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.BINOMDIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.BINOM_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.CHISQ_DIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.COMPLEX]:{3:[{value:"i",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ISuffixDescriptionForComplexNumber)},{value:"j",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.JSuffixDescriptionForComplexNumber)}]},[n.WorksheetFuncId.COUPDAYBS]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPDAYS]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPDAYSNC]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPNCD]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPNUM]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPPCD]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.CUMIPMT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.CUMPRINC]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.DAYS360]:{3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASDMethod)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EuropeanMethod)}]},[n.WorksheetFuncId.DISC]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.DURATION]:{5:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.EXPONDIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.EXPON_DIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.F_DIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.FIXED]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PreventCommas)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotPreventCommas)}]},[n.WorksheetFuncId.FV]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.GAMMADIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.GAMMA_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.HYPGEOM_DIST]:{5:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.INDIRECT]:{2:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.A1Style)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.R1C1Style)}]},[n.WorksheetFuncId.INTRATE]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.IPMT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.LINEST]:{3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}],4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnAdditionalRegressionStatistics)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotReturnAdditionalRegressionStatistics)}]},[n.WorksheetFuncId.LOGEST]:{3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}],4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnAdditionalRegressionStatistics)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotReturnAdditionalRegressionStatistics)}]},[n.WorksheetFuncId.LOGNORM_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.MDURATION]:{5:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.NEGBINOM_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.NORM_S_DIST]:{2:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.NORMDIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.NORM_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.NPER]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.ODDFPRICE]:{8:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ODDFYIELD]:{8:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ODDLPRICE]:{7:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ODDLYIELD]:{7:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.PMT]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.POISSON]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.POISSON_DIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.PPMT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.PRICE]:{6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.PRICEDISC]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.PRICEMAT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.QUARTILE]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MinimumValue)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MaximumValue)}]},[n.WorksheetFuncId.QUARTILE_INC]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MinimumValue)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MaximumValue)}]},[n.WorksheetFuncId.QUARTILE_EXC]:{2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)}]},[n.WorksheetFuncId.RATE]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.RECEIVED]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.REGEXEXTRACT]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexExtractMode0)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexExtractMode1)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexExtractMode2)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseInsensitiveMatch)}]},[n.WorksheetFuncId.REGEXREPLACE]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseInsensitiveMatch)}]},[n.WorksheetFuncId.REGEXTEST]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseInsensitiveMatch)}]},[n.WorksheetFuncId.ROMAN]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Classic)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Simplified)}]},[n.WorksheetFuncId.STOCKHISTORY]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Daily)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Weekly)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monthly)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoHeader)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Showheader)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ShowInstrumentIdentifierAndHeader)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],10:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],11:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}]},[n.WorksheetFuncId.TRANSLATE]:{2:[{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAF),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAF)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSQ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSQ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAM),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAM)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAZ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAZ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagEU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBHO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBHO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBRX),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBRX)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBOSNIAN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBOSNIAN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagYUE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYUE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagCA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHNE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHNE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLZH),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLZH)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagZH_CHS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZH_CHS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagZH_CHT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZH_CHT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagCS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPRS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePRS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDV),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDV)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDOI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDOI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagEN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagET),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameET)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFJ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFJ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFIL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFIL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFR_CA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFR_CA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagGL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLUG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLUG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagEL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagGU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMWW),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMWW)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagID),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameID)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIKT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIKT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIU_LATN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIU_LATN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagGA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagJA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameJA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKM),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKM)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagRW),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRW)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagGOM),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGOM)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKMR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKMR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLV),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLV)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDSB),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDSB)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMAI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMAI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagML),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameML)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMNI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMNI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMN_CYRL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMN_CYRL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMN_MONG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMN_MONG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNB),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNB)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNYA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNYA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagOR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameOR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPT_PT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePT_PT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagOTQ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameOTQ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagRO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagRUN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRUN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagRU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSM),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSM)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSR_CYRL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSR_CYRL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSR_LATN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSR_LATN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagST),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameST)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNSO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNSO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSD),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSD)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagES),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameES)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSW),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSW)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSV),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSV)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTH),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTH)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagUK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHSB),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHSB)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagUR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagUG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagUZ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUZ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagVI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameVI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagCY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagXH),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameXH)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagYO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagYUA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYUA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagZU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZU)}],3:[{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAF),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAF)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSQ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSQ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAM),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAM)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagAZ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAZ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagEU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBHO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBHO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBRX),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBRX)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBOSNIAN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBOSNIAN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagYUE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYUE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagCA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHNE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHNE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLZH),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLZH)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagZH_CHS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZH_CHS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagZH_CHT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZH_CHT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagCS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPRS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePRS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDV),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDV)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDOI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDOI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagEN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagET),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameET)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFJ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFJ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFIL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFIL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFR_CA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFR_CA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagGL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLUG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLUG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagEL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagGU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMWW),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMWW)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagID),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameID)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIKT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIKT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIU_LATN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIU_LATN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagGA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagIT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagJA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameJA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKM),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKM)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagRW),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRW)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagGOM),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGOM)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKMR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKMR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagKY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLV),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLV)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagLT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagDSB),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDSB)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMAI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMAI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagML),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameML)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMNI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMNI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMN_CYRL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMN_CYRL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMN_MONG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMN_MONG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagMI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNB),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNB)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNYA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNYA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagOR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameOR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPS),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePS)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagFA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPT_PT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePT_PT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagPA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagOTQ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameOTQ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagRO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagRUN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRUN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagRU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRU)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSM),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSM)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSR_CYRL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSR_CYRL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSR_LATN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSR_LATN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagST),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameST)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagNSO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNSO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSN),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSN)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSD),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSD)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSL),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSL)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagES),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameES)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSW),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSW)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagSV),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSV)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTT),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTT)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTE),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTE)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTH),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTH)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagBO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagTK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagUK),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUK)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagHSB),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHSB)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagUR),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUR)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagUG),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUG)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagUZ),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUZ)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagVI),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameVI)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagCY),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCY)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagXH),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameXH)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagYO),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYO)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagYUA),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYUA)},{value:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageTagZU),description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZU)}]},[n.WorksheetFuncId.TREND]:{4:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}]},[n.WorksheetFuncId.TTEST]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Paired)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleEqualVariance)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleUnequalVariance)}]},[n.WorksheetFuncId.T_TEST]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Paired)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleEqualVariance)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleUnequalVariance)}]},[n.WorksheetFuncId.VDB]:{7:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SwitchToStraightLineDepreciation)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotSwitchToStraightLineDepreciation)}]},[n.WorksheetFuncId.WEEKDAY]:{2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Sundaythrough7Saturday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Mondaythrough7Sunday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers0Mondaythrough6Sunday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Mondaythrough7Sunday)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Tuesdaythrough7Monday)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Wednesdaythrough7Tuesday)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Thursdaythrough7Wednesday)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Fridaythrough7Thursday)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Saturdaythrough7Friday)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Sundaythrough7Saturday)}]},[n.WorksheetFuncId.WEIBULL]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.WEIBULL_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.YEARFRAC]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.YIELD]:{6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.YIELDDISC]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.YIELDMAT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.GROWTH]:{4:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}]},[n.WorksheetFuncId.PV]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.TDIST]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}]},[n.WorksheetFuncId.T_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.WEEKNUM]:{2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tuesday)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Wednesday)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Thursday)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Friday)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Saturday)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday)},{value:"21",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)}]},[n.WorksheetFuncId.NETWORKDAYS_INTL]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdaySunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayMonday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayTuesday)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayWednesday)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayThursday)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayFriday)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridaySaturday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayOnly)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayOnly)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayOnly)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayOnly)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayOnly)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridayOnly)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdayOnly)}]},[n.WorksheetFuncId.WORKDAY_INTL]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdaySunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayMonday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayTuesday)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayWednesday)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayThursday)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayFriday)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridaySaturday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayOnly)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayOnly)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayOnly)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayOnly)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayOnly)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridayOnly)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdayOnly)}]},[n.WorksheetFuncId.FORECAST_ETS]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],6:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}]},[n.WorksheetFuncId.FORECAST_ETS_CONFINT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],7:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}]},[n.WorksheetFuncId.FORECAST_ETS_SEASONALITY]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],4:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}]},[n.WorksheetFuncId.FORECAST_ETS_STAT]:{4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaParameterOfETSalgorithm)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BetaParameterOfETSalgorithm)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GammaParameterOfETSalgorithm)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MASEMetric)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMAPEMetric)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MAEMetric)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RMSEMetric)},{value:"8",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.StepSizeDetected)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],6:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}]},[n.WorksheetFuncId.TEXTJOIN]:{2:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreEmptyCells)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IncludeEmptyCells)}]},[n.WorksheetFuncId.SORT]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)}],4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SortByColumn)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SortByRow)}]},[n.WorksheetFuncId.UNIQUE]:{2:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnUniqueColumns)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnUniqueRows)}],3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnitemsthatAppearExactlyOnce)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnEveryDistinctItem)}]},[n.WorksheetFuncId.SORTBY]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)}]},[n.WorksheetFuncId.RANDARRAY]:{5:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Integer)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Decimal)}]},[n.WorksheetFuncId.VALUETOTEXT]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Concise)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Strict)}]},[n.WorksheetFuncId.ARRAYTOTEXT]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Concise)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Strict)}]},[n.WorksheetFuncId.TOCOL]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KeepAllValues)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanks)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrors)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanksAndErrors)}],3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByRow)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByColumn)}]},[n.WorksheetFuncId.TOROW]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KeepAllValues)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanks)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrors)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanksAndErrors)}],3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByRow)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByColumn)}]},[n.WorksheetFuncId.IMAGE]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FitCell)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FillCell)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OriginalSize)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CustomSize)}]}})))},3427:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteBaseVisitor=t.CaretInsideArrayNodeIdentityVisitor=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(3219);class s extends n.IdentityVisitor{arrayNode(e,t,r){const n=super.arrayNode(e,t,r);return this.autoCompleteFixForArrayNodesEnabled&&this.caretInNode(n)&&(this.isInsideArrayNode=!0),n}caretInNode(e){if(void 0===e)return!1;const t=this.parsedFormulaTree.spans[e.label];return void 0!==t&&this.caretPosition>=t.start&&this.caretPosition<=t.end}constructor(e,t){super(),this.parsedFormulaTree=e,this.caretPosition=t,this.isInsideArrayNode=!1,this.autoCompleteFixForArrayNodesEnabled=(0,o.isChangeGateEnabled)("OfficeVSO:7896479_autoCompleteFixForArrayNodesEnabled")}}t.CaretInsideArrayNodeIdentityVisitor=s,t.AutocompleteBaseVisitor=class extends s{nameNode(e,t,r){return e.kind!==n.NamePartKind.IdentNamePart&&e.kind!==n.NamePartKind.FieldRefNamePart||this.updateAutocompleteString(r,e.asWhole),super.nameNode(e,t,r)}appNode(e,t,r,n){return this.autoCompleteForCellRefEnabled&&e.kind===a.NodeKind.WSF&&this.updateAutocompleteString(n,e.whole),super.appNode(e,t,r,n)}cellRefNode(e,t,r){const n=this.parsedFormulaTree.spans[r];if(e.kind===i.CellRefKind.Single&&n){const e=this.formulaString.substring(n.start,n.end);this.updateAutocompleteString(r,e)}return super.cellRefNode(e,t,r)}updateAutocompleteString(e,t){const r=this.parsedFormulaTree.spans[e].start,n=r+t.length;this.caretPosition===n&&(this.autocompleteString=t,this.stringEndPosition=n,this.stringStartPosition=r)}constructor(e,t,r,n){super(e,t),this.formulaString=r,this.autoCompleteForCellRefEnabled=n}}},6607:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteFunctionPluginDependenciesResolved=t.AutocompleteFunctionPlugin=void 0;const n=r(3345),a=r(3942),i=r(3166),o=r(6067),s=r(6067),u=r(6067),l=r(6366),c=r(3228),d=r(9762),g=r(6067),m=r(295),h=r(7630),p=r(7630),f=r(2820),S=r(3427),v=r(3219),F=r(6366),y=r(6366),b=r(3338),C=r(9313),A=r(1339),E=C.PluginRegistry.create(p.PluginFactoryName.AutocompleteFunctionPlugin,h.PluginGroup.Excel);let T=(()=>{let e,t,r,i=[E.x10Plugin()],d=[],p=[];return t=class{*run(e){const t=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,l.isSuccess)(t.result))return null;if(t.result.value.kind!==c.EditKind.Formula)return null;const{formula:r}=t.result.value,n=new S.AutocompleteBaseVisitor(r,e.caretPosition,e.content,this.autoCompleteForCellRefEnabled);if((0,g.reduceBottomUp)(n,r),void 0===n.autocompleteString||void 0===n.stringStartPosition||void 0===n.stringEndPosition||n.isInsideArrayNode)return null;const i=n.autocompleteString.toUpperCase(),o=n.stringStartPosition,s=n.stringEndPosition,u=yield{kind:a.ComputationRequestKind.GetFunctionsInfo};if(u.kind!==a.ComputationRequestKind.GetFunctionsInfo)return this.logFailure("failed to get functions info"),null;const d=u.functionsInfo,{prefixedSuggestions:h,notPrefixedSuggestions:p}=(0,f.filterSuggestionsAccordingToPrefix)(i,d,(e=>e.NameDataStrings)),v=m.functionShortDescriptions.getValue();null!==v&&null!==v.descriptionMap||this.logFailure("failed to get short descriptions, will show function info help description");const F=(0,f.getCompletedFunctionSuffix)(e.content,s);return{items:[...this.generateCompletionItems(h,v,o,s,!0,F),...this.generateCompletionItems(p,v,o,s,!1,F)]}}generateCompletionItems(e,t,r,n,a,i){const l=[],c=e.map((e=>{const o=e.FunctionIndexInServer.toString();let s=(0,y.isTypedChangeGateEnabled)("Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions")?t.descriptionMap?.[o]:t.descriptionMap?.get(o);return(0,F.isNone)(s)&&(l.push(e.FunctionIndexInServer),s=e.Help),{label:e.NameDataStrings,kind:h.CompletionItemKind.Function,type:h.SuggestionKind.Simple,detail:s,textEdit:{newText:e.NameDataStrings+i,range:{start:{line:0,character:r},end:{line:0,character:n}}},isPrefixed:a,shouldRequestAutocompleteOnCommit:!0}}));return l.length>0&&u.ulsLogger.ULS.traceTag(508871621,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,`AutocompleteFunctionPlugin missing short descriptions for func IDs: ${JSON.stringify(l)}`),c}logFailure(e){u.ulsLogger.ULS.traceTag(539083013,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,`AutocompleteFunctionPlugin encountered a failure with msg ${e}`)}constructor(){this.autoCompleteForCellRefEnabled=(n.__runInitializers(this,p),(0,v.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef"))}},n.__setFunctionName(t,"AutocompleteFunctionPlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[E.uiMessageHandler({kind:A.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,p),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,d),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=E.injectPluginFactory(),n.__runInitializers(t,d),t})();t.AutocompleteFunctionPlugin=T,(0,i.registerPluginFactory)(T.factory),t.autocompleteFunctionPluginDependenciesResolved=(0,b.trackableAsyncLazy)((async()=>{const e=await d.autoCompletePluginsThread.getValue();await e.loadPluginScript("formula-authoring-strings",!0),await e.createAndAttachPlugin(p.PluginFactoryName.AutocompleteFunctionPlugin),await d.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteFunctionPluginDependenciesResolved")},2820:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCompletedFunctionSuffix=t.getStructRefCompletionItemRank=t.endOf=t.verifyTextAndRange=t.filterSuggestionsAccordingToPrefix=void 0;const n=r(4068),a=r(6366),i=r(6366),o=r(6366),s=r(7630);t.filterSuggestionsAccordingToPrefix=function(e,t,r,n=!1){const a=[],o=[],s=e.toLocaleLowerCase();return""===e?{prefixedSuggestions:t,notPrefixedSuggestions:o}:(t.forEach((e=>{const t=r?r(e).toLocaleLowerCase():"string"==typeof e?e.toLocaleLowerCase():void 0;if(void 0!==t)if(!t.startsWith(s)||n&&t===s)if(n){const r=t.split(" ");(0,i.isDefined)(r.find((e=>e.startsWith(s))))&&o.push(e)}else s.length>2&&t.includes(s)&&o.push(e);else a.push(e)})),{prefixedSuggestions:a,notPrefixedSuggestions:o})},t.verifyTextAndRange=(e,t,r,n,a)=>{expect(e?.label).toEqual(t),expect(e?.textEdit?.newText).toEqual(a??t),expect(e?.textEdit?.range?.start?.character).toEqual(r),expect(e?.textEdit?.range?.end?.character).toEqual(n)},t.endOf=e=>e.length,t.getStructRefCompletionItemRank=e=>{const t=e.kind===s.CompletionItemKind.TableHeader?1:e.label?.startsWith("#")?0:e.label?.startsWith("@")?2:void 0;return(0,o.isNone)(t)?(a.ulsLogger.ULS.traceTag(526411872,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,`conflictResolver: trying to rank a structRef completion item with unexpected fields. item = ${JSON.stringify(e)}`),0):t},t.getCompletedFunctionSuffix=function(e,t){return"("===e?.charAt(t)?"":"("}},4444:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteLetPluginDependenciesResolved=t.AutocompleteLetPlugin=void 0;const n=r(3345),a=r(3942),i=r(3166),o=r(6366),s=r(3228),u=r(9762),l=r(6067),c=r(8097),d=r(2820),g=r(3219),m=r(7630),h=r(3338),p=r(9313),f=r(1339),S=p.PluginRegistry.create(m.PluginFactoryName.AutocompleteLetPlugin,m.PluginGroup.Excel);let v=(()=>{let e,t,r,i=[S.x10Plugin()],u=[],h=[];return t=class{*run(e){const t=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,o.isSuccess)(t.result))return null;if(t.result.value.kind!==s.EditKind.Formula)return null;const{formula:r}=t.result.value,n=e.caretPosition,i=new c.AutocompleteLetVisitor(this.autoCompleteForCellRefEnabled,e.content,r,n);(0,l.reduceBottomUp)(i,r);const u=i.references.reverse(),g=Array.from(new Set(u)),m=i.caretNodeText;if(void 0===m||i.isInsideArrayNode)return null;const h=n,p=h-m.length,{prefixedSuggestions:f,notPrefixedSuggestions:S}=(0,d.filterSuggestionsAccordingToPrefix)(m,g);return{items:[...this.stringsToCompletionItems(f,p,h,!0),...this.stringsToCompletionItems(S,p,h,!1)]}}stringsToCompletionItems(e,t,r,n){return e.map((e=>({label:e,kind:m.CompletionItemKind.LetVariable,type:m.SuggestionKind.Simple,textEdit:{newText:e,range:{start:{line:0,character:t},end:{line:0,character:r}}},isPrefixed:n})))}constructor(){this.autoCompleteForCellRefEnabled=(n.__runInitializers(this,h),(0,g.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef"))}},n.__setFunctionName(t,"AutocompleteLetPlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[S.uiMessageHandler({kind:f.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,h),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,u),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=S.injectPluginFactory(),n.__runInitializers(t,u),t})();t.AutocompleteLetPlugin=v,(0,i.registerPluginFactory)(v.factory),t.autocompleteLetPluginDependenciesResolved=(0,h.trackableAsyncLazy)((async()=>{const e=await u.autoCompletePluginsThread.getValue();await e.createAndAttachPlugin(m.PluginFactoryName.AutocompleteLetPlugin),await u.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteLetPluginDependenciesResolved")},8097:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteLetVisitor=void 0;const n=r(6067),a=r(3427),i=r(6366);class o extends a.CaretInsideArrayNodeIdentityVisitor{letNode(e,t,r,a,i,o){if(this.caretInNode(r?.arg))this.pushNames(t);else for(let r=0;r<t.length;r+=1){const{binder:a}=t[r];if(this.caretInNode(a.arg)){this.pushNames(e.id===n.WorksheetFuncId.LET?t.slice(0,r):t);break}}return super.letNode(e,t,r,a,i,o)}lambdaNode(e,t,r,n,a,i){if(this.caretInNode(r?.arg))this.pushNames(t);else for(let e=0;e<t.length;e+=1){const{name:r}=t[e];if(void 0!==r.arg.def&&this.caretInNode(r.arg.def.rhs)){this.pushNames(t.slice(0,e));break}}return super.lambdaNode(e,t,r,n,a,i)}pushNames(e){(0,i.safePush)(this.references,e.map((({name:e})=>e.arg.wholeName)).filter(i.isDefined).reverse())}constructor(e,t){super(e,t),this.references=[]}}t.AutocompleteLetVisitor=class extends o{nameNode(e,t,r){return this.updateCaretNodeText(r,e.asWhole),super.nameNode(e,t,r)}cellRefNode(e,t,r){const a=this.parsedFormulaTree.spans[r];if(this.autoCompleteForCellRefEnabled&&e.kind===n.CellRefKind.Single&&a){const e=this.formulaString.substring(a.start,a.end);this.updateCaretNodeText(r,e)}return super.cellRefNode(e,t,r)}updateCaretNodeText(e,t){const r=this.parsedFormulaTree.spans[e]?.end;void 0!==r&&this.caretPosition===r&&t.length>0&&(this.caretNodeText=t)}constructor(e,t,r,n){super(r,n),this.autoCompleteForCellRefEnabled=e,this.formulaString=t}}},8200:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteNamedObjectsPluginDependenciesResolved=t.AutocompleteNamedObjectsPlugin=void 0;const n=r(3345),a=r(3942),i=r(3166),o=r(6067),s=r(6067),u=r(6067),l=r(6366),c=r(3228),d=r(9762),g=r(7630),m=r(3427),h=r(6067),p=r(2820),f=r(6366),S=r(6366),v=r(7630),F=r(3219),y=r(7630),b=r(3338),C=r(9313),A=r(1339),E=C.PluginRegistry.create(y.PluginFactoryName.AutocompleteNamedObjectsPlugin,g.PluginGroup.Excel);let T=(()=>{let e,t,r,i=[E.x10Plugin()],d=[],y=[];return t=class{*run(e){const t=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,l.isSuccess)(t.result))return null;if(t.result.value.kind!==c.EditKind.Formula)return null;const{formula:r}=t.result.value,n=yield{kind:a.ComputationRequestKind.GetDefinedNamesInfo};if(n.kind!==a.ComputationRequestKind.GetDefinedNamesInfo)return this.logFailure("failed to get named objects info"),null;const i=n.definedNamesInfo,o=new m.AutocompleteBaseVisitor(r,e.caretPosition,e.content,this.autoCompleteForCellRefEnabled);(0,h.reduceBottomUp)(o,r);const{autocompleteString:s,stringStartPosition:u,stringEndPosition:d,isInsideArrayNode:g}=o;if(!(0,f.isDefined)(s)||!(0,f.isDefined)(d)||!(0,f.isDefined)(u)||g)return null;const{prefixedSuggestions:F,notPrefixedSuggestions:y}=(0,p.filterSuggestionsAccordingToPrefix)(s,i,(e=>e.name));if(this.newNamedObjectsEnabled){const t=[...F.map((e=>({...e,isPrefixed:!0}))),...y.map((e=>({...e,isPrefixed:!1})))];for(const e of t){if((0,S.isNone)(e.reference)||e.type!==v.DefinedNameInfoType.Other)continue;const t=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:e.reference};if(t.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,l.isSuccess)(t.result)||t.result.value.kind!==c.EditKind.Formula)return null;const{formula:r}=t.result.value;r.isWellFormed&&"Lambda"===r.node.kind&&r.node.isClosed&&(e.type=v.DefinedNameInfoType.Lambda)}const r=(0,p.getCompletedFunctionSuffix)(e.content,d);return{items:this.namesToCompletionItems(t,u,d,r)}}return{items:[...this.namesToCompletionItemsOld(F,u,d,!0),...this.namesToCompletionItemsOld(y,u,d,!1)]}}namesToCompletionItemsOld(e,t,r,n){return e.filter((e=>e.type!==v.DefinedNameInfoType.Invalid)).map((e=>({label:e.name,kind:e.type===v.DefinedNameInfoType.NamedRange?g.CompletionItemKind.NamedRange:g.CompletionItemKind.Table,type:g.SuggestionKind.Simple,textEdit:{newText:e.name,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:e.tooltip,isPrefixed:n})))}namesToCompletionItems(e,t,r,n){return e.filter((e=>e.type!==v.DefinedNameInfoType.Invalid)).map((e=>{const a=function(e){switch(e.type){case v.DefinedNameInfoType.NamedRange:return g.CompletionItemKind.NamedRange;case v.DefinedNameInfoType.Table:return g.CompletionItemKind.Table;case v.DefinedNameInfoType.Lambda:return g.CompletionItemKind.Lambda;default:return g.CompletionItemKind.NamedOther}}(e);let i=e.name;return a===g.CompletionItemKind.Lambda&&(i+=n),{label:e.name,kind:a,type:g.SuggestionKind.Simple,textEdit:{newText:i,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:e.tooltip,isPrefixed:e.isPrefixed}}))}logFailure(e){u.ulsLogger.ULS.traceTag(528562134,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,`AutocompleteNamedObjectPlugin encountered a failure with msg ${e}`)}constructor(){this.autoCompleteForCellRefEnabled=(n.__runInitializers(this,y),(0,F.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef")),this.newNamedObjectsEnabled=(0,F.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAuthoringWithNameManager",!1)&&(0,F.getBooleanFeatureGate)("Microsoft.Office.Excel.XLONameManager",!1)}},n.__setFunctionName(t,"AutocompleteNamedObjectsPlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[E.uiMessageHandler({kind:A.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,y),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,d),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=E.injectPluginFactory(),n.__runInitializers(t,d),t})();t.AutocompleteNamedObjectsPlugin=T,(0,i.registerPluginFactory)(T.factory),t.autocompleteNamedObjectsPluginDependenciesResolved=(0,b.trackableAsyncLazy)((async()=>{const e=await d.autoCompletePluginsThread.getValue();await e.createAndAttachPlugin(y.PluginFactoryName.AutocompleteNamedObjectsPlugin),await d.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteNamedObjectsPluginDependenciesResolved")},7230:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteRichValuePluginDependenciesResolved=t.AutocompleteRichValuePlugin=void 0;const n=r(3345),a=r(3942),i=r(3166),o=r(9762),s=r(7630),u=r(3647),l=r(6366),c=r(6366),d=r(3228),g=r(6067),m=r(6067),h=r(6366),p=r(6366),f=r(6366),S=r(2820),v=r(6067),F=r(7630),y=r(472),b=r(3219),C=r(3338),A=r(9313),E=r(1339),T=r(6067),R=r(6067),k=A.PluginRegistry.create(F.PluginFactoryName.AutocompleteRichValuePlugin,s.PluginGroup.Excel);let N=(()=>{let e,t,r,i=[k.x10Plugin()],o=[],f=[];var F=t=class{*run(e){if((0,p.isNone)(e.content)||(0,p.isNone)(e.caretPosition))return I("missing request arguments"),null;const t=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,l.isSuccess)(t.result))return null;if(t.result.value.kind!==d.EditKind.Formula)return null;const{formula:r}=t.result.value,n=yield{kind:a.ComputationRequestKind.GetDefinedNamesInfo};if(n.kind!==a.ComputationRequestKind.GetDefinedNamesInfo)return I("failed to get named objects info"),null;const i=yield{kind:a.ComputationRequestKind.GetActiveCell};if(i.kind!==a.ComputationRequestKind.GetActiveCell)return I("failed to get active cell"),null;const o=i.activeCell,f=new u.AutocompleteRichValueVisitor(r,e.caretPosition,e.content,n.definedNamesInfo,o.range);if((0,g.reduceBottomUp)(f,r),f.isInsideArrayNode)return null;let F,y;if((0,h.isDefined)(f.cellRef))F=f.cellRef,y=o.sheet.index;else if((0,h.isDefined)(f.namedRangeNode)){const e={originGridCell:(0,c.success)(o.range),originSheet:(0,c.success)(o.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},t=yield{kind:a.ComputationRequestKind.ResolveReferences,nodes:[f.namedRangeNode],locals:e};if(t.kind===a.ComputationRequestKind.ResolveReferences){const e=t.resolverResults[0];if(e.kind===v.ResolvedKind.ResolvedStructRef&&(0,l.isSuccess)(e.resolution)&&void 0!==e.resolution.value){const t=e.resolution.value.range;F={firstRow:t.row,firstColumn:t.col,lastRow:t.row+t.rows-1,lastColumn:t.col+t.cols-1},y=e.resolution.value.sheet.index}}}if(!(0,h.isDefined)(F))return null;const b=f.dotNotationPath;if((0,p.isNone)(b))return I("failed to parse cellRef"),null;let C="";if((0,h.isDefined)(f.sheetName))C=f.sheetName;else{const e=yield{kind:a.ComputationRequestKind.GetSheetNames};if(e.kind!==a.ComputationRequestKind.GetSheetNames)return I("failed to get sheet names"),null;if(!(0,m.isDocumentLocEqual)(o.sheet.document,e.document))return I("sheet names document is different than that of active cell"),null;if(!(0,h.isDefined)(y))return I("sheet index is undefined"),null;C=e.sheets[e.idToIndex[y]].sheetName}const A={...F,sheetName:C,namedObjectName:""},E=yield{kind:a.ComputationRequestKind.GetRichValueFieldListContext,rangeToQuery:A,dotNotationPath:b,singleColumn:!1,findRange:!1};if(E.kind!==a.ComputationRequestKind.GetRichValueFieldListContext)return I("failed to get field list context data"),null;if((0,p.isNone)(E.result)||0===E.result.length)return null;E.result.length>1&&I("fieldListContextRequest results length greater than 1");const{prefixedSuggestions:T,notPrefixedSuggestions:R}=(0,S.filterSuggestionsAccordingToPrefix)(f.richValueItemPrefix,E.result[0].FieldInfoDataList,(e=>e.Name),!0),k=yield{kind:a.ComputationRequestKind.GetConfig};let N=[...this.resultsToCompletionItems(T,!0,f.dotNotationIndex,f.fieldRefChainEndIndex??e.caretPosition,k,!!f.namedRangeNode),...this.resultsToCompletionItems(R,!1,f.dotNotationIndex,f.fieldRefChainEndIndex??e.caretPosition,k,!!f.namedRangeNode)];var O,P;return f.shouldAddEmptySuggestion&&(N=[(O=f.dotNotationIndex,P=f.fieldRefChainEndIndex??e.caretPosition,{label:"",kind:s.CompletionItemKind.RichEntityEmptyCellRef,type:s.SuggestionKind.Simple,detail:"",textEdit:{newText:"",range:{start:{line:0,character:O},end:{line:0,character:P}}},isPrefixed:!0}),...N]),{items:N}}static getTextToCommit(e,t,r,n){let i=e.Name;if(i=i.replace("'","''"),i=i.replace("[","'["),i=i.replace("]","']"),e.RefersToDotFunction)return`.${i}`;if(r){if(n)return`.[${i}]`;const e=t.kind===a.ComputationRequestKind.GetConfig?t.config.localeInfo:void 0;return e&&!(0,y.isUnbracketedFieldName)(e,i)?`.[${i}]`:`.${i}`}return`.[${i}]`}resultsToCompletionItems(e,t,r,n,a,i){return e.map((e=>({label:e.Name,kind:s.CompletionItemKind.RichEntity,type:s.SuggestionKind.Simple,detail:"",textEdit:{newText:F.getTextToCommit(e,a,this.dontAlwaysAddBracketsEnabled,i),range:{start:{line:0,character:r},end:{line:0,character:n}}},isPrefixed:t})))}constructor(){this.dontAlwaysAddBracketsEnabled=(n.__runInitializers(this,f),(0,b.isChangeGateEnabled)("OfficeVSO:7765276_RichValueAutoCompleteDontAlwayAddBrackets"))}};return n.__setFunctionName(t,"AutocompleteRichValuePlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[k.uiMessageHandler({kind:E.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,f),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,o),F=t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=k.injectPluginFactory(),n.__runInitializers(t,o),F=t})();function I(e){f.ulsLogger.ULS.traceTag(529056660,T.LogCategory.msoulscat_ES_EWAJS,R.TraceLevel.Warning,`AutocompleteRichValuePlugin encountered a failure with msg ${e}`)}t.AutocompleteRichValuePlugin=N,(0,i.registerPluginFactory)(N.factory),t.autocompleteRichValuePluginDependenciesResolved=(0,C.trackableAsyncLazy)((async()=>{const e=await o.dynamicPluginLoaderCreated.getValue();await e.createAndAttachPlugin(F.PluginFactoryName.AutocompleteRichValuePlugin),await o.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteRichValuePluginDependenciesResolved")},3647:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteRichValueVisitor=void 0;const n=r(6366),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(7630),d=r(6366),g=r(1811),m=r(3427);class h extends m.CaretInsideArrayNodeIdentityVisitor{nameNode(e,t,r){const a=this.parsedFormulaTree.spans[r]?.end;if(a===this.caretPosition&&e.kind===u.NamePartKind.IdentNamePart&&this.trySetDefinedName(e)&&(this.dotNotationIndex=a,this.childFieldRefLabel=r),e.kind===u.NamePartKind.FieldRefNamePart){const r=this.parsedFormulaTree.spans[e.lhs.label]?.end;if((0,n.isDefined)(r)&&(this.caretPosition===a||this.isCaretAfterDotBeforeStartOfFieldRef(r,e.rhs)&&e.lhs.kind!==u.NamePartKind.FieldRefNamePart)){let n=!1;e.lhs.kind===u.NamePartKind.CellRefNamePart?(this.setCellRef(e.lhs.ref,t),n=!0):e.lhs.kind===u.NamePartKind.IdentNamePart&&this.trySetDefinedName(e.lhs)&&(n=!0),n&&(this.dotNotationIndex=r,e.rhs.field.kind===s.NodeKind.Ident&&(this.caretPosition===a?this.richValueItemPrefix=e.rhs.field.whole:this.fieldRefChainEndIndex=a))}}return super.nameNode(e,t,r)}cellRefNode(e,t,r){const n=this.parsedFormulaTree.spans[r]?.end;return void 0!==n&&this.caretPosition===n&&(this.setCellRef(e,t),this.dotNotationIndex=n,this.childFieldRefLabel=r,this.shouldAddEmptySuggestion=!0),super.cellRefNode(e,t,r)}fieldRefNode(e,t,r){const n=this.parsedFormulaTree.spans[r]?.end,a=this.parsedFormulaTree.spans[e.label]?.end;return void 0===n||void 0===a||(this.isCaretAtEndOfFieldRefNode(n,t)?(this.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(e,r),this.dotNotationIndex=a,this.richValueItemPrefix=p(t)):this.isCaretAfterDotBeforeStartOfFieldRef(a,t)?(this.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(e,r),this.dotNotationIndex=a,this.fieldRefChainEndIndex=n):e.label===this.childFieldRefLabel&&(this.fieldRefChainEndIndex=n,this.childFieldRefLabel=r)),super.fieldRefNode(e,t,r)}structRefNode(e,t,r){const a=super.structRefNode(e,t,r),i=this.parsedFormulaTree.spans[r]?.end;return this.caretPosition===i&&(0,n.isDefined)(e)&&t.isClosed&&a.kind===s.NodeKind.StructRef&&this.definedNames.some((t=>t.type===c.DefinedNameInfoType.Table&&(0,n.isDefined)(t.name)&&t.name.toLowerCase()===e.whole.toLowerCase()))&&(this.setNamedNodeRef(a),this.dotNotationIndex=i),a}initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(e,t){let r=e;for(;r.kind===s.NodeKind.FieldRef;)this.dotNotationPath="["+p(r.rhs)+"]."+this.dotNotationPath,r=r.lhs;r.kind===s.NodeKind.CellRef&&this.setCellRef(r.ref,r.qualifier),r.kind===s.NodeKind.StructRef&&this.setNamedNodeRef(r),r.kind===s.NodeKind.Name&&this.trySetDefinedName(r.parts),this.childFieldRefLabel=t}getRefString(e){const t=this.parsedFormulaTree.spans[e]?.start,r=this.parsedFormulaTree.spans[e]?.end;return(0,n.isDefined)(t)&&(0,n.isDefined)(r)&&t>=0&&r<this.formulaText.length?this.formulaText.substring(t,r):""}setCellRef(e,t){e.kind!==l.CellRefKind.Single&&e.kind!==l.CellRefKind.Range||(this.cellRef=(0,g.getRangeFromCellRef)(e,this.activeCell,f)),(0,n.isDefined)(t)&&(this.sheetName=(0,g.getSheetNameFromQualifier)(t,f)),this.trySetDotNotationPathOrigin((()=>this.getRefString(e.label)))}setNamedNodeRef(e){this.namedRangeNode=e,this.trySetDotNotationPathOrigin((()=>this.getRefString(e.label)))}isCaretAfterDotBeforeStartOfFieldRef(e,t){if(!(0,n.isDefined)(t))return!1;const r=this.parsedFormulaTree.spans[t.field.label]?.start;return void 0!==r&&this.caretPosition>e&&(this.caretPosition<r||!t.isBracketed&&this.caretPosition===r)}isCaretAtEndOfFieldRefNode(e,t){if(this.caretPosition===e)return!0;const r=this.parsedFormulaTree.spans[t.field.label]?.end;return!(!(0,n.isDefined)(r)||this.caretPosition!==r)}trySetDefinedName(e){if(e.canDenoteNamedObject){const t=this.definedNames.find((t=>t.name?.toLowerCase()===e.asWhole.toLowerCase()));if((0,n.isDefined)(t))return this.setDefinedName(t),!0}return!1}setDefinedName(e){const t=e.namedRange;if(!(0,n.isDefined)(t))return;const r=e.sheetName??t.sheetName;(0,n.isDefined)(r)&&(this.sheetName=r),this.cellRef={firstRow:t.top-1,firstColumn:t.left-1,lastRow:t.bottom-1,lastColumn:t.right-1},this.trySetDotNotationPathOrigin((()=>e.name))}trySetDotNotationPathOrigin(e){if(this.onlySendNestedDotNotationPathEnabled){if(this.dotNotationPath.length>0){const t=e();(0,n.isDefined)(t)?this.dotNotationPath=t+"."+this.dotNotationPath:f("tryUpdateDotNotationPath with undefined name")}}else this.dotNotationPath=e()+(this.dotNotationPath.length>0?"."+this.dotNotationPath:"")}constructor(e,t,r,n,a){super(e,t),this.formulaText=r,this.definedNames=n,this.activeCell=a,this.dotNotationPath="",this.richValueItemPrefix="",this.dotNotationIndex=0,this.shouldAddEmptySuggestion=!1,this.onlySendNestedDotNotationPathEnabled=(0,d.isTypedChangeGateEnabled)("OfficeVSO:6476056_OnlySendNestedDotNotationPath")}}function p(e){return e.field.kind!==s.NodeKind.Ident?"":e.field.whole}function f(e){o.ulsLogger.ULS.traceTag(523257827,a.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`AutocompleteRichValueVisitor failed with msg: ${e}`)}t.AutocompleteRichValueVisitor=h},1761:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteTableHeadersPluginDependenciesResolved=void 0;const n=r(3345),a=r(3942),i=r(3166),o=r(6067),s=r(6067),u=r(6067),l=r(6366),c=r(3228),d=r(637),g=r(9762),m=r(7630),h=r(6067),p=r(6366),f=r(6366),S=r(7630),v=r(1342),F=r(2820),y=r(6067),b=r(7630),C=r(6366),A=r(3219),E=r(873),T=r(3338),R=r(9313),k=r(1339),N=R.PluginRegistry.create(b.PluginFactoryName.AutocompleteTableHeadersPlugin,m.PluginGroup.Excel);let I=(()=>{let e,t,r,i=[N.x10Plugin()],d=[],g=[];return t=class{*run(e){const{content:t,caretPosition:r}=e;if((0,f.isNone)(t)||(0,f.isNone)(r))return null;const n=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:t};if(n.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,l.isSuccess)(n.result))return null;if(n.result.value.kind!==c.EditKind.Formula)return null;const{formula:i}=n.result.value,d=yield{kind:a.ComputationRequestKind.GetDefinedNamesInfo};if(d.kind!==a.ComputationRequestKind.GetDefinedNamesInfo)return this.logFailure("failed to get named objects info"),null;const g=d.definedNamesInfo.filter((e=>e.type===S.DefinedNameInfoType.Table)).map((e=>e.name)).filter(p.isDefined);if(0===g.length)return null;let m;m=this.fixAutocompleteTableHeadersBugEnabled?new v.AutocompleteTableHeadersVisitor(i,r,g):new E.AutocompleteTableHeadersVisitorOld(i,r,g),(0,h.reduceBottomUp)(m,i);let{tableName:F}=m;const{containingNode:y,isInsideArrayNode:b,isNodeClosed:C}=m;if((0,f.isNone)(y)||b)return null;if((0,f.isNone)(F)){const e=yield{kind:a.ComputationRequestKind.GetActiveCell};if(e.kind!==a.ComputationRequestKind.GetActiveCell)return this.logFailure("Couldn't get active cell"),null;const t=yield{kind:a.ComputationRequestKind.GetContainingTable,cell:e.activeCell};if(t.kind!==a.ComputationRequestKind.GetContainingTable||!(0,l.isSuccess)(t.result))return this.logFailure(`GetContainingTable request failed. result kind = ${JSON.stringify(t)}`),null;if(F=t.result.value?.name,(0,f.isNone)(F))return null}let{start:A,end:T}=y;const R=t.charAt(T-1);if("]"!==R&&")"!==R||T--,"["===t.charAt(A)&&A++,!(r===T||this.fixAutocompleteTableHeadersBugEnabled&&this.caretIsInTheBeginning(t,A,r)))return null;const k=yield{kind:a.ComputationRequestKind.GetAvailableTableHeaders,tableName:F};let N;if(k.kind!==a.ComputationRequestKind.GetAvailableTableHeaders||!(0,l.isSuccess)(k.result)||(0,f.isNone)(k.result.value)||this.getTableHeadersFromServerEnabled&&k.result.value.isPartial){if(this.getTableHeadersFromServerEnabled){u.ulsLogger.ULS.traceTag(509682331,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"AutocompleteTableHeadersPlugin getting col headers from server");const e=yield{kind:a.ComputationRequestKind.GetFullTableHeadersFromServer,tableName:F};if(e.kind!==a.ComputationRequestKind.GetFullTableHeadersFromServer||!(0,p.isDefined)(e.result))return this.logFailure("Failed to get header names from server"),null;N=e.result}}else N=k.result.value.cols;if(!(0,p.isDefined)(N)||0===N.length)return null;let I="";this.fixAutocompleteTableHeadersBugEnabled&&this.caretIsInTheBeginning(t,A,r)?T=C?T:A:I=t.substring(A,T);const O=yield{kind:a.ComputationRequestKind.GetConfig};return O.kind!==a.ComputationRequestKind.GetConfig?(this.logFailure("getConfig request failed"),null):{items:this.getCompletionItems(N,I,A,T,m.isWithinThisRowOp,O.config.localeInfo.specialRefNames)}}caretIsInTheBeginning(e,t,r){return 0===e.substring(t,r).trim().length}generateCompletionItems(e,t,r,n,a,i){const o=[];return e.forEach((e=>{const s="string"==typeof e,u=s?e:e.name,l=s?void 0:e.description;o.push({label:u,kind:a,type:m.SuggestionKind.Simple,textEdit:{newText:(0,p.isDefined)(i)?i(u):u,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:l,isPrefixed:n})})),o}generateHeadersCompletionItems(e,t,r,n,a=!1){const{prefixedSuggestions:i,notPrefixedSuggestions:o}=(0,F.filterSuggestionsAccordingToPrefix)(e,t),s=this.getHeaderTextEditCallback(a);return[...this.generateCompletionItems(i,r,n,!0,m.CompletionItemKind.TableHeader,s),...this.generateCompletionItems(o,r,n,!1,m.CompletionItemKind.TableHeader,s)]}generateSpecialCaseCompletionItems(e,t,r,n){const a=[y.SpecialRefId.All,y.SpecialRefId.Data,y.SpecialRefId.Headers,y.SpecialRefId.Totals].map((e=>({name:n[e]??"",description:O.getValue()[e]}))),{prefixedSuggestions:i,notPrefixedSuggestions:o}=(0,F.filterSuggestionsAccordingToPrefix)(r,a,(e=>e.name));return[...this.generateCompletionItems(i,e,t,!0,m.CompletionItemKind.TableSpecialStructRef),...this.generateCompletionItems(o,e,t,!1,m.CompletionItemKind.TableSpecialStructRef)]}generateThisRowOpCompletionItem(e,t,r){return{label:`@ - ${r}`,kind:m.CompletionItemKind.TableSpecialStructRef,type:m.SuggestionKind.Simple,textEdit:{newText:"@",range:{start:{line:0,character:e},end:{line:0,character:t}}},detail:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisRowOpDescription),shouldRequestAutocompleteOnCommit:!0}}logFailure(e){u.ulsLogger.ULS.traceTag(526508764,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,`AutocompleteTableHeadersPlugin encountered a failure with msg ${e}`)}constructor(){this.getTableHeadersFromServerEnabled=(n.__runInitializers(this,g),(0,C.isTypedChangeGateEnabled)("OfficeVSO:7396249_getTableHeadersFromServer")),this.fixAutocompleteTableHeadersBugEnabled=(0,A.isChangeGateEnabled)("OfficeVSO:7899833_fixAutocompleteTableHeadersBug"),this.getCompletionItems=(e,t,r,n,a,i)=>{const o="@"===t.charAt(0);if(o||a){const a=o?r+1:r,i=o?t.substring(1):t;return this.generateHeadersCompletionItems(i,e,a,n,!0)}const s=[];if(""===t){const e=i[y.SpecialRefId.ThisRow]?.substring(1);this.fixAutocompleteTableHeadersBugEnabled?s.push(this.generateThisRowOpCompletionItem(r,r,e)):s.push(this.generateThisRowOpCompletionItem(r,n,e))}return s.push(...this.generateSpecialCaseCompletionItems(r,n,t,i)),s.push(...this.generateHeadersCompletionItems(t,e,r,n)),s},this.getHeaderTextEditCallback=e=>t=>{const r=P(t);return e&&this.hasSpecialChars(r)?`[${r}]`:r},this.hasSpecialChars=e=>{try{return new RegExp("(?=\\P{L})(?=\\P{M})(?=\\P{N})","u").test(e)}catch(e){return this.logFailure(`hasSpecialChars method, error: ${e}.`),!0}}}},n.__setFunctionName(t,"AutocompleteTableHeadersPlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[N.uiMessageHandler({kind:k.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,g),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,d),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=N.injectPluginFactory(),n.__runInitializers(t,d),t})();(0,i.registerPluginFactory)(I.factory),t.autocompleteTableHeadersPluginDependenciesResolved=(0,T.trackableAsyncLazy)((async()=>{const e=(0,C.isTypedChangeGateEnabled)("OfficeVSO:7396249_getTableHeadersFromServer")?await g.dynamicPluginLoaderCreated.getValue():await g.autoCompletePluginsThread.getValue();await e.createAndAttachPlugin(b.PluginFactoryName.AutocompleteTableHeadersPlugin),await g.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteTableHeadersPluginDependenciesResolved");const O=new d.ResettableLazy((()=>({[y.SpecialRefId.All]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefAllDescription),[y.SpecialRefId.Data]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefDataDescription),[y.SpecialRefId.Headers]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefHeadersDescription),[y.SpecialRefId.Totals]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefTotalsDescription),[y.SpecialRefId.ThisRow]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisRowOpDescription)}))),P=e=>e.replace(/\[|\]|\'|\@|\#/g,"'$&")},1342:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteTableHeadersVisitor=void 0;const n=r(6366),a=r(6366),i=r(6067),o=r(3427);class s extends o.CaretInsideArrayNodeIdentityVisitor{structRefNode(e,t,r){if(this.isCaretInNode(t)){e&&this.tableNames.forEach((t=>{t.toLocaleLowerCase()===e.whole.toLocaleLowerCase()&&(this.tableName=t)}));const r=this.parsedFormulaTree.spans[t.label];this.isNodeClosed=this.isStructRefClosed=t.isClosed,this.containingNode=r,void 0!==t.innerRef&&this.findContainingNode(t.innerRef)}return super.structRefNode(e,t,r)}getIsNodeClosed(e){return e.isBracketed?e.isClosed:this.isStructRefClosed}isCaretInNode(e){const t=this.parsedFormulaTree.spans[e.label];return(0,n.isDefined)(t)&&this.caretPosition<=t.end&&this.caretPosition>=t.start}isCaretInBeginningOfNode(e){return(0,n.isDefined)(e)&&this.caretPosition===e.start}constructor(e,t,r){super(e,t),this.tableNames=r,this.isWithinThisRowOp=!1,this.isStructRefClosed=!1,this.isNodeClosed=!1,this.findContainingNode=e=>{const t=this.parsedFormulaTree.spans[e.label];if(this.isCaretInNode(e))switch(e.kind){case i.StructRefKind.SpecialRef:case i.StructRefKind.ColumnRef:case i.StructRefKind.BadRef:this.isTighterThanCurrent(t)&&(this.containingNode=t,this.isNodeClosed=this.getIsNodeClosed(e));break;case i.StructRefKind.ThisRowOpRef:const r=e.ref;if(this.isCaretInBeginningOfNode(t))break;this.isWithinThisRowOp=!0,(0,n.isDefined)(r)?this.findContainingNode(r):this.isTighterThanCurrent(t)&&(this.containingNode=t,this.isNodeClosed=this.isStructRefClosed);break;case i.StructRefKind.CommaOpRef:if(this.isCaretInBeginningOfNode(t))break;e.refs.map(this.findContainingNode);break;case i.StructRefKind.RangeOpRef:if(this.isCaretInBeginningOfNode(t))break;const a=e;this.findContainingNode(a.lhs),this.findContainingNode(a.rhs);break;case i.StructRefKind.MissingRef:this.containingNode=void 0}},this.isTighterThanCurrent=e=>(0,n.isDefined)(e)&&((0,a.isNone)(this.containingNode)||e.end<this.containingNode.end||e.start>this.containingNode.start)}}t.AutocompleteTableHeadersVisitor=s},873:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteTableHeadersVisitorOld=void 0;const n=r(6366),a=r(6366),i=r(6067),o=r(3427);class s extends o.CaretInsideArrayNodeIdentityVisitor{structRefNode(e,t,r){return this.isCaretInNode(t)&&(e&&this.tableNames.forEach((t=>{t.toLocaleLowerCase()===e.whole.toLocaleLowerCase()&&(this.tableName=t)})),void 0===t.innerRef?this.containingNode=this.parsedFormulaTree.spans[t.label]:this.findContainingNode(t.innerRef)),super.structRefNode(e,t,r)}isCaretInNode(e){const t=this.parsedFormulaTree.spans[e.label];return(0,n.isDefined)(t)&&this.caretPosition<=t.end&&this.caretPosition>=t.start}constructor(e,t,r){super(e,t),this.tableNames=r,this.isWithinThisRowOp=!1,this.isNodeClosed=!1,this.findContainingNode=e=>{const t=this.parsedFormulaTree.spans[e.label];if(this.isCaretInNode(e))switch(e.kind){case i.StructRefKind.SpecialRef:case i.StructRefKind.ColumnRef:case i.StructRefKind.BadRef:this.isTighterThanCurrent(t)&&(this.containingNode=t);break;case i.StructRefKind.ThisRowOpRef:const r=e.ref;this.isWithinThisRowOp=!0,(0,n.isDefined)(r)?this.findContainingNode(r):this.isTighterThanCurrent(t)&&(this.containingNode=t);break;case i.StructRefKind.CommaOpRef:e.refs.map(this.findContainingNode);break;case i.StructRefKind.RangeOpRef:const a=e;this.findContainingNode(a.lhs),this.findContainingNode(a.rhs);break;case i.StructRefKind.MissingRef:this.containingNode=void 0}},this.isTighterThanCurrent=e=>(0,n.isDefined)(e)&&((0,a.isNone)(this.containingNode)||e.end<this.containingNode.end||e.start>this.containingNode.start)}}t.AutocompleteTableHeadersVisitorOld=s},295:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionShortDescriptions=void 0;const n=r(6067),a=r(637),i=r(6366),o=r(4068),s=r(6366);t.functionShortDescriptions=new a.ResettableLazy((()=>{try{const e=new Map,t={};for(const r of Object.keys(n.WorksheetFuncId)){const a=Number(r);if(!isNaN(Number(a))){const r=FormulaAuthoringStrings[n.WorksheetFuncId[a]+"ShortDescription"];e.set(a.toString(),r),t[a.toString()]=r}}return(0,s.isTypedChangeGateEnabled)("Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions")?{descriptionMap:t}:{descriptionMap:e}}catch(e){return i.ulsLogger.ULS.traceTag(538792415,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`failed to get functionShortDescriptionsMap with exception ${e}`),{}}}))},7485:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeEventCallbacksManager=t.makeALAnnotationNotifier=t.makeEventEmitter=t.isALAnnotationEventKind=t.ALAnnotationKinds=t.ExternallyHandledEventKinds=t.ExternallyTriggeredEventKinds=t.ALAnnotationKind=t.EventKind=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(4636);var u,l;!function(e){e.InternalTestEvent="InternalTestEvent",e.TestEvent="TestEvent",e.FBECacheUpdateEvent="FBECacheUpdateEvent",e.FBESendSignal="FBESendSignal",e.FBEOutcomeUpdate="FBEOutcomeUpdate",e.FBECacheUpdateEventDeprecated="FBECacheUpdateEventDeprecated",e.FormulaTranspilerInitEvent="FormulaTranspilerInitEvent"}(u||(t.EventKind=u={})),function(e){e.FormulaByExample="FormulaByExample"}(l||(t.ALAnnotationKind=l={})),t.ExternallyTriggeredEventKinds=[u.TestEvent,u.FBEOutcomeUpdate,u.FormulaTranspilerInitEvent],t.ExternallyHandledEventKinds=[u.TestEvent],t.ALAnnotationKinds=(0,o.strEnumArray)(l),t.isALAnnotationEventKind=e=>t.ALAnnotationKinds.findIndex((t=>e===t))>=0,(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),t.makeEventEmitter=function(e){return(0,s.mapFromArrayOfDependantPairs)(t.ExternallyTriggeredEventKinds.map((t=>[t,r=>e.triggerEvent(t,r).then((()=>{}))])))},t.makeALAnnotationNotifier=function(e){const r=t=>r=>(0,n.isNone)(r)?Promise.resolve(null):Promise.resolve(e.triggerEvent(t,r));(0,a.staticAssertExtends)();const i={};for(const e of t.ALAnnotationKinds)i[e]=r(e);return i},t.makeEventCallbacksManager=async function(){const e=(0,s.mapFromArrayOfDependantPairs)(t.ExternallyHandledEventKinds.map((e=>[e,[]]))),r=t=>r=>{for(const n of e[t])n(r)};return{registerEventCallback:(t,r)=>e[t].push(r),...(0,s.mapFromArrayOfDependantPairs)(t.ExternallyHandledEventKinds.map((e=>[e,r(e)])))}}},9367:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ALAnnotationKind=t.EventKind=void 0;var n=r(7485);Object.defineProperty(t,"EventKind",{enumerable:!0,get:function(){return n.EventKind}}),Object.defineProperty(t,"ALAnnotationKind",{enumerable:!0,get:function(){return n.ALAnnotationKind}})},1339:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultPluginResponseWindows=t.RequestKind=void 0;var n=r(8534);Object.defineProperty(t,"RequestKind",{enumerable:!0,get:function(){return n.RequestKind}}),Object.defineProperty(t,"defaultPluginResponseWindows",{enumerable:!0,get:function(){return n.defaultPluginResponseWindows}})},8534:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeSyncRequester=t.makeRequester=t.requestKindCellContentNamesMap=t.defaultPluginResponseWindows=t.RequestKind=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(3942),s=r(6366);var u;!function(e){e.functionSuggestion="functionSuggestion",e.inCellSuggestion="inCellSuggestion",e.formulaHighlighting="formulaHighlighting",e.argumentAssistance="argumentAssistance",e.valuePreview="valuePreview",e.gotoCtrlClick="gotoCtrlClick",e.runExperiment="runExperiment",e.runAuthoringExperiment="runAuthoringExperiment",e.runPerCharacterExperiment="runPerCharacterExperiment",e.runTest="runTest",e.formulaRepair="formulaRepair",e.chatGPTQuery="chatGPTQuery",e.columnFormulaSuggestion="columnFormulaSuggestion",e.setCellPrefetch="setCellPrefetch",e.getTranspiledFormulas="getTranspiledFormulas",e.inCellControlsAutodetection="inCellControlsAutodetection",e.getLocale="getLocale"}(u||(t.RequestKind=u={})),(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)(),t.defaultPluginResponseWindows={[u.functionSuggestion]:{startDelta:5,stopDelta:2e3},[u.inCellSuggestion]:{startDelta:5,stopDelta:2e3},[u.formulaHighlighting]:{startDelta:5,stopDelta:2e3},[u.argumentAssistance]:{startDelta:5,stopDelta:2e3},[u.valuePreview]:{startDelta:5,stopDelta:2e3},[u.gotoCtrlClick]:{startDelta:5,stopDelta:2e3},[u.formulaRepair]:{startDelta:5,stopDelta:2e3},[u.runExperiment]:{startDelta:0,stopDelta:15e3},[u.runAuthoringExperiment]:{startDelta:0,stopDelta:15e3},[u.runPerCharacterExperiment]:{startDelta:5,stopDelta:2e3},[u.runTest]:{startDelta:0,stopDelta:15e3},[u.chatGPTQuery]:{startDelta:0,stopDelta:15e3},[u.columnFormulaSuggestion]:{startDelta:0,stopDelta:2e4},[u.setCellPrefetch]:{startDelta:(0,s.isTypedChangeGateEnabled)("OfficeVSO:9150789_CancelSuppressedRequests")?100:5,stopDelta:(0,s.isTypedChangeGateEnabled)("OfficeVSO:9275652_changeStopDeltaPrefetchPlugin")?2e4:2e3},[u.getTranspiledFormulas]:{startDelta:0,stopDelta:5e3},[u.inCellControlsAutodetection]:{startDelta:0,stopDelta:2e3},[u.getLocale]:{startDelta:0,stopDelta:2e3}},i.staticAssertSame,t.requestKindCellContentNamesMap={[u.functionSuggestion]:"content",[u.inCellSuggestion]:"content",[u.formulaHighlighting]:"content",[u.argumentAssistance]:"content",[u.valuePreview]:"text",[u.runAuthoringExperiment]:"content",[u.runPerCharacterExperiment]:"content",[u.formulaRepair]:"formula",[u.gotoCtrlClick]:"text",[u.columnFormulaSuggestion]:void 0,[u.setCellPrefetch]:void 0,[u.runExperiment]:void 0,[u.runTest]:void 0,[u.chatGPTQuery]:void 0,[u.getTranspiledFormulas]:void 0,[u.inCellControlsAutodetection]:void 0,[u.getLocale]:void 0},t.makeRequester=function(e){const t=t=>(...[r,a,i])=>(0,n.isNone)(r)?Promise.resolve(null):Promise.resolve(e.doRequest(t,r,a,i??o.DefaultComputationGroup));return{argumentAssistance:t(u.argumentAssistance),chatGPTQuery:t(u.chatGPTQuery),columnFormulaSuggestion:t(u.columnFormulaSuggestion),formulaHighlighting:t(u.formulaHighlighting),formulaRepair:t(u.formulaRepair),functionSuggestion:t(u.functionSuggestion),gotoCtrlClick:t(u.gotoCtrlClick),inCellSuggestion:t(u.inCellSuggestion),runAuthoringExperiment:t(u.runAuthoringExperiment),runExperiment:t(u.runExperiment),runPerCharacterExperiment:t(u.runPerCharacterExperiment),runTest:t(u.runTest),valuePreview:t(u.valuePreview),setCellPrefetch:t(u.setCellPrefetch),getTranspiledFormulas:t(u.getTranspiledFormulas),inCellControlsAutodetection:t(u.inCellControlsAutodetection),getLocale:t(u.getLocale)}},t.makeSyncRequester=function(e){return{runTest:(t,r,a)=>(0,n.isNone)(t)?null:e.doSyncRequest(u.runTest,t,r,a??o.DefaultComputationGroup),formulaHighlighting:(t,r,a)=>(0,n.isNone)(t)?null:e.doSyncRequest(u.formulaHighlighting,t,r,a??o.DefaultComputationGroup),columnFormulaSuggestion:(t,r,a)=>(0,n.isNone)(t)?null:e.doSyncRequest(u.columnFormulaSuggestion,t,r,a??o.DefaultComputationGroup)}}},8206:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComputationKinds=t.ComputationType=void 0;const n=r(6366),a=r(6366),i=r(7485),o=r(8534);var s;!function(e){e.UIMessage="UIMessage",e.Event="Event"}(s||(t.ComputationType=s={})),t.ComputationKinds={[s.UIMessage]:o.RequestKind,[s.Event]:{...i.EventKind,...i.ALAnnotationKind}},(0,a.staticAssertSame)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)()},8869:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFormulaContent=t.isFormulaRequest=t.getShouldRunComputationPredicate=t.computationRegistry=t.registerComputation=t.deletePluginRegistration=t.wrapRegistration=void 0;const n=r(6366),a=r(8206),i=r(4636),o=r(6067),s=r(1276),u=r(8534);class l{push(e,t){this.registeredComputations.get(t)?o.ulsLogger.ULS.traceTag(507330770,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`Computation '${JSON.stringify(t.computationIdentifier)}' already registered`):(this.byFactoryName.get(e).push(t),this.registeredComputations.set(t,!0))}getRegistrationsByPluginIdentifier(e){return this.byFactoryName.get(e)}getRegistrationByComputationIdentifier(e){return this.getRegistrationsByPluginIdentifier(e).find((t=>t.computationIdentifier.computationName===e.computationName))}deleteRegistrationsByPluginIdentifier(e){let t=0;for(const r of this.byFactoryName.get(e))this.registeredComputations.delete(r),t++;return this.byFactoryName.delete(e),t}constructor(){this.registeredComputations=new i.DefaultMap({getKey:e=>`${e.computationIdentifier.factoryName}.${e.computationIdentifier.pluginName}.${e.computationIdentifier.computationName}.${e.computationIdentifier.executionType}`,getDefault:()=>!1}),this.byFactoryName=new i.DefaultMap({getKey:e=>`${e.factoryName}.${e.pluginName}`,getDefault:()=>[]})}}const c=(0,i.mapFromArrayOfDependantPairs)((0,n.strEnumArray)(a.ComputationType).map((e=>[e,new l])));function d(e,t){return function(r,n){for(const t of h)if(!t({registration:e,input:r,pluginGroup:n}))return!1;return void 0===t||t(r,n)}}function g(e){return void 0!==u.requestKindCellContentNamesMap[e]}function m(e){const t=u.requestKindCellContentNamesMap[e[0]];(0,i.staticTypeHint)(t);const r=e[1][t];return(0,i.staticTypeHint)(r),r}t.wrapRegistration=(e,t,r,n,a,i,o,s)=>{const u=d({type:e,kind:t,pluginGroup:n,modifiers:i},s);return{type:e,kind:t,execution:r,pluginGroup:n,computationIdentifier:a,modifiers:i,registrationMethod:(n,i)=>([s,l])=>{if(!u(s.computationInput,l))return void n.addResult({type:e,computationKind:t,computationIdentifier:a,computationGroup:s.computationGroup,correlationId:s.correlationId},{kind:"Skipped"});const c=o.bind(i);n.startComputation(e,t,r,a,c(s.computationInput),s)}}},t.deletePluginRegistration=e=>{let t=0;for(const r of(0,n.strEnumArray)(a.ComputationType))t+=c[r].deleteRegistrationsByPluginIdentifier(e);t>0&&s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.PluginAttachmentFailure,failureLevel:o.TraceLevel.Warning,path:"deletePluginRegistration",description:"Deleted plugin registration",data:e}})},t.registerComputation=(e,r,n,a,i,o,s,u)=>{const l=(0,t.wrapRegistration)(e,r,n,a,i,o,s,u);c[e].push(i,l)},t.computationRegistry=c,t.getShouldRunComputationPredicate=d,t.isFormulaRequest=g,t.getFormulaContent=m;const h=[({registration:e,pluginGroup:t})=>void 0===t||t===e.pluginGroup,({registration:e,input:t})=>{if(e.type!==a.ComputationType.UIMessage||e.modifiers.runOnNonFormula)return!0;if((0,i.staticTypeHint)(e.kind),!g(e.kind))return!0;const r=[e.kind,t];(0,i.staticTypeHint)(r);const n=m(r);return-1!==["=","+","-"].indexOf(n[0])}]},5235:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ExecutionType=void 0,function(e){e.NoOp="NoOp",e.Sync="Sync",e.Async="Async"}(r||(t.ExecutionType=r={}))},2857:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormulaAuthoringHelperSingleton=void 0;const n=r(6366),a=r(5114);t.FormulaAuthoringHelperSingleton=(0,n.singleton)((()=>new a.FormulaAuthoringHelper))},5114:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormulaAuthoringHelper=void 0;const n=r(6366),a=r(6366),i=r(6067),o=r(6067),s=r(6067),u=r(3465),l=r(3116),c=r(8909),d=r(3219);t.FormulaAuthoringHelper=class{getMinimalParamArray(e,t){if((0,a.isNone)(t))return;const{minArgs:r,restTypes:i}=(0,c.getWorksheetFuncTypeWrapper)(t);let o;o=(0,d.isChangeGateEnabled)("OfficeVSO:9292450_FixWrongParamForCFInArgumentsDialog")?i.length>0&&!t.IsDynamicUdf?Math.max(r,2):e?.length??0:i.length>0?Math.max(r,2):e?.length??0;const s=[];for(let r=0;r<o;r+=1){const a=this.getFunctionParamByIndex(e,t,r);(0,n.isDefined)(a)&&s.push(a)}return s}getFunctionParamByIndex(e,t,r){if((0,a.isNone)(t))return;const n=t.ParamsHelp.split("!");let i="",o=!1,s="";if((0,d.isChangeGateEnabled)("OfficeVSO:9292450_FixWrongParamForCFInArgumentsDialog")&&t.IsDynamicUdf){if(r<=e.length-1&&(o=/^\[.*\]$/.test(e[r]),i=o?e[r].slice(1,-1):e[r],s=n[r]),r>=e.length-1)if(t.Params.endsWith("..."))i=`${(0,u.getBaseParamName)(e[e.length-1])}${r-e.length+2}`,o=!0,s=n[n.length-1];else if(r!==e.length-1)return void this.logError("Trying to get param by index that is out of bounds")}else{const a=(0,c.getWorksheetFuncTypeWrapper)(t),l=a.headTypes.length,d=(0,u.getParamIndexToHighlight)(r,e.length,a,!1,!0);if(-1===d)return void this.logError("Trying to get param by index that is out of bounds");if(d>=e.length)return void this.logError("Trying to add param for a signature that doesn't have rest params.");i=r<l?e[d].match(/[^\[\]]+/).toString():`${(0,u.getBaseParamName)(e[d])}${(0,u.getParamNumberSuffix)(r,l,a.restTypes.length)}`,o=r>=a.minArgs,s=n[(0,u.getParamIndexToHighlight)(r,t.ParamsHelp.split("!").length,a)]}return{name:i,isOptional:o,description:s,type:"TO DO"}}getFormulaAnonymizer(e){const t=new l.ConsistentAnonymizer;return{anonymize:(r,a)=>{try{return i=r,(0,n.isDefined)(i)&&"string"==typeof i?function(e){return(0,n.isDefined)(e)&&"object"==typeof e&&"localeInfo"in e&&"mathpack"in e&&"refStyle"in e}(e)?function(e){return(0,n.isDefined)(e)&&"object"==typeof e&&"row"in e&&"col"in e&&1===e.rows&&1===e.cols}(a)?t.anonymize(r,e,a):(this.logError("getFormulaAnonymizer: Origin"),null):(this.logError("getFormulaAnonymizer: Config"),null):(this.logError("getFormulaAnonymizer: Formula"),null)}catch(e){return this.logError(`getFormulaAnonymizer: ${e}`),null}var i}}}logError(e){s.ulsLogger.ULS.traceTag(512331973,i.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,`FormulaAuthoringHelper error: ${e}`)}constructor(){this.hasRepeatingParams=e=>(0,a.isNone)(e)?(this.logError("hasRepeatingParams: funcInfo is null or undefined"),!1):(0,c.getWorksheetFuncTypeWrapper)(e).restTypes.length>0}}},8909:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFuncTypeWrapper=void 0;const n=r(6067),a=r(6067);t.getWorksheetFuncTypeWrapper=function(e){return i(e)?o[e.FunctionIndexInServer][e.signatureIndex]:(0,a.getWorksheetFuncType)(e.FunctionIndexInServer)};const i=e=>{if(void 0===e)return!1;const{FunctionIndexInServer:t,signatureIndex:r}=e;return!(0!==r&&1!==r||t!==n.WorksheetFuncId.AGGREGATE&&t!==n.WorksheetFuncId.INDEX&&t!==n.WorksheetFuncId.LOOKUP)},o={[n.WorksheetFuncId.AGGREGATE]:[{headTypes:[1,1,48,17],restTypes:[],tailTypes:[],minArgs:3,maxArgs:4},{headTypes:[1,1],restTypes:[16],tailTypes:[],minArgs:3,maxArgs:255}],[n.WorksheetFuncId.INDEX]:[{headTypes:[48,1,1],restTypes:[],tailTypes:[],minArgs:2,maxArgs:3},{headTypes:[48,1,1,1],restTypes:[],tailTypes:[],minArgs:2,maxArgs:4}],[n.WorksheetFuncId.LOOKUP]:[{headTypes:[263,48,48],restTypes:[],tailTypes:[],minArgs:2,maxArgs:3},{headTypes:[263,48],restTypes:[],tailTypes:[],minArgs:2,maxArgs:2}]}},3116:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsistentAnonymizer=void 0;const n=r(472);var a=n.stopUsingThis.tokenizeFormula,i=n.stopUsingThis.singleLineCommentToken,o=n.stopUsingThis.multiLineCommentToken,s=n.stopUsingThis.TokenKind,u=n.stopUsingThis.identToken,l=n.stopUsingThis.literalToken,c=n.stopUsingThis.cellRefA1Token,d=n.stopUsingThis.TokenOperKind,g=n.stopUsingThis.cellRefR1C1Token,m=n.stopUsingThis.unexpectedToken,h=n.stopUsingThis.DelimId;const p=r(6067),f=r(6067),S=r(6366);class v{get(e,t,r){if(e===s.Literal){if(void 0===r)throw new Error("Expected subkind");return this.literalStore.get(r)?.get(t)}return this.nonLiteralStore.get(e)?.get(t)}set(e,t,r,n){if(e===s.Literal){if(void 0===n)throw new Error("Expected subkind");const e=this.literalStore.get(n)??new Map;e.set(t,r),this.literalStore.set(n,e)}else{const n=this.nonLiteralStore.get(e)??new Map;n.set(t,r),this.nonLiteralStore.set(e,n)}}constructor(){this.nonLiteralStore=new Map,this.literalStore=new Map}}t.ConsistentAnonymizer=class{getAnonymization(e,t,r,n){const a=this.store.get(e,r,t);if(void 0!==a)return a;const i=n(this.counter);return this.counter+=1,this.store.set(e,r,i,t),i}anonymizeIdent(e,t,r,n){const a=t??e.start,i=r?.localeInfo.getWorksheetFuncId(e.chars);if(void 0!==i&&function(e){return void 0!==e&&e.kind===s.Left&&e.value===h.Paren}(n))return u(a,e.chars);const o=this.getAnonymization(e.kind,void 0,e.chars,(e=>`ident${e}`));return u(a,o)}anonymizeA1CellRef(e,t){if(e.refStyle!==p.RefStyle.A1)throw new Error("Expected RefStyle.A1");const r=t??e.start,n=this.getAnonymization(e.kind,void 0,e.chars,(e=>`A${e}`));return c(r,n,void 0,void 0)}anonymizeR1C1CellRef(e,t){if(e.refStyle!==p.RefStyle.R1C1)throw new Error("Expected RefStyle.R1C1");const r=t??e.start,n=this.getAnonymization(e.kind,void 0,e.chars,(e=>`R${e}C${e}`));return g(r,n,void 0,void 0)}anonymizeCellRef(e,t){return e.refStyle===p.RefStyle.A1?this.anonymizeA1CellRef(e,t):this.anonymizeR1C1CellRef(e,t)}anonymizeLiteral(e,t){const r=t??e.start;let n;switch(e.oper.kind){case f.OperKind.Number:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(e=>`${e}`));break;case f.OperKind.String:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(e=>`"s${e}"`));break;case d.BadNumber:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(e=>`1e${e}000`));break;case d.BadError:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(e=>{const t=["a"],r="a".charCodeAt(0);let n=e;for(;n>0;){const a=e%10,i=String.fromCharCode(r+a);t.push(i),n=Math.floor(n/10)}return`#${t.join("")}`}));break;case f.OperKind.Boolean:case f.OperKind.Error:n=e.chars;break;default:(0,S.assertNever)("error",e.oper)}const a=e.oper,i=e.hasRight;return l(r,n,a,i)}anonymizeToken(e,t,r,n){switch(e.kind){case s.Ident:return this.anonymizeIdent(e,t,r,n);case s.CellRef:return this.anonymizeCellRef(e,t);case s.Literal:return this.anonymizeLiteral(e,t);case s.Unexpected:return function(e,t){const r=t??e.start;return"\t"===e.chars||";"===e.chars?m(r,e.chars):m(r,"\t")}(e,t);case s.SingleLineComment:return i(t,"redacted");case s.MultiLineComment:return o(t,"redacted",e.isClosed);case s.End:case s.Left:case s.Right:case s.Sep:case s.Operator:case s.Spaces:case s.SpecialRef:case s.Escape:return{...e,start:t};default:return(0,S.assertNever)("ConsistentAnonymizer.anonymizeToken",e)}}anonymize(e,t,r){const n=a(t.localeInfo,t.mathpack,t.refStyle,r,e,0,{}),i=[];let o=0;for(let e=0;e<n.length;e+=1){const r=n[e],a=e+1<n.length?n[e+1]:void 0,s=this.anonymizeToken(r,o,t,a);o+=s.chars.length,i.push(s)}return i.map((e=>e.chars)).join("")}constructor(){this.store=new v,this.counter=1}}},9217:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulaCollectionPluginDependenciesResolved=t.combineSplitCollectedFormulaLogs=t.deserializeSplitCollectedFormulaLog=t.FormulaCollectionPlugin=void 0;const n=r(3345),a=r(3942),i=r(3166),o=r(6067),s=r(6067),u=r(6067),l=r(6366),c=r(3228),d=r(6067),g=r(4068),m=r(3116),h=r(472),p=r(472),f=r(472),S=r(6067),v=r(9762),F=r(7630),y=r(3338),b=r(9313),C=r(1339);function A(e){u.ulsLogger.ULS.traceTag(537962337,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Verbose,e)}const E=b.PluginRegistry.create(F.PluginFactoryName.FormulaCollectionPlugin,F.PluginGroup.Excel);let T=(()=>{let e,t,r,i=[E.x10Plugin()],v=[],y=[];var b=t=class{getEditEntry(e,t){const r={content:e,cell:t};if(void 0===this.lastEdit||!(0,S.isSheetGridCellEqual)(this.lastEdit.cell,t)||this.lastEdit.content!==e)return this.lastEdit=r,r}anonymizeSheetId(e){if(this.sheetIdAnonymization.has(e))return this.sheetIdAnonymization.get(e);const t=(0,g.getNewGuid)()[0];return this.sheetIdAnonymization.set(e,t),t}*run(e){const t=yield{kind:a.ComputationRequestKind.GetActiveCell};if(t.kind!==a.ComputationRequestKind.GetActiveCell)return A(I.GetActiveCell),null;const r=t.activeCell;if(null==e.content)return A(I.EmptyContent),null;if(!e.content.trimLeft().startsWith("="))return null;const n=this.getEditEntry(e.content,r);if(void 0===n)return null;const i=yield{kind:a.ComputationRequestKind.GetConfig};if(i.kind!==a.ComputationRequestKind.GetConfig)return A(I.GetConfig),null;const g=i.config,m=(0,p.createAnalyzeGlobals)(g),S=(0,d.lexicalSourceCell)(n.cell),v=(0,h.analyzeLocalsGrid)(S.kind,S.range),F=(0,f.createAnalyzer)(m),y=this.consistentAnonymizer.anonymize(n.content,g,r.range),C=yield{kind:a.ComputationRequestKind.ParseEdit,cell:n.cell,formulaBarText:y};if(C.kind!==a.ComputationRequestKind.ParseEdit||!(0,l.isSuccess)(C.result))return A(I.ParseEdit),null;if(C.result.value.kind!==c.EditKind.Formula)return null;const E=C.result.value.formula,T=E.isWellFormed;let R;if(!T){const e=F.checkFormulaWithDiagnostics(v,E);if((0,l.isSuccess)(e)){const t=e?.value[1];void 0!==t&&(R=function(e,t){const r={},n={};return Object.keys(e).forEach((a=>{const i=Number(a),o=e[i];void 0!==o&&(r[a]=o);const s=t.spans[i];void 0!==s&&(n[a]=s)})),{spanDiagnostics:r,spans:n}}(t,E))}}const O=yield{kind:a.ComputationRequestKind.GetCorrelationId};if("GetCorrelationId"!==O.kind)return null;const P=O.correlationId;return function(e){const t=function(e){let t=JSON.stringify(e),r=0;const n=[];for(;t.length>0;){const[a,i]=N(t,r,e.i);t=i,r+=1,n.push(a)}return n}(e);for(const e of t){const t=k(e);u.ulsLogger.ULS.dnmTraceTag(537962336,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,t)}}({v:b.formulaCollectionVersion,f:y,ok:T,d:R,c:{s:this.anonymizeSheetId(n.cell.sheet.index),c:n.cell.range.col,r:n.cell.range.row},i:P}),null}constructor(){this.lastEdit=void n.__runInitializers(this,y),this.lastEdit=void 0,this.consistentAnonymizer=new m.ConsistentAnonymizer,this.sheetIdAnonymization=new Map}};return n.__setFunctionName(t,"FormulaCollectionPlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[E.uiMessageHandler({kind:C.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,y),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,v),b=t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=E.injectPluginFactory(),t.factoryName=F.PluginFactoryName.FormulaCollectionPlugin,t.formulaCollectionVersion=1,n.__runInitializers(t,v),b=t})();t.FormulaCollectionPlugin=T;const R=2300;function k(e){return e.correlationId.toString()+","+e.logPartId.toString()+","+e.partialMessage}function N(e,t,r){const n=r.toString().length+t.toString().length+2,a=R-n;return[{correlationId:r,logPartId:t,partialMessage:e.slice(0,a)},e.slice(a)]}var I;t.deserializeSplitCollectedFormulaLog=function(e){let t=e,r=t.indexOf(",");const n=Number(t.slice(0,r));return t=t.slice(r+1),r=t.indexOf(","),{correlationId:n,logPartId:Number(t.slice(0,r)),partialMessage:t.slice(r+1)}},t.combineSplitCollectedFormulaLogs=function(e){const t=e.sort((e=>e.logPartId)).map((e=>e.partialMessage)).join("");return JSON.parse(t)},function(e){e.GetActiveCell="GetActiveCell failed",e.GetConfig="GetConfig failed",e.ParseEdit="ParseEdit failed",e.EmptyContent="empty content"}(I||(I={})),(0,i.registerPluginFactory)(T.factory),t.formulaCollectionPluginDependenciesResolved=(0,y.trackableAsyncLazy)((async()=>{const e=await v.workerThreadSpread.getValue();await e.createAndAttachPlugin(F.PluginFactoryName.FormulaCollectionPlugin),await v.schedulerWithRecalcServiceAttached.getValue()}),"formulaCollectionPluginDependenciesResolved")},5191:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coloredReferencesPluginDependenciesResolved=void 0;const n=r(3345),a=r(6067),i=r(6067),o=r(6067),s=r(6366),u=r(6366),l=r(6067),c=r(3228),d=r(3166),g=r(9762),m=r(3942),h=r(9050),p=r(6366),f=r(2026),S=r(6067),v=r(6067),F=r(7630),y=r(3338),b=r(9313),C=r(1339),A=r(5235),E=b.PluginRegistry.create(F.PluginFactoryName.ColoredReferencesPlugin,F.PluginGroup.Excel);let T=(()=>{let e,t,r,a=[E.x10Plugin()],i=[],o=[];return t=class{*run(e){const t=e.content,r=yield{kind:m.ComputationRequestKind.ParseActiveCell,formulaText:t};if(r.kind!==m.ComputationRequestKind.ParseActiveCell||!(0,s.isSuccess)(r.result))return null;if(r.result.value.kind!==c.EditKind.Formula)return null;const n=yield{kind:m.ComputationRequestKind.GetActiveCell};if(n.kind!==m.ComputationRequestKind.GetActiveCell)return R("failed to get active cell"),null;let a;const i=yield{kind:m.ComputationRequestKind.GetSheetNames};let o;i.kind===m.ComputationRequestKind.GetSheetNames?a=i:R("failed to get sheet names");const d=yield{kind:m.ComputationRequestKind.GetDefinedNamesInfo};d.kind===m.ComputationRequestKind.GetDefinedNamesInfo?o=d.definedNamesInfo:R("failed to get defined names");const g=n.activeCell,{formula:y}=r.result.value,b=new h.ColoredReferencesVisitor(g,y,t,a,o);(0,l.reduceBottomUp)(b,y);let C=b.formulaHighlights;if(0!==b.structRefNodes.length){const e={originGridCell:(0,u.success)(g.range),originSheet:(0,u.success)(g.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},t=yield{kind:m.ComputationRequestKind.ResolveReferences,nodes:b.structRefNodes,locals:e};t.kind===m.ComputationRequestKind.ResolveReferences?C=C.concat(function(e,t,r){const n=[];return r.forEach((r=>{const a=e.spans[r.node.label];if(!a)return void R("failed to resolve StructRef, formulaSpan null");if(!(0,s.isSuccess)(r.resolution))return void R(`failed to resolve StructRef, reason: ${r.resolution?.reason.kind}`);if(void 0===r.resolution.value)return void R("failed to resolve StructRef, resolution value undefined");const i=r.resolution.value,o=(0,v.sheetRangeToSheetIndex)(i.sheet);if(!(0,p.isDefined)(o)||!(0,S.isSheetIndexEqual)(o,t.sheet))return;const u=(0,f.gridRangeToRange)(i.range),l={kind:F.HighlightKind.StructRef,span:a,rangeInfo:{range:u}};n.push(l)})),n}(y,g,t.resolverResults)):R("failed to resolve node references")}return{formulaHighlights:C}}constructor(){n.__runInitializers(this,o)}},n.__setFunctionName(t,"ColoredReferencesPlugin"),(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[E.uiMessageHandler({kind:C.RequestKind.formulaHighlighting,modifiers:{executionType:A.ExecutionType.Sync}})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:s},null,o),n.__esDecorate(null,e={value:t},a,{kind:"class",name:t.name,metadata:s},null,i),t=e.value,s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s})})(),t.factory=E.injectPluginFactory(),n.__runInitializers(t,i),t})();function R(e){o.ulsLogger.ULS.traceTag(525133647,a.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`ColoredReferencesPlugin encountered a failure with msg ${e}`)}(0,d.registerPluginFactory)(T.factory),t.coloredReferencesPluginDependenciesResolved=(0,y.trackableAsyncLazy)((async()=>{const e=await g.dynamicPluginLoaderCreated.getValue();await e.createAndAttachPlugin(F.PluginFactoryName.ColoredReferencesPlugin),await g.schedulerWithRecalcServiceAttached.getValue()}),"coloredReferencesPluginDependenciesResolved")},9050:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColoredReferencesVisitor=void 0;const n=r(6366),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(7630),c=r(6067),d=r(6067),g=r(6067),m=r(1811),h=r(6067),p=r(2026),f=r(9293),S=r(7630);class v extends g.IdentityVisitor{structRefNode(e,t,r){const n=super.structRefNode(e,t,r);return this.structRefNodes.push(n),n}nameNode(e,t,r){const a=super.nameNode(e,t,r);if(!this.isRefInActiveSheet(t))return a;if(a.parts.kind===c.NamePartKind.FieldRefNamePart)return this.createAndAppendFieldRefHighlight(a.parts.lhs),a;if(!(0,n.isDefined)(this.namedObjectsMap))return a;const i=this.namedObjectsMap.get(e.asWhole.toLocaleLowerCase());return void 0!==i&&i.type!==S.DefinedNameInfoType.Invalid&&this.createAndAppendNamedRefHighlight(r,i),a}cellRefNode(e,t,r){const n=super.cellRefNode(e,t,r);if(!(0,m.isValidCellRef)(e)||!this.isRefInActiveSheet(t))return n;const a=this.parsedFormulaTree.spans[r];if(a){const t=this.createRangeInfoFromCellRef(e),r=this.formulaSpanToHighlightingSpan(a,d.NodeKind.CellRef);this.formulaHighlights.push(F(l.HighlightKind.CellRef,r,t))}return n}get namedObjectsMap(){return(0,n.isDefined)(this._namedObjectsMap)||(0,n.isDefined)(this.definedNameInfoList)&&(this._namedObjectsMap=(0,m.createNameToDefinedNameInfoMapping)(this.definedNameInfoList)),this._namedObjectsMap}createAndAppendNamedRefHighlight(e,t){const r=this.parsedFormulaTree.spans[e];if(!(0,n.isDefined)(r)||!(0,n.isDefined)(this.sheetNames))return;const a=t.sheetName;if(!(0,n.isDefined)(a))return void y(`createAndAppendNamedRef - sheetName undefined, DefinedNameInfo type: ${t.type}`);const i=(0,m.getSheetIndexFromSheetName)(a,this.sheetNames);if(!(0,n.isDefined)(i))return void y(`createAndAppendNamedRef: sheetIndex undefined, DefinedNameInfo type: ${t.type}`);if(!(0,h.isSheetIndexEqual)(i,this.activeCell.sheet))return;const o=(0,f.getRangeFromDefinedName)(t);void 0!==o&&this.formulaHighlights.push(F(l.HighlightKind.NamedRange,r,{range:o}))}createAndAppendFieldRefHighlight(e){switch(e.kind){case c.NamePartKind.CellRefNamePart:this.createAndAppendCellRefPartHighlight(e);break;case c.NamePartKind.IdentNamePart:{if(!(0,n.isDefined)(this.namedObjectsMap))return;const t=this.namedObjectsMap.get(e.asWhole.toLocaleLowerCase());void 0!==t&&t.type!==S.DefinedNameInfoType.Invalid&&this.createAndAppendNamedRefHighlight(e.label,t);break}case c.NamePartKind.FieldRefNamePart:this.createAndAppendFieldRefHighlight(e.lhs)}}createAndAppendCellRefPartHighlight(e){const t=this.parsedFormulaTree.spans[e.label];if(!(0,n.isDefined)(t))return;const r=this.createRangeInfoFromCellRef(e.ref),a=this.formulaSpanToHighlightingSpan(t,d.NodeKind.CellRef),i=F(l.HighlightKind.CellRef,a,r);this.formulaHighlights.push(i)}formulaSpanToHighlightingSpan(e,t){const r={...e};var n,a;return t===d.NodeKind.CellRef&&(n=e,(a=this.formulaString).length>n.end&&a.charAt(n.end)===u.operatorStrings[s.OperatorId.Pound]&&(r.end+=1)),r}createRangeInfoFromCellRef(e){return{range:(0,m.getRangeFromCellRef)(e,this.activeCell.range,y),positionKindInfo:(0,p.getPositionKindInfoFromCellRef)(e)}}isRefInActiveSheet(e){if(!(0,n.isDefined)(e))return!0;if(!(0,n.isDefined)(this.sheetNames))return!1;const t=(0,m.getSheetIndexFromQualifier)(e,this.sheetNames,this.failureCallback);return(0,n.isDefined)(t)?(0,h.isSheetIndexEqual)(t,this.activeCell.sheet):(this.failureCallback?.("CellRefHighlightCreator.isRefInActiveSheet: sheetIndex is undefined"),!1)}constructor(e,t,r,n,a,i){super(),this.activeCell=e,this.parsedFormulaTree=t,this.formulaString=r,this.sheetNames=n,this.definedNameInfoList=a,this.failureCallback=i,this.structRefNodes=[],this.formulaHighlights=[],this.activeCellSheetName=void 0,this._namedObjectsMap=void 0}}function F(e,t,r){return{kind:e,span:t,rangeInfo:r}}function y(e){o.ulsLogger.ULS.traceTag(520935561,a.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`ColoredReferencesVisitor encountered a failure with msg ${e}`)}t.ColoredReferencesVisitor=v},573:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parenthesesCouplingPluginDependenciesResolved=t.ParenthesesCouplingPlugin=void 0;const n=r(3345),a=r(6366),i=r(6366),o=r(6067),s=r(3228),u=r(3166),l=r(9762),c=r(3942),d=r(8554),g=r(7630),m=r(3338),h=r(9313),p=r(1339),f=r(5235),S=h.PluginRegistry.create(g.PluginFactoryName.ParenthesesCouplingPlugin,g.PluginGroup.Excel);let v=(()=>{let e,t,r,u=[S.x10Plugin()],l=[],m=[];return t=class{*run(e){if(null!=e.selectionLength&&e.selectionLength>0)return null;const t=yield{kind:c.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==c.ComputationRequestKind.ParseActiveCell||!(0,i.isSuccess)(t.result))return null;if(t.result.value.kind!==s.EditKind.Formula)return null;const{formula:r}=t.result.value,n=new d.ParenthesesCouplingVisitor(r,e.caretPosition);return(0,o.reduceBottomUp)(n,r),(0,a.isDefined)(n.parenthesesSpan)?this.getParenthesesHighlights(n.parenthesesSpan):{formulaHighlights:void 0}}getParenthesesHighlights(e){const t=e.start,r=e.end,n={kind:g.HighlightKind.Parentheses,span:{start:t,end:t+1}};return{formulaHighlights:[{kind:g.HighlightKind.Parentheses,span:{start:r,end:r+1}},n]}}constructor(){n.__runInitializers(this,m)}},n.__setFunctionName(t,"ParenthesesCouplingPlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[S.uiMessageHandler({kind:p.RequestKind.formulaHighlighting,modifiers:{executionType:f.ExecutionType.Sync}}),S.uiMessageHandler({kind:p.RequestKind.formulaHighlighting,modifiers:{executionType:f.ExecutionType.Async}})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,m),n.__esDecorate(null,e={value:t},u,{kind:"class",name:t.name,metadata:a},null,l),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=S.injectPluginFactory(),n.__runInitializers(t,l),t})();t.ParenthesesCouplingPlugin=v,(0,u.registerPluginFactory)(v.factory),t.parenthesesCouplingPluginDependenciesResolved=(0,m.trackableAsyncLazy)((async()=>{const e=await l.dynamicPluginLoaderCreated.getValue();await e.createAndAttachPlugin(g.PluginFactoryName.ParenthesesCouplingPlugin),await l.schedulerWithRecalcServiceAttached.getValue()}),"parenthesesCouplingPluginDependenciesResolved")},8554:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParenthesesCouplingVisitor=void 0;const n=r(6067),a=r(6067);class i extends a.IdentityVisitor{appNode(e,t,r,a){return e.kind!==n.NodeKind.Operator&&this.matchFormula(e,r,a),super.appNode(e,t,r,a)}parenNode(e,t,r){const n=this.formula.spans[r];return t&&n&&this.matchParentheses(n.start,n.end-1),super.parenNode(e,t,r)}letNode(e,t,r,n,a,i){return this.matchFormula(e,a,i),super.letNode(e,t,r,n,a,i)}lambdaNode(e,t,r,n,a,i){return this.matchFormula(e,a,i),super.lambdaNode(e,t,r,n,a,i)}matchFormula(e,t,r){const n=this.formula.spans[r],a=this.formula.spans[e.label];t&&n&&a&&this.matchParentheses(a.end,n.end-1)}matchParentheses(e,t){e===this.caretPosition&&(this.checkRight=!0),t===this.caretPosition-1&&(this.checkLeft=!0),this.checkRight&&this.shouldUpdateLocation(e,t,this.caretPosition+1)||this.shouldUpdateLocation(e,t,this.caretPosition)?(this.parenthesesSpan={start:e,end:t},this.areParenthesesLeftOfCaret=!1):this.checkLeft&&this.shouldUpdateLocation(e,t,this.caretPosition-1)&&(this.parenthesesSpan={start:e,end:t},this.areParenthesesLeftOfCaret=!0)}shouldUpdateLocation(e,t,r){return e<r&&r<=t&&(void 0===this.parenthesesSpan||this.areParenthesesLeftOfCaret&&e<=this.parenthesesSpan.start||e>this.parenthesesSpan.start)}constructor(e,t){super(),this.formula=e,this.caretPosition=t,this.parenthesesSpan=void 0,this.checkLeft=!1,this.checkRight=!1,this.areParenthesesLeftOfCaret=!1}}t.ParenthesesCouplingVisitor=i},2026:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPositionKindInfoFromCellRef=t.spanCompare=t.gridRangeToRange=void 0;const n=r(6067),a=r(7630),i={Abs:a.PositionKind.Absolute,Rel:a.PositionKind.Relative};t.gridRangeToRange=function(e){const t=e.row,r=e.col;return{firstRow:t,firstColumn:r,lastRow:t+e.rows-1,lastColumn:r+e.cols-1}},t.spanCompare=function(e,t){let r;return 0!=(r=e.start-t.start)||0!=(r=t.end-e.end)?r:0},t.getPositionKindInfoFromCellRef=function(e){switch(e.kind){case n.CellRefKind.Col:return function(e){return{firstRow:a.PositionKind.Relative,firstColumn:i[e.col1.kind],secondRow:a.PositionKind.Relative,secondColumn:i[e.col2.kind]}}(e);case n.CellRefKind.Row:return function(e){return{firstRow:i[e.row1.kind],firstColumn:a.PositionKind.Relative,secondRow:i[e.row2.kind],secondColumn:a.PositionKind.Relative}}(e);case n.CellRefKind.Single:return function(e){let t,r;return{firstRow:t=i[e.row.kind],firstColumn:r=i[e.col.kind],secondRow:t,secondColumn:r}}(e);case n.CellRefKind.Range:return function(e){return{firstRow:i[e.ref1.row.kind],firstColumn:i[e.ref1.col.kind],secondRow:i[e.ref2.row.kind],secondColumn:i[e.ref2.col.kind]}}(e)}}},609:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gotoCtrlClickPluginDependenciesResolved=void 0;const n=r(3345),a=r(6067),i=r(6067),o=r(6067),s=r(6366),u=r(6366),l=r(6366),c=r(7630),d=r(9762),g=r(9293),m=r(3942),h=r(8782),p=r(6067),f=r(3228),S=r(3338),v=r(9313),F=r(1339),y=r(3166),b=v.PluginRegistry.create(c.PluginFactoryName.GotoCtrlClickPlugin,c.PluginGroup.Excel);let C=(()=>{let e,t,r,a=[b.x10Plugin()],i=[],o=[];return t=class{*run({text:e,index:t}){const r=e;if(t<0||t>=r.length)return A("caret out of formula scope"),{kind:c.GotoCtrlClickResultKind.NoReferenceFound};const n=yield{kind:m.ComputationRequestKind.ParseActiveCell,formulaText:r};if(n.kind!==m.ComputationRequestKind.ParseActiveCell||!(0,u.isSuccess)(n.result))return A("failed to parse active cell"),{kind:c.GotoCtrlClickResultKind.Failure};if(n.result.value.kind!==f.EditKind.Formula)return A("Not a formula cell"),{kind:c.GotoCtrlClickResultKind.NotAFormula};const a=yield{kind:m.ComputationRequestKind.GetActiveCell};if(a.kind!==m.ComputationRequestKind.GetActiveCell)return A("failed to get active cell"),null;let i;const o=yield{kind:m.ComputationRequestKind.GetDefinedNamesInfo};o.kind===m.ComputationRequestKind.GetDefinedNamesInfo?i=o.definedNamesInfo:A("failed to get defined names");const d=a.activeCell,{formula:S}=n.result.value,v=new h.GotoCtrlClickVisitor(S,d.range,i,t);if((0,p.reduceBottomUp)(v,S),!v.referenceFound)return{kind:c.GotoCtrlClickResultKind.NoReferenceFound};let F=v.sheetRange;if((0,s.isDefined)(v.structRefNodeToResolve)){let e;const t=yield{kind:m.ComputationRequestKind.GetSheetNames};if(t.kind!==m.ComputationRequestKind.GetSheetNames)return A("failed to get sheet names"),{kind:c.GotoCtrlClickResultKind.RangeResolutionFailure,span:v.span};e=t;const r=yield{kind:m.ComputationRequestKind.ResolveReferences,nodes:[v.structRefNodeToResolve],locals:{originGridCell:(0,l.success)(d.range),originSheet:(0,l.success)(d.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0}};r.kind===m.ComputationRequestKind.ResolveReferences?F=(0,g.getSheetRangeFromResolvedRef)(e,r.resolverResults[0],A):A("failed to resolve node references")}return(0,s.isDefined)(F)?{kind:c.GotoCtrlClickResultKind.ReferenceFound,sheetRange:F,span:v.span}:{kind:c.GotoCtrlClickResultKind.RangeResolutionFailure,span:v.span}}constructor(){n.__runInitializers(this,o)}},n.__setFunctionName(t,"GotoCtrlClickPlugin"),(()=>{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[b.uiMessageHandler({kind:F.RequestKind.gotoCtrlClick})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:s},null,o),n.__esDecorate(null,e={value:t},a,{kind:"class",name:t.name,metadata:s},null,i),t=e.value,s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s})})(),t.factory=b.injectPluginFactory(),n.__runInitializers(t,i),t})();function A(e){o.ulsLogger.ULS.traceTag(508687389,a.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`GotoCtrlClickPlugin encountered a failure with msg ${e}`)}(0,y.registerPluginFactory)(C.factory),t.gotoCtrlClickPluginDependenciesResolved=(0,S.trackableAsyncLazy)((async()=>{const e=await d.workerThreadSpread.getValue();await e.createAndAttachPlugin(c.PluginFactoryName.GotoCtrlClickPlugin),await d.schedulerWithRecalcServiceAttached.getValue()}),"gotoCtrlClickPluginDependenciesResolved")},8782:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GotoCtrlClickVisitor=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6366),s=r(6067),u=r(6067),l=r(7630),c=r(1811),d=r(9293);class g extends u.IdentityVisitor{get namedObjectsMap(){return(0,o.isDefined)(this._namedObjectsMap)?this._namedObjectsMap:(0,o.isDefined)(this.definedNameInfoList)?(this._namedObjectsMap=(0,c.createNameToDefinedNameInfoMapping)(this.definedNameInfoList),this._namedObjectsMap):void m("namedObjectsMap: was called but definedNameInfoList is undefined")}structRefNode(e,t,r){const n=super.structRefNode(e,t,r);if(this.referenceFound)return n;const a=this.parsedFormulaTree.spans[r];return(0,c.caretInSpanScope)(this.caretPosition,a)&&(this.referenceFound=!0,this.span=a,this.structRefNodeToResolve=n),n}cellRefNode(e,t,r){const n=super.cellRefNode(e,t,r);if(this.referenceFound)return n;const a=this.parsedFormulaTree.spans[r];return(0,c.caretInSpanScope)(this.caretPosition,a)&&(this.referenceFound=!0,this.span=a,this.sheetRange=(0,d.sheetRangeFromCellRef)(e,t,this.activeCell,m)),n}nameNode(e,t,r){const n=super.nameNode(e,t,r);if(this.referenceFound)return n;const a=this.parsedFormulaTree.spans[r];if(!(0,c.caretInSpanScope)(this.caretPosition,a))return n;if(n.parts.kind===s.NamePartKind.FieldRefNamePart)this.tryFindFieldRefGotoReference(n.parts,t);else{const r=this.namedObjectsMap?.get(e.asWhole.toLocaleLowerCase());void 0!==r&&r.type!==l.DefinedNameInfoType.Invalid&&(this.referenceFound=!0,this.span=a,this.sheetRange=(0,d.getSheetRangeFromDefinedNameInfo)(r,t))}return n}tryFindFieldRefGotoReference(e,t){const r=(0,c.findFieldRefSourceLhs)(e);switch(r.kind){case s.NamePartKind.CellRefNamePart:{const e=this.parsedFormulaTree.spans[r.label];return void((0,c.caretInSpanScope)(this.caretPosition,e)&&(this.referenceFound=!0,this.span=e,this.sheetRange=(0,d.sheetRangeFromCellRef)(r.ref,void 0,this.activeCell,m)))}case s.NamePartKind.IdentNamePart:{const e=this.parsedFormulaTree.spans[r.label];if((0,o.isDefined)(this.namedObjectsMap)&&(0,c.caretInSpanScope)(this.caretPosition,e)){this.referenceFound=!0,this.span=e;const n=(0,c.getNamePartIfExists)(r,this.namedObjectsMap);if(!(0,o.isDefined)(n))return;this.sheetRange=(0,d.getSheetRangeFromDefinedNameInfo)(n,t)}return}default:m("tryFindFieldRefGotoReference: Was not able to parse a left-most NamePart")}}constructor(e,t,r,n){super(),this.parsedFormulaTree=e,this.activeCell=t,this.definedNameInfoList=r,this.caretPosition=n,this.structRefNodeToResolve=void 0,this.span=void 0,this.sheetRange=void 0,this.referenceFound=!1,this._namedObjectsMap=void 0}}function m(e){i.ulsLogger.ULS.traceTag(508687388,n.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`GotoCtrlClickVisitor encountered a failure with msg ${e}`)}t.GotoCtrlClickVisitor=g},2103:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComputationFinalizer=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(2691),s=r(9834),u=r(6366),l=r(1276),c=r(3942);t.ComputationFinalizer=class{subscribe(e){if(!this.isClosed)return this.subject.subscribe(e);l.x10Logger.log({kind:"failure",payload:{failureKind:l.X10FailureKind.AssertionFailure,failureLevel:i.TraceLevel.Warning,path:"PluginFinalizer.subscribe",description:"subscription for a closed finalizer was requested"}})}finalize(e,t){const r=this.extractComputationInfo(e);t===c.ExecutionStopReason.Unknown&&l.x10Logger.log({kind:"failure",payload:{failureKind:l.X10FailureKind.AssertionFailure,failureLevel:i.TraceLevel.Warning,path:"PluginFinalizer.finalize",description:"finalize was invoked with an unknown stop reason",data:r}}),this.isClosed?l.x10Logger.log({kind:"failure",payload:{failureKind:l.X10FailureKind.AssertionFailure,failureLevel:i.TraceLevel.Warning,path:"PluginFinalizer.finalize",description:"finalizer was invoked more than once",data:{stopReason:t,...r}}}):(this.isClosed=!0,this.finalizeComputationGeneratorExecution(e,t),this.subject.next({computationInfo:r,stopReason:t}))}finalizeComputationGeneratorExecution(e,t){switch(t){case c.ExecutionStopReason.Unknown:case c.ExecutionStopReason.Frame.Timeout:case c.ExecutionStopReason.Frame.Superseded:case c.ExecutionStopReason.Frame.ConflictResolverEarlyTermination:let r=!1;try{e.generator.throw(new s.X10ExceptionComputationTermination(t))}catch(o){r=!0,o instanceof s.X10ExceptionComputationTermination&&o.stopReason&&o?.stopReason!==t&&n.ulsLogger.ULS.traceTag(508903693,a.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,l.x10Logger.formatLogMessage("finalizeComputationGeneratorExecution",{description:"computation threw an exception during execution",data:e.info}))}finally{r||l.x10Logger.log({kind:"failure",payload:{failureKind:l.X10FailureKind.AssertionFailure,failureLevel:i.TraceLevel.Warning,path:"ComputationFinalizer.finalizeComputationGeneratorExecution",description:"computation terminated by x10 with exception but did not threw the exception back",data:e.info}})}break;case c.ExecutionStopReason.Computation.Done:case c.ExecutionStopReason.Computation.Skipped:case c.ExecutionStopReason.Computation.Exception:break;default:(0,u.assertNever)("Unknown stopReason",t)}}extractComputationInfo(e){const t=e.info;t.totalRuntime=e.info.computationTime;for(const r in e.info.requestTimes)t.totalRuntime+=e.info.requestTimes[r]?.requestDuration??0;return t}constructor(...e){this.subject=new o.Subject,this.isClosed=!1;for(const t of e)this.subscribe(t)}}},9293:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uniteIntersectingRangeObjects=t.uniteIntersectingGridRanges=t.gridRangesIntersects=t.rangesIntersects=t.getSheetGridCellFromRangeObject=t.rangeToGridRange=t.toSharedSheetRange=t.getSheetRangeFromResolvedRef=t.sheetRangeFromCellRef=t.getSheetRangeFromDefinedNameInfo=t.getRangeFromDefinedName=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(1811),s=r(6366),u=r(7630),l=r(2026),c=r(6067),d=r(6067);function g(e){const t=e.namedRange;if(null==t||e.type===u.DefinedNameInfoType.Invalid)return;const r=e.type===u.DefinedNameInfoType.Table?1:0;return t.bottom&&t.top&&t.right&&t.left?{firstRow:t.top+r-1,firstColumn:t.left-1,lastRow:t.bottom-1,lastColumn:t.right-1}:void 0}function m(e,t){return(0,a.fastMin)(e.lastColumn,t.lastColumn)>=(0,n.fastMax)(e.firstColumn,t.firstColumn)&&(0,a.fastMin)(e.lastRow,t.lastRow)>=(0,n.fastMax)(e.firstRow,t.firstRow)}function h(e,t){return(0,a.fastMin)(e.col+e.cols-1,t.col+t.cols-1)>=(0,n.fastMax)(e.col,t.col)&&(0,a.fastMin)(e.row+e.rows-1,t.row+t.rows-1)>=(0,n.fastMax)(e.row,t.row)}t.getRangeFromDefinedName=g,t.getSheetRangeFromDefinedNameInfo=function(e,t){const r=g(e);if(!(0,i.isDefined)(r))return;const n=(0,i.isDefined)(e.sheetName)?e.sheetName:t?(0,o.getSheetNameFromQualifier)(t):"";return{...r,sheetName:n,namedObjectName:(0,i.isDefined)(e.name)?e.name:""}},t.sheetRangeFromCellRef=function(e,t,r,n){const a=(0,o.getRangeFromCellRef)(e,r,n);if((0,i.isDefined)(a))return{...a,sheetName:t?(0,o.getSheetNameFromQualifier)(t):"",namedObjectName:""}},t.getSheetRangeFromResolvedRef=function(e,t,r){if(!(0,s.isSuccess)(t.resolution))return void r?.(`failed to resolve StructRef, reason: ${t.resolution.reason}`);if(void 0===t.resolution.value)return void r?.("failed to resolve StructRef, resolution value undefined");const n=t.resolution.value,a=(0,o.sheetIndexToSheetName)(n.sheet,e)??"";return{...(0,l.gridRangeToRange)(n.range),sheetName:a,namedObjectName:t.node.lhs?t.node.lhs.whole:""}},t.toSharedSheetRange=function(e){return{FirstColumn:e.firstColumn,FirstRow:e.firstRow,LastColumn:e.lastColumn,LastRow:e.lastRow,NamedObjectName:e.namedObjectName,SheetName:e.sheetName}},t.rangeToGridRange=function(e){const t=e.firstRow,r=e.firstColumn;return(0,d.gridRange)(t,r,e.lastRow-t+1,e.lastColumn-r+1)},t.getSheetGridCellFromRangeObject=function(e,t){return(0,c.sheetGridCell)(t,{row:e.firstRow,col:e.firstColumn,rows:1,cols:1})},t.rangesIntersects=m,t.gridRangesIntersects=h,t.uniteIntersectingGridRanges=function(e,t){return h(e,t)?(0,d.gridRange)((0,a.fastMin)(e.row,t.row),(0,a.fastMin)(e.col,t.col),(0,n.fastMax)(e.row+e.rows,t.row+t.rows)-(0,a.fastMin)(e.row,t.row),(0,n.fastMax)(e.col+e.cols,t.col+t.cols)-(0,a.fastMin)(e.col,t.col)):null},t.uniteIntersectingRangeObjects=function(e,t){return m(e,t)?{firstRow:(0,a.fastMin)(e.firstRow,t.firstRow),firstColumn:(0,a.fastMin)(e.firstColumn,t.firstColumn),lastRow:(0,n.fastMax)(e.lastRow,t.lastRow),lastColumn:(0,n.fastMax)(e.lastColumn,t.lastColumn)}:null}},2691:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X10TaskInternal=t.Ref=t.InitializingSubject=t.Subject=void 0;const n=r(4068),a=r(1276);class i{next(e){for(const[t,r]of this.subscribers)r(e)}subscribe(e){return this.subscribers.push([++this.currentSubscription,e]),this.currentSubscription}unsubscribe(e){this.subscribers=this.subscribers.filter((([t,r])=>t!==e))}constructor(){this.subscribers=[],this.currentSubscription=0}}t.Subject=i,t.InitializingSubject=class extends i{subscribe(e){const t=super.subscribe(e);return this.initializeSubscriber().map(e),t}constructor(e){super(),this.initializeSubscriber=e}},t.Ref=class{constructor(e){this.value=e}},t.X10TaskInternal=class{static createToken(){return"Do not use outside of x10 scheduler. Resovle by yielding with an 'AwaitTask' / 'AwaitAll' request"}resolve(e){return e!==this.token&&a.x10Logger.log({kind:"failure",payload:{failureKind:a.X10FailureKind.AssertionFailure,failureLevel:n.TraceLevel.Warning,path:"X10TaskInternal.resolve",description:"Task is resolving with an invalid token"}}),this.maybeThenable}constructor(e,t){this.maybeThenable=e,this.token=t}}},1811:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findFieldRefSourceLhs=t.caretInSpanScope=t.sheetIndexToSheetName=t.getAbsolutePosition=t.getNamePartIfExists=t.createNameToDefinedNameInfoMapping=t.getRangeFromCellRef=t.getSheetNameFromQualifier=t.getSheetIndexFromQualifier=t.getSheetIndexFromSheetName=t.isValidCellRef=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6366),u=r(7630),l=r(6067);class c{}function d(e,t){const r=t.nameToIndex.getValue(e);if((0,s.isDefined)(r))return t.sheets[r].sheetIndex}function g(e,t){return e.kind===a.QualifierKind.Sheet?e.sheet:e.kind===a.QualifierKind.Ident?e.name:((0,s.isDefined)(t)&&t(`getSheetNameFromQualifier unexpected qualifier kind: ${e.kind}`),"")}function m(e,t){return e.index+(e.kind===o.PosKind.Rel?t:0)}c.MaxRow=1048575,c.MaxColumn=16383,t.isValidCellRef=function(e){return e.kind!==i.CellRefKind.Bad&&e.kind!==i.CellRefKind.Error},t.getSheetIndexFromSheetName=d,t.getSheetIndexFromQualifier=function(e,t,r){return d(g(e,r),t)},t.getSheetNameFromQualifier=g,t.getRangeFromCellRef=function(e,t,r){switch(e.kind){case i.CellRefKind.Single:{const r=m(e.row,t.row),n=m(e.col,t.col);return{firstRow:r,firstColumn:n,lastRow:r,lastColumn:n}}case i.CellRefKind.Range:return{firstRow:m(e.ref1.row,t.row),firstColumn:m(e.ref1.col,t.col),lastRow:m(e.ref2.row,t.row),lastColumn:m(e.ref2.col,t.col)};case i.CellRefKind.Col:return{firstRow:0,firstColumn:m(e.col1,t.col),lastRow:c.MaxRow,lastColumn:m(e.col2,t.col)};case i.CellRefKind.Row:return{firstRow:m(e.row1,t.row),firstColumn:0,lastRow:m(e.row2,t.row),lastColumn:c.MaxColumn};default:(0,s.isDefined)(r)&&r(`getRangeFromCellRef unexpected CellRefKind: ${e.kind}`)}},t.createNameToDefinedNameInfoMapping=function(e){const t=new Map;return e.forEach((e=>{(0,s.isDefined)(e.name)&&t.set(e.name.toLocaleLowerCase(),e)})),t},t.getNamePartIfExists=function(e,t){const r=t.get(e.asWhole.toLocaleLowerCase());if(void 0!==r&&r.type!==u.DefinedNameInfoType.Invalid)return r},t.getAbsolutePosition=m,t.sheetIndexToSheetName=function(e,t){const r=t.sheets.findIndex((t=>(0,l.isSheetIndexEqual)(t.sheetIndex,e)));if(-1!==r)return t.sheets[r].sheetName},t.caretInSpanScope=function(e,t){return(0,s.isDefined)(t)&&e.valueOf()>=t.start&&e.valueOf()<t.end},t.findFieldRefSourceLhs=function e(t){switch(t.kind){case n.NamePartKind.CellRefNamePart:case n.NamePartKind.IdentNamePart:return t;case n.NamePartKind.FieldRefNamePart:return e(t.lhs)}}},9313:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluginRegistry=void 0;var n=r(745);Object.defineProperty(t,"PluginRegistry",{enumerable:!0,get:function(){return n.PluginRegistry}})},745:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluginRegistry=void 0;const n=r(8206),a=r(8869),i=r(6366),o=r(5235);class s{static creator(){return(e,t)=>new s(e,t)}static get create(){return s.creator()}x10Plugin(e){return(t,r)=>{const o=String(r.name),s={factoryName:this.factoryName,pluginName:o,pluginGroup:this.pluginGroup,create:r=>new t(...e?e(r):[])};(0,i.assertTrue)(`Registry object cannot be used on '${s.pluginName}' class. 'x10Plugin' decorator must be called only once on plugin class`,void 0===this.factory),this.factory=s,(0,a.deletePluginRegistration)({factoryName:this.factoryName,pluginName:o});for(const e of this.registeredUIHandlers)(0,a.registerComputation)(n.ComputationType.UIMessage,e.kind,e.executionType,this.pluginGroup,{factoryName:this.factoryName,pluginName:o,computationName:e.name,executionType:e.executionType},e.modifiers,e.computationGenerator,e.predicate);for(const e of this.registeredEventHandlers)(0,a.registerComputation)(n.ComputationType.Event,e.kind,e.executionType,this.pluginGroup,{factoryName:this.factoryName,pluginName:o,computationName:e.name,executionType:e.executionType},e.modifiers,e.computationGenerator,e.predicate)}}uiMessageHandler(e){return(t,r)=>{this.registeredUIHandlers.push({type:n.ComputationType.UIMessage,kind:e.kind,name:String(r.name),executionType:e.modifiers?.executionType??o.ExecutionType.Async,modifiers:e.modifiers??{},computationGenerator:t,predicate:e.predicate})}}eventHandler(e){return(t,r)=>{this.registeredEventHandlers.push({type:n.ComputationType.Event,kind:e.kind,name:String(r.name),executionType:e.modifiers?.executionType??o.ExecutionType.Async,modifiers:e.modifiers??{},computationGenerator:t,predicate:e.predicate})}}injectPluginFactory(){return(0,i.assertTrue)("Plugin factory not initialized. `x10Plugin` decorator must be called on plugin class",void 0!==this.factory),this.factory}constructor(e,t){this.factoryName=e,this.pluginGroup=t,this.factory=void 0,this.registeredUIHandlers=[],this.registeredEventHandlers=[]}}t.PluginRegistry=s},5138:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X10TableIntelligenceService=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6067),s=r(1276);t.X10TableIntelligenceService=class{async getRecognizedRangeTablesInfo(...e){try{const t=await this.tableIntelligenceProvider.getRecognizedRangeTablesInfo(...e);return(0,n.isDefined)(t)?(0,i.success)(t.filter(n.isDefined)):(0,a.failure)(void 0)}catch(e){return"getRecognizedRangeTablesInfo",t=`failed to get recognized range tables info: ${e}`,s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.TableIntelligenceFailure,failureLevel:o.TraceLevel.Warning,path:"X10TableIntelligenceService.getRecognizedRangeTablesInfo",description:t}}),(0,a.failure)(e)}var t}constructor(e){this.tableIntelligenceProvider=e}}},9626:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Types=t.override=t.describe=void 0;const n=r(3345),a=r(6019),i=n.__importStar(r(9111));t.describe=a.x10Test.describe,t.override=a.x10Test.override,t.Types=i},9111:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RangeInterface=t.SheetInterface=t.GridInterface=void 0;const n=r(3345).__importStar(r(1171));t.GridInterface=n.GridInterface,t.SheetInterface=n.SheetInterface,t.RangeInterface=n.RangeInterface},6019:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.x10Test=t.X10TestInfra=t.generateTestMethod=void 0;const n=r(6366),a=r(6366),i=r(3127),o=r(1206),s=r(1861),u=r(5480),l=r(1171);class c{static get instance(){return(0,a.isDefined)(this._instance)||(this._instance=new c),this._instance}constructor(){this.args=[],this.args=JSON.parse({NODE_ENV:"production"}.npm_config_argv??"{}").original??[]}}c.has=e=>c.instance.args.findIndex((t=>t===e))>=0;class d{get startTime(){return this.timer.startTime}get preciseNow(){return this.timer.preciseNow()}jolt(){return new Promise((e=>(0,n.setImmediateUnified)((()=>e()))))}async runUntilResolved(e){let t=!1;const r=Promise.resolve(e);return r.then((()=>t=!0)),await this.runMacrotasksWhile((()=>!t)),r}constructor(e){this.timer=e,this.runMacrotasksWhile=(...e)=>this.timer.runMacrotasksWhile(...e),this.runMacrotasksFor=e=>{const t=this.preciseNow;return this.runMacrotasksWhile((()=>this.preciseNow<t+e))},this.busyWait=e=>this.timer.busyWait(e)}}function g(e,t){return function(r,n,c){const g=function(e){const t=e.some((e=>(0,a.isDefined)(e.changeGates))),r=e.some((e=>(0,a.isDefined)(e.featureGates)));return{overrides:0===e.length?[{}]:e.map((e=>({changeGates:e.changeGates??void 0,featureGates:e.featureGates??void 0}))),description:String(t?"\nCG Overrides: $changeGates":"")+(r?"\nFG Overrides: $featureGates":"")+(t||r?"\n":"")}}(t);describe.each(g.overrides)(g.description,(t=>{e(r,(async(...e)=>{const r=u.GateOverrideManager.override(t);try{return await n(function(){const e=(0,i.createMockAsyncGrid)(),t=new o.MockTimerImmediate,r=(0,s.getSchedulerFactories)().createFormulaBarScheduler((0,i.createMockGridProvider)(e),void 0,t),n=new l.GridInterface(e,r);return r.registerAsyncGrid(),{scheduler:r,grid:n,timer:new d(t)}}(),...e)}finally{u.GateOverrideManager.revert(r)}}),c)}))}}t.generateTestMethod=g;const m=e=>({test:g(test,e),it:g(it,e),each:t=>g(test.each(t),e),failing:g(test.failing,e),failingOverride:t=>(...r)=>{const n=e.filter((e=>!u.GateOverrideManager.extends(e,t))),a=e.filter((e=>u.GateOverrideManager.extends(e,t)));g(test,0===n.length?[t]:n)(...r),g(test.failing,0===a.length?[t]:a)(...r)},flaky:t=>g(c.has("--flaky")?test:test.skip,e),skip:g(test.skip,e),override:t=>m(u.GateOverrideManager.mergeGateOverrideLists(e,t))});class h{call(e,t){describe(e,(()=>t(m(this.overrides))))}each(e){return(t,r,n)=>{describe.each(e)(t,((...e)=>r(m(this.overrides),...e)),n)}}static create(e){const t=new h(e);return Object.assign(((...e)=>t.call(...e)),{each:(...e)=>t.each(...e)})}constructor(e){this.overrides=e,0===e.length&&(this.overrides=[{changeGates:{},featureGates:{}}])}}t.X10TestInfra=e=>({describe:h.create(e),override:t=>({describe:h.create(u.GateOverrideManager.mergeGateOverrideLists(e,t))})}),t.x10Test=(0,t.X10TestInfra)(u.GateOverrideManager.defaultGateOverrides())},1171:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridInterface=t.SheetInterface=t.RangeInterface=void 0;const n=r(6067),a=r(115),i=r(429),o=r(222),s=r(6067),u=r(6067),l=r(472),c=r(1811);function d(e){return void 0!==e&&e.hasOwnProperty("value")}class g{set(e,t,r){e in this.map||(this.map[e]={}),this.map[e][t]=r}get(e,t){if(e in this.map&&t in this.map[e])return this.map[e][t]}constructor(){this.map={}}}class m{setRange(e){const t=e.map((e=>e.map((e=>d(e)?e.value:e)))),r=e.map((e=>e.map((e=>d(e)?e.format:void 0)))),n=e.map((e=>e.map((e=>d(e)?e.formulaBarText:void 0))));this.grid.setRange(this.sheetId,this,t,r,n)}setTable(e,t,r){const[n,o]=[!e?.hideHeadersRow,e?.hasTotalsRow??!1];this.setRange(n?[t,...r]:r);const s=[(0,i.namedObjectsWrite)(void 0,[(0,i.namedObject)(e.name,(0,i.namedTableData)((0,i.sheetRangeLocation)(this.sheetId,this.firstRow+(n?1:0),this.firstColumn,this.firstRow+r.length-(o?1:0),this.firstColumn+t.length-1),n,o,t.map(((e,t)=>(0,i.columnData)(this.firstColumn+t,e)))))])];this.grid.setNamedObjects(s),this.scheduler.doNotify(a.NotificationKind.updateNamedObjects,[0,s])}get topLeft(){return{row:this.firstRow,col:this.firstColumn,rows:1,cols:1}}get firstRow(){return this.row}get firstColumn(){return this.col}get lastRow(){return this.row+this.rows-1}get lastColumn(){return this.col+this.cols-1}get range(){return this}get sheet(){return{document:{name:"",path:void 0},index:this.sheetId,index2:this.sheetId}}get rowIndex(){return this.firstRow}get colIndex(){return this.firstColumn}get sheetIndex(){return this.sheet.index}get docPath(){return this.sheet.document.path??null}get docName(){return this.sheet.document.name}get tables(){const e=this;return this.grid.getIntersectingTables(0,this).then((async t=>(await e.grid.discardSnapshot(0),"Success"===t.kind?t.value.tables:[])))}get cellValues(){return this.cells.then((e=>e.map((e=>e.map((e=>e.value))))))}get cellFormats(){return this.cells.then((e=>e.map((e=>e.map((e=>e.format))))))}get cells(){const e=this;return e.grid.getRangeValues(0,e).then((t=>e.grid.getRangeFormats(0,e).then((async r=>e.grid.getRangeFormulae(0,e).then((async n=>{const a=p("Success"===t.kind?t.value.nonEmptyCells:[],(e=>(0,o.readOperToCellValue)(s.xlMathpack,e))),i=p("Success"===r.kind?r.value.nonEmptyCells:[],(e=>Number(e))),u=p("Success"===n.kind?n.value.nonEmptyCells:[],(e=>e)),l=[];for(let t=e.firstRow;t<=e.lastRow;t++){l.push([]);for(let r=e.firstColumn;r<=e.lastColumn;r++)l[t-e.firstRow].push({value:a.get(t,r),formulaBarText:u.get(t,r)?.formulaBarText,format:i.get(t,r)})}return await e.grid.discardSnapshot(0),l}))))))}constructor(e,t,r,n,a,i,o){this.grid=e,this.scheduler=t,this.sheetId=r,this.row=n,this.col=a,this.rows=i,this.cols=o}}t.RangeInterface=m;class h{get(e){const t=this.parseRangeIndex(e);return this.getCoordinates(t.firstRow,t.firstColumn,t.lastRow,t.lastColumn)}getCoordinates(e,t,r,n){return new m(this.grid,this.scheduler,this.id,e,t,(r??e)-e+1,(n??t)-t+1)}parseRangeIndex(e){const t={col:0,row:0,cols:1,rows:1},r=this.parser.parseFormulaExpression((0,l.parseLocals)(n.LexicalKind.Range,t),e);if("Success"!==r.kind||"CellRef"!==r.value.node.kind)throw`Could not parse range: ${e}`;const a=(0,c.getRangeFromCellRef)(r.value.node.ref,t,(e=>{throw e}));if(void 0===a)throw`Could not parse range: ${e}`;return a}constructor(e,t,r){this.grid=e,this.scheduler=t,this.id=r;const n={config:(0,u.calcConfig)((0,u.getEnglishLocaleInfo)(),void 0,s.xlMathpack)};this.parser=(0,l.createParser)(n)}}function p(e,t){const r=new g;for(const n of e){const e=n[0],a=e[0],i=e[1],o=e[2]??1,s=e[3]??1,u=n[1];for(let e=a;e<a+o;e++)for(let n=i;n<i+s;n++)r.set(e,n,t(u))}return r}t.SheetInterface=h,t.GridInterface=class{createSheet(e){const t=new h(this.grid,this.scheduler,e);return this.grid.setSheet(e,e,[[]]),this.sheets[e]=t,this.scheduler.doNotify(a.NotificationKind.updateSheetNames,[0,[{sheetId:e,sheetName:e}]]),t}constructor(e,t){this.grid=e,this.scheduler=t,this.sheets={}}}},2356:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logSafeFailure=void 0;const n=r(6366);t.logSafeFailure={failure:e=>({...(0,n.failure)(e),logSafe:!0}),isSafe:e=>!0===e.logSafe,censored:e=>!0===e.logSafe?e:(0,n.failure)(void 0)}},8441:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valuePreviewPluginDependenciesResolved=t.ValuePreviewPlugin=void 0;const n=r(3345),a=r(3942),i=r(3166),o=r(9762),s=r(6366),u=r(6366),l=r(6366),c=r(3228),d=r(6366),g=r(6366),m=r(6366),h=r(4068),p=r(5510),f=r(6067),S=r(3991),v=r(7630);var F=r(6058).types.SpecialFormat;const y=r(8338),b=r(6067),C=r(6067),A=r(6067),E=r(3338),T=r(9313),R=r(1339),k=T.PluginRegistry.create(v.PluginFactoryName.ValuePreviewPlugin,v.PluginGroup.Excel);let N=(()=>{let e,t,r,i=[k.x10Plugin()],o=[],v=[];return t=class{*run({text:e,index:t,length:r,activeCell:n}){if((0,g.isNone)(e)||(0,g.isNone)(t)||(0,g.isNone)(r))return I("missing request arguments"),null;if(t<0||t+r>e.length)return I(`invalid selection, ${e.length}, ${t}, ${r}`),null;const i=yield{kind:a.ComputationRequestKind.GetActiveCell};if(i.kind!==a.ComputationRequestKind.GetActiveCell)return{kind:"Failure",index:t,length:r,reason:"GetActiveCell failed"};let o,v=i.activeCell;if((0,g.isNone)(n)||(0,g.isNone)(n.sheetName)||function(e,t){const r=[];return e.sheet.index!==t.sheetName&&r.push("sheet"),e.range.col!==t.firstColumn&&r.push("col"),e.range.row!==t.firstRow&&r.push("row"),r.length>0&&m.ulsLogger.ULS.traceTag(507777486,h.LogCategory.msoulscat_ES_EWAJS,h.TraceLevel.Info,`ValuePreviewPlugin.areCellsEqual - active cell diff: ${r.join(",")}`),0===r.length}(v,n)){const t=yield{kind:a.ComputationRequestKind.ParseActiveCell,formulaText:e};if(t.kind!==a.ComputationRequestKind.ParseActiveCell||!(0,u.isSuccess)(t.result))return null;if(t.result.value.kind!==c.EditKind.Formula)return null;o=t.result.value.formula}else{const t=(0,A.unsafeGridRange)(n.firstRow,n.firstColumn,1,1);v=(0,b.sheetGridCell)((0,C.sheetIndex)(v.sheet.document,n.sheetName),t);const r=yield{kind:a.ComputationRequestKind.ParseCellFormula,cell:v,formula:{formulaBarText:e,kind:y.FormulaKind.CellFormula},useEnglishLocaleInfo:!1};if(r.kind!==a.ComputationRequestKind.ParseCellFormula||!(0,u.isSuccess)(r.result))return null;o=r.result.value}const E=function(e,t,r,n){let a;a=0===t?{start:1,end:r>0?r:e.length}:{start:t,end:t+r};const i=new p.ValuePreviewVisitor(n,a.start,a.end,e);let o;if((0,f.reduceBottomUp)(i,n),o=0===r?{start:0===t?t:i.subFormulaStart,end:i.subFormulaEnd}:{start:t,end:t+r},-1===o.start||o.end===o.start||i.isBadSelection||r>0&&!function(e,t){const r=0===t.start||Object.keys(e.spans).some((r=>e.spans[Number(r)]?.start===t.start)),n=Object.keys(e.spans).some((r=>e.spans[Number(r)]?.end===t.end));return r&&n}(n,o))return(0,s.failure)("invalid selection");const u=e.substring(o.start,o.end);return(0,l.success)({subFormula:u,subFormulaSpan:o,isVolatile:i.isVolatile,hasCrossWorkbookRef:i.hasCrossWorkbookRef,letDefinitions:i.letDefinitions})}(e,t,r,o);if("Success"!==E.kind)return null;let{subFormula:T}=E.value;const{subFormulaSpan:R,isVolatile:k,letDefinitions:N,hasCrossWorkbookRef:O}=E.value,P={index:R.start,length:R.end-R.start},M=yield{kind:a.ComputationRequestKind.GetConfig};if(M.kind!==a.ComputationRequestKind.GetConfig)return{kind:"Failure",...P,reason:"GetConfig failed"};(0,d.isDefined)(N)&&(T=N+M.config.localeInfo.listSeparator+T+")");const D=(T.startsWith("=")?"":"=")+T;if("="===D)return{kind:"Failure",...P,reason:"Empty formula"};if(O)return{kind:"Failure",evaluatedFormula:D,...P,reason:"Cross workbook reference"};const w=yield{kind:a.ComputationRequestKind.GetActiveCellFormat};if(w.kind!==a.ComputationRequestKind.GetActiveCellFormat)return I("GetActiveCellFormat failed"),{kind:"Unavailable",evaluatedFormula:D,...P,isVolatile:k,reason:"GetActiveCellFormat failed"};if(!(0,u.isSuccess)(w.result)||(0,g.isNone)(w.result.value))return I("Empty cell format"),{kind:"Unavailable",evaluatedFormula:D,...P,isVolatile:k,reason:"Empty cell format"};const L={kind:F.Edit,renderBlanksAsZeros:!0,isWholeFormula:D===e},_=yield{kind:a.ComputationRequestKind.EvalFormula,formula:D,origin:{sheet:v.sheet,range:{col:v.range.col,row:v.range.row,rows:1,cols:1}},format:L};if(_.kind!==a.ComputationRequestKind.EvalFormula)return{kind:"Failure",evaluatedFormula:D,...P,reason:"EvalFormula failed"};const x=new S.ValuePreviewResultExtractor(M.config).fromEvalFormulaOutput(_.result);switch(x.kind){case"Success":return{...x,evaluatedFormula:D,...P,isVolatile:k};case"Unavailable":return{kind:x.kind,evaluatedFormula:D,...P,isVolatile:k,reason:x.reason};case"Failure":return{kind:x.kind,evaluatedFormula:D,...P,reason:x.reason}}}constructor(){n.__runInitializers(this,v)}},n.__setFunctionName(t,"ValuePreviewPlugin"),(()=>{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[k.uiMessageHandler({kind:R.RequestKind.valuePreview})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:a},null,v),n.__esDecorate(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,o),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})})(),t.factory=k.injectPluginFactory(),n.__runInitializers(t,o),t})();function I(e){m.ulsLogger.ULS.traceTag(521692767,h.LogCategory.msoulscat_ES_EWAJS,h.TraceLevel.Warning,`ValuePreviewPlugin encountered a failure with msg ${e}`)}t.ValuePreviewPlugin=N,(0,i.registerPluginFactory)(N.factory),t.valuePreviewPluginDependenciesResolved=(0,E.trackableAsyncLazy)((async()=>{const e=await o.workerThreadSpread.getValue();await e.createAndAttachPlugin(v.PluginFactoryName.ValuePreviewPlugin),await o.schedulerWithRecalcServiceAttached.getValue()}),"valuePreviewPluginDependenciesResolved")},3991:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValuePreviewResultExtractor=void 0;const n=r(6366),a=r(6366),i=r(6067),o=r(6067),s=r(3228),u=r(3228),l=r(3228),c=r(8073),d=r(6366),g=r(6067),m=r(6067);t.ValuePreviewResultExtractor=class{fromEvalFormulaOutput({value:e,formatted:t}){switch(e.kind){case a.ResultKind.Success:return this.resultFromSuccess(e.value,t);case a.ResultKind.Failure:return this.resultFromFailureReason(e.reason);default:return e}}resultFromSuccess(e,t){let r;switch(e.kind){case i.OperKind.String:case i.OperKind.Array:case i.OperKind.Blank:case i.OperKind.Number:r=this.resultFromFormatted(t);break;case i.OperKind.Boolean:r=this.resultFromBoolean(e);break;case i.OperKind.Error:r=this.resultFromError(e,t);break;default:return{kind:"Failure",reason:`Unsupported operKind: ${e.kind}`}}if("Success"!==r.kind)return r;const n=this.getUnformattedValue(e,r);return{...r,unformattedValue:n,operKind:e.kind}}resultFromFormatted(e){if((0,n.isNone)(e))return{kind:"Failure",reason:"No formatted value"};switch(e.kind){case a.ResultKind.Success:if((0,s.isHashesValue)(e.value)){const r=e.value.units;return t=`Evaluate HashesValue: ${r.kind}`,d.ulsLogger.ULS.traceTag(520680450,g.LogCategory.msoulscat_ES_EWAJS,m.TraceLevel.Warning,`ValuePreviewResultExtractor encountered a failure with msg ${t}`),{kind:"Failure",reason:`HashesValue: ${r.kind}`}}return this.resultFromFormattedValue(e.value);case a.ResultKind.Failure:return this.resultFromFailureReason(e.reason);default:return e}var t}resultFromFormattedValue(e){const t=this.formatter.renderValue(e,l.renderInfiniteWidth);return t.kind===a.ResultKind.Failure?{kind:"Failure",reason:"renderValue fail"}:(0,s.isHashesValue)(t.value)?{kind:"Failure",reason:`Render HashesValue: ${t.value.units.kind}`}:{kind:"Success",value:(0,u.renderedValueToString)(t.value),color:e.color}}resultFromFailureReason(e){const t=function(e){switch(e.kind){case c.ReasonKind.Unavailable:return`Unavailable - [${e.objects.map((e=>"kind"in e?e.kind:"")).join(",")}]`;case c.ReasonKind.NotImplemented:return`NotImplemented - [${e.features.join(",")}]`;case c.ReasonKind.PreviousFailure:return"PreviousFailure";default:return`${e.kind}`}}(e);switch(e.kind){case c.ReasonKind.Unavailable:case c.ReasonKind.NotImplemented:case c.ReasonKind.PreviousFailure:return{kind:"Unavailable",reason:`FailureReason: ${t}`};default:return{kind:"Failure",reason:`Unsupported FailureReason: ${t}`}}}resultFromError(e,t){switch(e.type){case o.ErrorType.NAME:case o.ErrorType.VALUE:case o.ErrorType.FIELD:return{kind:"Unavailable",reason:`Unsupported error: ${e.type}`}}return this.resultFromFormatted(t)}getUnformattedValue(e,t){let r=t.value;return e.kind===i.OperKind.String&&(t.value=`"${t.value}"`,r=e.value),e.kind===i.OperKind.Number&&(r=this.mathpack.toNumber(e).toString()),e.kind===i.OperKind.Blank&&(r=this.mathpack.toNumber(this.mathpack.zero).toString()),r}resultFromBoolean(e){const t=e.value?this.localeInfo.trueName:this.localeInfo.falseName;return{kind:"Success",value:t,unformattedValue:t,operKind:i.OperKind.Boolean}}constructor(e){this.mathpack=e.mathpack,this.localeInfo=e.localeInfo,this.formatter=(0,s.createNumberFormatter)({config:e})}}},5510:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValuePreviewVisitor=void 0;const n=r(6366),a=r(4068),i=r(6366),o=r(6366),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(3219);class g extends c.IdentityVisitor{appNode(e,t,r,n){const a=super.appNode(e,t,r,n);return this.tryUpdateAppNodeAsSubFormula(e,a),a}literalNode(e,t,r){const n=super.literalNode(e,t,r);return this.tryUpdateNodeAsSubFormula(n),n}missingNode(e,t){const r=super.missingNode(e,t);return this.tryUpdateNodeAsSubFormula(r),r}arrayNode(e,t,r){const n=super.arrayNode(e,t,r);return this.tryUpdateNodeAsSubFormula(n),n}cellRefNode(e,t,r){const n=super.cellRefNode(e,t,r);return this.validateSelection(r,"whole"),this.tryAddCrossWorkbookRef(t,r),this.tryUpdateNodeAsSubFormula(n)&&(this.isRefNode=!0),n}fieldRefNode(e,t,r){const n=super.fieldRefNode(e,t,r);return this.validateSelection(r,"prefix"),this.tryUpdateNodeAsSubFormula(n),n}structRefNode(e,t,r){const n=super.structRefNode(e,t,r);return this.validateSelection(r,"prefix"),this.tryUpdateNodeAsSubFormula(n)&&(this.isRefNode=!0),n}nameNode(e,t,r){const n=super.nameNode(e,t,r);return this.validateSelection(r,"prefix"),this.tryUpdateNodeAsSubFormula(n)&&(this.isRefNode=!0),n}badSequenceNode(e,t,r){const n=super.badSequenceNode(e,t,r);return t.some((e=>e.label===this.nodeLabel))&&(this.updateNodeAsSubFormula(n),this.isBadSelection=!0),n}parenNode(e,t,r){const n=super.parenNode(e,t,r);return t&&this.tryUpdateNodeAsSubFormula(n),n}letNode(e,t,r,n,a,i){const o=super.letNode(e,t,r,n,a,i),s=this.parsedFormulaTree.spans[i];return this.isMatchingArg(s,!0)&&this.updateLetNodeAsSubFormula(o),o}wsfNode(e,t,r){const n=super.wsfNode(e,t,r);return this.validateSelection(r,"none"),n}operatorNode(e,t){const r=super.operatorNode(e,t);return this.validateSelection(t,"none"),r}tryUpdateNodeAsSubFormula(e){return!!this.isMinimalMatchingSpan(this.parsedFormulaTree.spans[e.label])&&(this.updateNodeAsSubFormula(e),!0)}tryUpdateAppNodeAsSubFormula(e,t){if(e.kind!==s.NodeKind.WSF&&e.kind!==s.NodeKind.Operator)return void n.ulsLogger.ULS.traceTag(509347166,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,`ValuePreviewVisitor - visitor encountered higher order function, kind: ${e.kind}`);const r=this.parsedFormulaTree.spans[e.label],i=this.parsedFormulaTree.spans[t.label];this.tryAddVolatileFunction(e,t),this.isMatchingAppNode(r,i,e.kind,t.isClosed)&&this.updateNodeAsSubFormula(t)}updateLetNodeAsSubFormula(e){const t=this.parsedFormulaTree.spans[e.head.label],r=this.parsedFormulaTree.spans[e.label];if(this.isMatchingAppNode(t,r,s.NodeKind.WSF,e.isClosed))this.updateNodeAsSubFormula(e);else for(let t=0;t<e.args.length;t++){const n=e.args[t],a=this.parsedFormulaTree.spans[n.label];if(!(0,i.isDefined)(a))return;if(this.isMatchingArg(a,!0)){if(1===t)return;const o=t%2==0,s=e.args.length-2,u=o?Math.min(s,t+1):t-2,l=this.parsedFormulaTree.spans[e.args[u].label];if(!(0,i.isDefined)(l))return;const c=this.formula.substring(r.start,l.end);this.letDefinitions=c,this.isVolatile=this.checkIntersectionWithVolatileFunction(r),this.hasCrossWorkbookRef=this.checkIntersectionWithCrossWorkbookRef(r),this.isMinimalMatchingSpan(a)&&(this.subFormulaStart=a.start,this.subFormulaEnd=a.end,this.nodeLabel=n.label)}}}updateNodeAsSubFormula(e){const t=this.parsedFormulaTree.spans[e.label];this.subFormulaStart=t.start,this.subFormulaEnd=t.end,this.nodeLabel=e.label,this.isVolatile=this.checkIntersectionWithVolatileFunction(t),this.hasCrossWorkbookRef=this.checkIntersectionWithCrossWorkbookRef(t)}isMinimalMatchingSpan(e){return-1===this.nodeLabel&&this.isMatchingArg(e)}isMatchingArg(e,t=!1){return!!(0,i.isDefined)(e)&&(this.selectionStart===this.selectionEnd?this.selectionStart>=e.start&&this.selectionEnd<e.end:t?this.selectionStart>=e.start&&this.selectionEnd<=e.end:this.selectionStart===e.start&&this.selectionEnd===e.end)}isMatchingAppNode(e,t,r,n){if(!(0,i.isDefined)(e)||!(0,i.isDefined)(t)||!n)return!1;if(this.selectionStart===this.selectionEnd)switch(r){case s.NodeKind.WSF:return this.selectionStart===e.end||this.selectionStart===t.end-1||this.selectionStart>=e.start&&this.selectionStart<e.end;case s.NodeKind.Operator:return this.selectionStart>=e.start-e.pre.length&&this.selectionStart<e.end+e.post.length}else if(e.start<=this.selectionStart&&this.selectionEnd<=e.end)return this.isBadSelection=!0,!1;return this.selectionStart===t.start&&this.selectionEnd===t.end}tryAddVolatileFunction(e,t){if(e.kind!==s.NodeKind.WSF)return;if(!t.isClosed)return;const r=this.parsedFormulaTree.spans[t.label];(0,o.isNone)(r)||(0,l.isVolatileFunc)(e.id)&&this.volatileFunctions.push({start:r.start,end:r.end})}checkIntersectionWithVolatileFunction(e){return this.volatileFunctions.some((t=>e.start<=t.start&&e.end>=t.end))}tryAddCrossWorkbookRef(e,t){if(!this.isCrossWorkbookRefDetectionEnabled)return;if(!e||e.kind!==u.QualifierKind.Sheet&&e.kind!==u.QualifierKind.SheetRange&&e.kind!==u.QualifierKind.Document)return;if((0,o.isNone)(e.document))return;const r=this.parsedFormulaTree.spans[t];(0,o.isNone)(r)||this.crossWorkbookRefs.push({start:r.start,end:r.end})}checkIntersectionWithCrossWorkbookRef(e){return!!this.isCrossWorkbookRefDetectionEnabled&&this.crossWorkbookRefs.some((t=>e.start<=t.start&&e.end>=t.end))}validateSelection(e,t){if(this.selectionStart===this.selectionEnd)return;const r=this.parsedFormulaTree.spans[e];if((0,i.isDefined)(r)&&!(this.selectionStart<r.start||this.selectionEnd>r.end))switch(t){case"prefix":return void(this.selectionStart!==r.start&&(this.isBadSelection=!0));case"suffix":return void(this.selectionEnd!==r.end&&(this.isBadSelection=!0));case"whole":return void(this.selectionStart===r.start&&this.selectionEnd===r.end||(this.isBadSelection=!0));case"none":return void(this.isBadSelection=!0)}}constructor(e,t,r,n){super(),this.parsedFormulaTree=e,this.selectionStart=t,this.selectionEnd=r,this.formula=n,this.subFormulaStart=-1,this.subFormulaEnd=-1,this.isBadSelection=!1,this.isRefNode=!1,this.isVolatile=!1,this.hasCrossWorkbookRef=!1,this.letDefinitions=void 0,this.volatileFunctions=[],this.crossWorkbookRefs=[],this.nodeLabel=-1,this.isCrossWorkbookRefDetectionEnabled=(0,d.getBooleanFeatureGate)("Microsoft.Office.Excel.ValuePreviewDisableCrossWorkbookRefs",!1)}}t.ValuePreviewVisitor=g},5330:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chatGPTPluginAttach=t.parserPerformanceMeasurementsAttach=t.autocompleteBinaryModelExperimentPluginAttach=t.autocompleteRangeSuggestionPluginAttach=t.autocompleteWrapperPluginAttach=t.autocompletePluginDependenciesResolved=void 0;const n=r(7630),a=r(9762),i=r(3338),o=(0,i.trackableAsyncLazy)((async()=>{const e=await a.workerThreadSpread.getValue();return await e.loadPluginScript("excelOnlineAutocomplete",!1),e}),"threadWithExcelOnlineAutocompleteScriptLoaded");t.autocompletePluginDependenciesResolved=(0,i.trackableAsyncLazy)((async()=>{const e=await o.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.AutocompletePlugin),await a.schedulerWithRecalcServiceAttached.getValue()}),"autocompletePluginDependenciesResolved"),t.autocompleteWrapperPluginAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await o.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.AutocompleteWrapperPlugin)}),"autocompleteWrapperPluginAttach"),t.autocompleteRangeSuggestionPluginAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await o.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.AutocompleteRangeSuggestionPlugin)}),"autocompleteRangeSuggestionPluginAttach"),t.autocompleteBinaryModelExperimentPluginAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await o.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin)}),"autocompleteBinaryModelExperimentPluginAttach"),t.parserPerformanceMeasurementsAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await o.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.ParserPerformanceMeasurements)}),"parserPerformanceMeasurementsAttach"),t.chatGPTPluginAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await o.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.ChatGPTPlugin)}),"chatGPTPluginAttach")},8647:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CacheGrid=void 0;const n=r(222),a=r(1674),i=r(5405),o=r(6468),s=r(6869),u=r(6067),l=r(5861),c=r(6366),d=r(9293),g=r(5013),m=r(6067),h=r(9207),p=r(6468),f=r(6067);function S(e){switch(e.kind){case"number":return f.xlMathpack.fromNumber(e.value);case"string":return(0,m.stringOper)(e.stringValue);case"bool":return(0,m.booleanOper)(e.boolValue);case"error":return(0,m.errorOper)(e.errorKind??m.ErrorType.UNKNOWN);case"rich":return{kind:m.OperKind.Rich,getFallback:()=>(0,m.errorOper)(m.ErrorType.FIELD),getField(){}};case"blank":return m.blankOper}}t.CacheGrid=class{get readonlyDataModel(){return this.calcGrid.dataModel.getDocs()}writeRange(e,t){const r=this.sheetRangeToSheetGridRange(t.range);if(void 0===r)return;const{hiddenRowSet:n,hiddenColSet:a}=this.populateHiddenCells(t,r,e),i=(0,s.sheetCellSet)(r.sheet,(0,g.createFromProduct)({row:n,col:a}));this.calcGrid.dataModel.writeCellContents(e,i,"",!1,(0,u.gridCell)(r.range.row,r.range.col),m.blankOper,void 0,void 0);const{visibleRows:l,visibleCols:c}=function(e,t,r){const{row:n,col:a,rows:i,cols:s}=e.range,u=(0,h.except)(o.bspFactory.row([n,n+i]),t),l=(0,h.except)(o.bspFactory.col([a,a+s]),r),c=[];(0,p.forEachRow)(u,(([e,t])=>{for(let r=e;r<t;r++)c.push(r);return!0}));const d=[];return(0,p.forEachCol)(l,(([e,t])=>{for(let r=e;r<t;r++)d.push(r);return!0})),{visibleRows:c,visibleCols:d}}(r,n,a);for(let n=0;n<t.values.length;n++){const a=t.values[n],i=l[n];for(let o=0;o<a.length;o++){const l=a[o],d=c[o],g=(0,u.gridCell)(i,d);this.calcGrid.dataModel.writeCellContents(e,(0,s.sheetCellSet)(r.sheet,(0,p.createCellSetFromRange)(g)),t.formulae[n][o].formulaText,t.formulae[n][o].isFormula,g,S(l),t.iformats[n][o],void 0)}}}get sheets(){return this.readonlyDataModel.getSingleReadonlyDocument()?.getReadonlySheets()}get nameManager(){return this.readonlyDataModel.getSingleReadonlyDocument()?.getReadonlyNameManager()}get config(){return this.readonlyDataModel.config}consumePartialWorkbookMessages(){for(;!this.calcGrid.dataModel.step().queueEmpty;);}populateHiddenCells(e,t,r){const a=e.hiddenRows.reduce(((e,{startInclusive:t,endExclusive:r})=>(0,h.union)(e,o.bspFactory.row([t,r]))),h.empty),i=e.hiddenCols.reduce(((e,{startInclusive:t,endExclusive:r})=>(0,h.union)(e,o.bspFactory.col([t,r]))),h.empty),s=(0,n.sheetGridRangeToHiddenRows)(t,a),u=(0,n.sheetGridRangeToHiddenCols)(t,i);return this.calcGrid.dataModel.writeHiddenRows(r,s),this.calcGrid.dataModel.writeHiddenCols(r,u),{hiddenRowSet:a,hiddenColSet:i}}sheetRangeToSheetGridRange(e){const t=this.calcGrid.dataModel.getDocs().getSheetIndex(this.calcGrid.document,e.sheetName);if(t.kind!==c.ResultKind.Failure&&(0,c.isDefined)(t.value))return(0,u.sheetGridRange)((0,u.sheetIndex)(this.calcGrid.document,t.value),(0,d.rangeToGridRange)(e))}constructor(){this.calcGrid=(0,l.makeCalcGrid)(),this.recalcSideGrid=new i.RecalcSideGrid(this.calcGrid),this.schedulerFeatures=[],this.setSchedulerFeatures=e=>{this.schedulerFeatures=e},this.setA1ReferenceStyle=(...e)=>{this.calcGrid.setA1ReferenceStyle(...e),this.consumePartialWorkbookMessages()},this.setLocale=(...e)=>{this.calcGrid.setLocale(...e),this.consumePartialWorkbookMessages()},this.setWorkbookProps=(...e)=>{this.calcGrid.setWorkbookProps(...e),this.consumePartialWorkbookMessages()},this.updateSheetNames=(...e)=>{this.calcGrid.updateSheetNames(...e),this.consumePartialWorkbookMessages()},this.updateNamedObjects=(...e)=>{this.calcGrid.updateNamedObjects(...e),this.consumePartialWorkbookMessages()},this.setNumberFormats=(...e)=>{this.calcGrid.setNumberFormats(...e),this.consumePartialWorkbookMessages()},this.getStateAsNotifications=()=>[],this.getDocumentLoc=(...e)=>this.readonlyDataModel.getDocumentLoc(...e),this.getSheetIndex=(...e)=>this.readonlyDataModel.getSheetIndex(...e),this.getSheetName=(...e)=>this.readonlyDataModel.getSheetName(...e),this.getNameLoc=(...e)=>this.readonlyDataModel.getNameLoc(...e),this.getUserDefinedFuncLoc=(...e)=>this.readonlyDataModel.getUserDefinedFuncLoc(...e),this.getSheetRangeIndexes=(...e)=>this.readonlyDataModel.getSheetRangeIndexes(...e),this.getContainingTable=(...e)=>this.readonlyDataModel.getContainingTable(...e),this.getStructRefSpecialRef=(...e)=>this.readonlyDataModel.getStructRefSpecialRef(...e),this.getStructRefColumn=(...e)=>this.readonlyDataModel.getStructRefColumn(...e),this.getRangeValues=(...e)=>this.recalcSideGrid.getRangeValues(...e),this.getRangeFormulae=(...e)=>this.recalcSideGrid.getRangeFormulae(...e),this.getRangeFormats=(...e)=>this.recalcSideGrid.getRangeFormats(...e),this.getSheetNames=(...e)=>this.recalcSideGrid.getSheetNames(...e),this.getIntersectingTables=(...e)=>this.recalcSideGrid.getIntersectingTables(...e),this.getIformats=(...e)=>this.recalcSideGrid.getIformats(...e),this.getHiddenRows=(...e)=>this.recalcSideGrid.getHiddenRows(...e),this.getHiddenCols=(...e)=>this.recalcSideGrid.getHiddenCols(...e),this.discardSnapshot=async(...e)=>this.recalcSideGrid.discardSnapshot(...e),this.evalClonedModelOnSnapshot=(...e)=>this.recalcSideGrid.evalClonedModelOnSnapshot(...e),this.evalFormulaOnSnapshot=(...e)=>this.recalcSideGrid.evalFormulaOnSnapshot(...e),this.getCorrespondingSnapshotID=(...e)=>this.recalcSideGrid.getCorrespondingSnapshotID(...e),this.calcGrid.dataModel.setNumberFormats(this.calcGrid.document,a.knownFormatData,!1,-1/0)}}},9749:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatGPTPlugin=void 0;const n=r(3345),a=r(7630),i=r(6366),o=r(3166),s=r(3942),u=r(9313),l=r(1339),c=u.PluginRegistry.create(a.PluginFactoryName.ChatGPTPlugin,a.PluginGroup.Excel);let d=(()=>{let e,t,r,a=[c.x10Plugin()],o=[],u=[];return t=class{*run(e){const t=e.query;if(!(0,i.isDefined)(t))return null;const r=yield{kind:s.ComputationRequestKind.CreateChatGPTSession,options:e.context};if(r.kind!==s.ComputationRequestKind.CreateChatGPTSession)throw new Error("Inconsistent yield request response type");const n=yield{kind:s.ComputationRequestKind.SendChatGPTQuery,session:r.result,request:t};if(n.kind!==s.ComputationRequestKind.SendChatGPTQuery)throw new Error("Inconsistent yield request response type");const a=yield{kind:s.ComputationRequestKind.SendChatGPTQuery,session:r.result,request:"Explain your answer"};if(a.kind!==s.ComputationRequestKind.SendChatGPTQuery)throw new Error("Inconsistent yield request response type");return{result:n.result,details:a.result}}constructor(){n.__runInitializers(this,u)}},n.__setFunctionName(t,"ChatGPTPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[c.uiMessageHandler({kind:l.RequestKind.chatGPTQuery})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,u),n.__esDecorate(null,e={value:t},a,{kind:"class",name:t.name,metadata:i},null,o),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=c.injectPluginFactory(),n.__runInitializers(t,o),t})();t.ChatGPTPlugin=d,(0,o.registerPluginFactory)(d.factory)},5043:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatGPTService=void 0;const n=r(6366),a=r(6366),i=r(6366);t.ChatGPTService=class{async createSession(e){const t=await this.provider.openChat(e);return(0,n.isDefined)(t)?(this.set.add(t),(0,i.success)(t)):(0,a.failure)(void 0)}async closeSession(e){if(!this.set.has(e))return(0,a.failure)(void 0);try{return this.provider.close(e),this.set.delete(e),(0,i.success)(void 0)}catch{return(0,a.failure)(void 0)}}async request(e,t){if(!this.set.has(e))return(0,a.failure)(void 0);try{const r=await this.provider.send(e,t);return(0,i.success)(r)}catch{return(0,a.failure)(void 0)}}constructor(e){this.provider=e,this.set=new Set}}},629:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.conflictResolver=void 0;const n=r(6366),a=r(6366),i=r(7630),o=r(7630),s=r(6366),u=r(2820),l=r(8308),c=r(4068),d=r(8869);t.conflictResolver={runTest:m,runExperiment:m,runAuthoringExperiment:m,runPerCharacterExperiment:m,argumentAssistance:h,valuePreview:h,gotoCtrlClick:h,formulaRepair:h,chatGPTQuery:h,columnFormulaSuggestion:h,setCellPrefetch:h,getTranspiledFormulas:h,inCellControlsAutodetection:h,getLocale:h,inCellSuggestion(e){for(const[{factoryName:t},r]of e)if(t===o.PluginFactoryName.AutocompleteRangeSuggestionPlugin&&(0,n.isDefined)(r))return r;return null},formulaHighlighting(e){if(e.length>0){let t=[];for(const[r,a]of e){const e=a.formulaHighlights?.filter(n.isDefined);void 0!==e&&(t=t.concat(e))}const r=(e,t)=>(0,n.isDefined)(e.span)&&(0,n.isDefined)(t.span)?(0,l.spanCompare)(e.span,t.span):(0,n.isDefined)(e)?1:(0,n.isDefined)(t)?-1:0;return t.sort(r),{formulaHighlights:t}}return null},functionSuggestion(e){let t;const r={Simple:[],Smart:[],Enum:[]};return e.forEach((([e,a])=>{a.items.filter(n.isDefined).filter((e=>(0,n.isDefined)(e.textEdit)||(0,n.isDefined)(e.label))).forEach((e=>{return r[(t=e,t.kind===i.CompletionItemKind.Enum?"Enum":t.type===i.SuggestionKind.Smart?"Smart":"Simple")].push(e);var t})),(0,n.isDefined)(a.data)&&(s.ulsLogger.ULS.assertTag(506804355,c.LogCategory.msoulscat_ES_EWAJS,!(0,n.isDefined)(t),"Multiple smart suggestions data received"),t=a.data)})),{items:r.Enum.length>0?[...r.Enum]:[...r.Smart,...r.Simple.sort((function(e,t){if((0,n.isDefined)(e.label)&&(0,n.isDefined)(t.label)){if((0,n.isDefined)(e.isPrefixed)&&(0,n.isDefined)(t.isPrefixed)&&e.isPrefixed!==t.isPrefixed)return e.isPrefixed?-1:1;if(g.includes(e.kind)&&g.includes(t.kind)){const r=(0,u.getStructRefCompletionItemRank)(e),n=(0,u.getStructRefCompletionItemRank)(t);if(r!==n)return n-r}return e.label.toLocaleLowerCase()>t.label.toLocaleLowerCase()?1:-1}return(0,n.isDefined)(e.label)?1:(0,n.isDefined)(t.label)?-1:0}))],data:t}}};const g=[i.CompletionItemKind.TableHeader,i.CompletionItemKind.TableSpecialStructRef];function m(e){const t=[];for(const[r,{results:a}]of e)(0,n.isDefined)(a)&&t.push(...a.filter(n.isDefined));return{results:t}}function h(e){if(0===e.length)return null;const[t,r]=e[0];if(1===e.length)return r;const n=d.computationRegistry.UIMessage.getRegistrationByComputationIdentifier(t)?.kind;throw new Error(`Conflict resolver: ${n}: ${e.length} results received, while only one active plugin is currently supported`)}(0,a.staticAssertExtends)()},6270:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.customConflictResolverFactories=t.FunctionSuggestionAndArgumentAssistanceConflictResolver=void 0;const n=r(701),a=r(6366),i=r(6366),o=r(6366),s=r(1339),u=r(6366),l=r(6366),c=r(3219),d=r(7630);class g{consumeResult(e){if((0,c.isChangeGateEnabled)("OfficeVSO:7640530_InCellSuggestionRequestResolverEnabledV2"))switch(e.kind){case s.RequestKind.functionSuggestion:(0,l.assertTrue)("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),this.functionSuggestionResult=e.result,this.functionSuggestionSet=!0,this.resolvePromiseIfPossible();break;case s.RequestKind.argumentAssistance:(0,l.assertTrue)("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.argumentAssistanceResult=e.result,this.argumentAssistanceSet=!0,this.resolvePromiseIfPossible();break;case s.RequestKind.inCellSuggestion:(0,l.assertTrue)("inCellSuggestionSet should be false when receiving inCellSuggestion request",!this.inCellSuggestionSet),this.inCellSuggestionResult=e.result,this.inCellSuggestionSet=!0,this.resolvePromiseIfPossible();break;default:(0,u.assertNever)(`unknown result: ${e}`,e)}else switch(e.kind){case s.RequestKind.functionSuggestion:if((0,l.assertTrue)("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),(0,a.isDefined)(e.result)&&(0,a.isDefined)(e.result.items)&&e.result.items.length>0&&e.result.items[e.result.items.length-1]?.type===d.SuggestionKind.Simple)return this.promise.resolve({functionSuggestion:e.result,argumentAssistance:null,inCellSuggestion:null});if(this.argumentAssistanceSet)return null!==this.argumentAssistanceResult?this.promise.resolve({functionSuggestion:null,argumentAssistance:this.argumentAssistanceResult,inCellSuggestion:null}):this.promise.resolve({functionSuggestion:e.result,argumentAssistance:null,inCellSuggestion:null});this.functionSuggestionResult=e.result,this.functionSuggestionSet=!0;break;case s.RequestKind.argumentAssistance:if((0,l.assertTrue)("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.functionSuggestionSet)return null!==e.result?this.promise.resolve({functionSuggestion:null,argumentAssistance:e.result,inCellSuggestion:null}):this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null,inCellSuggestion:null});this.argumentAssistanceResult=e.result,this.argumentAssistanceSet=!0;break;case s.RequestKind.inCellSuggestion:break;default:(0,u.assertNever)(`unknown result: ${e}`,e)}}static create(){return new g}resolvePromiseIfPossible(){if(this.functionSuggestionSet){if((0,a.isDefined)(this.functionSuggestionResult)&&(0,a.isDefined)(this.functionSuggestionResult.items)&&this.functionSuggestionResult.items.length>0)return this.functionSuggestionResult.items[length-1]?.type===d.SuggestionKind.Smart&&((0,l.assertTrue)("can't get argument assistance and smart suggestion at the same time",!this.argumentAssistanceSet||null==this.argumentAssistanceResult),(0,l.assertTrue)("can't get in cell suggestion and smart suggestion at the same time",!this.inCellSuggestionSet||null==this.inCellSuggestionResult?.completionItem)),this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null,inCellSuggestion:null});if(this.argumentAssistanceSet&&this.inCellSuggestionSet)return this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:this.argumentAssistanceResult,inCellSuggestion:this.inCellSuggestionResult})}}constructor(){this.argumentAssistanceResult=null,this.functionSuggestionResult=null,this.inCellSuggestionResult=null,this.argumentAssistanceSet=!1,this.functionSuggestionSet=!1,this.inCellSuggestionSet=!1,this.promise=new o.ResolvablePromise}}t.FunctionSuggestionAndArgumentAssistanceConflictResolver=g,(0,i.staticAssertExtends)(),t.customConflictResolverFactories={[n.CustomConflictResolverStrategy.FunctionSuggestionAndArgumentAssistance]:g},(0,i.staticAssertExtends)()},701:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeBatchRequester=t.customConflictResolverPluginKinds=t.CustomConflictResolverStrategy=void 0;const n=r(3942),a=r(1339),i=r(6366),o=r(6366);var s;!function(e){e.FunctionSuggestionAndArgumentAssistance="FunctionSuggestionAndArgumentAssistance"}(s||(t.CustomConflictResolverStrategy=s={})),t.customConflictResolverPluginKinds={[s.FunctionSuggestionAndArgumentAssistance]:[a.RequestKind.functionSuggestion,a.RequestKind.argumentAssistance,a.RequestKind.inCellSuggestion]},t.makeBatchRequester=function(e){return{functionSuggestionAndArgumentAssistance(t,r,a){if((0,i.isNone)(t))return Promise.resolve(null);const{functionSuggestion:o,argumentAssistance:u,inCellSuggestion:l}=t;return(0,i.isNone)(o)||(0,i.isNone)(u)||(0,i.isNone)(l)?Promise.resolve(null):e.doBatchRequest({strategy:s.FunctionSuggestionAndArgumentAssistance,functionSuggestion:o,argumentAssistance:u,inCellSuggestion:l},r,a??n.DefaultComputationGroup)}}},(0,o.staticAssertExtends)(),(0,o.staticAssertExtends)(),(0,o.staticAssertExtends)(),(0,o.staticAssertExtends)(),(0,o.staticAssertExtends)()},7732:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dynamicPluginLoaderInsideInit=t.timelineQueueProcessorFactory=t.createPrefetchingCacheFactory=t.DynamicPluginLoader=void 0;const n=r(3345).__importStar(r(4067)),a=r(4068),i=r(2897),o=r(2897),s=r(6366),u=r(6366),l=r(6366),c=r(6366),d=r(6366),g=r(6366),m=r(6366),h=r(3166),p=r(6366),f=r(6366),S=r(3423),v=r(3423),F=r(5900),y=r(4636),b=r(637),C=r(1276),A=r(6492);class E{loadPluginScriptTrace(e,t){m.ulsLogger.ULS.traceTag(553734797,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,C.x10Logger.formatLogMessage("loadPluginScript",{description:`${e} loaded, time to load ${t}`}))}async createAndAttachPlugin(e,t){const r=(0,h.getPluginFactory)(e);this.scheduler.createAndAttachPlugin(r,t)}constructor(e,t){if(!(t instanceof o.FormulaBarScheduler))throw new TypeError(`DynamicPluginLoaderBase.constructor: unknown IFormulaBarScheduler class: ${JSON.stringify(t)}`);this.scheduler=t,C.x10Logger.threadId=e}}class T extends E{async loadPluginScript(e,t){if((0,p.isNone)(e)||(0,p.isNone)(t))return;const r=v.defaultTimerInterface,n=r.now();await this.loader.loadScript(e);const a=r.now()-n;this.loadPluginScriptTrace(e,a)}isThreadingSupported(){return n.isThreadingSupported()&&void 0!==(0,s.getCalcAbsUrl)()}async createPluginThread(e){const t=`DynamicPluginLoaderThread-${T.lastThreadNum+=1}-${e}`,r=`${t}-IGrid`;await d.initCalcCalled;const o=await n.createWorker({createMode:"Thread",id:t},n.paramInsideDef({scriptUrl:(0,u.getCalcAbsUrlOrThrow)(),insideInitName:this.threadEntryPoint},{pluginResponseWindows:this.scheduler.getPluginResponseWindows()}),(()=>({...(0,y.bindMethods)(this.scheduler,[...i.parentMethodsCall,...i.parentMethodsPost]),resolveScript:this.resolveScript})));try{let e=()=>{};o.onClose=()=>{e(),m.ulsLogger.ULS.traceTag(553734798,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,C.x10Logger.formatLogMessage("DynamicPluginLoader",{description:"Thread closed"}))};const t=await(0,c.initCalcThread)(o);e=()=>t.close(),this.scheduler.doNotifyStatelessSubject.subscribe((e=>o.post.processNotification(e))),this.scheduler.requestWithCorrelationIdSubject.subscribe((e=>o.post.requestWithCorrelationId(...e))),this.scheduler.doNotifyStatefulSubject.subscribe((e=>o.post.processNotification(e)));const n={createIGridImportEndpoint:e=>o.call.createIGridImportEndpoint.transfer([e.port],e),onGridExporterClosed:o.post.onGridExporterClosed};return this.gridManager.onGridImporterCreated(n,r),new R(o)}catch(e){throw o.close(),e}}constructor(e,t,r,n){super("Main",r),this.threadEntryPoint=e,this.gridManager=t,this.loader=n;const a=n.getConfig();this.resolveScript=a.resolveScript}}t.DynamicPluginLoader=T,T.lastThreadNum=0;class R{loadPluginScript(e,t){return this.outside.call.loadPluginScript(e,t)}createAndAttachPlugin(e,t){return this.outside.call.createAndAttachPlugin(e,t)}recalcServiceAttached(){return this.outside.call.recalcServiceAttached()}close(){this.outside.close()}constructor(e){this.outside=e}}t.createPrefetchingCacheFactory=e=>(...t)=>{const r=e.getGrid();if(void 0!==r)return A.PrefetchingCache.create(r,...t)},t.timelineQueueProcessorFactory=e=>t=>new S.TimelineQueueProcessor(((e,t)=>e.kind-t.kind),t,void 0,e),t.dynamicPluginLoaderInsideInit=(e,t)=>async({config:r,connection:a},{pluginResponseWindows:s})=>n.Endpoint.createInside(a,(n=>{const u={...(0,y.bindLazyMethods)(new b.ResettableLazy((()=>n.call)),i.parentMethodsCall),...(0,y.bindLazyMethods)(new b.ResettableLazy((()=>n.post)),i.parentMethodsPost)},l=void 0,c=new F.GridProvider((()=>d.registerAsyncGrid())),d=new o.FormulaBarScheduler(e(l),t(c),s,c.getGridDataSink(),c.getSyncDataModel(),l,u);return new k(String(a.options.id),c,d,r,n)}));class k extends E{async loadPluginScript(e,t){if((0,p.isNone)(e)||(0,p.isNone)(t))return;if(!0===this.loadedScripts[e])return;const r=v.defaultTimerInterface,a=r.now();n.importScriptsWithRetry([await this.inside.call.resolveScript({identifier:e,isLocalized:t})],g.maxRetriesForLoadingScript);const i=r.now()-a;this.loadedScripts[e]=!0,this.loadPluginScriptTrace(e,i)}recalcServiceAttached(){return this.scheduler.recalcServiceAttached()}constructor(e,t,r,n,a){super(e,r),this.gridImporter=t,this.twConfig=n,this.inside=a,this.loadedScripts=(0,f.makeStringMap)(),this.initCalcThreadInside=async(e,t,r)=>{await(0,l.initCalcInThread)(e,t,r,this.twConfig)},this.createIGridImportEndpoint=this.gridImporter.createIGridImportEndpoint.bind(this.gridImporter),this.onGridExporterClosed=this.gridImporter.onGridExporterClosed.bind(this.gridImporter),this.processNotification=this.scheduler.processNotification.bind(this.scheduler),this.requestWithCorrelationId=this.scheduler.requestWithCorrelationId.bind(this.scheduler)}}},619:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.experimentQueueProcessorFactory=t.ExperimentQueueProcessor=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(3942);class s{enqueue(e,t,r){(0,n.isDefined)(r)&&e.kind===o.SchedulerTimelineQueueMessageKind.StopComputationFrame||this.queue.enqueue(e)}step(){const e=this.queue.pop();(0,n.isDefined)(e)&&this.consumeMessage(e)}get done(){return 0===this.queue.getCount()}constructor(e){this.consumeMessage=e,this.queue=new i.PriorityQueue((()=>0))}}t.ExperimentQueueProcessor=s,t.experimentQueueProcessorFactory=e=>new s(e),(0,a.staticAssertExtends)()},4636:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultMap=t.functionMapToGenericFunction1stArg=t.mapFromArrayOfDependantPairs=t.asReadonly=t.bindMethodsNullCheck=t.bindMethodsUnbox=t.bindLazyMethods=t.bindMethods=t.functionMapFromDUFunction=t.staticTypeHint=void 0;const n=r(6366),a=r(6366);t.staticTypeHint=function(e){},a.staticAssertSame,a.staticAssertSame,a.staticAssertSame,a.staticAssertSame,t.functionMapFromDUFunction=function(e,t){const r={};for(const n of t)r[n]=(...t)=>e(n,...t);return r},t.bindMethods=function(e,t){const r={};for(const n of t){const t=(...t)=>e[n](...t);r[n]=t}return r},t.bindLazyMethods=function(e,t){const r={};for(const n of t){const t=(...t)=>e.getValue()[n](...t);r[n]=t}return r},a.staticAssertSame,a.staticAssertSame,a.staticAssertSame,a.staticAssertSame;class i{unbox(e){return(...t)=>e(t)}nullcheck(e){return(...t)=>{for(const e of t)if((0,n.isNone)(e))return null;return e(...t)}}}function o(e){const t=new i,r=t[e].bind(t);return function(e,t){const n={};for(const a of t){const t=e[a].bind(e);n[a]=r(t)}return n}}t.bindMethodsUnbox=o("unbox"),t.bindMethodsNullCheck=o("nullcheck");{const e={methodF:e=>e+1,methodG:([e])=>e+1},r=(0,t.bindMethodsUnbox)(e,["methodG"]);a.staticAssertSame,(0,t.bindMethodsNullCheck)(e,["methodG"]),a.staticAssertSame,(0,t.bindMethodsNullCheck)(r,["methodG"]),a.staticAssertSame}function s(e){return e.reduce(((e,[t,r])=>(e[t]=r,e)),{})}t.asReadonly=function(e){return e},t.mapFromArrayOfDependantPairs=s,s([["a",1],["b",2]]),a.staticAssertSame,t.functionMapToGenericFunction1stArg=function(e){return(t,r,...n)=>e[t].call(e,r,...n)},t.DefaultMap=class{get(e){const t=this.operations.getKey(e),r=this.map.get(t);if(void 0!==r)return r;const n=this.operations.getDefault();return this.map.set(t,n),n}set(e,t){this.map.set(this.operations.getKey(e),t)}delete(e){this.map.delete(this.operations.getKey(e))}constructor(e){this.operations=e,this.map=new Map}}},2897:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldRunComputation=t.FormulaBarScheduler=t.parentMethodsPost=t.parentMethodsCall=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(7630),l=r(6366),c=r(6366),d=r(6366),g=r(6366),m=r(6366),h=r(6366),p=r(6366),f=r(6366),S=r(6366),v=r(6067),F=r(6067),y=r(3942),b=r(8534),C=r(3942),A=r(5021),E=r(115),T=r(6366),R=r(6366),k=r(6366),N=r(3423),I=r(6366),O=r(629),P=r(6366),M=r(6366),D=r(6366),w=r(6270),L=r(701),_=r(295),x=r(6366),K=r(5004),W=r(6634),U=r(6366),G=r(637),B=r(6366),V=r(6366),j=r(4955),H=r(1276),q=r(5043),z=r(2691),Q=r(2103),$=r(4636),Y=r(5235),J=r(8206),X=r(8869),Z=r(7485),ee=r(7485),te=r(7485),re=r(5563),ne=r(5138),ae=r(2356);class ie{create(){return this.current+=1}constructor(){this.current=0}}const oe=(0,$.mapFromArrayOfDependantPairs)((0,l.numEnumArray)(u.PluginFactoryName).map((e=>[e,u.PluginFactoryName[e]])));t.parentMethodsCall=["createChatGPTSession","closeChatGPTSession","sendChatGPTQuery","sendAugLoopSignal","registerALAnnotation","getRecognizedTablesInfo"],t.parentMethodsCall,t.parentMethodsPost=["addResult","addToComputationCount","triggerEventImmediate"],(0,c.staticAssertSame)();const se={kind:K.InternalSchedulerResponseKind.FirstStep},ue={[E.NotificationKind.setActiveCell]:!0,[E.NotificationKind.setActiveCellFormat]:!0,[E.NotificationKind.doNothing]:!0},le=(0,B.getTypedFeatureGate)("Microsoft.Office.Excel.PluginResponseWindowDebugTimeExtension");class ce{setFunctionInfo(e){if((0,d.isNone)(e))return void p.ulsLogger.ULS.traceTag(512274762,v.LogCategory.msoulscat_ES_EWAJS,F.TraceLevel.Info,H.x10Logger.formatLogMessage("setFunctionInfo",{description:"functionsInfo was none"}));const t={};for(const r of e)(0,g.isDefined)(r)&&(t[r.NameDataStrings]=r);this.state={...this.state,functionsInfoMap:t},p.ulsLogger.ULS.traceTag(512274761,v.LogCategory.msoulscat_ES_EWAJS,F.TraceLevel.Info,H.x10Logger.formatLogMessage("setFunctionInfo",{description:"set functionsInfoMap"}))}setDefinedNamesInfo(e){if((0,d.isNone)(e))return void p.ulsLogger.ULS.traceTag(512274760,v.LogCategory.msoulscat_ES_EWAJS,F.TraceLevel.Info,H.x10Logger.formatLogMessage("setDefinedNamesInfo",{description:"definedNamesInfo was none"}));const t={};for(const r of e)(0,g.isDefined)(r)&&(0,g.isDefined)(r.name)&&(t[r.name.toUpperCase()]=r);this.state={...this.state,definedNamesInfoMap:t},p.ulsLogger.ULS.traceTag(512274759,v.LogCategory.msoulscat_ES_EWAJS,F.TraceLevel.Info,H.x10Logger.formatLogMessage("setDefinedNamesInfo",{description:"set definedNamesInfoMap"}))}onWorkbookClosing(){H.x10Logger.flush()}getPluginResponseWindows(){return this.pluginResultWindows}setPluginResponseWindow(e,t,r){this.pluginResultWindows[e]={startDelta:t,stopDelta:r}}consumeMessage(e){switch(e.kind){case C.SchedulerTimelineQueueMessageKind.StepComputation:this.stepComputation(e.computation,e.payload);break;case C.SchedulerTimelineQueueMessageKind.NoOpRequest:case C.SchedulerTimelineQueueMessageKind.SyncRequest:case C.SchedulerTimelineQueueMessageKind.AsyncRequest:const t=this.timer.now();this.processRequest(e.computation,e.request,{onFulfilled:t=>{if(t.kind===k.ResultKind.Success)return this.enqueueMessage({kind:C.SchedulerTimelineQueueMessageKind.StepComputation,computation:e.computation,payload:{kind:K.InternalSchedulerResponseKind.NormalResponse,response:t.value}}),t.value;const r=ae.logSafeFailure.censored(t);return this.enqueueMessage({kind:C.SchedulerTimelineQueueMessageKind.StepComputation,computation:e.computation,payload:{kind:K.InternalSchedulerResponseKind.RequestFailure,request:e.request.kind,failure:r}}),r},onRejected:()=>{const t=(0,T.failure)(void 0);return this.enqueueMessage({kind:C.SchedulerTimelineQueueMessageKind.StepComputation,computation:e.computation,payload:{kind:K.InternalSchedulerResponseKind.RequestFailure,request:e.request.kind,failure:t}}),t}}),e.computation.info.schedulerTime+=this.timer.now()-t;break;case C.SchedulerTimelineQueueMessageKind.StopComputationFrame:this.stopComputationFrame(e.correlationId,e.computationGroup,e.type,e.computationKind,C.ExecutionStopReason.Frame.Timeout);break;case C.SchedulerTimelineQueueMessageKind.Timeout:e.callback();break;default:(0,f.assertNever)(`unknown message: ${e}`,e)}}enqueueMessage(e,t){const r=ce.abstractStepCosts[e.kind];this.processor.enqueue(e,r,t)}stepComputation(e,t){const r=this.responseStates[e.info.type][e.info.computationKind].computationFrame(e.info.computationGroup);if(e.info.correlationId===r?.correlationId)try{const r=this.timer.now(),n=de(e.generator,t);if(e.info.computationTime+=this.timer.now()-r,!0!==n.done){const t=n.value,r=this.x10RefactorWrapRequestEnabled?(0,K.createTimelineQueueMessage)(t,e):(0,K.wrapRequest)(t,e);this.enqueueMessage(r)}else this.addResultAndFinalizeComputationFrame(e,{kind:"Successful",message:n.value},C.ExecutionStopReason.Computation.Done)}catch(t){this.addResultAndFinalizeComputationFrame(e,{kind:"Exception"},C.ExecutionStopReason.Computation.Exception),H.x10Logger.log({kind:"failure",payload:{failureKind:H.X10FailureKind.PluginFailure,failureLevel:F.TraceLevel.Warning,path:"FormulaBarScheduler.stepComputation",description:`plugin threw exception: ${t} during computation`,data:e.info}})}else e.finalizer.finalize(e,e.stopReasonRef.value)}addResultAndFinalizeComputationFrame(e,t,r){return e.finalizer.finalize(e,r),this.addResult(e.info,t)}addResult(e,t,r){const n=this.responseStates[e.type][e.computationKind].computationFrame(e.computationGroup);if(this.parent||r?.forEach((e=>H.x10Logger.log(...e))),void 0===n||n.correlationId>e.correlationId)return;if(n.correlationId<e.correlationId&&H.x10Logger.log({kind:"failure",payload:{failureKind:H.X10FailureKind.AssertionFailure,failureLevel:F.TraceLevel.Warning,path:"FormulaBarScheduler.addResult",description:`main scheduler corelationID (${n.correlationId}) is less than the child one (${e.correlationId})`}}),this.parent){const n=[...r??[],...H.x10Logger.flushBufferedMessages()];this.parent.addResult(e,t,n)}switch(t.kind){case"Successful":n.successfulResults.results.push([e.computationIdentifier,t.message]);break;case"Exception":n.numFailures+=1;break;case"Skipped":n.numSkippedComputations+=1;break;default:(0,f.assertNever)("unknown result",t)}const a=this.x10GetNumOfComputationsFromFrameEnabled?function(e){switch(!0){case e.numFailures+e.numSkippedComputations+e.successfulResults.results.length!==e.numOfComputations:return;case e.numFailures===e.numOfComputations:return C.ExecutionStopReason.Computation.Exception;case e.numSkippedComputations===e.numOfComputations:return C.ExecutionStopReason.Computation.Skipped;default:return C.ExecutionStopReason.Computation.Done}}(n):function(e){return e.numFailures+e.numSkippedComputations+e.successfulResults.results.length}(n)===this.responseStates[e.type][e.computationKind].numComputations?C.ExecutionStopReason.Computation.Done:void 0;void 0!==a&&this.stopComputationFrame(n.correlationId,e.computationGroup,e.type,e.computationKind,a)}processRequest(e,t,{onFulfilled:r,onRejected:n}){const a=this.responseStates[e.info.type][e.info.computationKind],i=a.computationFrame(e.info.computationGroup);if(e.info.correlationId!==i?.correlationId)return e.finalizer.finalize(e,e.stopReasonRef.value),n(ae.logSafeFailure.failure("Computation timed out"));const o=this.timer.now(),s=(0,W.processRequest)(W.requestProcessorMap,t,e,a.computationFrame(e.info.computationGroup)?.cache,a.computationFrame(e.info.computationGroup)?.config);return(0,I.bindMaybeThenable)(s,(n=>(this.addProcessingTime(e,t.kind,o),n.kind!==k.ResultKind.Success&&H.x10Logger.log({kind:"failure",payload:{failureKind:H.X10FailureKind.RequestProcessorFailure,failureLevel:F.TraceLevel.Warning,path:"FormulaBarScheduler.processRequest",description:"request returned a scheduler-side failure",data:{...e.info,failedRequest:t.kind,failedReason:ae.logSafeFailure.censored(n)}}}),r(n))),(r=>(this.addProcessingTime(e,t.kind,o),H.x10Logger.log({kind:"failure",payload:{failureKind:H.X10FailureKind.RequestProcessorFailure,failureLevel:F.TraceLevel.Error,path:"FormulaBarScheduler.processRequest",description:"request processor threw",data:{...e.info,failedRequest:t.kind,error:(0,x.messageFromError)(r)}}}),n(r))))}addProcessingTime(e,t,r){const n=this.timer.now(),a=e.info.requestTimes[t];return a?(a.requestDuration=a.requestDuration+n-r,a.numberOfRequests+=1,a.timeSinceLastRequest=n-e.lastTimestamp):e.info.requestTimes[t]={requestDuration:n-r,numberOfRequests:1,timeSinceLastRequest:n-e.lastTimestamp},e.lastTimestamp=n,n}stopComputationFrame(e,t,r,n,a){const i=this.responseStates[r][n];e===i.computationFrame(t)?.correlationId&&i.stop(t,a,this.timer.now())}recalcServiceAttached(){return this.recalcServiceAttachedPromise.toPromise()}chatGPTProviderAttached(){return this.chatGPTProviderAttachedPromise.toPromise()}tableIntelligenceServiceAttached(){return this.tableIntelligenceServiceAttachedPromise.toPromise()}getFunctionsShortDescriptions(){return _.functionShortDescriptions.getValue()}getSchedulerFeatures(){return(0,$.asReadonly)(this.syncDataModel.schedulerFeatures)}isSchedulerFeatureEnabled(e){return-1!==this.getSchedulerFeatures().indexOf(e)}doNotify(...e){p.ulsLogger.ULS.traceTag(512274758,v.LogCategory.msoulscat_ES_EWAJS,F.TraceLevel.Info,H.x10Logger.formatLogMessage("FormulaBarScheduler.doNotify",{description:`received notification of kind:\n       ${e[0]}\n      `})),this.enqueueNotification(e),e[0]!==E.NotificationKind.setSchedulerFeatures&&e[0]!==E.NotificationKind.notifyWorkbookClosing||this.processNotifications()}enqueueNotification(e){const t=this.notificationQueue.length-1,r=this.notificationQueue[t];if(void 0===r)this.notificationQueue.push(e),p.ulsLogger.ULS.traceTag(512274757,v.LogCategory.msoulscat_ES_EWAJS,F.TraceLevel.Info,H.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:`queue empty, notification of kind:\n         ${e[0]} pushed to queue\n        `}));else{const[n]=r,[a]=e;n===a&&!0===ue[n]?(this.notificationQueue[t]=e,p.ulsLogger.ULS.traceTag(512274756,v.LogCategory.msoulscat_ES_EWAJS,F.TraceLevel.Info,H.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:`notification of kind:\n           ${e[0]} overrode previous notification\n          `}))):(this.notificationQueue.push(e),p.ulsLogger.ULS.traceTag(512274755,v.LogCategory.msoulscat_ES_EWAJS,F.TraceLevel.Info,H.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:`couldn't coalesce, notification of kind:\n           ${e[0]} pushed to queue\n          `})))}}processNotifications(){for(const e of this.notificationQueue)p.ulsLogger.ULS.traceTag(512274754,v.LogCategory.msoulscat_ES_EWAJS,F.TraceLevel.Info,H.x10Logger.formatLogMessage("FormulaBarScheduler.processNotifications",{description:`processing notification of kind:\n         ${e[0]}\n        `})),this.processNotification(e);this.notificationQueue.length=0}processNotification(e){const[t,r]=e;switch(this.notificationProcessorMap[t](...r),t){case E.NotificationKind.setA1ReferenceStyle:case E.NotificationKind.setLocale:case E.NotificationKind.setWorkbookProps:case E.NotificationKind.updateSheetNames:case E.NotificationKind.updateNamedObjects:case E.NotificationKind.setSchedulerFeatures:this.doNotifyStatefulSubject.next(e);break;default:this.doNotifyStatelessSubject.next(e)}}requestWithCorrelationId(...[e,t,r,n,a,i,o]){const s=this.timer.now(),u=this.responseStates[e][t];u.closeFrame(o,C.ExecutionStopReason.Frame.Superseded,s);const l=this.createPrefetchingCache(this.syncDataModel,a),c=this.computationResultWindows[e][t],d=u.createFrame(a,o,Y.ExecutionType.Async,n,l,this.syncDataModel.config,s,c);0===this.responseStates[e][t].numComputations?(H.x10Logger.log({kind:"requestSkipped",payload:{computationKind:t,computationGroup:o}}),d.resolve({kind:"Done",payload:{kind:t,results:[]}})):H.x10Logger.log({kind:"beginRequest",payload:{correlationId:a,computationKind:t,computationGroup:o}});const g=u.computationFrame(o);return(0,S.assertTrue)("`frame` should be always defined at this point",void 0!==g),this.computationSubjects[e][r][t].next([g,i]),c.stopDelta<1/0&&this.enqueueMessage({kind:C.SchedulerTimelineQueueMessageKind.StopComputationFrame,correlationId:a,computationGroup:o,type:e,computationKind:t},s+c.stopDelta+le),this.requestWithCorrelationIdSubject.next([e,t,r,n,a,i,o]),d}syncRequestWithCorrelationId(e,t,r,n,a,i,o){const s=this.timer.now(),u=this.responseStates[e][t];u.closeFrame(o,C.ExecutionStopReason.Frame.Superseded,s);const l=this.createPrefetchingCache(this.syncDataModel,a),c=this.computationResultWindows[e][t],d=u.createFrame(a,o,Y.ExecutionType.Sync,n,l,this.syncDataModel.config,s,c);H.x10Logger.log({kind:"beginRequest",payload:{correlationId:a,computationKind:t,computationGroup:o}});const g=u.computationFrame(o);(0,S.assertTrue)("`frame` should be always defined at this point",void 0!==g),this.computationSubjects[e][r][t].next([g,i]);const m=s+c.stopDelta+le,[h,p]=this.runToCompletion(l,this.syncDataModel.config,m);return u.closeFrame(o,h,this.timer.now()),d.resolve({kind:"Done",payload:{kind:t,results:[]}}),{kind:t,results:p}}runToCompletion(e,t,r){const n=[];let a=this.timer.now();for(let i=this.syncMessageQueue.pop();void 0!==i;i=this.syncMessageQueue.pop(),a=this.timer.now()){if(a>=r){i.computation.finalizer.finalize(i.computation,C.ExecutionStopReason.Frame.Timeout);break}let o;switch(i.kind){case C.SchedulerTimelineQueueMessageKind.StepComputation:{const{computation:e,payload:t}=i;try{const r=de(e.generator,t);if(e.info.computationTime+=this.timer.now()-a,!0!==r.done){const t=r.value,n=this.x10RefactorWrapRequestEnabled?(0,K.createSyncTimelineQueueMessage)(t,e):(0,K.wrapSyncRequest)(t,e);this.syncMessageQueue.enqueue(n)}else this.addResult(e.info,{kind:"Successful",message:r.value}),e.finalizer.finalize(e,C.ExecutionStopReason.Computation.Done),n.push([e.info.computationIdentifier,r.value])}catch{p.ulsLogger.ULS.traceTag(538581056,v.LogCategory.msoulscat_ES_EWAJS,F.TraceLevel.Warning,H.x10Logger.formatLogMessage("FormulaBarScheduler.runToCompletion",{description:"plugin threw exception during computation",data:e.info})),e.finalizer.finalize(e,C.ExecutionStopReason.Computation.Exception)}}break;case C.SchedulerTimelineQueueMessageKind.NoOpRequest:case C.SchedulerTimelineQueueMessageKind.SyncRequest:const r=(0,W.processSyncRequest)(W.requestProcessorMap,i.request,i.computation,e,t);o=this.addProcessingTime(i.computation,i.request.kind,a),i.computation.info.schedulerTime+=o-a,r.kind===k.ResultKind.Success?this.syncMessageQueue.enqueue({kind:C.SchedulerTimelineQueueMessageKind.StepComputation,computation:i.computation,payload:{kind:K.InternalSchedulerResponseKind.NormalResponse,response:r.value}}):(H.x10Logger.log({kind:"failure",payload:{failureKind:H.X10FailureKind.RequestProcessorFailure,failureLevel:F.TraceLevel.Warning,path:"FormulaBarScheduler.runToCompletion",description:"request returned a scheduler-side failure",data:{...i.computation.info,failedRequest:i.request.kind}}}),this.syncMessageQueue.enqueue({kind:C.SchedulerTimelineQueueMessageKind.StepComputation,computation:i.computation,payload:{kind:K.InternalSchedulerResponseKind.RequestFailure,request:i.request.kind,failure:ae.logSafeFailure.censored(r)}}));break;default:(0,f.assertNever)(`unknown message: ${i}`,i)}}return this.syncMessageQueue.clear(),[!(0,g.isDefined)(r)||a<r?C.ExecutionStopReason.Computation.Done:C.ExecutionStopReason.Frame.Timeout,n]}triggerEventImmediate(e,t){if(this.parent)return this.parent.triggerEventImmediate(e,t);this.triggerEvent(e,t)}triggerEvent(e,t){return this.processNotifications(),this.doRequestUntyped(J.ComputationType.Event,e,t,void 0,this.eventComputationGroupFactory.create().toString())}doRequest(e,t,r,n){return this.isEnabledProcessNotificationsAfterShouldRunPlugin&&!this.shouldRunRequest(J.ComputationType.UIMessage,e,t,r,Y.ExecutionType.Async)?this.wrapResults(J.ComputationType.UIMessage,this.skippedRequest(e,n)):(this.processNotifications(),this.doRequestUntyped(J.ComputationType.UIMessage,e,t,r,n))}skippedRequest(e,t){H.x10Logger.log({kind:"requestSkipped",payload:{computationKind:e,computationGroup:t}});const r=new P.ResolvablePromise;return r.resolve({kind:"Done",payload:{kind:e,results:[]}}),r}async wrapResults(e,t){const r=await this.resolveConflicts(e,t);return"Superseded"===r.kind?r:{...r,payload:r.payload.result}}async doRequestUntyped(e,t,r,n,a){const i=this.requestWithCorrelationId(e,t,Y.ExecutionType.Async,r,this.idFactory.create(),n,a);return this.wrapResults(e,i)}doSyncRequest(e,t,r,n){return this.isEnabledProcessNotificationsAfterShouldRunPlugin&&!this.shouldRunRequest(J.ComputationType.UIMessage,e,t,r,Y.ExecutionType.Sync)?this.wrapSyncResponse(J.ComputationType.UIMessage,this.skippedSyncRequest(e,n)):(this.processNotifications(),this.doSyncRequestUntyped(J.ComputationType.UIMessage,e,t,r,n))}skippedSyncRequest(e,t){return H.x10Logger.log({kind:"requestSkipped",payload:{computationKind:e,computationGroup:t}}),{kind:e,results:[]}}wrapSyncResponse(e,t){return this.syncResolveConflicts(e,t).result}doSyncRequestUntyped(e,t,r,n,a){let i;if(0===this.responseStates[e][t].numSyncComputations)i=this.skippedSyncRequest(t,a);else{const o=this.idFactory.create();i=this.syncRequestWithCorrelationId(e,t,Y.ExecutionType.Sync,r,o,n,a)}return this.wrapSyncResponse(e,i)}async resolveConflicts(e,t){const r=await t;return"Superseded"===r.kind?r:{kind:"Done",payload:this.syncResolveConflicts(e,r.payload)}}syncResolveConflicts(e,t){const r=t.results.filter((([,e])=>(0,g.isDefined)(e)));return{kind:t.kind,result:this.conflictResolvers[e][t.kind](r)}}async doBatchRequest(e,t,r){this.isEnabledProcessNotificationsAfterShouldRunPlugin||this.processNotifications();const n=this.idFactory.create(),a=L.customConflictResolverPluginKinds[e.strategy],i=w.customConflictResolverFactories[e.strategy].create(),o=a.map((()=>!0)),s=new P.ResolvablePromise;for(let u=0;u<a.length;u+=1){const l=a[u],c=e[l];let d;this.isEnabledProcessNotificationsAfterShouldRunPlugin&&!this.shouldRunRequest(J.ComputationType.UIMessage,l,c,t,Y.ExecutionType.Async)?d=this.skippedRequest(l,r??y.DefaultComputationGroup):(this.processNotifications(),d=this.requestWithCorrelationId(J.ComputationType.UIMessage,l,Y.ExecutionType.Async,c,n,t,r??y.DefaultComputationGroup)),this.resolveConflicts(J.ComputationType.UIMessage,d).then((e=>{if(o[u]=!1,"Superseded"===e.kind)s.resolve({kind:"Superseded"});else{const t=e.payload;i.consumeResult(t)}}),(()=>{H.x10Logger.log({kind:"failure",payload:{failureKind:H.X10FailureKind.CustomConflictResolverFailure,failureLevel:F.TraceLevel.Error,path:"FormulaBarScheduler.doBatchRequest",description:`Custom conflict resolver "${e.strategy}" got an exception for plugin kind "${l}". Skipping kind`}}),o[u]=!1,i.consumeResult({kind:l,result:null})}))}const u=(0,I.bindMaybeThenable)(i.promise,(e=>({kind:"Done",payload:e}))),l=await Promise.race([s,u]);for(let e=0;e<a.length;e+=1){const t=a[e];o[e]&&(this.doNotify(E.NotificationKind.conflictResolverEarlyTermination,[n,r??y.DefaultComputationGroup,t]),this.processNotifications())}return l}async updatePrefetchingCache(e){const t=this.createPrefetchingCache(this.syncDataModel,this.idFactory.create()),r=await(e.cache?.getCorrespondingSnapshotID()),n=await(t?.getCorrespondingSnapshotID());return n!==r?(e.cache=t,n):r}notifier(){return this.notifierObject}eventEmitter(){return this.eventEmitterObject}alAnnotationNotifier(){return this.alAnnotationNotifierObject}requester(){return this.requesterObject}syncRequester(){return this.syncRequesterObject}batchRequester(){return this.batchRequesterObject}setServerDataProvider(e){(0,d.isNone)(e)||(this.state={...this.state,serverDataProvider:e})}setActiveCellImpl(e){if((0,d.isNone)(e.docName)||(0,d.isNone)(e.sheetIndex))return void H.x10Logger.log({kind:"failure",payload:{failureKind:H.X10FailureKind.NotificationProcessorFailure,failureLevel:F.TraceLevel.Warning,path:"FormulaBarScheduler.setActiveCellImpl",description:"early exit, some of the arguments is None"}});const t=(0,n.documentLoc)(void 0,""),r=(0,s.unsafeGridRange)(e.rowIndex,e.colIndex,1,1),a=(0,i.sheetGridCell)((0,o.sheetIndex)(t,e.sheetIndex),r),u=he(e);this.state={...this.state,activeCell:a,activeCellFormat:u},p.ulsLogger.ULS.traceTag(512274752,v.LogCategory.msoulscat_ES_EWAJS,F.TraceLevel.Info,H.x10Logger.formatLogMessage("setActiveCellImpl",{description:`updated activeCell to col: ${a.range.col}, row: ${a.range.row}`}))}setActiveCellFormatImpl(e){const t=he(e);this.state={...this.state,activeCellFormat:t}}getConfig(){return this.syncDataModel.config}startComputation(e,t,r,n,a,i){switch(r){case Y.ExecutionType.Async:this.enqueueMessage({kind:C.SchedulerTimelineQueueMessageKind.StepComputation,computation:{...this.generateNewComputationInfo(e,t,n,i),generator:a},payload:se},i.startTime+i.timeWindow.startDelta);break;case Y.ExecutionType.Sync:this.syncMessageQueue.enqueue({kind:C.SchedulerTimelineQueueMessageKind.StepComputation,computation:{...this.generateNewComputationInfo(e,t,n,i),generator:a},payload:se});break;default:(0,f.assertNever)(`${r}`,r)}}generateNewComputationInfo(e,t,r,n){return{info:{correlationId:n.correlationId,computationGroup:n.computationGroup,type:e,computationKind:t,computationIdentifier:r,pluginFactoryNameString:oe[r.factoryName],computationTime:0,schedulerTime:0,requestTimes:{}},cache:n.cache,finalizer:new Q.ComputationFinalizer(...this.computationFinalizerHandlers),stopReasonRef:n.stopReasonRef,schedulerState:this.state,lastTimestamp:this.timer.now()}}getPluginComputations(e){return[...X.computationRegistry.UIMessage.getRegistrationsByPluginIdentifier(e),...X.computationRegistry.Event.getRegistrationsByPluginIdentifier(e)]}createAndAttachPlugin(e,t){this.parent&&this.warmupParse.force();const r=e.create(t);for(const t of this.getPluginComputations(e))switch(t.type){case J.ComputationType.UIMessage:this.computationSubjects[t.type][t.execution][t.kind].subscribe(t.registrationMethod(this,r)),this.addToComputationCount(t);break;case J.ComputationType.Event:(0,Z.isALAnnotationEventKind)(t.kind)&&this.registerALAnnotation(t.kind).catch((e=>{H.x10Logger.log({kind:"failure",payload:{failureKind:H.X10FailureKind.ALFailure,failureLevel:F.TraceLevel.Error,path:"FormulaBarScheduler.createAndAttachPlugin",description:`Failed to register on ${t.kind} AL annotation: ${e}`}})})),this.computationSubjects[t.type][t.execution][t.kind].subscribe(t.registrationMethod(this,r)),this.addToComputationCount(t);break;default:(0,f.assertNever)(`${t}`,t)}p.ulsLogger.ULS.traceTag(545378970,v.LogCategory.msoulscat_ES_EWAJS,F.TraceLevel.Info,`x10arch.FormulaBarScheduler.createAndAttachPlugin: ${u.PluginFactoryName[e.factoryName]} was attached.`)}addToComputationCount(e){switch(this.parent&&this.parent.addToComputationCount({type:e.type,kind:e.kind,execution:e.execution,computationIdentifier:e.computationIdentifier}),e.execution){case Y.ExecutionType.Async:this.responseStates[e.type][e.kind].attachComputation(e.computationIdentifier);break;case Y.ExecutionType.Sync:this.responseStates[e.type][e.kind].attachSyncComputation(e.computationIdentifier)}}attachEventCallbacksManager(e){for(const t of Z.ExternallyHandledEventKinds)(0,g.isDefined)(e[t])&&this.computationSubjects[J.ComputationType.Event][Y.ExecutionType.Async][t].subscribe((([r,n])=>{try{e[t](r.computationInput)}catch(e){H.x10Logger.log({kind:"failure",payload:{failureKind:H.X10FailureKind.EventCallbacksManagerFailure,failureLevel:F.TraceLevel.Error,path:"FormulaBarScheduler.attachEventCallbacksManager",description:`Failed to call eventCallbacksManager.${t}: ${e}`}})}}))}async registerEventCallback(e,t){const r=await this.eventCallbackManagerCreated.getValue();(0,g.isDefined)(this.eventCallbackManagerAttachedPromise.getCurrentValue())||(this.eventCallbackManagerAttachedPromise.resolve(r),this.attachEventCallbacksManager(r)),r.registerEventCallback(e,t)}catchEvent(e){return new Promise(((t,r)=>{const n=this.computationSubjects[J.ComputationType.Event][Y.ExecutionType.Async][e.eventKind].subscribe((([r,a])=>{(0,g.isDefined)(e.predicate)&&!e.predicate(r.computationInput)||(this.computationSubjects[J.ComputationType.Event][Y.ExecutionType.Async][e.eventKind].unsubscribe(n),t((0,R.success)(r.computationInput)))}));this.enqueueMessage({kind:C.SchedulerTimelineQueueMessageKind.Timeout,type:J.ComputationType.Event,callback:()=>{this.computationSubjects[J.ComputationType.Event][Y.ExecutionType.Async][e.eventKind].unsubscribe(n),t((0,T.failure)("Timeout"))}},this.timer.now()+e.timeout)}))}registerAsyncGrid(){this.recalcServiceAttachedPromise.resolve(void 0)}registerChatGPTProvider(e){const t=new q.ChatGPTService(e);this.chatGPTProviderAttachedPromise.resolve(t)}registerALProvider(e){const t=new re.AugLoopService(e);this.alManagerAttachedPromise.resolve(t)}async registerALAnnotation(e){if(void 0!==this.parent)return this.parent.registerALAnnotation(e);let t;try{t=await this.alManagerAttachedPromise}catch(e){return H.x10Logger.log({kind:"failure",payload:{failureKind:H.X10FailureKind.ALFailure,failureLevel:F.TraceLevel.Warning,path:"FormulaBarScheduler.registerALAnnotation",description:`Error getting AugLoopService: ${e}`}}),(0,T.failure)(e)}return t.registerALAnnotation(e)}registerTableIntelligenceProvider(e){this.tableIntelligenceServiceAttachedPromise.resolve(new ne.X10TableIntelligenceService(e))}async getRecognizedTablesInfo(...e){if((0,g.isDefined)(this.parent))return this.parent.getRecognizedTablesInfo(...e);const t=this.tableIntelligenceServiceAttachedPromise.getCurrentValue();return(0,g.isDefined)(t)?t.getRecognizedRangeTablesInfo(...e):(H.x10Logger.log({kind:"failure",payload:{failureKind:H.X10FailureKind.TableIntelligenceFailure,failureLevel:F.TraceLevel.Warning,path:"FormulaBarScheduler.getRecognizedTablesInfo",description:"tableIntelligenceService is not attached yet"}}),(0,T.failure)(void 0))}async sendAugLoopSignal(e,t){if(void 0===this.parent){let r;try{r=await this.alManagerAttachedPromise.toPromise()}catch(e){return H.x10Logger.log({kind:"failure",payload:{failureKind:H.X10FailureKind.ALFailure,failureLevel:F.TraceLevel.Warning,path:"FormulaBarScheduler.sendAugLoopSignal",description:`Error getting AugLoopService: ${e}`}}),(0,T.failure)(e)}return r.sendSignal(e,t)}return this.parent.sendAugLoopSignal(e,t)}augloopCloseCallback(){p.ulsLogger.ULS.traceTag(508629987,v.LogCategory.msoulscat_ES_EWAJS,F.TraceLevel.Info,"x10arch.FormulaBarScheduler.augloopCloseCallback: Got close callback from AugLoop Manager")}async createChatGPTSession(e){return void 0===this.parent?(await this.chatGPTProviderAttached()).createSession(e):this.parent.createChatGPTSession(e)}async closeChatGPTSession(e){return void 0===this.parent?(await this.chatGPTProviderAttached()).closeSession(e):this.parent.closeChatGPTSession(e)}async sendChatGPTQuery(e,t){if(void 0===this.parent){const r=await this.chatGPTProviderAttached(),n=await r.request(e,t);return n.kind!==k.ResultKind.Success||(0,g.isDefined)(n.value)?((0,$.staticTypeHint)(n),n):(0,T.failure)(void 0)}return this.parent.sendChatGPTQuery(e,t)}shouldRunRequest(e,t,r,n,a){const i=this.responseStates[e][t],o=a===Y.ExecutionType.Async?i.attachedComputations:i.attachedSyncComputations;for(const a of o)if(e!==J.ComputationType.UIMessage||ge(e,t,a,n,r))return!0;return!1}constructor(e,t,r={...b.defaultPluginResponseWindows},s,u,l=N.defaultTimerInterface,c){this.createPrefetchingCache=t,this.pluginResultWindows=r,this.gridDataSink=s,this.syncDataModel=u,this.timer=l,this.parent=c,this.responseStates=(0,$.mapFromArrayOfDependantPairs)((0,m.strEnumArray)(J.ComputationType).map((e=>[e,(0,$.mapFromArrayOfDependantPairs)((0,m.strEnumArray)(J.ComputationKinds[e]).map((t=>[t,new C.ResponseState(e,t)])))]))),this.uiMessages=(0,$.mapFromArrayOfDependantPairs)((0,m.strEnumArray)(J.ComputationKinds[J.ComputationType.UIMessage]).map((e=>[e,new z.Subject]))),this.syncUIMessages=(0,$.mapFromArrayOfDependantPairs)((0,m.strEnumArray)(J.ComputationKinds[J.ComputationType.UIMessage]).map((e=>[e,new z.Subject]))),this.eventHandlers=(0,$.mapFromArrayOfDependantPairs)((0,m.strEnumArray)(J.ComputationKinds[J.ComputationType.Event]).map((e=>[e,new z.Subject]))),this.conflictResolvers={[J.ComputationType.UIMessage]:O.conflictResolver,[J.ComputationType.Event]:(0,h.mapFromArrayOfPairs)((0,m.strEnumArray)(J.ComputationKinds[J.ComputationType.Event]).map((e=>[e,()=>{}])))},this.computationSubjects={[J.ComputationType.UIMessage]:{[Y.ExecutionType.Async]:this.uiMessages,[Y.ExecutionType.Sync]:this.syncUIMessages},[J.ComputationType.Event]:{[Y.ExecutionType.Async]:this.eventHandlers}},this.syncMessageQueue=new U.PriorityQueue((()=>0)),this.doNotifyStatelessSubject=new z.Subject,this.doNotifyStatefulSubject=new z.InitializingSubject((()=>this.syncDataModel.getStateAsNotifications())),this.requestWithCorrelationIdSubject=new z.Subject,this.idFactory=new ie,this.eventComputationGroupFactory=new ie,this.state={scheduler:this},this.notificationProcessorMap={[E.NotificationKind.setActiveCell]:this.setActiveCellImpl.bind(this),[E.NotificationKind.setActiveCellFormat]:this.setActiveCellFormatImpl.bind(this),[E.NotificationKind.setA1ReferenceStyle]:this.syncDataModel.setA1ReferenceStyle.bind(this.syncDataModel),[E.NotificationKind.setLocale]:this.syncDataModel.setLocale.bind(this.syncDataModel),[E.NotificationKind.setWorkbookProps]:this.syncDataModel.setWorkbookProps.bind(this.syncDataModel),[E.NotificationKind.updateSheetNames]:this.syncDataModel.updateSheetNames.bind(this.syncDataModel),[E.NotificationKind.updateNamedObjects]:this.syncDataModel.updateNamedObjects.bind(this.syncDataModel),[E.NotificationKind.doNothing]:()=>{},[E.NotificationKind.writeRange]:(...e)=>this.gridDataSink?.writeRange(...e),[E.NotificationKind.setNumberFormats]:(...e)=>this.gridDataSink?.setNumberFormats(...e),[E.NotificationKind.setFunctionsInfo]:this.setFunctionInfo.bind(this),[E.NotificationKind.conflictResolverEarlyTermination]:(e,t,r)=>this.stopComputationFrame(e,t,J.ComputationType.UIMessage,r,C.ExecutionStopReason.Frame.ConflictResolverEarlyTermination),[E.NotificationKind.setDefinedNamesInfo]:this.setDefinedNamesInfo.bind(this),[E.NotificationKind.notifyWorkbookClosing]:this.onWorkbookClosing.bind(this),[E.NotificationKind.setSchedulerFeatures]:this.syncDataModel.setSchedulerFeatures.bind(this.syncDataModel)},this.notifierObject=(0,A.makeNotifier)(this),this.eventEmitterObject=(0,te.makeEventEmitter)(this),this.alAnnotationNotifierObject=(0,ee.makeALAnnotationNotifier)(this),this.requesterObject=(0,b.makeRequester)(this),this.syncRequesterObject=(0,b.makeSyncRequester)(this),this.batchRequesterObject=(0,L.makeBatchRequester)(this),this.notificationQueue=[],this.isEnabledProcessNotificationsAfterShouldRunPlugin=(0,V.isTypedChangeGateEnabled)("OfficeVSO:8579351_x10ProcessNotificationsAfterShouldRunPlugin"),this.x10GetNumOfComputationsFromFrameEnabled=(0,V.isTypedChangeGateEnabled)("OfficeVSO:8557722_x10GetNumOfComputationsFromFrame"),this.x10RefactorWrapRequestEnabled=(0,V.isTypedChangeGateEnabled)("OfficeVSO:9282729_x10RefactorWrapRequest"),this.eventResultWindows=(0,h.mapFromArrayOfPairs)((0,m.strEnumArray)(J.ComputationKinds[J.ComputationType.Event]).map((e=>[e,{startDelta:0,stopDelta:1/0}]))),this.computationResultWindows={[J.ComputationType.UIMessage]:this.pluginResultWindows,[J.ComputationType.Event]:this.eventResultWindows},this.recalcServiceAttachedPromise=new P.ResolvablePromise,this.chatGPTProviderAttachedPromise=new P.ResolvablePromise,this.alManagerAttachedPromise=new D.ResolvablePromiseWithTimeout(3e5,this.timer),this.tableIntelligenceServiceAttachedPromise=new M.ResolvablePromiseWithSyncValue,this.eventCallbackManagerAttachedPromise=new M.ResolvablePromiseWithSyncValue,this.eventCallbackManagerCreated=(0,G.asyncLazy)(Z.makeEventCallbacksManager),this.computationFinalizerHandlers=[me],this.warmupParse=(0,G.asyncLazy)((async()=>{const e=this.createPrefetchingCache(this.syncDataModel,-1);if(e){const t=(0,n.documentLoc)(void 0,""),r=(0,i.sheetGridCell)((0,o.sheetIndex)(t,0),(0,a.gridCell)(1,1));e.parseEditSync(r,"=sum(5,7)",{formatString:"'GENERAL",builtIn:!0})}})),p.ulsLogger.ULS.traceTag(537796811,v.LogCategory.msoulscat_ES_EWAJS,F.TraceLevel.Info,H.x10Logger.formatLogMessage("excelOnlineCalcPackages",{description:`${(0,j.getExcelOnlineCalcNewPackagesNames)()}`})),this.processor=e(this.consumeMessage.bind(this)),this.alManagerAttachedPromise.toPromise().catch((()=>{}))}}function de(e,t){switch(t.kind){case K.InternalSchedulerResponseKind.FirstStep:return e.next();case K.InternalSchedulerResponseKind.NormalResponse:return e.next(t.response);case K.InternalSchedulerResponseKind.RequestFailure:return e.throw({kind:t.failure.kind,request:t.request,reason:t.failure.reason});default:(0,f.assertNever)("x10arch: FormulaBarScheduler.stepPlugin: unknown payload",t)}}function ge(e,t,r,n,a){const i=X.computationRegistry[e].getRegistrationByComputationIdentifier(r)??{type:e,kind:t,modifiers:{},pluginGroup:n};return(0,X.getShouldRunComputationPredicate)(i)(a,n)}function me(e){H.x10Logger.log({kind:"computationStoppedExecution",payload:{computationName:`${e.computationInfo.pluginFactoryNameString}.${e.computationInfo.computationIdentifier.computationName}`,stopReason:e.stopReason,logInfo:e.computationInfo}}),e.stopReason===C.ExecutionStopReason.Computation.Done&&H.x10Logger.log({kind:"pluginCompletedInTime",payload:{pluginName:e.computationInfo.pluginFactoryNameString,logInfo:e.computationInfo}})}function he(e){let t=null;return(0,d.isNone)(e.formatString)||(0,d.isNone)(e.builtIn)||(t={formatString:e.formatString,builtIn:e.builtIn}),t}t.FormulaBarScheduler=ce,ce.abstractStepCosts={[C.SchedulerTimelineQueueMessageKind.NoOpRequest]:.01,[C.SchedulerTimelineQueueMessageKind.AsyncRequest]:.1,[C.SchedulerTimelineQueueMessageKind.SyncRequest]:.5,[C.SchedulerTimelineQueueMessageKind.StepComputation]:1,[C.SchedulerTimelineQueueMessageKind.StopComputationFrame]:.01,[C.SchedulerTimelineQueueMessageKind.Timeout]:.01},t.shouldRunComputation=ge},5861:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeCalcGrid=void 0;const n=r(6366),a=r(7753),i=r(6366),o=r(6366),s=()=>{};t.makeCalcGrid=function(e=n.defaultSetTimeoutInterface){return new a.RecalcServiceImpl(s,s,s,s,(0,i.asyncLoopFactory)((0,o.asyncLoopDelayPromiseImpl)(e)))}},5900:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridImportManager=t.GridProvider=void 0;const n=r(3345).__importStar(r(4067)),a=r(6366),i=r(4068),o=r(1276),s=r(345);function u(e,t,r){const{port1:n,port2:s}=new MessageChannel;Promise.all([e.createIGridImportEndpoint({port:s,options:r}),t.createIGridExportEndpoint({port:n,options:r},(()=>e.onGridExporterClosed()))]).catch((t=>{o.x10Logger.log({kind:"failure",payload:{failureKind:o.X10FailureKind.GridFailure,failureLevel:i.TraceLevel.Warning,path:"gridProvider.connectGridImporterExporter",description:(0,a.messageFromError)(t)}});try{e.onGridExporterClosed()}catch(t){o.x10Logger.log({kind:"failure",payload:{failureKind:o.X10FailureKind.GridFailure,failureLevel:i.TraceLevel.Warning,path:"gridProvider.connectGridImporterExporter",description:`${o.X10FailureKind.GridFailure}: importer threw ${(0,a.messageFromError)(t)}`}})}}))}t.GridProvider=class{getGrid(){return this.gridService?.call}async createIGridImportEndpoint(e){this.onGridExporterClosed();const t=await n.Endpoint.createOutside(e,(e=>{this.gridService={call:void 0,close:()=>e.close("Force")}}));t.hasBeenClosed()||(this.gridService=t,this.onGridReady(this.gridService.call))}onGridExporterClosed(){if(!this.gridService)return;const e=this.gridService;this.gridService=void 0,e.close()}constructor(e){this.onGridReady=e,this.gridService=void 0,this.syncDataModel=new s.SyncDataModel,this.getGridDataSink=()=>{},this.getSyncDataModel=()=>this.syncDataModel}},t.GridImportManager=class{onGridExporterCreated(e){this.exporter=e;for(const{importer:t,id:r}of this.importers)u(t,e,{id:r,createTimeout:this.timeout})}onGridImporterCreated(e,t){this.importers.push({importer:e,id:t}),this.exporter&&u(e,this.exporter,{id:t,createTimeout:this.timeout})}constructor(e){this.timeout=e,this.exporter=void 0,this.importers=[]}}},8338:function(e,t,r){"use strict";const n=r(6058);e.exports=n.gridinterface},8308:function(e,t,r){"use strict";const n=r(6058);e.exports=n.helpers},4392:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createIEEE754Double=void 0;const r=new ArrayBuffer(8),n=new Uint32Array(r),a=new Float64Array(r),i=1===new Uint8Array(new Uint16Array([1]).buffer)[0],[o,s]=i?[0,1]:[1,0];t.createIEEE754Double=function({lowDword:e,highDword:t}){return n[o]=e,n[s]=t,a[0]}},3127:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setMockGridSheetAndNotify=t.createMockGridExporter=t.createMockGridProvider=t.createConstGridProvider=t.createMockAsyncGrid=t.MockAsyncGrid=void 0;const n=r(3345),a=r(5861),i=r(6366),o=r(429),s=r(8338),u=r(6067),l=r(6067),c=n.__importStar(r(4067)),d=r(6366),g=r(115),m=r(5405),h=r(1674),p=r(6067),f=r(345);function S(e){if("object"==typeof e)switch(e.kind){case"Blank":return"";case"Error":return(0,l.getEnglishLocaleInfo)().errorNames[e.type];case"Rich":return"rich value formulaBarText"}return e.toString()}class v extends((0,i.wrapIntoAsyncClass)()(["getRangeFormats","getRangeFormulae","getRangeValues","getSheetNames","getIformats","discardSnapshot","getHiddenRows","getHiddenCols","evalClonedModelOnSnapshot","evalFormulaOnSnapshot","getCorrespondingSnapshotID","getIntersectingTables"])){get calcConfig(){return this.calcGrid.dataModel.getDocs().config}reconfigure(e){return this.calcGrid.reconfigure(e)}setRange(e,t,r,n,a){const i=(0,u.documentLoc)(void 0,""),s=(0,u.sheetIndex)(i,e),l=[];for(let e=0;e<r.length;e+=1){const i=r[e];if(void 0!==i)for(let r=0;r<i.length;r+=1){const u=i[r];if(void 0===u)continue;const c=(0,o.sheetRangeLocation)(s.index,t.firstRow+e,t.firstColumn+r),d=a?.[e]?.[r]??S(u),g=n?.[e]?.[r]??p.KnownFormat.General;d.startsWith("=")?l.push((0,o.rangeWrite)(c,(0,o.cellFormulaCellData)(d,u,g))):l.push((0,o.rangeWrite)(c,(0,o.valueCellData)(d,u,g)))}}this.calcGrid.updateRanges(0,[(0,o.rangeWrite)((0,o.sheetRangeLocation)(s.index,t.firstRow,t.firstColumn,t.lastRow,t.lastColumn)),...l]),this.runTasks()}setSheet(e,t,r,n){const a=(0,u.documentLoc)(void 0,""),i=(0,u.sheetIndex)(a,e);(0,d.assertTrue)(`Sheet having sheetId ${e} is already in the mock workbook`,!this.sheetNames.some((({sheetId:t})=>t===e))),this.sheetNames.push((0,o.sheetName)(i.index,t)),this.calcGrid.updateSheetNames(0,this.sheetNames),this.setRange(e,{firstRow:0,firstColumn:0,lastRow:0,lastColumn:0},r,n)}setNamedObjects(e){this.calcGrid.updateNamedObjects(0,e),this.runTasks()}runTasks(){for(;!this.calcGrid.dataModel.step().queueEmpty;);}constructor(){const e=(0,a.makeCalcGrid)();e.dataModel.setNumberFormats(e.document,h.knownFormatData,!1,-1/0),super(new m.RecalcSideGrid(e)),this.sheetNames=[],this.calcGrid=e,this.document=e.document}}function F(e,t,r){return{getGrid:()=>e,getGridDataSink:()=>t,getSyncDataModel:()=>r}}t.MockAsyncGrid=v,t.createMockAsyncGrid=function(){const e=new v;return{...(0,s.wrapIntoResumeRecalc)(e,(()=>e.calcGrid.resumeRecalc())),setSheet:e.setSheet.bind(e),setRange:e.setRange.bind(e),setNamedObjects:e.setNamedObjects.bind(e),document:e.document,reconfigure:e.reconfigure.bind(e),calcConfig:e.calcConfig}},t.createConstGridProvider=F,t.createMockGridProvider=e=>F(e,void 0,new f.SyncDataModel),t.createMockGridExporter=function(e){return{async createIGridExportEndpoint(t){await c.Endpoint.createInside(t,(()=>e))}}},t.setMockGridSheetAndNotify=function(e,t,r,n,a,i=0){r.setSheet(e,t,n);const o={sheetId:e,sheetName:t};a.doNotify(g.NotificationKind.updateSheetNames,[i,[o]])}},1206:function(e,t,r){"use strict";const n=r(6058);e.exports=n.mockTimer},8226:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NaiveLocalSheetGrid=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6067),u=r(6067),l=r(8338),c=r(6468),d=r(5013),g=r(5013),m=r(9207),h=r(6067),p=r(6366);class f{static buildSparseMatrix(e,t){const r=[];for(const[[n,a,i=1,o=1],...s]of e){const e=s.length;for(let u=a,l=0;u<a+o;u+=1)for(let a=n;a<n+i;a+=1,l=(l+1)%e)void 0===r[a]&&(r[a]=[]),r[a][u]=t(s[l],a,u)}return r}static forEachInSparseMatrix(e,t,r=(()=>!1)){let n=!0;return e.forEach(((e,a)=>{n&&e.forEach(((e,i)=>{n&&!r(e)&&(t((0,s.gridCell)(a,i),e)||(n=!1))}))})),n}static unionRanges(e){return e.map(c.createCellSetFromRange).reduce(d.unionProduct,m.empty)}getCellValue(e,t){return this.isAvailable(e,t,"value")?void 0!==this.values&&void 0!==this.values[e]&&void 0!==this.values[e][t]?(0,o.success)(this.values[e][t]):(0,o.success)(l.emptyRangeValue):(0,i.failure)((0,u.unavailable)(["getCellValue"]))}getCellFormat(e,t){return this.isAvailable(e,t,"format")?void 0!==this.formats&&void 0!==this.formats[e]&&void 0!==this.formats[e][t]?(0,o.success)(this.formats[e][t]):(0,o.success)(l.emptyRangeFormat):(0,i.failure)((0,u.unavailable)(["getCellFormat"]))}getCellFormula(e,t){return this.isAvailable(e,t,"formula")?void 0!==this.formulae&&void 0!==this.formulae[e]&&void 0!==this.formulae[e][t]?(0,o.success)(this.formulae[e][t]):(0,o.success)(l.emptyRangeFormula):(0,i.failure)((0,u.unavailable)(["getCellFormula"]))}foreachNonBlankCellValue(e){return void 0===this.values||f.forEachInSparseMatrix(this.values,e,(e=>e.kind===h.OperKind.Blank))}foreachNonBlankCellFormula(e){return void 0===this.formulae||f.forEachInSparseMatrix(this.formulae,e,(e=>e.kind===l.emptyRangeFormula.kind&&e.formulaBarText===l.emptyRangeFormula.formulaBarText))}isAvailable(e,t,r){let n;switch(r){case"value":n=this.valueAvailabilitySet;break;case"formula":n=this.formulaAvailabilitySet;break;case"format":n=this.formatAvailabilitySet;break;default:(0,p.assertNever)("isAvailable",r)}return void 0!==n&&((0,g.compareProduct)((0,c.createCellSetFromRange)((0,s.gridCell)(e,t)),n)??1)<=0}constructor(e,t,r,n){this.formats=void 0,this.values=void 0,this.formulae=void 0,this.valueAvailabilitySet=void 0,this.formatAvailabilitySet=void 0,this.formulaAvailabilitySet=void 0,(0,a.isSuccess)(t)&&(this.values=f.buildSparseMatrix(t.value.nonEmptyCells,(e=>e)),this.valueAvailabilitySet=f.unionRanges(t.value.availableRanges)),(0,a.isSuccess)(n)&&(this.formats=f.buildSparseMatrix(n.value.nonEmptyCells,(e=>e)),this.formatAvailabilitySet=f.unionRanges(n.value.availableRanges)),(0,a.isSuccess)(r)&&(this.formulae=f.buildSparseMatrix(r.value.nonEmptyCells,(e=>e)),this.formulaAvailabilitySet=f.unionRanges(r.value.availableRanges))}}t.NaiveLocalSheetGrid=f,(0,n.staticAssertExtends)()},115:function(e,t,r){"use strict";const n=r(6058);e.exports=n.notificationKinds},5021:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeNotifier=void 0;const n=r(6366),a=r(6366),i=r(115),o=r(4636),s=r(4636),u=r(4880);(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)();const l=[i.NotificationKind.conflictResolverEarlyTermination],c=(0,n.strEnumArray)(i.NotificationKind).filter((function(e){return l.findIndex((t=>t===e))<0}));t.makeNotifier=function(e){const t=e.doNotify.bind(e),r=(0,s.functionMapFromDUFunction)(t,c),n=(0,s.bindMethodsUnbox)(r,c),a={...(0,s.bindMethodsNullCheck)(n,c),[i.NotificationKind.notifyWorkbookClosing]:()=>n.notifyWorkbookClosing()};return l=a,d=u.notificationMethodArgumentsConvertorsMap,(0,o.mapFromArrayOfDependantPairs)(c.map((e=>[e,(...t)=>l[e](...d[e](...t))])));var l,d}},4880:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notificationMethodArgumentsConvertorsMap=void 0;const n=r(115),a=r(6067),i=r(6067),o=r(6366),s=r(6067),u=r(6366),l=r(4392),c=(...e)=>e,d=e=>{if("NamedValue"===e?.kind)switch(e.value.kind){case"Number":return{...e,value:e.value.numberValue};case"String":return{...e,value:e.value.stringValue};case"Boolean":return{...e,value:e.value.booleanValue};case"Error":return{...e,value:e.value}}return e},g=[[s.ErrorType.NULL,e=>0===e],[s.ErrorType.DIV0,e=>7===e],[s.ErrorType.VALUE,e=>15===e||53===e],[s.ErrorType.REF,e=>23===e],[s.ErrorType.NAME,e=>29===e],[s.ErrorType.NUM,e=>36===e],[s.ErrorType.NA,e=>42===e],[s.ErrorType.GETTING_DATA,e=>43===e],[s.ErrorType.SPILL,e=>45===e],[s.ErrorType.CONNECT,e=>46===e],[s.ErrorType.BLOCKED,e=>47===e],[s.ErrorType.UNKNOWN,e=>48===e],[s.ErrorType.FIELD,e=>49===e],[s.ErrorType.CALC,e=>50===e],[s.ErrorType.BUSY,e=>51===e||52===e||54===e],[s.ErrorType.EXTERNAL,()=>!1]];function m(e){switch(e.kind){case"error":for(const[t,r]of g)if(r(e.errorValue))return{kind:"error",errorKind:t};return{kind:"error",errorKind:void 0};case"number":return{kind:"number",value:(0,l.createIEEE754Double)(e)};default:return e}}(0,u.staticAssertSame)(),t.notificationMethodArgumentsConvertorsMap={[n.NotificationKind.doNothing]:c,[n.NotificationKind.setActiveCell]:c,[n.NotificationKind.setActiveCellFormat]:c,[n.NotificationKind.setFunctionsInfo]:c,[n.NotificationKind.setDefinedNamesInfo]:c,[n.NotificationKind.notifyWorkbookClosing]:c,[n.NotificationKind.setSchedulerFeatures]:c,[n.NotificationKind.setA1ReferenceStyle]:c,[n.NotificationKind.setWorkbookProps]:c,[n.NotificationKind.updateSheetNames]:c,[n.NotificationKind.writeRange]:(e,t)=>[e,{...t,values:t.values.map((e=>e.map(m)))}],[n.NotificationKind.setLocale]:(...e)=>{const[t]=e;return[{...t,specialRefNames:(0,o.partialArray)({[a.SpecialRefId.All]:t.specialRefNames.All,[a.SpecialRefId.Data]:t.specialRefNames.Data,[a.SpecialRefId.Headers]:t.specialRefNames.Headers,[a.SpecialRefId.ThisRow]:t.specialRefNames.ThisRow,[a.SpecialRefId.Totals]:t.specialRefNames.Totals}),currencyFormat:i.CurrencyFormat[t.currencyFormat],dateOrder:i.DateOrder[t.dateOrder],timeAltSeparator:t.timeAltSeparator,ampmSymbols:[t.ampmSymbols.first,t.ampmSymbols.second]}]},[n.NotificationKind.updateNamedObjects]:(...e)=>{const[t,r]=e;return[t,r.map((e=>({...e,scope:e.scope,objects:e.objects?.map((e=>({...e,data:d(e.data??void 0)}))),fromStateId:e.fromStateId})))]},[n.NotificationKind.setNumberFormats]:c}},7346:function(e,t){"use strict";if(Object.defineProperty(t,"__esModule",{value:!0}),t.platform=void 0,t.platform=globalThis.__x10_target_platform??"Web",["Web","Win32"].indexOf(t.platform)<0)throw new Error(`Wrong platform id ${t.platform}`);globalThis.__x10_target_platform=t.platform},3166:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerPluginFactory=t.getPluginFactory=void 0;const n=r(7630),a=r(6067),i=r(6366),o=r(6366),s=r(1276),u=(0,i.makeStringMap)();t.getPluginFactory=function(e){const t=u[e];if(!t){const t=s.x10Logger.formatLogMessage("getPluginFactory",{description:`${n.PluginFactoryName[e]} has not been registered`});throw s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.PluginAttachmentFailure,failureLevel:a.TraceLevel.Error,path:"pluginFactory.getPluginFactory",description:`${n.PluginFactoryName[e]} has not been registered`}}),new Error(t)}return t},t.registerPluginFactory=function(e){const t=e.factoryName,r=u[t];if(void 0!==r&&r!==e){const e=s.x10Logger.formatLogMessage("registerPluginFactory",{description:`${n.PluginFactoryName[t]} is already registered`});if(s.x10Logger.log({kind:"failure",payload:{failureKind:s.X10FailureKind.PluginAttachmentFailure,failureLevel:a.TraceLevel.Error,path:"pluginFactory.registerPluginFactory",description:`${n.PluginFactoryName[t]} is already registered`}}),!(0,o.getTypedFeatureGate)("Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration"))throw new Error(e)}u[t]=e,s.x10Logger.log({kind:"registerPluginFactory",payload:{factoryName:t}})}},2559:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureGroupAttachedLegacy=t.ensureGroupAttached=t.ensurePluginAttached=t.setX10Features=t.ensurePluginAttachedLegacy=t.resolveScriptLoaderPromise=void 0;const n=r(6366),a=r(6366),i=r(2529),o=r(5330),s=r(9762),u=r(6607),l=r(5965),c=r(573),d=r(5191),g=r(609),m=r(4444),h=r(7230),p=r(9217),f=r(8200),S=r(1761),v=r(8441),F=r(8373),y=r(6067),b=r(6366),C=r(1276),A=r(1861),E=r(115),T=r(7630),R=r(6792),k=r(7346),N=r(8298),I={Web:{[T.PluginFactoryName.ArgumentAssistancePlugin]:[i.argumentAssistancePluginDependenciesResolved,void 0,void 0,"ArgumentAssistance"],[T.PluginFactoryName.AutocompletePlugin]:[o.autocompletePluginDependenciesResolved,void 0,void 0,"SmartSuggestionsAutoComplete"],[T.PluginFactoryName.AutocompleteFunctionPlugin]:[u.autocompleteFunctionPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[T.PluginFactoryName.ParenthesesCouplingPlugin]:[c.parenthesesCouplingPluginDependenciesResolved,void 0,void 0,"ParenthesisCoupling"],[T.PluginFactoryName.ColoredReferencesPlugin]:[d.coloredReferencesPluginDependenciesResolved,void 0,void 0,"ColoredReferences"],[T.PluginFactoryName.GotoCtrlClickPlugin]:[g.gotoCtrlClickPluginDependenciesResolved,void 0,void 0,"GotoCtrlClick"],[T.PluginFactoryName.AutocompleteLetPlugin]:[m.autocompleteLetPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[T.PluginFactoryName.AutocompleteRichValuePlugin]:[h.autocompleteRichValuePluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[T.PluginFactoryName.FormulaCollectionPlugin]:[p.formulaCollectionPluginDependenciesResolved,"Microsoft.Office.Excel.FormulaCollection"],[T.PluginFactoryName.AutocompleteNamedObjectsPlugin]:[f.autocompleteNamedObjectsPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[T.PluginFactoryName.ParserPerformanceMeasurements]:[o.parserPerformanceMeasurementsAttach,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements"],[T.PluginFactoryName.AutocompleteTableHeadersPlugin]:[S.autocompleteTableHeadersPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[T.PluginFactoryName.ValuePreviewPlugin]:[v.valuePreviewPluginDependenciesResolved,void 0,void 0,"ValuePreview"],[T.PluginFactoryName.SyntaxErrorsPlugin]:[R.syntaxErrorsPluginDependenciesResolved,void 0,void 0,"SyntaxErrors"],[T.PluginFactoryName.AutocompleteRangeSuggestionPlugin]:[o.autocompleteRangeSuggestionPluginAttach,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin"],[T.PluginFactoryName.AutocompleteWrapperPlugin]:[o.autocompleteWrapperPluginAttach,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled"],[T.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin]:[o.autocompleteBinaryModelExperimentPluginAttach,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin"],[T.PluginFactoryName.FormulaRepairShadowEvalPlugin]:[R.formulaRepairShadowEvalPluginDependenciesResolved,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled"],[T.PluginFactoryName.PythonAutocompletePlugin]:[F.pythonAutocompletePluginAttach,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled"],[T.PluginFactoryName.ChatGPTPlugin]:[o.chatGPTPluginAttach,"Microsoft.Office.Excel.ChatGPTPluginEnabled"],[T.PluginFactoryName.FormulaByExamplePlugin]:[R.formulaByExamplePluginAttach,"Microsoft.Office.Excel.FormulaByExamplePluginSuggestionShowing"],[T.PluginFactoryName.TestPlugin]:[s.workerThreadInitialized,"Microsoft.Office.Excel.MockWorkerThreadPlugin"],[T.PluginFactoryName.AutocompleteEnumPlugin]:[l.autocompleteEnumPluginDependenciesResolved,void 0,void 0,"EnumAutoComplete"],[T.PluginFactoryName.SetCellPrefetchPlugin]:[R.setCellPreftechPluginAttach,"Microsoft.Office.Excel.SetCellPrefetchPluginEnabled"],[T.PluginFactoryName.FormulaTranspilerPlugin]:[R.formulaTranspilerPluginAttach,"Microsoft.Office.Excel.FileOptimization"],[T.PluginFactoryName.InCellControlsAutodetectionPlugin]:[R.inCellControlsAutodetectionPluginAttach,"Microsoft.Office.Excel.InCellControlsAutodetection"]},Win32:{[T.PluginFactoryName.FormulaByExamplePlugin]:[N.win32FormulaByExamplePluginAttached,"Microsoft.Office.Excel.DesktopX10FBEEnabled"],[T.PluginFactoryName.GetLocalePlugin]:[N.win32CleanDataPluginAttached,"Microsoft.Office.Excel.GetLocalePluginEnabled"]}},O={[T.PluginAttachGroup.Core]:!0,[T.PluginAttachGroup.Python]:!1,[T.PluginAttachGroup.SmartSuggestionsAutoComplete]:!1};(0,b.staticAssertExtends)();const P={[T.PluginAttachGroup.Core]:{[T.PluginFactoryName.AutocompletePlugin]:!1},[T.PluginAttachGroup.Python]:{},[T.PluginAttachGroup.SmartSuggestionsAutoComplete]:{[T.PluginFactoryName.AutocompletePlugin]:!0}};async function M(e,t,r=[]){(0,a.isTypedChangeGateEnabled)("OfficeVSO:7903424_Microsoft.Office.Excel.ProvideX10FeaturesFromSchedulerFeatures")&&A.PluginSchedulerSingleton.instance().doNotify(E.NotificationKind.setSchedulerFeatures,[r.map((e=>T.SchedulerFeature[e]))]),s.scriptLoaderPromise.resolve(t);const i=I.Web[e];if(void 0===i)return!1;const[o,u,l,c]=i;if((void 0===u||(0,n.getTypedFeatureGate)(u))&&(void 0===l||(0,a.isTypedChangeGateEnabled)(l))&&(void 0===c||-1!==r.indexOf(c)))try{return await o.getValue(),!0}catch(t){C.x10Logger.log({kind:"failure",payload:{failureKind:C.X10FailureKind.PluginAttachmentFailure,failureLevel:y.TraceLevel.Error,path:"ensurePluginAttachedLegacy",description:`Failed to ensure plugin "${T.PluginFactoryName[e]}" is attached with exception`,data:t}})}return!1}async function D(e){const t=I[k.platform][e];if(void 0===t)return!1;const r=A.PluginSchedulerSingleton.instance().getSchedulerFeatures(),[i,o,s,u]=t;if((void 0===o||(0,n.getTypedFeatureGate)(o))&&(void 0===s||(0,a.isTypedChangeGateEnabled)(s))&&(void 0===u||-1!==r.indexOf(T.SchedulerFeature[u])))try{return await i.getValue(),!0}catch(t){C.x10Logger.log({kind:"failure",payload:{failureKind:C.X10FailureKind.PluginAttachmentFailure,failureLevel:y.TraceLevel.Error,path:"ensurePluginAttached",description:`Failed to ensure plugin "${T.PluginFactoryName[e]}" is attached with exception`,data:t}})}return!1}function w(e){return Object.keys(e).map((e=>parseInt(e,10)))}function L(e,t){return P[t][e]??O[t]}t.resolveScriptLoaderPromise=function(e){s.scriptLoaderPromise.resolve(e)},t.ensurePluginAttachedLegacy=M,t.setX10Features=function(e){A.PluginSchedulerSingleton.instance().doNotify(E.NotificationKind.setSchedulerFeatures,[e.map((e=>T.SchedulerFeature[e]))])},t.ensurePluginAttached=D,t.ensureGroupAttached=async function(e){let t=0;for(const r of w(I[k.platform]))L(r,e)&&await D(r)&&(t+=1);return t},t.ensureGroupAttachedLegacy=async function(e,t,r=[]){let n=0;for(const a of w(I.Web))L(a,t)&&await M(a,e,r)&&(n+=1);return n}},9762:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autoCompletePluginsThread=t.workerThreadInitialized=t.workerThreadSpread=t.dynamicPluginLoaderCreated=t.schedulerWithTableIntelligenceServiceAttached=t.schedulerWithRecalcServiceAttached=t.scriptLoaderPromise=t.FormulaAuthoringStringsOnMainThread=void 0;const n=r(1861),a=r(637),i=r(6366),o=r(6366),s=r(7630),u=r(3338);t.FormulaAuthoringStringsOnMainThread=(0,u.trackableAsyncLazy)((async()=>{const e=await t.dynamicPluginLoaderCreated.getValue();await e.loadPluginScript("formula-authoring-strings",!0)}),"FormulaAuthoringStringsOnMainThread"),t.scriptLoaderPromise=new i.ResolvablePromise,t.schedulerWithRecalcServiceAttached=(0,u.trackableAsyncLazy)((async()=>{const e=n.PluginSchedulerSingleton.instance();return l.getValue()&&await t.FormulaAuthoringStringsOnMainThread.getValue(),await e.recalcServiceAttached(),e}),"schedulerWithRecalcServiceAttached"),t.schedulerWithTableIntelligenceServiceAttached=(0,u.trackableAsyncLazy)((async()=>{const e=n.PluginSchedulerSingleton.instance();return await e.tableIntelligenceServiceAttached(),e}),"schedulerWithTableIntelligenceServiceAttached"),t.dynamicPluginLoaderCreated=(0,u.trackableAsyncLazy)((async()=>{const e=await t.scriptLoaderPromise;return(0,n.createDynamicPluginLoader)(e)}),"dynamicPluginLoaderCreated"),t.workerThreadSpread=(0,u.trackableAsyncLazy)((async()=>(await t.dynamicPluginLoaderCreated.getValue()).createPluginThread("worker")),"workerThreadSpread"),t.workerThreadInitialized=(0,u.trackableAsyncLazy)((async()=>{await t.workerThreadSpread.getValue()}),"workerThreadInitialized"),t.autoCompletePluginsThread=(0,u.trackableAsyncLazy)((async()=>{let e;return e=(0,o.getTypedFeatureGate)("Microsoft.Office.Excel.AutoCompleteOnMainThread")?await t.dynamicPluginLoaderCreated.getValue():await t.workerThreadSpread.getValue(),e}),"autoCompletePluginsThread");const l=new a.ResettableLazy((()=>{const e=n.PluginSchedulerSingleton.instance();return!e.isSchedulerFeatureEnabled(s.SchedulerFeature.SimpleAutoComplete)&&e.isSchedulerFeatureEnabled(s.SchedulerFeature.ArgumentAssistance)}))},8298:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.win32CleanDataPluginAttached=t.win32FormulaByExamplePluginAttached=void 0;const n=r(7630),a=r(3338),i=r(3166),o=r(1861);t.win32FormulaByExamplePluginAttached=new a.TrackableAsyncLazy((async()=>{const e=o.PluginSchedulerSingleton.instance(),t=(0,i.getPluginFactory)(n.PluginFactoryName.FormulaByExamplePlugin);e.createAndAttachPlugin(t)}),"win32FormulaByExamplePluginAttached"),t.win32CleanDataPluginAttached=new a.TrackableAsyncLazy((async()=>{const e=o.PluginSchedulerSingleton.instance(),t=(0,i.getPluginFactory)(n.PluginFactoryName.GetLocalePlugin);e.createAndAttachPlugin(t)}),"win32CleanDataPluginAttached")},6792:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.inCellControlsAutodetectionPluginAttach=t.formulaTranspilerPluginAttach=t.setCellPreftechPluginAttach=t.formulaByExamplePluginAttach=t.formulaRepairShadowEvalPluginDependenciesResolved=t.syntaxErrorsPluginDependenciesResolved=void 0;const n=r(7630),a=r(9762),i=r(3338),o=(0,i.trackableAsyncLazy)((async()=>{const e=await a.workerThreadSpread.getValue();return await e.loadPluginScript("excelOnlineX10Plugins",!1),e}),"threadWithExcelOnlineX10PluginsScriptLoaded");t.syntaxErrorsPluginDependenciesResolved=(0,i.trackableAsyncLazy)((async()=>{const e=await o.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),await e.createAndAttachPlugin(n.PluginFactoryName.SyntaxErrorsPlugin)}),"syntaxErrorsPluginDependenciesResolved"),t.formulaRepairShadowEvalPluginDependenciesResolved=(0,i.trackableAsyncLazy)((async()=>{const e=await o.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),await e.createAndAttachPlugin(n.PluginFactoryName.FormulaRepairShadowEvalPlugin)}),"formulaRepairShadowEvalPluginDependenciesResolved"),t.formulaByExamplePluginAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await o.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),await e.createAndAttachPlugin(n.PluginFactoryName.FormulaByExamplePlugin)}),"formulaByExamplePluginAttach"),t.setCellPreftechPluginAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await o.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),await e.createAndAttachPlugin(n.PluginFactoryName.SetCellPrefetchPlugin)}),"setCellPreftechPluginAttach"),t.formulaTranspilerPluginAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await a.workerThreadSpread.getValue();await e.loadPluginScript("excelOnlineFormulaTranspiler",!1),await e.createAndAttachPlugin(n.PluginFactoryName.FormulaTranspilerPlugin)}),"formulaTranspilerPluginAttach"),t.inCellControlsAutodetectionPluginAttach=(0,i.trackableAsyncLazy)((async()=>{const e=await o.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),await e.createAndAttachPlugin(n.PluginFactoryName.InCellControlsAutodetectionPlugin)}),"inCellControlsAutodetectionPluginAttach")},3942:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseState=t.ExecutionStopReason=t.FrameExecutionStopReason=t.SchedulerTimelineQueueMessageKind=t.delay=t.awaitPromise=t.typedRequest=t.recalcNotificationKinds=t.ComputationRequestExecutionType=t.ComputationRequestKind=t.DefaultComputationGroup=void 0;const n=r(6366),a=r(6366),i=r(115),o=r(5235),s=r(6366),u=r(2691),l=r(1276),c=r(4636),d=r(5354);var g,m,h;t.DefaultComputationGroup="",t.ComputationRequestKind={AwaitAll:"AwaitAll",AwaitAny:"AwaitAny",AwaitBatch:"AwaitBatch",AwaitEvent:"AwaitEvent",AwaitPromise:"AwaitPromise",AwaitTask:"AwaitTask",CloseChatGPTSession:"CloseChatGPTSession",CreateChatGPTSession:"CreateChatGPTSession",CreateTask:"CreateTask",Delay:"Delay",EvalFormula:"EvalFormula",EvalOnClonedModel:"EvalOnClonedModel",GetActiveCell:"GetActiveCell",GetActiveCellFormat:"GetActiveCellFormat",GetAvailableTableHeaders:"GetAvailableTableHeaders",GetCell:"GetCell",GetConfig:"GetConfig",GetContainingTable:"GetContainingTable",GetCorrelationId:"GetCorrelationId",GetCorrespondingSnapshotID:"GetCorrespondingSnapshotID",GetCultureTag:"GetCultureTag",GetDefinedNamesInfo:"GetDefinedNamesInfo",GetDefinedNameInfo:"GetDefinedNameInfo",GetEditFormat:"GetEditFormat",GetFullTableHeadersFromServer:"GetFullTableHeadersFromServer",GetFunctionInfo:"GetFunctionInfo",GetFunctionsInfo:"GetFunctionsInfo",GetHiddenRows:"GetHiddenRows",GetHiddenCols:"GetHiddenCols",GetIformat:"GetIformat",GetIntersectingTables:"GetIntersectingTables",GetRange:"GetRange",GetSheetNames:"GetSheetNames",GetStructRefColumn:"GetStructRefColumn",GetStructRefSpecialRef:"GetStructRefSpecialRef",GetRecognizedRangeTables:"GetRecognizedRangeTables",GetRichValueFieldListContext:"GetRichValueFieldListContext",IsSchedulerFeatureEnabled:"IsSchedulerFeatureEnabled",ParseActiveCell:"ParseActiveCell",ParseCellFormula:"ParseCellFormula",ParseEdit:"ParseEdit",ParseNumberFormat:"ParseNumberFormat",PrintFormula:"PrintFormula",PromiseToTask:"PromiseToTask",ResolveReferences:"ResolveReferences",SendAugLoopSignal:"SendAugLoopSignal",SendChatGPTQuery:"SendChatGPTQuery",SetActiveCell:"SetActiveCell",TriggerEvent:"TriggerEvent",UnsafeGetContainingTableName:"UnsafeGetContainingTableName",UnsafeGetIntersectingTableNames:"UnsafeGetIntersectingTableNames",UpdateSnapshot:"UpdateSnapshot"},(0,n.staticAssertExtends)(),t.ComputationRequestExecutionType={[t.ComputationRequestKind.AwaitAll]:o.ExecutionType.Async,[t.ComputationRequestKind.AwaitAny]:o.ExecutionType.Async,[t.ComputationRequestKind.AwaitBatch]:o.ExecutionType.Async,[t.ComputationRequestKind.AwaitEvent]:o.ExecutionType.Async,[t.ComputationRequestKind.AwaitPromise]:o.ExecutionType.Async,[t.ComputationRequestKind.AwaitTask]:o.ExecutionType.Async,[t.ComputationRequestKind.CloseChatGPTSession]:o.ExecutionType.Async,[t.ComputationRequestKind.CreateChatGPTSession]:o.ExecutionType.Async,[t.ComputationRequestKind.CreateTask]:o.ExecutionType.NoOp,[t.ComputationRequestKind.Delay]:o.ExecutionType.NoOp,[t.ComputationRequestKind.EvalFormula]:o.ExecutionType.Async,[t.ComputationRequestKind.EvalOnClonedModel]:o.ExecutionType.Async,[t.ComputationRequestKind.GetActiveCell]:o.ExecutionType.NoOp,[t.ComputationRequestKind.GetActiveCellFormat]:o.ExecutionType.NoOp,[t.ComputationRequestKind.GetAvailableTableHeaders]:o.ExecutionType.Sync,[t.ComputationRequestKind.GetCell]:o.ExecutionType.Async,[t.ComputationRequestKind.GetConfig]:o.ExecutionType.NoOp,[t.ComputationRequestKind.GetContainingTable]:o.ExecutionType.Async,[t.ComputationRequestKind.GetCorrelationId]:o.ExecutionType.NoOp,[t.ComputationRequestKind.GetCorrespondingSnapshotID]:o.ExecutionType.Async,[t.ComputationRequestKind.GetCultureTag]:o.ExecutionType.NoOp,[t.ComputationRequestKind.GetDefinedNamesInfo]:o.ExecutionType.NoOp,[t.ComputationRequestKind.GetDefinedNameInfo]:o.ExecutionType.NoOp,[t.ComputationRequestKind.GetEditFormat]:o.ExecutionType.Async,[t.ComputationRequestKind.GetFullTableHeadersFromServer]:o.ExecutionType.Async,[t.ComputationRequestKind.GetFunctionInfo]:o.ExecutionType.NoOp,[t.ComputationRequestKind.GetFunctionsInfo]:o.ExecutionType.NoOp,[t.ComputationRequestKind.GetHiddenRows]:o.ExecutionType.Async,[t.ComputationRequestKind.GetHiddenCols]:o.ExecutionType.Async,[t.ComputationRequestKind.GetIformat]:o.ExecutionType.Async,[t.ComputationRequestKind.GetIntersectingTables]:o.ExecutionType.Async,[t.ComputationRequestKind.GetRange]:o.ExecutionType.Async,[t.ComputationRequestKind.GetSheetNames]:o.ExecutionType.Sync,[t.ComputationRequestKind.GetStructRefColumn]:o.ExecutionType.Sync,[t.ComputationRequestKind.GetStructRefSpecialRef]:o.ExecutionType.Sync,[t.ComputationRequestKind.GetRecognizedRangeTables]:o.ExecutionType.Async,[t.ComputationRequestKind.GetRichValueFieldListContext]:o.ExecutionType.Async,[t.ComputationRequestKind.IsSchedulerFeatureEnabled]:o.ExecutionType.NoOp,[t.ComputationRequestKind.ParseActiveCell]:o.ExecutionType.Sync,[t.ComputationRequestKind.ParseCellFormula]:o.ExecutionType.Sync,[t.ComputationRequestKind.ParseEdit]:o.ExecutionType.Async,[t.ComputationRequestKind.ParseNumberFormat]:o.ExecutionType.Sync,[t.ComputationRequestKind.PrintFormula]:o.ExecutionType.Sync,[t.ComputationRequestKind.PromiseToTask]:o.ExecutionType.NoOp,[t.ComputationRequestKind.ResolveReferences]:o.ExecutionType.Sync,[t.ComputationRequestKind.SendAugLoopSignal]:o.ExecutionType.Async,[t.ComputationRequestKind.SendChatGPTQuery]:o.ExecutionType.Async,[t.ComputationRequestKind.SetActiveCell]:o.ExecutionType.NoOp,[t.ComputationRequestKind.TriggerEvent]:o.ExecutionType.NoOp,[t.ComputationRequestKind.UnsafeGetContainingTableName]:o.ExecutionType.Sync,[t.ComputationRequestKind.UnsafeGetIntersectingTableNames]:o.ExecutionType.Sync,[t.ComputationRequestKind.UpdateSnapshot]:o.ExecutionType.Async},(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),t.recalcNotificationKinds=[i.NotificationKind.setA1ReferenceStyle,i.NotificationKind.setLocale,i.NotificationKind.setWorkbookProps,i.NotificationKind.updateSheetNames,i.NotificationKind.updateNamedObjects],t.typedRequest=function*(e,t){const r=yield{kind:e,...t};return(0,a.assertTrue)("Response kind coincides with request kind",r.kind===e),(0,c.staticTypeHint)(r),r},t.awaitPromise=function*(e){const r=yield{kind:t.ComputationRequestKind.AwaitPromise,promise:e};return(0,a.assertTrue)("Response kind coincides with request kind",r.kind===t.ComputationRequestKind.AwaitPromise),r.result},t.delay={kind:t.ComputationRequestKind.Delay},function(e){e[e.NoOpRequest=0]="NoOpRequest",e[e.AsyncRequest=1]="AsyncRequest",e[e.SyncRequest=2]="SyncRequest",e[e.StepComputation=3]="StepComputation",e[e.StopComputationFrame=4]="StopComputationFrame",e[e.Timeout=5]="Timeout"}(g||(t.SchedulerTimelineQueueMessageKind=g={})),(0,n.staticAssertExtends)(),function(e){e.Superseded="Superseded",e.Timeout="Timeout",e.ConflictResolverEarlyTermination="ConflictResolverEarlyTermination"}(m||(t.FrameExecutionStopReason=m={})),function(e){e.Done="Done",e.Skipped="Skipped",e.Exception="Exception"}(h||(h={})),t.ExecutionStopReason={Unknown:"Unknown",Frame:m,Computation:h},t.ResponseState=class{computationFrame(e){return this._computationFrames.get(e)}get attachedComputations(){return[...this._attachedComputations]}get attachedSyncComputations(){return[...this._attachedSyncComputations]}get numComputations(){return this._attachedComputations.length}get numSyncComputations(){return this._attachedSyncComputations.length}attachComputation(e){this._attachedComputations.push(e)}attachSyncComputation(e){this._attachedSyncComputations.push(e)}createFrame(e,r,n,a,i,l,c,d){const g=new s.ResolvablePromise,m=this.computationKind,h={type:this.computationType,correlationId:e,computationGroup:r,computationInput:a,cache:i,config:l,startTime:c,timeWindow:d,successfulResults:{kind:m,results:[]},resolvable:g,stopReasonRef:new u.Ref(t.ExecutionStopReason.Unknown),numOfComputations:n===o.ExecutionType.Async?this.numComputations:this.numSyncComputations,numFailures:0,numSkippedComputations:0};return this._computationFrames.set(r,h),g}closeFrame(e,r,n){const a=this.computationFrame(e);if(!a)return;this._computationFrames.delete(e),a.stopReasonRef.value=r,a.resolvable.resolve(r===t.ExecutionStopReason.Frame.Superseded?{kind:"Superseded"}:{kind:"Done",payload:a.successfulResults}),a.cache?.close();const{computationKind:i,numComputations:o,numSyncComputations:s}=this,{correlationId:u,startTime:c,numSkippedComputations:g,successfulResults:m}=a,h=m.results.length,p={correlationId:u,type:this.computationType,computationKind:i,computationGroup:e,numComputations:o,numSyncComputations:s,numSent:h,numSkippedComputations:g,stopReason:r,startTime:c,stopTime:n};l.x10Logger.log({kind:"closeComputationFrame",payload:p}),(0,d.sendX10UsedTelemetryEvent)()}stop(e,t,r){void 0!==this.computationFrame(e)&&this.closeFrame(e,t,r)}constructor(e,t){this.computationType=e,this.computationKind=t,this._attachedComputations=[],this._attachedSyncComputations=[],this._computationFrames=new Map}}},6492:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrefetchingCache=void 0;const n=r(6067),a=r(6067),i=r(6067),o=r(6067),s=r(6067),u=r(6067),l=r(6067),c=r(6067),d=r(8226),g=r(6067),m=r(6067),h=r(6366),p=r(6366),f=r(6366),S=r(6366),v=r(6067),F=r(6067),y=r(6366),b=r(6366),C=r(6366),A=r(6366),E=r(6366),T=r(6366),R=r(6067),k=r(6468),N=r(9207),I=r(9207),O=r(9207),P=r(9207),M=r(5013),D=r(5013),w=r(6366),L=r(3228),_=r(3228),x=r(3228),K=r(3228),W=r(472),U=r(472),G=r(472),B=r(472),V=r(8073),j=r(8073),H=r(6067),q=r(6067),z=r(1276);function Q({hasHeadersRow:e,hasTotalsRow:t,dataRange:r}){return(0,n.gridRange)(r.row-Number(e),r.col,r.rows+Number(e)+Number(t),r.cols)}function $(e,t,r,a){const{name:i,hasHeadersRow:o,hasTotalsRow:s,dataRange:u,columns:l}=t,c=o?(0,n.gridRange)(u.row-1,u.col,1,u.cols):void 0,d=s?(0,n.gridRange)(u.row+u.rows,u.col,1,u.cols):void 0,g={};let m=w.RedBlackMapTree.create(e.stringCompareCI);for(const e of l)g[e.column]=e,m=m.setValue(e.name,e);return{name:i,sheet:r,dataRange:u,headersRange:c,totalsRange:d,allRange:a,indexToColumn:g,nameToColumn:m,allColumnNamesAvailable:l.length===u.cols}}function Y(e,t){return((0,D.compareProduct)((0,k.createCellSetFromRange)(t),e)??1)<=0}const J=(0,p.failure)((0,g.unavailable)(["getCell"])),X=(0,p.failure)((0,g.unavailable)(["getContainingTable"])),Z=(0,p.failure)((0,g.unavailable)(["getIntersectingTables"])),ee=(0,p.failure)((0,g.unavailable)(["getIntersectingTableNames"])),te=(0,p.failure)((0,g.unavailable)(["getIformats"])),re=(0,p.failure)((0,g.unavailable)(["GetAvailableTableHeaders"]));class ne{static getOrFetchTile(e,t,r){const i=t.range.row>>>ne.tileHeightPow,o=t.range.col>>>ne.tileWidthPow;void 0===e[i]&&(e[i]=[]);const s=e[i][o];return void 0===s?r((0,a.sheetGridRange)(t.sheet,(0,n.gridRange)(i<<ne.tileHeightPow,o<<ne.tileWidthPow,1<<ne.tileHeightPow,1<<ne.tileWidthPow))).then((t=>e[i][o]=t)):s}static create(e,t,r){return new ne(e,t,r)}getSheetContents(e){return this.sheet2contents[e]??(this.sheet2contents[e]={cellTiles:[],tables:(0,R.makeGridRangeTable)(),tableTiles:[],hiddenRows:I.empty,hiddenRowsAvailability:I.empty,hiddenCols:I.empty,hiddenColsAvailability:I.empty})}getCurrentDocumentLoc(){return this.currentDocumentLoc}getSheetNames(){if(void 0===this.sheetNames){const e=[];this.syncDataStore.sheets?.forEachSheet((t=>{e.push({sheetIndex:t.sheetIndex,sheetName:t.name})}));const t={};let r=w.RedBlackMapTree.create(this.syncDataStore.config.localeInfo.stringCompareCI);for(let n=0;n<e.length;n+=1){const{sheetIndex:a,sheetName:i}=e[n];t[a.index]=n,r=r.setValue(i,n)}const n=this.getCurrentDocumentLoc();this.sheetNames={document:n,sheets:e,idToIndex:t,nameToIndex:r}}return(0,S.success)(this.sheetNames)}getRangeValues(e){return this.grid.getRangeValues(this.correlationId,e)}getRangeFormulae(e){return this.grid.getRangeFormulae(this.correlationId,e)}getRangeFormats(e){return this.grid.getRangeFormats(this.correlationId,e)}async getHiddenRows(e,t,r){const n=this.getSheetContents(e.index),a=k.bspFactory.row([t,r]),i=(0,N.compare)(a,n.hiddenRowsAvailability);if(0!==i&&-1!==i){const a=await this.grid.getHiddenRows(this.correlationId,e,(0,A.fastMax)(0,t-10),(0,E.fastMin)(l.sheetRows,r+10));n.hiddenRows=a.hidden.reduce(((e,{start:t,end:r})=>(0,P.union)(e,k.bspFactory.row([t,r]))),n.hiddenRows),n.hiddenRowsAvailability=a.available.reduce(((e,{start:t,end:r})=>(0,P.union)(e,k.bspFactory.row([t,r]))),n.hiddenRowsAvailability)}const o=[];(0,k.forEachRow)((0,O.intersect)(n.hiddenRowsAvailability,a),(([e,t])=>(o.push((0,j.interval)(e,t)),!0)));const s=[];return(0,k.forEachRow)((0,O.intersect)(n.hiddenRows,a),(([e,t])=>(s.push((0,j.interval)(e,t)),!0))),{available:o,hidden:s}}async getHiddenCols(e,t,r){const n=this.getSheetContents(e.index),a=k.bspFactory.col([t,r]),i=(0,N.compare)(a,n.hiddenColsAvailability);if(0!==i&&-1!==i){const a=await this.grid.getHiddenCols(this.correlationId,e,(0,A.fastMax)(0,t-10),(0,E.fastMin)(c.sheetCols,r+10));n.hiddenCols=a.hidden.reduce(((e,{start:t,end:r})=>(0,P.union)(e,k.bspFactory.col([t,r]))),n.hiddenCols),n.hiddenColsAvailability=a.available.reduce(((e,{start:t,end:r})=>(0,P.union)(e,k.bspFactory.col([t,r]))),n.hiddenColsAvailability)}const o=[];(0,k.forEachCol)((0,O.intersect)(n.hiddenColsAvailability,a),(([e,t])=>(o.push((0,j.interval)(e,t)),!0)));const s=[];return(0,k.forEachCol)((0,O.intersect)(n.hiddenCols,a),(([e,t])=>(s.push((0,j.interval)(e,t)),!0))),{available:o,hidden:s}}async getRange(e,t){const r=void 0===t||t.indexOf("values")>-1,n=void 0===t||t.indexOf("formulae")>-1,a=void 0===t||t.indexOf("formats")>-1,i=(0,p.failure)((0,g.unavailable)(["getRange"])),[o,s,u]=await Promise.all([r?this.getRangeValues(e):i,n?this.getRangeFormulae(e):i,a?this.getRangeFormats(e):i]);return new d.NaiveLocalSheetGrid(e.sheet,o,s,u)}getCell(e){const t=this.getSheetContents(e.sheet.index),r=ne.getOrFetchTile(t.cellTiles,e,(async t=>{const[r,n,a]=[await this.grid.getRangeValues(this.correlationId,t),await this.grid.getRangeFormulae(this.correlationId,t),await this.grid.getRangeFormats(this.correlationId,t)];return(0,f.isSuccess)(r)&&(0,f.isSuccess)(n)&&(0,f.isSuccess)(a)?new d.NaiveLocalSheetGrid(e.sheet,r,n,a):"unavailable"}));return(0,b.bindMaybeThenable)(r,(t=>{if("unavailable"===t)return J;const r=t.getCellValue(e.range.row,e.range.col),n=t.getCellFormula(e.range.row,e.range.col),a=t.getCellFormat(e.range.row,e.range.col);return(0,f.isSuccess)(r)&&(0,f.isSuccess)(n)&&(0,f.isSuccess)(a)?(0,S.success)({value:r.value,formula:n.value,format:a.value}):J}))}getAvailableTableHeaders(e){const t=this.syncDataStore.nameManager;if(!t)return re;const r=t.getAllDocumentNames().find((t=>t.name===e));if(!r)return re;const n=t.getAvailableTableColumns(r);return(0,S.success)(n)}getStructRefColumn(e,t){const r=this.syncDataStore.getStructRefColumn(e,t);return r.kind===h.ResultKind.Failure?(0,p.failure)((0,g.unavailable)(["getStructRefColumn"])):r}getStructRefSpecialRef(e,t){const r=this.syncDataStore.getStructRefSpecialRef(e,t);return r.kind===h.ResultKind.Failure?(0,p.failure)((0,g.unavailable)(["getStructRefSpecialRef"])):r}getContainingTableName(e){const t=this.syncDataStore.getContainingTable(e);return t.kind===h.ResultKind.Failure?(0,p.failure)((0,g.unavailable)(["getContainingTableName"])):t}async getContainingTable(e){const t=this.getSheetContents(e.sheet.index),r=ne.getOrFetchTile(t.tableTiles,e,(async r=>{const n=await this.grid.getIntersectingTables(this.correlationId,r);if(!(0,f.isSuccess)(n))return"unavailable";const a=n.value.availableRanges.map(k.createCellSetFromRange).reduce(M.unionProduct,I.empty);for(const r of n.value.tables){const n=Q(r);t.tables.getValue(n)||(t.tables=t.tables.setValue(n,$(this.syncDataStore.config.localeInfo,r,e.sheet,n)))}return a}));return(0,b.bindMaybeThenable)(r,(r=>{if("unavailable"===r)return X;let n;return t.tables.forEachGe(e.range,((e,t)=>(n=t,!1))),void 0!==n||Y(r,e.range)?(0,S.success)(n):X}))}async getIntersectingTables(e){const t=this.getSheetContents(e.sheet.index);let r=I.empty;for(let n=e.range.row,a=e.range.row+e.range.rows;n<a;n+=1<<ne.tileHeightPow)for(let a=e.range.col,i=e.range.col+e.range.cols;a<i;a+=1<<ne.tileWidthPow){const i=ne.getOrFetchTile(t.tableTiles,(0,o.sheetGridCell)(e.sheet,(0,u.gridCell)(n,a)),(e=>this.fetchTableTile(e.sheet,t,e))),s=(0,C.isThenable)(i)?await i:i;if("unavailable"===s)return Z;r=(0,M.unionProduct)(r,s)}const n=[];return t.tables.forEachMeets(e.range,((e,t)=>(n.push(t),r=(0,M.unionProduct)(r,(0,k.createCellSetFromRange)(e)),!0))),Y(r,e.range)?(0,S.success)(n):Z}getIntersectingTableNames(e){if(void 0===this.syncDataStore.nameManager)return ee;const t=this.syncDataStore.nameManager.getIntersectingTables(e);return t.kind===h.ResultKind.Failure?ee:t}async fetchTableTile(e,t,r){const n=await this.grid.getIntersectingTables(this.correlationId,r);if(!(0,f.isSuccess)(n))return"unavailable";const a=n.value.availableRanges.map(k.createCellSetFromRange).reduce(M.unionProduct,I.empty);for(const r of n.value.tables){const n=Q(r);t.tables.getValue(n)||(t.tables=t.tables.setValue(n,$(this.syncDataStore.config.localeInfo,r,e,n)))}return a}async getIformat(e,t){const r=t>>>ne.formatPagePow,n=r<<ne.formatPagePow,a=n+(1<<ne.formatPagePow);let i=this.formatPages[r];if(void 0===i){const t=await this.grid.getIformats(this.correlationId,e,n,a);if((0,f.isSuccess)(t)){const e=[];for(const r of t.value.availableFormats)r.iformat<n||r.iformat>=a||(e[r.iformat-n]=r);i=this.formatPages[r]=e}else i=this.formatPages[r]="unavailable"}if("unavailable"===i)return te;const o=i[t-n];return void 0===o?te:(0,S.success)(o)}parseCellFormula(e,t,r){return{result:ne.cachedParseFormula(r?this.englishFormulaCache:this.formulaCache,r?this.englishParser:this.parser,r?this.englishAnalyzer:this.analyzer,e,t)}}async parseEdit(e,t){const r=await this.getEditFormat(e)??{valueType:_.FormatValueType.General,bidiDate:void 0,culture:void 0};return this.parseEditInternal(e,t,r)}parseEditSync(e,t,r){const n=this.parseNumberFormat(r.formatString,r.builtIn).result;let a;return a=(0,f.isSuccess)(n)?n.value:{valueType:_.FormatValueType.General,bidiDate:void 0,culture:void 0},this.parseEditInternal(e,t,a)}resolveReferences(e,t){return t.map((t=>{switch(t.kind){case H.NodeKind.StructRef:return this.resolveStructRefSync(e,t).result;case H.NodeKind.CellRef:return this.resolveCellRefNodeSync(e,t).result}}))}async getCorrespondingSnapshotID(){return-1===this.correspondingSnapshotID&&(this.correspondingSnapshotID=await this.grid.getCorrespondingSnapshotID(this.correlationId)),this.correspondingSnapshotID}async getEditFormat(e){const t=await this.getCell(e);if(!(0,f.isSuccess)(t))return;let r;if("string"==typeof t.value.format)r=this.parseNumberFormat(t.value.format,!1).result;else{const n=await this.getIformat(e.sheet.document,t.value.format);if(!(0,f.isSuccess)(n))return;const{formatString:a,builtIn:i}=n.value;r=this.parseNumberFormat(a,i).result}return(0,f.isSuccess)(r)?r.value:void 0}parseEditInternal(e,t,r){let n=this.formatter.parseEdit(t,r);if(!(0,f.isSuccess)(n))return{result:n};if(n.value.kind===x.EditKind.String&&"="===t&&r.valueType!==_.FormatValueType.Text&&(n=(0,S.success)((0,L.formulaEdit)(t))),n.value.kind!==x.EditKind.Formula)return{result:(0,S.success)(n.value)};const a=ne.parseCheckedFormula(this.parser,this.analyzer,e,n.value.fmla,e.range);return(0,f.isSuccess)(a)?{result:(0,S.success)({kind:x.EditKind.Formula,fmla:n.value.fmla,formula:a.value})}:{result:a}}static cachedParseFormula(e,t,r,n,a){const i=e.get(a);if(void 0!==i)return i;const o=ne.parseWellFormedFormula(t,r,n,a.formulaBarText,a.origin??n.range);return e.set(a,o),o}static parseWellFormedFormula(e,t,r,n,a){const i=ne.parseCheckedFormula(e,t,r,n,a);return(0,f.isSuccess)(i)?(0,m.isWellFormed)(i.value)?(0,S.success)(i.value):(0,p.failure)((0,V.illFormedFormula)("ill-formed formula")):i}static parseCheckedFormula(e,t,r,n,a){const s=e.parseFormula((0,W.parseLocals)(i.LexicalKind.Cell,a),n);if(!(0,f.isSuccess)(s))return s;const u=t.checkFormula((0,U.analyzeLocalsGrid)(i.LexicalKind.Cell,(0,o.sheetGridCell)(r.sheet,a)),s.value);return(0,f.isSuccess)(u)?(0,S.success)(u.value):u}parseNumberFormat(e,t){return{result:this.cachedParseNumberFormat(e,t)}}evalOnClonedModel(e,t,r){return this.grid.evalClonedModelOnSnapshot(this.correlationId,e,t,r)}evalFormula(e,t,r){return this.grid.evalFormulaOnSnapshot(this.correlationId,e,t,r)}cachedParseNumberFormat(e,t){const r=t?this.builtInFormatCache.get(e):this.customFormatCache.get(e);if(void 0!==r)return r;const n=this.formatter.createFormat(e,t);return t?this.builtInFormatCache.set(e,n):this.customFormatCache.set(e,n),n}resolveStructRefSync(e,t){return{result:this.resolver.resolveStructRef(e,t)}}resolveCellRefNodeSync(e,t){return{result:this.resolver.resolveCellRef(e,t)}}close(){this.grid.discardSnapshot(this.correlationId).catch((e=>{z.x10Logger.log({kind:"failure",payload:{failureKind:z.X10FailureKind.GridFailure,failureLevel:v.TraceLevel.Warning,path:"PrefetchingCache.close",description:(0,y.messageFromError)(e)}})}))}constructor(e,t,r){this.grid=e,this.syncDataStore=t,this.correlationId=r,this.correspondingSnapshotID=-1,this.sheet2contents=(0,T.makeStringMap)(),this.currentDocumentLoc=(0,s.documentLoc)(void 0,""),this.formatPages=[],this.formulaCache=new Map,this.englishFormulaCache=new Map,this.builtInFormatCache=new Map,this.customFormatCache=new Map,this.parser=(0,G.createParser)(t),this.analyzer=(0,B.createAnalyzer)(t),this.formatter=(0,K.createNumberFormatter)(t),this.resolver=(0,q.createResolver)(t);const n={config:{localeInfo:(0,F.getEnglishLocaleInfo)(),get date1904(){return t.config.date1904},get dateCompatibility(){return t.config.dateCompatibility},get datepack(){return t.config.datepack},get mathpack(){return t.config.mathpack},get refStyle(){return t.config.refStyle},get timezone(){return t.config.timezone}},getSheetName:(...e)=>t.getSheetName(...e),getContainingTable:(...e)=>t.getContainingTable(...e),getDocumentLoc:(...e)=>t.getDocumentLoc(...e),getNameLoc:(...e)=>t.getNameLoc(...e),getSheetIndex:(...e)=>t.getSheetIndex(...e),getSheetRangeIndexes:(...e)=>t.getSheetRangeIndexes(...e),getStructRefColumn:(...e)=>t.getStructRefColumn(...e),getStructRefSpecialRef:(...e)=>t.getStructRefSpecialRef(...e),getUserDefinedFuncLoc:(...e)=>t.getUserDefinedFuncLoc(...e)};this.englishParser=(0,G.createParser)(n),this.englishAnalyzer=(0,B.createAnalyzer)(n)}}t.PrefetchingCache=ne,ne.tileWidthPow=2,ne.tileHeightPow=4,ne.formatPagePow=6},8373:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pythonAutocompletePluginAttach=void 0;const n=r(9762),a=r(6366),i=r(7630),o=r(3338),s=(0,o.trackableAsyncLazy)((async()=>{const e=await n.workerThreadSpread.getValue();return await e.loadPluginScript((0,a.isTypedChangeGateEnabled)("Microsoft.Office.Excel.X10IntelligentPythonWP5")?"pythonIntelliSenseWP5":"pythonIntelliSense",!1),e}),"threadWithExcelOnlinePythonPluginScriptLoaded");t.pythonAutocompletePluginAttach=(0,o.trackableAsyncLazy)((async()=>{const e=await s.getValue();await e.createAndAttachPlugin(i.PluginFactoryName.PythonAutocompletePlugin)}),"pythonAutocompletePluginAttach")},6634:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processSyncRequest=t.processRequest=t.requestProcessorMap=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(6366),u=r(6366),l=r(6366),c=r(6067),d=r(6067),g=r(6067),m=r(6067),h=r(6067),p=r(6067),f=r(6067),S=r(6067),v=r(3942),F=r(6067),y=r(1276),b=r(2691),C=r(6366),A=r(7485),E=r(3228),T=r(2356),R=b.X10TaskInternal.createToken();function k(e,t){return e.kind===u.ResultKind.Failure?e:(0,l.success)(t(e.value))}async function N(e){try{return(0,l.success)(await e)}catch(e){return(0,s.failure)(e)}}t.requestProcessorMap={[v.ComputationRequestKind.Delay]:()=>(0,l.success)({}),[v.ComputationRequestKind.AwaitPromise]:async({request:{promise:e}})=>{try{const t=await e;return(0,l.success)({result:t})}catch(e){return(0,s.failure)(e)}},[v.ComputationRequestKind.CreateTask]:({request:{request:e},handle:t,schedulerState:r})=>{const n=new b.X10TaskInternal(r.scheduler.processRequest(t,e,{onFulfilled:e=>{if(e.kind!==u.ResultKind.Success)throw{kind:"RequestFailure"};return e.value},onRejected:e=>{throw e}}),R);return(0,l.success)({task:n})},[v.ComputationRequestKind.PromiseToTask]:({request:{promise:e}})=>(0,l.success)({task:new b.X10TaskInternal(e,R)}),[v.ComputationRequestKind.AwaitTask]:async({request:{task:e}})=>(0,l.success)({result:await N(e.resolve(R))}),[v.ComputationRequestKind.AwaitBatch]:async({request:{tasks:e}})=>{const t=[];for(const r of e)t.push(await N(r.resolve(R)));return(0,l.success)({results:t})},[v.ComputationRequestKind.AwaitAll]:async({request:{tasks:e}})=>{const t=i.MaybeThenable.all(e.map((e=>e.resolve(R))));return(0,l.success)({result:await N(t)})},[v.ComputationRequestKind.AwaitAny]:async({request:{tasks:e}})=>{const t=i.MaybeThenable.any(e.map((e=>e.resolve(R))));return(0,l.success)({result:await N(t)})},[v.ComputationRequestKind.GetCell]:async({request:{cell:e},cache:t})=>{if(void 0===t)return T.logSafeFailure.failure("Cache is undefined");const r=await t.getCell(e);return(0,l.success)({result:r})},[v.ComputationRequestKind.GetContainingTable]:async({request:{cell:e},cache:t})=>{if(void 0===t)return T.logSafeFailure.failure("Cache is undefined");const r=await t.getContainingTable(e);return(0,l.success)({result:r})},[v.ComputationRequestKind.UnsafeGetContainingTableName]:({request:{cell:e},cache:t})=>{if(void 0===t)return T.logSafeFailure.failure("Cache is undefined");const r=t.getContainingTableName(e);return(0,l.success)({result:r})},[v.ComputationRequestKind.GetAvailableTableHeaders]:({request:{tableName:e},cache:t})=>{if(void 0===t)return T.logSafeFailure.failure("Cache is undefined");const r=t.getAvailableTableHeaders(e);return(0,l.success)({result:r})},[v.ComputationRequestKind.GetIntersectingTables]:async({request:{range:e},cache:t})=>{if(void 0===t)return T.logSafeFailure.failure("Cache is undefined");const r=await t.getIntersectingTables(e);return(0,l.success)({result:r})},[v.ComputationRequestKind.UnsafeGetIntersectingTableNames]:({request:{range:e},cache:t})=>{if(void 0===t)return T.logSafeFailure.failure("Cache is undefined");const r=t.getIntersectingTableNames(e);return(0,l.success)({result:r})},[v.ComputationRequestKind.GetRange]:async({request:{range:e,layers:t},cache:r})=>{if(void 0===r)return T.logSafeFailure.failure("Cache is undefined");const n=await r.getRange(e,t);return(0,l.success)({localSheetGrid:n})},[v.ComputationRequestKind.GetSheetNames]:({cache:e})=>void 0===e?T.logSafeFailure.failure("Cache is undefined"):e.getSheetNames(),[v.ComputationRequestKind.GetStructRefColumn]:({request:{table:e,nameOrCol:t},cache:r})=>{if(void 0===r)return T.logSafeFailure.failure("Cache is undefined");const n=r.getStructRefColumn(e,t);return(0,l.success)({result:n})},[v.ComputationRequestKind.GetStructRefSpecialRef]:({request:{table:e,id:t},cache:r})=>{if(void 0===r)return T.logSafeFailure.failure("Cache is undefined");const n=r.getStructRefSpecialRef(e,t);return(0,l.success)({result:n})},[v.ComputationRequestKind.GetIformat]:async({request:{document:e,iformat:t},cache:r})=>{if(void 0===r)return T.logSafeFailure.failure("Cache is undefined");const n=await r.getIformat(e,t);return(0,l.success)({result:n})},[v.ComputationRequestKind.ParseCellFormula]:({request:{cell:e,formula:t,useEnglishLocaleInfo:r},cache:n})=>void 0===n?T.logSafeFailure.failure("Cache is undefined"):(0,l.success)(n.parseCellFormula(e,t,r)),[v.ComputationRequestKind.ParseEdit]:async({request:{cell:e,formulaBarText:t},cache:r})=>void 0===r?T.logSafeFailure.failure("Cache is undefined"):(0,l.success)(await r.parseEdit(e,t)),[v.ComputationRequestKind.ParseActiveCell]:({request:{formulaText:e},schedulerState:{activeCell:t,activeCellFormat:r},cache:n})=>{if(void 0===n)return T.logSafeFailure.failure("Cache is undefined");if((0,a.isNone)(t))return T.logSafeFailure.failure("Active Cell is undefined");if(void 0===r)return T.logSafeFailure.failure("Active Cell Format is undefined");const i=r??{formatString:"General",builtIn:!0};return(0,l.success)(n.parseEditSync(t,e,i))},[v.ComputationRequestKind.ParseNumberFormat]:({request:{formatString:e,builtIn:t},cache:r})=>void 0===r?T.logSafeFailure.failure("Cache is undefined"):(0,l.success)(r.parseNumberFormat(e,t)),[v.ComputationRequestKind.PrintFormula]:({request:{formula:e,origin:t},config:r})=>{if(void 0===r)return(0,s.failure)([]);const n=(0,p.createPrinter)((0,f.createSimplePrintGlobals)(r)).printFormula((0,S.printLocalsGrid)((0,h.lexicalSourceGrid)(m.LexicalKind.Cell,t),t),e);return(0,l.success)({result:n})},[v.ComputationRequestKind.GetActiveCell]:({schedulerState:{activeCell:e}})=>void 0===e?(g.ulsLogger.ULS.traceTag(512274723,c.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,y.x10Logger.formatLogMessage("GetActiveCell",{description:"failed because activeCell was undefined"})),T.logSafeFailure.failure("Active Cell is undefined")):(0,l.success)({activeCell:e}),[v.ComputationRequestKind.GetActiveCellFormat]:({schedulerState:{activeCellFormat:e}})=>void 0===e?T.logSafeFailure.failure("Active Cell Format is undefined"):null===e?(0,l.success)({result:(0,s.failure)((0,F.unavailable)(["unavailableFormat"]))}):(0,l.success)({result:(0,l.success)(e)}),[v.ComputationRequestKind.GetConfig]:({config:e})=>void 0===e?T.logSafeFailure.failure("Config is undefined"):(0,l.success)({config:e}),[v.ComputationRequestKind.GetCultureTag]:({request:{lcid:e}})=>{const t=(0,E.convertKnownLCID)(e).toString();return-1===t.indexOf("-")?T.logSafeFailure.failure(`Culture-Tag '${t}' from LCID '${e}' has an unknown format`):(0,l.success)({cultureTag:t})},[v.ComputationRequestKind.GetFunctionsInfo]:({schedulerState:e})=>{const t=e.functionsInfoMap;if(void 0===t)return g.ulsLogger.ULS.traceTag(512274722,c.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,y.x10Logger.formatLogMessage("GetFunctionsInfo",{description:"failed because functionsInfoMap was undefined"})),T.logSafeFailure.failure("functionsInfoMap is undefined");const r=Object.keys(t).map((e=>t[e]));return(0,l.success)({functionsInfo:r})},[v.ComputationRequestKind.GetFunctionInfo]:({request:{functionName:e},schedulerState:t})=>{if(void 0===t.functionsInfoMap)return g.ulsLogger.ULS.traceTag(512274721,c.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,y.x10Logger.formatLogMessage("GetFunctionInfo",{description:"failed because functionsInfoMap was undefined"})),T.logSafeFailure.failure("functionsInfoMap is undefined");const r=t.functionsInfoMap[e.toUpperCase()];return void 0===r?T.logSafeFailure.failure("functionsInfo is undefined"):(0,l.success)({functionInfo:r})},[v.ComputationRequestKind.GetDefinedNamesInfo]:({schedulerState:e})=>{const t=e.definedNamesInfoMap;if(void 0===t)return g.ulsLogger.ULS.traceTag(512274720,c.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Info,y.x10Logger.formatLogMessage("GetDefinedNamesInfo",{description:"failed because definedNamesInfoMap was undefined"})),T.logSafeFailure.failure("definedNamesInfoMap is undefined");const r=Object.keys(t).map((e=>t[e]));return(0,l.success)({definedNamesInfo:r})},[v.ComputationRequestKind.GetDefinedNameInfo]:({request:{definedName:e},schedulerState:t})=>{if(void 0===t.definedNamesInfoMap)return T.logSafeFailure.failure("definedNamesInfoMap is undefined");const r=t.definedNamesInfoMap[e.toUpperCase()];return(0,l.success)({definedNameInfo:r})},[v.ComputationRequestKind.EvalOnClonedModel]:async({cache:e,request:t})=>{const r=await(e?.evalOnClonedModel(t.updates,t.edits,t.formatResults));return void 0===r?T.logSafeFailure.failure("Operation did not return a result"):r.kind!==u.ResultKind.Success?T.logSafeFailure.failure("Operation returned an unsuccessful result"):(0,l.success)({result:r.value})},[v.ComputationRequestKind.EvalFormula]:async({cache:e,request:t})=>{const r=await(e?.evalFormula(t.formula,t.origin,t.format));return void 0===r?T.logSafeFailure.failure("Operation did not return a result"):r.kind!==u.ResultKind.Success?T.logSafeFailure.failure("Operation returned an unsuccessful result"):(0,l.success)({result:r.value})},[v.ComputationRequestKind.GetCorrelationId]:({correlationId:e})=>(0,l.success)({correlationId:e}),[v.ComputationRequestKind.SetActiveCell]:e=>(e.schedulerState={...e.schedulerState,activeCell:e.request.activeCell,activeCellFormat:e.request.activeCellFormat},(0,l.success)({})),[v.ComputationRequestKind.GetRichValueFieldListContext]:async({schedulerState:e,request:{rangeToQuery:t,dotNotationPath:r,singleColumn:n,findRange:i}})=>{const o=e.serverDataProvider;if((0,a.isNone)(o))return T.logSafeFailure.failure("serverDataProvider is undefined");const s=await o.getRichValueFieldListContext(t,r,n,i);return(0,C.isTypedChangeGateEnabled)("OfficeVSO:8575821_x10MapGetRichValueFieldListContext")||(0,l.success)({result:s}),(0,l.success)({result:s})},[v.ComputationRequestKind.GetHiddenRows]:async({cache:e,request:t})=>{if(void 0===e)return(0,s.failure)([]);const r=await e.getHiddenRows(t.sheet,t.start,t.endExclusive);return(0,l.success)({result:r})},[v.ComputationRequestKind.GetHiddenCols]:async({cache:e,request:t})=>{if(void 0===e)return(0,s.failure)([]);const r=await e.getHiddenCols(t.sheet,t.start,t.endExclusive);return(0,l.success)({result:r})},[v.ComputationRequestKind.ResolveReferences]:({cache:e,request:{locals:t,nodes:r}})=>{if(void 0===e)return T.logSafeFailure.failure("Cache is undefined");if(void 0===t)return T.logSafeFailure.failure("Locals is undefined");if(void 0===r)return T.logSafeFailure.failure("Nodes is undefined");const n=e.resolveReferences(t,r);return(0,l.success)({resolverResults:n})},[v.ComputationRequestKind.GetCorrespondingSnapshotID]:async({cache:e})=>{if(void 0===e)return T.logSafeFailure.failure("Cache is undefined");const t=await e.getCorrespondingSnapshotID();return(0,l.success)({snapshotID:t})},[v.ComputationRequestKind.GetEditFormat]:async({cache:e,request:{cell:t}})=>{if(void 0===e)return T.logSafeFailure.failure("Cache is undefined");const r=await e.getEditFormat(t);return(0,l.success)({result:void 0===r?(0,s.failure)((0,F.unavailable)(["Unavailable Format"])):(0,l.success)(r)})},[v.ComputationRequestKind.UpdateSnapshot]:async({handle:e,schedulerState:t})=>{const r=await t.scheduler.updatePrefetchingCache(e);return void 0===r?T.logSafeFailure.failure("Cache is undefined"):(0,l.success)({snapshotID:r})},[v.ComputationRequestKind.GetFullTableHeadersFromServer]:async({schedulerState:e,request:{tableName:t}})=>{const r=e.serverDataProvider;if((0,a.isNone)(r))return T.logSafeFailure.failure("serverDataProvider is undefined");const i=await r.getTableColHeaders(t);return(0,a.isNone)(i)?(0,l.success)({result:[]}):(0,l.success)({result:i.filter(n.isDefined)})},[v.ComputationRequestKind.CreateChatGPTSession]:async({schedulerState:{scheduler:e},finalizer:t,request:{options:r}})=>{if(void 0===r)return T.logSafeFailure.failure("Request contained undefined 'options'");const n=await e.createChatGPTSession(r);return n.kind===u.ResultKind.Success&&t.subscribe((()=>e.closeChatGPTSession(n.value))),k(n,(e=>({result:e})))},[v.ComputationRequestKind.CloseChatGPTSession]:async({schedulerState:{scheduler:e},request:{session:t}})=>k(await e.closeChatGPTSession(t),(()=>({result:void 0}))),[v.ComputationRequestKind.SendChatGPTQuery]:async({schedulerState:{scheduler:e},request:{session:t,request:r}})=>k(await e.sendChatGPTQuery(t,r),(e=>({result:e}))),[v.ComputationRequestKind.IsSchedulerFeatureEnabled]:({schedulerState:{scheduler:e},request:{feature:t}})=>{const r=e.isSchedulerFeatureEnabled(t);return(0,l.success)({isFeatureEnabled:r})},[v.ComputationRequestKind.SendAugLoopSignal]:async({schedulerState:{scheduler:e},handle:t,request:{signal:r}})=>k(await e.sendAugLoopSignal(r,t.info.computationIdentifier.factoryName),(e=>({result:e}))),[v.ComputationRequestKind.TriggerEvent]:({schedulerState:{scheduler:e},request:{eventKind:t,event:r}})=>(e.triggerEventImmediate(t,r),(0,l.success)({})),[v.ComputationRequestKind.AwaitEvent]:async({schedulerState:{scheduler:e},request:t})=>{const r=(0,C.isTypedChangeGateEnabled)("OfficeVSO:9127295_x10_awaitEventAsyncChanges")?e.catchEvent(t):void 0;if((0,A.isALAnnotationEventKind)(t.eventKind)){const r=await e.registerALAnnotation(t.eventKind);if(r.kind!==u.ResultKind.Success)return r}const n=await(r??e.catchEvent(t));return(0,l.success)({result:n})},[v.ComputationRequestKind.GetRecognizedRangeTables]:async({schedulerState:{scheduler:e},handle:t,request:{sheetId:r,range:n,metadataStates:a,maxRevisions:i}})=>k(await e.getRecognizedTablesInfo(r,n,a,t.info.computationIdentifier.factoryName,i),(e=>({result:e})))},t.processRequest=function(e,t,r,n,a){const{info:{correlationId:i},schedulerState:s,finalizer:c}=r,d=e[t.kind],g={request:t,correlationId:i,cache:n,config:a,schedulerState:s,finalizer:c,handle:r},m=d(g);return(0,o.bindMaybeThenable)(m,(e=>e.kind!==u.ResultKind.Success?T.logSafeFailure.censored(e):(r.schedulerState=g.schedulerState,(0,l.success)({kind:t.kind,...e.value}))))},t.processSyncRequest=function(e,t,r,n,a){const{info:{correlationId:i},schedulerState:o,finalizer:s}=r,c={request:t,correlationId:i,cache:n,config:a,schedulerState:o,finalizer:s,handle:r},d=(0,e[t.kind])(c);return d.kind!==u.ResultKind.Success?T.logSafeFailure.censored(d):(r.schedulerState=c.schedulerState,(0,l.success)({kind:t.kind,...d.value}))}},1861:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSchedulerFactories=t.dynamicPluginLoaderInsideInit=t.createDynamicPluginLoader=t.PluginSchedulerSingleton=t.GridImportManagerSingleton=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(5900),s=r(2897),u=r(619),l=r(7732),c=r(7346),d=r(8647),g=(0,a.singleton)((()=>{const e=f().createGridProvider((()=>t.PluginSchedulerSingleton.instance().registerAsyncGrid()));return t.GridImportManagerSingleton.instance().onGridImporterCreated(e,"Main-IGrid"),e}));t.GridImportManagerSingleton=(0,a.singleton)((()=>f().createGridImportManager())),t.PluginSchedulerSingleton=(0,a.singleton)((()=>f().createFormulaBarScheduler(g.instance()))),(0,i.staticAssertExtends)(),t.createDynamicPluginLoader=function(e){return f().createDynamicPluginLoader(t.GridImportManagerSingleton.instance(),t.PluginSchedulerSingleton.instance(),e)};const m=(e,t,...r)=>new s.FormulaBarScheduler((0,l.timelineQueueProcessorFactory)(r[0]),(0,l.createPrefetchingCacheFactory)(e),t,e.getGridDataSink(),e.getSyncDataModel(),...r);t.dynamicPluginLoaderInsideInit=(0,l.dynamicPluginLoaderInsideInit)(l.timelineQueueProcessorFactory,l.createPrefetchingCacheFactory);class h extends s.FormulaBarScheduler{set ComputationFinalizerHandlers(e){this.computationFinalizerHandlers=e}get ComputationFinalizerHandlers(){return this.computationFinalizerHandlers}}const p={Win32:{createFormulaBarScheduler:m,createExperimentFormulaBarScheduler(){throw new Error("Cannot use Experiment Formula Bar Scheduler in win32 context")},createTestableFormulaBarScheduler(){throw new Error("Cannot use Testable Formula Bar Scheduler in win32 context")},createDynamicPluginLoader(){throw new Error("Cannot use Dynamic Plugin Loader in win32 context")},createGridImportManager:()=>({onGridExporterCreated(){},onGridImporterCreated(){}}),createGridProvider(){const e=new d.CacheGrid;return{getGrid:()=>e,getGridDataSink:()=>e,getSyncDataModel:()=>e,createIGridImportEndpoint(){throw new Error("Cannot use createIGridImportEndpoint in win32 context")},onGridExporterClosed(){throw new Error("Cannot use onGridExporterClosed in win32 context")}}}},Web:{createFormulaBarScheduler:m,createDynamicPluginLoader:(...e)=>((e,...t)=>new l.DynamicPluginLoader(e,...t))("excelOnlineCalc.x10.stableDynamicPluginLoaderInsideInit",...e),createGridImportManager:e=>new o.GridImportManager(e),createGridProvider:e=>new o.GridProvider(e),createExperimentFormulaBarScheduler:(e,t,...r)=>{let n;const a=new s.FormulaBarScheduler((e=>(n=new u.ExperimentQueueProcessor(e),n)),(0,l.createPrefetchingCacheFactory)(e),t,e.getGridDataSink(),e.getSyncDataModel(),...r);if(void 0===n)throw"not initialized";return[a,n]},createTestableFormulaBarScheduler:(e,t,...r)=>new h((0,l.timelineQueueProcessorFactory)(r[0]),(0,l.createPrefetchingCacheFactory)(e),t,e.getGridDataSink(),e.getSyncDataModel(),...r)}};function f(){return p[c.platform]}if(t.getSchedulerFactories=f,(0,n.getTypedFeatureGate)("TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL")&&(self.__retries=(self.__retries??-1)+1,0===self.__retries))throw""},5004:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapRequest=t.wrapSyncRequest=t.createTimelineQueueMessage=t.createSyncTimelineQueueMessage=t.InternalSchedulerResponseKind=void 0;const n=r(6366),a=r(6366),i=r(3942),o=r(5235),s=r(4636);var u;function l(e,t){return function(e){return i.ComputationRequestExecutionType[e.kind]===o.ExecutionType.NoOp}(e)?{kind:i.SchedulerTimelineQueueMessageKind.NoOpRequest,request:e,computation:t}:{kind:i.SchedulerTimelineQueueMessageKind.SyncRequest,request:e,computation:t}}function c(e,t){switch(e.kind){case i.ComputationRequestKind.Delay:case i.ComputationRequestKind.CreateTask:case i.ComputationRequestKind.PromiseToTask:case i.ComputationRequestKind.GetActiveCell:case i.ComputationRequestKind.GetActiveCellFormat:case i.ComputationRequestKind.GetConfig:case i.ComputationRequestKind.GetCultureTag:case i.ComputationRequestKind.GetCorrelationId:case i.ComputationRequestKind.GetFunctionInfo:case i.ComputationRequestKind.GetFunctionsInfo:case i.ComputationRequestKind.GetDefinedNameInfo:case i.ComputationRequestKind.GetDefinedNamesInfo:case i.ComputationRequestKind.SetActiveCell:case i.ComputationRequestKind.IsSchedulerFeatureEnabled:case i.ComputationRequestKind.TriggerEvent:return{kind:i.SchedulerTimelineQueueMessageKind.NoOpRequest,request:e,computation:t};case i.ComputationRequestKind.GetSheetNames:case i.ComputationRequestKind.GetAvailableTableHeaders:case i.ComputationRequestKind.ParseCellFormula:case i.ComputationRequestKind.ParseNumberFormat:case i.ComputationRequestKind.PrintFormula:case i.ComputationRequestKind.ParseActiveCell:case i.ComputationRequestKind.ResolveReferences:case i.ComputationRequestKind.UnsafeGetContainingTableName:case i.ComputationRequestKind.UnsafeGetIntersectingTableNames:case i.ComputationRequestKind.GetStructRefColumn:case i.ComputationRequestKind.GetStructRefSpecialRef:return{kind:i.SchedulerTimelineQueueMessageKind.SyncRequest,request:e,computation:t};default:(0,n.assertNever)(`unknown request: ${e}`,e)}}!function(e){e[e.FirstStep=0]="FirstStep",e[e.NormalResponse=1]="NormalResponse",e[e.RequestFailure=2]="RequestFailure"}(u||(t.InternalSchedulerResponseKind=u={})),(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)(),t.createSyncTimelineQueueMessage=l,t.createTimelineQueueMessage=function(e,t){return function(e){return i.ComputationRequestExecutionType[e.kind]===o.ExecutionType.Async}(e)?{kind:i.SchedulerTimelineQueueMessageKind.AsyncRequest,request:e,computation:t}:((0,s.staticTypeHint)(t),l(e,t))},t.wrapSyncRequest=c,t.wrapRequest=function(e,t){switch(e.kind){case i.ComputationRequestKind.GetRange:case i.ComputationRequestKind.GetCell:case i.ComputationRequestKind.GetContainingTable:case i.ComputationRequestKind.GetIntersectingTables:case i.ComputationRequestKind.GetIformat:case i.ComputationRequestKind.AwaitPromise:case i.ComputationRequestKind.AwaitTask:case i.ComputationRequestKind.AwaitBatch:case i.ComputationRequestKind.AwaitAll:case i.ComputationRequestKind.AwaitAny:case i.ComputationRequestKind.ParseEdit:case i.ComputationRequestKind.GetRichValueFieldListContext:case i.ComputationRequestKind.GetHiddenRows:case i.ComputationRequestKind.GetHiddenCols:case i.ComputationRequestKind.EvalOnClonedModel:case i.ComputationRequestKind.EvalFormula:case i.ComputationRequestKind.GetCorrespondingSnapshotID:case i.ComputationRequestKind.GetEditFormat:case i.ComputationRequestKind.UpdateSnapshot:case i.ComputationRequestKind.GetFullTableHeadersFromServer:case i.ComputationRequestKind.CreateChatGPTSession:case i.ComputationRequestKind.CloseChatGPTSession:case i.ComputationRequestKind.SendChatGPTQuery:case i.ComputationRequestKind.SendAugLoopSignal:case i.ComputationRequestKind.AwaitEvent:case i.ComputationRequestKind.GetRecognizedRangeTables:return{kind:i.SchedulerTimelineQueueMessageKind.AsyncRequest,request:e,computation:t};default:return c(e,t)}},(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)()},345:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncDataModel=t.MaxStateIdDifferenceForGC=void 0;const n=r(8072),a=r(222),i=r(429),o=r(8713),s=r(6448),u=r(6067),l=r(6067),c=r(6366),d=r(6366),g=r(6366),m=r(6067),h=r(6067),p=r(115),f=()=>{};t.MaxStateIdDifferenceForGC=17,t.SyncDataModel=class{get document(){return this.dataTransformer.document}getStateAsNotifications(){return[...this.configNotifications,...this.getSheetStateAsNotifications(),...this.getNameStateAsNotifications(),...this.getSchedulerFeaturesAsNotifications()]}getSchedulerFeaturesAsNotifications(){return[[p.NotificationKind.setSchedulerFeatures,[this.schedulerFeatures]]]}getSheetStateAsNotifications(){const e=[];return this.sheets.forEachSheet(((t,r)=>{e.push((0,i.sheetName)(r,t.name))})),e.length>0?[[p.NotificationKind.updateSheetNames,[this.stateId,e]]]:[]}getNameStateAsNotifications(){const e=[],t=t=>{const r=[];t.forEachAvailableName(((e,t)=>{const n=(0,a.namedObjectToNamedObjectData)(this.config.mathpack,this.dataTransformer.document,t?.obj);return r.push((0,i.namedObject)(e,n)),!0})),r.length>0&&e.push((0,i.namedObjectsWrite)(t.scope.index,r)),t.allAvailable()&&e.push((0,i.undefinedNamesWrite)(t.scope.index))},r=this.nameManager.getNamesBySheetId(void 0);return(0,d.isSuccess)(r)&&t(r.value),this.nameManager.forEachSheetScope((e=>{t(e)})),e.length>0?[[p.NotificationKind.updateNamedObjects,[this.stateId,e]]]:[]}trySetStateId(e,r){if(r<this.stateId)return!1;if(r>this.stateId){const e=this.stateId;if(this.stateId=r,this.sheets.advanceState(e),this.nameManager.advanceState(e),this.stateChangesSinceLastGC+=1,this.stateChangesSinceLastGC>=t.MaxStateIdDifferenceForGC){this.stateChangesSinceLastGC=0;const e=this.stateId-t.MaxStateIdDifferenceForGC;this.nameManager.collectGarbage(e)}}return!0}clearCompiledFormulas(){this.nameManager.resetLazyData()}clearCompiledNumberFormats(){}setA1ReferenceStyle(e){this.configNotifications.push([p.NotificationKind.setA1ReferenceStyle,[e]]),this.dataTransformer.setA1ReferenceStyle(this,this.stateId,e)}setLocale(e){this.configNotifications.push([p.NotificationKind.setLocale,[e]]),this.dataTransformer.setLocaleInfo(this,this.stateId,e,{})}setWorkbookProps(e){this.configNotifications.push([p.NotificationKind.setWorkbookProps,[e]]),this.dataTransformer.setWorkbookProps(this,this.stateId,e,{})}updateSheetNames(e,t){this.dataTransformer.updateSheetNames(this,e,t,{})}updateNamedObjects(e,t){this.dataTransformer.updateNamedObjects(this,e,t,{})}setSchedulerFeatures(e){this.schedulerFeatures=e}setLangConfig(e,t){if(!this.trySetStateId(!0,e))return;const r=this.config.localeInfo!==t.localeInfo,n=this.config.refStyle!==t.refStyle;this.config=t,r&&this.clearCompiledNumberFormats(),(r||n)&&this.clearCompiledFormulas()}setSheetNames(e,t,r){this.trySetStateId(!0,r)&&(this.sheets=this.sheets.setSheetNames(t),this.nameManager=this.nameManager.setSheetNames(t))}writeNamedObject(e,t,r,n){if(!this.trySetStateId(!0,e))return;const a=this.nameManager.setNamedObject(!0,(0,l.nameLoc)(t,r),n,f);(0,d.isSuccess)(a)}writeUndefinedNames(e,t){if(!this.trySetStateId(!0,e))return;const r=this.nameManager.setUndefinedNames(t);(0,d.isSuccess)(r)}promoteNamedObjects(e,t,r){if(!this.trySetStateId(!0,e))return;const n=this.nameManager.promoteNamedObjects(t,r);(0,d.isSuccess)(n)&&n.value}getDocumentLoc(e,t){const r=this.dataTransformer.document;return void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?(0,c.failure)((0,h.unavailable)([(0,u.documentLoc)(e,t)])):(0,g.success)(r)}getSheetIndex(e,t){const r=this.sheets.getSheetByName(t);return(0,d.isSuccess)(r)?void 0===r.value?r:(0,g.success)(r.value.sheetIndex.index):r}getSheetName(e,t){const r=this.sheets.getSheetById(t);return(0,d.isSuccess)(r)?(0,g.success)(r.value.name):r}getNameLoc(e,t,r){return this.nameManager.getNameLoc(e.index,t,r)}getUserDefinedFuncLoc(e,t){return(0,c.failure)((0,m.notImplemented)(["call UDF"]))}getSheetRangeIndexes(e){return this.sheets.getSheetRangeIds(e)}getContainingTable(e){return this.nameManager.getContainingTable(e)}getStructRefColumn(e,t){return this.nameManager.getStructRefColumn(e,t)}getStructRefSpecialRef(e,t){return this.nameManager.getStructRefSpecialRef(e,t)}getTime(){return(0,c.failure)((0,h.unavailable)(["getTime"]))}constructor(){this.dataTransformer=new n.RecalcServiceDataTransformer,this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.config=this.dataTransformer.getLangConfig(),this.configNotifications=[],this.sheets=new o.PartialWorkbookSheets(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.nameManager=new s.PartialWorkbookNameManager(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.schedulerFeatures=[]}}},6332:function(e,t,r){"use strict";const n=r(6058);e.exports=n.testUtils},5480:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flaky=t.YarnExecutionArgs=t.testingCGOverrides=t.GateOverrideManager=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366),s=r(3219),u=r(3219),l=r(6366);class c{static defaultGateOverrides(){return 0===c.changeGatesToTest.length&&0===c.booleanFeatureGatesToTest.length?[{featureGates:{Number_Of_Times_Test_Was_Executed:1}},{featureGates:{Number_Of_Times_Test_Was_Executed:2}}]:[...c.defaultChangeGateOverrides().map((e=>({changeGates:e}))),...c.defaultBooleanFeatureGateOverrides().map((e=>({featureGates:e})))]}static defaultChangeGateOverrides(){return 0===c.changeGatesToTest.length?[]:c.changeGatesToTest.map((e=>[{[e]:!0},{[e]:!1}])).flat()}static defaultBooleanFeatureGateOverrides(){return 0===c.booleanFeatureGatesToTest.length?[]:c.booleanFeatureGatesToTest.map((e=>[{[e]:!0},{[e]:!1}])).flat()}static mergeGateOverrides(e,t){return{changeGates:{...e.changeGates,...t.changeGates},featureGates:{...e.featureGates,...t.featureGates}}}static mergeGateOverrideLists(e,t){const r=new Set;return e.forEach((e=>{t.forEach((t=>{const n=c.mergeGateOverrides(e,t);let a=!0;r.forEach((e=>{c.extends(e,n)?a=!1:c.extends(n,e)&&r.delete(e)})),a&&r.add(n)}))})),Array.from(r)}static extends(e,t){return Object.entries(t.changeGates??{}).every((([t,r])=>e.changeGates?.[t]===r))&&Object.entries(t.featureGates??{}).every((([t,r])=>e.featureGates?.[t]===r))}static override(e){return{changeGates:(0,l.isDefined)(e.changeGates)?(0,u.overrideTypedChangeGates)(n.isTypedChangeGateEnabled,e.changeGates):void 0,featureGates:(0,l.isDefined)(e.featureGates)?(0,o.overrideTypedFeatureGates)(a.getTypedFeatureGate,e.featureGates):void 0}}static revert(e){(0,s.setChangeGateDictionaryGetter)(e.changeGates),(0,i.setFeatureGateDictionaryGetter)(e.featureGates)}}t.GateOverrideManager=c,c.changeGatesToTest=[],c.booleanFeatureGatesToTest=[],t.testingCGOverrides=c.defaultChangeGateOverrides();class d{static get instance(){return(0,l.isDefined)(this._instance)||(this._instance=new d),this._instance}constructor(){this.args=[],this.args=JSON.parse({NODE_ENV:"production"}.npm_config_argv??"{}").original??[]}}t.YarnExecutionArgs=d,d.has=e=>d.instance.args.findIndex((t=>t===e))>=0,t.flaky=()=>d.has("--flaky")?it:it.skip},3423:function(e,t,r){"use strict";const n=r(6058);e.exports=n.timelineQueueProcessor},3338:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trackableAsyncLazy=t.TrackableAsyncLazy=void 0;const n=r(637),a=r(1276),i=r(6366);class o extends n.ResettableLazy{reset(){throw new Error("Resetting a TrackableAsyncLazy is not allowed")}constructor(e,t,r=i.now){super((async()=>{try{const t=r(),n=e(),o=r()-t,s=await n,u=r()-t-o;return a.x10Logger.log({kind:"trackableAsyncLazy",payload:{name:this.name,result:(0,i.success)({syncTime:o,asyncTime:u})}}),s}catch(e){throw(0,i.isTypedChangeGateEnabled)("OfficeVSO:9272876_LogThrowingAsyncLazy")&&a.x10Logger.log({kind:"trackableAsyncLazy",payload:{name:this.name,result:(0,i.failure)(`${e}`)}}),e}})),this.name=t}}t.TrackableAsyncLazy=o,t.trackableAsyncLazy=function(e,t,r=i.now){return new o(e,t,r)}},5354:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendX10UsedTelemetryEvent=t.createX10RequestPerformanceEvent=t.createX10AggregatedTelemetryEvent=t.addSampleWithProbability=t.getHistogramBinIndexForDuration=t.updateDurationHistogramsWithRequestTimes=t.histogramBinCount=t.REQUEST_DURATION_THRESHOLDS=void 0;const n=r(6366),a=r(6366),i=r(8521),o=r(3969);t.REQUEST_DURATION_THRESHOLDS=[5,10,20,50,100,200],t.histogramBinCount=t.REQUEST_DURATION_THRESHOLDS.length+1;const s=new a.JSF32(0);let u=!1;function l(e){for(let r=0;r<t.REQUEST_DURATION_THRESHOLDS.length;r++)if(e<t.REQUEST_DURATION_THRESHOLDS[r])return r;return t.REQUEST_DURATION_THRESHOLDS.length}function c(){return{dataCategories:i.EnumObjects.DataCategories.ProductServiceUsage,samplingPolicy:i.EnumObjects.SamplingPolicy.Measure,diagnosticLevel:i.EnumObjects.DiagnosticLevel.Optional}}t.updateDurationHistogramsWithRequestTimes=function(e,r){var a;return(a=r,Object.entries(a)).forEach((([r,a])=>{if((0,n.isDefined)(a)&&a.numberOfRequests>0){const n=l(a.requestDuration/a.numberOfRequests),i=e[r]??Array(t.histogramBinCount).fill(0);i[n]+=a.numberOfRequests,e[r]=i}})),e},t.getHistogramBinIndexForDuration=l,t.addSampleWithProbability=function(e,t,r){return function(e){return e>=0&&e<=1}(r)&&s.next()<r&&e.push(t),e},t.createX10AggregatedTelemetryEvent=function(e){return{eventName:"Office.Excel.Client.X10.AggregatedTelemetry",eventFlags:c(),dataFields:[(0,i.makeStringDataField)("X10AggregatedTelemetryObject",e)]}},t.createX10RequestPerformanceEvent=function(e){return{eventName:"Office.Excel.Client.X10.RequestPerformance",eventFlags:c(),dataFields:[(0,i.makeStringDataField)("X10RequestPerformanceTelemetryObject",e)]}},t.sendX10UsedTelemetryEvent=function(){u||((0,o.getTelemetryLogger)().sendTelemetryEvent({eventName:"Office.Excel.Client.X10.X10UsedEvent",eventFlags:c()}),u=!0)}},9834:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X10ExceptionComputationTermination=t.X10Exception=void 0;class r extends Error{}t.X10Exception=r,t.X10ExceptionComputationTermination=class extends r{constructor(e){super(`Computation execution was terminated with '${e}'.`),this.stopReason=e}}},1276:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.x10Logger=t.CombinedLogger=t.ImmediateLogger=t.X10FailureKind=t.LoggerKind=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6067),s=r(6067),u=r(7630),l=r(6366),c=r(6366),d=r(5354),g=r(4636),m=r(3969),h="Main",p=(0,c.isTypedChangeGateEnabled)("OfficeVSO:8786821_x10SendLoggerMessagesToMainThread"),f=(0,c.isTypedChangeGateEnabled)("OfficeVSO:8846142_x10SendTelemetryWithUTel");var S,v;!function(e){e.Immediate="Immediate",e.Aggregating="Aggregating"}(S||(t.LoggerKind=S={})),function(e){e.ALFailure="ALFailure",e.AssertionFailure="AssertionFailure",e.CustomConflictResolverFailure="CustomConflictResolverFailure",e.EventCallbacksManagerFailure="EventCallbacksManagerFailure",e.GridFailure="GridFailure",e.NotificationProcessorFailure="NotificationProcessorFailure",e.PluginAttachmentFailure="PluginAttachmentFailure",e.PluginFailure="PluginFailure",e.RequestProcessorFailure="RequestProcessorFailure",e.TableIntelligenceFailure="TableIntelligenceFailure"}(v||(t.X10FailureKind=v={}));const F=(e,t,r)=>`x10arch.[${e}].${t}: ${(0,n.isDefined)(r.description)&&r.description.length?`${r.description}. `:""}${(0,n.isDefined)(r.data)?JSON.stringify(r.data):""}`;(0,a.staticAssertSame)();const y={trackableAsyncLazy:(e,{name:t,result:r})=>i.ulsLogger.ULS.traceTag(507316304,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,F(e,"trackableAsyncLazy",{data:"Success"===r.kind?{name:t,syncTime:r.value.syncTime,asyncTime:r.value.asyncTime}:{name:t,failure:r.reason}})),snapshotCreation:(e,t)=>i.ulsLogger.ULS.traceTag(512305240,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,F(e,"snapshotCreation",{data:t})),beginRequest:(e,t)=>i.ulsLogger.ULS.traceTag(553734792,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,F(e,"beginRequest",{data:t})),requestSkipped:(e,t)=>i.ulsLogger.ULS.traceTag(553734793,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,F(e,"requestSkipped",{data:t})),registerPluginFactory:(e,{factoryName:t})=>i.ulsLogger.ULS.traceTag(571246212,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,F(e,"registerPluginFactory",{description:`registered ${u.PluginFactoryName[t]}`})),pluginCompletedInTime:(e,{pluginName:t,logInfo:r})=>i.ulsLogger.ULS.traceTag(553734790,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,F(e,"pluginCompletedInTime",{description:`plugin completed in time. plugin name:${t}`,data:r})),computationStoppedExecution:(e,{computationName:t,stopReason:r,logInfo:n})=>i.ulsLogger.ULS.traceTag(509109120,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,F(e,"pluginStoppedExecution",{data:{computationName:t,stopReason:r,...n}})),closeComputationFrame:(e,t)=>i.ulsLogger.ULS.traceTag(553734789,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,F(e,"closeUIMessageFrame",{data:t})),nullCheckViolation:(e,t)=>i.ulsLogger.ULS.traceTag(507803776,o.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,F(e,"nullCheckViolation",{data:t})),failure:(e,{failureKind:t,failureLevel:r,path:n,description:a,data:s})=>i.ulsLogger.ULS.traceTag(507322970,o.LogCategory.msoulscat_ES_EWAJS,r,F(e,n,{description:a,data:{failureKind:t,failureLevel:r,...s}}))},b={trackableAsyncLazy:{},snapshotCreation:{numSnapshots:0,numFreshSnapshots:0},beginRequest:{},requestSkipped:{},registerPluginFactory:{factories:[]},pluginCompletedInTime:{},computationStoppedExecution:{computationsStopReason:{},requestDurationHistograms:{},requestDurationHistogramByComputationKind:{},schedulerTimeSamples:[],computationTimeSamples:[]},closeComputationFrame:{},nullCheckViolation:{},failure:{}},C={trackableAsyncLazy:(e,{name:t,result:r})=>({...e,[t]:{numCalls:(e[t]?.numCalls??0)+1,totalSyncTime:(e[t]?.totalSyncTime??0)+("Success"===r.kind?r.value.syncTime:0),totalAsyncTime:(e[t]?.totalAsyncTime??0)+("Success"===r.kind?r.value.asyncTime:0),totalFailures:(e[t]?.totalAsyncTime??0)+("Failure"===r.kind?1:0)}}),snapshotCreation:({numSnapshots:e,numFreshSnapshots:t},r)=>({numSnapshots:e+1,numFreshSnapshots:t+(r?1:0)}),beginRequest:(e,{computationKind:t})=>({...e,[t]:(e[t]??0)+1}),requestSkipped:(e,{computationKind:t})=>({...e,[t]:(e[t]??0)+1}),registerPluginFactory:({factories:e},{factoryName:t})=>({factories:[...e,u.PluginFactoryName[t]]}),pluginCompletedInTime:(e,{pluginName:t})=>({...e,[t]:(e[t]??0)+1}),computationStoppedExecution:({computationsStopReason:e,requestDurationHistograms:t,requestDurationHistogramByComputationKind:r,schedulerTimeSamples:n,computationTimeSamples:a},{computationName:i,stopReason:o,logInfo:{computationKind:s,requestTimes:u,computationTime:l,schedulerTime:c}})=>({computationsStopReason:{...e,[`${s}.${i}`]:{...e[`${s}.${i}`],[o]:(e[`${s}.${i}`]?.[o]??0)+1}},requestDurationHistograms:(0,d.updateDurationHistogramsWithRequestTimes)(t,u),requestDurationHistogramByComputationKind:{...r,[`${s}.${i}`]:(0,d.updateDurationHistogramsWithRequestTimes)(r[`${s}.${i}`]??{},u)},schedulerTimeSamples:(0,d.addSampleWithProbability)(n,c,5e-4),computationTimeSamples:(0,d.addSampleWithProbability)(a,l,5e-4)}),closeComputationFrame:(e,t)=>({...e,[t.computationKind]:{...e[t.computationKind],[t.stopReason]:(e[t.computationKind]?.[t.stopReason]??0)+1}}),nullCheckViolation:(e,{requestKind:t,violations:r})=>({...e,[t]:{...e[t],[r.join(";")]:(e[t]?.[r.join(";")]??0)+1}}),failure:(e,{failureKind:t,failureLevel:r})=>({...e,[t]:{...e[t],[r]:(e[t]?.[r]??0)+1}})};class A{log(e,t){this.isMessageForAnotherLogger(t)||((0,l.getTypedFeatureGate)("Microsoft.Office.Excel.EnableFullSessionLogging")||"failure"===e.kind)&&y[e.kind](this.threadId,e.payload)}flush(){}flushBufferedMessages(){return[]}get threadId(){return this._threadId}set threadId(e){this._threadId=e}isMessageForAnotherLogger(e){return(0,n.isDefined)(e)&&e!==S.Immediate}constructor(){this._threadId=h,this.formatLogMessage=(e,t)=>F(this.threadId,e,t)}}t.ImmediateLogger=A;class E{log(e,t){this.isMessageForAnotherLogger(t)||(this.shouldBufferLogMessages()?((0,g.staticTypeHint)(e),this.logMessageBuffer.push([e,S.Aggregating])):(this.loggingStates[e.kind]=C[e.kind](this.loggingStates[e.kind],e.payload),this.periodicFlush(e.kind)))}flush(){if(this.shouldBufferLogMessages())return;const{requestDurationHistogramByComputationKind:e}=this.loggingStates.computationStoppedExecution;this.loggingStates.computationStoppedExecution.requestDurationHistogramByComputationKind={};const t=this.formatLogMessage("AgggregationLogger.flush",{description:"summary logs for session",data:this.loggingStates}),r=this.formatLogMessage("AgggregationLogger.flush",{description:"request duration histogram by computation kind",data:e});if(f&&this.threadId===h){const e=(0,m.getTelemetryLogger)();e.sendTelemetryEvent((0,d.createX10AggregatedTelemetryEvent)(t)),e.sendTelemetryEvent((0,d.createX10RequestPerformanceEvent)(r))}}periodicFlush(e){"closeComputationFrame"===e&&(this.closeComputationFrameCount++,this.closeComputationFrameCount>=this.nextFlushThreshold&&(this.nextFlushThreshold*=1.33,this.flush()))}flushBufferedMessages(){const e=this.logMessageBuffer;return this.logMessageBuffer=[],e}get threadId(){return this._threadId}set threadId(e){this._threadId=e}shouldBufferLogMessages(){return p&&this.threadId!==h}isMessageForAnotherLogger(e){return(0,n.isDefined)(e)&&e!==S.Aggregating}constructor(){this.loggingStates={...b},this._threadId=h,this.logMessageBuffer=[],this.closeComputationFrameCount=0,this.nextFlushThreshold=4,this.formatLogMessage=(e,t)=>F(this.threadId,e,t)}}class T{log(e,t){this.immediateLogger.log(e,t),this.aggregatingLogger.log(e,t)}flush(){this.immediateLogger.flush(),this.aggregatingLogger.flush()}flushBufferedMessages(){return[...this.immediateLogger.flushBufferedMessages(),...this.aggregatingLogger.flushBufferedMessages()]}get threadId(){return this._threadId}set threadId(e){this._threadId=e,this.immediateLogger.threadId=e,this.aggregatingLogger.threadId=e}constructor(){this._threadId=h,this.immediateLogger=new A,this.aggregatingLogger=new E,this.formatLogMessage=(e,t)=>F(this.threadId,e,t)}}t.CombinedLogger=T,t.x10Logger=new T},3438:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Test=t.testingCGOverrides=t.GateOverrideManager=t.runQueueProcessorUntil=t.VisitorHelpers=t.RangeHelpers=t.TimelineQueueProcessor=t.defaultTimerInterface=t.resolveScriptLoaderPromise=t.setX10Features=t.ensurePluginAttached=t.ensureGroupAttachedLegacy=t.ensureGroupAttached=t.spanToLSPRange=t.ValuePreviewResultExtractor=t.PluginRegistry=t.ALAnnotationKind=t.EventKind=t.ExecutionType=t.ComputationType=t.NotificationKind=t.RequestKind=t.delay=t.wrapIntoAsync=t.awaitPromise=t.typedRequest=t.PluginRequestKind=t.ComputationRequestKind=t.stableDynamicPluginLoaderInsideInit=t.DefaultComputationGroup=t.registerPluginFactory=t.PluginFactoryName=t.PluginGroup=t.MockTimerImmediate=t.setMockGridSheetAndNotify=t.createMockGridExporter=t.createMockGridProvider=t.createMockAsyncGrid=t.RecalcSideGrid=t.FormulaKind=t.GridImportManagerSingleton=t.PluginSchedulerSingleton=t.getSchedulerFactories=t.defaultPluginResponseWindows=t.ChatGPTPlugin=t.staticTypeHint=t.platform=void 0;const n=r(3345),a=n.__importStar(r(4636)),i=n.__importStar(r(1861)),o=n.__importStar(r(3127)),s=n.__importStar(r(1206)),u=n.__importStar(r(3166)),l=n.__importStar(r(3942)),c=n.__importStar(r(115)),d=n.__importStar(r(8338)),g=n.__importStar(r(8308)),m=n.__importStar(r(2559)),h=n.__importStar(r(5405)),p=n.__importStar(r(3991)),f=n.__importStar(r(3423)),S=n.__importStar(r(9749)),v=n.__importStar(r(9367)),F=n.__importStar(r(1339)),y=n.__importStar(r(9313)),b=n.__importStar(r(8206)),C=n.__importStar(r(5235)),A=n.__importStar(r(7630)),E=n.__importStar(r(9293)),T=n.__importStar(r(1811)),R=n.__importStar(r(6332)),k=n.__importStar(r(5480)),N=n.__importStar(r(9626));var I=r(7346);Object.defineProperty(t,"platform",{enumerable:!0,get:function(){return I.platform}}),t.staticTypeHint=a.staticTypeHint,t.ChatGPTPlugin=S.ChatGPTPlugin,t.defaultPluginResponseWindows=F.defaultPluginResponseWindows,t.getSchedulerFactories=i.getSchedulerFactories,t.PluginSchedulerSingleton=i.PluginSchedulerSingleton,t.GridImportManagerSingleton=i.GridImportManagerSingleton,t.FormulaKind=d.FormulaKind,t.RecalcSideGrid=h.RecalcSideGrid,t.createMockAsyncGrid=o.createMockAsyncGrid,t.createMockGridProvider=o.createMockGridProvider,t.createMockGridExporter=o.createMockGridExporter,t.setMockGridSheetAndNotify=o.setMockGridSheetAndNotify,t.MockTimerImmediate=s.MockTimerImmediate,t.PluginGroup=A.PluginGroup,t.PluginFactoryName=A.PluginFactoryName,t.registerPluginFactory=u.registerPluginFactory,t.DefaultComputationGroup=l.DefaultComputationGroup,t.stableDynamicPluginLoaderInsideInit=i.dynamicPluginLoaderInsideInit,t.ComputationRequestKind=l.ComputationRequestKind,t.PluginRequestKind=l.ComputationRequestKind,t.typedRequest=l.typedRequest,t.awaitPromise=l.awaitPromise;var O=r(6366);Object.defineProperty(t,"wrapIntoAsync",{enumerable:!0,get:function(){return O.wrapIntoAsync}}),t.delay=l.delay,t.RequestKind=F.RequestKind,t.NotificationKind=c.NotificationKind,t.ComputationType=b.ComputationType,t.ExecutionType=C.ExecutionType,t.EventKind=v.EventKind,t.ALAnnotationKind=v.ALAnnotationKind,t.PluginRegistry=y.PluginRegistry,t.ValuePreviewResultExtractor=p.ValuePreviewResultExtractor,t.spanToLSPRange=g.spanToLSPRange,t.ensureGroupAttached=m.ensureGroupAttached,t.ensureGroupAttachedLegacy=m.ensureGroupAttachedLegacy,t.ensurePluginAttached=m.ensurePluginAttached,t.setX10Features=m.setX10Features,t.resolveScriptLoaderPromise=m.resolveScriptLoaderPromise,t.defaultTimerInterface=f.defaultTimerInterface,t.TimelineQueueProcessor=f.TimelineQueueProcessor,t.RangeHelpers=E,t.VisitorHelpers=T,t.runQueueProcessorUntil=R.runQueueProcessorUntil,t.GateOverrideManager=k.GateOverrideManager,t.testingCGOverrides=k.testingCGOverrides,t.Test=N},9777:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;const r={},n="promises";t.promises=function(){return void 0===r[n]&&(r[n]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),r[n]}},1639:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){const e=new Uint8Array(31),t=function(e){const t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof crypto?crypto:"undefined"!=typeof msCrypto?msCrypto:void 0;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push(`crypto: ${JSON.stringify(e)}`)}}let n=!1;const a="undefined"!=typeof performance?performance:void 0;try{a&&a.now&&a.now()!==1/0&&(n=!0)}catch(e){t.exceptions.push(`perfNow: ${JSON.stringify(e)}`)}for(let r=0;r<e.length;r+=1){try{if(n){t.perfNow=!0;let e=Math.floor(100*a.now())%10;(e<0||e>9)&&(e=0);for(let t=0;t<e;t+=1)Math.random()}}catch(e){t.exceptions.push(`Math.random: ${JSON.stringify(e)}`)}e[r]=Math.floor(16*Math.random())}return t}(e);let r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},4257:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=e=>{if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=e=>!!e.replaceChildren},4068:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.replaceChildren=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;const n=r(5357);t.utils=n;const a=r(6970);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return a.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return a.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return a.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return a.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return a.ConsoleLogger}});const i=r(9777);t.browserSupport=i;const o=r(2810);t.perfWatch=o;const s=r(4843);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return s.initStopwatchFactory}});const u=r(352);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return u.TelemetryCollector}});var l=r(1639);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return l.getNewGuid}});var c=r(5298);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return c.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return c.TextAreaInputMode}});var d=r(4257);Object.defineProperty(t,"replaceChildren",{enumerable:!0,get:function(){return d.replaceChildren}})},6970:function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(t.TraceLevel=r={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(n||(t.LogCategory=n={})),t.ULS={getFromExternalLogger:function(e){const t=e;return{ULS:{trace:(e,r,n)=>t.traceTag(0,e,r,n),traceTag:(e,r,n,a)=>t.traceTag(e,r,n,a),debugTrace:(e,r,n)=>t.debugTraceTag(0,e,r,n),debugTraceTag:(e,r,n,a)=>t.debugTraceTag(e,r,n,a),assert:(e,r,n)=>t.assertTag(0,e,r,n),assertTag:(e,r,n,a)=>t.assertTag(e,r,n,a),shipAssert:(e,r,n)=>t.shipAssertTag(0,e,r,n),shipAssertTag:(e,r,n,a)=>t.shipAssertTag(e,r,n,a),dnmTrace:(e,r,n)=>t.dnmTraceTag(0,e,r,n),dnmTraceTag:(e,r,n,a)=>t.dnmTraceTag(e,r,n,a)}}}},t.ConsoleLogger=class{shipAssertTag(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)}assertTag(e,t,r,n){console.assert(r,"assertTag",e,t,n)}traceTag(e,t,r,n){console.log("traceTag",e,n,t,r)}dnmTraceTag(e,t,r,n){console.log("dnmTraceTag",e,n,t,r)}debugTraceTag(e,t,r,n){console.log("debugTraceTag",e,n,t,r)}},t.NulLogger=class{shipAssertTag(){}assertTag(){}traceTag(){}debugTraceTag(){}dnmTraceTag(){}}},2810:function(e,t){"use strict";function r(){const e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function n(e,t,n){e[t]=r()-n}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){const t=r(),a=e,i=t,o={},s=(e,t,r)=>function(e,t,r,a,i,o){n(e,"end",r);const s={sessionName:t,result:a?"success":"failure",message:o,marks:e};i(JSON.stringify(s))}(o,a,i,e,t,r);return o.start=0,{mark:e=>(e=>n(o,e,i))(e),end:e=>s(!0,e),success:(e,t)=>s(!0,e,t),failure:(e,t)=>s(!1,e,t)}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=r},5298:function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(r||(t.TextAreaVirtualKeyboardPolicy=r={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(n||(t.TextAreaInputMode=n={}))},4843:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;let r=()=>Date.now();t.initStopwatchFactory=function(e,t=1){return"undefined"!=typeof self&&self.performance&&self.performance.now&&(r=()=>self.performance.now()),function(n){let a=r(),i=n;return{reset(e){null!=e&&(i=e),a=r()},stop(n){const o=r()-a,s=JSON.stringify({Target:i,Duration:o.toFixed(t),StopInfo:n});e(s)}}}}},352:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0,t.TelemetryCollector=class{getJsonForLogging(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"}addEvent(e,t){null!=e&&null!=t&&(this.events[e]=t)}clearEvents(){this.events={}}getEventsLoggableString(){return JSON.stringify(this.events)}incrementCounter(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)}getCountersLoggableString(){return JSON.stringify(this.counters)}clearCounters(){this.counters={}}startTimer(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})}endTimer(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)}getTimerDuration(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"}getTimersLoggableString(){return JSON.stringify(this.timers)}constructor(){this.counters={},this.timers={},this.events={}}}},5357:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce(((e,n)=>e.then((()=>r&&r.stop?Promise.resolve(void 0):t(n,r)))),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(n(e))}catch{return t.defaultToJSONResultWhenStringifyFails}};const r=5;function n(e,t=0){if(t<0||t>r)return e;if(null==e||"object"!=typeof e)return e;const a={};Object.getOwnPropertyNames(e).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(a[t]=e[t])}));const i=Object.getPrototypeOf(e);i&&"object"==typeof i&&Object.keys(i).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(a[t]=e[t])}));const o={};return Object.keys(a).forEach((e=>{o[e]=n(a[e],t+1)})),o}const a=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";let t=e.trim().substring(0,200).trim().replace(a,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error(`utils.retry: attempts expected to be greater than 0 but got ${t}`));let r=Promise.reject();for(let n=1;n<=t;n+=1)r=r.catch((t=>e(n,t)));return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();let r=t(e[0]);for(let n=1;n<e.length;n+=1){const a=e[n];r=r.catch((()=>t(a)))}return r},t.getQueryParameterByName=function(e,t){const r=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;let t=5381,r=t;const n=e.length;for(let a=0;a<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(a)),a!==n-1);a+=2)r=4294967295&((r<<5)+r^e.charCodeAt(a+1));let a=t+35685*r+(23896*r<<16)&4294967295;return a<0&&(a+=4294967296),a}},531:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stackSave=t.stackRestore=t.stackAlloc=t.setThrew=t.memory=t._start=t.__growWasmMemory=t.__errno_location=t.Mathpack_Zero=t.Mathpack_ViewRound=t.Mathpack_Trunc=t.Mathpack_TenTo=t.Mathpack_Tan=t.Mathpack_TakeMathError=t.Mathpack_Sub=t.Mathpack_Sqrt=t.Mathpack_Sin=t.Mathpack_SFloat=t.Mathpack_SFix=t.Mathpack_RoundUp=t.Mathpack_RoundDown=t.Mathpack_Round=t.Mathpack_Power=t.Mathpack_Pi=t.Mathpack_Pack=t.Mathpack_One=t.Mathpack_Neg=t.Mathpack_Mul=t.Mathpack_Mod=t.Mathpack_Log=t.Mathpack_Ln=t.Mathpack_LFix=t.Mathpack_GetExp32=t.Mathpack_FormatScientific=t.Mathpack_FormatGetSign=t.Mathpack_FormatGetExponent=t.Mathpack_FormatGeneral=t.Mathpack_FormatFixed=t.Mathpack_Floor=t.Mathpack_Float=t.Mathpack_Fix=t.Mathpack_Exp=t.Mathpack_Equal=t.Mathpack_Div=t.Mathpack_Cos=t.Mathpack_Cond2=t.Mathpack_Cond=t.Mathpack_Compare=t.Mathpack_Ceil=t.Mathpack_Atan2=t.Mathpack_Atan=t.Mathpack_Asin=t.Mathpack_Add=t.Mathpack_Acos=t.Mathpack_Abs=t.Dtr_Yr=t.Dtr_Write=t.Dtr_Wdy=t.Dtr_UtcToLocal=t.Dtr_ToTime=t.Dtr_ToNumWithDuration=t.Dtr_ToNum=t.Dtr_ToDays=t.Dtr_Sec=t.Dtr_Rounding=t.Dtr_Mon=t.Dtr_Min=t.Dtr_Hour=t.Dtr_FromNum=t.Dtr_FracSec=t.Dtr_DaysPerMonth=t.Dtr_Days=t.Dtr_DOM=t.Base_StrBufSize=t.Base_StrBuf=void 0;var n=r(6538),a=r(6389),i=r(7325),o=new ArrayBuffer(8),s=new Int32Array(o),u=(new Float32Array(o),new Float64Array(o));function l(e){return s[e]}function c(e,t){s[e]=t}function d(){return u[0]}function g(e){u[0]=e}var m,h=new ArrayBuffer(65536),p=(m=new Uint8Array(h),function(e,t){var r,n;if("undefined"==typeof Buffer)for(r=atob(t),n=0;n<r.length;n++)m[e+n]=r.charCodeAt(n);else for(r=Buffer.from(t,"base64"),n=0;n<r.length;n++)m[e+n]=r[n]});p(1024,"yAwAAAEAAAACAAAAAwAAAAAAAAAE"),p(1056,"AQAAAAsAAAANAAAABwAAAAkAAAADAAAABQAAAA8AAAAAAAEAMAACADkAMQAcAAMAPQA6ADIAKgAmAB0AEQAEAD4ANwA7ACQANQAzACsAFgAtACcAIQAeABgAEgAMAAUAPwAvADgAGwA8ACkAJQAQADYAIwA0ABUALAAgABcACwAuABoAKAAPACIAFAAfAAoAGQAOABMACQANAAgABwAGAJAMAACYDAAAoAwAAKgMAAAfHR8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHR8eHx4fHx4fHh8="),p(1312,"WAwAAHAMAABoDAAAeAw="),p(1359,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsAAAAAHwA8AFsAeQCYALYA1QD0ABIBMQFPAW4B"),p(1759,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwAAAAAAHwA7AFoAeACXALUA1ADzABEBMAFOAW0B"),p(2135,"oAQ="),p(2151,"yAc="),p(2167,"+go="),p(2182,"QJwO"),p(2198,"UMMR"),p(2214,"JPQU"),p(2229,"gJaYGA=="),p(2245,"ILy+Gw=="),p(2261,"KGvuHg=="),p(2277,"+QKVIg=="),p(2292,"QLdDuiU="),p(2308,"EKXU6Cg="),p(2324,"KueEkSw="),p(2339,"gPQg5rUv"),p(2355,"oDGpX+My"),p(2371,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//w=="),p(3126,"kEEYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/"),p(3182,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQAAsOlNYnBCBAQAABAE"),p(3904,"4E8=");var f=function(e,t,r){var n=new e.Int8Array(r),a=new e.Int16Array(r),i=new e.Int32Array(r),o=new e.Uint8Array(r),u=new e.Uint16Array(r),m=new e.Uint32Array(r),h=(new e.Float32Array(r),new e.Float64Array(r)),p=e.Math.imul,f=(e.Math.fround,e.Math.abs),S=e.Math.clz32,v=e.Math.min,F=(e.Math.max,e.Math.floor),y=e.Math.ceil,b=e.Math.sqrt,C=t.abort,A=(e.NaN,e.Infinity,t.Base_LocaleIsNumeral),E=t.Base_LocaleGetOrdinal,T=t.Base_LocaleDecimalSeparator,R=t.Math_log10,k=t.Math_log,N=(b=t.Math_sqrt,t.Math_sin),I=t.Math_cos,O=t.Math_tan,P=t.Math_atan,M=t.Math_exp,D=t.proc_exit,w=t.getTempRet0,L=20288,_=0;function x(){}function K(e,t,r){e:if(e>>>0<=t>>>0){if(!r)break e;for(;n[0|e]=o[0|t],e=e+1|0,t=t+1|0,r=r+-1|0;);}else if(r)for(e=e+r|0,t=t+r|0;t=t+-1|0,n[0|(e=e+-1|0)]=o[0|t],r=r+-1|0;);}function W(e,t){var r,s,c=0,d=0,m=0,p=0;if(d=3856,L=r=L-48|0,i[r+40>>2]=0,a[r+30>>1]=0,a[r+32>>1]=0,h[482]=e,s=z(e),h[482]=s,ye(s,r+40|0,r,15),u[r+42>>1]){c=(0|(c=ge(t)<<16))<0?100:c>>16,g(+t),m=0|l(1),l(0),(p=-65536&m)&&(2146435072!=(2146435072&m)?c=(0|p)<1?0-c|0:c:i[966]=1);e:{if(!((0|(c=a[r+40>>1]+c|0))>=a[r+42>>1])){if((0|c)<1){d=3168;break e}(255&c)>>>0>=o[r+30|0]||(n[r+30|0]=c)}Fe(3276,3856,r)}e=h[d>>3]}return L=r+48|0,e}function U(e,t){var r,n=0,a=0,o=0;if(h[482]=e,g(+e),a=0|l(1),l(0),o=a,a=0,(n=-65536&o)&&(2146435072!=(2146435072&o)?a=(0|n)<1:(i[966]=1,a=0)),i[965]=2147483647&o,re(h[395]),n=-65536&(o=i[965]))if(2146435072!=(2146435072&o)){if(!((0|n)<1))return Q(8),0}else i[966]=1;r=ne(h[395],e),Ae(h[393],r),ae(r),pe();e:{t:{if((n=i[965])>>>0>=65536){if(2146435072!=(2146435072&n))break t;i[966]=1}if(t){if(i[964]=0,i[965]=0,!a)break e;return t=i[783],i[964]=i[782],i[965]=t,h[482]}if(n=i[789],i[964]=i[788],i[965]=n,t=n,1^a|n>>>0<65536)break e;return i[965]=-2147483648^t,h[482]}Re(e),fe(),t&&(h[482]=ne(h[394],h[482]))}return h[482]}function G(e,t,r,n){var s,l=0,c=0,d=0,g=0,m=0,h=0,f=0;if(l=i[e+4>>2],m=-2146827284,!((0|(s=(c=u[e>>1])+(e=(0|(d=a[e+2>>1]))>=1?(d+-1|0)/12|0:(0|d)/-12^-1)<<16>>16))>9999|((r?1900:-9999)+(t?4:0)|0)>(0|s)||((d=d+p(e,-12)<<16>>16)-1&65535)>>>0>11|(!l|1900==(0|s)&2==(0|d)&29==(0|l)?!r:0))){if(h=(0|(e=(g=(0|(c=s+1e4|0))/4|0)<<2))%100|0,f=(0|e)%400|0,l=(((g=p(g,1461)+l|0)+((0|(l=e+-1|0))/-100|0)|0)+((0|l)/400|0)|0)-1|0,c=(p(c-e|0,12)+d|0)-1|0)for(c=c+(e=f?h?0:12:0)|0;l=o[e+1232|0]+l|0,(0|c)!=(0|(e=e+1|0)););e:if(r||t){if(e=l+-4346385|0,!((0|s)>1900|(0|d)>=3))break e;e=l+-4346384|0}else e=l+-4346384|0;e>>>0>2958465||(i[n>>2]=e,m=0)}return m}function B(e,t,r){var n,s,u,l=0,c=0,d=0;c=d=Pe(e,t,711573504,201),i[r+28>>2]=(c+1>>>0)%7,l=c+p(n=(c>>>0)/146097|0,-146097)|0,s=(p(l,100)+75>>>0)/3652425|0,l=((u=p(s,-36524)+l|0)>>>0)/1461|0,c=(((c+(((l=((p(s,100)+p(n,400)|0)+(l<<2)|0)+((p(u+p(l,-1461)|0,100)+75>>>0)/36525|0)|0)>>>0)/100|0)|0)-(l>>>2)|0)-((l>>>0)/400|0)|0)+p(l,-365)|0,d=Oe(d,_,-864e5,-1),e=Pe(e,t,1e4,0)+d|0,d=!(((t=l+1|0)>>>0)%100)|3&t&&(t>>>0)%400|0?2096+((t=o[c+1728|0])<<1)|0:1696+((t=o[c+1328|0])<<1)|0,i[r+12>>2]=(e>>>0)/36e5,i[r+4>>2]=t+1,i[r>>2]=l+1601,t=(e>>>0)/1e3|0,i[r+20>>2]=(t>>>0)%60,i[r+16>>2]=((e>>>0)/6e4>>>0)%60,i[r+24>>2]=e-p(t,1e3),i[r+8>>2]=1+(c-a[d>>1]|0)}function V(e,t){var r=0,n=0,o=0,s=0,u=0,l=0,c=0,d=0,g=0,m=0,h=0,f=0;return(0|(s=i[e+4>>2]))<1||(d=s+-1|0)>>>0>11||(n=(r=i[e>>2])+-1601|0)>>>0>29226||(0|(u=i[e+8>>2]))<1||(o=1696,((l=65535&r)>>>0)%400&&(o=3&r?2096:(l>>>0)%100|0?1696:2096),(g=i[e+24>>2])>>>0>999||(l=i[e+20>>2])>>>0>59||(m=i[e+16>>2])>>>0>59||(h=i[e+12>>2])>>>0>23||(u=u+-1|0)>>>0>=a[o+(s<<1)>>1]-a[o+(d<<1)>>1]>>>0||(o=n>>>2,s=p(n,365),n=((e=65535&n)>>>0)/400|0,f=(e>>>0)/100|0,((c=65535&(r=r+-1600|0))>>>0)%400&&(e=2096,!((c>>>0)%100)|3&r)||(e=1696),c=1,r=(r=p(p(p(h,60)+m|0,60)+l|0,1e3)+g|0)+(n=Oe(e=a[(d<<1)+e>>1]+(n+((u+(s+o|0)|0)-f|0)|0)|0,e>>31,864e5,0))|0,e=_,i[t>>2]=Oe(r,r>>>0<n>>>0?e+1|0:e,1e4,0),i[t+4>>2]=_)),c}function j(e,t,r,n){var a,o=0,s=0,u=0,l=0;L=a=L-112|0,B(r,n,a+80|0);e:{if(i[e>>2]){if(!V(e,t))break e}else{if((0|(s=i[e+8>>2]))>5|!s)break e;if(r=i[e+4>>2],n=i[e+28>>2],o=i[a+80>>2],i[a+56>>2]=1,i[a+52>>2]=r,i[a+48>>2]=o,i[a+60>>2]=i[e+12>>2],i[a+64>>2]=i[e+16>>2],i[a+68>>2]=i[e+20>>2],e=i[e+24>>2],i[a+76>>2]=0,i[a+72>>2]=e,!V(a+48|0,a+8|0)){o=0;break e}e=n+8|0,r=n+1|0,u=(0|s)<2,B(i[a+8>>2],i[a+12>>2],a+16|0),l=a;t:{if((0|n)<(0|(o=i[a+44>>2])))e=e-o|0;else{if(e=1,(0|n)<=(0|o))break t;e=r-o|0}i[l+56>>2]=e}t:if(!u&&(r=e+7|0,i[a+56>>2]=r,o=1,V(a+48|0,a+8|0)))for(;;){if(B(i[a+8>>2],i[a+12>>2],a+16|0),e=i[a+24>>2],(0|s)==(0|(o=o+1|0)))break t;if(r=r+7|0,i[a+56>>2]=r,!V(a+48|0,a+8|0))break}if(i[a+56>>2]=e,!V(a+48|0,a+8|0)){o=0;break e}e=i[a+12>>2],i[t>>2]=i[a+8>>2],i[t+4>>2]=e}o=1}return L=a+112|0,o}function H(e,t,r){var n,o=0,s=0,l=0,c=0,d=0;if(L=n=L-16|0,r&&(l=r>>31,l^=l+r))for(r=(0|r)>0?2112:2608;(o=15&l)&&(s=a[8+(o=(o<<4)+r|0)>>1],d=q(h[e>>3],h[o>>3],n),t=t+s|0,a[n+14>>1]<=0?(o=u[n+6>>1],s=u[n+8>>1]):(s=i[n+4>>2],o=u[n+6>>1]<<1,a[n+6>>1]=o,c=i[n+8>>2],i[n+12>>2]=i[n+12>>2]<<1|c>>>31,s=c<<1|s>>>31,i[n+8>>2]=s,t=t+-1|0),(65535&o|1&s|0!=(0|d))>>>0<32769||(s=(o=i[n+8>>2])+1|0,i[n+8>>2]=s,s>>>0>=o>>>0||(s=(o=i[n+12>>2])+1|0,i[n+12>>2]=s,s>>>0>=o>>>0||(i[n+12>>2]=-2147483648,t=t+1|0))),o=i[n+12>>2],i[e>>2]=i[n+8>>2],i[e+4>>2]=o),r=r+240|0,l>>=4;);return L=n+16|0,t}function q(e,t,r){var n,i,o,s=0,u=0,c=0,d=0,m=0,h=0,f=0,S=0,v=0,F=0,y=0,b=0;return g(+t),d=0|l(1),m=65535&(u=0|l(0)),g(+e),F=0|l(1),s=0|l(0),c=F,i=p(S=65535&s,m),a[r>>1]=i,o=((65535&(y=p(v=s>>>16,m)))+(i>>>16)|0)+(65535&(f=p(u>>>=16,S)))|0,a[r+2>>1]=o,y=(((h=((65535&(s=p(n=65535&c,m)))+(y>>>16)|0)+(f>>>16)|0)+(65535&(f=p(u,v)))|0)+(65535&(b=p(F=65535&d,S)))|0)+(o>>>16)|0,a[r+4>>1]=y,f=(((((((65535&(h=p(d>>>=16,S)))+(s>>>16)|0)+(65535&(c=p(s=c>>>16,m)))|0)+(f>>>16)|0)+(b>>>16)|0)+(65535&(m=p(F,v)))|0)+(65535&(S=p(u,n)))|0)+(y>>>16)|0,a[r+6>>1]=f,v=((((((b=(c>>>16)+(h>>>16)|0)+(65535&(c=p(d,v)))|0)+(m>>>16)|0)+(S>>>16)|0)+(65535&(h=p(s,u)))|0)+(65535&(u=p(F,n)))|0)+(f>>>16)|0,a[r+8>>1]=v,h=((u=(((65535&(m=p(d,n)))+(c>>>16)|0)+(h>>>16)|0)+(u>>>16)|0)+(65535&(c=p(s,F)))|0)+(v>>>16)|0,a[r+10>>1]=h,s=(((65535&(d=p(s,d)))+(m>>>16)|0)+(c>>>16)|0)+(h>>>16)|0,a[r+12>>1]=s,a[r+14>>1]=(s>>>16)+(d>>>16),65535&(i|o|y)}function z(e){var t,r,n=0,a=0,o=0,s=0,u=0,c=0;return L=t=L-16|0,h[t+8>>3]=e,g(+e),n=0|l(1),a=0|l(0),r=n,(n&=2146435072)&&(i[t+8>>2]=a<<11,i[t+12>>2]=r<<11|a>>>21|-2147483648,s=(n=p(a=(n>>>20)-1022|0,39457)>>17)-14|0,o=H(t+8|0,a,14-n|0),a=i[t+8>>2],(0|o)>=(0|(m[t+12>>2]<(a>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47))||(o=H(t+8|0,o,1),a=i[t+8>>2],s=n+-15|0),n=s,s=(s=a)+(a=-2147483648>>>(31&o))|0,i[t+8>>2]=s,s>>>0>=a>>>0||(c=(u=i[t+12>>2])+1|0,i[t+12>>2]=c,c>>>0>=u>>>0||(i[t+12>>2]=-2147483648,o=o+1|0)),i[t+8>>2]=s&0-(a<<1),o=H(t+8|0,o,n),3071&(n=i[t+8>>2])?(a=n+1024|0,i[t+8>>2]=a,n>>>0<4294966272||(s=(n=i[t+12>>2])+1|0,i[t+12>>2]=s,o=(s>>>0<n>>>0)+o|0)):a=n,(0|o)<=-1023?(i[t+8>>2]=0,i[t+12>>2]=0):(0|(n=1071644672+(o<<20)|0))<=-1||(o=i[t+12>>2],i[t+8>>2]=o<<21|a>>>11,i[t+12>>2]=o>>>11&1048575|n|-2147483648&r),e=h[t+8>>3]),L=t+16|0,e}function Q(e){var t;return t=i[966],i[966]=e,t}function $(){var e,t,r;return e=i[964],t=i[965],ee(1048576),ee(2146435072),a[1931]<0?(i[964]=e,i[965]=t,-2147483648):(r=de(),i[964]=e,i[965]=t,-2147483648^r)}function Y(e){var t,r=0,n=0,a=0,i=0;if(g(+e),r=0|l(1),t=0|l(0),i=r,a=0,!((r=2047&(n=r>>>20))>>>0<1023||(a=e,r>>>0>1075))){if(n=-1<<(19-n&31),r>>>0>=1044)return c(0,n&t),c(1,0|i),+d();i&=n,c(0,0),c(1,0|i),a=+d()}return a}function J(e){var t=0,r=0,n=0;if(e+307>>>0<=615)return i[964]=0,i[965]=-2147483648,n=H(3856,1,e),r=i[964],e=i[965],3071&r&&(t=i[965],(e=i[964]+1024|0)>>>0<1024&&(t=t+1|0),i[964]=e,i[965]=t,r=e,e=t),i[964]=e<<21|r>>>11,void(i[965]=1071644672+(e>>>11&1048575|n<<20));(0|e)>=309&&(i[966]=1),i[964]=0,i[965]=0}function X(e,t,r,n){var o=0,s=0,l=0;e:{t:{r:{n:{if(!n){if(u[e>>1]<=52)break n;break t}if(!((0|n)<1)&&(0|n)<15)break r}return i[t>>2]=1,void(i[r>>2]=0)}if(u[(n<<1)+e>>1]<=52)break e;for(;;){if(l=u[(s=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[s>>1]=l,58!=(65535&l))break e;if(!(n=o))break}}return a[e>>1]=49,i[t>>2]=i[t>>2]+1,void(i[r>>2]=1)}for(;t=n,(0|n)>=2&&48==u[((n=t+-1|0)<<1)+e>>1];);i[r>>2]=t}function Z(){var e=0,t=0,r=0;e:{if(r=i[964],t=-65536&(e=i[965])){if(2146435072==(2146435072&e))return i[966]=1,void Se();if((0|t)<1)break e}return void Se()}Se(),(0|r)==i[964]&&i[965]==(0|e)||re(1)}function ee(e){h[482]=te(h[482],e)}function te(e,t){var r;return g(+(e+=t)),r=0|l(1),l(0),2146435072==(2146435072&r)&&(i[966]=1,e=h[396]),e}function re(e){h[482]=ne(h[482],e)}function ne(e,t){var r;return g(+(e-=t)),r=0|l(1),l(0),2146435072==(2146435072&r)&&(i[966]=1,e=h[396]),e}function ae(e){h[482]=ie(h[482],e)}function ie(e,t){var r,n=0,a=0,o=0;return g(+e*t),n=0|l(1),r=0|l(0),0|2146435072!=(0|(a=2146435072&n))?(o=(a=!(a|o))?i[792]:r,n=a?i[793]:n,c(0,0|o),c(1,0|n),+d()):(i[966]=1,n=i[793],c(0,i[792]),c(1,0|n),+d())}function oe(e){h[482]=se(h[482],e)}function se(e,t){var r=0,n=0,a=0,o=0;if(g(+t),r=0|l(1),l(0),2146435072&r){if(n=1,g(+e/t),r=0|l(1),a=0|l(0),!(!0&2146435072==(0|(o=2146435072&r))))return a=(n=!(0|o))?i[792]:a,r=n?i[793]:r,c(0,0|a),c(1,0|r),+d()}else n=4;return i[966]=n,r=i[793],c(0,i[792]),c(1,0|r),+d()}function ue(e){h[482]=e>>>0}function le(e){h[482]=0|e}function ce(){var e,t;e=+k(+h[482]),h[482]=e,g(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(i[966]=8)}function de(){return ge(h[482])}function ge(e){var t,r=0,n=0,a=0,i=0;return g(+e),i=1106247680==(0|(a=2146435072&(r=0|l(1))))&i>>>0<0|a>>>0<1106247680,t=r&=2147483647,c(0,0|(n=0|l(0))),c(1,0|r),(e=+d())<0x10000000000000000&e>=0?(a=f(e)>=1?e>0?~~v(F(e/4294967296),4294967295)>>>0:~~y((e-+(~~e>>>0>>>0))/4294967296)>>>0:0,r=~~e>>>0):(a=0,r=0),n=i?r:n,!(r=i?a:t)&n>>>0<4294967295|r>>>0<0?n:-1}function me(){return he(h[482])}function he(e){var t=0,r=0;return g(+e),t=0|l(1),l(0),r=1105199104==(0|(t&=2145386496))&r>>>0<0|t>>>0<1105199104,t=f(e)<2147483648?~~e:-2147483648,r?t:-2147483648}function pe(){var e,t;e=+b(+h[482]),h[482]=e,g(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(i[966]=8)}function fe(){var e,t;e=+P(+h[482]),h[482]=e,g(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(i[966]=8)}function Se(){h[482]=Y(h[482])}function ve(){var e,t;e=+M(+h[482]),h[482]=e,g(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(i[966]=1)}function Fe(e,t,r){return function(e,t,r){var n=0,s=0,c=0,d=0;if(n=o[r+30|0]){for(s=r;d=10*d+ +(0|we[i[i[e>>2]+4>>2]](e,u[s>>1])),s=s+2|0,c=(0|n)>1,n=n+-1|0,c;);if(g(+d),n=0|l(1),e=0|l(0),i[t>>2]=e<<11,i[t+4>>2]=2147481600&((2097151&n)<<11|e>>>21)|e>>>21|-2147483648,n=H(t,(n>>>20&2047)-1022|0,((32767&u[r+32>>1])-o[r+30|0]|0)-16384|0),3071&(s=i[t>>2])?(e=s+1024|0,i[t>>2]=e,s>>>0<4294966272||(c=(s=i[t+4>>2])+1|0,i[t+4>>2]=c,n=(c>>>0<s>>>0)+n|0)):e=s,!((0|n)<=-1022))return(0|(s=1071644672+(n<<20)|0))<0?1:(n=i[t+4>>2],i[t>>2]=n<<21|e>>>11,i[t+4>>2]=-2147483648&a[r+32>>1]|s|n>>>11&1048575,0)}return i[t>>2]=0,i[t+4>>2]=0,0}(e,t,r)}function ye(e,t,r,o){!function(e,t,r,o){var s,c,d=0,m=0,f=0,S=0,v=0,F=0,y=0,b=0,C=0,A=0;L=s=L-16|0,h[s+8>>3]=e,c=t,g(+e),m=0|l(1),f=0|l(0),S=d=m;e:if(m=2146435072&d){if(m=p(v=(m>>>20)-1022|0,39457)>>17,a[r+32>>1]=m+16385|d>>>16&32768,(0|o)<=14){if((0|(o=1+(o+m|0)|0))<=-1){n[r+30|0]=0,a[r+32>>1]=0,a[t+2>>1]=0,t=0;break e}o=(0|o)<15?o:15}if(i[s+8>>2]=f<<11,i[s+12>>2]=S<<11|f>>>21|-2147483648,(0|(d=H(s+8|0,v,-1^m)))>=1)for(f=r+32|0;m=u[f>>1],a[f>>1]=m+1&32767|32768&m,(0|(d=H(s+8|0,d,-1)))>0;);if(d?(m=(f=i[s+12>>2])>>>(S=0-d|0),i[s+12>>2]=m,d=f<<d+32|i[s+8>>2]>>>S,i[s+8>>2]=d):(d=i[s+8>>2],m=i[s+12>>2]),d=(f=m>>>0<(d>>>0<2576980377?429496730:429496729)>>>0?922:9223)+d|0,i[s+8>>2]=d,d>>>0<f>>>0&&(m=m+1|0,i[s+12>>2]=m),(0|o)<1)f=r;else{for(F=d>>>16,y=u[s+14>>1],b=r+32|0,A=15==(0|o),f=r,S=1;;){v=o;t:{r:{for(;;){if(o=p(F,10)+(p(65535&d,10)>>>16)>>>16,C=p(y,10)+(o+p(65535&m,10)>>>16)>>>16|48,a[f>>1]=C,y=(m=o+p(m,10)|0)>>>16,F=(d=p(d,10))>>>16,1&(-1^S|48!=(0|C)))break r;if(o=u[b>>1],a[b>>1]=o+-1&32767|32768&o,!A)break}S=1;break t}f=f+2|0,S=0}if(o=v+-1|0,!((0|v)>1))break}i[s+12>>2]=m,i[s+8>>2]=d}d=(o=f-r|0)>>1;t:{if((0|o)<=29){if((0|m)<=-1){a[f>>1]=57,m=d+1|0;break t}a[f>>1]=48}for(;;){if(m=d,(0|d)<1)break t;if(d=m+-1|0,48!=u[(f=f+-2|0)>>1])break}}n[r+30|0]=m,a[t+2>>1]=m,t=(32767&u[r+32>>1])-16384|0}else n[r+30|0]=0,a[r+32>>1]=0,a[t+2>>1]=0,t=0;a[c>>1]=t,L=s+16|0}(e,t,r,o)}function be(e,t,r,n){var a,o=0,s=0,u=0,l=0,c=0,d=0,g=0;c=i[t+4>>2],a=i[t>>2],l=u,u=i[e>>2],e=Oe(a,l,o=i[e+4>>2],t=0),s=_,o=Oe(l=c,c=0,o,t),t=_+d|0,t=(s=s+o|0)>>>0<o>>>0?t+1|0:t,o=s,d=t,t=Oe(l,c,s=u,0),l=(u=o)+(o=_)|0,u=d,u=l>>>0<o>>>0?u+1|0:u,o=0,d=Oe(a,g,s,c),e=(s=(g=_)+e|0)>>>0<g>>>0?o+1|0:o,c=t,s=t+s|0,t=e,e=l,l=t=s>>>0<c>>>0?t+1|0:t,(t=e+t|0)>>>0<l>>>0&&(u=u+1|0),i[r>>2]=t,i[r+4>>2]=u,i[n>>2]=d,i[n+4>>2]=s}function Ce(e){return ne(h[482],e)}function Ae(e,t){h[482]=ne(e,t)}function Ee(e){return ie(h[482],e)}function Te(e){return se(h[482],e)}function Re(e){h[482]=se(e,h[482])}function ke(e,t){h[482]=se(e,t)}function C(){D(1),C()}function Ne(e,t){var r,n;r=0|e,n=0|t,s[0]=r,s[1]=n}function Ie(e,t,r,n){var a=0,i=0,o=0,s=0,u=0,l=0,c=0,d=0,g=0,m=0;e:{t:{r:{n:{a:{i:{o:{s:{u:{l:{if(o=t){if(!(a=r))break l;if(!(i=n))break u;if((a=S(i)-S(o)|0)>>>0<=31)break s;break t}if(1==(0|n)&r>>>0>=0|n>>>0>1)break t;return Ne(e-p(t=(e>>>0)/(r>>>0)|0,r)|0,0),_=0,t}if(a=n,!e)break o;if(!a)break i;if((i=a+-1|0)&a)break i;return Ne(e,o&i),e=o>>>(31&De(a)),_=0,e}if(!((i=a+-1|0)&a))break a;l=0-(u=(S(a)+33|0)-S(o)|0)|0;break r}u=a+1|0,l=63-a|0;break r}return Ne(0,o-p(e=(o>>>0)/(a>>>0)|0,a)|0),_=0,e}if((a=S(a)-S(o)|0)>>>0<31)break n;break t}if(Ne(e&i,0),1==(0|a))break e;return n=e,e=31&(r=De(a)),32<=(63&r)>>>0?(a=0,e=t>>>e):(a=t>>>e,e=((1<<e)-1&t)<<32-e|n>>>e),_=a,e}u=a+1|0,l=63-a|0}if(i=t,g=e,o=31&(a=63&u),32<=(63&a)>>>0?(a=0,s=i>>>o):(a=i>>>o,s=((1<<o)-1&i)<<32-o|g>>>o),i=a,o=e,e=31&(a=63&l),32<=(63&a)>>>0?(a=o<<e,e=0):(a=(1<<e)-1&o>>>32-e|t<<e,e=o<<e),t=a,u)for(a=n+-1|0,(o=r+-1|0)>>>0<4294967295&&(a=a+1|0),l=a;a=i<<1|s>>>31,i=s<<1,g=a,a=(s=l-((o>>>0<(i|=t>>>31)>>>0)+a|0)|0)>>31,s=(d=i)-(i=r&(c=s>>31))|0,i=g-((n&a)+(d>>>0<i>>>0)|0)|0,a=t<<1|e>>>31,e=m|e<<1,t=0|a,d=0,m=c&=1,u=u+-1|0;);return Ne(s,i),_=(a=t<<1|e>>>31)|d,c|e<<1}Ne(e,t),e=0,t=0}return _=t,e}function Oe(e,t,r,n){return e=function(e,t,r,n){var a,i,o,s,u=0,l=0;return s=p(u=r>>>16,l=e>>>16),u=(65535&(l=((o=p(a=65535&r,i=65535&e))>>>16)+p(l,a)|0))+p(u,i)|0,e=(((p(t,r)+s|0)+p(e,n)|0)+(l>>>16)|0)+(u>>>16)|0,_=e,65535&o|u<<16}(e,t,r,n),e}function Pe(e,t,r,n){return e=function(e,t,r,n){var a=0,i=0;return r=Ie((e^=a=t>>31)-a|0,i=((i=t>>31)^t)-((e>>>0<a>>>0)+i|0)|0,(r^=e=n>>31)-e|0,((a=n>>31)^n)-((r>>>0<e>>>0)+a|0)|0),_=((e=(t^=n)>>31)^_)-(((r^=t>>=31)>>>0<t>>>0)+e|0)|0,r-t|0}(e,t,r,n),e}function Me(e,t,r,n){return Ie(e,t,r,n),t=0|("function"==typeof setTempRet0&&setTempRet0(s[1]),s[0]),e=0|w(),_=e,0|t}function De(e){return e?31-S(e+-1^e)|0:32}var we=[null,function(e,t){return 0!=(0|A(0|(t|=0)))|0},function(e,t){return 0|E(0|(t|=0))},function(e){return 0|T()},function(e,t){return(t|=0)-48|0},x];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return r}}}),Base_StrBuf:function(){return 3280},Base_StrBufSize:function(){return 255},Dtr_DaysPerMonth:function(e,t,r){return 0|function(e,t,r){var n=0;n=3&t;e:if(r){if(n|(0|t)<2100)break e;n=!((t>>>0)%100)&0!=((t>>>0)%400|0)}else n||(n=!((0|t)%100)&0!=((0|t)%400|0));return o[1232+(((p(n,12)+e|0)-1|0)%48|0)|0]}(e|=0,t|=0,0!=(0|(r|=0)))},Dtr_FromNum:function(e,t,r,n,s){return e=+e,t|=0,n|=0,s|=0,r=p(r|=0,20)+3792|0,a[r>>1]=0,t=function(e,t,r,n,s){var m=0,f=0,S=0,v=0,F=0,y=0,b=0,C=0,A=0;e:if(!u[e>>1]){if(h[482]=t,g(+t),m=0|l(1),S=0|l(0),y=m,A=-65536&m)if(2146435072!=(2146435072&m)){if(!((0|A)>=1))return-2147467259}else i[966]=1;F=i[812],v=-1;t:{if(!((0|m)<(0|(f=b=i[813]))||(v=1,(0|m)>(0|f)))){if((0|F)==(0|(f=S)))break t;v=f>>>0<F>>>0?-1:1}if(f=-2147467259,1==(0|((y&b)>-1?v:0-v|0)))break e}t:{if(F=i[814],b=f=i[815],v=-1,!((0|m)<(0|f)||(v=1,(0|m)>(0|b)))){if((0|S)==(0|F))break t;v=S>>>0<F>>>0?-1:1}if(F=v,-1==(0|((f&y)>-1?F:0-F|0)))return-2147467259}t:{r:{if(!(s|!A))if(2146435072!=(2146435072&m)){if((0|A)<1)break r}else i[966]=1;ee(h[i[1216+(r<<2)>>2]>>3]),C=h[482];break t}Z(),re(t),S=y=i[965],c(0,0|(m=i[964])),c(1,0|S),C=+d(),i[792]==(0|m)&&i[793]==(0|S)||(f=i[965])>>>0<65536||(i[965]=-2147483648^f,g(+(C=h[482])),S=0|l(1),m=0|l(0)),y=S,F=S,S=i[1216+(r<<2)>>2],b=i[S+4>>2],f=i[S>>2],v=-1;r:{if(!((0|F)<(0|(S=b))||(v=1,(0|F)>(0|S)))){if((0|m)==(0|f)){h[482]=t;break r}v=m>>>0<f>>>0?-1:1}if(F=v,h[482]=t,-1==(0|((y&b)>-1?F:0-F|0)))break t}re(h[395])}if(a[e+18>>1]=r,m=me(),f=-2147467259,!Q(0)){if(n){if((0|m)>2957003)break e;m=m+1462|0}else if(m+4346018>>>0>7304483)break e;if(a[e+14>>1]=1+((m+6|0)%7|0),!s|m)if(m){if((0|m)<=-1?(S=-4-((n=(-1^m)/1461|0)<<2)|0,f=1461+(p(n,1461)+m|0)|0):(S=(n=(m+-1|0)/1461|0)<<2,f=p(n,-1461)+m|0),!(s&&(0|S)<=199))if((0|(f=(((0|(n=S+-101|0))/100|0)-((0|n)/400|0)|0)+f|0))>=1462){m=3&(n=S+1900|0);t:if(s){if(m|(0|S)<200)break t;m=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else m||(m=!((0|n)%100)&0!=((0|n)%400|0));S=S+4|0,f=(12==(0|p(m,12))?-1460:-1461)+f|0}else(0|f)>0||(S=S+-4|0,f=f+1461|0);m=3&(n=S+1900|0);t:if(s){if(m|(0|S)<200)break t;m=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else m||(m=!((0|n)%100)&0!=((0|n)%400|0));for(m=y=p(m,12);s=m,m=m+1|0,(0|(f=(n=f)-o[s+1232|0]|0))>0;);s=((f=s)-((0|y)<(0|(s=s+-11|0))?y:s)>>>0)/12|0,a[e>>1]=1900+(s+S|0),a[e+2>>1]=(p(s,-12)+m|0)-y}else i[e>>2]=788331,n=30;else i[e>>2]=67436;if(i[e+4>>2]=n,h[482]=C,Se(),(n=i[965])>>>0>=65536&&(i[965]=-2147483648^n),ee(C),ae(h[400]),t=h[482],n=de(),a[e+8>>1]=n,ue(n<<16>>16),(n=i[965])>>>0>=65536&&(i[965]=-2147483648^n),ee(t),ae(h[401]),t=h[482],n=de(),a[e+10>>1]=n,ue(n<<16>>16),(n=i[965])>>>0>=65536&&(i[965]=-2147483648^n),ee(t),ae(h[401]),!r)return r=de(),a[e+16>>1]=0,a[e+12>>1]=r,0;t=h[482],n=de(),a[e+12>>1]=n,ue(n<<16>>16),(n=i[965])>>>0>=65536&&(i[965]=-2147483648^n),ee(t),ae(h[i[1312+(r<<2)>>2]>>3]),h[482]=z(h[482]),a[e+16>>1]=de(),f=0}}return f}(r,e,t,0!=(0|n),0!=(0|s)),i[966]=0,0|t},Dtr_Yr:function(e){return a[p(e|=0,20)+3792>>1]},Dtr_Mon:function(e){return a[p(e|=0,20)+3794>>1]},Dtr_DOM:function(e){return i[p(e|=0,20)+3796>>2]},Dtr_Hour:function(e){return a[p(e|=0,20)+3800>>1]},Dtr_Min:function(e){return a[p(e|=0,20)+3802>>1]},Dtr_Sec:function(e){return a[p(e|=0,20)+3804>>1]},Dtr_Wdy:function(e){return a[p(e|=0,20)+3806>>1]},Dtr_FracSec:function(e){return a[p(e|=0,20)+3808>>1]},Dtr_Rounding:function(e){return a[p(e|=0,20)+3810>>1]},Dtr_Write:function(e,t,r,n,o,s,u,l,c,d){e|=0,t|=0,r|=0,n|=0,o|=0,s|=0,u|=0,l|=0,c|=0,d=p(d|=0,20),a[d+3810>>1]=c,a[d+3808>>1]=l,a[d+3806>>1]=u,a[d+3804>>1]=s,a[d+3802>>1]=o,a[d+3800>>1]=n,i[d+3796>>2]=r,a[d+3794>>1]=t,a[d+3792>>1]=e},Dtr_ToNum:function(e,t,r){return e|=0,t|=0,r|=0,i[964]=0,i[965]=0,function(e,t,r){var n,o=0;L=n=L-16|0;e:{t:{r:{if((u[e+2>>1]+-32767&65535)>>>0>1){if(a[e+18>>1]>=1?(le(a[e+16>>1]),o=Te(h[i[1312+(a[e+18>>1]<<2)>>2]>>3]),le(a[e+12>>1]),ee(o)):le(a[e+12>>1]),o=Te(h[401]),le(a[e+10>>1]),ee(o),o=Te(h[401]),le(a[e+8>>1]),ee(o),o=Te(h[400]),!((0|G(e,t,r,n+12|0))<0)){if(e=i[n+12>>2],!t)break r;if(le(e+-1462|0),!((0|e)<1462)){if(!(t=-65536&(e=i[965])))break t;if(2146435072==(2146435072&e)){i[966]=1;break t}if((0|t)>=1)break t}}i[964]=0,i[965]=0}i[964]=0,i[965]=0,Q(8);break e}ue(e)}ee(o)}L=n+16|0}(p(e,20)+3792|0,0!=(0|t),0!=(0|r)),+h[482]},Dtr_ToNumWithDuration:function(e,t,r,n,o){return e|=0,t|=0,r|=0,n|=0,o|=0,i[964]=0,i[965]=0,function(e,t,r,n,o){var s,l=0;L=s=L-16|0;e:{t:{r:{if((u[e+2>>1]+-32767&65535)>>>0>1){n:if(a[e+18>>1]>=1){if(le(a[e+16>>1]),oe(h[i[1312+(a[e+18>>1]<<2)>>2]>>3]),l=h[482],2==(0|o)){h[482]=n,ee(l);break n}le(a[e+12>>1]),ee(l)}else 2!=(0|o)?le(a[e+12>>1]):h[482]=n;if(oe(h[401]),l=h[482],1!=(0|o)?le(a[e+10>>1]):h[482]=n,ee(l),oe(h[401]),l=h[482],o?le(a[e+8>>1]):h[482]=n,ee(l),oe(h[400]),n=h[482],!((0|G(e,t,r,s+12|0))<0)){if(e=i[s+12>>2],!t)break r;if(le(e+-1462|0),!((0|e)<1462)){if(!(t=-65536&(e=i[965])))break t;if(2146435072==(2146435072&e)){i[966]=1;break t}if((0|t)>=1)break t}}i[964]=0,i[965]=0}i[964]=0,i[965]=0,Q(8);break e}ue(e)}ee(n)}L=s+16|0}(p(e,20)+3792|0,0!=(0|t),0!=(0|r),+(0|o),n),+h[482]},Dtr_Days:function(){return i[963]},Dtr_ToDays:function(e,t,r){return t|=0,r|=0,0|G(p(e|=0,20)+3792|0,0!=(0|t),0!=(0|r),3852)},Dtr_ToTime:function(e,t,r){return function(e,t,r){h[482]=e,ee(h[i[1216+(r<<2)>>2]>>3]);e:{if(t>>>0<=1){if(t-1)break e}else ae(h[401]);ae(h[401])}ae(h[400]),Se()}(e=+e,t|=0,r|=0),+h[482]},Dtr_UtcToLocal:function(e,t,r,n,o,s,l,c){var d;return e|=0,t|=0,r|=0,n|=0,o|=0,s|=0,l|=0,c|=0,L=d=L-32|0,i[d+24>>2]=s,i[d+16>>2]=n,i[d+8>>2]=t,i[d+20>>2]=(0|o)>-1?p(o,20)+3792|0:0,i[d+12>>2]=(0|r)>-1?p(r,20)+3792|0:0,e=function(e,t,r,n){var o,s=0;return L=o=L-32|0,function(e,t,r){var n,o=0,s=0,l=0,c=0,d=0,g=0,m=0,h=0,f=0,S=0,v=0,F=0;if(L=n=L-96|0,i[n+64>>2]=a[t>>1],i[n+68>>2]=a[t+2>>1],i[n+72>>2]=i[t+4>>2],i[n+76>>2]=a[t+8>>1],i[n+80>>2]=a[t+10>>1],i[n+84>>2]=a[t+12>>1],i[n+92>>2]=a[t+14>>1]+-1,(o=a[t+18>>1])>>>0<=3){e:{t:switch(o-1|0){case 0:o=p(a[t+16>>1],100);break e;case 1:o=p(a[t+16>>1],10);break e;case 2:break t;default:break e}o=a[t+16>>1]}i[n+88>>2]=o}t=0;e:if(V(n- -64|0,n+40|0)){if(l=Oe(l=p(i[e>>2],60),l>>31,1e7,0),d=_,(s=i[e+4>>2])&&(c=i[e+12>>2])){if(i[n+64>>2]=a[s>>1],i[n+68>>2]=a[s+2>>1],i[n+72>>2]=i[s+4>>2],i[n+76>>2]=a[s+8>>1],i[n+80>>2]=a[s+10>>1],i[n+84>>2]=a[s+12>>1],i[n+92>>2]=a[s+14>>1]+-1,(o=a[s+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=p(a[s+16>>1],100);break t;case 1:o=p(a[s+16>>1],10);break t;case 2:break r;default:break t}o=a[s+16>>1]}i[n+88>>2]=o}if(i[n+8>>2]=a[c>>1],i[n+12>>2]=a[c+2>>1],i[n+16>>2]=i[c+4>>2],i[n+20>>2]=a[c+8>>1],i[n+24>>2]=a[c+10>>1],i[n+28>>2]=a[c+12>>1],i[n+36>>2]=a[c+14>>1]+-1,(o=a[c+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=p(a[c+16>>1],100);break t;case 1:o=p(a[c+16>>1],10);break t;case 2:break r;default:break t}o=a[c+16>>1]}i[n+32>>2]=o}if(c=s=i[n+44>>2],!j(n- -64|0,n+56|0,o=i[n+40>>2],s))break e;if(!j(n+8|0,n+48|0,o,c))break e;f=i[n+40>>2],m=i[n+44>>2],S=l,v=e+16|0,F=e+8|0,h=(c=d)+i[n+52>>2]|0,(g=(o=l)+i[n+48>>2]|0)>>>0<o>>>0&&(h=h+1|0),s=g,g=Oe(o=p(i[e+8>>2],60),o>>31,1e7,0),o=_+h|0,h=s=s+g|0,g=o=s>>>0<g>>>0?o+1|0:o,s=d+i[n+60>>2]|0,(d=l+i[n+56>>2]|0)>>>0<l>>>0&&(s=s+1|0),l=Oe(e=p(i[e+16>>2],60),e>>31,1e7,0),e=_+s|0,e=(d=l+d|0)>>>0<l>>>0?e+1|0:e,l=d,e=Oe(e=p(i[((e=(0|o)<(0|e)||(0|o)<=(0|e)&&!(h>>>0>=l>>>0)?((0|m)<(0|e)?1:(0|m)<=(0|e)?f>>>0>=l>>>0?0:1:0)&((0|m)>(0|g)?1:(0|m)>=(0|g)?f>>>0<h>>>0?0:1:0):((0|m)<(0|e)?1:(0|m)<=(0|e)?f>>>0>=l>>>0?0:1:0)|((0|m)>(0|g)?1:(0|m)>=(0|g)?f>>>0<h>>>0?0:1:0))?v:F)>>2],60),e>>31,1e7,0),o=_+c|0,d=o=(l=S+e|0)>>>0<e>>>0?o+1|0:o}e=i[n+40>>2],o=i[n+44>>2]-(d+(e>>>0<l>>>0)|0)|0,l=e-l|0,(0|(e=o))<0||(0|e)<=0&&!(l>>>0>=0)||(B(l,e,n- -64|0),a[r>>1]=i[n+64>>2],a[r+2>>1]=i[n+68>>2],i[r+4>>2]=i[n+72>>2],t=1,a[r+14>>1]=u[n+92>>1]+1,a[r+8>>1]=i[n+76>>2],a[r+10>>1]=i[n+80>>2],a[r+12>>1]=i[n+84>>2],e=i[n+88>>2],a[r+18>>1]=3,a[r+16>>1]=e)}return L=n+96|0,t}(n,e,o+8|0)&&(n=i[o+12>>2],i[e>>2]=i[o+8>>2],i[e+4>>2]=n,i[e+16>>2]=i[o+24>>2],n=i[o+20>>2],i[e+8>>2]=i[o+16>>2],i[e+12>>2]=n,n=e,(0|G(e,t,r,o+28|0))>=0?e=1+((i[o+28>>2]+6|0)%7|0)|0:(i[o+28>>2]=-1,e=6),a[n+14>>1]=e,s=1),L=o+32|0,s}(p(e,20)+3792|0,0!=(0|l),0!=(0|c),d+8|0),L=d+32|0,0|e},Mathpack_Zero:function(){return+h[396]},Mathpack_One:function(){return+h[395]},Mathpack_Pi:function(){return+h[391]},Mathpack_Div:function(e,t){return+se(e=+e,t=+t)},Mathpack_Mul:function(e,t){return+ie(e=+e,t=+t)},Mathpack_Sub:function(e,t){return+ne(e=+e,t=+t)},Mathpack_Add:function(e,t){return+te(e=+e,t=+t)},Mathpack_Power:function(e,t){return+function(e,t){var r=0,n=0,o=0,s=0;h[482]=t,g(+t),r=0|l(1),l(0),o=r,i[965]=2147483647&r,t=h[482];e:{if(g(+Ce(h[392])),65535==(0|(r=0|l(1)))&(n=0|l(0))>>>0<=4294967295|r>>>0<65535)h[482]=e,pe();else if(Se(),g(+Ce(t)),65535==(0|(r=0|l(1)))&(n=0|l(0))>>>0>4294967295|r>>>0>65535||-1==(0|(r=de()))){if(h[482]=e,g(+e),n=0|l(1),l(0),(0|(n=(r=n)>>>16<<16))>=1)ce(),ae(t),ve();else if(!((0|n)>-1)){if(ke(h[395],t),s=z(h[482]),h[482]=s,Se(),g(+Ce(s)),65535==(0|(n=0|l(1)))&l(0)>>>0>4294967295|n>>>0>65535)break e;if(2147483647==(0|(n=me()))|!(1&n))break e;h[482]=e,i[965]=2147483647&r,ce(),ae(t),ve(),(r=i[965])>>>0<65536||(i[965]=-2147483648^r)}}else h[482]=e,function(e){var t,r=0;if((t=a[1931])|e){if(!((0|t)<1)&&10==(0|de())){if(r=h[482],Se(),re(r),!u[1931])return void J(e);h[482]=r}for(r=1;1&e&&(r=Ee(r)),e>>>=1;)ae(h[482]);h[482]=r}else i[966]=4&i[966]?4:64}(r);if(o>>>16<<16>>16<=-1){if(1&(o=i[966]))return i[964]=0,i[965]=0,i[966]=-2&o,h[482];Re(h[395])}return h[482]}return i[966]=8,h[482]}(e=+e,t=+t)},Mathpack_Cond:function(e){var t,r;return g(+(e=+e)),t=0|l(1),l(0),(r=-65536&t)?2146435072==(2146435072&t)?(i[966]=1,0):0|((0|r)<1?-1:1):0},Mathpack_Cond2:function(e,t){t=+t;var r,n,a,i,o=0,s=0,u=0;g(+(e=+e)),o=0|l(1),r=0|l(0),n=o,i=o,g(+t),a=0|l(1),o=0|l(0),u=-1;e:{if(!((0|n)<(0|(s=a))||(u=1,(0|i)>(0|s)))){if(s=0,(0|o)==(0|r))break e;u=r>>>0<o>>>0?-1:1}o=u,s=(a&n)>-1?o:0-o|0}return 0|s},Mathpack_TakeMathError:function(){var e;return e=i[966],i[966]=0,0|e},Mathpack_Trunc:function(e){return+Y(e=+e)},Mathpack_Ceil:function(e){return e=+e,h[482]=e,function(){var e=0,t=0,r=0;e:{if(r=i[964],t=-65536&(e=i[965])){if(2146435072==(2146435072&e))return i[966]=1,void Se();if((0|t)>0)break e}return void Se()}Se(),(0|r)==i[964]&&i[965]==(0|e)||ee(1)}(),+h[482]},Mathpack_Floor:function(e){return e=+e,h[482]=e,Z(),+h[482]},Mathpack_Abs:function(e){var t=0;return g(+(e=+e)),t=0|l(1),t&=2147483647,c(0,0|l(0)),c(1,0|t),+d()},Mathpack_Neg:function(e){var t,r,n,a;return g(+(e=+e)),n=-2147483648^(t=0|l(1)),c(0,0|(r=0|l(0))),c(1,0|n),a=+d(),+(65535==(0|t)&r>>>0>4294967295|t>>>0>65535?a:e)},Mathpack_Float:function(e){return+((e|=0)>>>0)},Mathpack_SFloat:function(e){return+(0|(e|=0))},Mathpack_Fix:function(e){return 0|ge(e=+e)},Mathpack_LFix:function(e){return 0|he(e=+e)},Mathpack_SFix:function(e){return e=+e,h[482]=e,0|$()},Mathpack_Round:function(e,t){return+function(e,t){var r,o=0,s=0,c=0,d=0;L=r=L+-64|0,i[r+56>>2]=0,a[r+46>>1]=0,a[r+48>>1]=0,h[482]=e,g(+e),o=0|l(1),l(0);e:if(s=-65536&o)if(2146435072!=(2146435072&o)){(0|s)>0||(d=32768,o>>>0<65536||(i[965]=-2147483648^o,e=h[482])),ye(e,r+56|0,r+16|0,15),u[r+58>>1]||(a[r+56>>1]=1),h[482]=t,o=(0|(o=$()))<0?100:o;t:{if(c=-65536&(s=i[965]))if(2146435072!=(2146435072&s)){if(!((0|c)>0)){if((o=i[965])>>>0>=65536&&(i[965]=-2147483648^o),(0|(o=$()))<=-1)break t;o=0-o|0}}else i[966]=1;(0|(c=o+(s=a[r+56>>1])|0))<(0|(o=a[r+58>>1]))&&(i[r+12>>2]=o,i[r+8>>2]=s,X(r+16|0,r+8|0,r+12|0,c),o=i[r+12>>2],a[r+58>>1]=o,s=i[r+8>>2],a[r+56>>1]=s),n[r+46|0]=o,a[r+48>>1]=s+16384&32767|d,Fe(3276,3856,r+16|0),e=h[482];break e}e=h[396]}else i[966]=1;return L=r- -64|0,e}(e=+e,t=+t)},Mathpack_RoundUp:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,s=0;if(g(+e),r=0|l(1),l(0),(n=-65536&r)&&(2146435072!=(2146435072&r)?s=(0|n)<1?-1:1:i[966]=1),a=W(e,t),h[482]=e,h[482]=z(e),re(a),(r=i[965])>>>0>=65536){if(2146435072==(2146435072&r))return i[966]=1,a;if(r=(0|(r=ge(t)<<16))<0?309:r>>16,g(+t),n=0|l(1),l(0),(o=-65536&n)&&(2146435072!=(2146435072&n)?r=(0|o)<1?0-r|0:r:i[966]=1),(0|r)<=-309)return Q(8),0;J(0-r|0),(0|s)>-1||(r=i[965])>>>0<65536||(i[965]=-2147483648^r),ee(a),a=h[482]}return a}(e=+e,t=+t)},Mathpack_RoundDown:function(e,t){var r;return g(+(e=W(e=+e,t=+t))),r=0|l(1),l(0),2146435072==(2146435072&r)&&(i[966]=1,e=-1),+e},Mathpack_TenTo:function(e){return J(e|=0),+h[482]},Mathpack_Compare:function(e,t){return+(0|function(e,t){var r,n=0,a=0,o=0,s=0,u=0;L=r=L-16|0,h[r+8>>3]=e,h[r>>3]=t,g(+e),n=0|l(1),a=0|l(0),o=n,g(+t),u=n=0|l(1);e:{if((0|a)!=(0|(s=0|l(0)))||(0|o)!=(0|n)){if((u+2097152&2146435072)-(2146435072&o)>>>0<=5242879&&(e=z(e),h[r+8>>3]=e,g(+e),n=0|l(1),l(0),o=n,e=z(t),h[r>>3]=e,g(+e),n=0|l(1),l(0),u=n),n=1,(0|(o=i[(s=(a=(u&o)>-1)?r+8|0:r)+4>>2]))>(0|(u=i[(a=a?r:r+8|0)+4>>2])))break e;if((0|o)<(0|u)){n=-1;break e}if((s=i[s>>2])>>>0>(a=i[a>>2])>>>0)break e;if(n=-1,s>>>0<a>>>0)break e}n=0}return L=r+16|0,n}(e=+e,t=+t))},Mathpack_GetExp32:function(e){var t;return g(+(e=+e)),t=0|l(1),l(0),2146435072&t},Mathpack_Equal:function(e,t){t=+t;var r,n,a=0;return g(+(e=+e)),a=0|l(1),r=0|l(0),g(+t),n=0|l(1),0|((0|r)==(0|l(0))?(0|a)==(0|n):0)},Mathpack_ViewRound:function(e){var t;return g(+(e=+e)),t=0|l(1),l(0),2146435072==(2146435072&t)?(i[966]=1,-1):+z(e)},Mathpack_Sqrt:function(e){return e=+e,h[482]=e,pe(),+h[482]},Mathpack_Exp:function(e){return e=+e,h[482]=e,ve(),+h[482]},Mathpack_Ln:function(e){return e=+e,h[482]=e,ce(),+h[482]},Mathpack_Log:function(e){return e=+e,h[482]=e,function(){var e,t;e=+R(+h[482]),h[482]=e,g(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(i[966]=8)}(),+h[482]},Mathpack_Sin:function(e){return e=+e,h[482]=e,function(){var e=0,t=0;g(+(t=h[482])),e=0|l(1),l(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+N(+t),h[482]=t,g(+t),e=0|l(1),l(0),2146435072!=(2146435072&e))||(i[966]=8)}(),+h[482]},Mathpack_Cos:function(e){return e=+e,h[482]=e,function(){var e=0,t=0;g(+(t=h[482])),e=0|l(1),l(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+I(+t),h[482]=t,g(+t),e=0|l(1),l(0),2146435072!=(2146435072&e))||(i[966]=8)}(),+h[482]},Mathpack_Tan:function(e){return e=+e,h[482]=e,function(){var e=0,t=0,r=0;r=8,g(+(t=h[482])),e=0|l(1),l(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+O(+t),h[482]=t,r=4,g(+t),e=0|l(1),l(0),2146435072!=(2146435072&e))||(i[966]=r)}(),+h[482]},Mathpack_Asin:function(e){return+U(e=+e,0)},Mathpack_Acos:function(e){return+U(e=+e,1)},Mathpack_Atan:function(e){return e=+e,h[482]=e,fe(),+h[482]},Mathpack_Atan2:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,s=0;h[482]=e;e:{if(g(+e),r=0|l(1),l(0),r>>>0>=65536){if(2146435072!=(2146435072&r))break e;i[966]=1}h[482]=t;t:{if(g(+t),r=0|l(1),l(0),n=-65536&r){if(2146435072!=(2146435072&r))break t;i[966]=1}return Q(4),0}return le((0|n)<1?-1:1),ae(h[391]),oe(h[393]),h[482]}e:if((0|r)<=-1){g(+t),r=0|l(1),l(0);t:{if(n=-65536&r)if(2146435072!=(2146435072&r)){if((0|n)<1)break t}else i[966]=1;a=h[391];break e}g(+(a=h[391])),o=-2147483648^(r=0|l(1)),c(0,0|(n=0|l(0))),c(1,0|o),s=+d(),a=65535==(0|r)&n>>>0>4294967295|r>>>0>65535?s:a}else a=h[396];return ke(t,e),fe(),ee(a),h[482]}(e=+e,t=+t)},Mathpack_Mod:function(e,t){return+function(e,t){var r,n=0,a=0,o=0,s=0,m=0,f=0,S=0,v=0,F=0,y=0,b=0,C=0,A=0,E=0,T=0,R=0,k=0,N=0,I=0,O=0,P=0,M=0,D=0,w=0,x=0,K=0,W=0,U=0;L=r=L+-64|0,h[482]=e,g(+e),n=0|l(1),l(0),(E=-65536&n)&&(2146435072!=(2146435072&n)?W=(0|E)<1?-1:1:i[966]=1),i[965]=2147483647&n,g(+t),n=0|l(1),E=0|l(0),o=n;e:{t:{if(O=-65536&n){if(2146435072!=(2146435072&n))break t;i[966]=1}Q(4),e=0;break e}m=n=2147483647&o,c(0,0|E),c(1,0|n),e=+d(),g(+(t=h[482])),n=0|l(1),a=0|l(0),b=n;t:{r:{f=n,D=m;n:if(!((0|n)<(0|m))){a:{if((0|f)<=(0|D)){if((0|(n=a))==(0|(f=E)))break a;if(n>>>0<f>>>0)break n}if(Ae(P=Y(Te(e)),h[390]),(f=-65536&(n=i[965]))&&(2146435072!=(2146435072&n)?s=(0|f)<1:i[966]=1),i[966]){Q(0);break r}if(!s)break r;if(n=2147483647&o,c(0,-134217728&E),c(1,0|n),Ae(e,w=+d()),(n=i[965])|i[964]&&!(2146435072&n))break r;U=Ee(P),h[482]=ie(P,w),(n=i[965])>>>0>=65536&&(i[965]=-2147483648^n),ee(t),re(U);break n}i[964]=0,i[965]=0}if(n=i[964],o=i[792],v=s=i[965],a=-1,!((0|s)<(0|(m=f=i[793]))||(a=1,(0|v)>(0|m)))){if((0|n)==(0|o))break t;a=n>>>0<o>>>0?-1:1}if(-1!=(0|((s&f)>-1?a:0-a|0)))break t;ee(e);break t}ke(t,e),i[965]=2147483647&i[965];r:{if(n=i[964],f=i[816],R=y=i[965],F=v=i[817],s=-1,!((0|y)<(0|v)||(s=1,(0|R)>(0|F)))){if((0|n)==(0|f))break r;s=n>>>0<f>>>0?-1:1}if(-1==(0|((v&y)>-1?s:0-s|0))){if(f=0,s=0,y=n=E,Oe(0-n&n,0-((0<n>>>0)+(o=v=1048575&o|1048576)|0)&o,-1261761911,66559345),v=31&(n=R=u[1088+(_>>>26<<1)>>1]),32<=(63&n)>>>0?(n=0,v=o>>>v):(n=o>>>v,v=((1<<v)-1&o)<<32-v|y>>>v),y=n,o=a,n=1048575&b|1048576,(0|(k=R-(C=(b>>>20&2047)-(x=m>>>20)|0)|0))>=1&&(F=31&(a=64-k|0),b=o,32<=(63&a)>>>0?(a=0,F=-1>>>F):(a=-1>>>F,F=(1<<F)-1<<32-F|-1>>>F),o=(T=o)-(F=N=F&o)|0,n=(m=n)-((M=n&a)+(b>>>0<F>>>0)|0)|0),b=r,T=r,m=a=(m=(m=i[1056+((a=v)<<1&28)>>2])-p(m,p(a,m)+-1&240)&255)|0-p(m,p(a,m)+-1&65280)&65280,F=Oe(v,y,a,0),S=_+-1|0,(F=F+-1|0)>>>0<4294967295&&(S=S+1|0),m=Oe(-65536&F,S,a=0-a|0,a>>31)|m,S=Oe(m,F=_,v,y),a=_+-1|0,I=(a=Oe(0,S+-1>>>0<4294967295?a+1|0:a,m,F))-m|0,i[T+56>>2]=I,F=_-((a>>>0<m>>>0)+F|0)|0,i[b+60>>2]=F,i[r+48>>2]=v,i[r+52>>2]=y,be(r+56|0,r+48|0,r+8|0,r+40|0),S=i[r+12>>2],(m=i[r+8>>2]+1|0)>>>0<1&&(S=S+1|0),i[r+8>>2]=m,i[r+12>>2]=S,m=Me(0-(a=v)|0,0-((0<a>>>0)+y|0)|0,a,y),b=_,S=31&(a=(0|(C=(C-R|0)- -64|0))%64|0),32<=(63&a)>>>0?(a=1<<S,T=0):(a=(1<<S)-1&1>>>32-S,T=1<<S),S=a,i[r+32>>2]=o,i[r+36>>2]=n,n|o)for(;i[r+56>>2]=o,i[r+60>>2]=n,i[r+48>>2]=m,i[r+52>>2]=b,be(r+56|0,r+48|0,r+32|0,r+40|0),o=i[r+32>>2],n=i[r+36>>2],a=s+(A=i[r+44>>2])|0,(s=f+(K=i[r+40>>2])|0)>>>0<f>>>0&&(a=a+1|0),f=s,s=a,(0|A)==(0|a)&f>>>0<K>>>0|a>>>0<A>>>0&&((o=o+1|0)>>>0<1&&(n=n+1|0),i[r+32>>2]=o,i[r+36>>2]=n),o|n;);if(i[r+56>>2]=Me(f,s,v,y),i[r+60>>2]=_,i[r+48>>2]=T,i[r+52>>2]=S,be(r+56|0,r+48|0,r+16|0,r+40|0),o=i[r+44>>2],a=i[r+40>>2],i[r+56>>2]=a,i[r+60>>2]=o,i[r+48>>2]=I,i[r+52>>2]=F,be(r+56|0,r+48|0,r+24|0,r+40|0),n=i[r+44>>2],i[r+56>>2]=i[r+40>>2],i[r+60>>2]=n,i[r+48>>2]=v,i[r+52>>2]=y,f=0,s=0,be(r+56|0,r+48|0,r+32|0,r+40|0),A=i[r+36>>2],S=i[r+20>>2],(a=(o=0!=(0|a)|0!=(0|o))+i[r+16>>2]|0)>>>0<o>>>0&&(S=S+1|0),T=a,o=a+i[r+32>>2]|0,a=S+A|0,i[r>>2]=o,i[r+4>>2]=o>>>0<T>>>0?a+1|0:a,i[r+32>>2]=m,i[r+36>>2]=b,m|b)for(o=m,n=b;i[r+56>>2]=o,i[r+60>>2]=n,i[r+48>>2]=m,i[r+52>>2]=b,be(r+56|0,r+48|0,r+32|0,r+40|0),o=i[r+32>>2],n=i[r+36>>2],a=s+(S=i[r+44>>2])|0,(s=f+(A=i[r+40>>2])|0)>>>0<f>>>0&&(a=a+1|0),f=s,s=a,(0|S)==(0|a)&f>>>0<A>>>0|a>>>0<S>>>0&&((o=o+1|0)>>>0<1&&(n=n+1|0),i[r+32>>2]=o,i[r+36>>2]=n),o|n;);if((0|C)>=64)for(o=Me(f,s,v,y),n=_,s=C>>>6;1&s&&(a=i[r+4>>2],i[r+56>>2]=i[r>>2],i[r+60>>2]=a,i[r+48>>2]=o,i[r+52>>2]=n,be(r+56|0,r+48|0,r+16|0,r+40|0),S=a=i[r+44>>2],C=i[r+40>>2],i[r+56>>2]=C,i[r+60>>2]=a,i[r+48>>2]=I,i[r+52>>2]=F,be(r+56|0,r+48|0,r+24|0,r+40|0),a=i[r+44>>2],i[r+56>>2]=i[r+40>>2],i[r+60>>2]=a,i[r+48>>2]=v,i[r+52>>2]=y,be(r+56|0,r+48|0,r+32|0,r+40|0),A=i[r+36>>2],a=i[r+20>>2],(C=(S=0!=(0|C)|0!=(0|S))+i[r+16>>2]|0)>>>0<S>>>0&&(a=a+1|0),S=C+i[r+32>>2]|0,a=a+A|0,i[r>>2]=S,i[r+4>>2]=S>>>0<C>>>0?a+1|0:a),i[r+56>>2]=o,i[r+60>>2]=n,i[r+48>>2]=o,i[r+52>>2]=n,be(r+56|0,r+48|0,r+16|0,r+40|0),o=i[r+44>>2],a=i[r+40>>2],i[r+56>>2]=a,i[r+60>>2]=o,i[r+48>>2]=I,i[r+52>>2]=F,be(r+56|0,r+48|0,r+24|0,r+40|0),n=i[r+44>>2],i[r+56>>2]=i[r+40>>2],i[r+60>>2]=n,i[r+48>>2]=v,i[r+52>>2]=y,be(r+56|0,r+48|0,r+32|0,r+40|0),f=i[r+36>>2],n=i[r+20>>2],(a=(o=0!=(0|a)|0!=(0|o))+i[r+16>>2]|0)>>>0<o>>>0&&(n=n+1|0),n=n+f|0,n=(o=a+i[r+32>>2]|0)>>>0<a>>>0?n+1|0:n,s>>>=1;);if(n=i[r+8>>2],o=i[r+12>>2],a=i[r+4>>2],i[r+56>>2]=i[r>>2],i[r+60>>2]=a,i[r+48>>2]=n,i[r+52>>2]=o,be(r+56|0,r+48|0,r,r+40|0),f=i[r+40>>2],s=i[r+44>>2],n=i[r+4>>2],o=i[r>>2],i[r+32>>2]=o,i[r+36>>2]=n,n|o)for(;i[r+56>>2]=o,i[r+60>>2]=n,i[r+48>>2]=m,i[r+52>>2]=b,be(r+56|0,r+48|0,r+32|0,r+40|0),o=i[r+32>>2],n=i[r+36>>2],a=s+(F=i[r+44>>2])|0,(s=f+(S=i[r+40>>2])|0)>>>0<f>>>0&&(a=a+1|0),f=s,s=a,(0|F)==(0|a)&f>>>0<S>>>0|a>>>0<F>>>0&&(a=n,(n=o+1|0)>>>0<1&&(a=a+1|0),o=n,i[r+32>>2]=n,n=a,i[r+36>>2]=n),o|n;);if(o=Me(f,s,v,y),n=a=_,i[r>>2]=o,i[r+4>>2]=n,s=(R+x|0)-52|0,N|M&&(m=o,v=31&(o=k),32<=(63&o)>>>0?(a=m<<v,n=0):(a=(1<<v)-1&m>>>32-v|n<<v,n=m<<v),a=a+M|0,o=n=n+N|0,i[r>>2]=n,n=n>>>0<N>>>0?a+1|0:a,i[r+4>>2]=n,s=s-k|0),!(n|o)){i[964]=0,i[965]=0;break t}if((0|n)>=1?(ue(n),n=i[964],f=i[965],ue(o),a=f+33554432|0,a=2146435072&(n>>>0<0?a+1|0:a)|-2146435073&f,c(0,n|(o=0)),c(1,0|a),ee(+d())):ue(o),o=n=i[965],a=i[964],(0|(n=(n>>>20&2047)+s|0))<=1023){i[964]=0,i[965]=0,i[966]=2;break t}i[964]=a,i[965]=-2146435073&o|(n+1025&2047)<<20;break t}}Q(2),e=0;break e}(((0|O)<1?-2147483648:1)^W)>-1||((n=i[965])>>>0>=65536&&(i[965]=-2147483648^n),ee(e),i[965]!=(0|D)|(0|E)!=i[964]||(i[964]=0,i[965]=0)),(0|O)>=1?s=i[965]:(s=i[965])>>>0<65536||(s^=-2147483648,i[965]=s),!(i[964]|s)|2146435072&s||(i[966]=2),e=h[482]}return L=r- -64|0,e}(e=+e,t=+t)},Mathpack_FormatGeneral:function(e,t){t|=0;var r,n,o,s=0,c=0;return g(+(e=+e)),r=0|l(1),o=0|l(0),2146435072==(2146435072&r)?(i[966]=1,-1):(h[482]=e,s=3280,(n=-65536&(c=r))&&(2146435072!=(2146435072&c)?(s=3280,(0|n)>0||(c>>>0>=65536&&(i[965]=-2147483648^c),s=3280,!o&-2147483648==(0|r)||(a[1640]=45,s=3282))):(i[966]=1,s=3280)),c=s,t=(0|t)<255?t:255,t=function(e,t,r,n){var o;L=o=L-16|0,e=0|we[i[i[e>>2]+8>>2]](e),i[o+8>>2]=0;e:if(r<<1>>>0<=33){if((0|r)<1)break e;a[t>>1]=0}else ye(h[482],o+8|0,t,15),t=function(e,t,r,n,o,s){var l,c,d,g=0,m=0,h=0,f=0,S=0;L=c=L-16|0,l=(t<<1)+e|0,d=c+12|0;t:{r:{n:{a:if(!(h=(0|r)<5&(m=o?n:1)+3>>>0<8)){i:if(!((0|m)>(0|r))){if((0|(n=r+m|0))>=3){if((0|r)<5|(0|m)>-4)break a;if((n+-2|0)<(0|o))break i;break a}if((0|r)<5)break a}if(f=1,n=1,(0|r)<7)break n;n=r-(m+97>>>0>196?6:5)|0;break n}(1!=(0|r)||(n=0,m))&&(n=r-((0|m)<(0|r)?(0|m)<1?2-m|0:1:0)|0)}n:{if((0|n)<(0|o)){g=1,o=0;a:if(!((0|t)<1)){i:{o:{if(!n){if(u[e>>1]>52)break o;break a}if((0|n)<1|(0|n)>=(0|t))break a;if(u[(n<<1)+e>>1]<=52)break i;for(;;){if(S=u[(g=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[g>>1]=S,58!=(65535&S))break i;if(n=o,!o)break}}a[e>>1]=49,o=1,g=m+1|0;break a}for(;(0|(o=n))>=2&&48==u[((n=o+-1|0)<<1)+e>>1];);g=m}if((-1^h)&(0|g)>(0|r)|f)break n;break r}if(g=m,!f)break r}if(i[d>>2]=32768,r=e+2|0,(0|o)<2||(n=r+(o<<1)|0)>>>0>=l>>>0?n=r:(o=o+-1|0,i[d>>2]=32768|o,e=e+4|0,(t<<1)-4>>1>>>0<o>>>0&&C(),K(e,r,o<<1),a[r>>1]=s),n>>>0<l>>>0&&(a[n>>1]=69,n=n+2|0),n>>>0>=l>>>0?o=n:(o=n+2|0,(0|g)<=0?(a[n>>1]=45,g=1-g|0):(a[n>>1]=43,g=g+-1|0)),(0|g)<100|o>>>0>=l>>>0||(e=(g>>>0)/100|0,a[o>>1]=e+48,g=g-p(e,100)|0,o=o+2|0),o>>>0<l>>>0&&(a[o>>1]=48+((0|g)/10|0),o=o+2|0),o>>>0>=l>>>0)break t;a[o>>1]=48+((0|g)%10|0),o=o+2|0;break t}if((0|o)<0|(0|o)>(0|g))if(r=o-g|0,i[d>>2]=r,(0|g)>=1){if(!((r=(n=((h=(r=(m=(0|g)>(0|t)?t:g)<<1)+e|0)+(o<<1)|0)-r|0)-2|0)>>>0<e>>>0|n>>>0>=l>>>0))for(;a[n>>1]=u[r>>1],n=n+-2|0,(r=r+-2|0)>>>0>=h>>>0;);(0|g)<(0|t)&&(a[h>>1]=s),o=h+(((0|(e=l-h>>1))>(0|(t=o-m|0))?t+1|0:e)<<1)|0}else{if(!((n=2+((e-(g<<1)|0)+(o<<1)|0)|0)>>>0>=l>>>0||(o=((o<<1)+e|0)-2|0)>>>0<e>>>0))for(;a[n>>1]=u[o>>1],n=n+-2|0,(o=o+-2|0)>>>0>=e>>>0;);if((0|t)>=1&&(a[e>>1]=48,e=e+2|0),e>>>0<l>>>0&&(a[e>>1]=s,e=e+2|0),n=l-e>>1,g&&(t=(0|n)<(0|(t=0-g|0))?n:t))for(o=0;a[(o<<1)+e>>1]=48,(0|t)!=(0|(o=o+1|0)););o=(((0|n)<(0|r)?n:r)<<1)+e|0}else{if(r=(n=(0|g)>(0|t)?t:g)-o|0)for(t=(o<<1)+e|0,o=0;a[t+(o<<1)>>1]=48,(0|r)!=(0|(o=o+1|0)););o=(n<<1)+e|0}}return L=c+16|0,o}(t,r,n,a[o+8>>1],a[o+10>>1],e);return L=o+16|0,t}(i[256],c,3790-c>>1,(0|t)>0?t:0),i[964]=0,i[965]=0,t-3280>>1)},Mathpack_FormatGetExponent:function(){return i[968]},Mathpack_FormatGetSign:function(){return i[969]},Mathpack_FormatFixed:function(e,t,r){t|=0,r|=0;var n,o=0,s=0;return L=n=L+-64|0,g(+(e=+e)),o=0|l(1),l(0),2146435072!=(2146435072&o)?(i[n+56>>2]=0,a[n+46>>1]=0,a[n+48>>1]=0,ye(e,n+56|0,n+16|0,(o=t+r|0)>>>0<15?o:15),s=a[n+56>>1],o=a[n+58>>1],i[n+8>>2]=o,t=t+s|0,i[n+12>>2]=t,(0|(t=t+r|0))<(0|o)&&(X(n+16|0,n+12|0,n+8|0,t),o=i[n+8>>2]),o?((0|(r=r+(t=i[n+12>>2])|0))<(0|o)&&(i[n+8>>2]=r,o=r),(0|o)>-1||(i[966]=1)):(o=0,i[n+12>>2]=0,t=0),i[968]=t,i[969]=u[n+48>>1]>>>15^1,r=o,o>>>0>=256&&(C(),r=i[n+8>>2]),K(3280,n+16|0,o<<1)):(i[966]=1,r=-1),L=n- -64|0,0|r},Mathpack_FormatScientific:function(e,t,r){t|=0,r|=0;var n,o=0,s=0,c=0;if(L=n=L+-64|0,g(+(e=+e)),s=0|l(1),l(0),2146435072!=(2146435072&s)){if(i[n+56>>2]=0,a[n+46>>1]=0,a[n+48>>1]=0,ye(e,n+56|0,n+16|0,15),c=a[n+56>>1],i[n+12>>2]=c,s=a[n+58>>1],i[n+8>>2]=s,(0|(o=t))>=2&&(o=(0|c)%(0|t)|0,o=((0|c)<1?t:o?0:t)+o|0),!((0|(o=r+o|0))>=(0|s))){for(X(n+16|0,n+12|0,n+8|0,o),o=(0|o)<(0|(s=i[n+8>>2]))?o:s;s=o,(0|o)>=1&&48==u[(n+16|0)+((o=s+-1|0)<<1)>>1];);i[n+8>>2]=s,(0|t)<2||(0|(o=i[n+12>>2]))!=(0|c)&&((((c=r)+(r=(0|o)%(0|t)|0)|0)+((0|o)<1?t:r?0:t)|0)>=(0|s)||(C(),s=i[n+8>>2]))}(0|s)<=-1&&(i[966]=1),i[968]=i[n+12>>2],i[969]=u[n+48>>1]>>>15^1,(o=s)>>>0>=256&&(C(),o=i[n+8>>2]),K(3280,n+16|0,s<<1)}else i[966]=1,o=-1;return L=n- -64|0,0|o},Mathpack_Pack:function(e,t,r){var o;return e|=0,t|=0,r|=0,L=o=L-48|0,n[o+39|0]=0,K(o+8|0,3280,(r=(0|r)<15?r:15)<<1),a[o+40>>1]=t+16384&32767|!e<<15,n[o+38|0]=r,i[o>>2]=0,i[o+4>>2]=0,Fe(i[256],o,o+8|0)&&(i[966]=1),L=o+48|0,+h[o>>3]},_start:x,__errno_location:function(){return 3888},setThrew:function(e,t){e|=0,t|=0,i[970]||(i[971]=t,i[970]=e)},stackSave:function(){return 0|L},stackAlloc:function(e){return L=e=L-(e|=0)&-16,0|e},stackRestore:function(e){L=e|=0},__growWasmMemory:function(e){return 0|C()}}}({Math:n.Math,Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:a.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:a.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:a.Base_LocaleDecimalSeparator,Math_log10:a.Math_log10,Math_log:a.Math_log,Math_sqrt:a.Math_sqrt,Math_sin:a.Math_sin,Math_cos:a.Math_cos,Math_tan:a.Math_tan,Math_atan:a.Math_atan,Math_exp:a.Math_exp,proc_exit:i.proc_exit,getTempRet0:a.getTempRet0},h),S=f.memory;t.memory=S;var v=f.Base_StrBuf;t.Base_StrBuf=v;var F=f.Base_StrBufSize;t.Base_StrBufSize=F;var y=f.Dtr_DaysPerMonth;t.Dtr_DaysPerMonth=y;var b=f.Dtr_FromNum;t.Dtr_FromNum=b;var C=f.Dtr_Yr;t.Dtr_Yr=C;var A=f.Dtr_Mon;t.Dtr_Mon=A;var E=f.Dtr_DOM;t.Dtr_DOM=E;var T=f.Dtr_Hour;t.Dtr_Hour=T;var R=f.Dtr_Min;t.Dtr_Min=R;var k=f.Dtr_Sec;t.Dtr_Sec=k;var N=f.Dtr_Wdy;t.Dtr_Wdy=N;var I=f.Dtr_FracSec;t.Dtr_FracSec=I;var O=f.Dtr_Rounding;t.Dtr_Rounding=O;var P=f.Dtr_Write;t.Dtr_Write=P;var M=f.Dtr_ToNum;t.Dtr_ToNum=M;var D=f.Dtr_ToNumWithDuration;t.Dtr_ToNumWithDuration=D;var w=f.Dtr_Days;t.Dtr_Days=w;var L=f.Dtr_ToDays;t.Dtr_ToDays=L;var _=f.Dtr_ToTime;t.Dtr_ToTime=_;var x=f.Dtr_UtcToLocal;t.Dtr_UtcToLocal=x;var K=f.Mathpack_Zero;t.Mathpack_Zero=K;var W=f.Mathpack_One;t.Mathpack_One=W;var U=f.Mathpack_Pi;t.Mathpack_Pi=U;var G=f.Mathpack_Div;t.Mathpack_Div=G;var B=f.Mathpack_Mul;t.Mathpack_Mul=B;var V=f.Mathpack_Sub;t.Mathpack_Sub=V;var j=f.Mathpack_Add;t.Mathpack_Add=j;var H=f.Mathpack_Power;t.Mathpack_Power=H;var q=f.Mathpack_Cond;t.Mathpack_Cond=q;var z=f.Mathpack_Cond2;t.Mathpack_Cond2=z;var Q=f.Mathpack_TakeMathError;t.Mathpack_TakeMathError=Q;var $=f.Mathpack_Trunc;t.Mathpack_Trunc=$;var Y=f.Mathpack_Ceil;t.Mathpack_Ceil=Y;var J=f.Mathpack_Floor;t.Mathpack_Floor=J;var X=f.Mathpack_Abs;t.Mathpack_Abs=X;var Z=f.Mathpack_Neg;t.Mathpack_Neg=Z;var ee=f.Mathpack_Float;t.Mathpack_Float=ee;var te=f.Mathpack_SFloat;t.Mathpack_SFloat=te;var re=f.Mathpack_Fix;t.Mathpack_Fix=re;var ne=f.Mathpack_LFix;t.Mathpack_LFix=ne;var ae=f.Mathpack_SFix;t.Mathpack_SFix=ae;var ie=f.Mathpack_Round;t.Mathpack_Round=ie;var oe=f.Mathpack_RoundUp;t.Mathpack_RoundUp=oe;var se=f.Mathpack_RoundDown;t.Mathpack_RoundDown=se;var ue=f.Mathpack_TenTo;t.Mathpack_TenTo=ue;var le=f.Mathpack_Compare;t.Mathpack_Compare=le;var ce=f.Mathpack_GetExp32;t.Mathpack_GetExp32=ce;var de=f.Mathpack_Equal;t.Mathpack_Equal=de;var ge=f.Mathpack_ViewRound;t.Mathpack_ViewRound=ge;var me=f.Mathpack_Sqrt;t.Mathpack_Sqrt=me;var he=f.Mathpack_Exp;t.Mathpack_Exp=he;var pe=f.Mathpack_Ln;t.Mathpack_Ln=pe;var fe=f.Mathpack_Log;t.Mathpack_Log=fe;var Se=f.Mathpack_Sin;t.Mathpack_Sin=Se;var ve=f.Mathpack_Cos;t.Mathpack_Cos=ve;var Fe=f.Mathpack_Tan;t.Mathpack_Tan=Fe;var ye=f.Mathpack_Asin;t.Mathpack_Asin=ye;var be=f.Mathpack_Acos;t.Mathpack_Acos=be;var Ce=f.Mathpack_Atan;t.Mathpack_Atan=Ce;var Ae=f.Mathpack_Atan2;t.Mathpack_Atan2=Ae;var Ee=f.Mathpack_Mod;t.Mathpack_Mod=Ee;var Te=f.Mathpack_FormatGeneral;t.Mathpack_FormatGeneral=Te;var Re=f.Mathpack_FormatGetExponent;t.Mathpack_FormatGetExponent=Re;var ke=f.Mathpack_FormatGetSign;t.Mathpack_FormatGetSign=ke;var Ne=f.Mathpack_FormatFixed;t.Mathpack_FormatFixed=Ne;var Ie=f.Mathpack_FormatScientific;t.Mathpack_FormatScientific=Ie;var Oe=f.Mathpack_Pack;t.Mathpack_Pack=Oe;var Pe=f._start;t._start=Pe;var Me=f.__errno_location;t.__errno_location=Me;var De=f.setThrew;t.setThrew=De;var we=f.stackSave;t.stackSave=we;var Le=f.stackAlloc;t.stackAlloc=Le;var _e=f.stackRestore;t.stackRestore=_e;var xe=f.__growWasmMemory;t.__growWasmMemory=xe},6389:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return n.Base_LocaleDecimalSeparator}}),Object.defineProperty(t,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return n.Base_LocaleGetOrdinal}}),Object.defineProperty(t,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return n.Base_LocaleIsNumeral}}),t.Math_tan=t.Math_sqrt=t.Math_sin=t.Math_log10=t.Math_log=t.Math_exp=t.Math_cos=t.Math_atan=void 0,t.getTempRet0=function(){return g},t.setTempRet0=function(e){g=e};var n=r(8375);const a=Math.sqrt;t.Math_sqrt=a;const i=Math.log10||function(e){return Math.log(e)*Math.LOG10E};t.Math_log10=i;const o=Math.log;t.Math_log=o;const s=Math.exp;t.Math_exp=s;const u=Math.sin;t.Math_sin=u;const l=Math.cos;t.Math_cos=l;const c=Math.tan;t.Math_tan=c;const d=Math.atan;t.Math_atan=d;let g=0},6538:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math=void 0;const r=function(e){if(e.imul&&e.fround&&e.clz32)return e;const t=new Float32Array(1);return Object.create(e,{imul:{value:function(e,t){var r=(4194303&e)*(t|=0);return 4290772992&e&&(r+=(4290772992&e)*t|0),0|r}},fround:{value:function(e){return t[0]=e,t[0]}},clz32:{value:function(t){var r=t>>>0;return 0===r?32:31-(e.log(r)/e.LN2|0)|0}}})}(Math);t.Math=r},7325:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proc_exit=function(e){throw new Error("unexpected process termination: "+e)}},9229:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.utcToLocal=t.toTime=t.TimeDivision=t.toDays=t.toNumWithDuration=t.toNum=t.fromNum=t.dtr=t.Rounding=t.daysPerMonth=void 0;const n=r(531),a=r(5432);var i,o;function s(e,t,r,n,a,i,o,s,u){return{yr:e,mon:t,dom:r,hour:n,min:a,sec:i,wdy:o,fracSec:s,rounding:u}}function u(e){return s((0,n.Dtr_Yr)(e),(0,n.Dtr_Mon)(e),(0,n.Dtr_DOM)(e),(0,n.Dtr_Hour)(e),(0,n.Dtr_Min)(e),(0,n.Dtr_Sec)(e),(0,n.Dtr_Wdy)(e),(0,n.Dtr_FracSec)(e),(0,n.Dtr_Rounding)(e))}function l(e,t){(0,n.Dtr_Write)(t.yr,t.mon,t.dom,t.hour,t.min,t.sec,t.wdy,t.fracSec,t.rounding,e)}t.daysPerMonth=function(e,t,r){return(0,n.Dtr_DaysPerMonth)(e,t,r?1:0)},function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(i||(t.Rounding=i={})),t.dtr=s,t.fromNum=function(e,t,r,a){const i=t;return 0===(0,n.Dtr_FromNum)(e,i,0,r?1:0,a?1:0)&&u(0)},t.toNum=function(e,t,r){l(0,e);const i=(0,n.Dtr_ToNum)(0,t?1:0,r?1:0),o=(0,n.Mathpack_TakeMathError)();return o===a.MathErrorNum.None?i:(0,a.mathError)(o)},t.toNumWithDuration=function(e,t,r,i,o){l(0,e);const s=i,u=(0,n.Dtr_ToNumWithDuration)(0,t?1:0,r?1:0,s,o),c=(0,n.Mathpack_TakeMathError)();return c===a.MathErrorNum.None?u:(0,a.mathError)(c)},t.toDays=function(e,t,r){return l(0,e),0===(0,n.Dtr_ToDays)(0,t?1:0,r?1:0)&&(0,n.Dtr_Days)()},function(e){e[e.Hour=0]="Hour",e[e.Minute=1]="Minute",e[e.Second=2]="Second"}(o||(t.TimeDivision=o={})),t.toTime=function(e,t,r){const i=t,o=r,s=(0,n.Dtr_ToTime)(e,i,o);return(0,n.Mathpack_TakeMathError)()===a.MathErrorNum.None&&s},t.utcToLocal=function(e,t,r,a){return l(0,e),null!=t.standardDate&&l(1,t.standardDate),null!=t.daylightDate&&l(2,t.daylightDate),0!==(0,n.Dtr_UtcToLocal)(0,t.bias,null!=t.standardDate?1:-1,t.standardBias,null!=t.daylightDate?2:-1,t.daylightBias,r?1:0,a?1:0)&&u(0)}},6647:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.dtr=t.mathpack=void 0;const n=r(3345),a=n.__importStar(r(5432));t.mathpack=a;const i=n.__importStar(r(9229));t.dtr=i;const o=r(8375);Object.defineProperty(t,"isSupported",{enumerable:!0,get:function(){return o.isSupported}}),(0,r(531)._start)()},5432:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pack=t.formatScientific=t.formatFixed=t.formatGeneral=t.mod=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log=t.ln=t.exp=t.sqrt=t.viewRound=t.cond2=t.cond=t.power=t.add=t.sub=t.mul=t.div=t.compare=t.tenTo=t.roundDown=t.roundUp=t.round=t.sfix=t.lfix=t.fix=t.float=t.neg=t.abs=t.floor=t.ceil=t.trunc=t.equal=t.exp32=t.pi=t.one=t.zero=t.mathError=t.MathErrorNum=void 0;const n=r(531),a=r(8375),i=r(531);function o(e,t){const r=new Uint16Array(i.memory.buffer);let n="";for(let a=0;a<t;a+=1)n+=String.fromCharCode(r[e+(a<<1)>>1]);return n}var s;function u(e){return{num:e}}!function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"}(s||(t.MathErrorNum=s={}));const l={[s.Over]:u(s.Over),[s.Under]:u(s.Under),[s.DivBy0]:u(s.DivBy0),[s.Trans]:u(s.Trans)};function c(e){return l[e]??u(e)}function d(e){return t=>{const r=e(t),a=(0,n.Mathpack_TakeMathError)();return a===s.None?r:c(a)}}function g(e){return(t,r)=>{const a=e(t,r),i=(0,n.Mathpack_TakeMathError)();return i===s.None?a:c(i)}}t.mathError=c,t.zero=n.Mathpack_Zero,t.one=n.Mathpack_One,t.pi=n.Mathpack_Pi,t.exp32=n.Mathpack_GetExp32,t.equal=function(e,t){return 0!==(0,n.Mathpack_Equal)(e,t)},t.trunc=n.Mathpack_Trunc,t.ceil=d(n.Mathpack_Ceil),t.floor=d(n.Mathpack_Floor),t.abs=n.Mathpack_Abs,t.neg=n.Mathpack_Neg,t.float=function(e){return e<0?(0,n.Mathpack_SFloat)(e):(0,n.Mathpack_Float)(e)},t.fix=function(e){return(0,n.Mathpack_Fix)(e)>>>0},t.lfix=n.Mathpack_LFix,t.sfix=d(n.Mathpack_SFix),t.round=g(n.Mathpack_Round),t.roundUp=g(n.Mathpack_RoundUp),t.roundDown=g(n.Mathpack_RoundDown),t.tenTo=function(e){if(e<-1e3)return 0;if(e>1e3)return c(s.Over);if(!isFinite(e))return c(s.Over);const t=(0,n.Mathpack_TenTo)(e),r=(0,n.Mathpack_TakeMathError)();return r===s.None?t:c(r)},t.compare=n.Mathpack_Compare,t.div=g(n.Mathpack_Div),t.mul=g(n.Mathpack_Mul),t.sub=g(n.Mathpack_Sub),t.add=g(n.Mathpack_Add),t.power=g(n.Mathpack_Power),t.cond=function(e){const t=(0,n.Mathpack_Cond)(e),r=(0,n.Mathpack_TakeMathError)();return r===s.None?t:c(r)},t.cond2=n.Mathpack_Cond2,t.viewRound=d(n.Mathpack_ViewRound),t.sqrt=d(n.Mathpack_Sqrt),t.exp=d(n.Mathpack_Exp),t.ln=d(n.Mathpack_Ln),t.log=d(n.Mathpack_Log),t.sin=d(n.Mathpack_Sin),t.cos=d(n.Mathpack_Cos),t.tan=d(n.Mathpack_Tan),t.asin=d(n.Mathpack_Asin),t.acos=d(n.Mathpack_Acos),t.atan=d(n.Mathpack_Atan),t.atan2=g(n.Mathpack_Atan2),t.mod=g(n.Mathpack_Mod),t.formatGeneral=function(e,t,r){try{(0,a.setLocale)(e);const i=(0,n.Mathpack_FormatGeneral)(t,r);return i<0?c((0,n.Mathpack_TakeMathError)()):o((0,n.Base_StrBuf)(),i)}finally{(0,a.setLocale)(void 0)}},t.formatFixed=function(e,t,r){const a=(0,n.Mathpack_FormatFixed)(e,t,r);if(a<0)return(0,n.Mathpack_TakeMathError)();const i=o((0,n.Base_StrBuf)(),a),s=(0,n.Mathpack_FormatGetExponent)();return{sign:0!==(0,n.Mathpack_FormatGetSign)(),mantissa:i,exponent:s}},t.formatScientific=function(e,t,r){const a=(0,n.Mathpack_FormatScientific)(e,t,r);if(a<0)return(0,n.Mathpack_TakeMathError)();const i=o((0,n.Base_StrBuf)(),a),s=(0,n.Mathpack_FormatGetExponent)();return{sign:0!==(0,n.Mathpack_FormatGetSign)(),mantissa:i,exponent:s}},t.pack=function(e,t,r,o){try{(0,a.setLocale)(e);const u=(0,a.fastMin)(o.length,(0,n.Base_StrBufSize)());!function(e,t){const r=new Uint16Array(i.memory.buffer);for(let n=0;n<t.length;n+=1)r[e+(n<<1)>>1]=t.charCodeAt(n)}((0,n.Base_StrBuf)(),o.substring(0,u));const l=(0,n.Mathpack_Pack)(!!t,r,u),d=(0,n.Mathpack_TakeMathError)();return d!==s.None?c(d):isNaN(l)?c(s.Over):l}finally{(0,a.setLocale)(void 0)}}},8375:function(e,t){"use strict";let r;Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.fastMin=t.Base_LocaleDecimalSeparator=t.Base_LocaleGetOrdinal=t.Base_LocaleIsNumeral=t.setLocale=void 0,t.setLocale=function(e){r=e},t.Base_LocaleIsNumeral=function(e){return r.isNumeral(e)?1:0},t.Base_LocaleGetOrdinal=function(e){return r.getOrdinal(e)},t.Base_LocaleDecimalSeparator=function(){const e=r.decimalSeparator;return 0===e.length?46:e.charCodeAt(0)},t.fastMin=function(e,t){return e<t?e:t},t.isSupported=function(){const e=new ArrayBuffer(2);return new Uint16Array(e)[0]=1,1===new Uint8Array(e)[0]}},955:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3501:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(3345).__exportStar(r(955),t)},4414:function(e,t){"use strict";var r,n,a,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.PictureDbnum=t.PictureColor=t.PictureSpecial=t.PictureSingle=t.Rounding=void 0,function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(r||(t.Rounding=r={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(n||(t.PictureSingle=n={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(a||(t.PictureSpecial=a={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(i||(t.PictureColor=i={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(o||(t.PictureDbnum=o={}))},4137:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},147:function(e,t){"use strict";var r,n,a,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.PictureDbnum=t.PictureColor=t.PictureSpecial=t.PictureSingle=t.Rounding=void 0,function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(r||(t.Rounding=r={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(n||(t.PictureSingle=n={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(a||(t.PictureSpecial=a={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(i||(t.PictureColor=i={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(o||(t.PictureDbnum=o={}))},3065:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4420:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.DefinedNameInfoType=void 0,function(e){e[e.Invalid=-1]="Invalid",e[e.Table=0]="Table",e[e.NamedRange=1]="NamedRange",e[e.Lambda=2]="Lambda",e[e.Other=3]="Other"}(r||(t.DefinedNameInfoType=r={}))},7642:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.MajorityDataType=void 0,function(e){e[e.Text=0]="Text",e[e.Number=1]="Number",e[e.Date=2]="Date",e[e.Max=3]="Max"}(r||(t.MajorityDataType=r={}))},2919:function(e,t){"use strict";var r,n,a,i,o,s;Object.defineProperty(t,"__esModule",{value:!0}),t.RepairItemPartType=t.CodeActionKind=t.DiagnosticTag=t.DiagnosticSeverity=t.SuggestionKind=t.CompletionItemKind=void 0,function(e){e[e.Function=3]="Function",e[e.Enum=13]="Enum",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef",e[e.RichEntityEmptyCellRef=108]="RichEntityEmptyCellRef",e[e.RangeRef=109]="RangeRef",e[e.NamedOther=110]="NamedOther"}(r||(t.CompletionItemKind=r={})),function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"}(n||(t.SuggestionKind=n={})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"}(a||(t.DiagnosticSeverity=a={})),function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"}(i||(t.DiagnosticTag=i={})),function(e){e[e.Empty=0]="Empty",e[e.QuickFix=1]="QuickFix",e[e.Refactor=2]="Refactor",e[e.RefactorExtract=3]="RefactorExtract",e[e.RefactorInline=4]="RefactorInline",e[e.RefactorRewrite=5]="RefactorRewrite",e[e.Source=6]="Source",e[e.SourceOrganizeImports=7]="SourceOrganizeImports",e[e.SourceFixAll=8]="SourceFixAll"}(o||(t.CodeActionKind=o={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Replaced=3]="Replaced"}(s||(t.RepairItemPartType=s={}))},7543:function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.ReferenceMode=t.IncompatibilityType=void 0,function(e){e[e.gMove=1]="gMove"}(r||(t.IncompatibilityType=r={})),function(e){e[e.R1C1=0]="R1C1",e[e.A1=1]="A1"}(n||(t.ReferenceMode=n={}))},7748:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9331:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},178:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3220:function(e,t){"use strict";var r,n,a,i,o,s,u,l,c,d,g,m,h,p;Object.defineProperty(t,"__esModule",{value:!0}),t.TableOrientation=t.RecognizedTablesMetadataState=t.ColumnFormulaSuggestionUpdateKind=t.SchedulerFeature=t.GotoCtrlClickResultKind=t.ValuePreviewResultKind=t.PositionKind=t.HighlightKind=t.PerCharacterExperimentResultKind=t.PluginAttachGroup=t.PluginGroup=t.PluginFactoryName=t.MessageType=t.EditorMessageType=void 0,function(e){e[e.FunctionMessage=0]="FunctionMessage"}(r||(t.EditorMessageType=r={})),function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Replace=2]="Replace"}(n||(t.MessageType=n={})),function(e){e[e.TestPlugin=0]="TestPlugin",e[e.AutocompletePlugin=1]="AutocompletePlugin",e[e.DragPlugin=2]="DragPlugin",e[e.ConfigTestPlugin=3]="ConfigTestPlugin",e[e.ArgumentAssistancePlugin=4]="ArgumentAssistancePlugin",e[e.FeatureGateTestPlugin=5]="FeatureGateTestPlugin",e[e.DNMTraceTagTestPlugin=7]="DNMTraceTagTestPlugin",e[e.ParenthesesCouplingPlugin=8]="ParenthesesCouplingPlugin",e[e.AutocompleteFunctionPlugin=9]="AutocompleteFunctionPlugin",e[e.AutocompleteLetPlugin=10]="AutocompleteLetPlugin",e[e.AutocompleteRichValuePlugin=11]="AutocompleteRichValuePlugin",e[e.AutocompleteNamedObjectsPlugin=12]="AutocompleteNamedObjectsPlugin",e[e.AutocompleteTableHeadersPlugin=13]="AutocompleteTableHeadersPlugin",e[e.ColoredReferencesPlugin=14]="ColoredReferencesPlugin",e[e.ValuePreviewPlugin=15]="ValuePreviewPlugin",e[e.AutocompleteRangeSuggestionPlugin=16]="AutocompleteRangeSuggestionPlugin",e[e.SyntaxErrorsPlugin=17]="SyntaxErrorsPlugin",e[e.GotoCtrlClickPlugin=18]="GotoCtrlClickPlugin",e[e.AutocompleteEnumPlugin=19]="AutocompleteEnumPlugin",e[e.FormulaByExamplePlugin=20]="FormulaByExamplePlugin",e[e.SetCellPrefetchPlugin=21]="SetCellPrefetchPlugin",e[e.FormulaTranspilerPlugin=22]="FormulaTranspilerPlugin",e[e.InCellControlsAutodetectionPlugin=23]="InCellControlsAutodetectionPlugin",e[e.GetLocalePlugin=24]="GetLocalePlugin",e[e.FormulaCollectionPlugin=1004]="FormulaCollectionPlugin",e[e.ParserPerformanceMeasurements=1005]="ParserPerformanceMeasurements",e[e.FormulaRepairShadowEvalPlugin=1007]="FormulaRepairShadowEvalPlugin",e[e.PythonAutocompletePlugin=1008]="PythonAutocompletePlugin",e[e.AutocompleteWrapperPlugin=1009]="AutocompleteWrapperPlugin",e[e.AutocompleteBinaryModelExperimentPlugin=1010]="AutocompleteBinaryModelExperimentPlugin",e[e.ChangeGateTestPlugin=2e3]="ChangeGateTestPlugin",e[e.SlowTestPlugin=2001]="SlowTestPlugin",e[e.EvalOnCloneTestPlugin=2002]="EvalOnCloneTestPlugin",e[e.EvalFormulaTestPlugin=2003]="EvalFormulaTestPlugin",e[e.PythonTestPlugin=2004]="PythonTestPlugin",e[e.ChatGPTPlugin=2005]="ChatGPTPlugin",e[e.EventsTestPlugin=2006]="EventsTestPlugin"}(a||(t.PluginFactoryName=a={})),function(e){e[e.Excel=0]="Excel",e[e.Python=1]="Python"}(i||(t.PluginGroup=i={})),function(e){e[e.Core=0]="Core",e[e.Python=1]="Python",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete"}(o||(t.PluginAttachGroup=o={})),function(e){e[e.AutocompleteWrapperPluginResult=0]="AutocompleteWrapperPluginResult"}(s||(t.PerCharacterExperimentResultKind=s={})),function(e){e[e.CellRef=0]="CellRef",e[e.StructRef=1]="StructRef",e[e.NamedRange=2]="NamedRange",e[e.Parentheses=3]="Parentheses"}(u||(t.HighlightKind=u={})),function(e){e[e.Absolute=0]="Absolute",e[e.Relative=1]="Relative"}(l||(t.PositionKind=l={})),function(e){e[e.Failure=0]="Failure",e[e.Success=1]="Success",e[e.Unavailable=2]="Unavailable"}(c||(t.ValuePreviewResultKind=c={})),function(e){e[e.ReferenceFound=0]="ReferenceFound",e[e.NoReferenceFound=1]="NoReferenceFound",e[e.Failure=2]="Failure",e[e.RangeResolutionFailure=3]="RangeResolutionFailure",e[e.NotAFormula=4]="NotAFormula"}(d||(t.GotoCtrlClickResultKind=d={})),function(e){e[e.ArgumentAssistance=0]="ArgumentAssistance",e[e.SimpleAutoComplete=1]="SimpleAutoComplete",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete",e[e.ValuePreview=3]="ValuePreview",e[e.ColoredReferences=4]="ColoredReferences",e[e.ParenthesisCoupling=5]="ParenthesisCoupling",e[e.SyntaxErrors=6]="SyntaxErrors",e[e.GotoCtrlClick=7]="GotoCtrlClick",e[e.EnumAutoComplete=8]="EnumAutoComplete"}(g||(t.SchedulerFeature=g={})),function(e){e[e.Accept=0]="Accept",e[e.Decline=1]="Decline",e[e.Ignore=2]="Ignore"}(m||(t.ColumnFormulaSuggestionUpdateKind=m={})),function(e){e[e.Valid=2]="Valid",e[e.Invalid=4]="Invalid",e[e.All=6]="All"}(h||(t.RecognizedTablesMetadataState=h={})),function(e){e[e.none=0]="none",e[e.rowMajor=1]="rowMajor",e[e.columnMajor=2]="columnMajor"}(p||(t.TableOrientation=p={}))},7630:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=void 0;const n=r(3345);n.__exportStar(r(4420),t),n.__exportStar(r(7642),t),n.__exportStar(r(2919),t),n.__exportStar(r(3065),t),n.__exportStar(r(7543),t),n.__exportStar(r(178),t),n.__exportStar(r(7748),t),n.__exportStar(r(147),t),n.__exportStar(r(3220),t),n.__exportStar(r(9331),t);var a=r(4414);Object.defineProperty(t,"PictureColor",{enumerable:!0,get:function(){return a.PictureColor}}),Object.defineProperty(t,"PictureDbnum",{enumerable:!0,get:function(){return a.PictureDbnum}}),Object.defineProperty(t,"PictureSingle",{enumerable:!0,get:function(){return a.PictureSingle}}),Object.defineProperty(t,"PictureSpecial",{enumerable:!0,get:function(){return a.PictureSpecial}}),n.__exportStar(r(1493),t),n.__exportStar(r(4137),t),n.__exportStar(r(3501),t)},1493:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1594:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8420:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9094:function(e,t){"use strict";var r,n,a,i,o,s;Object.defineProperty(t,"__esModule",{value:!0}),t.RepairItemPartType=t.CodeActionKind=t.DiagnosticTag=t.DiagnosticSeverity=t.SuggestionKind=t.CompletionItemKind=void 0,function(e){e[e.Function=3]="Function",e[e.Enum=13]="Enum",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef",e[e.RichEntityEmptyCellRef=108]="RichEntityEmptyCellRef",e[e.RangeRef=109]="RangeRef"}(r||(t.CompletionItemKind=r={})),function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"}(n||(t.SuggestionKind=n={})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"}(a||(t.DiagnosticSeverity=a={})),function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"}(i||(t.DiagnosticTag=i={})),function(e){e[e.Empty=0]="Empty",e[e.QuickFix=1]="QuickFix",e[e.Refactor=2]="Refactor",e[e.RefactorExtract=3]="RefactorExtract",e[e.RefactorInline=4]="RefactorInline",e[e.RefactorRewrite=5]="RefactorRewrite",e[e.Source=6]="Source",e[e.SourceOrganizeImports=7]="SourceOrganizeImports",e[e.SourceFixAll=8]="SourceFixAll"}(o||(t.CodeActionKind=o={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Replaced=3]="Replaced"}(s||(t.RepairItemPartType=s={}))},5305:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoResumeRecalc=t.emptyRangeFormat=t.emptyRangeFormula=t.emptyRangeValue=t.FormulaKind=void 0;const n=r(6067),a=r(6067),i=r(6366);var o;!function(e){e.Value="Value",e.CellFormula="CellFormula"}(o||(t.FormulaKind=o={})),t.emptyRangeValue=a.blankOper,t.emptyRangeFormula={kind:o.Value,formulaBarText:"",origin:(0,n.gridCell)(0,0)},(0,i.staticAssertExtends)(),t.emptyRangeFormat=0,t.wrapIntoResumeRecalc=function(e,t){return{evalClonedModelOnSnapshot:(r,...n)=>{const a=e.evalClonedModelOnSnapshot(r,...n);return t(r),a},discardSnapshot:e.discardSnapshot.bind(e),getRangeFormats:(r,...n)=>{const a=e.getRangeFormats(r,...n);return t(r),a},getRangeValues:(r,...n)=>{const a=e.getRangeValues(r,...n);return t(r),a},getRangeFormulae:(r,...n)=>{const a=e.getRangeFormulae(r,...n);return t(r),a},getSheetNames:(r,...n)=>{const a=e.getSheetNames(r,...n);return t(r),a},getIntersectingTables:(r,...n)=>{const a=e.getIntersectingTables(r,...n);return t(r),a},getIformats:(r,...n)=>{const a=e.getIformats(r,...n);return t(r),a},getHiddenRows:(r,...n)=>{const a=e.getHiddenRows(r,...n);return t(r),a},getHiddenCols:(r,...n)=>{const a=e.getHiddenCols(r,...n);return t(r),a},evalFormulaOnSnapshot:(r,...n)=>{const a=e.evalFormulaOnSnapshot(r,...n);return t(r),a},getCorrespondingSnapshotID:t=>e.getCorrespondingSnapshotID(t)}}},9291:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.spanCompare=t.Timeline=t.spanToLSPRange=t.indexToLSPPosition=void 0;const n=r(6366),a=r(6386),i=r(4068),o=r(6366),s=r(4067);function u(e,t){let r=0,a=0;for(;a<t;){const i=e.indexOf("\n",a),o=e.indexOf("\r",a),s=i<0?o:o<0?i:(0,n.fastMin)(i,o);if(s<0||s>=t)break;r+=1,a=s+1+(s===o&&s+1<t&&10===e.charCodeAt(s+1)?1:0)}return{line:r,character:t-a}}t.indexToLSPPosition=u,t.spanToLSPRange=function(e,t,r){return{start:u(e,t),end:u(e,r)}},t.Timeline=class{stamp(e){this.enabled&&!this.timestamps.has(e)&&this.timestamps.set(e,this.timer.now())}log(e){if(this.enabled){this.stamp(e);const t={};let r=this.timer.now(),n=0;this.timestamps.forEach(((e,a)=>{r=Math.min(r,e),n=Math.max(n,e),t[a]=e})),n-r>this.logThreshold&&o.ulsLogger.ULS.traceTag(526234881,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Timeline[${this.name}]: ${JSON.stringify({...t,...this.workerInfo})}`),this.timestamps.clear()}}constructor(e,t,r=!0){this.name=e,this.logThreshold=t,this.enabled=r,this.timestamps=new Map,this.timer=a.defaultTimerInterface,this.workerInfo={isWorkerThread:(0,s.isWorkerThread)(),workerName:(0,s.workerName)()},o.ulsLogger.ULS.traceTag(526223315,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Timeline[${this.name}]: Initializing, ${JSON.stringify(this.workerInfo)}`)}},t.spanCompare=function(e,t){let r;return 0!=(r=e.start-t.start)||0!=(r=t.end-e.end)?r:0}},6058:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulaAssistance=t.dynamicPluginLoaderEwaFacade=t.functionInfoDTO=t.gridinterface=t.helpers=t.mockGlobals=t.notificationKinds=t.testUtils=t.mockTimer=t.timelineQueueProcessor=t.repeatedTaskScheduler=t.types=t.PackageName=void 0;const n=r(3345);t.PackageName="excel-online-x10-types",t.types=n.__importStar(r(1671)),t.repeatedTaskScheduler=n.__importStar(r(4714)),t.timelineQueueProcessor=n.__importStar(r(6386)),t.mockTimer=n.__importStar(r(4661)),t.testUtils=n.__importStar(r(5743)),t.notificationKinds=n.__importStar(r(5884)),t.mockGlobals=n.__importStar(r(7324)),t.helpers=n.__importStar(r(9291)),t.gridinterface=n.__importStar(r(5305)),t.functionInfoDTO=n.__importStar(r(1594)),t.dynamicPluginLoaderEwaFacade=n.__importStar(r(8420)),t.formulaAssistance=n.__importStar(r(9094))},7324:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MockGlobals=void 0;const n=r(6366),a=r(6067),i=r(6067);t.MockGlobals=class{getDocumentLoc(){return(0,n.failure)((0,a.notImplemented)(["getDocumentLoc"]))}getSheetIndex(){return(0,n.failure)((0,a.notImplemented)(["getSheetIndex"]))}getSheetName(){return(0,n.failure)((0,a.notImplemented)(["getSheetName"]))}getNameLoc(){return(0,n.failure)((0,a.notImplemented)(["getNameLoc"]))}getUserDefinedFuncLoc(){return(0,n.failure)((0,a.notImplemented)(["getUserDefinedFuncLoc"]))}getSheetRangeIndexes(){return(0,n.failure)((0,a.notImplemented)(["getSheetRangeIndexes"]))}getContainingTable(){return(0,n.failure)((0,a.notImplemented)(["getContainingTable"]))}getStructRefColumn(){return(0,n.failure)((0,a.notImplemented)(["getStructRefColumn"]))}getStructRefSpecialRef(){return(0,n.failure)((0,a.notImplemented)(["getStructRefSpecialRef"]))}getTime(){return(0,n.failure)((0,i.unavailable)(["getTime"]))}constructor(e){this.config=e}}},4661:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MockTimerImmediate=t.MockTimer=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(6366);t.MockTimer=class{now(){const e=this.nowTimes.shift();if(void 0===e)throw"now was called too many times";return e}constructor(e){this.nowTimes=e,this.setImmediateCalls=[],this.setTimeoutCalls=[],this.clearImmediateCalls=[],this.clearTimeoutCalls=[],this.setImmediate=(e,...t)=>{if(void 0!==this.handle)throw"setImmediate called, even though we already have a callback";return this.setImmediateCalls.push([e,...t]),this.handle=(0,o.setImmediateUnified)((()=>(this.handle=void 0,e(...t))))},this.clearImmediate=e=>{if(this.handle!==e)throw"clearImmediate called with a different handle than the one supplied";(0,i.clearTimerUnified)(this.handle),this.clearImmediateCalls.push([e]),this.handle=void 0},this.setTimeout=(e,t,...r)=>{if(void 0!==this.handle)throw"setTimeout called, even though we already have a callback";return this.setTimeoutCalls.push([e,t,...r]),this.handle=(0,o.setImmediateUnified)((()=>(this.handle=void 0,e(...r))))},this.clearTimeout=e=>{if(this.handle!==e)throw"clearTimeout called with a different handle than the one supplied";(0,i.clearTimerUnified)(this.handle),this.clearTimeoutCalls.push([e]),this.handle=void 0}}};class s{preciseNow(){return this.time}now(){return Math.floor(this.time/this.precisionMs)*this.precisionMs}busyWait(e){this.time+=e>0?e:0}busyWaitUntil(e){this.time=this.time<e?e:this.time}async runMacrotasksWhile(e){for(;;){if(await new Promise((e=>(0,o.setImmediateUnified)((()=>e())))),!e())return;const t=this.queue.pop();if(!t)return;if(this.busyWaitUntil(t.delayUntil),t.isValid)try{t.callback(...t.args)}catch(e){dispatchEvent(new ErrorEvent("error",{error:e,message:(0,a.messageFromError)(e),filename:"",lineno:0,colno:0}))}}}constructor(e=1,t=0){this.precisionMs=e,this.startTime=t,this.setImmediate=(e,...t)=>{const r={delayUntil:-1,callback:e,args:t,isValid:!0};return this.queue.enqueue(r),new s.Immediate(r)},this.clearImmediate=e=>{if(!(e instanceof s.Immediate))throw new TypeError("handle is not a MockFullTimer.Immediate");(0,i.clearTimerUnified)(e)},this.setTimeout=(e,t,...r)=>{const n={delayUntil:this.time+(t>4?t:4),callback:e,args:r,isValid:!0};return this.queue.enqueue(n),new s.Timeout(n)},this.clearTimeout=e=>{if(!(e instanceof s.Timeout))throw new TypeError("handle is not a MockFullTimer.Timeout");(0,i.clearTimerUnified)(e)},this.time=t>0?t:0,this.queue=new n.PriorityQueue(((e,t)=>e.delayUntil-t.delayUntil))}}t.MockTimerImmediate=s,s.Immediate=class{constructor(e){this.delayedCallback=e,this.kind="Mocking"}},s.Timeout=class{constructor(e){this.delayedCallback=e,this.kind="Mocking"}}},5884:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationKind=void 0,function(e){e.doNothing="doNothing",e.setActiveCell="setActiveCell",e.setActiveCellFormat="setActiveCellFormat",e.setFunctionsInfo="setFunctionsInfo",e.setDefinedNamesInfo="setDefinedNamesInfo",e.notifyWorkbookClosing="notifyWorkbookClosing",e.setSchedulerFeatures="setSchedulerFeatures",e.setA1ReferenceStyle="setA1ReferenceStyle",e.setLocale="setLocale",e.setWorkbookProps="setWorkbookProps",e.updateSheetNames="updateSheetNames",e.updateNamedObjects="updateNamedObjects",e.conflictResolverEarlyTermination="conflictResolverEarlyTermination",e.writeRange="writeRange",e.setNumberFormats="setNumberFormats"}(r||(t.NotificationKind=r={}))},4714:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RepeatedTaskScheduler=t.TaskKind=void 0;const n=r(6366),a=r(6366),i=r(6366);var o,s;function u(e,t){return{kind:e,handle:t}}function l(e){return void 0!==e?(e.kind=o.NoWorkScheduled,e.handle=void 0,e):u(o.NoWorkScheduled,void 0)}!function(e){e[e.NoWorkScheduled=0]="NoWorkScheduled",e[e.PromiseScheduled=1]="PromiseScheduled",e[e.ImmediateScheduled=2]="ImmediateScheduled",e[e.FutureScheduled=3]="FutureScheduled"}(o||(o={})),(0,a.staticAssertExtends)(),function(e){e.Sync="Sync",e.MicroTask="MicroTask",e.MacroTask="MacroTask"}(s||(t.TaskKind=s={}));const c=Promise.resolve();t.RepeatedTaskScheduler=class{runNextSynchronously(){switch(this.handleState.kind){case o.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case o.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}this.clearHandleClosureAndRunBody()}runNextAsMicrotask(){switch(this.handleState.kind){case o.PromiseScheduled:return;case o.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case o.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e;this.handleState=void 0!==(e=this.handleState)?(e.kind=o.PromiseScheduled,e.handle=void 0,e):u(o.PromiseScheduled,void 0),c.then(this.promiseClosure)}runNextAsMacrotask(){switch(this.handleState.kind){case o.ImmediateScheduled:return;case o.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e,t;this.handleState=(e=this.timer.setImmediate(this.clearHandleClosureAndRunBody),void 0!==(t=this.handleState)?(t.kind=o.ImmediateScheduled,t.handle=e,t):u(o.ImmediateScheduled,e))}runNextInFuture(e){switch(this.handleState.kind){case o.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case o.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}var t,r;this.handleState=(t=this.timer.setTimeout(this.clearHandleClosureAndRunBody,e),void 0!==(r=this.handleState)?(r.kind=o.FutureScheduled,r.handle=t,r):u(o.FutureScheduled,t))}clear(){switch(this.handleState.kind){case o.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case o.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}this.handleState=l(this.handleState)}constructor(e,t=i.defaultSetTimeoutInterface){this.timer=t,this.handleState=l(),this.clearHandleClosureAndRunBody=()=>{let t;switch(this.handleState.kind){case o.NoWorkScheduled:t=s.Sync;break;case o.PromiseScheduled:t=s.MicroTask;break;case o.ImmediateScheduled:case o.FutureScheduled:t=s.MacroTask;break;default:(0,n.assertNever)("Unknown handle state",this.handleState)}this.handleState=l(this.handleState),e(t)},this.promiseClosure=()=>{this.handleState.kind===o.PromiseScheduled&&this.clearHandleClosureAndRunBody()}}}},5743:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runQueueProcessorUntil=void 0;const n=r(6366);t.runQueueProcessorUntil=async function(e,t){let r=!1;const a=Promise.resolve(t);a.then((()=>r=!0));let i=0;return await(0,n.promiseLoop)((async()=>{if(++i%100==0&&await new Promise((e=>setTimeout(e,1))),!r)return e.step(),!0}),!0),a}},6386:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimelineQueueProcessor=t.defaultTimerInterface=void 0;const n=r(6366),a=r(6366),i=r(6366),o=r(4714);t.defaultTimerInterface={...i.defaultSetTimeoutInterface,now:n.now},t.TimelineQueueProcessor=class{enqueue(e,t,r=this.maxWitnessedNow){this.queue.enqueue({delayUntil:r,payload:e,abstractCost:t}),this.continue()}push(e,t,r=this.maxWitnessedNow){this.queue.push({delayUntil:r,payload:e,abstractCost:t}),this.continue()}pop(){return 1===this.queue.getCount()&&this.scheduler.clear(),this.queue.pop()?.payload}peek(){return this.queue.peek()}getCount(){return this.queue.getCount()}continue(){for(this.startTime=this.startTime??this.now();this.totalSyncCost<this.costThreshold;){const e=this.queue.peek();if(void 0===e)return;if(e.delayUntil>this.maxWitnessedNow&&this.tryRunNextInFuture(e.delayUntil,this.now()))return;this.queue.pop(),this.totalSyncCost+=e.abstractCost,this.consumeMessage(e.payload)}const e=this.queue.peek();if(void 0===e)return;const t=this.now();t-this.startTime<this.timeThreshold&&e.delayUntil<=t?this.scheduler.runNextAsMicrotask():this.tryRunNextInFuture(e.delayUntil,t)||this.scheduler.runNextAsMacrotask()}tryRunNextInFuture(e,t){return e>t&&(this.lastFutureAbsoluteTime!==e&&(this.lastFutureAbsoluteTime=e,this.scheduler.runNextInFuture(e-t)),!0)}now(){return this.maxWitnessedNow=this.timer.now()}constructor(e,r,n,i=t.defaultTimerInterface){this.cmp=e,this.consumeMessage=r,this.timer=i,this.startTime=void 0,this.totalSyncCost=0,this.maxWitnessedNow=0,this.lastFutureAbsoluteTime=void 0,this.queue=new a.PriorityQueue(((t,r)=>{const n=t.delayUntil-r.delayUntil;return 0!==n?n:e(t.payload,r.payload)})),this.costThreshold=n?.costThreshold??1,this.timeThreshold=n?.timeThreshold??10,this.scheduler=new o.RepeatedTaskScheduler((e=>{this.totalSyncCost=0,this.lastFutureAbsoluteTime=void 0,e===o.TaskKind.MacroTask&&(this.startTime=void 0),this.continue()}),i)}}},1671:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.SpecialFormat=void 0,function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Aggregate="Aggregate",e.Inferred="Inferred",e.Known="Known",e.Edit="Edit"}(r||(t.SpecialFormat=r={}))},3187:function(e,t){"use strict";function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0,t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},9089:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;const r={};function n(){return void 0===globalThis.__get_feature_gate_dictionary_variable?r:globalThis.__get_feature_gate_dictionary_variable()}function a(e,t){return n()[e]??t}t.getFeatureGateDictionary=n,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){const r=a(e)?.trim().toLowerCase();return"true"===r||"false"!==r&&t},t.getNumberFeatureGate=function(e,t){const r=a(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const n=parseFloat(r);return isNaN(n)?t:n},t.getIntFeatureGate=function(e,t){const r=a(e)?.trim();if(void 0===r)return t;const n=parseInt(r,10);return isNaN(n)?t:n},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t}},3219:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3345);n.__exportStar(r(9089),t),n.__exportStar(r(2900),t),n.__exportStar(r(3187),t),n.__exportStar(r(2665),t),n.__exportStar(r(2699),t),n.__exportStar(r(6297),t)},2900:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;const n=r(9089);t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},2665:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;const n=r(3187);t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,n.isChangeGateEnabled)(e)}},2699:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;const n=r(3187);function a(e){const t=(0,n.setChangeGateDictionaryGetter)(void 0);return(0,n.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}t.overrideChangeGates=a,t.overrideTypedChangeGates=function(e,t){return a(t)}},6297:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;const n=r(9089);function a(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,n.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,n.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}t.overrideFeatureGates=a,t.overrideTypedFeatureGates=function(e,t){return a(t)}},626:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTelemetryLogger=t.setTelemetryLogger=void 0;const n=r(8521);t.setTelemetryLogger=function(e){globalThis.__otel_util_telemetry_logger__=e},t.getTelemetryLogger=function(){return void 0===globalThis.__otel_util_telemetry_logger__&&(globalThis.__otel_util_telemetry_logger__=new n.TelemetryLogger),globalThis.__otel_util_telemetry_logger__}},2519:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertDataFields=void 0;const n=r(3345).__importStar(r(8521));t.convertDataFields=function(e){let t=!0;const r=[];return e.forEach((e=>{const a=e.classification;if(a===n.EnumObjects.DataClassification.SystemMetadata||a===n.EnumObjects.DataClassification.EssentialServiceMetadata){const t={name:e.name,bool:null,string:null,double:null,int64:null,date:null,contract:null};switch(e.dataType){case n.EnumObjects.DataFieldType.Boolean:t.bool=e.value;break;case n.EnumObjects.DataFieldType.Double:t.double=e.value;break;case n.EnumObjects.DataFieldType.Int64:t.int64=e.value;break;case n.EnumObjects.DataFieldType.String:t.string=e.value;break;case n.EnumObjects.DataFieldType.Guid:default:return}r.push(t)}else t=!1})),t?r:[]}},3969:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3345);n.__exportStar(r(2519),t),n.__exportStar(r(626),t)},4067:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.createWorker=void 0,a(r(3755),t);var i=r(9663);Object.defineProperty(t,"createWorker",{enumerable:!0,get:function(){return i.createWorker}})},3755:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.workerName=t.isWorkerThread=t.importScriptsWithRetry=t.Endpoint=t.paramInsideDef=t.dispatchWorkerError=t.setConfig=t.isThreadingSupported=t.WorkerError=void 0;var n=r(5915);Object.defineProperty(t,"WorkerError",{enumerable:!0,get:function(){return n.WorkerError}});var a=r(2973);Object.defineProperty(t,"isThreadingSupported",{enumerable:!0,get:function(){return a.isThreadingSupported}}),Object.defineProperty(t,"setConfig",{enumerable:!0,get:function(){return a.setConfig}}),Object.defineProperty(t,"dispatchWorkerError",{enumerable:!0,get:function(){return a.dispatchWorkerError}});var i=r(6709);Object.defineProperty(t,"paramInsideDef",{enumerable:!0,get:function(){return i.paramInsideDef}});var o=r(7774);Object.defineProperty(t,"Endpoint",{enumerable:!0,get:function(){return o.Endpoint}});var s=r(2156);Object.defineProperty(t,"importScriptsWithRetry",{enumerable:!0,get:function(){return s.importScriptsWithRetry}});var u=r(2668);Object.defineProperty(t,"isWorkerThread",{enumerable:!0,get:function(){return u.isWorkerThread}}),Object.defineProperty(t,"workerName",{enumerable:!0,get:function(){return u.workerName}})},2973:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dispatchCreateWorker=t.dispatchWorkerError=t.getCreateMode=t.getCreateTimeout=t.getSafeParams=t.setConfig=t.isThreadingSupported=t.ThreadMessageKind=void 0;const n=r(5221);var a;function i(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}let o;function s(e){setTimeout((()=>{throw e}))}function u(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function l(e){const t=u();if(void 0!==t){const r={kind:a.WorkerError,error:(0,n.encodeResultValue)(e)};t.postMessage(r)}else console.warn(e)}function c(e){const t=u();if(void 0!==t){const r={kind:a.CreateWorker,stats:e};t.postMessage(r)}}!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(a||(t.ThreadMessageKind=a={})),t.isThreadingSupported=i,t.setConfig=function(e){if(o)throw new TypeError("setConfig has already been called");o=e},t.getSafeParams=function(){const e=o??{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?[...e.importScriptUrls]:void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}},t.getCreateTimeout=function(e){return e?.createTimeout??o?.createTimeout??3e5},t.getCreateMode=function(e){const t=e?.createMode??o?.createMode??"Thread";return"ThreadOrLocal"===t?i()?"Thread":"Local":t},t.dispatchWorkerError=function(e){try{(o?.onWorkerError??l)(e)}catch(t){console.warn(e),s(t)}},t.dispatchCreateWorker=function(e){try{(o?.onCreateWorker??c)(e)}catch(e){s(e)}}},9663:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createWorker=void 0;const o=r(6709),s=r(7774),u=r(2973),l=r(5523),c=r(5915),d=r(3996),g=r(7181),m={...i(r(3755)),createWorker:S};function h(e,t,r,n,a){const{port1:i,port2:o}=new MessageChannel;let u;return Promise.all([n({port:i,options:e,createMode:t}),(0,d.timePromise)(r.createOutside=(0,d.startStopwatch)(),(()=>s.Endpoint.createOutside({port:o,options:e,createMode:t},(e=>a(u=e)))))]).then((()=>u),(e=>(u?u.close("Force"):o.close(),Promise.reject(e))))}function p(e,t,r,n){return h(e,"Local",t,(e=>function(e,t,r){const{def:n,args:a}="def"in r?r:(0,o.paramInsideDef)(r);if("function"!=typeof n){const t={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new c.WorkerError("Loading an InsideScript to create a local worker is unimplemented",t))}return Promise.resolve().then((()=>(0,d.timePromise)(t.insideInit=(0,d.startStopwatch)(),(()=>n({config:(0,u.getSafeParams)(),importTypedWorkers:()=>m,connection:e},...a).then((()=>{}))))))}(e,t,r)),n)}function f(e,t,r,n){let a;t.createThread=(0,d.startStopwatch)();try{a=new l.Thread(e,r)}catch(e){return(0,d.stopStopwatch)(t.createThread,"Error"),Promise.reject(e)}return(0,d.stopStopwatch)(t.createThread,"Success"),h(e,"Thread",t,(e=>a.createInside(e,t)),n).then((e=>(e.hasBeenClosed()?a.terminate():e._onClose=a.terminate.bind(a),e)),(e=>(a.terminate(),Promise.reject(e))))}function S(e,t,r=(()=>{})){const n=(0,u.getCreateMode)(e),a="local"in t?"Local"===n?t.local:t.thread:t,i="Local"===n?p:f,o={id:e.id,createMode:n,createWorker:(0,d.startStopwatch)()},l=(0,d.timePromise)(o.createWorker,(()=>i((0,s.getSafeOptions)(e),o,a,r)));return(0,g.promiseFinally)(l,(()=>{const e=(0,d.createWorkerStats)(o);e&&(0,u.dispatchCreateWorker)(e)}))}t.createWorker=S},7774:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Endpoint=t.getSafeOptions=void 0;const n=r(2973),a=r(5221),i=r(5915),o=r(5593),s=r(7181);t.getSafeOptions=function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls,importScriptsMaxRetries:e.importScriptsMaxRetries}};class u{static _create(e,t,r){const{port:a,options:l,createMode:c}=t,d={type:"Endpoint",side:e,id:l?.id};let g,m;try{g=new o.EndpointState(d,a),m=new u(d,g,c)}catch(e){return Promise.reject(e)}return new Promise(((t,a)=>{g.getCallTimeout=()=>m.callTimeout,g.getOnPostMessageError=()=>m.onPostMessageError,g.onImports=(e,t)=>{Object.defineProperties(m,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),u.resolve()},g.onClose=()=>m.close("Force");const o=(0,n.getCreateTimeout)(l),u=(0,s.setCallbacksTimeout)(o,(()=>{const t="Outside"===e?"inside":"outside",r={cause:"Timeout",idInfo:d,timeout:o},n=new i.WorkerError(`${e} Endpoint timed out waiting for the ${t} to start`,r);u.reject(n)}),{resolve:t,reject:a});let c;m._closedDuringCreate=()=>{u.resolve()};try{c=r(m)}catch(e){return u.reject(e)}m._state?.setExports(c)})).then((()=>(m._closedDuringCreate=void 0,m)),(e=>(m._closedDuringCreate=void 0,m.close(),Promise.reject(e))))}hasBeenClosed(){return void 0===this._state}close(e){if(!this._state)return;if(this._closedDuringCreate){if("Force"!==e){const e={cause:"Connection",idInfo:this._idInfo};throw new i.WorkerError(`${this._idInfo.side} Endpoint's close called during creation`,e)}this._closedDuringCreate()}const t=this._state;this._state=void 0;try{t.close(),this._onClose?.(),this.onClose?.()}catch(e){const t={cause:"Connection",idInfo:this._idInfo,error:(0,a.asError)(e)};(0,n.dispatchWorkerError)(new i.WorkerError(`${this._idInfo.side} Endpoint's close threw an error`,t))}}constructor(e,t,r){this.callTimeout=1/0,this.onPostMessageError=o.throwWorkerError,this._idInfo=e,this._state=t,this.createMode=r;const n=t=>()=>{const r="Outside"===e.side?"inside":"outside",n={cause:"Connection",idInfo:e};throw new i.WorkerError(`${e.side} Endpoint's ${t} referenced before the ${r} Endpoint started`,n)};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:n("post")},call:{configurable:!0,enumerable:!1,get:n("call")}})}}t.Endpoint=u,u.createOutside=(e,t=(()=>{}))=>u._create("Outside",e,t),u.createInside=(e,t)=>u._create("Inside",e,t)},5593:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EndpointState=t.throwWorkerError=void 0;const n=r(2973),a=r(5221),i=r(5915),o=r(7181);var s;function u(e){throw e}!function(e){e[e.Invoke=0]="Invoke",e[e.Result=1]="Result",e[e.Names=2]="Names",e[e.Close=3]="Close"}(s||(s={})),t.throwWorkerError=u;let l=-1;t.EndpointState=class{setExports(e){this.exports=e;const t=(0,o.haveNativeProxy)()?void 0:(0,o.getFunctionPropertyNames)(e),r={kind:s.Names,funcNames:t};this.port.postMessage(r)}close(){if(this.isClosed)return;this.isClosed=!0;const e={kind:s.Close};this.port.postMessage(e),this.port.close();for(const e in this.unresolvedCalls){const{reject:t,funcName:r}=this.unresolvedCalls[e],n={cause:"Connection",idInfo:this.idInfo,funcName:r};t(new i.WorkerError(`Importing Endpoint closed while waiting for ${r} result`,n))}}onInvoke({callId:e,funcName:t,args:r}){const o=Promise.resolve().then((()=>{const n=this.exports[t];if(n)return n.apply(this.exports,r);const a=e>=0?"call":"post",o={cause:"Connection",idInfo:this.idInfo,callId:e,funcName:t};throw new i.WorkerError(`Exporting Endpoint received a ${a} to unknown function ${t}`,o)}));e>=0?o.then((r=>this.sendResult(e,t,!0,r)),(r=>this.sendResult(e,t,!1,r))):o.catch((r=>{const o=(0,a.asError)(r),s={cause:"UnhandledError",idInfo:this.idInfo,error:o,callId:e,funcName:t};(0,n.dispatchWorkerError)(new i.WorkerError(`Exporting Endpoint's ${t} implementation threw or rejected`,s))}))}sendResult(e,t,r,n){const i=(0,a.encodeResultValue)(n),o={kind:s.Result,callId:e,funcName:t,isFulfilled:r,resultValue:i};try{this.port.postMessage(o,void 0)}catch(e){this.onSendResultFailed(o,(0,a.asError)(e))}}onSendResultFailed({callId:e,funcName:t,resultValue:r},a){const o=a?`Exporting Endpoint failed to send ${t} result`:`Importing Endpoint failed to deserialize ${t} result`,s={cause:"MessageError",idInfo:this.idInfo,error:a,callId:e,funcName:t},u=new i.WorkerError(o,s);r.isError?(0,n.dispatchWorkerError)(u):this.sendResult(e,t,!1,u)}takeCallbacks(e){const t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t}setCallTimeout(e,t,r,n){return r>o.maxTimeout?n:(0,o.setCallbacksTimeout)(r,(()=>{const n=this.takeCallbacks(e);if(n){const a={cause:"Timeout",idInfo:this.idInfo,timeout:r,callId:e,funcName:t};n.reject(new i.WorkerError(`Importing Endpoint's call to ${t} timed out`,a))}}),n)}sendCall(e,t,r,n){return new Promise(((o,u)=>{const c=l+=1,d={kind:s.Invoke,callId:c,funcName:e,args:t};this.unresolvedCalls[c]={...this.setCallTimeout(c,e,r,{resolve:o,reject:u}),funcName:e};try{this.port.postMessage(d,n)}catch(t){const r=this.takeCallbacks(c);if(r){const n=(0,a.asError)(t),o={cause:"MessageError",idInfo:this.idInfo,error:n,callId:c,funcName:e};r.reject(new i.WorkerError(`Importing Endpoint failed to send call to ${e}`,o))}}}))}sendPost(e,t,r,n){const o={kind:s.Invoke,callId:-1,funcName:e,args:t};try{this.port.postMessage(o,n)}catch(t){const n=(0,a.asError)(t),o={cause:"MessageError",idInfo:this.idInfo,error:n,callId:-1,funcName:e};r(new i.WorkerError(`Importing Endpoint failed to post to ${e}`,o))}}onSendInvokeFailed({callId:e,funcName:t}){const r=e>=0?"call":"post",a={cause:"MessageError",idInfo:this.idInfo,callId:e,funcName:t},o=new i.WorkerError(`Exporting Endpoint failed to deserialize ${r} to ${t}`,a),s=e>=0?this.takeCallbacks(e):void 0;(s?.reject??n.dispatchWorkerError)(o)}onResult({callId:e,funcName:t,isFulfilled:r,resultValue:a}){if(e>=0){const t=this.takeCallbacks(e);t&&(r?t.resolve:t.reject)((0,i.decodeResultValue)(a))}else{const r={cause:"InternalError",idInfo:this.idInfo,callId:e,funcName:t};(0,n.dispatchWorkerError)(new i.WorkerError(`Exporting Endpoint sent a result for a post to ${t}`,r))}}createPostProxy(e){const t=(...e)=>t.transfer(void 0,...e);return t.transfer=(r,...n)=>{if(this.isClosed)return;const a=t.onPostMessageError??this.getOnPostMessageError?.()??u;this.sendPost(e,n,a,r)},t}createCallProxy(e){const t=(...e)=>t.transfer(void 0,...e);return t.transfer=(r,...n)=>{if(this.isClosed){const t={cause:"Connection",idInfo:this.idInfo,funcName:e};return Promise.reject(new i.WorkerError(`${this.idInfo.side} Endpoint's call.${e} called after close`,t))}const a=t.callTimeout??this.getCallTimeout?.()??1/0;return this.sendCall(e,n,a,r)},t.callTimeout=void 0,t}constructor(e,t){this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=(0,o.createEmptyRecord)();const r=()=>this.onClose?.(),n={[s.Invoke]:this.onInvoke.bind(this),[s.Result]:this.onResult.bind(this),[s.Names]:({funcNames:e})=>{this.onImports?.((0,o.createObjectFromFunction)(this.createPostProxy.bind(this),e),(0,o.createObjectFromFunction)(this.createCallProxy.bind(this),e))},[s.Close]:r},a={[s.Invoke]:this.onSendInvokeFailed.bind(this),[s.Result]:this.onSendResultFailed.bind(this),[s.Names]:r,[s.Close]:r};this.port.onmessage=({data:e})=>n[e.kind](e),this.port.onmessageerror=({data:e})=>a[e.kind](e)}}},5221:function(e,t){"use strict";function r(e){return n(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function n(e){if(null==e)return!1;if(e instanceof Error)return!0;const t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return{...e,error:e.error?i(e.error):void 0}}function i(e){return{name:e.name,message:r(e)?e.baseMessage:e.message,stack:e.stack,info:r(e)?a(e.info):void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.encodeResultValue=t.encodeError=t.encodeWorkerErrorInfo=t.asError=t.isError=t.isWorkerError=void 0,t.isWorkerError=r,t.isError=n,t.asError=function(e){return n(e)?e:new Error(`(non-Error object) ${function(e){const t=typeof e;switch(t){case"function":case"symbol":case"undefined":return`<${t}>`;case"object":return JSON.stringify(e);default:return`${e}`}}(e)}`)},t.encodeWorkerErrorInfo=a,t.encodeError=i,t.encodeResultValue=function(e){return n(e)?{isError:!0,value:i(e)}:{isError:!1,value:e}}},9480:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTypedFeatureGate=t.isTypedChangeGateEnabled=void 0;const n=r(3219);t.isTypedChangeGateEnabled=(0,n.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]),t.getTypedFeatureGate=(0,n.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0})},7181:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createObjectFromFunction=t.haveNativeProxy=t.getFunctionPropertyNames=t.createEmptyRecord=t.setCallbacksTimeout=t.maxTimeout=t.promiseFinally=void 0;const n=r(9480);function a(){const e=Object.create(null);return e.key=void 0,delete e.key,e}let i;t.promiseFinally=function(e,t){return e.then((e=>(t(),e)),(e=>(t(),Promise.reject(e))))},t.maxTimeout=1<<30,t.setCallbacksTimeout=function(e,r,n){if(e>t.maxTimeout)return n;const a=setTimeout(r,Math.max(0,e));return{resolve:e=>{clearTimeout(a),n.resolve(e)},reject:e=>{clearTimeout(a),n.reject(e)}}},t.createEmptyRecord=a,t.getFunctionPropertyNames=function(e){const t=a();for(;null!=e;){for(const r of Object.getOwnPropertyNames(e))try{"function"==typeof e[r]&&(t[r]=!0)}catch(e){}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)},t.haveNativeProxy=function(){return i??(i=function(){try{return"function"==typeof Proxy&&!0===new Proxy({},{get:()=>!0}).k}catch(e){return!1}}())},t.createObjectFromFunction=function(e,t){const r=a(),i=(0,n.isTypedChangeGateEnabled)("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?(t,r)=>"then"===r?void 0:t[r]??(t[r]=e(r)):(t,r)=>t[r]??(t[r]=e(r));return t?(t.forEach((e=>i(r,e))),r):new Proxy(r,{get:i})}},2156:function(e,t){"use strict";function r(e,t,r){const n=e.indexOf("?");if(n<0)return`${e}?${t}=${r}`;const a=e.slice(0,n+1),i=e.slice(n+1).split("&");let o=0;for(;o<i.length&&("="!==i[o][t.length]||i[o].slice(0,t.length)!==t);o+=1);return i[o]=`${t}=${r}`,a+i.join("&")}function n(e,t){let n;for(let a=0;a<=t;a+=1)try{return void importScripts(a>0?r(e,"retries",String(a)):e)}catch(e){n=e}throw n}Object.defineProperty(t,"__esModule",{value:!0}),t.importScriptsWithRetry=void 0,t.importScriptsWithRetry=function(e,t){if(0!==t)for(const r of e)n(r,t);else importScripts(...e)}},6709:function(e,t){"use strict";function r(e){throw new ReferenceError(`${e} is not defined`)}Object.defineProperty(t,"__esModule",{value:!0}),t.paramInsideDef=t.indexObject=void 0,t.indexObject=function(e,t,n=r){try{const r=t.split(".");for(const t of r)e=e[t];return e??n(t)}catch{return n(t)}},t.paramInsideDef=(e,...r)=>t.paramInsideDef.transfer(e,void 0,...r),t.paramInsideDef.transfer=(e,t,...r)=>({def:e,args:r,transferables:t??[]})},3996:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createWorkerStats=t.timePromise=t.stopStopwatch=t.startStopwatch=void 0;const n=r(5221),a="undefined"!=typeof performance&&void 0!==performance.timeOrigin?()=>performance.now()+performance.timeOrigin:()=>Date.now();function i(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,r??a()))}function o(e){return Math.round(1e3*e)/1e3}function s(e,t,r){return e<t?t:e>r?r:e}function u(e,t,r){const n=s(e?.start??1/0,t,r),a=s(e?.end??1/0,t,r);return{status:e?.status??"Pending",start:o(n-t),end:o(a-t),duration:o(a-n)}}t.startStopwatch=function(){return{status:"Pending",start:a()}},t.stopStopwatch=i,t.timePromise=function(e,t){function r(t){throw i(e,(0,n.isWorkerError)(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((t=>i(e,"Success")??t),r)}catch(e){r(e)}},t.createWorkerStats=function(e){const{id:t,createMode:r,createWorker:n,insideInit:a,createOutside:i,createThread:s}=e,{status:l,start:c,end:d}=n;if("Pending"!==l&&void 0!==d)return{id:t,createMode:r,createWorker:{status:l,absStart:c,duration:o(d-c)},createThread:"Thread"===r?u(s,c,d):void 0,createOutside:u(i,c,d),insideInit:u(a,c,d)}}},5523:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Thread=void 0;const a=r(2973),i=r(5915),o=r(6709),s=n(r(8437)),u=r(7181),l=r(3219);let c=-1;t.Thread=class{revokeBlobUrl(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)}createInside(e,t){const{port:r,options:n}=e,o={type:"Thread",side:"Outside",id:n.id},s=this.worker,c=new Promise(((e,u)=>{this.createCallbacks={resolve:e,reject:u};const c={config:(0,a.getSafeParams)(),port:r,options:n,script:this.script,args:this.args,featureGateDictionary:(0,l.getFeatureGateDictionary)(),changeGateDictionary:(0,l.getChangeGateDictionary)()};s.postMessage(c,[r,...this.transferables]),s.onerror=e=>{e.preventDefault();const t=(0,i.getErrorEventWorkerError)(o,"worker.onerror",e);this.createCallbacks?this.createCallbacks.reject(t):(0,a.dispatchWorkerError)(t)},s.onmessage=({data:e})=>{switch(e.kind){case a.ThreadMessageKind.InitResult:return t.insideInit=e.stopwatch,void 0===e.error?this.createCallbacks?.resolve():this.createCallbacks?.reject((0,i.decodeResultValue)(e.error));case a.ThreadMessageKind.WorkerError:return(0,a.dispatchWorkerError)((0,i.decodeResultValue)(e.error));case a.ThreadMessageKind.CreateWorker:return(0,a.dispatchCreateWorker)(e.stats)}}}));return(0,u.promiseFinally)(c,(()=>{this.createCallbacks=void 0}))}terminate(){if(!this.worker)return;const e=this.worker;this.worker=void 0,this.createCallbacks?.resolve(),e.terminate(),this.revokeBlobUrl()}constructor(e,t){try{let r;[this.script,this.args,this.transferables,r]=function(e){const{def:t,args:r,transferables:n}="def"in e?e:(0,o.paramInsideDef)(e);if("function"!=typeof t)return[t,r,n,void 0];const a=`__generatedInsideInit${c+=1}`;return[{scriptUrl:void 0,insideInitName:a},r,n,`var ${a} = ${t.toString()};`]}(t);const n=void 0===r?[s.default]:[r,"\n\n",s.default];this.blobUrl=URL.createObjectURL(new Blob(n,{type:"application/javascript"}));const a={};null!=e.id&&(a.name=e.id),this.worker=new Worker(this.blobUrl,a)}catch(e){throw this.worker?.terminate(),this.revokeBlobUrl(),e}}}},8437:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default='(function(){var threadBootstrap;(()=>{"use strict";var e={530:(e,t,r)=>{r.r(t),r.d(t,{__assign:()=>a,__asyncDelegator:()=>T,__asyncGenerator:()=>j,__asyncValues:()=>G,__await:()=>S,__awaiter:()=>y,__classPrivateFieldGet:()=>W,__classPrivateFieldIn:()=>C,__classPrivateFieldSet:()=>x,__createBinding:()=>h,__decorate:()=>c,__esDecorate:()=>u,__exportStar:()=>g,__extends:()=>o,__generator:()=>_,__importDefault:()=>M,__importStar:()=>E,__makeTemplateObject:()=>k,__metadata:()=>p,__param:()=>s,__propKey:()=>l,__read:()=>b,__rest:()=>i,__runInitializers:()=>f,__setFunctionName:()=>d,__spread:()=>m,__spreadArray:()=>O,__spreadArrays:()=>w,__values:()=>v});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function c(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function s(e,t){return function(r,n){t(r,n,e)}}function u(e,t,r,n,o,a){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var c,s=n.kind,u="getter"===s?"get":"setter"===s?"set":"value",f=!t&&e?n.static?e:e.prototype:null,l=t||(f?Object.getOwnPropertyDescriptor(f,n.name):{}),d=!1,p=r.length-1;p>=0;p--){var y={};for(var _ in n)y[_]="access"===_?{}:n[_];for(var _ in n.access)y.access[_]=n.access[_];y.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(e||null))};var h=(0,r[p])("accessor"===s?{get:l.get,set:l.set}:l[u],y);if("accessor"===s){if(void 0===h)continue;if(null===h||"object"!=typeof h)throw new TypeError("Object expected");(c=i(h.get))&&(l.get=c),(c=i(h.set))&&(l.set=c),(c=i(h.init))&&o.push(c)}else(c=i(h))&&("field"===s?o.push(c):l[u]=c)}f&&Object.defineProperty(f,n.name,l),d=!0}function f(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function l(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function y(e,t,r,n){return new(r||(r=Promise))((function(o,a){function i(e){try{s(n.next(e))}catch(e){a(e)}}function c(e){try{s(n.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,c)}s((n=n.apply(e,t||[])).next())}))}function _(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}var h=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function g(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||h(t,e,r)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,c=a.length;i<c;i++,o++)n[o]=a[i];return n}function O(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function j(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||c(e,t)}))})}function c(e,t){try{(r=o[e](t)).value instanceof S?Promise.resolve(r.value.v).then(s,u):f(a[0][2],r)}catch(e){f(a[0][3],e)}var r}function s(e){c("next",e)}function u(e){c("throw",e)}function f(e,t){e(t),a.shift(),a.length&&c(a[0][0],a[0][1])}}function T(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:S(e[n](t)),done:!1}:o?o(t):t}:o}}function G(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=v(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function k(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var P=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&h(t,e,r);return P(t,e),t}function M(e){return e&&e.__esModule?e:{default:e}}function W(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function C(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},216:(e,t)=>{function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0,t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},448:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;const r={};function n(){return void 0===globalThis.__get_feature_gate_dictionary_variable?r:globalThis.__get_feature_gate_dictionary_variable()}function o(e,t){return n()[e]??t}t.getFeatureGateDictionary=n,t.getStringFeatureGate=o,t.getBooleanFeatureGate=function(e,t){const r=o(e)?.trim().toLowerCase();return"true"===r||"false"!==r&&t},t.getNumberFeatureGate=function(e,t){const r=o(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const n=parseFloat(r);return isNaN(n)?t:n},t.getIntFeatureGate=function(e,t){const r=o(e)?.trim();if(void 0===r)return t;const n=parseInt(r,10);return isNaN(n)?t:n},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t}},400:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(530);n.__exportStar(r(448),t),n.__exportStar(r(187),t),n.__exportStar(r(216),t),n.__exportStar(r(340),t),n.__exportStar(r(56),t),n.__exportStar(r(96),t)},187:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;const n=r(448);t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},340:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;const n=r(216);t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,n.isChangeGateEnabled)(e)}},56:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;const n=r(216);function o(e){const t=(0,n.setChangeGateDictionaryGetter)(void 0);return(0,n.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}t.overrideChangeGates=o,t.overrideTypedChangeGates=function(e,t){return o(t)}},96:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;const n=r(448);function o(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,n.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,n.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}t.overrideFeatureGates=o,t.overrideTypedFeatureGates=function(e,t){return o(t)}},691:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dispatchCreateWorker=t.dispatchWorkerError=t.getCreateMode=t.getCreateTimeout=t.getSafeParams=t.setConfig=t.isThreadingSupported=t.ThreadMessageKind=void 0;const n=r(739);var o;function a(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}let i;function c(e){setTimeout((()=>{throw e}))}function s(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function u(e){const t=s();if(void 0!==t){const r={kind:o.WorkerError,error:(0,n.encodeResultValue)(e)};t.postMessage(r)}else console.warn(e)}function f(e){const t=s();if(void 0!==t){const r={kind:o.CreateWorker,stats:e};t.postMessage(r)}}!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(o||(t.ThreadMessageKind=o={})),t.isThreadingSupported=a,t.setConfig=function(e){if(i)throw new TypeError("setConfig has already been called");i=e},t.getSafeParams=function(){const e=i??{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?[...e.importScriptUrls]:void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}},t.getCreateTimeout=function(e){return e?.createTimeout??i?.createTimeout??3e5},t.getCreateMode=function(e){const t=e?.createMode??i?.createMode??"Thread";return"ThreadOrLocal"===t?a()?"Thread":"Local":t},t.dispatchWorkerError=function(e){try{(i?.onWorkerError??u)(e)}catch(t){console.warn(e),c(t)}},t.dispatchCreateWorker=function(e){try{(i?.onCreateWorker??f)(e)}catch(e){c(e)}}},739:(e,t)=>{function r(e){return n(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function n(e){if(null==e)return!1;if(e instanceof Error)return!0;const t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function o(e){return{...e,error:e.error?a(e.error):void 0}}function a(e){return{name:e.name,message:r(e)?e.baseMessage:e.message,stack:e.stack,info:r(e)?o(e.info):void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.encodeResultValue=t.encodeError=t.encodeWorkerErrorInfo=t.asError=t.isError=t.isWorkerError=void 0,t.isWorkerError=r,t.isError=n,t.asError=function(e){return n(e)?e:new Error(`(non-Error object) ${function(e){const t=typeof e;switch(t){case"function":case"symbol":case"undefined":return`<${t}>`;case"object":return JSON.stringify(e);default:return`${e}`}}(e)}`)},t.encodeWorkerErrorInfo=o,t.encodeError=a,t.encodeResultValue=function(e){return n(e)?{isError:!0,value:a(e)}:{isError:!1,value:e}}},762:(e,t)=>{function r(e,t,r){const n=e.indexOf("?");if(n<0)return`${e}?${t}=${r}`;const o=e.slice(0,n+1),a=e.slice(n+1).split("&");let i=0;for(;i<a.length&&("="!==a[i][t.length]||a[i].slice(0,t.length)!==t);i+=1);return a[i]=`${t}=${r}`,o+a.join("&")}function n(e,t){let n;for(let o=0;o<=t;o+=1)try{return void importScripts(o>0?r(e,"retries",String(o)):e)}catch(e){n=e}throw n}Object.defineProperty(t,"__esModule",{value:!0}),t.importScriptsWithRetry=void 0,t.importScriptsWithRetry=function(e,t){if(0!==t)for(const r of e)n(r,t);else importScripts(...e)}},619:(e,t)=>{function r(e){throw new ReferenceError(`${e} is not defined`)}Object.defineProperty(t,"__esModule",{value:!0}),t.paramInsideDef=t.indexObject=void 0,t.indexObject=function(e,t,n=r){try{const r=t.split(".");for(const t of r)e=e[t];return e??n(t)}catch{return n(t)}},t.paramInsideDef=(e,...r)=>t.paramInsideDef.transfer(e,void 0,...r),t.paramInsideDef.transfer=(e,t,...r)=>({def:e,args:r,transferables:t??[]})},506:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createWorkerStats=t.timePromise=t.stopStopwatch=t.startStopwatch=void 0;const n=r(739),o="undefined"!=typeof performance&&void 0!==performance.timeOrigin?()=>performance.now()+performance.timeOrigin:()=>Date.now();function a(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,r??o()))}function i(e){return Math.round(1e3*e)/1e3}function c(e,t,r){return e<t?t:e>r?r:e}function s(e,t,r){const n=c(e?.start??1/0,t,r),o=c(e?.end??1/0,t,r);return{status:e?.status??"Pending",start:i(n-t),end:i(o-t),duration:i(o-n)}}t.startStopwatch=function(){return{status:"Pending",start:o()}},t.stopStopwatch=a,t.timePromise=function(e,t){function r(t){throw a(e,(0,n.isWorkerError)(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((t=>a(e,"Success")??t),r)}catch(e){r(e)}},t.createWorkerStats=function(e){const{id:t,createMode:r,createWorker:n,insideInit:o,createOutside:a,createThread:c}=e,{status:u,start:f,end:l}=n;if("Pending"===u||void 0===l)return;return{id:t,createMode:r,createWorker:{status:u,absStart:f,duration:i(l-f)},createThread:"Thread"===r?s(c,f,l):void 0,createOutside:s(a,f,l),insideInit:s(o,f,l)}}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{var e=n;Object.defineProperty(e,"__esModule",{value:!0});const t=r(739),o=r(619),a=r(691),i=r(506),c=r(762),s=r(400);self.onmessage=({data:{config:e,port:r,options:n,script:u,args:f,featureGateDictionary:l,changeGateDictionary:d}})=>{self.onmessage=null,self.__typed_workers_thread=!0,(0,s.setFeatureGateDictionaryGetter)((()=>l)),(0,s.setChangeGateDictionaryGetter)((()=>d));const p=n.importScriptsMaxRetries??e.importScriptsMaxRetries??0;let y;function _(){if(y)return y;if(void 0===e.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return(0,c.importScriptsWithRetry)([e.typedWorkersUrl],p),y=(0,o.indexObject)(self,e.typedWorkersName??"typedWorkers"),y.setConfig(e),y}const h=(0,i.startStopwatch)();function g(e,r){const n=e?void 0:(0,t.encodeResultValue)((0,t.asError)(r)),o={kind:a.ThreadMessageKind.InitResult,error:n,stopwatch:h};self.postMessage(o),e||setTimeout(self.close.bind(self),6e4)}try{(0,i.timePromise)(h,(()=>{(0,c.importScriptsWithRetry)([...n?.importScriptUrls??e.importScriptUrls??[],...void 0!==u.scriptUrl?[u.scriptUrl]:[]],p);return(0,o.indexObject)(self,u.insideInitName)({config:e,importTypedWorkers:_,connection:{port:r,options:n,createMode:"Thread"}},...f)})).then((()=>g(!0)),(e=>g(!1,e)))}catch(e){g(!1,e)}}})(),threadBootstrap=n})();})()'},5915:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodeResultValue=t.decodeWorkerErrorInfo=t.decodeError=t.knownErrorClasses=t.getErrorEventWorkerError=t.WorkerError=void 0;const n=r(5221);class a extends Error{constructor(e,t){super(`${e}; info = ${JSON.stringify({...t,error:t.error?.message})}`),this.baseMessage=e,this.info=t,this.name="WorkerError"}}function i(e){let r;if("WorkerError"===e.name)r=new a(e.message,o(e.info));else{const n=t.knownErrorClasses[e.name];n?r=new n(e.message):(r=new Error(e.message),r.name=e.name)}return null!=e.stack&&(r.stack=e.stack),r}function o(e){return{...e,error:e.error?i(e.error):void 0}}t.WorkerError=a,a.isWorkerError=n.isWorkerError,t.getErrorEventWorkerError=function(e,t,r){if((0,n.isError)(r.error)){if((0,n.isWorkerError)(r.error))return r.error;const i={cause:"UnhandledError",idInfo:e,error:r.error};return new a(`${t} received an unhandled error`,i)}if(null==r.message)return new a(`${t} received a non-error (worker script fetch probably failed)`,{cause:"UnhandledError",idInfo:e});const i={cause:"UnhandledError",idInfo:e},o=`${r.message} at ${r.filename}:${r.lineno}:${r.colno}`;return new a(`${t} received an unhandled error: ${o}`,i)},t.knownErrorClasses={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError},t.decodeError=i,t.decodeWorkerErrorInfo=o,t.decodeResultValue=function(e){return e.isError?i(e.value):e.value}},2668:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.workerName=t.isWorkerThread=void 0,t.isWorkerThread=function(){return"undefined"!=typeof WorkerGlobalScope},t.workerName=function(){return self.name}}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};!function(){"use strict";var e=n;Object.defineProperty(e,"__esModule",{value:!0}),e.ConsistentAnonymizer=e.x10TypesSubpackage=e.syntaxSubpackage=e.runtimeSubpackage=e.recalcSubpackage=e.numfmtSubpackage=e.langSubpackage=e.commonSubpackage=e.isTypedChangeGateEnabled=e.getTypedFeatureGate=e.x10=e.style=e.funcs=e.calc=e.runtime=e.numfmt=e.analyze=e.parse=e.date=e.math=e.config=e.util=e.signature=e.value=e.formula=e.location=e.common=e.sheetName=e.ResettableLazy=e.asyncLazy=e.ResolvablePromiseWithLimitedSubscribers=e.FormulaAuthoringHelperSingletonGlobal=e.PluginSchedulerSingletonGlobal=e.packageVersion=void 0;const t=r(3345);var a=r(7591);Object.defineProperty(e,"packageVersion",{enumerable:!0,get:function(){return a.packageVersion}});const i=t.__importStar(r(1912));e.common=i;const o=t.__importStar(r(5854));e.location=o;const s=t.__importStar(r(1175));e.formula=s;const u=t.__importStar(r(34));e.value=u;const l=t.__importStar(r(3607));e.signature=l;const c=t.__importStar(r(3707));e.util=c;const d=t.__importStar(r(5293));e.config=d;const g=t.__importStar(r(6613));e.math=g;const m=t.__importStar(r(8907));e.date=m;const h=t.__importStar(r(7608));e.parse=h;const p=t.__importStar(r(5177));e.analyze=p;const f=t.__importStar(r(4598));e.numfmt=f;const S=t.__importStar(r(3729));e.runtime=S;const v=t.__importStar(r(8728));e.calc=v;const F=t.__importStar(r(3288));e.funcs=F;const y=t.__importStar(r(2534));e.style=y;const b=t.__importStar(r(3438));e.x10=b;const C=r(1861),A=r(2857);e.PluginSchedulerSingletonGlobal=new C.PluginSchedulerSingleton,e.FormulaAuthoringHelperSingletonGlobal=new A.FormulaAuthoringHelperSingleton;const E=r(6366);Object.defineProperty(e,"ResolvablePromiseWithLimitedSubscribers",{enumerable:!0,get:function(){return E.ResolvablePromiseWithLimitedSubscribers}});var T=r(637);Object.defineProperty(e,"asyncLazy",{enumerable:!0,get:function(){return T.asyncLazy}}),Object.defineProperty(e,"ResettableLazy",{enumerable:!0,get:function(){return T.ResettableLazy}});var R=r(429);Object.defineProperty(e,"sheetName",{enumerable:!0,get:function(){return R.sheetName}});const k=r(6366);Object.defineProperty(e,"getTypedFeatureGate",{enumerable:!0,get:function(){return k.getTypedFeatureGate}});const N=r(6366);Object.defineProperty(e,"isTypedChangeGateEnabled",{enumerable:!0,get:function(){return N.isTypedChangeGateEnabled}}),e.commonSubpackage=t.__importStar(r(6366)),e.langSubpackage=t.__importStar(r(6067)),e.numfmtSubpackage=t.__importStar(r(3228)),e.recalcSubpackage=t.__importStar(r(3271)),e.runtimeSubpackage=t.__importStar(r(8073)),e.syntaxSubpackage=t.__importStar(r(472)),e.x10TypesSubpackage=t.__importStar(r(6058));var I=r(3116);Object.defineProperty(e,"ConsistentAnonymizer",{enumerable:!0,get:function(){return I.ConsistentAnonymizer}})}(),excelOnlineCalc=n}();
//# sourceMappingURL=excelOnlineCalc.min.js.map