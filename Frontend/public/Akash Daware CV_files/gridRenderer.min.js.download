function _define_property(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _object_spread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){_define_property(e,t,n[t])}))}return e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _object_spread_props(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(globalThis,(function(){return function(){"use strict";var e,t,n={440:function(e,t,n){n.r(t),n.d(t,{__assign:function(){return i},__asyncDelegator:function(){return F},__asyncGenerator:function(){return v},__asyncValues:function(){return T},__await:function(){return I},__awaiter:function(){return f},__classPrivateFieldGet:function(){return H},__classPrivateFieldIn:function(){return P},__classPrivateFieldSet:function(){return M},__createBinding:function(){return m},__decorate:function(){return a},__esDecorate:function(){return d},__exportStar:function(){return p},__extends:function(){return r},__generator:function(){return C},__importDefault:function(){return B},__importStar:function(){return A},__makeTemplateObject:function(){return D},__metadata:function(){return g},__param:function(){return s},__propKey:function(){return u},__read:function(){return S},__rest:function(){return l},__runInitializers:function(){return c},__setFunctionName:function(){return h},__spread:function(){return R},__spreadArray:function(){return b},__spreadArrays:function(){return w},__values:function(){return y}});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return i=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},i.apply(this,arguments)};function l(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}function a(e,t,n,o){var r,i=arguments.length,l=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(i<3?r(l):i>3?r(t,n,l):r(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l}function s(e,t){return function(n,o){t(n,o,e)}}function d(e,t,n,o,r,i){function l(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,s=o.kind,d="getter"===s?"get":"setter"===s?"set":"value",c=!t&&e?o.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,o.name):{}),h=!1,g=n.length-1;g>=0;g--){var f={};for(var C in o)f[C]="access"===C?{}:o[C];for(var C in o.access)f.access[C]=o.access[C];f.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(l(e||null))};var m=(0,n[g])("accessor"===s?{get:u.get,set:u.set}:u[d],f);if("accessor"===s){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(a=l(m.get))&&(u.get=a),(a=l(m.set))&&(u.set=a),(a=l(m.init))&&r.push(a)}else(a=l(m))&&("field"===s?r.push(a):u[d]=a)}c&&Object.defineProperty(c,o.name,u),h=!0}function c(e,t,n){for(var o=arguments.length>2,r=0;r<t.length;r++)n=o?t[r].call(e,n):t[r].call(e);return o?n:void 0}function u(e){return"symbol"==typeof e?e:"".concat(e)}function h(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function g(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,n,o){return new(n||(n=Promise))((function(r,i){function l(e){try{s(o.next(e))}catch(e){i(e)}}function a(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((o=o.apply(e,t||[])).next())}))}function C(e,t){var n,o,r,i,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(l=0)),l;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,o=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(!((r=(r=l.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){l=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){l.label=a[1];break}if(6===a[0]&&l.label<r[1]){l.label=r[1],r=a;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(a);break}r[2]&&l.ops.pop(),l.trys.pop();continue}a=t.call(e,l)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var m=Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]};function p(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||m(t,e,n)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function S(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)l.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return l}function R(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(S(arguments[t]));return e}function w(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],l=0,a=i.length;l<a;l++,r++)o[r]=i[l];return o}function b(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}function I(e){return this instanceof I?(this.v=e,this):new I(e)}function v(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=n.apply(e,t||[]),i=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(e){r[e]&&(o[e]=function(t){return new Promise((function(n,o){i.push([e,t,n,o])>1||a(e,t)}))})}function a(e,t){try{(n=r[e](t)).value instanceof I?Promise.resolve(n.value.v).then(s,d):c(i[0][2],n)}catch(e){c(i[0][3],e)}var n}function s(e){a("next",e)}function d(e){a("throw",e)}function c(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function F(e){var t,n;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,r){t[o]=e[o]?function(t){return(n=!n)?{value:I(e[o](t)),done:!1}:r?r(t):t}:r}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=y(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,r){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,r,(t=e[n](t)).done,t.value)}))}}}function D(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function A(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&m(t,e,n);return x(t,e),t}function B(e){return e&&e.__esModule?e:{default:e}}function H(e,t,n,o){if("a"===n&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?o:"a"===n?o.call(e):o?o.value:t.get(e)}function M(e,t,n,o,r){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?r.call(e,n):r?r.value=n:t.set(e,n),n}function P(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},396:function(e,t,n){var o,r,i,l,a,s,d,c,u,h,g,f,C,m,p,y,S,R,w,b,I,v,F,T,D,x,A,B,H,M,P,O,k,E,L,N,z,G,W,V,_,U,j,q,$;n.r(t),n.d(t,{AutoFilterType:function(){return b},BackgroundFillType:function(){return C},BorderLineType:function(){return T},BorderPositionType:function(){return D},CFIconSet:function(){return k},CellFormulaType:function(){return w},CellValueType:function(){return R},CellsEncoding:function(){return I},DelayRenderToNextAnimationFrameState:function(){return U},DirtyGridCellArea:function(){return $},DirtyHeaderCellArea:function(){return q},DirtyType:function(){return L},FontSchemeOption:function(){return B},FontUnderline:function(){return x},FontVerticalAlignment:function(){return A},GradientShadingStyle:function(){return f},HitTestEvents:function(){return X},HorizontalAlignment:function(){return p},InCellControlType:function(){return l},InsertButtonType:function(){return o},LocationInCell:function(){return r},MenuDisplayType:function(){return i},MenuEntryIdentifier:function(){return M},MenuItemType:function(){return F},ModelType:function(){return V},OutlineState:function(){return H},PatternStyleType:function(){return W},PivotFilterType:function(){return d},PivotMeasureType:function(){return u},PivotSortInfo:function(){return c},PivotTableDataFieldAggregationType:function(){return a},PivotTableDataFieldFormatType:function(){return s},PythonReturnType:function(){return _},RangeType:function(){return h},ReadingOrderType:function(){return m},RenderFeaturesZIndex:function(){return Y},RenderFlagsArray:function(){return v},RichValueCellType:function(){return P},RichValueIconType:function(){return O},SparklineType:function(){return E},SpillDirection:function(){return j},TolType:function(){return N},UniqueHeadersFontID:function(){return G},UniqueHeadersStyleID:function(){return z},UniqueStyleID:function(){return S},VerticalAlignment:function(){return y},ViewMode:function(){return g}}),function(e){e[e.InsertDot=0]="InsertDot",e[e.InsertButton=1]="InsertButton"}(o||(o={})),function(e){e[e.CellStart=0]="CellStart",e[e.CellEnd=1]="CellEnd"}(r||(r={})),function(e){e[e.Gallery=0]="Gallery",e[e.List=1]="List"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Checkbox=1]="Checkbox",e[e.Dropdown=2]="Dropdown"}(l||(l={})),function(e){e[e.None=-1]="None",e[e.Sum=0]="Sum",e[e.Count=1]="Count",e[e.Average=2]="Average",e[e.Max=3]="Max",e[e.Min=4]="Min",e[e.Product=5]="Product",e[e.CountNumbers=6]="CountNumbers",e[e.StdDeviation=7]="StdDeviation",e[e.StdDeviationPercent=8]="StdDeviationPercent",e[e.Variant=9]="Variant",e[e.VariantPercent=10]="VariantPercent",e[e.DistinctCountPPM=11]="DistinctCountPPM",e[e.Median=12]="Median",e[e.AggregationTypeMax=12]="AggregationTypeMax"}(a||(a={})),function(e){e[e.None=-1]="None",e[e.NoCalculation=0]="NoCalculation",e[e.DifferenceFrom=1]="DifferenceFrom",e[e.PercentOf=2]="PercentOf",e[e.PercentDifferenceFrom=3]="PercentDifferenceFrom",e[e.RunningTotalIn=4]="RunningTotalIn",e[e.PercentOfRowTotal=5]="PercentOfRowTotal",e[e.PercentOfColumnTotal=6]="PercentOfColumnTotal",e[e.PercentOfGrandTotal=7]="PercentOfGrandTotal",e[e.Index=8]="Index",e[e.PercentOfParentRowTotal=9]="PercentOfParentRowTotal",e[e.PercentOfParentColumnTotal=10]="PercentOfParentColumnTotal",e[e.PercentOfParentTotal=11]="PercentOfParentTotal",e[e.PercentRunningTotalIn=12]="PercentRunningTotalIn",e[e.RankSmallestToLargest=13]="RankSmallestToLargest",e[e.RankLargestToSmallest=14]="RankLargestToSmallest",e[e.DataFormatMax=14]="DataFormatMax"}(s||(s={})),function(e){e[e.Invalid=0]="Invalid",e[e.FirstTop10=1]="FirstTop10",e[e.Count=1]="Count",e[e.Percent=2]="Percent",e[e.Sum=3]="Sum",e[e.LastTop10=3]="LastTop10",e[e.CaptionFirst=4]="CaptionFirst",e[e.CaptionEquals=4]="CaptionEquals",e[e.CaptionDoesNotEqual=5]="CaptionDoesNotEqual",e[e.CaptionBeginsWith=6]="CaptionBeginsWith",e[e.CaptionDoesNotBeginWith=7]="CaptionDoesNotBeginWith",e[e.CaptionEndsWith=8]="CaptionEndsWith",e[e.CaptionDoesNotEndWith=9]="CaptionDoesNotEndWith",e[e.CaptionContains=10]="CaptionContains",e[e.CaptionDoesNotContain=11]="CaptionDoesNotContain",e[e.CaptionIsGreaterThan=12]="CaptionIsGreaterThan",e[e.CaptionIsGreaterThanOrEqualTo=13]="CaptionIsGreaterThanOrEqualTo",e[e.CaptionIsLessThan=14]="CaptionIsLessThan",e[e.CaptionIsLessThanOrEqualTo=15]="CaptionIsLessThanOrEqualTo",e[e.CaptionIsBetween=16]="CaptionIsBetween",e[e.CaptionIsNotBetween=17]="CaptionIsNotBetween",e[e.ValueFirst=18]="ValueFirst",e[e.ValueEqual=18]="ValueEqual",e[e.ValueNotEqual=19]="ValueNotEqual",e[e.ValueGreaterThan=20]="ValueGreaterThan",e[e.ValueGreaterThanOrEqual=21]="ValueGreaterThanOrEqual",e[e.ValueLessThan=22]="ValueLessThan",e[e.ValueLessThanOrEqual=23]="ValueLessThanOrEqual",e[e.ValueBetween=24]="ValueBetween",e[e.ValueNotBetween=25]="ValueNotBetween",e[e.DateFirst=26]="DateFirst",e[e.DateEquals=26]="DateEquals",e[e.DateOlderThan=27]="DateOlderThan",e[e.DateNewerThan=28]="DateNewerThan",e[e.DateBetween=29]="DateBetween",e[e.DateTomorrow=30]="DateTomorrow",e[e.DateToday=31]="DateToday",e[e.DateYesterday=32]="DateYesterday",e[e.DateNextWeek=33]="DateNextWeek",e[e.DateThisWeek=34]="DateThisWeek",e[e.DateLastWeek=35]="DateLastWeek",e[e.DateNextMonth=36]="DateNextMonth",e[e.DateThisMonth=37]="DateThisMonth",e[e.DateLastMonth=38]="DateLastMonth",e[e.DateNextQuarter=39]="DateNextQuarter",e[e.DateThisQuarter=40]="DateThisQuarter",e[e.DateLastQuarter=41]="DateLastQuarter",e[e.DateNextYear=42]="DateNextYear",e[e.DateThisYear=43]="DateThisYear",e[e.DateLastYear=44]="DateLastYear",e[e.DateYearToDate=45]="DateYearToDate",e[e.DateAllDatesInPeriodQuarter1=46]="DateAllDatesInPeriodQuarter1",e[e.DateAllDatesInPeriodQuarter2=47]="DateAllDatesInPeriodQuarter2",e[e.DateAllDatesInPeriodQuarter3=48]="DateAllDatesInPeriodQuarter3",e[e.DateAllDatesInPeriodQuarter4=49]="DateAllDatesInPeriodQuarter4",e[e.DateAllDatesInPeriodJanuary=50]="DateAllDatesInPeriodJanuary",e[e.DateAllDatesInPeriodFebruary=51]="DateAllDatesInPeriodFebruary",e[e.DateAllDatesInPeriodMarch=52]="DateAllDatesInPeriodMarch",e[e.DateAllDatesInPeriodApril=53]="DateAllDatesInPeriodApril",e[e.DateAllDatesInPeriodMay=54]="DateAllDatesInPeriodMay",e[e.DateAllDatesInPeriodJune=55]="DateAllDatesInPeriodJune",e[e.DateAllDatesInPeriodJuly=56]="DateAllDatesInPeriodJuly",e[e.DateAllDatesInPeriodAugust=57]="DateAllDatesInPeriodAugust",e[e.DateAllDatesInPeriodSeptember=58]="DateAllDatesInPeriodSeptember",e[e.DateAllDatesInPeriodOctober=59]="DateAllDatesInPeriodOctober",e[e.DateAllDatesInPeriodNovember=60]="DateAllDatesInPeriodNovember",e[e.DateAllDatesInPeriodDecember=61]="DateAllDatesInPeriodDecember",e[e.DateNotEqual=62]="DateNotEqual",e[e.DateOlderOrEqual=63]="DateOlderOrEqual",e[e.DateNewerOrEqual=64]="DateNewerOrEqual",e[e.DateNotBetween=65]="DateNotBetween",e[e.Last=65]="Last"}(d||(d={})),function(e){e[e.None=0]="None",e[e.SortAscending=1]="SortAscending",e[e.SortDescending=2]="SortDescending",e[e.SortAscendingByValue=3]="SortAscendingByValue",e[e.SortDescendingByValue=4]="SortDescendingByValue"}(c||(c={})),function(e){e[e.None=0]="None",e[e.Explicit=1]="Explicit",e[e.Implicit=2]="Implicit"}(u||(u={})),function(e){e[e.Unknown=0]="Unknown",e[e.UsedRange=1]="UsedRange",e[e.PivotTable=2]="PivotTable",e[e.Hyperlink=3]="Hyperlink",e[e.Autofilter=4]="Autofilter",e[e.DataValidation=5]="DataValidation",e[e.Sparkline=6]="Sparkline",e[e.FloatingObjectAnchor=7]="FloatingObjectAnchor",e[e.DynamicArray=8]="DynamicArray",e[e.AutoDetect=9]="AutoDetect"}(h||(h={})),function(e){e[e.Default=0]="Default",e[e.NamedSheetView=1]="NamedSheetView",e[e.PresentMode=2]="PresentMode"}(g||(g={})),function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal",e[e.ReversedVertical=2]="ReversedVertical",e[e.ReversedHorizontal=3]="ReversedHorizontal",e[e.DiagonalUp=4]="DiagonalUp",e[e.DiagonalDown=5]="DiagonalDown",e[e.ReversedDiagonalUp=6]="ReversedDiagonalUp",e[e.ReversedDiagonalDown=7]="ReversedDiagonalDown",e[e.TopLeftCorner=8]="TopLeftCorner",e[e.TopRightCorner=9]="TopRightCorner",e[e.BottomLeftCorner=10]="BottomLeftCorner",e[e.BottomRightCorner=11]="BottomRightCorner",e[e.Center=12]="Center"}(f||(f={})),function(e){e[e.Solid=0]="Solid",e[e.Gradient=1]="Gradient"}(C||(C={})),function(e){e[e.Context=0]="Context",e[e.LeftToRight=1]="LeftToRight",e[e.RightToLeft=2]="RightToLeft"}(m||(m={})),function(e){e[e.Automatic=0]="Automatic",e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right",e[e.Fill=4]="Fill",e[e.Justify=5]="Justify",e[e.CenterAcrossSelection=6]="CenterAcrossSelection",e[e.Distributed=7]="Distributed",e[e.JustifyDistributed=8]="JustifyDistributed"}(p||(p={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom",e[e.Justify=3]="Justify",e[e.Distributed=4]="Distributed"}(y||(y={})),function(e){e[e.DefaultBorder=0]="DefaultBorder",e[e.Default=-1]="Default",e[e.Hyperlink=-2]="Hyperlink",e[e.FormulaError=-3]="FormulaError"}(S||(S={})),function(e){e[e.None=0]="None",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=3]="Boolean",e[e.Error=4]="Error"}(R||(R={})),function(e){e[e.Value=0]="Value",e[e.Formula=1]="Formula",e[e.ArrayFormula=2]="ArrayFormula"}(w||(w={})),function(e){e[e.None=0]="None",e[e.Filtered=1]="Filtered",e[e.SortedAsc=2]="SortedAsc",e[e.SortedDesc=3]="SortedDesc",e[e.SortedTop=4]="SortedTop",e[e.SortedBottom=5]="SortedBottom",e[e.BothAsc=6]="BothAsc",e[e.BothDesc=7]="BothDesc",e[e.BothTop=8]="BothTop",e[e.BothBottom=9]="BothBottom",e[e.Sorted=10]="Sorted",e[e.Both=11]="Both"}(b||(b={})),function(e){e[e.None=0]="None",e[e.CData=1]="CData"}(I||(I={})),function(e){e[e.NewVerticalAlignExp=0]="NewVerticalAlignExp",e[e.InCellControls=1]="InCellControls",e[e.FontServiceIntegration=2]="FontServiceIntegration",e[e.TextWidthClientPhase2=3]="TextWidthClientPhase2",e[e.CanvasHitTest=4]="CanvasHitTest",e[e.TextWidthClientNewProcessing=5]="TextWidthClientNewProcessing",e[e.FiltersUXModernization=6]="FiltersUXModernization",e[e.HeaderDragImprovements=8]="HeaderDragImprovements",e[e.DelayRenderToNextAnimationFrame=9]="DelayRenderToNextAnimationFrame",e[e.ResizeHeaderUXModernization=10]="ResizeHeaderUXModernization",e[e.RenderHeaderOutlinesInCanvas=11]="RenderHeaderOutlinesInCanvas",e[e.RenderHeaderSnappingInCanvas=12]="RenderHeaderSnappingInCanvas",e[e.DoubleBorderFormattingFix=13]="DoubleBorderFormattingFix",e[e.WrapTextCse=14]="WrapTextCse",e[e.RenderResizePill=16]="RenderResizePill",e[e.FormulaViewCellImagesFix=17]="FormulaViewCellImagesFix",e[e.ModernFontPicker=19]="ModernFontPicker",e[e.DoubleBorderMergeCellFix=20]="DoubleBorderMergeCellFix",e[e.DoubleBorderBlockEdgeFix=21]="DoubleBorderBlockEdgeFix",e[e.TextWidthClientPhase1=22]="TextWidthClientPhase1",e[e.TableSelectorsHitTest=23]="TableSelectorsHitTest",e[e.CanvasHeaders=24]="CanvasHeaders",e[e.TextOrientationSlice1=25]="TextOrientationSlice1",e[e.ByExamplePreviewMode=26]="ByExamplePreviewMode",e[e.ShowDynamicImageCardOnHover=27]="ShowDynamicImageCardOnHover",e[e.TextOrientationSlice2=28]="TextOrientationSlice2",e[e.TableBordersInHighContrast=29]="TableBordersInHighContrast",e[e.UseOffscreenCanvas=30]="UseOffscreenCanvas",e[e.RenderPatternStyle=33]="RenderPatternStyle",e[e.GlobalStylesSlice1=34]="GlobalStylesSlice1",e[e.NewDefaultTemplate=35]="NewDefaultTemplate",e[e.GlobalStylesSlice2=37]="GlobalStylesSlice2",e[e.GlobalStylesSlice3=39]="GlobalStylesSlice3",e[e.HideColumnSlice1=40]="HideColumnSlice1",e[e.HideColumnMergedCellSlice1=41]="HideColumnMergedCellSlice1",e[e.HideColumnAutoFilterSlice1=42]="HideColumnAutoFilterSlice1",e[e.HideColumnFormulaSlice1=43]="HideColumnFormulaSlice1",e[e.MoveSpillCellBeforeRendering=44]="MoveSpillCellBeforeRendering",e[e.NewThemeFontForHeaderFBarNBox=45]="NewThemeFontForHeaderFBarNBox"}(v||(v={})),function(e){e[e.None=0]="None",e[e.Flyout=1]="Flyout",e[e.Toggle=2]="Toggle",e[e.Button=3]="Button"}(F||(F={})),function(e){e[e.None=0]="None",e[e.Thin=1]="Thin",e[e.Medium=2]="Medium",e[e.Dashed=3]="Dashed",e[e.Dotted=4]="Dotted",e[e.Thick=5]="Thick",e[e.Double=6]="Double",e[e.Hair=7]="Hair",e[e.MediumDashed=8]="MediumDashed",e[e.DashDot=9]="DashDot",e[e.MediumDashDot=10]="MediumDashDot",e[e.DashDotDot=11]="DashDotDot",e[e.MediumDashDotDot=12]="MediumDashDotDot",e[e.SlantDashDot=13]="SlantDashDot"}(T||(T={})),function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Diagonal=4]="Diagonal",e[e.Vertical=5]="Vertical",e[e.Horizontal=6]="Horizontal",e[e.BorderMax=7]="BorderMax"}(D||(D={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.Double=2]="Double",e[e.SingleAccounting=3]="SingleAccounting",e[e.DoubleAccounting=4]="DoubleAccounting"}(x||(x={})),function(e){e[e.None=0]="None",e[e.Subscript=1]="Subscript",e[e.Superscript=2]="Superscript"}(A||(A={})),function(e){e[e.None=0]="None",e[e.Major=1]="Major",e[e.Minor=2]="Minor"}(B||(B={})),function(e){e[e.None=0]="None",e[e.Expanded=1]="Expanded",e[e.Collapsed=2]="Collapsed"}(H||(H={})),function(e){e[e.None=0]="None",e[e.CustomSort=1]="CustomSort",e[e.Filter=2]="Filter",e[e.SheetViewDefault=3]="SheetViewDefault",e[e.SheetViewTemp=4]="SheetViewTemp",e[e.SheetViewSwitch=5]="SheetViewSwitch",e[e.SheetViewMoreViews=6]="SheetViewMoreViews",e[e.SheetViewCreate=7]="SheetViewCreate",e[e.SheetViewOptions=8]="SheetViewOptions",e[e.GenericScript=9]="GenericScript",e[e.ClearFilter=10]="ClearFilter",e[e.ShowRichFieldsList=11]="ShowRichFieldsList",e[e.ShowPivotFilter=12]="ShowPivotFilter",e[e.SortByValue=13]="SortByValue",e[e.SortAscending=14]="SortAscending",e[e.SortDescending=15]="SortDescending",e[e.FieldListToReportFilter=16]="FieldListToReportFilter",e[e.FieldListToRowLabels=17]="FieldListToRowLabels",e[e.FieldListToColumnLabels=18]="FieldListToColumnLabels",e[e.FieldListToValues=19]="FieldListToValues",e[e.FieldListAddAsSlicer=20]="FieldListAddAsSlicer",e[e.RemoveFilter=21]="RemoveFilter",e[e.FilterType=22]="FilterType",e[e.FilterPivot=23]="FilterPivot",e[e.FilterSubMenu=24]="FilterSubMenu",e[e.FieldSubMenu=25]="FieldSubMenu",e[e.SheetViewSubMenu=26]="SheetViewSubMenu",e[e.GenericSortAscending=27]="GenericSortAscending",e[e.GenericSortDescending=28]="GenericSortDescending",e[e.RemovePivotFilter=29]="RemovePivotFilter",e[e.SortAtoZ=30]="SortAtoZ",e[e.SortZtoA=31]="SortZtoA",e[e.SortSmallestToLargest=32]="SortSmallestToLargest",e[e.SortLargestToSmallest=33]="SortLargestToSmallest",e[e.SortOldestToNewest=34]="SortOldestToNewest",e[e.SortNewestToOldest=35]="SortNewestToOldest",e[e.SortByColor=36]="SortByColor",e[e.FilterByColor=37]="FilterByColor",e[e.AnalyzeData=38]="AnalyzeData",e[e.Skeleton=39]="Skeleton"}(M||(M={})),function(e){e[e.None=0]="None",e[e.AmbiguousLinkedEntity=1]="AmbiguousLinkedEntity",e[e.ConnectedLinkedEntityBlocked=2]="ConnectedLinkedEntityBlocked",e[e.ConnectedLinkedEntityNotBlocked=3]="ConnectedLinkedEntityNotBlocked",e[e.DisconnectedLinkedEntity=4]="DisconnectedLinkedEntity",e[e.RichError=5]="RichError",e[e.ImageUrl=6]="ImageUrl",e[e.OtherRichValue=7]="OtherRichValue"}(P||(P={})),function(e){e[e.Disambiguation=0]="Disambiguation",e[e.Sync=1]="Sync",e[e.LinkedEntity=2]="LinkedEntity"}(O||(O={})),function(e){e[e.ThreeArrowsColored=0]="ThreeArrowsColored",e[e.ThreeArrowsGray=1]="ThreeArrowsGray",e[e.ThreeFlags=2]="ThreeFlags",e[e.ThreeTrafficLightsUnrimmed=3]="ThreeTrafficLightsUnrimmed",e[e.ThreeTrafficLightsRimmed=4]="ThreeTrafficLightsRimmed",e[e.ThreeSigns=5]="ThreeSigns",e[e.ThreeSymbolsCircled=6]="ThreeSymbolsCircled",e[e.ThreeSymbolsUncircled=7]="ThreeSymbolsUncircled",e[e.FourArrowsColored=8]="FourArrowsColored",e[e.FourArrowsGray=9]="FourArrowsGray",e[e.RedToBlack=10]="RedToBlack",e[e.FourRatings=11]="FourRatings",e[e.FourTrafficLights=12]="FourTrafficLights",e[e.FiveArrowsColored=13]="FiveArrowsColored",e[e.FiveArrowsGray=14]="FiveArrowsGray",e[e.FiveRatings=15]="FiveRatings",e[e.FiveQuarters=16]="FiveQuarters",e[e.ThreeStarts=17]="ThreeStarts",e[e.ThreeTriangles=18]="ThreeTriangles",e[e.FiveBoxes=19]="FiveBoxes"}(k||(k={})),function(e){e[e.Line=0]="Line",e[e.Column=1]="Column",e[e.Stacked=2]="Stacked"}(E||(E={})),function(e){e[e.None=0]="None",e[e.ModelCellChanges=2]="ModelCellChanges",e[e.ModelCoreChanges=4]="ModelCoreChanges",e[e.ScaleFactorChange=8]="ScaleFactorChange",e[e.ViewportChange=16]="ViewportChange",e[e.ExternalChanges=32]="ExternalChanges",e[e.NoCanvasCache=64]="NoCanvasCache",e[e.ModelCellPreviewChanges=128]="ModelCellPreviewChanges"}(L||(L={})),function(e){e[e.None=0]="None",e[e.Autofit=1]="Autofit",e[e.Spill=2]="Spill"}(N||(N={})),function(e){e[e.Default=-1]="Default",e[e.PartialRowColSelection=0]="PartialRowColSelection",e[e.WholeRowColSelection=1]="WholeRowColSelection",e[e.Hover=2]="Hover",e[e.PartialSelectionAndHover=3]="PartialSelectionAndHover",e[e.WholeSelectionAndHover=4]="WholeSelectionAndHover",e[e.NoHeadings=5]="NoHeadings",e[e.PartialRowColSelectionLeftAlignment=6]="PartialRowColSelectionLeftAlignment",e[e.PartialRowColSelectionRightAlignment=7]="PartialRowColSelectionRightAlignment",e[e.WholeRowColSelectionLeftAlignment=8]="WholeRowColSelectionLeftAlignment",e[e.WholeRowColSelectionRightAlignment=9]="WholeRowColSelectionRightAlignment",e[e.HoverLeftAlignment=10]="HoverLeftAlignment",e[e.HoverRightAlignment=11]="HoverRightAlignment",e[e.PartialSelectionAndHoverLeftAlignment=12]="PartialSelectionAndHoverLeftAlignment",e[e.PartialSelectionAndHoverRightAlignment=13]="PartialSelectionAndHoverRightAlignment",e[e.WholeSelectionAndHoverLeftAlignment=14]="WholeSelectionAndHoverLeftAlignment",e[e.WholeSelectionAndHoverRightAlignment=15]="WholeSelectionAndHoverRightAlignment",e[e.LeftAlignment=16]="LeftAlignment",e[e.RightAlignment=17]="RightAlignment"}(z||(z={})),function(e){e[e.Default=-1]="Default",e[e.Hover=0]="Hover",e[e.PartialSelection=1]="PartialSelection",e[e.PartialSelectionAndHover=2]="PartialSelectionAndHover",e[e.WholeSelection=3]="WholeSelection",e[e.WholeSelectionAndHover=4]="WholeSelectionAndHover"}(G||(G={})),function(e){e[e.None=0]="None",e[e.Solid=1]="Solid",e[e.Gray50=2]="Gray50",e[e.Gray75=3]="Gray75",e[e.Gray25=4]="Gray25",e[e.HorzStripe=5]="HorzStripe",e[e.VertStripe=6]="VertStripe",e[e.ReverseDiagStripe=7]="ReverseDiagStripe",e[e.DiagStripe=8]="DiagStripe",e[e.DiagCross=9]="DiagCross",e[e.ThickDiagCross=10]="ThickDiagCross",e[e.ThinHorzStripe=11]="ThinHorzStripe",e[e.ThinVertStripe=12]="ThinVertStripe",e[e.ThinReverseDiagStripe=13]="ThinReverseDiagStripe",e[e.ThinDiagStripe=14]="ThinDiagStripe",e[e.ThinHorzCross=15]="ThinHorzCross",e[e.ThinDiagCross=16]="ThinDiagCross",e[e.Gray125=17]="Gray125",e[e.Gray0625=18]="Gray0625"}(W||(W={})),function(e){e[e.GridBlockModel=0]="GridBlockModel",e[e.HeaderBlockModel=1]="HeaderBlockModel"}(V||(V={})),function(e){e[e.None=-1]="None",e[e.Value=0]="Value",e[e.Reference=1]="Reference"}(_||(_={})),function(e){e[e.None=0]="None",e[e.Delay=1]="Delay",e[e.DoNotDelay=2]="DoNotDelay"}(U||(U={})),function(e){e[e.Start=-1]="Start",e[e.End=1]="End"}(j||(j={})),function(e){e[e.EntireCell=1]="EntireCell",e[e.GutterArea=2]="GutterArea",e[e.CellStartGridlineArea=4]="CellStartGridlineArea",e[e.CellEndGridlineArea=8]="CellEndGridlineArea"}(q||(q={})),function(e){e[e.EntireCell=1]="EntireCell"}($||($={}));const X=["pointerdown","pointerup","click","mouseenter","mouseleave","touchstart","touchend","dblclick"];var Y;!function(e){e[e.DebugWatermark=0]="DebugWatermark",e[e.Headers=1]="Headers",e[e.DataCleansing=2]="DataCleansing",e[e.HeaderResize=3]="HeaderResize",e[e.UnhideSkittle=4]="UnhideSkittle",e[e.HeaderDragDropSquares=5]="HeaderDragDropSquares",e[e.HeaderInsert=6]="HeaderInsert",e[e.GeneralCellTooltip=7]="GeneralCellTooltip",e[e.DynamicImage=8]="DynamicImage",e[e.Comments=9]="Comments",e[e.RichError=10]="RichError",e[e.DrillIndicator=11]="DrillIndicator",e[e.Hyperlink=12]="Hyperlink",e[e.ColumnOrRowSelector=13]="ColumnOrRowSelector",e[e.TableSelector=14]="TableSelector",e[e.RichValueIcon=15]="RichValueIcon",e[e.AutoFilter=16]="AutoFilter",e[e.CheckboxIcon=17]="CheckboxIcon"}(Y||(Y={}))},465:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.PartialRowColSelectionBackgroundColor=t.PartialRowColSelectionHCFontColor=t.DefaultHiddenRowColInnerGapPx=t.MinimalCellExtent=t.DefaultHeaderFontSize=t.DefaultHeaderBackgroundColor=t.DefaultRowHeaderWidth=t.DefaultColHeaderHeight=t.RowHeaderWidthWithDragSquaresArea=t.ColHeaderHeightWithDragSquaresArea=t.getRowHeaderStylesArray=t.createHeaderCell=t.calculateRowHeaderWidth=t.columnNumberToTitle=t.createHeaderBlockModel=t.CalcBlockModel=t.verifyArgumentNotNull=t.overrideRenderFlagForMismatch=t.isRenderFlagEnabled=t.isPartialHeaderCellRenderingEnabled=t.isFixFullySelectedGridLinesBetweenBlocksEnabled=t.isRenderResizePillAcrossBlockEnabled=t.isFontRefactorFGV3Enabled=t.preprocessStyles=t.isHeaderInsertEnabled=t.isIncreasedHeaderSizeEnabled=t.processGlobalStyles=t.getCellBorderStyle=t.initCellLookup=t.validateCellShouldExistInModelUnsafe=t.getRenderingRegionHitTestCache=t.getOrCreateCell=t.cellsPositionComparer=t.getCellStyle=t.getCell=t.isDifferentialRenderingSupported=t.cleanHitTestCache=t.initModelClientCache=t.getModelClientCache=t.getAdjacentCellsKeysOld=t.getAdjacentCellsKeys=t.getSpilledOverCount=t.getRowColFromCellKey=t.uniqueValuesFilter=t.getAllSpanningCellsKeys=t.getDefaultCell=t.isAccAndCustomNumFmtApplicable=t.shouldOverrideText=t.getReferencedObjectToCache=t.getCellLookupKey=void 0,t.getGlobalBorderStyleMap=t.getGlobalStyleId=t.getGlobalStylesTelemetry=t.preprocessModelStyles=t.StyleType=t.generateKeyFromModelStyles=t.isPassRibbonCommandsToCanvasRendererEnabled=t.isChangeGateEnabled=t.ChangeGate=t.MaxBitsPerRenderFlag=t.MaxAllowedRowColCount=t.isModelCellContainedInRange=t.getCellLog=t.getRangeLog=t.isCellContainedInRange=t.getRangeTopLeftCell=t.getReferencedObjectById=t.compareHeaderBlockModels=t.areMergeInformationEqual=t.areNumberFormatInformationEqual=t.areInCellControlOptionsEqual=t.areGridArraysEqual=t.areGridCellsEqual=t.comparePartialGridBlockModels=t.compareGridBlockModels=t.areFormattedTextsEqual=t.annonymize=t.serializeCell=t.HoverFontColor=t.WholeRowColSelectionBackgroundColor=t.HoverHeadersStylesSet=t.WholeSelectionHeadersStylesSet=t.PartiallySelectionHeadersStylesSet=t.NSVGridinesColor=t.NSVOutlinesColor=t.OutlinesColor=t.SelectedCellsGridlinesColor=t.NSVHeaderBackgroundColor=t.ColumnHeadersStylesArray=t.RowHeadersStylesArrayBeforeHeaderDragImprovements=t.RowHeadersStylesArray=t.HeadersFonts=t.OldHeadersFonts=t.ColumnHeadersNSVStylesArray=t.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements=t.RowHeadersNSVStylesArray=t.HeadersNSVFonts=t.OldHeadersNSVFonts=t.PartialSelectionFontColor=t.PartialRowColSelectionAndHoverBackgroundColor=void 0,t.isGetStyleFixChangeGateEnabled=t.getCellStyleByID=t.getFontByID=t.getBorderStyleByID=t.isGlobalFontsAndCellStylesEnabled=t.isGlobalFontsAndCellStylesFlightEnabled=t.disableGlobalFonts=t.disableGlobalCellStyles=t.GlobalCellStyles=t.getGlobalCellStylesMap=t.updateGlobalFontIDInCell=t.GlobalFonts=t.getGlobalFontsMap=t.GlobalBorderStyles=t.isGlobalBorderStylesEnabledNew=t.disableGlobalBorderStyles=t.isGlobalBorderStylesEnabled=void 0;const o=n(440);o.__exportStar(n(396),t);var r=n(669);Object.defineProperty(t,"getCellLookupKey",{enumerable:!0,get:function(){return r.getCellLookupKey}}),Object.defineProperty(t,"getReferencedObjectToCache",{enumerable:!0,get:function(){return r.getReferencedObjectToCache}}),Object.defineProperty(t,"shouldOverrideText",{enumerable:!0,get:function(){return r.shouldOverrideText}}),Object.defineProperty(t,"isAccAndCustomNumFmtApplicable",{enumerable:!0,get:function(){return r.isAccAndCustomNumFmtApplicable}}),Object.defineProperty(t,"getDefaultCell",{enumerable:!0,get:function(){return r.getDefaultCell}}),Object.defineProperty(t,"getAllSpanningCellsKeys",{enumerable:!0,get:function(){return r.getAllSpanningCellsKeys}}),Object.defineProperty(t,"uniqueValuesFilter",{enumerable:!0,get:function(){return r.uniqueValuesFilter}}),Object.defineProperty(t,"getRowColFromCellKey",{enumerable:!0,get:function(){return r.getRowColFromCellKey}}),Object.defineProperty(t,"getSpilledOverCount",{enumerable:!0,get:function(){return r.getSpilledOverCount}}),Object.defineProperty(t,"getAdjacentCellsKeys",{enumerable:!0,get:function(){return r.getAdjacentCellsKeys}}),Object.defineProperty(t,"getAdjacentCellsKeysOld",{enumerable:!0,get:function(){return r.getAdjacentCellsKeysOld}}),Object.defineProperty(t,"getModelClientCache",{enumerable:!0,get:function(){return r.getModelClientCache}}),Object.defineProperty(t,"initModelClientCache",{enumerable:!0,get:function(){return r.initModelClientCache}}),Object.defineProperty(t,"cleanHitTestCache",{enumerable:!0,get:function(){return r.cleanHitTestCache}}),Object.defineProperty(t,"isDifferentialRenderingSupported",{enumerable:!0,get:function(){return r.isDifferentialRenderingSupported}}),Object.defineProperty(t,"getCell",{enumerable:!0,get:function(){return r.getCell}}),Object.defineProperty(t,"getCellStyle",{enumerable:!0,get:function(){return r.getCellStyle}}),Object.defineProperty(t,"cellsPositionComparer",{enumerable:!0,get:function(){return r.cellsPositionComparer}}),Object.defineProperty(t,"getOrCreateCell",{enumerable:!0,get:function(){return r.getOrCreateCell}}),Object.defineProperty(t,"getRenderingRegionHitTestCache",{enumerable:!0,get:function(){return r.getRenderingRegionHitTestCache}}),Object.defineProperty(t,"validateCellShouldExistInModelUnsafe",{enumerable:!0,get:function(){return r.validateCellShouldExistInModelUnsafe}}),Object.defineProperty(t,"initCellLookup",{enumerable:!0,get:function(){return r.initCellLookup}}),Object.defineProperty(t,"getCellBorderStyle",{enumerable:!0,get:function(){return r.getCellBorderStyle}}),Object.defineProperty(t,"processGlobalStyles",{enumerable:!0,get:function(){return r.processGlobalStyles}}),Object.defineProperty(t,"isIncreasedHeaderSizeEnabled",{enumerable:!0,get:function(){return r.isIncreasedHeaderSizeEnabled}}),Object.defineProperty(t,"isHeaderInsertEnabled",{enumerable:!0,get:function(){return r.isHeaderInsertEnabled}}),Object.defineProperty(t,"preprocessStyles",{enumerable:!0,get:function(){return r.preprocessStyles}}),Object.defineProperty(t,"isFontRefactorFGV3Enabled",{enumerable:!0,get:function(){return r.isFontRefactorFGV3Enabled}}),Object.defineProperty(t,"isRenderResizePillAcrossBlockEnabled",{enumerable:!0,get:function(){return r.isRenderResizePillAcrossBlockEnabled}}),Object.defineProperty(t,"isFixFullySelectedGridLinesBetweenBlocksEnabled",{enumerable:!0,get:function(){return r.isFixFullySelectedGridLinesBetweenBlocksEnabled}}),Object.defineProperty(t,"isPartialHeaderCellRenderingEnabled",{enumerable:!0,get:function(){return r.isPartialHeaderCellRenderingEnabled}});var i=n(520);Object.defineProperty(t,"isRenderFlagEnabled",{enumerable:!0,get:function(){return i.isRenderFlagEnabled}}),Object.defineProperty(t,"overrideRenderFlagForMismatch",{enumerable:!0,get:function(){return i.overrideRenderFlagForMismatch}}),Object.defineProperty(t,"verifyArgumentNotNull",{enumerable:!0,get:function(){return i.verifyArgumentNotNull}});var l=n(966);Object.defineProperty(t,"CalcBlockModel",{enumerable:!0,get:function(){return l.CalcBlockModel}});var a=n(755);Object.defineProperty(t,"createHeaderBlockModel",{enumerable:!0,get:function(){return a.createHeaderBlockModel}}),Object.defineProperty(t,"columnNumberToTitle",{enumerable:!0,get:function(){return a.columnNumberToTitle}}),Object.defineProperty(t,"calculateRowHeaderWidth",{enumerable:!0,get:function(){return a.calculateRowHeaderWidth}}),Object.defineProperty(t,"createHeaderCell",{enumerable:!0,get:function(){return a.createHeaderCell}}),Object.defineProperty(t,"getRowHeaderStylesArray",{enumerable:!0,get:function(){return a.getRowHeaderStylesArray}});var s=n(835);Object.defineProperty(t,"ColHeaderHeightWithDragSquaresArea",{enumerable:!0,get:function(){return s.ColHeaderHeightWithDragSquaresArea}}),Object.defineProperty(t,"RowHeaderWidthWithDragSquaresArea",{enumerable:!0,get:function(){return s.RowHeaderWidthWithDragSquaresArea}}),Object.defineProperty(t,"DefaultColHeaderHeight",{enumerable:!0,get:function(){return s.DefaultColHeaderHeight}}),Object.defineProperty(t,"DefaultRowHeaderWidth",{enumerable:!0,get:function(){return s.DefaultRowHeaderWidth}}),Object.defineProperty(t,"DefaultHeaderBackgroundColor",{enumerable:!0,get:function(){return s.DefaultHeaderBackgroundColor}}),Object.defineProperty(t,"DefaultHeaderFontSize",{enumerable:!0,get:function(){return s.DefaultHeaderFontSize}}),Object.defineProperty(t,"MinimalCellExtent",{enumerable:!0,get:function(){return s.MinimalCellExtent}}),Object.defineProperty(t,"DefaultHiddenRowColInnerGapPx",{enumerable:!0,get:function(){return s.DefaultHiddenRowColInnerGapPx}}),Object.defineProperty(t,"PartialRowColSelectionHCFontColor",{enumerable:!0,get:function(){return s.PartialRowColSelectionHCFontColor}}),Object.defineProperty(t,"PartialRowColSelectionBackgroundColor",{enumerable:!0,get:function(){return s.PartialRowColSelectionBackgroundColor}}),Object.defineProperty(t,"PartialRowColSelectionAndHoverBackgroundColor",{enumerable:!0,get:function(){return s.PartialRowColSelectionAndHoverBackgroundColor}}),Object.defineProperty(t,"PartialSelectionFontColor",{enumerable:!0,get:function(){return s.PartialSelectionFontColor}}),Object.defineProperty(t,"OldHeadersNSVFonts",{enumerable:!0,get:function(){return s.OldHeadersNSVFonts}}),Object.defineProperty(t,"HeadersNSVFonts",{enumerable:!0,get:function(){return s.HeadersNSVFonts}}),Object.defineProperty(t,"RowHeadersNSVStylesArray",{enumerable:!0,get:function(){return s.RowHeadersNSVStylesArray}}),Object.defineProperty(t,"RowHeadersNSVStylesArrayBeforeHeaderDragImprovements",{enumerable:!0,get:function(){return s.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements}}),Object.defineProperty(t,"ColumnHeadersNSVStylesArray",{enumerable:!0,get:function(){return s.ColumnHeadersNSVStylesArray}}),Object.defineProperty(t,"OldHeadersFonts",{enumerable:!0,get:function(){return s.OldHeadersFonts}}),Object.defineProperty(t,"HeadersFonts",{enumerable:!0,get:function(){return s.HeadersFonts}}),Object.defineProperty(t,"RowHeadersStylesArray",{enumerable:!0,get:function(){return s.RowHeadersStylesArray}}),Object.defineProperty(t,"RowHeadersStylesArrayBeforeHeaderDragImprovements",{enumerable:!0,get:function(){return s.RowHeadersStylesArrayBeforeHeaderDragImprovements}}),Object.defineProperty(t,"ColumnHeadersStylesArray",{enumerable:!0,get:function(){return s.ColumnHeadersStylesArray}}),Object.defineProperty(t,"NSVHeaderBackgroundColor",{enumerable:!0,get:function(){return s.NSVHeaderBackgroundColor}}),Object.defineProperty(t,"SelectedCellsGridlinesColor",{enumerable:!0,get:function(){return s.SelectedCellsGridlinesColor}}),Object.defineProperty(t,"OutlinesColor",{enumerable:!0,get:function(){return s.OutlinesColor}}),Object.defineProperty(t,"NSVOutlinesColor",{enumerable:!0,get:function(){return s.NSVOutlinesColor}}),Object.defineProperty(t,"NSVGridinesColor",{enumerable:!0,get:function(){return s.NSVGridinesColor}}),Object.defineProperty(t,"PartiallySelectionHeadersStylesSet",{enumerable:!0,get:function(){return s.PartiallySelectionHeadersStylesSet}}),Object.defineProperty(t,"WholeSelectionHeadersStylesSet",{enumerable:!0,get:function(){return s.WholeSelectionHeadersStylesSet}}),Object.defineProperty(t,"HoverHeadersStylesSet",{enumerable:!0,get:function(){return s.HoverHeadersStylesSet}}),Object.defineProperty(t,"WholeRowColSelectionBackgroundColor",{enumerable:!0,get:function(){return s.WholeRowColSelectionBackgroundColor}}),Object.defineProperty(t,"HoverFontColor",{enumerable:!0,get:function(){return s.HoverFontColor}});var d=n(306);Object.defineProperty(t,"serializeCell",{enumerable:!0,get:function(){return d.serializeCell}}),Object.defineProperty(t,"annonymize",{enumerable:!0,get:function(){return d.annonymize}});var c=n(199);Object.defineProperty(t,"areFormattedTextsEqual",{enumerable:!0,get:function(){return c.areFormattedTextsEqual}}),Object.defineProperty(t,"compareGridBlockModels",{enumerable:!0,get:function(){return c.compareGridBlockModels}}),Object.defineProperty(t,"comparePartialGridBlockModels",{enumerable:!0,get:function(){return c.comparePartialGridBlockModels}}),Object.defineProperty(t,"areGridCellsEqual",{enumerable:!0,get:function(){return c.areGridCellsEqual}}),Object.defineProperty(t,"areGridArraysEqual",{enumerable:!0,get:function(){return c.areGridArraysEqual}}),Object.defineProperty(t,"areInCellControlOptionsEqual",{enumerable:!0,get:function(){return c.areInCellControlOptionsEqual}}),Object.defineProperty(t,"areNumberFormatInformationEqual",{enumerable:!0,get:function(){return c.areNumberFormatInformationEqual}}),Object.defineProperty(t,"areMergeInformationEqual",{enumerable:!0,get:function(){return c.areMergeInformationEqual}});var u=n(528);Object.defineProperty(t,"compareHeaderBlockModels",{enumerable:!0,get:function(){return u.compareHeaderBlockModels}});var h=n(571);Object.defineProperty(t,"getReferencedObjectById",{enumerable:!0,get:function(){return h.getReferencedObjectById}});var g=n(161);Object.defineProperty(t,"getRangeTopLeftCell",{enumerable:!0,get:function(){return g.getRangeTopLeftCell}}),Object.defineProperty(t,"isCellContainedInRange",{enumerable:!0,get:function(){return g.isCellContainedInRange}}),Object.defineProperty(t,"getRangeLog",{enumerable:!0,get:function(){return g.getRangeLog}}),Object.defineProperty(t,"getCellLog",{enumerable:!0,get:function(){return g.getCellLog}}),Object.defineProperty(t,"isModelCellContainedInRange",{enumerable:!0,get:function(){return g.isModelCellContainedInRange}});var f=n(757);Object.defineProperty(t,"MaxAllowedRowColCount",{enumerable:!0,get:function(){return f.MaxAllowedRowColCount}}),Object.defineProperty(t,"MaxBitsPerRenderFlag",{enumerable:!0,get:function(){return f.MaxBitsPerRenderFlag}});var C=n(488);Object.defineProperty(t,"ChangeGate",{enumerable:!0,get:function(){return C.ChangeGate}}),Object.defineProperty(t,"isChangeGateEnabled",{enumerable:!0,get:function(){return C.isChangeGateEnabled}}),Object.defineProperty(t,"isPassRibbonCommandsToCanvasRendererEnabled",{enumerable:!0,get:function(){return C.isPassRibbonCommandsToCanvasRendererEnabled}});var m=n(996);Object.defineProperty(t,"generateKeyFromModelStyles",{enumerable:!0,get:function(){return m.generateKeyFromModelStyles}});var p=n(311);Object.defineProperty(t,"StyleType",{enumerable:!0,get:function(){return p.StyleType}});var y=n(564);Object.defineProperty(t,"preprocessModelStyles",{enumerable:!0,get:function(){return y.preprocessModelStyles}}),Object.defineProperty(t,"getGlobalStylesTelemetry",{enumerable:!0,get:function(){return y.getGlobalStylesTelemetry}}),Object.defineProperty(t,"getGlobalStyleId",{enumerable:!0,get:function(){return y.getGlobalStyleId}});var S=n(97);Object.defineProperty(t,"getGlobalBorderStyleMap",{enumerable:!0,get:function(){return S.getGlobalBorderStyleMap}}),Object.defineProperty(t,"isGlobalBorderStylesEnabled",{enumerable:!0,get:function(){return S.isGlobalBorderStylesEnabled}}),Object.defineProperty(t,"disableGlobalBorderStyles",{enumerable:!0,get:function(){return S.disableGlobalBorderStyles}}),Object.defineProperty(t,"isGlobalBorderStylesEnabledNew",{enumerable:!0,get:function(){return S.isGlobalBorderStylesEnabledNew}}),Object.defineProperty(t,"GlobalBorderStyles",{enumerable:!0,get:function(){return S.GlobalBorderStyles}});var R=n(906);Object.defineProperty(t,"getGlobalFontsMap",{enumerable:!0,get:function(){return R.getGlobalFontsMap}}),Object.defineProperty(t,"GlobalFonts",{enumerable:!0,get:function(){return R.GlobalFonts}}),Object.defineProperty(t,"updateGlobalFontIDInCell",{enumerable:!0,get:function(){return R.updateGlobalFontIDInCell}});var w=n(585);Object.defineProperty(t,"getGlobalCellStylesMap",{enumerable:!0,get:function(){return w.getGlobalCellStylesMap}}),Object.defineProperty(t,"GlobalCellStyles",{enumerable:!0,get:function(){return w.GlobalCellStyles}}),Object.defineProperty(t,"disableGlobalCellStyles",{enumerable:!0,get:function(){return w.disableGlobalCellStyles}});var b=n(939);Object.defineProperty(t,"disableGlobalFonts",{enumerable:!0,get:function(){return b.disableGlobalFonts}}),Object.defineProperty(t,"isGlobalFontsAndCellStylesFlightEnabled",{enumerable:!0,get:function(){return b.isGlobalFontsAndCellStylesFlightEnabled}}),Object.defineProperty(t,"isGlobalFontsAndCellStylesEnabled",{enumerable:!0,get:function(){return b.isGlobalFontsAndCellStylesEnabled}});var I=n(525);Object.defineProperty(t,"getBorderStyleByID",{enumerable:!0,get:function(){return I.getBorderStyleByID}}),Object.defineProperty(t,"getFontByID",{enumerable:!0,get:function(){return I.getFontByID}}),Object.defineProperty(t,"getCellStyleByID",{enumerable:!0,get:function(){return I.getCellStyleByID}}),Object.defineProperty(t,"isGetStyleFixChangeGateEnabled",{enumerable:!0,get:function(){return I.isGetStyleFixChangeGateEnabled}}),o.__exportStar(n(396),t)},161:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getCellLog=t.getRangeLog=t.getRangeTopLeftCell=t.isModelCellContainedInRange=t.isCellContainedInRange=void 0,t.isCellContainedInRange=function(e,t){return(!e.NamedObjectName&&!t.NamedObjectName||e.NamedObjectName===t.NamedObjectName)&&(!e.SheetName&&!t.SheetName||e.SheetName===t.SheetName)&&e.FirstColumn<=t.FirstColumn&&e.LastColumn>=t.FirstColumn&&e.FirstRow<=t.FirstRow&&e.LastRow>=t.FirstRow},t.isModelCellContainedInRange=function(e,t,n){const o=e.ColumnNumbers[n.Col],r=e.RowNumbers[n.Row];return t.FirstColumn<=o&&t.LastColumn>=o&&t.FirstRow<=r&&t.LastRow>=r},t.getRangeTopLeftCell=function(e){return{SheetName:e.SheetName,NamedObjectName:e.NamedObjectName,FirstRow:e.FirstRow,FirstColumn:e.FirstColumn}},t.getRangeLog=function(e){return`(${e.FirstRow}-${e.LastRow}, ${e.FirstColumn}-${e.LastColumn})`},t.getCellLog=function(e){return`(${e.FirstRow},${e.FirstColumn})`}},378:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Digit=t.ValueAnnonymizerRegex=t.CharacterReplaceValue=t.DigitPattern=t.DigitReplaceValue=t.AllowedCharactersToLog=t.SetCellOfInterestSymbols=t.CurrencySymbols=void 0,t.CurrencySymbols="$¢£¤¥₠₡₢₣₤₥₦₧₨₩₪₫€₭₮₯₰₱₲₳₴₵₶₷₸₹",t.SetCellOfInterestSymbols='=\\[\\]\\./%#\\-\\+,;\\(\\):?""&<>\'!{}~\\^\\*'+t.CurrencySymbols,t.AllowedCharactersToLog=t.SetCellOfInterestSymbols+"\\sꃂ",t.DigitReplaceValue="d",t.DigitPattern="[0-9]",t.CharacterReplaceValue="w",t.ValueAnnonymizerRegex=new RegExp("[^"+t.AllowedCharactersToLog+t.DigitReplaceValue+"]","gm"),t.Digit=new RegExp(t.DigitPattern,"gm")},259:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.comparePartialCellsInGridBlockModel=t.comparePartialColumnsInGridBlockModel=t.comparePartialRowsInGridBlockModel=t.getRowColIndexFromNumber=t.ensureCachedFontsInTextRuns=t.compareModelCells=t.areObjectsEqual=t.areArraysEqual=t.areCellsEqual=void 0;const o=n(490),r=n(212),i=n(669),l=n(488),a=n(520),s=n(585),d=n(906),c=n(939),u=n(97),h=n(969),g=n(181),f=n(396),C="",m=-1;let p;const y=(0,g.getBooleanFeatureGate)("Microsoft.Office.Excel.HeaderCellsComparisonFromLocalStyles",!1);function S(e,t,n,o,r,l,a,s){const d=(0,c.isGlobalFontsAndCellStylesFlightEnabled)(n)&&(0,c.isGlobalFontsAndCellStylesFlightEnabled)(o)&&(0,u.isGlobalBorderStylesEnabled)(n)&&(0,u.isGlobalBorderStylesEnabled)(o),h=(0,i.modelType)(n)===f.ModelType.HeaderBlockModel;!d||y&&h?(e.CachedStyle=(0,i.getReferencedObjectToCache)(e.StyleID||0,n.Styles),t.CachedStyle=(0,i.getReferencedObjectToCache)(t.StyleID||0,o.Styles),e.CachedFont=(0,i.getReferencedObjectToCache)(e.CachedStyle.FontID||0,n.Fonts),t.CachedFont=(0,i.getReferencedObjectToCache)(t.CachedStyle.FontID||0,o.Fonts),e.CachedBorderStyle=(0,i.getReferencedObjectToCache)(e.BorderStyleID||0,n.BorderStyles),t.CachedBorderStyle=(0,i.getReferencedObjectToCache)(t.BorderStyleID||0,o.BorderStyles)):(A(e,n),A(t,o),B(e,n),B(t,o),x(e,n),x(t,o));const C=l(e,t);b(e.TextRuns,n.Fonts),b(t.TextRuns,o.Fonts);let m=w(e,t,C,r,a);return void 0===p&&(p=(0,g.getBooleanFeatureGate)("Microsoft.Office.Excel.ModelComparisonIsSpillBlocked",!1)),p&&!s&&m.isEqual&&e&&t&&e.Spill&&t.Spill&&!!e.Spill.IsSpillBlocked!=!!t.Spill.IsSpillBlocked&&(m={isEqual:!1,message:`areCellsEqual: simple object comparison failure. PropertyName = Spill.IsSpillCellBlocked, cell1 Value = ${e.Spill.IsSpillBlocked}, cell2 Value = ${t.Spill.IsSpillBlocked}`}),m.isEqual||(m.message+=`\nareCellsEqual: cell1.Row = ${e.Row}, cell1.Col = ${e.Col}, cell2.Row = ${t.Row}, cell2.Col = ${t.Col}`),m}function R(e,t,n,o,r,i){if(e===t)return{isEqual:!0};if(void 0===e&&void 0===t)return{isEqual:!0};if(void 0===e||void 0===t)return void 0===e?{isEqual:!1,message:"areArraysEqual: the first array is undefined."}:{isEqual:!1,message:"areArraysEqual: the second array is undefined."};if(e.length!==t.length)return{isEqual:!1,message:`areArraysEqual: arrays length are different. length1: ${e.length}, length2: ${t.length}`};for(let l=0;l<e.length;l++){const a=w(e[l],t[l],n,o,r,i);if(!a.isEqual)return a.message+=`\nareArraysEqual: array objects are different. index: ${l}`,a}return{isEqual:!0}}function w(e,t,n,r,i,l){const{shouldContinue:a,result:s}=function(e,t,n){return e===t||(0,o.isNullOrUndefined)(e)&&(0,o.isNullOrUndefined)(t)?{shouldContinue:!1,result:{isEqual:!0}}:null==e||null==t?{shouldContinue:!1,result:{isEqual:!1,message:`areObjectsEqual: one object is null, o1 = ${!e}, o2 = ${!t}`}}:e!=e?{shouldContinue:!1,result:{isEqual:e!=e,message:"${callerMethod}: NaN comparison"}}:{shouldContinue:!0,result:{isEqual:!0}}}(e,t);if(!a)return s;const d=function(e,t){if(!e||!t)return e||t;const n=t.filter((t=>-1===e.indexOf(t)));return e.push(...n),e}(r(e,n),r(t,n));if(0===d.length)return F(e)&&F(t)?{isEqual:!0}:e instanceof Date||e instanceof Number||e instanceof Boolean?{isEqual:e.valueOf()===t.valueOf(),message:"areObjectsEqual: simple object comparison"}:{isEqual:e===t,message:"areObjectsEqual: simple object comparison"};for(let n=0;n<d.length;n++){const a=d[n],s=e[a],c=t[a],u=typeof s,h=typeof c;if(!(0,o.isNullOrUndefined)(s)||!(0,o.isNullOrUndefined)(c)){if(u!==h){if(v(s)&&v(c))continue;return{isEqual:!1,message:`areObjectsEqual: object types are different. propName = ${a} type1 = ${u}, type2 = ${h}`}}switch(u){case"string":if(s!==c){if(!l||-1===l.indexOf(a))return{isEqual:!1,message:`areObjectsEqual: simple types comparison, propertyName = ${a}`};if(s.toUpperCase()!==c.toUpperCase())return{isEqual:!1,message:`areObjectsEqual: ignore case comparison, propertyName = ${a}`}}break;case"undefined":case"boolean":case"number":if(s!==c)return{isEqual:!1,message:`areObjectsEqual: simple types comparison, propertyName = ${a}`};break;case"object":if(s instanceof Array){if(!(c instanceof Array))return{isEqual:!1,message:`areObjectsEqual: array 2 is not an array, propertyName = ${a}`};const e=I(a,i),t=e.ignoreCaseProps,n=R(s,c,e.filterByProps,r,i,t);if(!n.isEqual)return n.message+=`\nareObjectsEqual: arrays mismatch, propertyName = ${a}`,n}else{const e=I(a,i),t=e.ignoreCaseProps,n=w(s,c,e.filterByProps,r,i,t);if(!n.isEqual)return n.message+=`\nareObjectsEqual: objects mismatch, propertyName = ${a}`,n}break;default:return{isEqual:!1,message:`areObjectsEqual: unexpected type: ${u}, propertyName = ${a}`}}}}return{isEqual:!0}}function b(e,t){if(e&&0!==e.length&&t)for(let n=0;n<e.length;n++){const o=e[n];(0,d.isGlobalFontsEnabled)()?o.CachedFont=H(o.GlobalFontID,o.FontID,t):o.CachedFont=(0,i.getReferencedObjectToCache)(o.FontID||0,t)}}function I(e,t){const n={filterByProps:void 0,ignoreCaseProps:void 0},o=r.propertyToClassMap[e];if(!o)return n;const i=[],l=new Set;for(let e=0;e<o.length;e++){var a,s;null===(a=t[o[e]])||void 0===a||a.forEach((e=>l.add(e))),i.push(...null!==(s=r.ignoreCaseLists[o[e]])&&void 0!==s?s:[])}return n.filterByProps=l,n.ignoreCaseProps=i,n}function v(e){return(0,l.isChangeGateEnabled)(l.ChangeGate.TreatZeroAndUndefinedAsEqual)?null==e||e===C||!1===e||0===e:null==e||e===C||!1===e}function F(e){if("object"==typeof e&&e.constructor===Object){for(const t in e)return!1;return!0}return!1}function T(e,t,n,o,r){const i=[];if(v(i))return[];for(let l=0;l<e.Cells.length;l++){const a=e.Cells[l];a.Row>=t&&a.Row<=n&&a.Col>=o&&a.Col<=r&&i.push(a)}return i}function D(e,t,n,o,r,i,l){let a=e,s=e,d=t,c=n;return d>=o?(s=r[c],c++):c>=i||l[d].Row<r[c].Row||l[d].Row===r[c].Row&&l[d].Col<r[c].Col?(a=l[d],d++):l[d].Row!==r[c].Row||l[d].Col!==r[c].Col?(s=r[c],c++):(a=l[d],s=r[c],d++,c++),{cell1:a,cell2:s,index1:d,index2:c}}function x(e,t){try{if(!(0,o.isNullOrUndefined)(e.GlobalBorderStyleID))return void(e.CachedBorderStyle=(0,u.getBorderStyleByGlobalID)(e.GlobalBorderStyleID||0));e.CachedBorderStyle=(0,i.getReferencedObjectToCache)(e.BorderStyleID||0,t.BorderStyles)}catch(n){e.CachedBorderStyle=(0,i.getReferencedObjectToCache)(e.BorderStyleID||0,t.BorderStyles),(0,u.disableGlobalBorderStyles)(`${n}`)}}function A(e,t){try{if(!(0,o.isNullOrUndefined)(e.GlobalCellStyleID))return void(e.CachedStyle=(0,s.getCellStyleByGlobalID)(e.GlobalCellStyleID));e.CachedStyle=(0,i.getReferencedObjectToCache)(e.StyleID||0,t.Styles)}catch(n){e.CachedStyle=(0,i.getReferencedObjectToCache)(e.StyleID||0,t.Styles),(0,s.disableGlobalCellStyles)(`${n}`)}}function B(e,t){try{var n,o;e.CachedFont=H(null===(n=e.CachedStyle)||void 0===n?void 0:n.GlobalFontID,null===(o=e.CachedStyle)||void 0===o?void 0:o.FontID,t.Fonts)}catch(n){var r;e.CachedFont=(0,i.getReferencedObjectToCache)((null===(r=e.CachedStyle)||void 0===r?void 0:r.FontID)||0,t.Fonts),(0,c.disableGlobalFonts)(`${n}`)}}function H(e,t,n){return(0,o.isNullOrUndefined)(e)?(0,i.getReferencedObjectToCache)(t||0,n):(0,d.getFontByGlobalID)(e)}t.areCellsEqual=S,t.areArraysEqual=R,t.areObjectsEqual=w,t.compareModelCells=function(e,t,n,o,r,a,s){const d=e.Cells,c=t.Cells;let u=0;if(d===c)return{isEqual:!0,canDiffRender:!0};const f=d.length,C=c.length;let p=0,y=0;const R=(0,i.getDefaultCell)(m,m,e.Styles,e.Fonts);let b=[],I=!0,v="";for(;p<f||y<C;){let F,T;const x=p,A=y;({cell1:F,cell2:T,index1:p,index2:y}=D(R,p,y,f,c,C,d));const B=S(F,T,e,t,o,r,a,s),H=(null==F?void 0:F.Row)===m?null==T?void 0:T.Row:F.Row,M=(null==F?void 0:F.Col)===m?null==T?void 0:T.Col:F.Col;if(!B.isEqual){I&&(I=!1,v+=B.message+"\n"),b.push((0,i.getCellLookupKey)(H,M));const r=(0,h.getComparisonIgnoreLists)((0,g.getBooleanFeatureGate)("Microsoft.Office.Excel.IgnoreListFix",!1),(0,g.getBooleanFeatureGate)("Microsoft.Office.Excel.IgnoreAutoFilterTitle",!1),(0,l.isChangeGateEnabled)(l.ChangeGate.RemoveIsCanvasHeaderSupported)).ReferencedObject;if(!w(F.CachedBorderStyle,T.CachedBorderStyle,r,o,a).isEqual||!w(F.HasError,T.HasError,void 0,o,a).isEqual){let n=[];(0,l.isChangeGateEnabled)(l.ChangeGate.AdjacentCellsMergeFix)?(F.Row!==m&&(n=(0,i.getAdjacentCellsKeys)(e,F)),T.Row!==m&&(n=n.concat((0,i.getAdjacentCellsKeys)(t,T)))):n=(0,i.getAdjacentCellsKeysOld)(t,H,M),b=b.concat(n),b=b.concat((0,i.getAllSpillingOverCells)(d,n)),b=b.concat((0,i.getAllSpillingOverCells)(c,n))}if(n&&(u++,u>=n))return{isEqual:I,canDiffRender:!1,changedCellsKeys:void 0,message:`${v} \n maxAllowedDiffRenderCells reached`};F!==R&&(b=b.concat((0,i.getAllSpanningCellsKeys)(d,F,x))),T!==R&&(b=b.concat((0,i.getAllSpanningCellsKeys)(c,T,A)))}}return{isEqual:I,canDiffRender:!0,changedCellsKeys:b.filter(i.uniqueValuesFilter),message:v}},t.ensureCachedFontsInTextRuns=b,t.getRowColIndexFromNumber=function(e,t){if(e.length<1)return 0;if(t<e[0])return 0;const n=e.length-1;if(t>e[n])return n;for(let n=0;n<e.length;n++)if(t===e[n])return n;return-1},t.comparePartialRowsInGridBlockModel=function(e,t,n,o){!function(e,t){(0,a.verifyArgumentNotNull)(e.RowOffsets,"model1.RowOffsets","validateRowArgs"),(0,a.verifyArgumentNotNull)(t.RowOffsets,"model2.RowOffsets","validateRowArgs"),(0,a.verifyArgumentNotNull)(e.RowHeights,"model1.RowHeights","validateRowArgs"),(0,a.verifyArgumentNotNull)(t.RowHeights,"model2.RowHeights","validateRowArgs"),(0,a.verifyArgumentNotNull)(e.RowNumbers,"model1.RowNumbers","validateRowArgs"),(0,a.verifyArgumentNotNull)(t.RowNumbers,"model2.RowNumbers","validateRowArgs")}(e,t);for(let r=n;r<=o;r++){if(e.RowHeights[r]!==t.RowHeights[r])return{isEqual:!1,message:"Mismatch in RowHeights, index = "+r+" model1 value = "+e.RowHeights[r]+" model2 value = "+t.RowHeights[r],canDiffRender:!1,changedCellsKeys:void 0};if(e.RowNumbers[r]!==t.RowNumbers[r])return{isEqual:!1,message:"Mismatch in RowNumbers, index = "+r+" model1 value = "+e.RowNumbers[r]+" model2 value = "+t.RowNumbers[r],canDiffRender:!1,changedCellsKeys:void 0};if(e.RowOffsets[r]!==t.RowOffsets[r])return{isEqual:!1,message:"Mismatch in RowOffsets, index = "+r+" model1 value = "+e.RowOffsets[r]+" model2 value = "+t.RowOffsets[r],canDiffRender:!1,changedCellsKeys:void 0}}return{isEqual:!0,canDiffRender:!0,changedCellsKeys:[],message:""}},t.comparePartialColumnsInGridBlockModel=function(e,t,n,o){!function(e,t){(0,a.verifyArgumentNotNull)(e.ColumnNumbers,"model1.ColumnNumbers","validateColumnArgs"),(0,a.verifyArgumentNotNull)(t.ColumnNumbers,"model2.ColumnNumbers","validateColumnArgs"),(0,a.verifyArgumentNotNull)(e.ColumnWidths,"model1.ColumnWidths","validateColumnArgs"),(0,a.verifyArgumentNotNull)(t.ColumnWidths,"model2.ColumnWidths","validateColumnArgs"),(0,a.verifyArgumentNotNull)(e.ColumnOffsets,"model1.ColumnOffsets","validateColumnArgs"),(0,a.verifyArgumentNotNull)(t.ColumnOffsets,"model2.ColumnOffsets","validateColumnArgs")}(e,t);for(let r=n;r<=o;r++){if(e.ColumnWidths[r]!==t.ColumnWidths[r])return{isEqual:!1,message:"Mismatch in ColumnWidths, index = "+r+" model1 value = "+e.ColumnWidths[r]+" model2 value = "+t.ColumnWidths[r],canDiffRender:!1,changedCellsKeys:void 0};if(e.ColumnOffsets[r]!==t.ColumnOffsets[r])return{isEqual:!1,message:"Mismatch in ColumnOffsets, index = "+r+" model1 value = "+e.ColumnOffsets[r]+" model2 value = "+t.ColumnOffsets[r],canDiffRender:!1,changedCellsKeys:void 0};if(e.ColumnNumbers[r]!==t.ColumnNumbers[r])return{isEqual:!1,message:"Mismatch in ColumnNumbers, index = "+r+" model1 value = "+e.ColumnNumbers[r]+" model2 value = "+t.ColumnNumbers[r],canDiffRender:!1,changedCellsKeys:void 0}}return{isEqual:!0,canDiffRender:!0,changedCellsKeys:[],message:""}},t.comparePartialCellsInGridBlockModel=function(e,t,n,o,r,l,a,s,d){const c=T(e,n,o,r,l),u=T(t,n,o,r,l),h=c.length,g=u.length;let f=0,p=0;const y=(0,i.getDefaultCell)(m,m,e.Styles,e.Fonts);for(;f<h||p<g;){let n,o;({cell1:n,cell2:o,index1:f,index2:p}=D(y,f,p,h,u,g,c));const r=S(n,o,e,t,a,s,d);if(!r.isEqual)return{isEqual:r.isEqual,canDiffRender:!0,changedCellsKeys:[],message:r.message}}return{isEqual:!0,canDiffRender:!0,changedCellsKeys:[],message:C}}},966:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CalcBlockModel=void 0;const o=n(669),r=n(490),i=n(396);t.CalcBlockModel=class{createCell(e){let t,n,o,r=i.CellValueType.None,l=i.CellFormulaType.Value,a=i.RichValueCellType.None;var s,d;return e.Merge&&!e.Merge.IsOrigin||(t=e.Value,r=e.ValueType,n=e.Text,o=null===(s=e.FormulaInfo)||void 0===s?void 0:s.Formula,l=e.FormulaInfo?e.FormulaInfo.FormulaType:i.CellFormulaType.Value,a=null!==(d=e.RichValueType)&&void 0!==d?d:i.RichValueCellType.None),{col:e.Col,row:e.Row,text:n,formula:o,valueType:r,value:t,ifmt:e.Ifmt||0,formulaType:l,richValueType:a}}addCell(e){if(-1!==this.index)throw"cannot add cell after iterating cells";this.Cells[(0,o.getCellLookupKey)(e.row,e.col)]=e,this.keys=null}addHeaders(e,t){this.RowNumbers=e,this.ColumnNumbers=t}getRowNumbers(){return this.RowNumbers}getColumnNumbers(){return this.ColumnNumbers}getCell(e,t){return(0,r.isNullOrUndefined)(this.Cells)?null:this.Cells[(0,o.getCellLookupKey)(e,t)]}reset(){this.index=0,(0,r.isNullOrUndefined)(this.keys)&&(this.keys=Object.keys(this.Cells))}getNextCell(){if((0,r.isNullOrUndefined)(this.Cells)||(0,r.isNullOrUndefined)(this.keys))return null;if(-1===this.index)return null;if(this.index>=this.keys.length)return null;const e=this.Cells[this.keys[this.index]];return this.index++,e}constructor(){this.RowNumbers=[],this.ColumnNumbers=[],this.Cells={},this.index=-1,this.keys=null}}},488:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.isPassRibbonCommandsToCanvasRendererEnabled=t.initializeArraysTestOnly=t.initializeChangeGatesDataStructure=t.isChangeGateEnabled=t.ChangeGate=void 0;const o=n(181);var r;!function(e){e[e.TreatZeroAndUndefinedAsEqual=0]="TreatZeroAndUndefinedAsEqual",e[e.AdjacentCellsMergeFix=1]="AdjacentCellsMergeFix",e[e.FixBoldFontsOnMac=2]="FixBoldFontsOnMac",e[e.PassRibbonCommandsToCanvasRenderer=3]="PassRibbonCommandsToCanvasRenderer",e[e.TableSelectionDragSelection=4]="TableSelectionDragSelection",e[e.FixUserContentList=5]="FixUserContentList",e[e.FixRotatedTextWidth=6]="FixRotatedTextWidth",e[e.ResetContentList=7]="ResetContentList",e[e.addTelemetryForStyleIdCrash=8]="addTelemetryForStyleIdCrash",e[e.protectIsCellPartiallySelected=9]="protectIsCellPartiallySelected",e[e.RichIconFilterScale=10]="RichIconFilterScale",e[e.FixCellImageAlignmentWithRichPivotDrill=11]="FixCellImageAlignmentWithRichPivotDrill",e[e.DontShowRichValueIconForSpilledArrayFormulasInFormulaView=12]="DontShowRichValueIconForSpilledArrayFormulasInFormulaView",e[e.UseClippedX=13]="UseClippedX",e[e.CellIconBottomPadding=14]="CellIconBottomPadding",e[e.FBEFormattedCellsPreviewStyle=15]="FBEFormattedCellsPreviewStyle",e[e.HeaderWithGlobalStyles=16]="HeaderWithGlobalStyles",e[e.HideColMergeCellTelemetry=17]="HideColMergeCellTelemetry",e[e.FixHeaderSnappingAutoFilterNone=18]="FixHeaderSnappingAutoFilterNone",e[e.FixBorderStylesEqual=19]="FixBorderStylesEqual",e[e.PreviewCellsSettings=20]="PreviewCellsSettings",e[e.FixBorderWithMergeCellComparison=21]="FixBorderWithMergeCellComparison",e[e.RotatedTextDecorationWithMergeCellBugFix=22]="RotatedTextDecorationWithMergeCellBugFix",e[e.HandlePointerLeaveEventFromHeaderCanvas=23]="HandlePointerLeaveEventFromHeaderCanvas",e[e.CheckboxFallbackFont=24]="CheckboxFallbackFont",e[e.EnablingRowColCSEForComplexCellsSlice2=25]="EnablingRowColCSEForComplexCellsSlice2",e[e.BlockEdgeBorderThicknessFix=26]="BlockEdgeBorderThicknessFix",e[e.HideCheckboxOnShowFormula=27]="HideCheckboxOnShowFormula",e[e.UseClippedXCheckbox=28]="UseClippedXCheckbox",e[e.StyleIdCrashFix=29]="StyleIdCrashFix",e[e.FixCopyBlankCellToACellWithCheckbox=30]="FixCopyBlankCellToACellWithCheckbox",e[e.HideCommentIndicators=31]="HideCommentIndicators",e[e.HideColMergedCellAcrossBlocks=32]="HideColMergedCellAcrossBlocks",e[e.EnableMergeCellSupportForFreezePanesCse=33]="EnableMergeCellSupportForFreezePanesCse",e[e.CheckboxInCellImageCheck=34]="CheckboxInCellImageCheck",e[e.ImprovedExceptionHandling=35]="ImprovedExceptionHandling",e[e.FixStyleIdIssue=36]="FixStyleIdIssue",e[e.TakeAutoFilterBeforePivotFilter=37]="TakeAutoFilterBeforePivotFilter",e[e.MergeCellBorderScenarios=38]="MergeCellBorderScenarios",e[e.PLTRegressionInMFPFix=39]="PLTRegressionInMFPFix",e[e.EnableFreezePanesCSEForMergedEdgeCells=40]="EnableFreezePanesCSEForMergedEdgeCells",e[e.RestrictStylesPreProcess=41]="RestrictStylesPreProcess",e[e.DoubleBorderFormattingFix=42]="DoubleBorderFormattingFix",e[e.UseSetForKnownFonts=43]="UseSetForKnownFonts",e[e.DismissUnhideSkittleOnResize=44]="DismissUnhideSkittleOnResize",e[e.AddPivotFilterTitleTag=45]="AddPivotFilterTitleTag",e[e.CacheCannonizedFont=46]="CacheCannonizedFont",e[e.RemoveIsCanvasHeaderSupported=47]="RemoveIsCanvasHeaderSupported",e[e.MungedBorderBugFixes=48]="MungedBorderBugFixes",e[e.HideDeleteCSEBlockEdgeBorderFix=49]="HideDeleteCSEBlockEdgeBorderFix",e[e.IncreaseFontLoadTimeout=50]="IncreaseFontLoadTimeout",e[e.UseNewKnownFontList=51]="UseNewKnownFontList",e[e.RemoveRefCountCheckForFontLoad=52]="RemoveRefCountCheckForFontLoad",e[e.DiffRenderingOptimization=53]="DiffRenderingOptimization",e[e.StopCursorChangeForCheckboxWhenComponentRangePicker=54]="StopCursorChangeForCheckboxWhenComponentRangePicker",e[e.GroupRowColBugFix=55]="GroupRowColBugFix",e[e.XLYellowFontLoadCheckNew=56]="XLYellowFontLoadCheckNew",e[e.DisableProcessGlobalStylesTelemetry=57]="DisableProcessGlobalStylesTelemetry",e[e.PassingThresholdCountOfSTylesFromFlight=58]="PassingThresholdCountOfSTylesFromFlight",e[e.HiddenIndicatorZoomFixEnabled=59]="HiddenIndicatorZoomFixEnabled",e[e.GetStyleFix=60]="GetStyleFix",e[e.ModernFontRendering=61]="ModernFontRendering",e[e.AddFontFlickerTelemetry=62]="AddFontFlickerTelemetry",e[e.BorderInsertionBugFix=63]="BorderInsertionBugFix",e[e.InsertOperationBugFix=64]="InsertOperationBugFix",e[e.SkeletonWithoutGridLines=65]="SkeletonWithoutGridLines",e[e.EnableDeleteRowColCSEForMergeCellSpanningAcrossTwoBlocks=66]="EnableDeleteRowColCSEForMergeCellSpanningAcrossTwoBlocks",e[e.MergeInfoResetBugFix=67]="MergeInfoResetBugFix",e[e.MergeInfoOriginRowColMismatchBugFix=68]="MergeInfoOriginRowColMismatchBugFix",e[e.PromotedRenderingTelemetry=69]="PromotedRenderingTelemetry",e[e.OptimizeProcessingForGlobalStyles=70]="OptimizeProcessingForGlobalStyles",e[e.InsertCSEForMergeCellSpanningBlocks=71]="InsertCSEForMergeCellSpanningBlocks",e[e.CacheIsResizeAllowedValue=72]="CacheIsResizeAllowedValue",e[e.AddHorizontalPaddingWithScaleFactor=73]="AddHorizontalPaddingWithScaleFactor",e[e.LogResizePillRenderingOnMultipleCells=74]="LogResizePillRenderingOnMultipleCells",e[e.DisableGlobalStylesTagSizeRegressionFix=75]="DisableGlobalStylesTagSizeRegressionFix",e[e.InCellControlCheckboxAlignmentChangeInTextRotaion=76]="InCellControlCheckboxAlignmentChangeInTextRotaion",e[e.InCellControlWithColAutofit=77]="InCellControlWithColAutofit",e[e.AddLocalizedAutoFilterTitleMapping=78]="AddLocalizedAutoFilterTitleMapping",e[e.UnhideSkittleHitRegionPreventOverlap=79]="UnhideSkittleHitRegionPreventOverlap",e[e.LastChangeGateDontDelete=80]="LastChangeGateDontDelete"}(r||(t.ChangeGate=r={}));let i,l=r.LastChangeGateDontDelete,{changeGatesNamesArray:a,changeGatesBitMap:s,cachedChangeGatesBitMap:d}=g(l,32);function c(e){const t=Math.floor(e/32),n=1<<e%32;return function(e,t,n){u(d,t,n)||((0,o.isChangeGateEnabled)(a[e])&&h(s,t,n),h(d,t,n))}(e,t,n),u(s,t,n)}function u(e,t,n){return 0!=(e[t]&n)}function h(e,t,n){e[t]|=n}function g(e,t){const n=new Array(e),o=Math.ceil(e/t);return{changeGatesNamesArray:n,changeGatesBitMap:f(o),cachedChangeGatesBitMap:f(o)}}function f(e){return Array.apply(null,new Array(e)).map((()=>0))}a[r.TreatZeroAndUndefinedAsEqual]="OfficeVSO:5010362_TreatZeroAndUndefinedAsEqual",a[r.AdjacentCellsMergeFix]="OfficeVSO:5230472_adjacentCellsMergeFix2",a[r.FixBoldFontsOnMac]="OfficeVSO:7477362_FixBoldFontsOnMacn",a[r.PassRibbonCommandsToCanvasRenderer]="OfficeVSO:9134712_PassRibbonCommandsToCanvasRenderer",a[r.TableSelectionDragSelection]="OfficeVSO:5501896_TableSelectionDragSelection",a[r.FixUserContentList]="OfficeVSO:6006812_FixUserContentList",a[r.FixRotatedTextWidth]="OfficeVSO:6582281_FixRotatedTextWidth",a[r.ResetContentList]="OfficeVSO:7259557_ResetContentList",a[r.addTelemetryForStyleIdCrash]="OfficeVSO:7426943_addTelemetryForStyleIdCrash2",a[r.protectIsCellPartiallySelected]="OfficeVSO:7733119_protectIsCellPartiallySelected",a[r.RichIconFilterScale]="OfficeVSO:7525144_RichIconFilterScale",a[r.FixCellImageAlignmentWithRichPivotDrill]="OfficeVSO:7910214_FixCellImageAlignmentWithRichPivotDrill",a[r.UseClippedX]="OfficeVSO:7868644_InCellControlCheckboxClippingInXLO",a[r.CellIconBottomPadding]="OfficeVSO:7944046_CellIconBottomPadding",a[r.FixHeaderSnappingAutoFilterNone]="OfficeVSO:8161977_fixHeaderSnappingAutoFilterNone",a[r.DontShowRichValueIconForSpilledArrayFormulasInFormulaView]="OfficeVSO:7971025_dontShowRichValueIconForSpilledArrayFormulasInFormulaView",a[r.HeaderWithGlobalStyles]="OfficeVSO:8126763_HeaderWithGlobalStyles",a[r.HideColMergeCellTelemetry]="OfficeVSO:8137545_HideColMergeCellTelemetry",a[r.FixBorderStylesEqual]="OfficeVSO:8353755_fixBorderStylesEqual",a[r.FixBorderWithMergeCellComparison]="OfficeVSO:8381160_FixBorderWithMergeCellComparison",a[r.PreviewCellsSettings]="OfficeVSO:8390976_PreviewCellsSettings",a[r.RotatedTextDecorationWithMergeCellBugFix]="OfficeVSO:8429004_RotatedTextDecorationWithMergeCellBugFix",a[r.HandlePointerLeaveEventFromHeaderCanvas]="OfficeVSO:8444516_HandlePointerLeaveEventFromHeaderCanvas",a[r.CheckboxFallbackFont]="OfficeVSO:8573746_CheckboxFallbackFontEnabled",a[r.EnablingRowColCSEForComplexCellsSlice2]="OfficeVSO:8633190_EnablingRowColCSEForComplexCellsSlice2",a[r.BlockEdgeBorderThicknessFix]="OfficeVSO:8612257_BlockEdgeBorderThicknessFix",a[r.HideCheckboxOnShowFormula]="OfficeVSO:8595087_HideCheckboxOnShowFormula",a[r.UseClippedXCheckbox]="OfficeVSO:8654438_UseClippedXCheckbox",a[r.StyleIdCrashFix]="OfficeVSO:8683770_StyleIdCrashV2",a[r.FixCopyBlankCellToACellWithCheckbox]="OfficeVSO:8689743_FixCopyBlankCellToACellWithCheckbox",a[r.HideCommentIndicators]="OfficeVSO:8608691_HideCommentIndicators",a[r.HideColMergedCellAcrossBlocks]=" OfficeVSO:8776386_HideColMergedCellAcrossBlocksEnabled",a[r.EnableMergeCellSupportForFreezePanesCse]="OfficeVSO:8778653_enableFreezePanesCseForSheetsWithMergeCells",a[r.CheckboxInCellImageCheck]="OfficeVSO:8766511_CheckboxInCellImageCheck",a[r.ImprovedExceptionHandling]="OfficeVSO:8793263_improvedExceptionHandlingGlobalStyles",a[r.FixStyleIdIssue]="OfficeVSO:8805047_FixStyleIdIssue",a[r.TakeAutoFilterBeforePivotFilter]="OfficeVSO:8812177_TakeAutoFilterBeforePivotFilter",a[r.MergeCellBorderScenarios]="OfficeVSO:8834380_MergeCellBorderScenarios",a[r.PLTRegressionInMFPFix]="OfficeVSO:8830767_PLTRegressionInMFPFixV2",a[r.EnableFreezePanesCSEForMergedEdgeCells]="OfficeVSO:8864410_EnableFreezePanesCSEForMergedEdgeCells",a[r.RestrictStylesPreProcess]="OfficeVSO:8923280_MinimizeStylesProcessing",a[r.DoubleBorderFormattingFix]="OfficeVSO:8875644_DoubleBorderFormattingFix",a[r.UseSetForKnownFonts]="OfficeVSO:8922969_useSetForKnownFonts",a[r.DismissUnhideSkittleOnResize]="OfficeVSO:8917567_dismissUnhideSkittleOnResize",a[r.AddPivotFilterTitleTag]="OfficeVSO:8938003_addPivotFilterTitleTag",a[r.MungedBorderBugFixes]="OfficeVSO:9010304_MungedBorderBugFixes",a[r.HideDeleteCSEBlockEdgeBorderFix]="OfficeVSO:9013637_HideDeleteCSEBlockEdgeBorderFix",a[r.CacheCannonizedFont]="OfficeVSO:9005975_cacheCannonizeFontName",a[r.RemoveIsCanvasHeaderSupported]="OfficeVSO:9169849_removeIsCanvasHeaderSupported",a[r.IncreaseFontLoadTimeout]="OfficeVSO:8989289_IncreaseFontLoadTimeout",a[r.UseNewKnownFontList]="OfficeVSO:9009674_UseNewKnownFontList",a[r.DiffRenderingOptimization]="OfficeVSO:9040294_DiffRenderingOptimization",a[r.RemoveRefCountCheckForFontLoad]="OfficeVSO:9019367_RemoveRefCountCheckForFontLoad",a[r.StopCursorChangeForCheckboxWhenComponentRangePicker]="OfficeVSO:8850652_stopCursorChangeForCheckboxWhenComponentRangePicker",a[r.GroupRowColBugFix]="OfficeVSO:9078919_RowColGroupBugFix",a[r.XLYellowFontLoadCheckNew]="OfficeVSO:9072398_XLYellowFontLoadCheckNew",a[r.DisableProcessGlobalStylesTelemetry]="OfficeVSO:9086219_DisableProcessGlobalStylesTelemetry",a[r.PassingThresholdCountOfSTylesFromFlight]="OfficeVSO:9162169_PassingThresholdCountOfSTylesFromFlight",a[r.HiddenIndicatorZoomFixEnabled]="OfficeVSO:9019696_HiddenIndicatorZoomFixEnabled",a[r.ModernFontRendering]="OfficeVSO:9093964_ModernFontRenderingFlight",a[r.GetStyleFix]="OfficeVSO:9086842_FixGlobalStylesACEError",a[r.SkeletonWithoutGridLines]="OfficeVSO:9155388_SkeletonWithoutGridLines",a[r.EnableDeleteRowColCSEForMergeCellSpanningAcrossTwoBlocks]="OfficeVSO:9198763_EnableDeleteRowColCSEForMergeCellSpanningAcrossTwoBlocks",a[r.MergeInfoResetBugFix]="OfficeVSO:9199196_MergeInfoResetBugFix",a[r.MergeInfoOriginRowColMismatchBugFix]="OfficeVSO:9200695_MergeInfoOriginRowColMismatchBugFix",a[r.AddFontFlickerTelemetry]="OfficeVSO:8927459_AddFontFlickerTelemetryV2",a[r.BorderInsertionBugFix]="OfficeVSO:9186234_BorderInsertionBugFix",a[r.InsertOperationBugFix]="OfficeVSO:9189954_InsertOperationBugFix",a[r.AddHorizontalPaddingWithScaleFactor]="OfficeVSO:8830743_AddHorizontalPaddingWithScaleFactorForRichValueIcon",a[r.PromotedRenderingTelemetry]="OfficeVSO:9062697_PromotedRenderingTelemetry",a[r.OptimizeProcessingForGlobalStyles]="OfficeVSO:9177847_OptimizeProcessingForGlobalStyles",a[r.InsertCSEForMergeCellSpanningBlocks]="OfficeVSO:9214402_InsertCSEForMergeCellSpanningBlocks",a[r.CacheIsResizeAllowedValue]="OfficeVSO:9159241_cacheIsResizeAllowedValue",a[r.LogResizePillRenderingOnMultipleCells]="OfficeVSO:9170639_LogResizePillRenderingOnMultipleCells",a[r.DisableGlobalStylesTagSizeRegressionFix]="OfficeVSO:9177908_DisableGlobalStylesTagSizeRegression",a[r.InCellControlCheckboxAlignmentChangeInTextRotaion]="OfficeVSO:9024501_InCellControlCheckboxAlignmentChangeInTextRotaion",a[r.InCellControlWithColAutofit]="OfficeVSO:9038646_InCellControlWithColAutofit",a[r.AddLocalizedAutoFilterTitleMapping]="OfficeVSO:8938100_AddLocalizedAutoFilterTitleMapping",a[r.UnhideSkittleHitRegionPreventOverlap]="OfficeVSO:9278674_UnhideSkittleHitRegionPreventOverlap",t.isChangeGateEnabled=c,t.initializeChangeGatesDataStructure=g,t.initializeArraysTestOnly=function(e){l=e.length,a=e;const t=Math.ceil(l/32);s=new Array(t).fill(0),d=new Array(t).fill(0)},t.isPassRibbonCommandsToCanvasRendererEnabled=function(){return void 0===i&&(i=c(r.PassRibbonCommandsToCanvasRenderer)),i}},757:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CellLookupColumnMod=t.MaxAllowedRowColCount=t.CellLookupRowShift=t.MaxBitsPerRenderFlag=void 0,t.MaxBitsPerRenderFlag=32,t.CellLookupRowShift=5,t.MaxAllowedRowColCount=32,t.CellLookupColumnMod=1<<t.CellLookupRowShift},520:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.isDisableProcessGlobalStylesTelemetryEnabled=t.testMethod=t.isGlobalStylesRenderFlagsEnabled=t.verifyArgumentNotNull=t.overrideRenderFlagForMismatch=t.isRenderFlagEnabled=void 0;const o=n(488),r=n(757),i=n(490),l=n(396);let a,s;function d(e,t){if(!(0,i.isNullOrUndefined)(t.RenderFlagsArray)){const n=Math.floor(e/r.MaxBitsPerRenderFlag);if(n<t.RenderFlagsArray.length){const o=e%r.MaxBitsPerRenderFlag;return 0!=(t.RenderFlagsArray[n]&1<<o)}}return!1}function c(){s=void 0}t.isRenderFlagEnabled=d,t.overrideRenderFlagForMismatch=function(e,t,n){if(!(0,i.isNullOrUndefined)(e.RenderFlagsArray)){const o=Math.floor(t/r.MaxBitsPerRenderFlag);if(o<e.RenderFlagsArray.length){const i=1<<t%r.MaxBitsPerRenderFlag;n!==!!(e.RenderFlagsArray[o]&i)&&(e.RenderFlagsArray[o]^=i)}}},t.verifyArgumentNotNull=function(e,t,n){if(null==e)throw Error(`${n}.verifyArgumentNotNull: ${t} cannot be null or undefined`)},t.isGlobalStylesRenderFlagsEnabled=function(e){return void 0===s&&(s=d(l.RenderFlagsArray.GlobalStylesSlice2,e)&&d(l.RenderFlagsArray.GlobalStylesSlice3,e)),!!s},t.testMethod=function(){return{resetGlobalStylesRenderFlags:c}},t.isDisableProcessGlobalStylesTelemetryEnabled=function(){return void 0===a&&(a=(0,o.isChangeGateEnabled)(o.ChangeGate.DisableProcessGlobalStylesTelemetry)),a}},212:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderIncludeLists=t.SerializationClasses=t.SerializationPropertyKey=t.SerializationProperties=t.UserContentList=t.propertyToClassMap=t.propertyNameToTypeMap=t.propertyLists=t.ignoreCaseLists=t.comparisonIgnoreLists=void 0,t.comparisonIgnoreLists={},t.comparisonIgnoreLists.GridBlockModel=["ColMetadata","FixedColumns","IsBitwiseFixedRows","RowOutlinesInformation","ColumnOutlinesInformation","MaxRowOutlineLevelInSheet","MaxColOutlineLevelInSheet","UniqueId","ShowHeaders","IsRow","Styles","Fonts","BorderStyles","CellsEncoding","RenderFlagsArray","HandleFlagsMismatch","AllRichValueFields","ClientOnlyCache","AdjacentBlocksHiddensInfo","RichValueTypes","IsCanvasHeadersSupported","HeadersFallbackReason","HasTable","HasOutline","IsEmptyBlocksSupported","EmptyBlocksFallbackReasonBitFlag","AreStylesProcessed"],t.comparisonIgnoreLists.Cell=["StyleID","GlobalCellStyleID","Ifmt","IfmtStamped","BorderStyleID","GlobalBorderStyleID","HorizontalAlignmentSet","Spill","ShrunkSize","RichValueType","RichValueFieldsIndexes","DynamicArrayInfo","ValueType","SrvDx","SrvDy","TolType","PythonInformation","BitwiseBorderPosition","IsCellSnapped","CachedDrawingLayout","CachedDisplayText","CachedDisplayTextRuns","CachedIsTextWidthExceedsCellWidth","CachedIndent","DisplayFormula","PreviewText","PreviewNumFmt","PreviewCellStyle","RetainTextOnPreview","ShowSkeleton","Value","UserInput","PhoneticInfo","OriginalText","ErrorTooltip"],t.comparisonIgnoreLists.HeaderCell=["ShowResizePill","ResizePillLocation","InsertButtons","IsHovered","DataCleansingIcon"],t.comparisonIgnoreLists.InsertButtons=["Start","End"],t.comparisonIgnoreLists.InsertButton=["Type"],t.comparisonIgnoreLists.AutoFilter=["Title","Menu","CommandData"],t.comparisonIgnoreLists.PivotFilter=["IsPivotPageField","CommandData","IsHeaderSnapped"],t.comparisonIgnoreLists.ReferencedObject=["ID","RefCount","GlobalId"],t.comparisonIgnoreLists.CellStyle=["IsPattern","NamedStyleId","FontID","GlobalFontID","IsUnlocked","IsHidden"],t.comparisonIgnoreLists.SpillInformation=["IsSpillingOutsideOfBlock"],t.comparisonIgnoreLists.FormulaInformation=["Formula","FormulaType","IsArrayRoot"],t.comparisonIgnoreLists.DynamicArrayInformation=["IsAnchor","Range"],t.comparisonIgnoreLists.MergeInformation=["IsOrigin","WidthAdjustedForDrawing","HeightAdjustedForDrawing","OriginDeltaXAdjustedForDrawing","OriginDeltaYAdjustedForDrawing","SpansNextBlockVertically","SpansNextBlockHorizontally"],t.comparisonIgnoreLists.BorderStyle=["HasDiagBorder"],t.comparisonIgnoreLists.Font=["FontScheme"],t.comparisonIgnoreLists.TextRun=["FontID","GlobalFontID","EndIndex","IsSpecialCharTextRun"],t.comparisonIgnoreLists.RangeInformation=["RangeType"],t.comparisonIgnoreLists.PivotTableRangeInformation=["ConnectionName","ConfirmationRequiredForDataOps","FieldListVersion","FieldWellVersion","ColumnTotalIndexes","RowTotalIndexes","ColumnMemberPropIndexes","RowMemberPropIndexes","ColumnHeaderRange","RowHeaderRange","RowAreaCaptions","ExternalSourceIndex","IsActionable","IsOlap","SupportsBIExplore","Xluid","ShowDrillIndicators","ShowColumnStripes","ShowRowStripes","ShowRowHeaders","ShowColumnHeaders","DataSource","RowLocation","ColGrandTotalOn","RwGrandTotalOn","IndentIncrement","AutoFormatOnUpdate","ShowItemsWithNoDataOnRw","ShowItemsWithNoDataOnCol","SaveSourceDataWithFile","RefreshOnLoad","AltText","AltTextSummary","ErrorString","NullString","DataPivotFieldCaption","DataPivotFieldIndex","DisplayErrorString","DisplayNullString","HasActiveFilter","IsPageArea","RowAreaFields","ColumnAreaFields","ValueAreaFields","PageAreaFields","CurrentStyleName","StyleIndex","IsRefreshableTabularOlap","SlicerConnections","AutoRefresh","SupportsAutoRefresh","OriginPTWidthAdjustedForDrawing","OriginPTHeightAdjustedForDrawing","DeltaXFromOriginPTAdjustedForDrawing","DeltaYFromOriginPTAdjustedForDrawing"],t.comparisonIgnoreLists.Hyperlink=["IsHyperlinkChecked"],t.comparisonIgnoreLists.DynamicImageInformation=["AltText"],t.comparisonIgnoreLists.Sparklines=["Ranges"],t.comparisonIgnoreLists.LinkedEntityInformation=["Domain"],t.comparisonIgnoreLists.PivotTableCellInformation=["ShouldShowExpandCollapseMenu","SourceIndex","ConfirmRequired","CanShowDetails"],t.ignoreCaseLists={},t.ignoreCaseLists.Font=["Color"],t.propertyLists={},t.propertyLists.GridBlockModel=["BlockWidth","BlockHeight","RowOffsets","ColumnOffsets","RowHeights","ColumnWidths","RowNumbers","ColumnNumbers","ColMetadata","FixedColumns","IsBitwiseFixedRows","RowOutlinesInformation","ColumnOutlinesInformation","MaxRowOutlineLevelInSheet","MaxColOutlineLevelInSheet","UniqueId","ShowGridLines","ShowHeaders","IsRtl","IsRow","PermissionSet","GridLineColor","BackgroundColor","Cells","Styles","Fonts","BorderStyles","CellsEncoding","RenderFlagsArray","HandleFlagsMismatch","PageBreaks","PrintAreas","PivotTables","Sparklines","InCellImages","AllRichValueFields","RibbonCommands","AdjacentBlocksHiddensInfo","RichValueTypes","IsCanvasHeadersSupported","HeadersFallbackReason","HasTable","HasOutline","IsEmptyBlocksSupported","EmptyBlocksFallbackReasonBitFlag"],t.propertyLists.Cell=["Col","Row","Text","StyleID","Ifmt","IfmtStamped","BorderStyleID","HorizontalAlignmentSet","Spill","Merge","NumFmt","WrapText","AutoFilter","PivotFilter","TextRuns","CondFormat","PhonInfo","Comment","RichValueType","RichValueFieldsIndexes","FormulaInfo","DynamicArrayInfo","ValueType","HasError","Hyperlink","Sparkline","InCellImage","LinkedEntity","RichValueIcon","PivotTable","HasIgnorableError","SrvDx","SrvDy","TolType","TableColHeader","TableRowHeader","InCellControlOptions","PythonInformation","BitwiseBorderPosition","Value","PhoneticInfo","OriginalText","ErrorTooltip"],t.propertyLists.AutoFilter=["Type","Title","Menu","RenderingContext","CommandData"],t.propertyLists.ShowAutoFilterMenuCommandData=["MenuId","Cell","IsHeaderSnapped"],t.propertyLists.PivotFilter=["Type","DisplayFilter","IsPivotPageField","CommandData","Title","IsHeaderSnapped"],t.propertyLists.ConditionalFormattingInformation=["Icon","DataBar"],t.propertyLists.ConditionalFormattingIcon=["Set","Index","IconOnly","CFIconHorizontalAlignment"],t.propertyLists.DataBarInformation=["AxisPostion","AxisColor","Length","Color","GradientColor","BorderColor","Direction"],t.propertyLists.PhoneticInformation=["Text","PhoneticTextRuns"],t.propertyLists.WrapTextInformation=["BreakOp"],t.propertyLists.AutoFilterMenu=["Id","Sections"],t.propertyLists.AutoFilterRenderingContext=["IsRenderingPermitted","IsHeaderSnapped","IsHidden"],t.propertyLists.MenuSection=["Id","MenuItems","Title","DisplayType"],t.propertyLists.MenuItem=["Disabled","Type","Identifier","RibbonCommand","CommandData","Label","SubMenu","IsChecked","IconName","Id","TooltipText"],t.propertyLists.ReferencedObject=["ID","RefCount"],t.propertyLists.CellStyle=["HorizontalAlignment","VerticalAlignment","BackgroundColor","Gradient","IsPattern","Indentation","ReadingOrder","ShrinkToFit","NamedStyleId","FontID","IsUnlocked","IsHidden","VerticalText","Orientation","PatternStyle","PatternColor"],t.propertyLists.SpillInformation=["SpanToEnd","SpanToStart","IsSpillBlocked"],t.propertyLists.FormulaInformation=["Formula","FormulaType","IsArrayRoot"],t.propertyLists.DynamicArrayInformation=["IsAnchor","Range"],t.propertyLists.MergeInformation=["Columns","Rows","IsOrigin","OriginRow","OriginColumn","SpansBlocks","Width","Height","OriginDeltaX","OriginDeltaY"],t.propertyLists.NumberFormatInformation=["Start","End","Separator"],t.propertyLists.InCellControlOptions=["Type"],t.propertyLists.BorderStyle=["Borders","HasDiagBorder"],t.propertyLists.Border=["BorderLineStyle","BorderPosition","Weight","Color"],t.propertyLists.RGBColor=["Red","Green","Blue"],t.propertyLists.FormattedText=["Text","TextRuns","Fonts"],t.propertyLists.PhoneticRun=["BaseStartIndex","PhoneticStartIndex","BaseTextLength","PhoneticLength"],t.propertyLists.Font=["Size","FontName","FontScheme","Color","Bold","Italic","StrikeThrough","VerticalAlign","Underline"],t.propertyLists.TextRun=["FontID","StartIndex"],t.propertyLists.ColorScheme=["BackgroundColor","LinkColor","TextColor"],t.propertyLists.GradientFill=["Stops","ShadingStyle"],t.propertyLists.ColorStop=["Color","Position"],t.propertyLists.PageBreaksInformation=["Row","Col"],t.propertyLists.RowColBreak=["Index","Min","Max"],t.propertyLists.SharedRange=["FirstRow","FirstColumn","LastRow","LastColumn"],t.propertyLists.RangeInformation=["RangeType"],t.propertyLists.PivotTableRangeInformation=["ConnectionName","PivotTableName","ConfirmationRequiredForDataOps","FieldListVersion","FieldWellVersion","ColumnTotalIndexes","RowTotalIndexes","ColumnMemberPropIndexes","RowMemberPropIndexes","OriginPTWidth","OriginPTHeight","DeltaXFromOriginPT","DeltaYFromOriginPT","ColumnHeaderRange","RowHeaderRange","RowAreaCaptions","ExternalSourceIndex","IsActionable","IsOlap","SupportsBIExplore","HideGridLines","IsEmptyPivot","Xluid","ShowDrillIndicators","ShowColumnStripes","ShowRowStripes","ShowRowHeaders","ShowColumnHeaders","DataSource","RowLocation","ColGrandTotalOn","RwGrandTotalOn","IndentIncrement","AutoFormatOnUpdate","ShowItemsWithNoDataOnRw","ShowItemsWithNoDataOnCol","SaveSourceDataWithFile","RefreshOnLoad","AltText","AltTextSummary","ErrorString","NullString","DataPivotFieldCaption","DataPivotFieldIndex","DisplayErrorString","DisplayNullString","HasActiveFilter","IsPageArea","RowAreaFields","ColumnAreaFields","ValueAreaFields","PageAreaFields","CurrentStyleName","FirstRowIndex","FirstColIndex","LastRowIndex","LastColIndex","StyleIndex","IsRefreshableTabularOlap","SlicerConnections","AutoRefresh","SupportsAutoRefresh"],t.propertyLists.PivotTableFieldInfo=["Index","Caption","ShowBlankLineAfterEachItem","ShowSubtotal","RepeatItemLabels","ShowItemsWithNoData","ShowSubtotalAtTop","IsCompactLayout","BaseFieldIndex","DataFieldAggregationType","DataFieldFormatType","SortInfo","LabelOrDateFilterType","ValueFilterType","MeasureType","HasManualFilter","IsDateField","IsImplicitMeasure","IsNumeric"],t.propertyLists.Hyperlink=["Text","IsValidHyperlink","IsHyperlinkFormula","IsHyperlinkExternal","IsHyperlinkChecked","Tooltip","InternalLink"],t.propertyLists.Outline=["StartIndex","ButtonIndex","IsExpanded","IsButtonHidden","IsNonDefaultDirection","ECTitle"],t.propertyLists.OutlinesLevel=["Outlines"],t.propertyLists.InternalLink=["ObjectName","SheetName"],t.propertyLists.DynamicImages=["ImageUrl","Version"],t.propertyLists.DynamicImageInformation=["ClusterOffsetY","ClusterOffsetX","AltText","Height","Width","ClusterImageHeight","ClusterImageWidth"],t.propertyLists.Sparklines=["Ranges"],t.propertyLists.SparklineRangeInformation=["LocationRow","LocationColumn","SparklineType"],t.propertyLists.LinkedEntityInformation=["Domain","IconWidth"],t.propertyLists.RichValueIconInformation=["Width","Type","Unicode"],t.propertyLists.LinkedEntityServiceDomainId=["Id","StringId"],t.propertyLists.RichValueField=["Value","Index","RefersToDotFunction"],t.propertyLists.PivotTableCellInformation=["HasExpandCollapseIndicator","IsExpanded","ECButtonTitle","ShouldShowExpandCollapseMenu","CanExpandCollapse","SourceIndex","ConfirmRequired","CanShowDetails"],t.propertyLists.SharedSheetCell=["SheetName","NamedObjectName","FirstRow","FirstColumn"],t.propertyLists.SharedSheetRange=["LastRow","LastColumn"],t.propertyLists.SharedSheetFilterRange=["FilteredColumns"],t.propertyLists.RibbonCommands=["ShowAutoFilterMenu","CardViewShowTemporaryDataCard","CardViewShowTemporaryErrorCard","CardViewHideTemporaryCard","CardViewShowDataCardOrDisambiguationPane","ToggleInCellControlCheckbox","DataCleansingShowTaskPane"],t.propertyLists.PermissionSet=["IsAutoFilterDisabled","IsSortDisabled"],t.propertyLists.PythonFormulaInformation=["ReturnType"],t.propertyLists.CommentData=["Row","Column","IsThreadedComment","IsResolved"],t.propertyLists.ColMetadata=["SrvDx","Text","CellValueType","CellStyleId","Autofilter","ExpandColButton","CondWidthIcon","RichValueIcon","IconWidth","InCellControlType","TextRuns"],t.propertyLists.PivotTableSlicerConnectionInfo=["Name","Caption","WorksheetName","Enabled"],t.propertyLists.AdjacentBlocksHiddensInfo=["IsFirstRowOfNextBlockHidden","IsFirstColOfNextBlockHidden","IsLastRowOfPrevBlockHidden","IsLastColOfPrevBlockHidden"],t.propertyLists.PreviewCellsSettings=["PreviewCellsRange","RetainCellTextOnPreview"],t.propertyNameToTypeMap={},t.propertyNameToTypeMap.ColMetadata="ColMetadata",t.propertyNameToTypeMap.RowOutlinesInformation="OutlinesLevel",t.propertyNameToTypeMap.ColumnOutlinesInformation="OutlinesLevel",t.propertyNameToTypeMap.PermissionSet="PermissionSet",t.propertyNameToTypeMap.Cells="Cell",t.propertyNameToTypeMap.Styles="CellStyle",t.propertyNameToTypeMap.Fonts="Font",t.propertyNameToTypeMap.BorderStyles="BorderStyle",t.propertyNameToTypeMap.PageBreaks="PageBreaksInformation",t.propertyNameToTypeMap.PrintAreas="SharedRange",t.propertyNameToTypeMap.PivotTables="PivotTableRangeInformation",t.propertyNameToTypeMap.Sparklines="Sparklines",t.propertyNameToTypeMap.InCellImages="InCellImages",t.propertyNameToTypeMap.AllRichValueFields="RichValueField",t.propertyNameToTypeMap.RibbonCommands="RibbonCommands",t.propertyNameToTypeMap.AdjacentBlocksHiddensInfo="AdjacentBlocksHiddensInfo",t.propertyNameToTypeMap.RichValueTypes="RichValueCellType",t.propertyNameToTypeMap.Spill="SpillInformation",t.propertyNameToTypeMap.Merge="MergeInformation",t.propertyNameToTypeMap.NumFmt="NumberFormatInformation",t.propertyNameToTypeMap.WrapText="WrapTextInformation",t.propertyNameToTypeMap.AutoFilter="AutoFilter",t.propertyNameToTypeMap.PivotFilter="PivotFilter",t.propertyNameToTypeMap.TextRuns="TextRun",t.propertyNameToTypeMap.CondFormat="ConditionalFormattingInformation",t.propertyNameToTypeMap.PhonInfo="PhoneticInformation",t.propertyNameToTypeMap.Comment="CommentData",t.propertyNameToTypeMap.RichValueType="RichValueCellType",t.propertyNameToTypeMap.FormulaInfo="FormulaInformation",t.propertyNameToTypeMap.DynamicArrayInfo="DynamicArrayInformation",t.propertyNameToTypeMap.ValueType="CellValueType",t.propertyNameToTypeMap.Hyperlink="Hyperlink",t.propertyNameToTypeMap.Sparkline="SparklineInformation",t.propertyNameToTypeMap.InCellImage="InCellImageInformation",t.propertyNameToTypeMap.LinkedEntity="LinkedEntityInformation",t.propertyNameToTypeMap.RichValueIcon="RichValueIconInformation",t.propertyNameToTypeMap.PivotTable="PivotTableCellInformation",t.propertyNameToTypeMap.TolType="TolType",t.propertyNameToTypeMap.InCellControlOptions="InCellControlOptions",t.propertyNameToTypeMap.PythonInformation="PythonFormulaInformation",t.propertyNameToTypeMap.Type="RichValueIconType",t.propertyNameToTypeMap.Menu="AutoFilterMenu",t.propertyNameToTypeMap.RenderingContext="AutoFilterRenderingContext",t.propertyNameToTypeMap.Cell="SharedSheetCell",t.propertyNameToTypeMap.Icon="ConditionalFormattingIcon",t.propertyNameToTypeMap.DataBar="DataBarInformation",t.propertyNameToTypeMap.Set="CFIconSet",t.propertyNameToTypeMap.CFIconHorizontalAlignment="HorizontalAlignment",t.propertyNameToTypeMap.Direction="ReadingOrderType",t.propertyNameToTypeMap.PhoneticTextRuns="PhoneticRun",t.propertyNameToTypeMap.Sections="MenuSection",t.propertyNameToTypeMap.MenuItems="MenuItem",t.propertyNameToTypeMap.DisplayType="MenuDisplayType",t.propertyNameToTypeMap.Identifier="MenuEntryIdentifier",t.propertyNameToTypeMap.SubMenu="AutoFilterMenu",t.propertyNameToTypeMap.HorizontalAlignment="HorizontalAlignment",t.propertyNameToTypeMap.VerticalAlignment="VerticalAlignment",t.propertyNameToTypeMap.Gradient="GradientFill",t.propertyNameToTypeMap.ReadingOrder="ReadingOrderType",t.propertyNameToTypeMap.PatternStyle="PatternStyleType",t.propertyNameToTypeMap.FormulaType="CellFormulaType",t.propertyNameToTypeMap.Range="SharedRange",t.propertyNameToTypeMap.Borders="Border",t.propertyNameToTypeMap.BorderLineStyle="BorderLineType",t.propertyNameToTypeMap.BorderPosition="BorderPositionType",t.propertyNameToTypeMap.Color="RGBColor",t.propertyNameToTypeMap.FontScheme="FontSchemeOption",t.propertyNameToTypeMap.VerticalAlign="FontVerticalAlignment",t.propertyNameToTypeMap.Underline="FontUnderline",t.propertyNameToTypeMap.Stops="ColorStop",t.propertyNameToTypeMap.ShadingStyle="GradientShadingStyle",t.propertyNameToTypeMap.Row="RowColBreak",t.propertyNameToTypeMap.Col="RowColBreak",t.propertyNameToTypeMap.RangeType="RangeType",t.propertyNameToTypeMap.ColumnHeaderRange="RangeInformation",t.propertyNameToTypeMap.RowHeaderRange="RangeInformation",t.propertyNameToTypeMap.RowAreaFields="PivotTableFieldInfo",t.propertyNameToTypeMap.ColumnAreaFields="PivotTableFieldInfo",t.propertyNameToTypeMap.ValueAreaFields="PivotTableFieldInfo",t.propertyNameToTypeMap.PageAreaFields="PivotTableFieldInfo",t.propertyNameToTypeMap.SlicerConnections="PivotTableSlicerConnectionInfo",t.propertyNameToTypeMap.DataFieldAggregationType="PivotTableDataFieldAggregationType",t.propertyNameToTypeMap.DataFieldFormatType="PivotTableDataFieldFormatType",t.propertyNameToTypeMap.SortInfo="PivotSortInfo",t.propertyNameToTypeMap.LabelOrDateFilterType="PivotFilterType",t.propertyNameToTypeMap.ValueFilterType="PivotFilterType",t.propertyNameToTypeMap.MeasureType="PivotMeasureType",t.propertyNameToTypeMap.InternalLink="InternalLink",t.propertyNameToTypeMap.Outlines="Outline",t.propertyNameToTypeMap.Ranges="SparklineRangeInformation",t.propertyNameToTypeMap.SparklineType="SparklineType",t.propertyNameToTypeMap.Domain="LinkedEntityServiceDomainId",t.propertyNameToTypeMap.ReturnType="PythonReturnType",t.propertyNameToTypeMap.CellValueType="CellValueType",t.propertyNameToTypeMap.PreviewCellsRange="SharedRange",t.propertyToClassMap={},t.propertyToClassMap.ColMetadata=["ColMetadata"],t.propertyToClassMap.RowOutlinesInformation=["OutlinesLevel"],t.propertyToClassMap.ColumnOutlinesInformation=["OutlinesLevel"],t.propertyToClassMap.PermissionSet=["PermissionSet"],t.propertyToClassMap.Cells=["Cell"],t.propertyToClassMap.Styles=["CellStyle","ReferencedObject"],t.propertyToClassMap.Fonts=["Font","ReferencedObject"],t.propertyToClassMap.BorderStyles=["BorderStyle","ReferencedObject"],t.propertyToClassMap.PageBreaks=["PageBreaksInformation"],t.propertyToClassMap.PrintAreas=["SharedRange"],t.propertyToClassMap.PivotTables=["PivotTableRangeInformation","RangeInformation","SharedRange"],t.propertyToClassMap.Sparklines=["Sparklines","DynamicImages"],t.propertyToClassMap.InCellImages=["InCellImages","DynamicImages"],t.propertyToClassMap.AllRichValueFields=["RichValueField"],t.propertyToClassMap.RibbonCommands=["RibbonCommands"],t.propertyToClassMap.AdjacentBlocksHiddensInfo=["AdjacentBlocksHiddensInfo"],t.propertyToClassMap.Spill=["SpillInformation"],t.propertyToClassMap.Merge=["MergeInformation"],t.propertyToClassMap.NumFmt=["NumberFormatInformation"],t.propertyToClassMap.WrapText=["WrapTextInformation"],t.propertyToClassMap.AutoFilter=["AutoFilter"],t.propertyToClassMap.PivotFilter=["PivotFilter"],t.propertyToClassMap.TextRuns=["TextRun"],t.propertyToClassMap.CondFormat=["ConditionalFormattingInformation"],t.propertyToClassMap.PhonInfo=["PhoneticInformation"],t.propertyToClassMap.Comment=["CommentData"],t.propertyToClassMap.FormulaInfo=["FormulaInformation"],t.propertyToClassMap.DynamicArrayInfo=["DynamicArrayInformation"],t.propertyToClassMap.Hyperlink=["Hyperlink"],t.propertyToClassMap.Sparkline=["SparklineInformation","DynamicImageInformation"],t.propertyToClassMap.InCellImage=["InCellImageInformation","DynamicImageInformation"],t.propertyToClassMap.LinkedEntity=["LinkedEntityInformation"],t.propertyToClassMap.RichValueIcon=["RichValueIconInformation"],t.propertyToClassMap.PivotTable=["PivotTableCellInformation"],t.propertyToClassMap.InCellControlOptions=["InCellControlOptions"],t.propertyToClassMap.PythonInformation=["PythonFormulaInformation"],t.propertyToClassMap.CachedStyle=["CellStyle","ReferencedObject"],t.propertyToClassMap.CachedFont=["Font","ReferencedObject"],t.propertyToClassMap.CachedBorderStyle=["BorderStyle","ReferencedObject"],t.propertyToClassMap.CachedDisplayTextRuns=["TextRun"],t.propertyToClassMap.PreviewNumFmt=["NumberFormatInformation"],t.propertyToClassMap.PreviewCellStyle=["CellStyle","ReferencedObject"],t.propertyToClassMap.InsertButtons=["InsertButtons"],t.propertyToClassMap.Start=["InsertButton"],t.propertyToClassMap.End=["InsertButton"],t.propertyToClassMap.Menu=["AutoFilterMenu"],t.propertyToClassMap.RenderingContext=["AutoFilterRenderingContext"],t.propertyToClassMap.Cell=["SharedSheetCell"],t.propertyToClassMap.Icon=["ConditionalFormattingIcon"],t.propertyToClassMap.DataBar=["DataBarInformation"],t.propertyToClassMap.PhoneticTextRuns=["PhoneticRun"],t.propertyToClassMap.Sections=["MenuSection"],t.propertyToClassMap.MenuItems=["MenuItem"],t.propertyToClassMap.SubMenu=["AutoFilterMenu"],t.propertyToClassMap.Gradient=["GradientFill"],t.propertyToClassMap.Range=["SharedRange"],t.propertyToClassMap.Borders=["Border"],t.propertyToClassMap.Color=["RGBColor"],t.propertyToClassMap.Stops=["ColorStop"],t.propertyToClassMap.Row=["RowColBreak"],t.propertyToClassMap.Col=["RowColBreak"],t.propertyToClassMap.ColumnHeaderRange=["RangeInformation","SharedRange"],t.propertyToClassMap.RowHeaderRange=["RangeInformation","SharedRange"],t.propertyToClassMap.RowAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.ColumnAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.ValueAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.PageAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.SlicerConnections=["PivotTableSlicerConnectionInfo"],t.propertyToClassMap.InternalLink=["InternalLink","SharedRange"],t.propertyToClassMap.Outlines=["Outline"],t.propertyToClassMap.Ranges=["SparklineRangeInformation","RangeInformation","SharedRange"],t.propertyToClassMap.Domain=["LinkedEntityServiceDomainId"],t.propertyToClassMap.CachedFormattedText=["FormattedText"],t.propertyToClassMap.PreviewCellsRange=["SharedRange"],t.UserContentList={},t.UserContentList.Cell=["Text","CachedDisplayText","PreviewText","Value","UserInput","OriginalText"],t.UserContentList.AutoFilter=["CommandData"],t.UserContentList.PivotFilter=["CommandData"],t.UserContentList.PhoneticInformation=["Text"],t.UserContentList.MenuItem=["CommandData","Label"],t.UserContentList.FormulaInformation=["Formula"],t.UserContentList.NumberFormatInformation=["Start","End","Separator"],t.UserContentList.FormattedText=["Text"],t.UserContentList.Font=["FontName"],t.UserContentList.PivotTableFieldInfo=["Caption"],t.UserContentList.Hyperlink=["Text","Tooltip"],t.UserContentList.InternalLink=["ObjectName","SheetName"],t.UserContentList.DynamicImages=["ImageUrl"],t.UserContentList.SharedSheetCell=["SheetName"],t.UserContentList.ColMetadata=["Text"],t.SerializationProperties={},t.SerializationPropertyKey="{className}.{propertyName}",t.SerializationProperties["GridBlockModel.BlockWidth"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.BlockHeight"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowOffsets"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnOffsets"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowHeights"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnWidths"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowNumbers"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnNumbers"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColMetadata"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.FixedColumns"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.IsBitwiseFixedRows"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowOutlinesInformation"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnOutlinesInformation"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.MaxRowOutlineLevelInSheet"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.MaxColOutlineLevelInSheet"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.UniqueId"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ShowGridLines"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ShowHeaders"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.IsRtl"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.IsRow"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PermissionSet"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.GridLineColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.BackgroundColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Cells"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Styles"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Fonts"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.BorderStyles"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.CellsEncoding"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RenderFlagsArray"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.HandleFlagsMismatch"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PageBreaks"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PrintAreas"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PivotTables"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Sparklines"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.InCellImages"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.AllRichValueFields"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RibbonCommands"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ClientOnlyCache"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["GridBlockModel.AdjacentBlocksHiddensInfo"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RichValueTypes"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.IsCanvasHeadersSupported"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.HeadersFallbackReason"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.HasTable"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.HasOutline"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.IsEmptyBlocksSupported"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.EmptyBlocksFallbackReasonBitFlag"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.AreStylesProcessed"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.Col"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Row"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Text"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.StyleID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.GlobalCellStyleID"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.Ifmt"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.IfmtStamped"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.BorderStyleID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.GlobalBorderStyleID"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.HorizontalAlignmentSet"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Spill"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Merge"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.NumFmt"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.WrapText"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.ShrunkSize"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.AutoFilter"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.PivotFilter"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.TextRuns"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.CondFormat"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.PhonInfo"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Comment"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.RichValueType"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.RichValueFieldsIndexes"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.FormulaInfo"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.DynamicArrayInfo"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.ValueType"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.HasError"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Hyperlink"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Sparkline"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.InCellImage"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.LinkedEntity"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.RichValueIcon"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.PivotTable"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.HasIgnorableError"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.SrvDx"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.SrvDy"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.TolType"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.TableColHeader"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.TableRowHeader"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.InCellControlOptions"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.PythonInformation"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.BitwiseBorderPosition"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.CachedStyle"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedFont"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedBorderStyle"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.IsCellSnapped"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedDrawingLayout"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedDisplayText"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedDisplayTextRuns"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedIsTextWidthExceedsCellWidth"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedIndent"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.DisplayFormula"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.PreviewText"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.PreviewNumFmt"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.PreviewCellStyle"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.RetainTextOnPreview"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.ShowSkeleton"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.Value"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.UserInput"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.PhoneticInfo"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.OriginalText"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.ErrorTooltip"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.HorizontalAlignment"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.VerticalAlignment"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.BackgroundColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.Gradient"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.IsPattern"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.Indentation"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.ReadingOrder"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.ShrinkToFit"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.NamedStyleId"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.FontID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.GlobalFontID"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["CellStyle.IsUnlocked"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.IsHidden"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.VerticalText"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.Orientation"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.PatternStyle"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.PatternColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.ID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.RefCount"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.GlobalId"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["BorderStyle.Borders"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.HasDiagBorder"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.ID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.RefCount"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.GlobalId"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Font.Size"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.FontName"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Font.FontScheme"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.Color"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Font.Bold"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Font.Italic"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Font.StrikeThrough"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Font.VerticalAlign"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.Underline"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.ID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.RefCount"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.GlobalId"]={type:"number",ignoreOnSerialize:!0},t.SerializationClasses={},t.SerializationClasses.Cell="Cells",t.SerializationClasses.CellStyle="Styles",t.SerializationClasses.Font="Fonts",t.SerializationClasses.BorderStyle="BorderStyles",t.HeaderIncludeLists={},t.HeaderIncludeLists.GridBlockModel=["BlockWidth","BlockHeight","RowOffsets","ColumnOffsets","RowHeights","ColumnWidths","RowNumbers","ColumnNumbers","RowOutlinesInformation","ColumnOutlinesInformation","MaxRowOutlineLevelInSheet","MaxColOutlineLevelInSheet","ShowHeaders","IsRtl","AdjacentBlocksHiddensInfo","IsCanvasHeadersSupported"],t.HeaderIncludeLists.Cell=["Col","Row","Text","CachedStyle","CachedFont"],t.HeaderIncludeLists.HeaderCell=["InsertButtons"],t.HeaderIncludeLists.InsertButtons=["Start","End"],t.HeaderIncludeLists.InsertButton=["Type"],t.HeaderIncludeLists.CellStyle=["BackgroundColor"],t.HeaderIncludeLists.Font=["Color"],t.HeaderIncludeLists.Outline=["StartIndex","ButtonIndex","IsExpanded","IsButtonHidden","IsNonDefaultDirection"],t.HeaderIncludeLists.OutlinesLevel=["Outlines"],t.HeaderIncludeLists.AdjacentBlocksHiddensInfo=["IsFirstRowOfNextBlockHidden","IsFirstColOfNextBlockHidden","IsLastRowOfPrevBlockHidden","IsLastColOfPrevBlockHidden"]},969:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getComparisonIgnoreLists=void 0;const o=n(212);let r=!1,i=!1;t.getComparisonIgnoreLists=function(e,t,n){if(!e&&!r){const e=n?new Set(["RowOutlinesInformation","ColumnOutlinesInformation","MaxRowOutlineLevelInSheet","MaxColOutlineLevelInSheet","ShowHeaders","AdjacentBlocksHiddensInfo","HasTable","HasOutline"]):new Set(["RowOutlinesInformation","ColumnOutlinesInformation","MaxRowOutlineLevelInSheet","MaxColOutlineLevelInSheet","ShowHeaders","AdjacentBlocksHiddensInfo","IsCanvasHeadersSupported","HasTable","HasOutline"]),t=new Set(["InsertButtons"]),i=new Set(["Start","End"]),l=new Set(["Type","Offset"]),a=o.comparisonIgnoreLists.GridBlockModel.filter((t=>!e.has(t))),s=o.comparisonIgnoreLists.HeaderCell.filter((e=>!t.has(e))),d=o.comparisonIgnoreLists.InsertButtons.filter((e=>!i.has(e))),c=o.comparisonIgnoreLists.InsertButton.filter((e=>!l.has(e)));o.comparisonIgnoreLists.GridBlockModel=a,o.comparisonIgnoreLists.HeaderCell=s,o.comparisonIgnoreLists.InsertButtons=d,o.comparisonIgnoreLists.InsertButton=c,r=!0}if(!t&&!i){const e=new Set(["Title"]),t=o.comparisonIgnoreLists.AutoFilter.filter((t=>!e.has(t)));o.comparisonIgnoreLists.AutoFilter=t,i=!0}return o.comparisonIgnoreLists}},170:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateOnlyStyleWithoutFont=void 0;const o=n(396);t.duplicateOnlyStyleWithoutFont=function(e,t,n){return{BackgroundColor:e.BackgroundColor,HorizontalAlignment:e.HorizontalAlignment||o.HorizontalAlignment.Automatic,ID:t||0,GlobalId:e.GlobalId,NamedStyleId:e.NamedStyleId||0,RefCount:n||0,VerticalAlignment:e.VerticalAlignment,Indentation:e.Indentation||0,IsUnlocked:e.IsUnlocked,IsHidden:e.IsHidden,ReadingOrder:e.ReadingOrder||o.ReadingOrderType.Context,FontID:e.FontID||0,GlobalFontID:e.GlobalFontID||0,ShrinkToFit:e.ShrinkToFit,Gradient:e.Gradient,Orientation:e.Orientation||0,VerticalText:e.VerticalText||!1,PatternStyle:e.PatternStyle||0,PatternColor:e.PatternColor}}},585:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.generateCellStyleKey=t.disableGlobalCellStyles=t.getCellStyleByGlobalID=t.isGlobalCellStylesEnabled=t.getGlobalCellStylesMap=t.GlobalCellStyles=void 0;const o=n(311),r=n(501),i=n(170),l=n(996),a=n(906),s=n(181);let d;class c extends o.GlobalStyles{initializeDefaultStyles(){c.DefaultCellStyleID=this.getOrCreateID(r.DefaultCellStyle)}static getInstance(){if(!c.instance)try{return c.instance=new c,c.instance}catch(e){throw new Error(`exception while creating GlobalCellStyles: ${e}`)}return c.instance}getOrCreateID(e){const t=g(e);if(void 0===t)return;let n=this.keyToGlobalIDMap.get(t);if(void 0===n){n=this.count,e.GlobalId=n;const o=(0,i.duplicateOnlyStyleWithoutFont)(e,e.ID||0,e.RefCount||0);return this.styles.push(o),this.keyToGlobalIDMap.set(t,this.count),this.count=this.count+1,n}return n}getDefaultCellStyle(){return this.styles[c.DefaultCellStyleID]}isEnabled(){return this.enabled}testExports(){return{forceEnableGlobalCellStyles:this.forceEnableGlobalCellStyles}}forceEnableGlobalCellStyles(){c.getInstance().enabled=!0}constructor(){super(),this.initializeDefaultStyles()}}function u(){return c.getInstance()}function h(e){u().disable(e),(0,a.getGlobalFontsMap)().disable("GlobalCellStyles: Due to disabling of Global Cell Styles")}function g(e){if(null!==e.GlobalFontID&&void 0!==e.GlobalFontID)try{const t=(0,a.getFontByGlobalID)(e.GlobalFontID),n=(void 0===d&&(d=(0,s.getBooleanFeatureGate)("Microsoft.Office.Excel.CellStyleKeyGenerationOptimization")),d?e.GlobalFontID.toString():(0,l.generateKeyFromFont)(t));return(0,l.generateKeyFromCellStyle)(e)+n+"|"}catch(e){h(`${e}`)}else h("GenerateCellStyleKey:: Global font ID is not present")}t.GlobalCellStyles=c,c.instance=void 0,t.getGlobalCellStylesMap=u,t.isGlobalCellStylesEnabled=function(){return u().isEnabled()},t.getCellStyleByGlobalID=function(e){return u().getObject(e)},t.disableGlobalCellStyles=h,t.generateCellStyleKey=g},906:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateFont=t.updateGlobalFontIDInCell=t.isGlobalFontsEnabled=t.isGlobalFontsFlightEnabled=t.getGlobalFontsMap=t.getDefaultFont=t.getFontByGlobalID=t.GlobalFonts=void 0;const o=n(996),r=n(311),i=n(445),l=n(501),a=n(520);class s extends r.GlobalStyles{initializeDefaultStyles(){s.DefaultFontID=this.getOrCreateID(l.DefaultGridFont)}static getInstance(){return s.instance||(s.instance=new s),s.instance}getOrCreateID(e){const t=(0,o.generateKeyFromFont)(e);let n=this.keyToGlobalIDMap.get(t);if(void 0===n){n=this.count,e.GlobalId=n;const o=u(e,e.ID||0,e.RefCount||0);return this.styles.push(o),this.keyToGlobalIDMap.set(t,this.count),this.count=this.count+1,n}return n}clear(){i.ULS.sendTraceTag(508389603,i.LogCategory.msoulscat_ES_EWAJSGrid,i.TraceLevel.Warning,`GlobalFonts: Total unique style count is ${this.count}`),super.clear(),this.initializeDefaultStyles()}getDefaultFont(){return this.styles[s.DefaultFontID]}isEnabled(){return this.enabled}testExports(){return{forceEnableGlobalFonts:this.forceEnableGlobalFonts}}forceEnableGlobalFonts(){s.getInstance().enabled=!0}constructor(){super(),this.initializeDefaultStyles()}}function d(){return s.getInstance()}function c(){return d().isEnabled()}function u(e,t,n){return{Bold:e.Bold,Color:e.Color,FontName:e.FontName,FontScheme:e.FontScheme,ID:t||0,GlobalId:e.GlobalId,Italic:e.Italic,RefCount:n||0,Size:e.Size,StrikeThrough:e.StrikeThrough,Underline:e.Underline,VerticalAlign:e.VerticalAlign}}t.GlobalFonts=s,s.instance=void 0,t.getFontByGlobalID=function(e){return d().getObject(e)},t.getDefaultFont=function(){return d().getDefaultFont()},t.getGlobalFontsMap=d,t.isGlobalFontsFlightEnabled=function(e){return(0,a.isGlobalStylesRenderFlagsEnabled)(e)&&c()},t.isGlobalFontsEnabled=c,t.updateGlobalFontIDInCell=function(e){e.CachedStyle&&e.CachedStyle.FontID&&e.CachedFont&&(e.CachedStyle.GlobalFontID=d().getOrCreateID(e.CachedFont))},t.duplicateFont=u},939:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.isGlobalFontsAndCellStylesEnabled=t.isGlobalFontsAndCellStylesFlightEnabled=t.disableGlobalFonts=void 0;const o=n(585),r=n(906),i=n(520);function l(){return(0,o.isGlobalCellStylesEnabled)()&&(0,r.isGlobalFontsEnabled)()}t.disableGlobalFonts=function(e){(0,r.getGlobalFontsMap)().disable(e),(0,o.getGlobalCellStylesMap)().disable("GlobalFonts: Due to disabling of Global Fonts")},t.isGlobalFontsAndCellStylesFlightEnabled=function(e){return(0,i.isGlobalStylesRenderFlagsEnabled)(e)&&l()},t.isGlobalFontsAndCellStylesEnabled=l},501:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultCellStyle=t.DefaultCellStyleID=t.DefaultGridFont=t.DefaultGlobalBorderID=t.DefaultGlobalFontID=t.DefaultGlobalStyleID=void 0,t.DefaultGlobalStyleID=0,t.DefaultGlobalFontID=0,t.DefaultGlobalBorderID=0,t.DefaultGridFont={Color:"#000000",FontName:"Calibri",FontScheme:2,Size:11,Underline:0,VerticalAlign:0},t.DefaultCellStyleID=0,t.DefaultCellStyle={VerticalAlignment:2,GlobalFontID:0,ID:-1}},97:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateBorderStyle=t.disableGlobalBorderStyles=t.isGlobalBorderStylesEnabledNew=t.isGlobalBorderStylesEnabled=t.getGlobalBorderStyleMap=t.getDefaultBorderStyle=t.getBorderStyleByGlobalID=t.GlobalBorderStyles=void 0;const o=n(396),r=n(996),i=n(311),l=n(445),a=n(520),s=n(501);class d extends i.GlobalStyles{initializeDefaultStyles(){d.DefaultBorderStyleID=this.getOrCreateID({Borders:[],ID:s.DefaultGlobalBorderID})}static getInstance(){return d.instance||(d.instance=new d),d.instance}getOrCreateID(e){const t=(0,r.generateKeyFromBorderStyle)(e);let n=this.keyToGlobalIDMap.get(t);if(void 0===n){n=this.count,e.GlobalId=n;const o=u(e,e.ID||0,e.RefCount||0);return this.styles.push(o),this.keyToGlobalIDMap.set(t,this.count),this.count=this.count+1,n}return n}clear(){l.ULS.sendTraceTag(508941207,l.LogCategory.msoulscat_ES_EWAJSGrid,l.TraceLevel.Warning,`GlobalBorderStyles: Total unique style count is ${this.count}`),super.clear(),this.initializeDefaultStyles()}getDefaultBorderStyle(){return this.styles[d.DefaultBorderStyleID]}isEnabled(){return this.enabled}testExports(){return{forceEnableGlobalBorderStyles:this.forceEnableGlobalBorderStyles}}forceEnableGlobalBorderStyles(){d.getInstance().enabled=!0}constructor(){super(),this.initializeDefaultStyles()}}function c(){return d.getInstance()}function u(e,t,n){const o=[];for(let t=0;t<e.Borders.length;t++){const n=e.Borders[t],r={BorderLineStyle:n.BorderLineStyle,BorderPosition:n.BorderPosition,Weight:n.Weight,Color:{Red:n.Color.Red,Blue:n.Color.Blue,Green:n.Color.Green}};o.push(r)}return{Borders:o,GlobalId:e.GlobalId,ID:t||0,RefCount:n||0}}t.GlobalBorderStyles=d,d.instance=void 0,t.getBorderStyleByGlobalID=function(e){return c().getObject(e)},t.getDefaultBorderStyle=function(){return c().getDefaultBorderStyle()},t.getGlobalBorderStyleMap=c,t.isGlobalBorderStylesEnabled=function(e){return(0,a.isRenderFlagEnabled)(o.RenderFlagsArray.GlobalStylesSlice1,e)&&c().isEnabled()},t.isGlobalBorderStylesEnabledNew=function(){return c().isEnabled()},t.disableGlobalBorderStyles=function(e){return c().disable(e)},t.duplicateBorderStyle=u},564:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getGlobalStyleId=t.getGlobalStylesTelemetry=t.preprocessModelStyles=void 0;const o=n(490),r=n(97),i=n(906),l=n(939),a=n(585),s=n(520),d=n(571),c=n(181),u=n(488);let h,g;function f(e,t){try{return(0,d.getReferencedObjectById)(e,t).GlobalId}catch(e){return}}function C(e,t){const n=e.BorderStyleID||0;if(void 0===e.GlobalBorderStyleID||null===e.GlobalBorderStyleID)try{e.GlobalBorderStyleID=f(n,t)}catch(e){throw new Error(`GlobalStyle::GlobalStylesManager::preprocessGlobalBorderStyleIdOfCell: ${e}`)}}function m(e,t){if(e&&e.TextRuns){const n=e.TextRuns;for(let e=0;e<n.length;e++){const o=n[e];if(void 0===o.GlobalFontID||null===o.GlobalFontID)try{o.GlobalFontID=f(o.FontID||0,t)}catch(e){throw new Error(`GlobalStyle::GlobalStylesManager::preprocessGlobalFontIdOfCell: ${e}`)}}}}function p(e,t){const n=e.StyleID||0;if(void 0===e.GlobalCellStyleID||null===e.GlobalCellStyleID)try{e.GlobalCellStyleID=f(n,t)}catch(e){throw new Error(`GlobalStyle::GlobalStylesManager::preprocessGlobalCellStyleIdOfCell: ${e}`)}}t.preprocessModelStyles=function(e){var t;(0,s.verifyArgumentNotNull)(e,"model","preprocessModelStyles"),(0,s.verifyArgumentNotNull)(e.Cells,"model.Cells","preprocessModelStyles");const n=(0,l.isGlobalFontsAndCellStylesFlightEnabled)(e);if(void 0===g&&(g=(0,c.getBooleanFeatureGate)("Microsoft.Office.Excel.CombinedStylesProcessingForCells",!1)),void 0===h&&(h=(0,u.isChangeGateEnabled)(u.ChangeGate.OptimizeProcessingForGlobalStyles)),!h||!(null===(t=e.ClientOnlyCache)||void 0===t?void 0:t.isProcessedForGlobalStyles)){if(g&&n&&(0,r.isGlobalBorderStylesEnabled)(e))try{!function(e){const t=e.Cells,n=e.BorderStyles,l=e.Styles,s=e.Fonts,d=!(0,o.isNullOrUndefined)(n)&&n.length>0,c=!(0,o.isNullOrUndefined)(l)&&l.length>0,u=!(0,o.isNullOrUndefined)(s)&&s.length>0;let h,g,y;if(d&&(h=(0,r.getGlobalBorderStyleMap)(),h.process(n)),u&&c){g=(0,i.getGlobalFontsMap)(),g.process(s);for(let e=0;e<l.length;e++){const t=l[e];if(t){const e=t.FontID||0;if(void 0===t.GlobalFontID||null===t.GlobalFontID)try{t.GlobalFontID=f(e,s)}catch(e){throw new Error(`GlobalStyle::GlobalStylesManager::preprocessCellsWithGlobalStyles while preprocessModelFontsWithGlobalStyles: ${e}`)}}}y=(0,a.getGlobalCellStylesMap)(),y.process(l)}for(let e=0;e<t.length;e++){const o=t[e];try{d&&C(o,n),u&&m(o,s),c&&p(o,l)}catch(e){throw new Error(`GlobalStyle::GlobalStylesManager::preprocessCellsWithGlobalStyles: ${e}`)}}}(e)}catch(e){if(h)return(0,r.disableGlobalBorderStyles)(`${e}`),(0,l.disableGlobalFonts)(`${e}`),void(0,a.disableGlobalCellStyles)(`${e}`);(0,r.disableGlobalBorderStyles)(`${e}`),(0,l.disableGlobalFonts)(`${e}`),(0,a.disableGlobalCellStyles)(`${e}`)}else{if((0,r.isGlobalBorderStylesEnabled)(e)&&!(0,o.isNullOrUndefined)(e.BorderStyles))try{!function(e,t){const n=(0,r.getGlobalBorderStyleMap)();n.process(t);for(let o=0;o<e.length;o++){const r=e[o],i=r.BorderStyleID||0;let l;if(l=void 0!==r.GlobalBorderStyleID&&null!==r.GlobalBorderStyleID&&n.getObject(r.GlobalBorderStyleID)?r.GlobalBorderStyleID:f(i,t),null==l)throw new Error(`GlobalStyle::GlobalStylesManager::preprocessCellsWithGlobalBorderStyles: Local Cell BorderStyleID ${i} not mapped to a Global Border Style ID`);r.GlobalBorderStyleID=l}}(e.Cells,e.BorderStyles)}catch(e){if(h)return(0,r.disableGlobalBorderStyles)(`${e}`),(0,l.disableGlobalFonts)(`${e}`),void(0,a.disableGlobalCellStyles)(`${e}`);(0,r.disableGlobalBorderStyles)(`${e}`)}if(n&&!(0,o.isNullOrUndefined)(e.Fonts)&&!(0,o.isNullOrUndefined)(e.Styles))try{!function(e,t,n){const o=(0,i.getGlobalFontsMap)();o.process(n);for(let e=0;e<t.length;e++){const r=t[e];if(r){const e=r.FontID||0;let t;if(t=void 0!==r.GlobalFontID&&null!==r.GlobalFontID&&o.getObject(r.GlobalFontID)?r.GlobalFontID:f(e,n),null==t)throw new Error(`GlobalStyle::GlobalStylesManager::preprocessModelFontsWithGlobalStyles: Local FontID ${e} not mapped to a Global Font ID`);r.GlobalFontID=t}}for(let t=0;t<e.length;t++){const r=e[t];if(r&&r.TextRuns){const e=r.TextRuns;for(let t=0;t<e.length;t++){const r=e[t];let i;if(i=void 0!==r.GlobalFontID&&null!==r.GlobalFontID&&o.getObject(r.GlobalFontID)?r.GlobalFontID:f(r.FontID||0,n),null==i)throw new Error(`GlobalStyle::GlobalStylesManager::preprocessModelFontsWithGlobalStyles: Local Cell Text run FontID ${r.FontID} not mapped to a Global Font ID`);r.GlobalFontID=i}}}}(e.Cells,e.Styles,e.Fonts)}catch(e){if(h)return(0,r.disableGlobalBorderStyles)(`${e}`),(0,l.disableGlobalFonts)(`${e}`),void(0,a.disableGlobalCellStyles)(`${e}`);(0,l.disableGlobalFonts)(`${e}`)}if(n&&!(0,o.isNullOrUndefined)(e.Styles))try{!function(e,t){const n=(0,a.getGlobalCellStylesMap)();n.process(t);for(let o=0;o<e.length;o++){const r=e[o],i=r.StyleID||0;let l;if(l=void 0!==r.GlobalCellStyleID&&null!==r.GlobalCellStyleID&&n.getObject(r.GlobalCellStyleID)?r.GlobalCellStyleID:f(i,t),null==l)throw new Error(`GlobalStyle::GlobalStylesManager::preprocessCellsWithGlobalStyles: Local Cell StyleID ${i} not mapped to a Global Style ID`);r.GlobalCellStyleID=l}}(e.Cells,e.Styles)}catch(e){if(h)return(0,r.disableGlobalBorderStyles)(`${e}`),(0,l.disableGlobalFonts)(`${e}`),void(0,a.disableGlobalCellStyles)(`${e}`);(0,a.disableGlobalCellStyles)(`${e}`)}}h&&(e.ClientOnlyCache||(e.ClientOnlyCache={}),e.ClientOnlyCache.isProcessedForGlobalStyles=!0)}},t.getGlobalStylesTelemetry=function(){return`{"GlobalBorderStylesCount": ${(0,r.getGlobalBorderStyleMap)().count}, "GlobalFontsCount": ${(0,i.getGlobalFontsMap)().count}, "GlobalCellStylesCount": ${(0,a.getGlobalCellStylesMap)().count} }`},t.getGlobalStyleId=f},525:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.isGetStyleFixChangeGateEnabled=t.getCellStyleByID=t.getFontByID=t.getBorderStyleByID=void 0;const o=n(571),r=n(97),i=n(906),l=n(939),a=n(585),s=n(490),d=n(488),c=n(445);let u;function h(){return void 0===u&&(u=(0,d.isChangeGateEnabled)(d.ChangeGate.GetStyleFix)),u}t.getBorderStyleByID=function(e,t){let n;if((0,r.isGlobalBorderStylesEnabled)(t)&&!(0,s.isNullOrUndefined)(e.GlobalBorderStyleID))try{try{if(!h()&&e.GlobalBorderStyleID){const n=(0,o.getReferencedObjectById)(e.BorderStyleID||0,t.BorderStyles);if(n&&n.GlobalId===e.GlobalBorderStyleID)return n}}catch(e){c.ULS.sendTraceTag(507000596,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Warning,`GlobalStyle: getBorderStyleByID exception in getting optimized border style ${e.message}`)}return(0,r.getBorderStyleByGlobalID)(e.GlobalBorderStyleID)}catch(e){n=void 0,(0,r.disableGlobalBorderStyles)(`getBorderStyleByID failed with exception: ${e.message}`)}return void 0===n?(0,o.getReferencedObjectById)(e.BorderStyleID||0,t.BorderStyles):n},t.getFontByID=function(e,t,n){let r;const a=e.GlobalFontID,d=e.FontID||0,c=(0,l.isGlobalFontsAndCellStylesFlightEnabled)(t);if(c&&!(0,s.isNullOrUndefined)(a))try{r=(0,i.getFontByGlobalID)(a),r||(0,l.disableGlobalFonts)("getFontByGlobalID returned null or undefined")}catch(e){r=void 0,(0,l.disableGlobalFonts)(`getFontByID failed with exception: ${e.message}`)}if(void 0===r){try{if(c&&!(0,s.isNullOrUndefined)(n)){const e=(0,o.getReferencedObjectById)(n||0,t.Styles);return(0,o.getReferencedObjectById)(e.FontID||0,t.Fonts)}}catch(e){return(0,o.getReferencedObjectById)(d||0,t.Fonts)}return(0,o.getReferencedObjectById)(d||0,t.Fonts)}return r},t.getCellStyleByID=function(e,t){let n;if((0,l.isGlobalFontsAndCellStylesFlightEnabled)(t)&&!(0,s.isNullOrUndefined)(e.GlobalCellStyleID))try{try{if(!h()&&e.GlobalCellStyleID){const n=(0,o.getReferencedObjectById)(e.StyleID||0,t.Styles);if(n&&n.GlobalId===e.GlobalCellStyleID)return n}}catch(e){c.ULS.sendTraceTag(507000595,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Warning,`GlobalStyle: getCellStyleByID exception in getting optimized cell style ${e.message}`)}return(0,a.getCellStyleByGlobalID)(e.GlobalCellStyleID)}catch(e){n=void 0,(0,a.disableGlobalCellStyles)(`getCellStyleByID failed with exception: ${e.message}`)}return void 0===n?(0,o.getReferencedObjectById)(e.StyleID||0,t.Styles):n},t.isGetStyleFixChangeGateEnabled=h},311:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalStyles=t.StyleType=void 0;const o=n(490),r=n(501),i=n(445),l=n(488);var a;!function(e){e[e.CellStyle=0]="CellStyle",e[e.BorderStyle=1]="BorderStyle",e[e.Font=2]="Font"}(a||(t.StyleType=a={})),t.GlobalStyles=class{process(e){if(0!==e.length)for(let t=0;t<e.length;t++)if(e[t]){const n=e[t];if(!(0,o.isNullOrUndefined)(n.GlobalId))continue;n.ID||(n.ID=r.DefaultGlobalStyleID);const i=this.getOrCreateID(n);if(void 0===i)throw new Error("GlobalStyle::Interface::Process: global style ID is undefined");n.GlobalId=i}}getObject(e){if(e<0||e>=this.count)throw new Error(`GlobalStyle::Interface::GetStyle: global style ID ${e} is not valid`);return this.styles[e]}clear(){this.count=0,this.styles.splice(0,this.styles.length),this.keyToGlobalIDMap.clear(),this.initializeDefaultStyles()}disable(e){if((0,l.isChangeGateEnabled)(l.ChangeGate.DisableGlobalStylesTagSizeRegressionFix)&&!this.enabled)return;this.enabled=!1;const t=`GlobalStyle::Interface::Disable: ${e} ${new Error(e).stack||""}`;i.ULS.sendTraceTag(508900295,i.LogCategory.msoulscat_ES_EWAJSGrid,i.TraceLevel.Warning,t)}constructor(){this.count=0,this.styles=[],this.keyToGlobalIDMap=new Map,this.enabled=!0}}},996:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.generateKeyFromBorderStyle=t.generateKeyFromFont=t.generateKeyFromCellStyle=t.generateKeyFromModelStyles=void 0;const o=n(311),r="|";function i(e){return[u(e.VerticalText),r,u(e.ShrinkToFit),r,h(e.HorizontalAlignment),r,h(e.VerticalAlignment),r,h(e.ReadingOrder),r,h(e.Orientation||0),r,h(e.Indentation||0),r,h(e.BackgroundColor),r,d(e.Gradient),r,u(e.IsUnlocked),r,u(e.IsHidden),r,h(e.NamedStyleId||0),r,h(e.PatternStyle),r,h(e.PatternColor),r].join("")}function l(e){return[u(e.Bold),r,u(e.Italic),r,u(e.StrikeThrough),r,h(e.FontName),r,h(e.Size),r,h(e.Color),r,h(e.Underline),r,h(e.VerticalAlign),r,h(e.FontScheme),r].join("")}function a(e){var t;const n=[u(e.HasDiagBorder),r];for(let o=0;o<(null===(t=e.Borders)||void 0===t?void 0:t.length);o++){const t=e.Borders[o];t&&n.push(s(t),r)}return n.join("")}function s(e){return[h(e.BorderLineStyle),r,h(e.BorderPosition),r,h(e.Weight),r,(t=e.Color,[h(t.Red),r,h(t.Green),r,h(t.Blue)].join(""))].join("");var t}function d(e){var t;if(!e)return"0";const n=[h(e.ShadingStyle)];for(let o=0;o<(null===(t=e.Stops)||void 0===t?void 0:t.length);o++){const t=e.Stops[o];t&&n.push(r,c(t))}return n.join("")}function c(e){return[h(e.Color),r,h(e.Position)].join("")}function u(e){return e?"1":"0"}function h(e){return e?e.toString():"0"}t.generateKeyFromModelStyles=function(e,t){if(!t)return"0";switch(e){case o.StyleType.CellStyle:return i(t);case o.StyleType.BorderStyle:return a(t);case o.StyleType.Font:return l(t);default:return""}},t.generateKeyFromCellStyle=i,t.generateKeyFromFont=l,t.generateKeyFromBorderStyle=a},199:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.areGridObjectsEqual=t.areGridArraysEqual=t.areGridCellsEqual=t.getCellIgnoreList=t.getNonIgnoredPropertyNames=t.areMergeInformationEqual=t.areNumberFormatInformationEqual=t.areInCellControlOptionsEqual=t.areFormattedTextsEqual=t.areStylesEqual=t.comparePartialGridBlockModels=t.compareGridBlockModels=void 0;const o=n(669),r=n(259),i=n(520),l=n(969),a=n(181),s=n(488);let d,c,u,h,g,f,C,m,p,y,S,R,w,b,I,v,F,T,D,x,A=!1;function B(e,t){if(M(),"object"!=typeof e)return[];const n=Object.getOwnPropertyNames(e);return t?t instanceof Set?n.filter((e=>!t.has(e))):n.filter((e=>-1===t.indexOf(e))):n}function H(e,t){M();const n=(0,o.isAccAndCustomNumFmtApplicable)(e)&&(0,o.isAccAndCustomNumFmtApplicable)(t),r=t.DisplayFormula;let i;return i=n?r?F:T:r?D:x,i}function M(){A||(d=(0,l.getComparisonIgnoreLists)((0,a.getBooleanFeatureGate)("Microsoft.Office.Excel.IgnoreListFix",!1),(0,a.getBooleanFeatureGate)("Microsoft.Office.Excel.IgnoreAutoFilterTitle",!1),(0,s.isChangeGateEnabled)(s.ChangeGate.RemoveIsCanvasHeaderSupported)),c=d.GridBlockModel.concat(["Cells"]).concat(d.RangeInformation).concat(d.PivotTableRangeInformation).concat(d.DynamicImageInformation).concat(d.Sparklines),u=d.Cell.concat(["Row","Col"]),h=u.concat(["Text"]),g=u.concat(["FormulaInfo"]),f=h.concat(["FormulaInfo"]),C=d.ReferencedObject,m=d.CellStyle.concat(C),p=m.concat(d.AutoFilter).concat(d.FormulaInformation).concat(d.MergeInformation).concat(d.TextRun).concat(d.Hyperlink).concat(d.LinkedEntityInformation).concat(d.PivotTableCellInformation),y=d.TextRun,S=[],R=[],w=[],b=y.concat(["Fonts"]),I=new Set(c),v=new Set([...c,"BlockWidth","BlockHeight","RowOffsets","ColumnOffsets","RowHeights","ColumnWidths","RowNumbers","ColumnNumbers"]),F=new Set([...h,...p]),T=new Set([...f,...p]),D=new Set([...u,...p]),x=new Set([...g,...p]),A=!0)}t.compareGridBlockModels=function(e,t,n,o){M();const i=I,l=(0,r.areObjectsEqual)(e,t,i,B,d);return l.isEqual?(0,r.compareModelCells)(e,t,n,B,H,d,o):{isEqual:l.isEqual,message:l.message,canDiffRender:!1,changedCellsKeys:void 0}},t.comparePartialGridBlockModels=function(e,t,n,o,l,a){M();const s=(0,r.areObjectsEqual)(e,t,v,B,d);if(!s.isEqual)return{isEqual:s.isEqual,message:s.message,canDiffRender:!1,changedCellsKeys:void 0};(0,i.verifyArgumentNotNull)(e.RowNumbers,"model1.RowNumbers","comparePartialGridBlockModels"),(0,i.verifyArgumentNotNull)(t.RowNumbers,"model2.RowNumbers","comparePartialGridBlockModels");const c=(0,r.getRowColIndexFromNumber)(e.RowNumbers,n),u=(0,r.getRowColIndexFromNumber)(e.RowNumbers,o),h=(0,r.comparePartialRowsInGridBlockModel)(e,t,c,u);if(!h.isEqual)return h;(0,i.verifyArgumentNotNull)(e.ColumnNumbers,"model1.ColumnNumbers","comparePartialGridBlockModels"),(0,i.verifyArgumentNotNull)(t.ColumnNumbers,"model2.ColumnNumbers","comparePartialGridBlockModels");const g=(0,r.getRowColIndexFromNumber)(e.ColumnNumbers,l),f=(0,r.getRowColIndexFromNumber)(e.ColumnNumbers,a),C=(0,r.comparePartialColumnsInGridBlockModel)(e,t,g,f);return C.isEqual?(0,r.comparePartialCellsInGridBlockModel)(e,t,c,u,g,f,B,H,d):C},t.areStylesEqual=function(e,t,n,o){return M(),(0,r.areObjectsEqual)(e,t,m,n,o)},t.areFormattedTextsEqual=function(e,t){if(M(),e&&t){if(e.TextRuns&&!e.Fonts)return{isEqual:!1,message:"couldn't compare formattedTexts, formattedText1 has Textruns without Fonts."};if(t.TextRuns&&!t.Fonts)return{isEqual:!1,message:"couldn't compare formattedTexts, formattedText2 has Textruns without Fonts."};(0,r.ensureCachedFontsInTextRuns)(e.TextRuns,e.Fonts),(0,r.ensureCachedFontsInTextRuns)(t.TextRuns,t.Fonts)}return(0,r.areObjectsEqual)(e,t,b,B,d)},t.areInCellControlOptionsEqual=function(e,t){return M(),(0,r.areObjectsEqual)(e,t,S,B,d)},t.areNumberFormatInformationEqual=function(e,t){return M(),(0,r.areObjectsEqual)(e,t,R,B,d)},t.areMergeInformationEqual=function(e,t){return M(),(0,r.areObjectsEqual)(e,t,w,B,d)},t.getNonIgnoredPropertyNames=B,t.getCellIgnoreList=H,t.areGridCellsEqual=function(e,t,n,o){return M(),(0,r.areCellsEqual)(e,t,n,o,B,H,d)},t.areGridArraysEqual=function(e,t,n){return M(),(0,r.areArraysEqual)(e,t,n,B,d)},t.areGridObjectsEqual=function(e,t,n,o){return M(),(0,r.areObjectsEqual)(e,t,n,B,d,o)}},571:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getReferencedObjectById=void 0;const o=n(396),r=n(490);t.getReferencedObjectById=function(e,t){let n;switch(e){case o.UniqueStyleID.Default:case o.UniqueStyleID.Hyperlink:n=t[t.length+e];break;default:n=t[e]}if((0,r.isNullOrUndefined)(n))throw Error(`RefObject is null or undefined, id: ${e}`);if((n.ID||0)!==e)throw Error("RefIDs are not sorted as expected");return n}},835:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements=t.RowHeadersNSVStylesArray=t.ColumnHeadersStylesArray=t.RowHeadersStylesArrayBeforeHeaderDragImprovements=t.RowHeadersStylesArray=t.OldHeadersNSVFonts=t.HeadersNSVFonts=t.OldHeadersFonts=t.HeadersFonts=t.AlphaRadix=t.LetterA=t.DefaultHiddenRowColInnerGapPx=t.RowWidthExtensionPerDigitPx=t.MaxNumberOfDigitsInDefaultRowHeader=t.ColHeaderHeightWithDragSquaresArea=t.DefaultColHeaderHeight=t.RowHeaderWidthWithDragSquaresArea=t.RowHeaderWidthWithDragSquaresAreaOld=t.DefaultRowHeaderWidth=t.MinimalCellExtent=t.GroupingLevelExtensionPx=t.GroupingFirstLevelExtensionPx=t.NSVOutlinesColor=t.OutlinesColor=t.NSVGridinesColor=t.SelectedCellsGridlinesColor=t.NSVWholeRowColSelectionAndHoverBackgroundColor=t.NSVPartialRowColSelectionAndHoverBackgroundColor=t.NSVWholeRowColSelectionBackgroundColor=t.NSVPartialRowColSelectionBackgroundColor=t.NSVHoverBackgroundColor=t.NSVHeaderBackgroundColor=t.NoHeadingsGridLineBorderBackgroundColor=t.WholeRowColSelectionAndHoverBackgroundColor=t.WholeRowColSelectionBackgroundColor=t.PartialRowColSelectionAndHoverBackgroundColor=t.PartialRowColSelectionBackgroundColor=t.HoverBackgroundColor=t.DefaultHeaderBackgroundColor=t.OldDefaultHeaderFont=t.PartialRowColSelectionHCFontColor=t.NSVHeaderFontColor=t.WholeSelectionAndHoverFontColor=t.WholeSelectionFontColor=t.PartialSelectionAndHoverFontColor=t.PartialSelectionFontColor=t.HoverFontColor=t.DefaultHeaderFontColor=t.DefaultHeaderFontSize=t.DefaultHeaderFont=void 0,t.HoverHeadersStylesSet=t.WholeSelectionHeadersStylesSet=t.PartiallySelectionHeadersStylesSet=t.ColumnHeadersNSVStylesArray=void 0;const o=n(396);t.DefaultHeaderFont="Aptos Narrow",t.DefaultHeaderFontSize=11,t.DefaultHeaderFontColor="#616161",t.HoverFontColor="#616161",t.PartialSelectionFontColor="#0F703B",t.PartialSelectionAndHoverFontColor="#0C5F32",t.WholeSelectionFontColor="#FFFFFF",t.WholeSelectionAndHoverFontColor="#FFFFFF",t.NSVHeaderFontColor="#FFFFFF",t.PartialRowColSelectionHCFontColor="#000000",t.OldDefaultHeaderFont="Calibri",t.DefaultHeaderBackgroundColor="#F5F5F5",t.HoverBackgroundColor="#EBEBEB",t.PartialRowColSelectionBackgroundColor="#CAEAD8",t.PartialRowColSelectionAndHoverBackgroundColor="#A0D8B9",t.WholeRowColSelectionBackgroundColor="#107C41",t.WholeRowColSelectionAndHoverBackgroundColor="#0F703B",t.NoHeadingsGridLineBorderBackgroundColor="#DAD8D6",t.NSVHeaderBackgroundColor="#333333",t.NSVHoverBackgroundColor="#4D4D4D",t.NSVPartialRowColSelectionBackgroundColor="#637C6E",t.NSVWholeRowColSelectionBackgroundColor="#107C41",t.NSVPartialRowColSelectionAndHoverBackgroundColor="#596D62",t.NSVWholeRowColSelectionAndHoverBackgroundColor="#0F703B",t.SelectedCellsGridlinesColor="#BFBFBF",t.NSVGridinesColor="#DFDFDF",t.OutlinesColor="#AAAEB1",t.NSVOutlinesColor="#AAAEB1",t.GroupingFirstLevelExtensionPx=26,t.GroupingLevelExtensionPx=12,t.MinimalCellExtent=1,t.DefaultRowHeaderWidth=36.5,t.RowHeaderWidthWithDragSquaresAreaOld=42.5,t.RowHeaderWidthWithDragSquaresArea=43,t.DefaultColHeaderHeight=19,t.ColHeaderHeightWithDragSquaresArea=30,t.MaxNumberOfDigitsInDefaultRowHeader=3,t.RowWidthExtensionPerDigitPx=10,t.DefaultHiddenRowColInnerGapPx=3,t.LetterA=65,t.AlphaRadix=26,t.HeadersFonts=[{Color:t.HoverFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.Hover,RefCount:1},{Color:t.PartialSelectionFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.PartialSelection,RefCount:1},{Color:t.PartialSelectionAndHoverFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1},{Color:t.WholeSelectionFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:o.UniqueHeadersFontID.WholeSelection,RefCount:1},{Color:t.WholeSelectionAndHoverFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1},{Color:t.DefaultHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.Default,RefCount:1}],t.OldHeadersFonts=[{Color:t.HoverFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.Hover,RefCount:1},{Color:t.PartialSelectionFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.PartialSelection,RefCount:1},{Color:t.PartialSelectionAndHoverFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1},{Color:t.WholeSelectionFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:o.UniqueHeadersFontID.WholeSelection,RefCount:1},{Color:t.WholeSelectionAndHoverFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1},{Color:t.DefaultHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.Default,RefCount:1}],t.HeadersNSVFonts=[{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.Hover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.PartialSelection,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:o.UniqueHeadersFontID.WholeSelection,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.Default,RefCount:1}],t.OldHeadersNSVFonts=[{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.Hover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.PartialSelection,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:o.UniqueHeadersFontID.WholeSelection,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.Default,RefCount:1}],t.RowHeadersStylesArray=[{ID:o.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.Hover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.PartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.WholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:o.UniqueHeadersStyleID.Default,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1}],t.RowHeadersStylesArrayBeforeHeaderDragImprovements=[{ID:o.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.Hover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.PartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.WholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:o.UniqueHeadersStyleID.Default,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1}],t.ColumnHeadersStylesArray=[{ID:o.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.Hover,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Hover,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.PartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.WholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.HoverLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.Hover,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:o.UniqueHeadersStyleID.HoverRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Hover,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.PartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.PartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.WholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.WholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.LeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.Default,RefCount:1},{ID:o.UniqueHeadersStyleID.RightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1},{ID:o.UniqueHeadersStyleID.Default,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1}],t.RowHeadersNSVStylesArray=[{ID:o.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.Hover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:o.UniqueHeadersStyleID.Default,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1}],t.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements=[{ID:o.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.Hover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:o.UniqueHeadersStyleID.Default,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1}],t.ColumnHeadersNSVStylesArray=[{ID:o.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.Hover,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.HoverLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.HoverRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.LeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.Default,RefCount:1},{ID:o.UniqueHeadersStyleID.RightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1},{ID:o.UniqueHeadersStyleID.Default,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1}],t.PartiallySelectionHeadersStylesSet=new Set([o.UniqueHeadersStyleID.PartialRowColSelection,o.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment,o.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment,o.UniqueHeadersStyleID.PartialSelectionAndHover,o.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment,o.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment]),t.WholeSelectionHeadersStylesSet=new Set([o.UniqueHeadersStyleID.WholeRowColSelection,o.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment,o.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment,o.UniqueHeadersStyleID.WholeSelectionAndHover,o.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment,o.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment]),t.HoverHeadersStylesSet=new Set([o.UniqueHeadersStyleID.Hover,o.UniqueHeadersStyleID.HoverLeftAlignment,o.UniqueHeadersStyleID.HoverRightAlignment,o.UniqueHeadersStyleID.PartialSelectionAndHover,o.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment,o.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment,o.UniqueHeadersStyleID.WholeSelectionAndHover,o.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment,o.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment])},528:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.compareHeaderBlockModels=void 0;const o=n(259),r=n(212),i=n(490),l=r.HeaderIncludeLists.GridBlockModel;function a(e,t){return(0,i.isNullOrUndefined)(t)?[]:t instanceof Array?t:Array.from(t)}function s(e,t){return r.HeaderIncludeLists.Cell.concat(r.HeaderIncludeLists.HeaderCell)}t.compareHeaderBlockModels=function(e,t){const n=(0,o.areObjectsEqual)(e,t,l,a,r.HeaderIncludeLists);return n.isEqual?(0,o.compareModelCells)(e,t,void 0,a,s,r.HeaderIncludeLists):{isEqual:!1,message:n.message,canDiffRender:!1,changedCellsKeys:void 0}}},755:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getRowHeaderStylesArray=t.createHeaderCell=t.calculateRowHeaderWidth=t.columnNumberToTitle=t.createHeaderBlockModel=void 0;const o=n(396),r=n(669),i=n(490),l=n(835),a=n(445),s=n(520),d=n(488),c=n(181);function u(e){if(e)for(const t of e)t&&(t.GlobalId=void 0)}function h(e){let t=e-1;const n=[];for(;t>=0;)n.unshift(String.fromCharCode(l.LetterA+t%l.AlphaRadix)),t=Math.floor(t/l.AlphaRadix)-1;return n.join("")}function g(e,t){return(Math.max(l.MaxNumberOfDigitsInDefaultRowHeader,e)-l.MaxNumberOfDigitsInDefaultRowHeader)*l.RowWidthExtensionPerDigitPx+(t?(0,c.getBooleanFeatureGate)("Microsoft.Excel.Office.RowHeaderWidthUpdated",!1)?l.RowHeaderWidthWithDragSquaresArea:l.RowHeaderWidthWithDragSquaresAreaOld:l.DefaultRowHeaderWidth)}function f(e,t,n,r,i){const l=!r||i?0:1,a=i?"":function(e,t){return t?e.toString():h(e)}(t,n);return{Row:n?e:l,Col:n?l:e,StyleID:o.UniqueHeadersStyleID.Default,BorderStyleID:o.UniqueHeadersStyleID.Default,HorizontalAlignmentSet:!1,ValueType:o.CellValueType.String,Text:a}}function C(e,t){let n;switch(e){case o.ViewMode.Default:n=l.RowHeadersStylesArray;break;case o.ViewMode.NamedSheetView:n=l.RowHeadersNSVStylesArray;break;case o.ViewMode.PresentMode:default:throw Error("headerBlockModelCreator.getModelStyles: unsupported ViewMode")}return n.map((e=>_object_spread_props(_object_spread({},e),{HorizontalAlignment:t&&e.HorizontalAlignment===o.HorizontalAlignment.Left?o.HorizontalAlignment.Right:t&&e.HorizontalAlignment===o.HorizontalAlignment.Right?o.HorizontalAlignment.Left:e.HorizontalAlignment})))}function m(e,t,n){const o=t?e.RowNumbers:e.ColumnNumbers;e.Cells=[];const r=n>0,i=[];for(let n=0;n<o.length;n++){const l=f(n,o[n],t,r,!1);if(e.Cells.push(l),r){const e=f(n,o[n],t,r,!0);i.push(e)}}r&&e.Cells.push(...i)}function p(e,t,n){const i=(0,r.isIncreasedHeaderSizeEnabled)(e);let a;switch(t){case o.ViewMode.Default:return a=i?C(o.ViewMode.Default,e.IsRtl):l.RowHeadersStylesArrayBeforeHeaderDragImprovements,n?a:l.ColumnHeadersStylesArray;case o.ViewMode.NamedSheetView:return a=i?C(o.ViewMode.NamedSheetView,e.IsRtl):l.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements,n?a:l.ColumnHeadersNSVStylesArray;case o.ViewMode.PresentMode:default:throw Error("headerBlockModelCreator.getModelStyles: unsupported ViewMode")}}function y(e,t){const n=(0,s.isRenderFlagEnabled)(o.RenderFlagsArray.NewDefaultTemplate,e)&&(0,s.isRenderFlagEnabled)(o.RenderFlagsArray.NewThemeFontForHeaderFBarNBox,e)&&document.fonts.check(`11pt ${l.DefaultHeaderFont}`);switch(t){case o.ViewMode.Default:return n?l.HeadersFonts:l.OldHeadersFonts;case o.ViewMode.NamedSheetView:return n?l.HeadersNSVFonts:l.OldHeadersNSVFonts;case o.ViewMode.PresentMode:default:throw Error("headerBlockModelCreator.getModelFonts: unsupported ViewMode")}}function S(e){return(0,s.verifyArgumentNotNull)(e,"array","headerBlockModel.duplicateArray"),[...e]}function R(e,t,n){return t?e.BlockHeight:(0,r.isIncreasedHeaderSizeEnabled)(e)?l.ColHeaderHeightWithDragSquaresArea+n:l.DefaultColHeaderHeight+n}function w(e,t,n){return t?function(e,t,n){const o=e.length-1;return e[o]?g(e[o].toString().length,n)+t:(a.ULS.sendTraceTag(508966366,a.LogCategory.msoulscat_ES_EWAJSGrid,a.TraceLevel.Warning,`HeaderBlockModelCreator.getRowHeaderWidth: rowNumbers[lastRowIndex] is undefined, rowNumbers.length: ${e.length}, lastRowIndex: ${o}, rowNumbers: ${e}`),0)}(e.RowNumbers,n,(0,r.isIncreasedHeaderSizeEnabled)(e)):e.BlockWidth}t.createHeaderBlockModel=function(e,t,n){(0,s.verifyArgumentNotNull)(e,"gridModel","headerBlockModel.createHeaderBlockModel");const o=function(e,t){const n=t?e.MaxRowOutlineLevelInSheet:e.MaxColOutlineLevelInSheet;return(0,i.isNullOrUndefined)(n)||0===n?0:l.GroupingFirstLevelExtensionPx+(n-1)*l.GroupingLevelExtensionPx}(e,t),a={RenderFlagsArray:S(e.RenderFlagsArray),BlockHeight:R(e,t,o),BlockWidth:w(e,t,o),IsRtl:e.IsRtl,ShowGridLines:!0,Fonts:y(e,n),Styles:p(e,n,t),ShowHeaders:e.ShowHeaders,AdjacentBlocksHiddensInfo:(c=e.AdjacentBlocksHiddensInfo,c?_object_spread({},c):c),IsRow:t,PermissionSet:e.PermissionSet,RibbonCommands:e.RibbonCommands};var c;return(0,r.isIncreasedHeaderSizeEnabled)(a)&&(u(a.Fonts),u(a.Styles)),(0,d.isChangeGateEnabled)(d.ChangeGate.RestrictStylesPreProcess)&&(a.AreStylesProcessed=!1),t?function(e,t,n){return function(e,t,n){var o;t.RowNumbers=S(e.RowNumbers),t.RowOffsets=S(e.RowOffsets),t.RowHeights=S(e.RowHeights),n>0&&(t.RowOutlinesInformation=(0,r.cloneOutlines)(e.RowOutlinesInformation)),t.MaxRowOutlineLevelInSheet=null!==(o=e.MaxRowOutlineLevelInSheet)&&void 0!==o?o:0}(e,t,n),m(t,!0,n),function(e,t){if(0===t)e.ColumnNumbers=[0],e.ColumnOffsets=[0],e.ColumnWidths=[e.BlockWidth];else{e.ColumnNumbers=[0,1],e.ColumnOffsets=[0,t];const n=e.BlockWidth-t;e.ColumnWidths=[t,n]}}(t,n),t}(e,a,o):function(e,t,n){return function(e,t,n){var o;t.ColumnNumbers=S(e.ColumnNumbers),t.ColumnOffsets=S(e.ColumnOffsets),t.ColumnWidths=S(e.ColumnWidths),n>0&&(t.ColumnOutlinesInformation=(0,r.cloneOutlines)(e.ColumnOutlinesInformation)),t.MaxColOutlineLevelInSheet=null!==(o=e.MaxColOutlineLevelInSheet)&&void 0!==o?o:0}(e,t,n),m(t,!1,n),function(e,t){0===t?(e.RowNumbers=[0],e.RowOffsets=[0],e.RowHeights=(0,r.isIncreasedHeaderSizeEnabled)(e)?[l.ColHeaderHeightWithDragSquaresArea]:[l.DefaultColHeaderHeight]):(e.RowNumbers=[0,1],e.RowOffsets=[0,t],e.RowHeights=(0,r.isIncreasedHeaderSizeEnabled)(e)?[t,l.ColHeaderHeightWithDragSquaresArea]:[t,l.DefaultColHeaderHeight])}(t,n),t}(e,a,o)},t.columnNumberToTitle=h,t.calculateRowHeaderWidth=g,t.createHeaderCell=f,t.getRowHeaderStylesArray=C},669:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.isPartialHeaderCellRenderingEnabled=t.isFixFullySelectedGridLinesBetweenBlocksEnabled=t.isRenderResizePillAcrossBlockEnabled=t.isIncreasedHeaderSizeEnabled=t.isHeaderInsertEnabled=t.processGlobalStyles=t.preprocessStyles=t.modelType=t.getCellBorderStyle=t.cloneOutlines=t.initCellLookup=t.getSpilledOverCount=t.uniqueValuesFilter=t.cellsPositionComparer=t.getCellStyle=t.getCell=t.isDifferentialRenderingSupported=t.getRenderingRegionHitTestCache=t.cleanHitTestCache=t.isFontRefactorFGV3Enabled=t.initModelClientCache=t.validateCellShouldExistInModelUnsafe=t.getOrCreateCell=t.getModelClientCache=t.getAdjacentCellsKeys=t.getAdjacentCellsKeysOld=t.getAllSpillingOverCells=t.getAllSpanningCellsKeys=t.getDefaultCell=t.isAccAndCustomNumFmtApplicable=t.shouldOverrideText=t.getReferencedObjectToCache=t.getRowColFromCellKey=t.getCellLookupKey=void 0;const o=n(571),r=n(396),i=n(490),l=n(757),a=n(488),s=n(525),d=n(520),c=n(445),u=n(564),h=n(639),g=n(97),f=n(939),C=n(181),m=n(585),p=120,y=35,S=160;let R,w,b,I,v,F,T,D;function x(e,t){return(e<<l.CellLookupRowShift)+t}function A(e){const t=e%l.CellLookupColumnMod;return{row:e>>l.CellLookupRowShift,column:t}}function B(e,t,n=void 0,i=void 0){const l=n&&0!==n.length?(0,o.getReferencedObjectById)(r.UniqueStyleID.Default,n):void 0;return{Col:t,CachedStyle:l,CachedFont:i&&0!==i.length&&l?(0,o.getReferencedObjectById)(l.FontID||0,i):void 0,HorizontalAlignmentSet:!1,Ifmt:0,IfmtStamped:0,Row:e,StyleID:r.UniqueStyleID.Default,BorderStyleID:r.UniqueStyleID.DefaultBorder,CachedBorderStyle:{Borders:[],ID:0},Text:"",ValueType:r.CellValueType.None,CachedDrawingLayout:{UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}}}}function H(e,t){const n=[];for(let o=0;o<t.length;o++){const i=t[o],{row:l,column:a}=A(i),{cellBefore:s,cellAfter:d}=X(e,l,a);s&&j(s)&&$(s,a,r.SpillDirection.End)&&n.push(x(s.Row,s.Col)),d&&j(d)&&$(d,a,r.SpillDirection.Start)&&n.push(x(d.Row,d.Col))}return n}function M(e){return e.ClientOnlyCache||k(e),e.ClientOnlyCache}function P(e,t,n){return z(t,n,e)||(O(e,t,n),B(t,n,e.Styles,e.Fonts))}function O(e,t,n){if((0,d.verifyArgumentNotNull)(e.RowNumbers,"RowNumbers","validateCellShouldExistInModelUnsafe"),(0,d.verifyArgumentNotNull)(e.ColumnNumbers,"ColumnNumbers","validateCellShouldExistInModelUnsafe"),(0,d.verifyArgumentNotNull)(e.Styles,"Styles","validateCellShouldExistInModelUnsafe"),t<0||n<0||t>=e.RowNumbers.length||n>=e.ColumnNumbers.length)throw Error(`validateCellShouldExistInModelUnsafe: cell requested for a cell which is not in range of the model. rowIndex:  ${t}, RowNumbers.length: ${e.RowNumbers.length},  colIndex:  ${n}, ColumnNumbers.length: ${e.ColumnNumbers.length}`)}function k(e){e.ClientOnlyCache||(e.ClientOnlyCache={},e.ClientOnlyCache.DirtyType=r.DirtyType.None),e.ClientOnlyCache.RenderingRegionsHitTestCache||function(e){e.ClientOnlyCache&&(e.ClientOnlyCache.RenderingRegionsHitTestCache={})}(e);const t=e.ClientOnlyCache;if(N(e))if(de())t.DirtyCellsMap=new Map(Array.from(t.DirtyCellsMap).sort((([e],[t])=>Y(e,t))));else{const e=t.DirtyCellsKeys.filter(W);t.DirtyCellsKeys=e.sort(Y)}t.CellsToRender=function(e){return N(e)?(e.ClientOnlyCache.CellLookup=_(e),de()?function(e,t){const n=[];for(const[o]of t)J(e,o,n);return n}(e,e.ClientOnlyCache.DirtyCellsMap):Z(e,e.ClientOnlyCache.DirtyCellsKeys)):e.Cells}(e),de()?t.GridlineOverridingCellsToRender=ee(e,void 0,t.DirtyCellsMap):t.GridlineOverridingCellsToRender=ee(e,t.DirtyCellsKeys,void 0),e.ClientOnlyCache.FallbackFonts={},E()&&(e.ClientOnlyCache.renderWithOldDefaultFont=!1)}function E(){return void 0!==F||(F=(0,C.getBooleanFeatureGate)("Microsoft.Office.Excel.FontLoadRefactorV3",!1)),!!F}function L(e,t){e.ClientOnlyCache&&e.ClientOnlyCache.RenderingRegionsHitTestCache||k(e);return e.ClientOnlyCache.RenderingRegionsHitTestCache[t]||(e.ClientOnlyCache.RenderingRegionsHitTestCache[t]={CellCursorHitRegions:{},CellHitRegions:{},CellLongPressHitRegions:{},CellTooltipHitRegions:{}},e.ClientOnlyCache.RenderingRegionsHitTestCache[t])}function N(e){const t=M(e);return de()?t.IsDirty&&!t.DisableDiffRendering&&t.DirtyCellsMap&&t.DirtyCellsMap.size>0:t.IsDirty&&!t.DisableDiffRendering&&t.DirtyCellsKeys&&t.DirtyCellsKeys.length>0}function z(e,t,n){(0,d.verifyArgumentNotNull)(n,"model","initCellLookup");const o=M(n);return o.CellLookup||(o.CellLookup=_(n)),o.CellLookup[x(e,t)]}function G(e,t){return(0,d.verifyArgumentNotNull)(t,"cell","getCellStyle"),(0,d.verifyArgumentNotNull)(e.Styles,"Styles","getCellStyle"),t.CachedStyle||(t.CachedStyle=(0,s.getCellStyleByID)(t,e)),t.CachedStyle}function W(e,t,n){return n.indexOf(e)===t}function V(e,t){return t.Spill?e===r.SpillDirection.Start?t.Spill.SpanToStart:t.Spill.SpanToEnd:0}function _(e){(0,d.verifyArgumentNotNull)(e,"model","initCellLookup"),(0,d.verifyArgumentNotNull)(e.Cells,"model.Cells","initCellLookup");const t={};for(let n=0;n<e.Cells.length;n++){const o=e.Cells[n];if(o)if(t[x(o.Row,o.Col)]=o,o.Merge)for(let e=0;e<=o.Merge.Rows;e++)for(let n=0;n<=o.Merge.Columns;n++)t[x(o.Row+e,o.Col+n)]=o;else t[x(o.Row,o.Col)]=o}return t}function U(e,t){return(0,d.verifyArgumentNotNull)(t,"cell","getCellBorderStyle"),(0,d.verifyArgumentNotNull)(e.BorderStyles,"BorderStyles","getCellBorderStyle"),t.CachedBorderStyle?t.CachedBorderStyle:(0,s.getBorderStyleByID)(t,e)}function j(e){return e&&!!e.Text&&""!==e.Text}function q(e,t,n,o,r){let i=t+n;for(;i>=0&&i<e.length;){const t=e[i];if(t.Row!==o)return;if(j(t))return $(t,r,-n)?t:void 0;i+=n}}function $(e,t,n){const o=Math.abs(t-e.Col);return!!(e.Spill&&V(n,e)>=o)}function X(e,t,n){let o,r;for(let i=0;i<e.length;i++){const l=e[i];if(!(l.Row<t)){if(l.Row>t)break;if(l.Col<n&&(o=l),l.Col>n){r=l;break}}}return{cellBefore:o,cellAfter:r}}function Y(e,t){const n=A(e),o=A(t);return K(n.row,n.column,o.row,o.column)}function K(e,t,n,o){return e===n&&t===o?0:e>n||e===n&&t>o?1:-1}function J(e,t,n){const o=e.ClientOnlyCache.CellLookup[t],{row:r,column:i}=A(t);o&&o.Row===r&&o.Col===i&&n.push(o)}function Z(e,t){const n=[],o=e.ClientOnlyCache;for(let r=0;r<t.length;r++){const i=t[r];if(de())J(e,i,n);else{const e=o.CellLookup[i],{row:t,column:r}=A(i);e&&e.Row===t&&e.Col===r&&n.push(e)}}return n}function Q(e){return(0,d.verifyArgumentNotNull)(e,"model","modelType"),void 0!==e.IsRow?r.ModelType.HeaderBlockModel:r.ModelType.GridBlockModel}function ee(e,t,n){if(!N(e))return e.Cells;if(Q(e)===r.ModelType.HeaderBlockModel)return[];if(de()){const t=new Set;for(const[o]of n){const n=te(e,o);t.add(o);for(let e=0;e<n.length;e++)t.add(n[e])}return Z(e,Array.from(t).sort(Y))}const o=[];for(let n=0;n<t.length;n++){const r=t[n],i=te(e,r);o.push(r);for(let e=0;e<i.length;e++)o.push(i[e])}return Z(e,o.filter(W).sort(Y))}function te(e,t){const n=[],{row:o,column:r}=A(t),i=Math.max(0,r-1),l=Math.min(e.ColumnNumbers.length-1,r+1),a=Math.max(0,o-1),s=Math.min(e.RowNumbers.length,o+1);for(let t=a;t<=s;t++)for(let o=i;o<=l;o++){const r=z(t,o,e);r&&ne(e,r)&&n.push(x(r.Row,r.Col))}return n}function ne(e,t){const n=G(e,t),o=U(e,t);return!!n.BackgroundColor||!!n.Gradient||o.Borders.length>0||!!t.HasError||!!n.PatternStyle}function oe(e,t,n){if(de())for(const[t]of n)e[t]&&(e[t]=[]);else for(let n=0;n<t.length;n++){const o=t[n];e[o]&&(e[o]=[])}}function re(e,t,n,o){try{O(e,n,o);const r=P(e,n,o);t.push(x(r.Row,r.Col)),r.Row===n&&r.Col===o||t.push(x(n,o))}catch(e){return}}function ie(e){if(!function(e){return!(0,i.isNullOrUndefined)(e.Cells)&&((0,d.isGlobalStylesRenderFlagsEnabled)(e)||!(0,i.isNullOrUndefined)(e.BorderStyles))||!(0,i.isNullOrUndefined)(e.Fonts)&&!(0,i.isNullOrUndefined)(e.Styles)}(e))return;void 0!==R&&void 0!==w&&void 0!==b||function(){if((0,a.isChangeGateEnabled)(a.ChangeGate.PassingThresholdCountOfSTylesFromFlight)){const e=`${p}|${y}|${S}`,t=(0,C.getStringFeatureGate)("Microsoft.Office.Excel.ThresholdCountOfStylesForGlobalStylesDisabling",e);if(""===t||(0,i.isNullOrUndefined)(t))return void se();const n=t.split("|");R=parseInt(n[0],10),w=parseInt(n[1],10),b=parseInt(n[2],10)}else se()}(),void 0===T&&(T=(0,C.getBooleanFeatureGate)("Microsoft.Office.Excel.DisableProcessingOfGlobalStylesForLargeNumberOfStyles",!1)),T&&(e.BorderStyles&&e.BorderStyles.length>R&&(0,g.disableGlobalBorderStyles)("Border styles processing disabled due to large number."),e.Fonts&&e.Fonts.length>w&&(0,f.disableGlobalFonts)("Font styles processing disabled due to large number."),e.Styles&&e.Styles.length>b&&(0,m.disableGlobalCellStyles)("Cell styles processing disabled due to large number."));const t=!(0,d.isDisableProcessGlobalStylesTelemetryEnabled)()&&performance.now()%10<1,n=(0,h.trackDuration)((()=>(0,u.preprocessModelStyles)(e)));if(t&&n>=0){let t=`processGlobalStyles: preprocessing time: ${n}, Cells count: ${e.Cells?e.Cells.length:0}`;(0,g.isGlobalBorderStylesEnabled)(e)&&!(0,i.isNullOrUndefined)(e.BorderStyles)&&(t+=`, Borders Styles count: ${e.BorderStyles.length}`),!(0,f.isGlobalFontsAndCellStylesFlightEnabled)(e)||(0,i.isNullOrUndefined)(e.Fonts)||(0,i.isNullOrUndefined)(e.Styles)||(t+=`, Fonts count: ${e.Fonts.length}`,t+=`, Cell styles count: ${e.Styles.length}`),window.requestIdleCallback?window.requestIdleCallback((()=>{le(t)})):setTimeout((()=>{le(t)}),100)}}function le(e){c.ULS.sendTraceTag(508363660,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Info,e)}function ae(){return(0,C.getBooleanFeatureGate)("Microsoft.Office.Excel.HeaderInsert",!1)}function se(){R=p,w=y,b=S}function de(){return null!=D||(D=(0,C.getBooleanFeatureGate)("Microsoft.Office.Excel.PartialHeaderCellRendering",!1)),D}t.getCellLookupKey=x,t.getRowColFromCellKey=A,t.getReferencedObjectToCache=function(e,t){if((0,a.isChangeGateEnabled)(a.ChangeGate.TreatZeroAndUndefinedAsEqual)){if((0,d.verifyArgumentNotNull)(e,"Id","helpers.getReferencedObjectToCache"),!(0,i.isNullOrUndefined)(t))return(0,o.getReferencedObjectById)(e,t)}else if(!(0,i.isNullOrUndefined)(t)&&!(0,i.isNullOrUndefined)(e))return(0,o.getReferencedObjectById)(e,t)},t.shouldOverrideText=function(e){if(e.RichValueType)return!1;const t=e.ValueType;return t===r.CellValueType.Number||t===r.CellValueType.Boolean||t===r.CellValueType.Error},t.isAccAndCustomNumFmtApplicable=function(e){return!!function(e){return e.ValueType===r.CellValueType.Number}(e)&&!(0,i.isNullOrUndefined)(e.NumFmt)&&""!==e.Text},t.getDefaultCell=B,t.getAllSpanningCellsKeys=function(e,t,n){let o=[];if(o=o.concat(function(e,t,n){if(!t.Merge&&!t.Spill)return[];const o=[];if(t.Merge)for(let e=0;e<=t.Merge.Rows;e++)for(let n=0;n<=t.Merge.Columns;n++)o.push(x(t.Row+e,t.Col+n));if(t.Spill){for(let e=0;e<t.Spill.SpanToEnd;e++)o.push(x(t.Row,t.Col+e+1));for(let e=0;e<t.Spill.SpanToStart;e++)o.push(x(t.Row,t.Col-e-1));if(t.Spill.SpanToEnd){const i=t.Col+t.Spill.SpanToEnd,l=q(e,n,r.SpillDirection.End,t.Row,i);l&&o.push(x(l.Row,l.Col))}if(t.Spill.SpanToStart){const i=t.Col-t.Spill.SpanToStart,l=q(e,n,r.SpillDirection.Start,t.Row,i);l&&o.push(x(l.Row,l.Col))}}return o}(e,t,n)),0===o.length){const i=q(e,n,r.SpillDirection.Start,t.Row,t.Col);i&&o.push(x(i.Row,i.Col));const l=q(e,n,r.SpillDirection.End,t.Row,t.Col);l&&o.push(x(l.Row,l.Col))}return o},t.getAllSpillingOverCells=H,t.getAdjacentCellsKeysOld=function(e,t,n){const o=[];if(t-1>=0){const r=P(e,t-1,n);o.push(x(r.Row,r.Col))}if(n-1>=0){const r=P(e,t,n-1);o.push(x(r.Row,r.Col))}if(t+1<e.RowNumbers.length){const r=P(e,t+1,n);o.push(x(r.Row,r.Col))}if(n+1<e.ColumnNumbers.length){const r=P(e,t,n+1);o.push(x(r.Row,r.Col))}return o},t.getAdjacentCellsKeys=function(e,t){var n,o;let r=[];const i=Math.max(0,t.Row-1),l=Math.min(e.RowNumbers.length-1,t.Row+1+((null==t||null===(n=t.Merge)||void 0===n?void 0:n.Rows)||0)),a=Math.max(0,t.Col-1),s=Math.min(e.ColumnNumbers.length-1,t.Col+1+((null===(o=t.Merge)||void 0===o?void 0:o.Columns)||0));for(let t=i;t<=l;t++)re(e,r,t,a),re(e,r,t,s);for(let t=a;t<=s;t++)re(e,r,i,t),re(e,r,l,t);return r=r.concat(H(e.Cells,r)),r},t.getModelClientCache=M,t.getOrCreateCell=P,t.validateCellShouldExistInModelUnsafe=O,t.initModelClientCache=k,t.isFontRefactorFGV3Enabled=E,t.cleanHitTestCache=function(e,t){const n=L(e,t),o=e.ClientOnlyCache;N(e)?(oe(n.CellHitRegions,o.DirtyCellsKeys,o.DirtyCellsMap),oe(n.CellCursorHitRegions,o.DirtyCellsKeys,o.DirtyCellsMap),oe(n.CellTooltipHitRegions,o.DirtyCellsKeys,o.DirtyCellsMap),oe(n.CellLongPressHitRegions,o.DirtyCellsKeys,o.DirtyCellsMap)):o.RenderingRegionsHitTestCache&&(o.RenderingRegionsHitTestCache[t]={CellCursorHitRegions:{},CellHitRegions:{},CellLongPressHitRegions:{},CellTooltipHitRegions:{}})},t.getRenderingRegionHitTestCache=L,t.isDifferentialRenderingSupported=N,t.getCell=z,t.getCellStyle=G,t.cellsPositionComparer=function(e,t){return K(e.Row,e.Col,t.Row,t.Col)},t.uniqueValuesFilter=W,t.getSpilledOverCount=V,t.initCellLookup=_,t.cloneOutlines=function(e){if(!e||0===e.length)return;const t=[];for(let n=0;n<e.length;++n){const o=e[n],r={Outlines:[]};for(let e=0;e<o.Outlines.length;++e){const t=_object_spread({},o.Outlines[e]);r.Outlines.push(t)}t.push(r)}return t},t.getCellBorderStyle=U,t.modelType=Q,t.preprocessStyles=function(e){if(void 0===v&&(v=(0,C.getBooleanFeatureGate)("Microsoft.Office.Excel.GlobalStylesRegressionFix",!1)),!v)if(void 0===I&&(I=(0,a.isChangeGateEnabled)(a.ChangeGate.RestrictStylesPreProcess)),I){const t=Q(e);t!==r.ModelType.HeaderBlockModel||e.AreStylesProcessed?t!==r.ModelType.GridBlockModel||N(e)||ie(e):(ie(e),e.AreStylesProcessed=!0)}else ie(e)},t.processGlobalStyles=ie,t.isHeaderInsertEnabled=ae,t.isIncreasedHeaderSizeEnabled=function(e){return(0,d.isRenderFlagEnabled)(r.RenderFlagsArray.HeaderDragImprovements,e)||ae()},t.isRenderResizePillAcrossBlockEnabled=function(){return(0,C.getBooleanFeatureGate)("Microsoft.Office.Excel.RenderResizePillAcrossBlock",!1)},t.isFixFullySelectedGridLinesBetweenBlocksEnabled=function(){return(0,C.getBooleanFeatureGate)("Microsoft.Office.Excel.FixFullySelectedGridLinesBetweenBlocks",!1)},t.isPartialHeaderCellRenderingEnabled=de},306:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.annonymize=t.serializeModel=t.serializeCell=void 0;const o=n(212),r=n(378),i=n(669),l=n(488);let a=!1,s=[];function d(e){return e.toLowerCase().replace(r.DigitReplaceValue,r.CharacterReplaceValue).replace(r.Digit,r.DigitReplaceValue).replace(r.ValueAnnonymizerRegex,r.CharacterReplaceValue)}function c(e){return(t,n)=>n&&e&&e.indexOf(t)>-1?d(n):n}s=o.UserContentList.Cell.concat(o.UserContentList.GridBlockModel).concat(o.UserContentList.CellStyle).concat(o.UserContentList.Font).concat(o.UserContentList.BorderStyle).concat(o.UserContentList.AutoFilter).concat(o.UserContentList.PivotFilter).concat(o.UserContentList.MenuItem).concat(o.UserContentList.FormulaInformation).concat(o.UserContentList.NumberFormatInformation).concat(o.UserContentList.InCellControlType).concat(o.UserContentList.InCellControlOptions),t.serializeCell=function(e,t){if((0,l.isChangeGateEnabled)(l.ChangeGate.FixUserContentList)&&!a){s=[];for(const e in o.UserContentList)s=s.concat(o.UserContentList[e]);a=!0}return e&&t?(e.CachedStyle=(0,i.getReferencedObjectToCache)(e.StyleID||0,t.Styles),e.CachedBorderStyle=(0,i.getReferencedObjectToCache)(e.BorderStyleID||0,t.BorderStyles),e.CachedFont=(0,i.getReferencedObjectToCache)(e.CachedStyle.FontID||0,t.Fonts),s?JSON.stringify(e,c(s)):JSON.stringify(e)):""},t.serializeModel=function(e){if((0,l.isChangeGateEnabled)(l.ChangeGate.FixUserContentList)&&!a){s=[];for(const e in o.UserContentList)s=s.concat(o.UserContentList[e]);a=!0}return e?s?JSON.stringify(e,c(s)):JSON.stringify(e):""},t.annonymize=d},639:function(e,t){let n;function o(){if(n)return n;n=!1,window.performance&&"function"==typeof window.performance.now&&(n=!0);try{window.performance.now()}catch(e){n=!1}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.trackDuration=t.verifyPerformanceNowSupported=t.perf=void 0,t.perf=o()?window.performance:void 0,t.verifyPerformanceNowSupported=o,t.trackDuration=function(e){const n=t.perf?t.perf.now():-1;return e(),t.perf?t.perf.now()-n:-1}},490:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isNullOrUndefined=void 0,t.isNullOrUndefined=function(e){return null==e}},480:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},872:function(e,t){let n;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGatesManagerSet=t.isChangeGateEnabled=t.setChangeGatesManager=void 0,t.setChangeGatesManager=e=>{n=e},t.isChangeGateEnabled=e=>!n||n.isChangeGateEnabled(e),t.isChangeGatesManagerSet=()=>!!n},91:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const o=n(440);o.__exportStar(n(872),t),o.__exportStar(n(480),t)},773:function(e,t){function n(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0,t.getChangeGateDictionary=n,t.isChangeGateEnabled=function(e){var t;return null===(t=n()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},491:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;const n={};function o(){return void 0===globalThis.__get_feature_gate_dictionary_variable?n:globalThis.__get_feature_gate_dictionary_variable()}function r(e,t){var n;return null!==(n=o()[e])&&void 0!==n?n:t}t.getFeatureGateDictionary=o,t.getStringFeatureGate=r,t.getBooleanFeatureGate=function(e,t){var n;const o=null===(n=r(e))||void 0===n?void 0:n.trim().toLowerCase();return"true"===o||"false"!==o&&t},t.getNumberFeatureGate=function(e,t){var n;const o=null===(n=r(e))||void 0===n?void 0:n.trim().toLowerCase();if(void 0===o)return t;if("infinity"===o||"+infinity"===o)return 1/0;if("-infinity"===o)return-1/0;const i=parseFloat(o);return isNaN(i)?t:i},t.getIntFeatureGate=function(e,t){var n;const o=null===(n=r(e))||void 0===n?void 0:n.trim();if(void 0===o)return t;const i=parseInt(o,10);return isNaN(i)?t:i},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t}},181:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const o=n(440);o.__exportStar(n(491),t),o.__exportStar(n(422),t),o.__exportStar(n(773),t),o.__exportStar(n(952),t),o.__exportStar(n(861),t),o.__exportStar(n(809),t)},422:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;const o=n(491);t.makeGetTypedFeatureGate=function(e){return function(t){const n=e[t];switch(typeof n){case"boolean":return(0,o.getBooleanFeatureGate)(t,n);case"number":return(0,o.getNumberFeatureGate)(t,n);case"string":return(0,o.getStringFeatureGate)(t,n);default:throw new Error("Wrong defaultValue type")}}}},952:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;const o=n(773);t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,o.isChangeGateEnabled)(e)}},861:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;const o=n(773);function r(e){const t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((()=>_object_spread({},void 0!==t?t():{},e))),t}t.overrideChangeGates=r,t.overrideTypedChangeGates=function(e,t){return r(t)}},809:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;const o=n(491);function r(e){const t={};for(const o of Object.keys(e)){var n;t[o]=null===(n=e[o])||void 0===n?void 0:n.toString()}var r;const i=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:()=>({});return(0,o.setFeatureGateDictionaryGetter)((()=>_object_spread({},i(),t))),i}t.overrideFeatureGates=r,t.overrideTypedFeatureGates=function(e,t){return r(t)}},365:function(e,t,n){n.d(t,{P:function(){return o}});class o{sendTraceTag(){}shipAssertTag(){}debugAssertTag(){}setCorrelationId(){}}},356:function(e,t,n){var o;n.d(t,{n:function(){return o}}),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptGc2EditCanvas=852]="msoulscat_Wac_PptGc2EditCanvas",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",e[e.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",e[e.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",e[e.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",e[e.msoulscat_Wac_CopilotComposeLaunchpad=3054]="msoulscat_Wac_CopilotComposeLaunchpad",e[e.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor"}(o||(o={}))},777:function(e,t,n){var o;n.d(t,{k:function(){return o}}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(o||(o={}))},586:function(e,t,n){n.d(t,{GY:function(){return r},Hv:function(){return i},n6:function(){return l}});var o=n(365);class r{setCorrelationId(e){this.externalLogger.setCorrelationId(e)}setLogger(e){this.externalLogger=e}sendTraceTag(e,t,n,o){this.externalLogger.sendTraceTag(e,t,n,o)}debugAssertTag(e,t,n,o){this.externalLogger.debugAssertTag(e,t,n,o)}shipAssertTag(e,t,n,o){this.externalLogger.shipAssertTag(e,t,n,o)}constructor(){this.externalLogger=new o.P}}const i=new r;function l(e){if(!e)throw new Error("The 'logger' argument is missing");i.setLogger(e)}},445:function(e,t,n){n.r(t),n.d(t,{CategoryLogger:function(){return y},ConsoleLogger:function(){return p},LogCategory:function(){return f.n},LogType:function(){return o},NoopLogger:function(){return C.P},RemoteUlsLogger:function(){return c},TraceLevel:function(){return s.k},ULS:function(){return r.Hv},UlsLoggerWrapper:function(){return r.GY},UnitTestLogger:function(){return m},formatForUpload:function(){return l},getUlsLogger:function(){return u},getUlsLoggerDeprecated:function(){return h},initializeLogger:function(){return r.n6},uploadLogs:function(){return i}});var o,r=n(586);function i(e,t,n){if(!t)return;const o=window.navigator;if(o&&o.sendBeacon)try{return void o.sendBeacon(t,e)}catch(e){}!function(e,t,n){const o=new XMLHttpRequest;o.readyState!==XMLHttpRequest.UNSENT&&o.readyState!==XMLHttpRequest.DONE||(o.open("POST",t,n),o.send(e))}(e,t,n)}function l(e,t,n,o){const r=[],i=e.map((e=>function(e,t,n){const o={};if(o.G=e.tag,o.T=e.timestamp-t,o.M=e.message,o.C=e.category,e.correlationId){let t=n.findIndex((t=>t===e.correlationId));t<0&&(t=n.push(e.correlationId)-1),o.I=t}const r=e.type*a+e.level;return o.D=r,o}(e,o,r))),l=function(e,t,n,o,r){const i={};return i.T=e,i.L=t,i.S=n,i.I=o,r&&r.length>0&&(i.W=r),i.V=1,i}(o,i,t,n,r);return JSON.stringify(l)}!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(o||(o={}));const a=1e3;var s=n(777);class d{handleTrace(e){e.message.length>d.messageMaxChars&&(e.message=e.message.substr(0,d.messageMaxChars-d.trimmedMessage.length)+d.trimmedMessage),this.logCache.push(e),(this.logCache.length>d.uploadTriggerSize||e.level===s.k.Error)&&this.triggerUploadAsync()}constructor(e,t,n){this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=()=>{this.triggerUpload(!1,!1)},this.flush=()=>{this.triggerUploadAsync()},this.triggerUploadAsync=()=>{window.setTimeout((()=>this.triggerUpload(!0,!0)),0)},this.triggerUpload=(e,t)=>{window.clearTimeout(this.timeoutId),this.logCache.length>0&&(this.uploadId+=1,i(l(this.logCache,this.userSessionId,this.uploadId,this.timestampBase),this.remoteUrlEndpoint,t),this.logCache=[],this.timestampBase=Date.now()),e&&(this.timeoutId=window.setTimeout(this.triggerUploadAsync,d.uploadCadenceInMsSec))},this.userSessionId=e;let o=t+"?usid="+e;void 0!==n&&n.forEach(((e,t)=>{o+="&"+t+"="+e})),this.remoteUrlEndpoint=o,window.setTimeout((()=>this.triggerUpload(!0,!0)),0)}}d.messageMaxChars=3072,d.uploadCadenceInMsSec=3e4,d.uploadTriggerSize=30,d.trimmedMessage="... [Trimmed]";class c{setCorrelationId(e){this.correlationId=e}sendTraceTag(e,t,n,o){g(this.cache,e,t,n,o,this.correlationId)}debugAssertTag(e,t,n,o){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")}shipAssertTag(e,t,n,o){n&&g(this.cache,e,t,s.k.Error,o,this.correlationId)}flush(){this.cache.flush()}flushOnClose(){this.cache.flushOnClose}constructor(e,t,n){this.correlationId="",this.cache=new d(e,t,n)}}function u(e,t){return new c(e,t)}function h(e,t){const n=new d(e,t);return{sendTraceTag:(e,t,o,r)=>g(n,e,t,o,r,""),shipAssertTag:(e,t,o,r)=>{o&&g(n,e,t,s.k.Error,r,"")},debugAssertTag:()=>{throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:n.flush,flushOnClose:n.flushOnClose,setCorrelationId:()=>{}}}function g(e,t,n,r,i,l){if(r>s.k.Info)return;const a={timestamp:Date.now(),category:n,tag:t,level:r,type:o.Trace,message:i,correlationId:l};e.handleTrace(a)}var f=n(356),C=n(365);class m extends C.P{}class p{static tagIntToString(e){return e<=p.maxNumericTag?e.toString():e>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e):p.map.charAt(e>>24&63)+p.map.charAt(e>>18&63)+p.map.charAt(e>>12&63)+p.map.charAt(e>>6&63)+p.map.charAt(63&e)}getLogMessage(e,t,n){let o=`tag_${p.tagIntToString(e)} [${f.n[t]}] ${n}`;return this.correlationId&&""!==this.correlationId&&(o+=`\t\t${this.correlationId}`),o}sendTraceTag(e,t,n,o){let r=this.logMessage;switch(n){case s.k.Error:r=this.logError;break;case s.k.Warning:r=this.logWarning;break;case s.k.Info:r=this.logInfo;break;case s.k.Verbose:r=this.logVerbose;break;case s.k.Spam:default:r=this.logMessage}try{r(this.getLogMessage(e,t,o))}catch(e){const t="undefined"!=typeof navigator?navigator:void 0;if(t&&!/rv:11.0/i.test(t.userAgent))throw e}}shipAssertTag(e,t,n,o){console.assert(n,this.getLogMessage(e,t,o))}debugAssertTag(e,t,n,o){this.shipAssertTag(e,t,n,o)}setCorrelationId(e){this.correlationId=e}logMessage(e){"log"in console&&console.log(e)}logError(e){"error"in console&&console.error(e)}logWarning(e){"warn"in console&&console.warn(e)}logInfo(e){"info"in console&&console.info(e)}logVerbose(e){"debug"in console&&console.debug(e)}constructor(){this.correlationId=""}}p.maxNumericTag=65535,p.minOldSchemeHighByteValue=36,p.map="abcdefghijklmnopqrstuvwxyz0123456789";class y{info(e,t,...n){r.Hv.sendTraceTag(e,this.category,s.k.Info,this.messageToLog(t,n))}warn(e,t,...n){r.Hv.sendTraceTag(e,this.category,s.k.Warning,this.messageToLog(t,n))}error(e,t,...n){r.Hv.sendTraceTag(e,this.category,s.k.Error,this.messageToLog(t,n))}messageToLog(e,...t){return t.length?`${e}: ${t.map((e=>JSON.stringify(e))).join(", ")}`:e}constructor(e){this.category=e}}}},o={};function r(e){var t=o[e];if(void 0!==t)return t.exports;var i=o[e]={exports:{}};return n[e](i,i.exports,r),i.exports}r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};r.r(i),r.d(i,{gridRenderer:function(){return a},rumShepherd:function(){return l}});var l={};r.r(l),r.d(l,{AppLoadMetricReportEventName:function(){return v},FUNCTIONALLY_READY:function(){return g},RumShepherdFactoryGlobal:function(){return ce},SubComponentInitEventName:function(){return b},SubComponentSetLoadStateEventName:function(){return I},VISUALLY_PERCEIVED:function(){return f},VISUALLY_READY:function(){return h},dispatchRumShepherdEvent:function(){return T},setupDefaultRumShepherd:function(){return se}});var a={};r.r(a),r.d(a,{CanvasRendererFactory:function(){return cb},CanvasRendererFactoryGlobal:function(){return ub},CanvasRendererGlobals:function(){return gT},CanvasServiceSettings:function(){return Ce},FontEndPoint:function(){return pe},FontLoadState:function(){return ue},FontRenderingLogStage:function(){return ye},GridCanvasRenderer:function(){return US},LoadStatus:function(){return he},MessageLevel:function(){return ge},StaticImages:function(){return fe},TableSelectorType:function(){return me},UnavailabilityToast:function(){return CT},UnavailabilityToastFactory:function(){return mT},UnavailabilityToastManager:function(){return RT},toastElementId:function(){return fT}});const s="stable-interactivity",d="first-input",c="first-interaction",u="first-idle",h="visually-ready",g="functionally-ready",f="visually-perceived";var C=r(777);function m(){const e=window.performance;return e&&e.timeOrigin?e.timeOrigin:e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:0}function p(){const e=window.performance;return e&&e.now?e.now():(new Date).getDate()-m()}function y(){const e=window.performance;return e&&e.now?m()+e.now():(new Date).getDate()}function S(e){return m()+e}let R=[];function w(e,t,n,o){const r=`[rum:${Number(p().toFixed())}]${t} ${n?JSON.stringify(n):""}`;R.push({level:e,message:r}),o&&function(){const e={traces:[...R]};R=[],T(F,e)}()}const b="Wac-SubComponentsInit",I="Wac-SubComponentSetLoadState",v="Wac-AppLoadMetricReport",F="Wac-AppLoadTrace",T=(e,t)=>{try{const n=new CustomEvent(e,{detail:t});self.dispatchEvent(n)}catch(e){w(C.k.Error,"dispatchRumShepherdEvent failed with exception:",e)}};function D(e){return e===h||e===g||e===f}function x(e,t){for(const o in e){var n;if(!(null===(n=e[o].states[t])||void 0===n?void 0:n.final))return!1}return!0}function A(e,t){return t&&e&&D(t)&&e.states[t]}function B(e){return e?_object_spread({},e):{}}function H(e){const t=[];for(const n in e){const o=e[n];t.push({id:o.id,rootElementId:o.rootElementId,subComponents:P(o.subComponents)})}return t}function M(e){const t=[];for(const n in e){const o=e[n];t.push({id:o.id,rootElementId:o.rootElementId,subComponents:O(o.subComponents)})}return t}function P(e){const t=[];for(const n in e){const o=e[n];o.nonReporting||t.push({id:o.id,initTime:S(o.initTime),optional:o.optional,unused:o.unused,nonReporting:o.nonReporting,states:k(o.states)})}return t}function O(e){const t=[];for(const n in e){const o=e[n];o.nonReporting&&t.push({id:o.id,initTime:S(o.initTime),optional:o.optional,unused:o.unused,nonReporting:o.nonReporting,states:k(o.states)})}return t}function k(e){const t={};for(const n in e){const o=e[n];(null==o?void 0:o.time)&&(t[n]=S(o.time))}return t}function E(e,t){const n=e.subComponents;for(const e in n){const o=n[e];if(!(o.states[t]||o.unused||o.nonReporting))return!1}return!0}function L(e){let t=Number.POSITIVE_INFINITY;for(const n in e.subComponents){const o=e.subComponents[n];t=Math.min(t,o.initTime)}return t}function N(e,t){if(!e||!t)return!1;const n=e.subComponents;for(const e in n)if(!z(n[e],t))return!1;return!0}function z(e,t){if(!e)return!1;const n=e.states[t];return e.optional||(null==n?void 0:n.time)&&n.promotedFromPreviousState}function G(e,t){return t===h&&A(e,f)}function W(e,t){return{start:e.start,time:null!=t?t:e.time,error:e.error,monitor:e.monitor,measures:B(e.measures),data:B(e.data)}}function V(e,t,n,o){"then"in e?e.then((e=>{o(e)})).catch((e=>{const r=`Error in invokeMonitor [${n}}]`;w(C.k.Error,r,e),o({start:t,time:t,monitor:"",error:`${r}: ${e}`})})):o(e)}class _{getBooleanSetting(e,t){const n=this._settings[e];if(!n)return t;switch(n.trim().toLowerCase()){case"true":return!0;case"false":return!1;default:return t}}getStringSetting(e,t){return this._settings[e]||t}constructor(e){this._settings=null!=e?e:{}}}class U{get timeout(){return this.timeoutInMs}get reason(){return this._reason}set onCancelled(e){this._onCancelled=e}constructor(e){this.timeoutInMs=e,this._reason="",this._cancel=e=>{this._reason||(this._reason=e?"timeout":"cancelled",this._onCancelled&&this._onCancelled())},this.cancel=()=>{this._cancel(!1)},e>0&&window.setTimeout((()=>this._cancel(!0)),e)}}function j(e){return new U(null!=e?e:0)}class q{get tabHideTime(){return this._firstTabHiddenTime}get metrics(){return this._metrics}startMonitors(e,t){w(C.k.Verbose,"startMonitors",{appState:e});const n=(e,n)=>{if(w(C.k.Verbose,"onCompleteWithInputCheck",{metric:e}),n){if(!n.error){const e=this._metrics[d]?this._metrics[d].time:0,t=this._metrics[c]?this._metrics[c].time:0;e>0&&e<n.time&&(0===t||e<=t)&&(n.error="first-input"),t>0&&t<n.time&&(n.error="first-interaction")}t(e,n)}};e===h&&(this.monitorMetric(d,t),this.monitorMetric(c,t),this.monitorMetric(u,n),this.monitorMetric(s,n,12e4))}cancelMonitors(e){if(e!==h)return;w(C.k.Info,"cancelAppStateMonitors",e);const t=e=>{var t;null===(t=this._monitoredMetrics[e])||void 0===t||t.cancel(),this._monitoredMetrics[e]=void 0,this._metrics[e]=void 0};t(s),t(u)}monitorMetric(e,t,n){if(w(C.k.Verbose,"monitorMetric",e),this._monitoredMetrics[e])return void w(C.k.Verbose,"monitorMetric:already-running",e);const o=j(n);this._monitoredMetrics[e]=o;const r=p();V((0,this._shepherdInit.monitors[e])(r,o),r,e,(n=>{w(C.k.Verbose,"monitorMetric:complete",e),t(e,n)}))}constructor(e){this._metrics={},this._monitoredMetrics={},this._firstTabHiddenTime=0,this._shepherdInit=e,function(e){let t="hidden"===document.visibilityState?0:1/0;e(t),document.addEventListener("visibilitychange",(n=>{t=Math.min(t,n.timeStamp),e(t)}),{once:!0})}((e=>this._firstTabHiddenTime=e))}}function $(e,t,n,o,r){r&&t.nonReporting||(e.states[n]={result:W(o),monitoring:void 0,final:E(e,n)})}class X{ProcessUnusedComponentFinal(e){for(const t in e.states){const n=t,o=e.states[n];!o.final&&E(e,n)&&(w(C.k.Verbose,"processSubComponentUnused:unused-final",{component:e.id,state:n}),o.final=!0,this._reportAppStateIfReady(n))}}addSubComponents(e){if(!(e&&e.component&&e.subComponents))return void w(C.k.Error,"Invalid data",e);const t=this._components[e.component];if(!t)return void w(C.k.Error,"Invalid component",e);const n=t.ignoreNewSubComponents;if(function(e){for(const t in e.states)if(e.states[t].final)return!1;return!0}(t)||n){w(C.k.Verbose,"addSubComponents",{ignore:n,data:e});try{const o=Array.isArray(e.subComponents)?e.subComponents:[e.subComponents];for(let e=0;e<o.length;e+=1)this._addSubComponent(t,o[e],n,!1,!1);if(e.optionalSubComponents)for(let o=0;o<e.optionalSubComponents.length;o+=1)this._addSubComponent(t,e.optionalSubComponents[o],n,!0,!1);if(e.nonReportingSubComponents)for(let o=0;o<e.nonReportingSubComponents.length;o+=1)this._addSubComponent(t,e.nonReportingSubComponents[o],n,!0,!0)}catch(e){w(C.k.Error,"addSubComponents",e)}}else w(C.k.Error,"Component cannot be modified",e)}setSubComponentState(e){var t;const n=p();if(!(e&&e.subComponent&&e.component&&e.state))return void w(C.k.Error,"Invalid data",e);const o=this._components[e.component];if(!o)return void w(C.k.Error,"Invalid component",e);if(o.ignoredSubComponents[e.subComponent])return;o.ignoreNewSubComponents=o.ignoreNewSubComponents||!!e.ignoreNewSubComponents;const r=o.subComponents[e.subComponent];if(!r)return void w(C.k.Error,"Unexpected sub-component",e);if("unused"===e.state)return void this._processSubComponentUnused(o,r);const i=e.state;if(!D(i))return void w(C.k.Error,"Unknown state reported",e);if(null===(t=o.states[i])||void 0===t?void 0:t.final)return void w(C.k.Error,"Component state final. Can't set",e);if(r.unused||r.states[i])return void w(C.k.Error,"SubComponent unused or set",e);const l=e.promoteStateFrom;l?this._processSubComponentState(o,r,i,n,l):this._processSubComponentState(o,r,i,n)}get components(){return this._components}get metrics(){return this._monitorMetrics.metrics}constructor(e){this._components={},this._reportedMetrics={},this._canAppStateMetricBeReported=e=>{if(this._reportedMetrics[e])return!1;const t=x(this._components,e);return w(C.k.Verbose,"canAppStateMetricBeReported:metric-final:",{metric:e,isFinal:t}),t},this._canMonitorMetricBeReported=e=>{if(e===s||e===u){const t=this._monitorMetrics.metrics[e],n=x(this._components,h);return w(C.k.Verbose,"canMonitorMetricBeReported:si-error:",{metric:e,error:null==t?void 0:t.error,vrStateFinal:n}),!!t&&"cancelled"!==t.error&&n}return!0},this._reportMonitorMetricIfReady=e=>{const t=this._reportedMetrics[e],n=this._canMonitorMetricBeReported(e);!t&&n?this._reportMetricInternal(e):w(C.k.Info,"reportMonitorMetricIfReady:not-ready",{metric:e,isReported:t,canMetricBeReported:n})},this._reportAppStateIfReady=e=>{this._canAppStateMetricBeReported(e)&&this._reportMetricInternal(e)},this._reportMetricInternal=e=>{try{const t=this._monitorMetrics.metrics[e],n={metric:e,timeOrigin:this._timeOrigin,time:t.time,error:t.error||(this._monitorMetrics.tabHideTime<t.time?"tab-switch":void 0),monitor:t.monitor,measures:B(t.measures),data:B(t.data),auxMetrics:[],componentsData:H(this._components),nonReportingComponentData:M(this._components)},o=n.measures;if(o.tabsSwitch=this._monitorMetrics.tabHideTime<t.time?this._monitorMetrics.tabHideTime:0,o.start=t.start,o.reportedTime=p(),e===s){const e=this._monitorMetrics.metrics[h];o[h]=e?e.time:0;const t=this._monitorMetrics.metrics[g];o[g]=t?t.time:0}if(D(e)){for(const t in this._components){const r=this._components[t];if(!r)continue;const i=r.states[e].result;if(!i)continue;o[t]=i.time,n.error=n.error||i.error;const l={metric:`${e}-${t}`,time:i.time,monitor:i.monitor,error:i.error,measures:B(i.measures)};l.measures.start=i.start,l.measures.init=L(r),n.auxMetrics.push(l)}const t=this._monitorMetrics.metrics[s];t&&t.error&&"cancelled"!==t.error&&!n.error&&(n.error="si-error")}this._shepherdInit.appLoadMetricReportCallback&&(this._reportedMetrics[e]=!0,w(C.k.Info,"reportMetric:reporting",e,!0),this._shepherdInit.appLoadMetricReportCallback(n))}catch(e){w(C.k.Error,"reportMetric:error",e)}},this._flushRumShepherdState=()=>{const e={time:y(),allMetricsReported:(t=this._reportedMetrics,!!(t[h]&&t[g]&&t[s]&&t[d]&&t[c]&&t[u])),metrics:this._monitorMetrics.metrics,components:H(this._components),timeOrigin:m()};var t;this._shepherdInit.appLoadStateLoggingCallback(e)},this._processSubComponentState=(e,t,n,o,r)=>{if(A(t,r)){const e=t.states[r];t.states[n]={time:e.time,promotedFromPreviousState:!0}}else t.states[n]={time:o,promotedFromPreviousState:!1};if(w(C.k.Verbose,"processSubComponentState",{component:e.id,subComponent:t.id,state:n}),!function(e,t){const n=e.subComponents;for(const e in n){const o=n[e].states[t];if(!((null==o?void 0:o.time)||n[e].optional||G(n[e],t)))return!1}return!0}(e,n))return void w(C.k.Verbose,"processSubComponentState:component-not-ready",{component:e.id,state:n});const i=(e,t,n)=>{t&&(w(C.k.Info,"processSubComponentState:complete-appstate-metric",e),this.metrics[e]=W(t,n),this._reportAppStateIfReady(e))},l=(e,t)=>{t&&(w(C.k.Info,"processSubComponentState:complete-monitor-metric",e),this.metrics[e]=W(t),this._reportMonitorMetricIfReady(e))},a=(e,t)=>{const n=function(e,t){let n=0;for(const i in e){var o,r;const l=null===(r=e[i].states[t])||void 0===r||null===(o=r.result)||void 0===o?void 0:o.time,a=e[i].allSubComponentsUnused;if(!l&&!a)return;l&&(n=Math.max(n,l))}return n}(this._components,e);w(C.k.Verbose,"processSubComponentState:appStateTime",{time:n,state:e}),n&&(i(e,t,n),this._monitorMetrics.startMonitors(e,l))};this._monitorMetrics.cancelMonitors(n);const s=this._settingsManager.getBooleanSetting("RumShepherdNonReportingComponentsIsEnabled",!1),d=A(t,r),c=function(e,t){if(t&&e&&e.states[t]){const n=e.states[t];return(null==n?void 0:n.result)&&(null==n?void 0:n.final)}return!1}(e,r);if(d){const o=e.states[r];return c?N(e,n)?($(e,t,n,o.result,s),void a(n,o.result)):void 0:void(N(e,n)&&o.monitoring&&(w(C.k.Verbose,"processSubComponentState: detected promotion while previous state is monitoring, marking state to promote later.",{component:e.id,state:n,promotedFromState:r}),o.stateToPromoteWhenFinal=n))}if(e.allSubComponentsUnused){const t={start:0,time:0,monitor:""};return e.states[n]={result:W(t),final:!0},w(C.k.Verbose,"processSubComponentState:setting component's state timings to 0 since all subComponents are unused",{component:e.id,state:n}),void a(n,t)}void 0!==r&&w(C.k.Verbose,"processSubComponentState:starting monitor although we are promoting",{component:e.id,subComponent:t.id,promotedFromState:r,state:n,isPromotingAndPromotedStateExists:d,isPreviousStateHasAFinalResult:c});const u=this._shepherdInit.monitors[n];w(C.k.Verbose,"processSubComponentState:start-monitor",{state:n}),function(e,t,n,o){const r=e.states[t];if(null==r?void 0:r.final)return;(null==r?void 0:r.monitoring)&&(null==r||r.monitoring.cancel());const i=p(),l=j(5e3);e.states[t]={monitoring:l,final:E(e,t)},V(n(i,l,e),i,t,o)}(e,n,u,(o=>{w(C.k.Verbose,"processSubComponentState:monitor-complete",{state:n});const r=e.states[n].stateToPromoteWhenFinal;$(e,t,n,o,s),r&&(w(C.k.Verbose,"processSubComponentState: promotion callback detected state to promote.",{component:e.id,state:n,stateToPromote:r}),$(e,t,r,o,s)),a(n,o)}))},this._processSubComponentUnused=(e,t)=>{w(C.k.Verbose,"processSubComponentUnused",{subComponent:t.id}),t.unused=!0;const n=e.subComponents;let o=!0;for(const e in n)n[e].unused||(o=!1);o?(e.allSubComponentsUnused=!0,this._processSubComponentState(e,t,f,0),w(C.k.Verbose,"processSubComponentUnused:vp-final",{component:e.id,VISUALLY_PERCEIVED:f}),e.states[f].final=!0,this._reportAppStateIfReady(f),this._processSubComponentState(e,t,h,0),w(C.k.Verbose,"processSubComponentUnused:vr-final",{component:e.id,VISUALLY_READY:h}),e.states[h].final=!0,this._reportAppStateIfReady(h),this._processSubComponentState(e,t,g,0),w(C.k.Verbose,"processSubComponentUnused:fr-final",{component:e.id,FUNCTIONALLY_READY:g}),e.states[g].final=!0,this._reportAppStateIfReady(g)):this.ProcessUnusedComponentFinal(e),this._reportMonitorMetricIfReady(s),this._reportMonitorMetricIfReady(u)},this._addSubComponent=(e,t,n,o,r)=>{n?e.ignoredSubComponents[t]=!0:e.subComponents[t]||(e.subComponents[t]={id:t,initTime:p(),optional:o,unused:!1,nonReporting:r,states:{}})},w(C.k.Info,"initialize"),this._timeOrigin=Number(Number(m()).toFixed()),this._shepherdInit=_object_spread({},e),this._monitorMetrics=new q(this._shepherdInit),this._settingsManager=new _(this._shepherdInit.appSettings);for(const t of e.components)this._components[t.id]={id:t.id,rootElementId:t.rootElementId,ignoreNewSubComponents:!1,subComponents:{},states:{},ignoredSubComponents:{}};window.setTimeout((()=>this._flushRumShepherdState()),12e4)}}function Y(e){return"PerformanceObserver"in window&&"function"==typeof PerformanceObserver&&PerformanceObserver.supportedEntryTypes&&-1!==PerformanceObserver.supportedEntryTypes.indexOf(e)}function K(e,t){return window.requestAnimationFrame?new Promise((n=>{let o;const r=(r=0)=>{cancelAnimationFrame(o),n({start:e,time:r,monitor:"rAF",error:t.reason})};t.onCancelled=r,o=requestAnimationFrame((()=>{r(p())}))})):Promise.resolve({start:e,time:0,monitor:"",error:"rAF Unsupported"})}function J(e,t){return new Promise((n=>{let o,r;const i=(i=0)=>{cancelAnimationFrame(o),clearTimeout(r),n({start:e,time:i,monitor:"rAF-setTimeout",error:t.reason})};t.onCancelled=()=>i(),o=requestAnimationFrame((()=>{r=window.setTimeout((()=>{i(p())}),0)}))}))}const Z="StableInteractivityDetected";function Q(e,t,n=1e3){const o=t||j(12e3);if(!Y("longtask"))return function(e,t){const n=p();if(!window.requestAnimationFrame)return Promise.resolve({start:n,time:0,monitor:"",error:"rAF unsupported"});const o=p();let r=0,i=o,l=0,a=0,s=o;return new Promise((o=>{let d;const c=(t=0)=>{cancelAnimationFrame(d);const i={start:n,time:t,monitor:"long-frames",error:e.reason,measures:{longTasksCount:r,longestTaskDuration:a,longTasksDuration:l}};o(i)};e.onCancelled=c;const u=e=>{let n=e-i;const o=e-s;if(s=e,o>=50&&(n=0,l+=o,r+=1,i=e,a=Math.max(a,o)),n>=t)return c(i),void ee();d=window.requestAnimationFrame(u)};d=window.requestAnimationFrame(u)}))}(o,n);const r=performance.now();let i=0,l=r,a=0,s=0;return new Promise((t=>{let r;const d=()=>{clearTimeout(r),c&&c.disconnect();const n=p()-e,d={start:e,time:l,monitor:"longtask-api",error:o.reason,measures:{longTasksDuration:a,longTasksCount:i,longestTaskDuration:s,monitoredTime:n}};t(d)};o.onCancelled=d;const c=new PerformanceObserver((function(e){e.getEntries().forEach((e=>{i+=1,a+=e.duration;const t=e.startTime+e.duration;l=Math.max(t,l),s=Math.max(s,e.duration)}))}));c.observe({entryTypes:["longtask"]});const u=()=>{const e=performance.now()-l;if(e>=n)d(),ee();else{const t=n-e;r=window.setTimeout(u,t)}};r=window.setTimeout(u,n)}))}function ee(){try{self.dispatchEvent(new CustomEvent(Z))}catch(e){w(C.k.Error,`${Z} failed with exception: ${e}`)}}function te(e,t){return Y("first-input")?new Promise((n=>{let o;const r=(t,r,i)=>{o&&o.disconnect(),n({start:e,time:t,monitor:"first-input-api",error:i,measures:{fid:r}})};try{t.onCancelled=()=>r(0,0,t.reason);const e=e=>{const t=e.processingStart,n=t-e.startTime;r(t,n)};o=new PerformanceObserver((t=>{t.getEntries().forEach((t=>e(t)))})),o.observe({type:"first-input",buffered:!0})}catch(e){r(0,0,"exception")}})):Promise.resolve({start:e,time:0,monitor:"",error:"FID unsupported"})}function ne(e,t){const n=["click","mousedown","keydown","touchstart","pointerdown","wheel","select","contextmenu","scroll"],o={passive:!0,capture:!0},r=y();return new Promise((i=>{const l=(n,o,r)=>{s(removeEventListener);const l={start:e,time:n,monitor:"first-interaction",error:t.reason,data:{eventName:o},measures:{delay:r}};i(l)};t.onCancelled=()=>l(0,"",0);const a=e=>{if(e.cancelable){const t=y(),n=e.timeStamp>1e12;let o=(n?y():performance.now())-e.timeStamp;(o<0||o>t-r)&&(o=0),l(n?e.timeStamp-m():e.timeStamp,e.type,o)}},s=e=>{n.forEach((function(t){e(t,a,o)}))};s(addEventListener)}))}function oe(e,t){return window.requestIdleCallback?new Promise((n=>{let o;const r=(t,r)=>{window.cancelIdleCallback(o),n({start:e,time:t,monitor:"first-idle",error:r})};try{o=window.requestIdleCallback((e=>r(p(),e.didTimeout?"timeout":"")),{timeout:t.timeout}),t.onCancelled=()=>r(0,t.reason)}catch(e){r(0,"exception")}})):Promise.resolve({start:e,time:0,monitor:"",error:"requestIdleCallback unsupported"})}let re=0;const ie=e=>{const t=`report ${e.metric}:${e.time}ms`;w(C.k.Info,t,e);const n=new CustomEvent(v,{detail:e});self.dispatchEvent(n)},le=e=>{w(C.k.Info,`reporting the application load state at epoch time: ${e.time}; with the status of all metrics reported as ${e.allMetricsReported}`,e);const t=new CustomEvent("Wac-AppLoadStateReport",{detail:e});self.dispatchEvent(t)},ae=(e,t,n)=>{if(n){const o=`vr-${n.id}-${re}`;re+=1;const r=document.documentElement;return function(e,t,n,o){let r=o?function(e,t,n,o){if(!Y("element"))return;const r="testimg-"+n,i=function(e){const t=document.createElement("img");if(e){if(!("elementTiming"in t))return;t.elementTiming=e}return t.style.position="absolute",t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",t.ariaHidden="true",t}(r);if(!i)return;const l=null!=o?o:document.documentElement;return new Promise((n=>{const o=(t=0,o)=>{a&&a.disconnect(),n({start:e,time:t,monitor:"image-paint-api",error:o})},a=new PerformanceObserver((e=>{const t=e.getEntries();for(const e of t){const t=e;if(t.identifier===r){try{i.hidden=!0,l.removeChild(i)}catch(e){w(C.k.Error,"measureImagePaintTime",e)}return void o(t.renderTime)}}}));t.onCancelled=()=>o(0,t.reason),a.observe({type:"element",buffered:!0}),l.appendChild(i)}))}(e,t,n,o):void 0;return r||(r=K(e,t)),r}(e,t,o,null!=r?r:void 0)}return K(e,t)};function se(e,t){const n=function(e){return new X(e)}({appLoadMetricReportCallback:ie,appLoadStateLoggingCallback:le,appSettings:t,monitors:{"visually-ready":ae,"visually-perceived":ae,"functionally-ready":J,"stable-interactivity":Q,"first-input":te,"first-interaction":ne,"first-idle":oe},components:e});window.addEventListener(b,(e=>{const t=e.detail;n.addSubComponents(t)})),window.addEventListener(I,(e=>{const t=e.detail;n.setSubComponentState(t)}))}class de{constructor(e){this.rumShepherdDataCollection=[],this.collectRumShepherdAction=e=>{e&&this.rumShepherdDataCollection.push(e)},this.stopRumShepherdDataRetrieverEventListener=()=>{window.removeEventListener("Wac-AppLoadMetricReport",this.eventCallback)},this.eventCallback=e=>{const t=e.detail;"visually-ready"===t.metric&&(this.stopRumShepherdDataRetrieverEventListener(),this.getComponentData(t.auxMetrics),this.shouldCollectSubComponentData&&(this.timeOrigin=t.timeOrigin,this.getSubComponentDataForComponents(t.componentsData)))},this.getSubComponentDataForComponents=e=>{e.forEach((e=>{e.subComponents.forEach((t=>{t.unused||t.nonReporting||(this.collectRumShepherdAction({startTime:0,endTime:t.initTime-this.timeOrigin,rumShepherdDataProps:{component:`${e.id}`,subComponent:`${t.id}`,state:"VRInit"}}),this.collectRumShepherdAction({startTime:t.initTime-this.timeOrigin,endTime:t.states["visually-ready"]-this.timeOrigin,rumShepherdDataProps:{component:`${e.id}`,subComponent:`${t.id}`,state:"VRInitToVR"}}))}))}))},this.getComponentData=e=>{e.forEach((e=>{this.collectRumShepherdAction({startTime:0,endTime:e.measures.init,rumShepherdDataProps:{component:`${e.metric.replace("visually-ready-","")}`,subComponent:"",state:"VRInit"}}),this.collectRumShepherdAction({startTime:e.measures.init,endTime:e.time,rumShepherdDataProps:{component:`${e.metric.replace("visually-ready-","")}`,subComponent:"",state:"VRInitToVR"}})}))},this.retrieveRumShepherdEventsBetweenTimeRange=(e,t)=>this.rumShepherdDataCollection.filter((n=>e<=n.endTime&&t>=n.startTime)),this.shouldCollectSubComponentData=e,window.addEventListener("Wac-AppLoadMetricReport",this.eventCallback)}}const ce=new class{setupDefault(e){if(e)return se(e),null}setupDefaultWithAppSettings(e,t){if(!e)return;const n={};try{if(t)for(const e of t.keys())if(e){const o=t.get(e);o&&(n[e]=o)}se(e,n)}catch(e){w(C.k.Error,"appSettings: map to dictionary conversion error",e)}return null}createAndInitRumShepherdDataRetriever(e){return new de(e)}};var ue,he,ge,fe,Ce,me,pe,ye;!function(e){e[e.NotInitialized=-1]="NotInitialized",e[e.Start=0]="Start",e[e.Loaded=1]="Loaded",e[e.Completed=2]="Completed"}(ue||(ue={})),function(e){e[e.Loaded=0]="Loaded",e[e.Error=1]="Error",e[e.Loading=2]="Loading",e[e.Unloaded=3]="Unloaded",e[e.Missing=4]="Missing",e[e.Undefined=5]="Undefined",e[e.Unexpected=6]="Unexpected"}(he||(he={})),function(e){e[e.Info=0]="Info",e[e.Monitorable=1]="Monitorable",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(ge||(ge={})),function(e){e[e.EmptyPivotTable=0]="EmptyPivotTable",e[e.RichValueIconDisambig=1]="RichValueIconDisambig",e[e.RichValueIconSync=2]="RichValueIconSync"}(fe||(fe={})),function(e){e[e.CanvasEventHandlersMeasureDurationMs=0]="CanvasEventHandlersMeasureDurationMs",e[e.CanvasEventHandlersTimeoutDurationMs=1]="CanvasEventHandlersTimeoutDurationMs",e[e.CanvasEventHandlersLogTraceCooldownMs=2]="CanvasEventHandlersLogTraceCooldownMs",e[e.PassiveTelemetryManagerExecutionDurationMs=3]="PassiveTelemetryManagerExecutionDurationMs",e[e.PassiveTelemetryManagerMaxUserInactiveTimeMs=4]="PassiveTelemetryManagerMaxUserInactiveTimeMs",e[e.PassiveTelemetryManagerMinLogThrottleTimeMs=5]="PassiveTelemetryManagerMinLogThrottleTimeMs",e[e.FontLoadRetryBaseIntervalMs=6]="FontLoadRetryBaseIntervalMs",e[e.FontLoadRetryMaxIntervalMs=7]="FontLoadRetryMaxIntervalMs",e[e.FontLoadRetries=8]="FontLoadRetries",e[e.TextWidthTolLimitForAutofit=9]="TextWidthTolLimitForAutofit",e[e.TextWidthTolLowerLimitForSpillCell=10]="TextWidthTolLowerLimitForSpillCell",e[e.TextWidthTolUpperLimitForSpillCell=11]="TextWidthTolUpperLimitForSpillCell",e[e.TextWidthCacheSizeLimit=12]="TextWidthCacheSizeLimit"}(Ce||(Ce={})),function(e){e[e.Column=0]="Column",e[e.Row=1]="Row",e[e.Table=2]="Table"}(me||(me={})),function(e){e[e.Unknown=0]="Unknown",e[e.Static=1]="Static",e[e.Flat=2]="Flat",e[e.Hierarchical=3]="Hierarchical",e[e.Custom=4]="Custom",e[e.Embedded=5]="Embedded"}(pe||(pe={})),function(e){e[e.TTVRHappenedForApp=0]="TTVRHappenedForApp",e[e.FirstFontLoadCompleted=1]="FirstFontLoadCompleted",e[e.ModelFonts=2]="ModelFonts",e[e.LoadedKnownFonts=3]="LoadedKnownFonts",e[e.FontsToLoad=4]="FontsToLoad",e[e.FontSourceToDownload=5]="FontSourceToDownload",e[e.FontsSourceUrlAdded=6]="FontsSourceUrlAdded",e[e.LocallyAvailableFonts=7]="LocallyAvailableFonts",e[e.TriggerFontLoading=8]="TriggerFontLoading",e[e.FontLoadStatusPending=9]="FontLoadStatusPending",e[e.FontLoadStatusLoaded=10]="FontLoadStatusLoaded",e[e.FontLoadStatusFailed=11]="FontLoadStatusFailed"}(ye||(ye={}));var Se=r(465);const Re="#E0E0E0",we="#A0D8B9",be="#525252",Ie="#BDBDBD",ve="#BDBDBD",Fe="#BDBDBD",Te="#969696",De="#FFFFFF",xe="#666666",Ae="#FFFFFF",Be="#B3B3B3",He="#FFFFFF",Me="#9e9e9e",Pe=.4,Oe=1,ke=9,Ee=-1,Le=1,Ne=2,ze=2,Ge="#ffffff",We="#000000",Ve="#66706F",_e={text:"",width:0,underlineWidth:0},Ue={Text:"",Fonts:[],TextRuns:[]},je={tokens:[{text:"",width:0,start:0,containsThaiCharacters:!1}],containsThaiCharacters:!1},qe="",$e=" ",Xe="　",Ye="\n",Ke="\r\n",Je=1,Ze=2,Qe=[],et=[1,1],tt=[2,2],nt=[6,2],ot=[9,3,3,3],rt=[9,3,3,3,3,3],it=[9,3],lt=1,at={Red:255,Green:0,Blue:0},st="#000000",dt={Borders:[{BorderLineStyle:Se.BorderLineType.Dashed,BorderPosition:Se.BorderPositionType.Top,Color:at,Weight:2},{BorderLineStyle:Se.BorderLineType.Dashed,BorderPosition:Se.BorderPositionType.Bottom,Color:at,Weight:2},{BorderLineStyle:Se.BorderLineType.Dashed,BorderPosition:Se.BorderPositionType.Left,Color:at,Weight:2},{BorderLineStyle:Se.BorderLineType.Dashed,BorderPosition:Se.BorderPositionType.Right,Color:at,Weight:2}],ID:Se.UniqueStyleID.FormulaError,RefCount:0},ct=3584,ut=3711,ht=-90,gt=90,ft=4,Ct="left",mt="right",pt=Math.PI/2,yt=2,St=3.14,Rt=28,wt=30,bt=.5,It="XLYellow",vt=.1,Ft=11,Tt=17,Dt=2,xt=20,At=40;function Bt(e){return null==e}const Ht="alphabetic",Mt=1,Pt="calibri",Ot=2,kt=1.33333333333333;function Et(e){if((0,Se.verifyArgumentNotNull)(e.Text,"cell.Text","updateNumFmt"),(0,Se.verifyArgumentNotNull)(e.NumFmt,"cell.NumFmt","updateNumFmt"),!Bt(e.NumFmt.End)&&!Bt(e.NumFmt.Separator)){var t,n,o,r;const i=function(e,t){let n=0;for(let o=0;o<e.length&&e[o]===t;o++)n++;return n}(e.NumFmt.End,e.NumFmt.Separator),l=function(e,t){let n=0;for(let o=e.length-1;o>0&&e[o]===t;o++)n++;return n}(e.NumFmt.End,e.NumFmt.Separator),a=function(e,t,n){const o=e.length-t,r=e.substring(0,o),i=r.lastIndexOf(n);return-1===i?r:r.substr(i+1)}(e.Text,l,e.NumFmt.Separator);e.NumFmt.End=function(e,t,n,o){return t.repeat(n)+e+t.repeat(o)}(a,e.NumFmt.Separator,i,l),(null==e||null===(n=e.Text)||void 0===n?void 0:n.endsWith((null===(t=e.NumFmt)||void 0===t?void 0:t.Separator)+e.NumFmt.End))&&(null==e||null===(r=e.Text)||void 0===r?void 0:r.startsWith((null===(o=e.NumFmt)||void 0===o?void 0:o.Start)||""))||(e.NumFmt=void 0)}}function Lt(e){var t;return!0===(null===(t=e.CachedStyle)||void 0===t?void 0:t.VerticalText)&&!e.DisplayFormula&&!e.PreviewText}function Nt(e){if(Lt(e))switch(e.CachedStyle.VerticalAlignment){case Se.VerticalAlignment.Justify:case Se.VerticalAlignment.Distributed:return!0}return!1}function zt(e){var t;if(Lt(e))switch(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment){case Se.HorizontalAlignment.Justify:case Se.HorizontalAlignment.JustifyDistributed:case Se.HorizontalAlignment.Distributed:return!0}return!1}var Gt,Wt;!function(e){e[e.Initialized=0]="Initialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.LoadFailed=3]="LoadFailed"}(Gt||(Gt={})),function(e){e[e.Sparkline=0]="Sparkline",e[e.InCellImage=1]="InCellImage"}(Wt||(Wt={}));const Vt={onImageLoadSuccessCallback:void 0,onImageLoadFailureCallback:void 0},_t="STATIC",Ut={};function jt(e,t){return qt($t(e),t,void 0,void 0)}function qt(e,t,n,o){let r=Jt(e);if(r||(r={blockIdentifiers:[t],status:Gt.Initialized,version:n,url:o},Zt(e,r),o))switch(r.status){case Gt.Loaded:return r.image;case Gt.LoadFailed:return;case Gt.Loading:return void Yt(t,r);case Gt.Initialized:return Yt(t,r),void(r.url&&Kt(r));default:throw Error(`getOrLoadImageByKey: unexpected image statue: ${r.status}`)}}function $t(e){return _t+e}function Xt(e,t){return e+t}function Yt(e,t){-1===t.blockIdentifiers.indexOf(e)&&t.blockIdentifiers.push(e)}function Kt(e){if(!e.url)throw Error("image url is not set, unexpected call");const t=new Image;t.onload=function(){e.status=Gt.Loaded,(0,Se.verifyArgumentNotNull)(Vt.onImageLoadSuccessCallback,"onImageLoadSuccessCallback","imageLoader::onload"),Vt.onImageLoadSuccessCallback(e.blockIdentifiers),e.blockIdentifiers=[]},t.onerror=function(){e.status=Gt.LoadFailed,(0,Se.verifyArgumentNotNull)(Vt.onImageLoadFailureCallback,"onImageLoadFailureCallback","imageLoader::onerror"),Vt.onImageLoadFailureCallback(`image failed to load, URL: ${e.url}, registeredModelsCount: ${e.blockIdentifiers.length}, registeredModelsCount: ${e.blockIdentifiers}`),e.blockIdentifiers=[]},t.src=e.url,e.image=t,e.status=Gt.Loading}function Jt(e){return Ut[e]}function Zt(e,t){Ut[e]=t}function Qt(e){Ut[e]=void 0}function en(e,t,n){if(null==e)throw Error(`${n}.verifyArgumentNotNull: ${t} cannot be null or undefined`)}var tn=r(181);const nn=2,on="|",rn=28;let ln,an,sn,dn,cn,un,hn,gn;function fn(e,t,n){if(null==e)throw Error(`${n}.assertArgumentNotNull: ${t} cannot be null or undefined`)}function Cn(e,t){return e-t}function mn(e,t,n,o,r){let i=t,l=t+n-1;for(;i<=l;){const t=i+(l-i>>1),n=r(e instanceof Array?e[t]:e.item(t),o);if(0===n)return t;n<0?i=t+1:l=t-1}return~i}function pn(e,t,n){en(t,"cell",n),t.CachedStyle||(0,Se.getCellStyle)(e,t),t.CachedFont||Fn(t,e),(null==t?void 0:t.TextRuns)&&t.TextRuns.forEach((t=>{t.CachedFont||(t.CachedFont=(0,Se.getFontByID)(t,e,void 0))}))}function yn(e,t){return((e.BitwiseBorderPosition||0)&1<<t)==1<<t}function Sn(e,t){const n=e.CachedBorderStyle;if(!n||!n.Borders)return!1;for(const e of n.Borders)if(e.BorderPosition===t)return!0;return!1}function Rn(e,t){throw Error(`${t}: ${e}`)}function wn(e){return e/2}function bn(e,t,n){if(en(e.Styles,"styles","helpers.initCellCachedObjects"),en(e.Fonts,"fonts","helpers.initCellCachedObjects"),t.CachedStyle=(0,Se.getCellStyleByID)(t,e),Bt(e.BorderStyles)||(t.CachedBorderStyle=(0,Se.getBorderStyleByID)(t,e)),t.CachedFont=(0,Se.getFontByID)(t.CachedStyle,e,t.StyleID||0),t.CachedDrawingLayout={UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}},t.CachedIndent=t.CachedStyle.Indentation,!Bt(t.TextRuns))for(let n=0;n<t.TextRuns.length;n++){const o=t.TextRuns[n];o.CachedFont=(0,Se.getFontByID)(o,e,void 0)}t.CachedDisplayText=void 0,t.CachedDisplayTextRuns=void 0,n&&t.Text&&(t.CachedDisplayText=kn(t,e))}function In(e,t){const n=(0,Se.getModelClientCache)(e);(0,Se.isPartialHeaderCellRenderingEnabled)()?(n.DirtyCellsMap||(n.DirtyCellsMap=new Map),n.DirtyCellsMap.set((0,Se.getCellLookupKey)(t.Row,t.Col),Se.DirtyGridCellArea.EntireCell)):(n.DirtyCellsKeys||(n.DirtyCellsKeys=[]),n.DirtyCellsKeys.push((0,Se.getCellLookupKey)(t.Row,t.Col)));const o=Tn(t,e.Cells),r=(0,Se.getAllSpanningCellsKeys)(e.Cells,t,o);if((0,Se.isPartialHeaderCellRenderingEnabled)())for(const e of r)n.DirtyCellsMap.set(e,Se.DirtyGridCellArea.EntireCell);else n.DirtyCellsKeys=n.DirtyCellsKeys.concat(r)}function vn(e,t){if(en(t,"model","getColumnWidth"),en(t.ColumnWidths,"ColumnWidths","getColumnWidth"),e>t.ColumnWidths.length-1||e<0)throw Error(`getColumnWidth: column width requested for a cell which is not in range of the model. colIndex: ${e}, columnWidths.length: ${t.ColumnWidths.length}`);return t.ColumnWidths[e]}function Fn(e,t){if(en(e,"cell","getCellFont"),en(t.Styles,"Styles","getCellFont"),en(t.Fonts,"Fonts","getCellFont"),!e.CachedFont){const n=(0,Se.getCellStyle)(t,e);e.CachedFont=(0,Se.getFontByID)(n,t,(null==e?void 0:e.StyleID)||0)}return e.CachedFont}function Tn(e,t){let n=mn(t,0,t.length,e,Se.cellsPositionComparer);return n<0&&(n=~n),n}function Dn(e,t,n){return t===Se.BorderPositionType.Bottom?yn(e,Se.BorderPositionType.Bottom)&&yn(n,Se.BorderPositionType.Top):t===Se.BorderPositionType.Top&&yn(e,Se.BorderPositionType.Top)&&yn(n,Se.BorderPositionType.Bottom)}function xn(e,t,n){return t===Se.BorderPositionType.Right?yn(e,Se.BorderPositionType.Right)&&yn(n,Se.BorderPositionType.Left):t===Se.BorderPositionType.Left&&yn(e,Se.BorderPositionType.Left)&&yn(n,Se.BorderPositionType.Right)}function An(e,t,n){const o=t[e].StartIndex;let r=n.length;return e<t.length-1&&(r=t[e+1].StartIndex),n.substring(o,r)}function Bn(e,t){e.CachedDisplayText=t,e.CachedDrawingLayout.CellTextLayout.Width=void 0}function Hn(e,t){return Bt(e)?Mn(t)?t:Ge:Vn(e.BackgroundColor)}function Mn(e){return!Bt(e)}function Pn(e){return!Bt(e.highContrastScheme)}function On(e,t,n){var o;if(t.TextRuns&&n.Fonts)return{Text:e,TextRuns:null!==(o=t.CachedDisplayTextRuns)&&void 0!==o?o:t.TextRuns,Fonts:n.Fonts}}function kn(e,t){if(Po(e.PreviewText))return e.PreviewText;if(e.DisplayFormula)return e.FormulaInfo.Formula;if(Lt(e)&&e.Text&&e.OriginalText&&(n=e.Text,/^(#)+$/.test(n)))return e.OriginalText;var n;if(!Xn(e))return e.Text;if(Bt(e.CachedDisplayText))if(!Bt(e.Text)&&Bt(e.WrapText)&&e.Text.indexOf(Ye)>=0){const n=On(e.Text,e,t);!Bt(n)&&n.Text.indexOf(Ye)>=0&&(e.CachedDisplayTextRuns=function(e){const t=e.TextRuns,n=[],o=e.Text;Nn(t,o);let r=0;for(let i=0;i<t.length;i++){const l=t[i];en(l.EndIndex,"EndIndex","getAdjustedTextRuns"),en(l.StartIndex,"StartIndex ","getAdjustedTextRuns");let a=l.StartIndex,s=l.EndIndex;r!==a&&(s+=r-a,a=r);for(let t=l.StartIndex;t<l.EndIndex;t++)o.charAt(t)!==Ye||e.WrapText||s--;n.push({StartIndex:a,EndIndex:s,FontID:l.FontID,GlobalFontID:l.GlobalFontID,CachedFont:l.CachedFont}),r=s}return n}(e)),e.CachedDisplayText=function(e){return-1!==e.indexOf(Ke)||-1!==e.indexOf(Ye)?e.replace(/\r\n|\n/g,""):e}(e.Text)}else e.CachedDisplayText=e.Text;return e.CachedDisplayText}function En(e,t,n){t.Text=n,Xn(t)&&($n(t)&&(t.CachedDisplayText=void 0),t.CachedDisplayText=kn(t,e)),(0,Se.isAccAndCustomNumFmtApplicable)(t)?Et(t):t.NumFmt=void 0}function Ln(e,t){var n;return!(!t||!(null===(n=e.FormulaInfo)||void 0===n?void 0:n.Formula))&&(e.FormulaInfo.FormulaType===Se.CellFormulaType.Formula||e.FormulaInfo.FormulaType===Se.CellFormulaType.ArrayFormula&&e.FormulaInfo.IsArrayRoot)}function Nn(e,t){var n;if(void 0===(null===(n=e[0])||void 0===n?void 0:n.EndIndex))for(let n=0;n<e.length;n++){const o=e[n],r=n<e.length-1?e[n+1].StartIndex:t.length;o.EndIndex=r}}function zn(e){return void 0!==e}function Gn(e,t){return en(e,"model","getModelRowIndex"),en(e.RowNumbers,"RowNumbers","getModelRowIndex"),mn(e.RowNumbers,0,e.RowNumbers.length,t,Cn)}function Wn(e,t){return en(e,"model","getModelColumnIndex"),en(e.ColumnNumbers,"ColumnNumbers","getModelColumnIndex"),mn(e.ColumnNumbers,0,e.ColumnNumbers.length,t,Cn)}function Vn(e){let t=Number(e).toString(16);for(;t.length<6;)t="0"+t;return"#"+t}function _n(e,t,n,o){return!(t<n||o<e)}function Un(e,t){const n=_n(e.FirstColumn,e.LastColumn,t.FirstColumn,t.LastColumn),o=_n(e.FirstRow,e.LastRow,t.FirstRow,t.LastRow);return n&&o}function jn(e,t){return Ko()?Jo(t.x,e.x,e.x+e.width)&&Jo(t.y,e.y,e.y+e.height):_n(t.x,t.x,e.x,e.x+e.width)&&_n(t.y,t.y,e.y,e.y+e.height)}function qn(e){var t,n,o,r;return null!==(r=null===(n=e.ClientOnlyCache)||void 0===n||null===(t=n.PreviewCellsSettings)||void 0===t?void 0:t.PreviewCellsRange)&&void 0!==r?r:null===(o=e.ClientOnlyCache)||void 0===o?void 0:o.PreviewCellsRange}function $n(e){return!Bt(e.Text)&&Bt(e.WrapText)&&e.Text.indexOf(Ye)>=0&&e.Text!==e.CachedDisplayText}function Xn(e){var t;const n=e.ValueType===Se.CellValueType.Number,o=(0,Se.shouldOverrideText)(e),r=$n(e),i=(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)===Se.HorizontalAlignment.Fill;return n||r||i||o}function Yn(e,t){switch(t){case Wt.Sparkline:return e.Sparkline;case Wt.InCellImage:return e.InCellImage;default:throw Error(`getDynamicImageInformationFromCell: unsupported image type = ${t}`)}}function Kn(){return void 0!==ln?ln:(ln=(0,Se.isChangeGateEnabled)(Se.ChangeGate.ModernFontRendering)?(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.ModernFontRendering"):(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.ModernFontPicker"),!!ln)}function Jn(){var e,t;if(void 0!==un)return un;const n=!!(null===(e=performance)||void 0===e?void 0:e.mark)&&!!(null===(t=performance)||void 0===t?void 0:t.measure);return un=n&&(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.LogFontPhaseTelemetry",!1),!!un}function Zn(){return void 0!==an||(an=Kn()&&(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.FontLoadRefactorV1",!1)),!!an}function Qn(){return"undefined"!=typeof OffscreenCanvas}function eo(){return void 0===dn&&(dn=(0,Se.isChangeGateEnabled)(Se.ChangeGate.PLTRegressionInMFPFix)&&Kn()),dn}function to(e,t,n){const o=t.Merge;if(o.SpansBlocks){o.HeightAdjustedForDrawing=Math.round(o.Height*n),o.WidthAdjustedForDrawing=Math.round(o.Width*n),o.OriginDeltaXAdjustedForDrawing=Math.round(o.OriginDeltaX*n),o.OriginDeltaYAdjustedForDrawing=Math.round(o.OriginDeltaY*n);const r=e.RowOffsets[t.Row]-o.OriginDeltaY;o.SpansNextBlockVertically=r+o.Height>e.BlockHeight;const i=e.ColumnOffsets[t.Col]-o.OriginDeltaX;o.SpansNextBlockHorizontally=i+o.Width>e.BlockWidth}}function no(e){const{startOffsetX:t,startOffsetY:n}=e;return(t<<10)+n}function oo(e,t,n,o){const r=ro(t,n,o);if(e.Fonts){const n=(0,Se.getFontByID)(t,e,void 0);n.RefCount=ao(n.RefCount||0)}return r}function ro(e,t,n){return{BackgroundColor:e.BackgroundColor,HorizontalAlignment:e.HorizontalAlignment||Se.HorizontalAlignment.Automatic,ID:t||0,NamedStyleId:e.NamedStyleId||0,RefCount:n||0,VerticalAlignment:e.VerticalAlignment,Indentation:e.Indentation||0,IsUnlocked:e.IsUnlocked,IsHidden:e.IsHidden,ReadingOrder:e.ReadingOrder||Se.ReadingOrderType.Context,FontID:e.FontID||0,GlobalFontID:e.GlobalFontID,ShrinkToFit:e.ShrinkToFit,Gradient:e.Gradient,Orientation:e.Orientation||0,VerticalText:e.VerticalText||!1,PatternStyle:e.PatternStyle||0,PatternColor:e.PatternColor}}function io(e,t,n){const o=[];for(let t=0;t<e.Borders.length;t++){const n=e.Borders[t],r={BorderLineStyle:n.BorderLineStyle,BorderPosition:n.BorderPosition,Weight:n.Weight,Color:{Red:n.Color.Red,Blue:n.Color.Blue,Green:n.Color.Green}};o.push(r)}return{Borders:o,ID:t||0,RefCount:n||0}}function lo(e,t,n){return{Bold:e.Bold,Color:e.Color,FontName:e.FontName,FontScheme:e.FontScheme,ID:t||0,Italic:e.Italic,RefCount:n||0,Size:e.Size,StrikeThrough:e.StrikeThrough,Underline:e.Underline,VerticalAlign:e.VerticalAlign,GlobalId:e.GlobalId}}function ao(e){return Bt(e)?1:e+1}function so(e,t){return e.IsRtl?t.endOffsetX-e.BlockWidth:-1*t.startOffsetX}function co(e,t,n){en(e,"renderingRegion","validateRenderingRegion");const o=t.RowOffsets[e.startRow],r=t.RowOffsets[e.endRow]+t.RowHeights[e.endRow],i=t.ColumnOffsets[e.startColumn],l=t.ColumnOffsets[e.endColumn]+t.ColumnWidths[e.endColumn];if(o>e.startOffsetY||r<e.endOffsetY)throw Error(`validateRenderingRegion: Invalid renderingRegion. startOffsetY= ${e.startOffsetY}, endOffsetY = ${e.endOffsetY}, firstRowStartOffset= ${o}, lastRowEndOffset= ${r}, modelHeight= ${t.BlockHeight}, rowHeights= ${t.RowHeights}, rowOffsets= ${t.RowOffsets}, startRow = ${e.startRow}, endRow = ${e.endRow}, isRTL = ${t.IsRtl}, DPR: ${n.devicePixelRatio}, zoom: ${n.zoom}`);if(i>e.startOffsetX||l<e.endOffsetX)throw Error(`validateRenderingRegion: Invalid renderingRegion. startOffsetX= ${e.startOffsetX}, endOffsetX = ${e.endOffsetX}, firstColumnStartOffset= ${i}, lastColumnEndOffset= ${l}, modelWidth= ${t.BlockWidth}, colWidths= ${t.ColumnWidths}, colOffsets= ${t.ColumnOffsets}, startColumn = ${e.startColumn}, endColumn = ${e.endColumn}, isRTL = ${t.IsRtl}, DPR: ${n.devicePixelRatio}, zoom: ${n.zoom}`)}function uo(e,t){if(0===e.startOffsetX&&0===e.startOffsetY&&e.endOffsetX===t.BlockWidth&&e.endOffsetY===t.BlockHeight)return!0;if((0,Se.isPartialHeaderCellRenderingEnabled)())for(const[n]of t.ClientOnlyCache.DirtyCellsMap){const{row:t,column:o}=(0,Se.getRowColFromCellKey)(n),r=_n(o,o,e.startColumn,e.endColumn),i=_n(t,t,e.startRow,e.endRow);if(r&&i)return!0}else{const n=t.ClientOnlyCache.DirtyCellsKeys;for(let t=0;t<n.length;t++){const o=n[t],{row:r,column:i}=(0,Se.getRowColFromCellKey)(o),l=_n(i,i,e.startColumn,e.endColumn),a=_n(r,r,e.startRow,e.endRow);if(l&&a)return!0}}return!1}function ho(e,t){if(e)for(const n in e){const o=e[n];for(let e=0;e<o.length;e++)t(o[e])}}function go(e,t,n){if(!(t>=0&&t<=e.length))throw Error(`addNewValueToArray: Index ${t} is out of range`);e.splice(t,0,n)}function fo(e,t){if(!(t>=0&&t<e.length))throw Error(`addNewValueToArray: Index ${t} is out of range`);e.splice(t,1)}function Co(e,t){const n=[];for(let o=0;o<e.length;o++){const r=e[o];n[o]=po(r,t[r.FontID||0])}return n}function mo(e,t){for(let n=0;n<e.length;n++)e[n].GlobalFontID=(0,Se.getGlobalStyleId)(e[n].FontID,t)}function po(e,t){return{FontID:null!=t?t:e.FontID||0,GlobalFontID:e.GlobalFontID,StartIndex:e.StartIndex,CachedFont:e.CachedFont}}function yo(e,t){So(e,t,1,t.Spill.SpanToEnd),So(e,t,-1,t.Spill.SpanToStart)}function So(e,t,n,o){const r=1===n?o+1:o;for(let o=1===n?1:0;o<r;o++){const r=(0,Se.getCell)(t.Row,t.Col+n*o,e);if(r){const t=(0,Se.getCellBorderStyle)(e,r);t&&t.Borders&&t.Borders.length>0&&To(r,t,e)}}}function Ro(e,t,n){if((0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.MoveSpillCellBeforeRendering,t))Fo(e,n,t);else{en(e,"cell","setBorders"),en(n,"BorderStyle","setBorders");const o=(0,Se.getCellBorderStyle)(t,e),r=vo(t)+1;n.ID=r,o.RefCount=Math.max(0,(o.RefCount||0)-1),t.BorderStyles.splice(r,0,n),e.BorderStyleID=r,e.CachedBorderStyle=n}}function wo(e,t){if(en(e,"cell","attachCellToModel"),en(t.Cells,"this.model.Cells","attachCellToModel"),(0,Se.getCell)(e.Row,e.Col,t))return;const n=(0,Se.getModelClientCache)(t),o=Tn(e,t.Cells);t.Cells.splice(o,0,e),n.CellLookup[(0,Se.getCellLookupKey)(e.Row,e.Col)]=e;const r=(0,Se.getCellStyle)(t,e);en(r,"style","attachCellToModel"),r.RefCount=ao(r.RefCount||0);const i=(0,Se.getCellBorderStyle)(t,e);en(i,"borderStyle","attachCellToModel"),i.RefCount=ao(i.RefCount||0),e.CachedBorderStyle=i}function bo(e,t,n,o){const r=(0,Se.getCellBorderStyle)(t,e);if(!r)return;let i=!1;for(let e=0;e<r.Borders.length;e++)if(r.Borders[e].BorderPosition===o){i=!0;break}i||(Wo(e,t),(0,Se.getCellBorderStyle)(t,e).Borders.push(n),_o(e,t))}function Io(e,t,n){en(e,"cell","removeBorderFromCell");const o=(0,Se.getCellBorderStyle)(t,e);if(!o||!o.Borders||0===o.Borders.length)return;let r=!1;for(let e=0;e<o.Borders.length;e++){const t=o.Borders[e];t&&t.BorderPosition===n&&(r=!0)}if(!r)return;Wo(e,t);const i=(0,Se.getCellBorderStyle)(t,e);for(let e=0;e<i.Borders.length;e++){const t=i.Borders[e];if(t&&t.BorderPosition===n){i.Borders.splice(e,1);break}}_o(e,t)}function vo(e){return e.BorderStyles.length-1}function Fo(e,t,n){en(e,"cell","setBorders"),en(t,"BorderStyle","setBorders");const o=(0,Se.getCellBorderStyle)(n,e),r=vo(n)+1;t.ID=r,o.RefCount=Math.max(0,(o.RefCount||0)-1),n.BorderStyles.splice(r,0,t),e.BorderStyleID=r,e.CachedBorderStyle=t}function To(e,t,n){const o=io(t,t.ID||0,1);if(o&&o.Borders){const t=o.Borders.length;for(let r=0;r<t;r++){const t=o.Borders[r];t&&t.BorderPosition===Se.BorderPositionType.Left&&(o.Borders.splice(r),(0,Se.isGlobalBorderStylesEnabled)(n)?Uo(e,n,o,!0):Fo(e,o,n))}}}function Do(e,t){const n=(0,Se.getReferencedObjectById)(t.FontID||0,e.Fonts);return""+Ao(t.IsUnlocked)+on+Ao(t.IsHidden)+on+Ao(t.VerticalText)+on+Ao(t.IsPattern)+on+Ao(t.ShrinkToFit)+on+Bo(t.HorizontalAlignment)+on+Bo(t.VerticalAlignment)+on+Bo(t.ReadingOrder)+on+Bo(t.NamedStyleId||0)+on+Bo(t.Orientation||0)+on+Bo(t.Indentation||0)+on+Bo(t.BackgroundColor)+on+function(e){var t;if(!e)return"0";let n="";for(let o=0;o<(null===(t=e.Stops)||void 0===t?void 0:t.length);o++){const t=e.Stops[o];t&&(n+=xo(t)+on)}return""+Bo(e.ShadingStyle)+on+n}(t.Gradient)+on+function(e){return""+Ao(e.Bold)+on+Ao(e.Italic)+on+Ao(e.StrikeThrough)+on+Bo(e.FontName)+on+Bo(e.Size)+on+Bo(e.Color)+on+Bo(e.Underline)+on+Bo(e.VerticalAlign)+on+Bo(e.FontScheme)}(n)+on}function xo(e){return""+Bo(e.Color)+on+Bo(e.Position)}function Ao(e){return e?1:0}function Bo(e){return e||0}function Ho(){var e,t;return(null===(t=window)||void 0===t||null===(e=t.navigator)||void 0===e?void 0:e.userAgent.indexOf("Macintosh"))>=0}function Mo(){if(window&&window.navigator){const e=window.navigator.userAgent.toLowerCase();return e.indexOf("safari")>=0&&e.indexOf("chrome")<0&&e.indexOf("edge")<0}return!1}function Po(e){return null!=e}function Oo(e){return e.Styles.length-nn-1}function ko(e){for(let t=0;t<e.length;t++){const n=e.charCodeAt(t);if(n>=ct&&n<=ut)return!0}return!1}function Eo(e,t){return t>rn||0!=(e&1<<t)}function Lo(e,t){const n=Oo(e)+1,o=oo(e,(0,Se.getCellStyleByID)(t,e),n,1);return o.HorizontalAlignment=Se.HorizontalAlignment.Center,o.VerticalAlignment=Se.VerticalAlignment.Center,e.Styles.splice(n,0,o),{refErrorStyle:o,refErrorGlobalId:(0,Se.getGlobalCellStylesMap)().getOrCreateID(o)}}function No(e,t,n){e.HorizontalAlignmentSet=!1,e.CachedStyle=t,e.GlobalCellStyleID=n,e.StyleID=t.ID}function zo(e,t,n){let o=!1;if(e.Merge){const r=e.Row+e.Merge.Rows,i=t.RowNumbers[r],l=e.Col+e.Merge.Columns;o=n(i,t.ColumnNumbers[l])}return o}function Go(e){let t=0;for(let n=0;n<e.RowHeights.length;n++)e.RowOffsets[n]=t,t+=e.RowHeights[n];e.BlockHeight=t}function Wo(e,t){const n=(0,Se.getCellBorderStyle)(t,e);if((0,Se.isGlobalBorderStylesEnabled)(t))Vo(e,t,io(n,0,1),!1);else{if((n.ID||0)!==Se.UniqueStyleID.DefaultBorder&&(n.RefCount||0)<=1)return;Ro(e,t,io(n,0,1))}}function Vo(e,t,n,o){if((0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.MoveSpillCellBeforeRendering,t))Uo(e,t,n,o);else{en(e,"cell","setBordersNew"),en(n,"BorderStyle","setBordersNew");const r=(0,Se.getCellBorderStyle)(t,e),i=vo(t)+1;n.ID=i,r.RefCount=Math.max(0,(r.RefCount||0)-1),t.BorderStyles.splice(i,0,n),e.BorderStyleID=i,o?(e.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(n),e.CachedBorderStyle=(0,Se.getBorderStyleByID)(e,t)):e.CachedBorderStyle=n}}function _o(e,t){const n=(0,Se.getCellBorderStyle)(t,e);e.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(n),e.CachedBorderStyle=(0,Se.getBorderStyleByID)(e,t)}function Uo(e,t,n,o){en(e,"cell","setBorders"),en(n,"BorderStyle","setBorders");const r=(0,Se.getCellBorderStyle)(t,e),i=vo(t)+1;n.ID=i,r.RefCount=Math.max(0,(r.RefCount||0)-1),t.BorderStyles.splice(i,0,n),e.BorderStyleID=i,o?(e.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(n),e.CachedBorderStyle=(0,Se.getBorderStyleByID)(e,t)):e.CachedBorderStyle=n}function jo(e,t,n){return t===Se.BorderPositionType.Right?(0,Se.getCell)(e.Row,e.Col+1,n):t===Se.BorderPositionType.Bottom?(0,Se.getCell)(e.Row+1,e.Col,n):t===Se.BorderPositionType.Left?(0,Se.getCell)(e.Row,e.Col-1,n):t===Se.BorderPositionType.Top?(0,Se.getCell)(e.Row-1,e.Col,n):null}function qo(e){return e===Se.BorderPositionType.Right?Se.BorderPositionType.Left:e===Se.BorderPositionType.Bottom?Se.BorderPositionType.Top:e===Se.BorderPositionType.Left?Se.BorderPositionType.Right:e===Se.BorderPositionType.Top?Se.BorderPositionType.Bottom:null}function $o(e){return e===Se.BorderPositionType.Top||e===Se.BorderPositionType.Bottom}function Xo(e){return e===Se.BorderPositionType.Left||e===Se.BorderPositionType.Right}function Yo(){return null!=hn||(hn=(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.OptimizeUnnecessaryHeaderCanvasCalls",!1)),hn}function Ko(){return void 0===gn&&(gn=(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.HitRegionsEndExclusive",!1)),gn}function Jo(e,t,n){return!(e<t||n<=e)}const Zo={},Qo={},er={},tr=1.1,nr=2e3;function or(e){return Bt(Zo[e])?(Zo[e]=Math.max(Math.round(e),1),Zo[e]):Zo[e]}function rr(e,t){if(e<0||e>t.length-1)throw`getColWidthFromOffsets:: invalid colIndex ${e}`;return t[e+1]-t[e]}function ir(e,t){if(e<0||e>t.length-1)throw`getRowHeightFromOffsets:: invalid colIndex ${e}`;return t[e+1]-t[e]}function lr(e,t){return Math.round(e*t)}function ar(e,t,n,o,r){let i=0;n&&(i=n+Mt);const l=t+i+o+r;return Math.max(0,e-Le-l)}function sr(e){return e-Le}function dr(e,t){t&&(e.save(),e.strokeStyle="transparent",function(e,t,n,o,r){e.beginPath(),e.rect(t,n,o,r),e.stroke(),e.clip()}(e,t.x,t.y,t.width,t.height))}function cr(e,t){t&&e.restore()}function ur(e,t,n,o,r){e.moveTo(t,n),e.lineTo(o,r)}function hr(e){if(""===e)return{Red:0,Green:0,Blue:0};const t="#"===e[0]?e.substr(1):e,n=parseInt(t,16);return{Red:n>>16&255,Green:n>>8&255,Blue:255&n}}function gr(e,t){let n=e.Row,o=e.Row,r=e.Col,i=e.Col;e.Merge?(o+=e.Merge.Rows,i+=e.Merge.Columns,e.Merge.SpansBlocks&&(e.Merge.OriginDeltaX&&(r=0),e.Merge.OriginDeltaY&&(n=0))):e.Spill&&(r-=e.Spill.SpanToStart,i+=e.Spill.SpanToEnd);const l=_n(r,i,t.startColumn,t.endColumn),a=_n(n,o,t.startRow,t.endRow);return l&&a}function fr(e,t){return e||!t}function Cr(e,t){const n=t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,o=n[n.length-1];return t.IsRtl?o-n[e+1]:n[e]}function mr(e){const t=e.charCodeAt(0);return t>=1424&&t<=1535||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=64336&&t<=65023||t>=65136&&t<=65279||t>=1984&&t<=1792||t>=1792&&t<=1871||t>=1920&&t<=1983||t>=11568&&t<=11647}function pr(e,t){const n=e.CachedStyle.BackgroundColor;return Bt(t.HeaderPartialSelectionFontColor)||n!==Se.PartialRowColSelectionBackgroundColor&&n!==Se.PartialRowColSelectionAndHoverBackgroundColor?Bt(e.Hyperlink)?(r=t.TextColor,er[r]||(er[r]=Vn(r)),er[r]):(o=t.LinkColor,Qo[o]||(Qo[o]=Vn(o)),Qo[o]):t.HeaderPartialSelectionFontColor;var o,r}function yr(e,t){const n=document.createElement("div");return n.style.visibility="hidden",n.style.direction=e.BaseDir,n.style.position="absolute",n.style.width=Math.max(nr,t*tr)+"px",n}function Sr(e,t,n){const o=sr(e)-t-n;return Math.max(0,o)}function Rr(e,t){const n=e.RowHeights,o=e.ColumnWidths,r=e.RowOffsets,i=e.ColumnOffsets;(0,Se.verifyArgumentNotNull)(n,"rowHeights","initializeOffsetsForDrawing"),(0,Se.verifyArgumentNotNull)(o,"colWidths","initializeOffsetsForDrawing"),(0,Se.verifyArgumentNotNull)(r,"rowOffsets","initializeOffsetsForDrawing"),(0,Se.verifyArgumentNotNull)(i,"colOffsets","initializeOffsetsForDrawing");const l=(0,Se.getModelClientCache)(e);l.RowOffsetsAdjustedForDrawing=[];for(let e=0;e<r.length;e++){const n=r[e];l.RowOffsetsAdjustedForDrawing.push(Math.round(n*t))}l.ColOffsetsAdjustedForDrawing=[];for(let e=0;e<i.length;e++){const n=i[e];l.ColOffsetsAdjustedForDrawing.push(Math.round(n*t))}l.RowOffsetsAdjustedForDrawing.push(lr(e.BlockHeight,t)),l.ColOffsetsAdjustedForDrawing.push(lr(e.BlockWidth,t))}function wr(e){return!!e.ClientOnlyCache&&!!e.ClientOnlyCache.RowOffsetsAdjustedForDrawing&&!!e.ClientOnlyCache.ColOffsetsAdjustedForDrawing}function br(e,t){return t?2===e.ColumnOffsets.length:2===e.RowOffsets.length}function Ir(e,t){var n;return t.isFormulaView&&(null===(n=e.FormulaInfo)||void 0===n?void 0:n.FormulaType)===Se.CellFormulaType.ArrayFormula&&!e.FormulaInfo.IsArrayRoot}var vr=r(586),Fr=r(356);function Tr(e){return e?Se.PartiallySelectionHeadersStylesSet.has(e.StyleID||0):(vr.Hv.sendTraceTag(509097937,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Error,"isCellPartiallySelected: cell is not defined"),!1)}function Dr(e){return e?Se.WholeSelectionHeadersStylesSet.has(e.StyleID||0):(vr.Hv.sendTraceTag(508059907,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Error,"isCellWhollySelected: cell is not defined"),!1)}function xr(e,t,n){return n?e.RowNumbers[t]:e.ColumnNumbers[t]}function Ar(e,t){return t?Hr(Ft,e):0}function Br(e,t){return t?Ar(e,t)+1:0}function Hr(e,t){return Math.round(e*t)}const Mr=1,Pr=wn(Mr);function Or(e,t){(0,Se.verifyArgumentNotNull)(e,"ctx","drawRectangle"),(0,Se.verifyArgumentNotNull)(t,"drawingContext","drawRectangle");const{innerColor:n,outerColor:o,left:r,bottom:i,height:l,width:a}=t;o&&function(e,t,n,o,r,i){e.strokeStyle=i,e.beginPath(),e.rect(t,n,o,r),e.stroke()}(e,r+Pr,i-l-Pr,a,l,o),n&&function(e,t,n,o,r,i){e.fillStyle=i,e.beginPath(),e.fillRect(t,n,o,r),e.fill()}(e,r+Mr,i-l,a-Mr,l-Mr,n)}function kr(e,t){(0,Se.verifyArgumentNotNull)(e,"ctx","drawRoundRectangle"),(0,Se.verifyArgumentNotNull)(t,"drawingContext","drawRoundRectangle");const{innerColor:n,outerColor:o,left:r,bottom:i,height:l,width:a,radius:s}=t;if(0===s.length||s.length>4)throw new Error(`Invalid radius array length: ${s.length}`);let d=[];switch(s.length){case 1:d=[s[0],s[0],s[0],s[0]];break;case 2:d=[s[0],s[1],s[0],s[1]];break;case 3:d=[s[0],s[1],s[2],s[1]];break;case 4:d=s}const c=r+Pr,u=i-l-Pr,h=c+a,g=u+l;e.beginPath(),e.roundRect?e.roundRect(c,u,a,l,d):(e.moveTo(c+d[0],u),e.lineTo(h-d[1],u),e.quadraticCurveTo(h,u,h,u+d[1]),e.lineTo(h,g-d[2]),e.quadraticCurveTo(h,g,h-d[2],g),e.lineTo(c+d[3],g),e.quadraticCurveTo(c,g,c,g-d[3]),e.lineTo(c,u+d[0]),e.quadraticCurveTo(c,u,c+d[0],u)),e.closePath(),n&&(e.fillStyle=n,e.fill()),o&&(e.strokeStyle=o,e.stroke())}function Er(e,t){if(!(e.RowOffsets&&e.ColumnOffsets&&e.RowHeights&&e.ColumnWidths))throw`drawGridLines:: one or more elements is null: RowOffset: ${!e.RowOffsets}, ColumnOffsets: ${!e.ColumnOffsets}, RowHeights: ${!e.RowHeights}, ColumnWidths: ${!e.ColumnWidths}`;if(e.RowOffsets.length!==e.RowHeights.length)throw"drawGridLines:: RowOffsets.length !== RowHeights.length";if(e.ColumnOffsets.length!==e.ColumnWidths.length)throw"drawGridLines:: ColumnOffsets.length !== ColumnWidths.length";return!(!e.ShowGridLines||t.scaleFactor<Pe||!fr(Pn(t),Mn(e.BackgroundColor)))}function Lr(e,t,n){let o=Math.round(e*t)-Le/2;if(n&&Mo()){const e=window?window.devicePixelRatio:-1;2===e&&t===e/2&&(o-=1)}return o}function Nr(e,t,n,o){const r=e+t-n;return Math.min(r,o)}function zr(e,t,n){const o=Math.max(e-t,0);return Math.min(o,n)}function Gr(e,t,n,o,r,i){const l=i.startRow,a=i.endRow;for(let i=l;i<=a;i++){const l=Nr(t[i],ir(i,t),o,r);ur(e,0,l,n,l)}}function Wr(e,t,n,o,r,i){const l=i.startColumn,a=i.endColumn;for(let i=l;i<=a;i++){const l=Nr(t[i],rr(i,t),o,r);ur(e,l,0,l,n)}}function Vr(e,t,n,o){return Bt(t.highContrastScheme)?Bt(e.GridLineColor)?n&&t.viewMode===Se.ViewMode.NamedSheetView?o?Fe:be:o?ve:Re:e.GridLineColor:`${Vn(t.highContrastScheme.TextColor)}`}function _r(e){return e.viewMode===Se.ViewMode.NamedSheetView?Ie:we}function Ur(e,t,n,o,r,i,l,a,s,d){kr(e,{outerColor:s,innerColor:d,left:r[i]-l,bottom:o,width:t,height:n,radius:[a,0,0,0]})}function jr(e,t,n,o,r,i,l,a,s,d){const c=Math.max(a-l,0);kr(e,{outerColor:s,innerColor:d,left:r[i+1]-Ne-c,bottom:o,width:t,height:n,radius:[0,a,0,0]})}function qr(e,t,n,o,r,i,l,a,s,d){const c=Math.max(a-l,0);kr(e,{outerColor:s,innerColor:d,left:o,bottom:r[i]+1+c,width:t,height:n,radius:[a,0,0,0]})}function $r(e,t,n,o,r,i,l,a,s,d){kr(e,{outerColor:s,innerColor:d,left:o,bottom:r[i+1]+l-1,width:t,height:n,radius:[0,0,0,a]})}function Xr(e,t){e.lineWidth=Le,e.setLineDash(function(e){return Bt(e.GridLineColor)?Qe:et}(t))}const Yr=1,Kr=409,Jr=11,Zr="Calibri",Qr=`${Jr}pt ${Zr}`,ei="aptos narrow",ti=1.06,ni=1;let oi;const ri=["angsananew","aptosnarrow","aptosdisplay","arial","arialblack","batang","bookantiqua","browallianew","calibri","cambria","candara","century","comicsansms","consolas","constantia","corbel","cordianew","dilleniaupc","courier","couriernew","dotum","fangsong","garamond","georgia","gulim","gungsuh","kaiti","jasmineupc","malgungothic","mangal","meiryo","microsoftjhengHei","microsoftyahei","mingliu","mingliuhkscs","msgothic","msmincho","mspgothic","mspmincho","pmingliu","pmingliuextb","simhei","simsun","simsunextb","sourcesanspro","tahoma","thsarabunpsk","times","timesnewroman","trebuchetms","verdana","yugothic","yumincho","xlyellow"],ii=["aharoni","aptos","aptosmono","aptosserif","바탕","batangche","바탕","dengxian","等线","돋움","dotumche","돋움체","仿宋","굴림","궁서","楷体","맑은 고딕","メイリオ","細明體","細明體_hkscs","ms ゴシック","ms 明朝","ms pゴシック","ms p明朝","opensans","新細明體","新細明體-extb","roboto","黑体","宋体"],li=()=>(oi=null!=oi?oi:(0,Se.isChangeGateEnabled)(Se.ChangeGate.UseNewKnownFontList))?ri.concat(ii):ri,ai=new Set(li()),si=2;let di,ci,ui;function hi(e,t,n,o,r,i){en(di,"externalCallbacks","handleRibbonCommand"),di.handleRibbonCommandCallback(e,t,n,o,r,i)}function gi(e,t,n){en(di,"externalCallbacks","showFloatingCommentCallback"),di.showOrCloseFloatingCommentCallback(e,t,n)}function fi(e,t,n,o){en(di,"externalCallbacks","invokeRibbonCommandWithCellReference"),di.invokeRibbonCommandWithCellReferenceCallback(e,t,n,o)}function Ci(e,t,n,o){en(di,"externalCallbacks","tableSelectorsCallback"),di.tableSelectorsCallback(e,t,n,o)}function mi(e,t,n,o,r){en(di,"externalCallbacks","onHeaderUnhideRowColCallback"),di.onHeaderUnhideRowColCallback(e,t,n,o,r)}const pi={};function yi(e,t){if(!di)return t;if(!Bt(pi[e]))return pi[e];const n=di.getServiceSetting(e);return pi[e]=n,Bt(n)?t:n}function Si(){return di.getAppZoom()}function Ri(){return di.getDevicePixelRatio()}function wi(){return di.shouldHitTestHandleEvent()}function bi(e,t,n,o){return en(di,"externalCallbacks","showOrHideHyperlinkFloatie"),di.showOrHideHyperlinkFloatie(e,t,n,o)}function Ii(e){return en(di,"externalCallbacks","isResizeAllowed"),di.isResizeAllowed(e)}function vi(){return en(di,"externalCallbacks","isHeaderDragAllowed"),di.isHeaderDragAllowed()}function Fi(e,t,n){return en(di,"externalCallbacks","isHeaderInsertAllowed"),di.isHeaderInsertAllowed(e,t,n)}function Ti(e){return"function"==typeof di.getFontFamilyEndPoint?di.getFontFamilyEndPoint(e):0}function Di(e){return void 0===ui&&(ui=(0,tn.isChangeGateEnabled)("OfficeVSO:9248839_ExternalCallbacksUndefinedFix")),ui?!(!Ai()||"function"!=typeof di.isFontSourceAddedToCss)&&di.isFontSourceAddedToCss(e):"function"==typeof di.isFontSourceAddedToCss&&di.isFontSourceAddedToCss(e)}function xi(e){return di.getTooltipTitle(e)}function Ai(){return!Bt(di)}function Bi(){return di.isStandardZoomCssSupportedByBrowser()}function Hi(){return void 0===ci&&(ci=(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.HoverTelemetry",!1)),ci||!1}let Mi="";const Pi=2500;let Oi,ki=[],Ei=[];const Li=function(){if(Oi)return Oi;Oi=!1,window.performance&&"function"==typeof window.performance.now&&(Oi=!0);try{window.performance.now()}catch(e){Oi=!1}return Oi}()?window.performance:void 0;function Ni(e,t){return{succeeded:e,message:t,performance:ki,counters:Ei,messageLevel:$i()}}function zi(e,t,n,o){const r=Li?Li.now():-1;if(t(),Li){const t=Li.now()-r;n&&ki[e]?(ki[e]+=t,o&&Ei[e]++):(ki[e]=t,o&&(Ei[e]=1))}}var Gi;function Wi(e){_i(e,1)}function Vi(e){_i(e,0)}function _i(e,t){var n;e&&""!==e&&(Mi=(Mi+"; "+e).substring(0,Pi),(n=t)>$i()&&(Ui=n))}let Ui,ji,qi;function $i(){return void 0===Ui?0:Ui}function Xi(e){return 2*e/3}!function(e){e[e.DrawGridlinesDurationMs=0]="DrawGridlinesDurationMs",e[e.DrawTextDurationMs=1]="DrawTextDurationMs",e[e.ClearDurationMs=2]="ClearDurationMs",e[e.RenderInternalDurationMs=3]="RenderInternalDurationMs",e[e.ModelPreparationsMs=4]="ModelPreparationsMs",e[e.ClearRectDurationMs=5]="ClearRectDurationMs",e[e.FillRectDurationMs=6]="FillRectDurationMs",e[e.GetContextDurationMs=7]="GetContextDurationMs",e[e.DrawSpillCellsDurationMs=8]="DrawSpillCellsDurationMs",e[e.DrawBackgroundFillMs=9]="DrawBackgroundFillMs",e[e.ClearGridlinesMs=10]="ClearGridlinesMs",e[e.ClearGridlinesForBorderMs=11]="ClearGridlinesForBorderMs",e[e.ClearGridLinesForSpannedCellsMs=12]="ClearGridLinesForSpannedCellsMs",e[e.DrawBordersMs=13]="DrawBordersMs",e[e.DrawTextDecoration=14]="DrawTextDecoration",e[e.GetFontMetrics=15]="GetFontMetrics",e[e.DrawCFIconsMs=16]="DrawCFIconsMs",e[e.ReorderBidiTextRuns=17]="ReorderBidiTextRuns",e[e.DrawPageBreaksDurationMs=18]="DrawPageBreaksDurationMs",e[e.DrawSkeletonMs=19]="DrawSkeletonMs",e[e.DrawPrintAreasDurationMs=20]="DrawPrintAreasDurationMs",e[e.ClearGridLinesForPivotTable=21]="ClearGridLinesForPivotTable",e[e.DrawEmptyPivotTableTitleContainers=22]="DrawEmptyPivotTableTitleContainers",e[e.DrawEmptyPivotTableImages=23]="DrawEmptyPivotTableImages",e[e.DrawEmptyPivotTableTitleText=24]="DrawEmptyPivotTableTitleText",e[e.DrawDataBarsMs=25]="DrawDataBarsMs",e[e.DrawSparklines=26]="DrawSparklines",e[e.DrawExpandCollapseButtonsMs=27]="DrawExpandCollapseButtonsMs",e[e.DrawAutoFiltersMs=28]="DrawAutoFiltersMs",e[e.RegisterHitRegionsMs=29]="RegisterHitRegionsMs",e[e.DrawInCellImagesMs=30]="DrawInCellImagesMs",e[e.DrawRichErrorMs=31]="DrawRichErrorMs",e[e.DrawCommentsMs=32]="DrawCommentsMs",e[e.DrawRichValueIcons=33]="DrawRichValueIcons",e[e.DrawPhoneticTextDurationMs=34]="DrawPhoneticTextDurationMs",e[e.HyperlinkEventRegistrationMs=35]="HyperlinkEventRegistrationMs",e[e.CellTooltipRegistrationMs=36]="CellTooltipRegistrationMs",e[e.RegisterTableSelectorsMs=37]="RegisterTableSelectorsMs",e[e.DrawPreviewCellsModeOverlayMs=38]="DrawPreviewCellsModeOverlayMs",e[e.DrawSkeletonCellsMs=39]="DrawSkeletonCellsMs",e[e.RegisterHeaderHitRegionsToModelMs=40]="RegisterHeaderHitRegionsToModelMs",e[e.DrawTableBordersMs=41]="DrawTableBordersMs",e[e.DrawHiddenRowColDurationMs=42]="DrawHiddenRowColDurationMs",e[e.DrawOutlines=43]="DrawOutlines",e[e.DrawPatternMs=44]="DrawPatternMs",e[e.DrawAutoFiltersForHeaderSnappingMs=45]="DrawAutoFiltersForHeaderSnappingMs",e[e.DrawInCellControls=46]="DrawInCellControls",e[e.DrawRowColDragAndDropSixSquaresDurationMs=47]="DrawRowColDragAndDropSixSquaresDurationMs",e[e.DrawResizePillDurationMs=48]="DrawResizePillDurationMs",e[e.ClearColumnHeaderGutterAreaDurationMs=49]="ClearColumnHeaderGutterAreaDurationMs",e[e.DrawHeaderCellTextDurationMs=50]="DrawHeaderCellTextDurationMs",e[e.DrawSingleCellTextDurationMs=51]="DrawSingleCellTextDurationMs",e[e.DrawInsertDotAndInsertButton=52]="DrawInsertDotAndInsertButton",e[e.DrawTextTextLineHeight=53]="DrawTextTextLineHeight",e[e.DrawTextTextMaxWidth=54]="DrawTextTextMaxWidth",e[e.DrawTextUpdateCellContext=55]="DrawTextUpdateCellContext",e[e.DrawDataCleansingHeaderIcon=56]="DrawDataCleansingHeaderIcon"}(Gi||(Gi={}));class Yi{dispose(){this.parentElement&&(this.parentElement.removeChild(this.canvas),this.parentElement=null),this.canvas.style.width="0px",this.canvas.style.height="0px",this.setWidth(0),this.setHeight(0),this.renderingRegion&&(this.renderingRegion.isRendered=!1)}appendToParent(e){e&&(e.appendChild(this.canvas),this.parentElement=e)}getContext2d(e){return this.offscreenCanvas?this.offscreenCanvas.getContext("2d",this.ctxOptions):this.canvas.getContext("2d",this.ctxOptions)}getWidth(){return this.offscreenCanvas?this.offscreenCanvas.width:this.canvas.width}setWidth(e){this.offscreenCanvas?this.offscreenCanvas.width=e:this.canvas.width=e}getHeight(){return this.offscreenCanvas?this.offscreenCanvas.height:this.canvas.height}setHeight(e){this.offscreenCanvas?this.offscreenCanvas.height=e:this.canvas.height=e}getStyle(){return this.canvas.style}setClassName(e){this.canvas.className=null!=e?e:""}updatePosition(e,t,n,o){if(this.canvas){const r=e+"px",i=t+"px",l=this.canvas.style;if(n||(o?l.right!==r:l.left!==r)||l.top!==i)return o?l.right=r:l.left=r,l.top=i,!0}return!1}setDimensions(e,t,n){const o=Math.round(e*n),r=Math.round(t*n);this.setStyleDimensions(o,r,n),this.setWidth(o),this.setHeight(r)}setRenderingRegion(e){e&&(this.renderingRegion=e)}getRenderingRegion(){return this.renderingRegion}setStyleDimensions(e,t,n){this.canvas.style.width=e/n+"px",this.canvas.style.height=t/n+"px"}constructor(e,t){this.renderingRegion=void 0,this.canvas=document.createElement("canvas"),this.parentElement=null;const n=!!t&&Qn();if(this.ctxOptions={alpha:!e},n)try{this.offscreenCanvas=this.canvas.transferControlToOffscreen()}catch(e){Vi("RenderingCanvasElement.ctor:: OffscreenCanvas failed."),this.offscreenCanvas=void 0}else this.offscreenCanvas=void 0}}let Ki=!1;const Ji={};const Zi=new Map;let Qi,el=0;function tl(e){if(ol()){const t=Zi.get(e);if(t&&t.fontNameCannonized)return t.fontNameCannonized}const t=function(e){if(ol()){const t=Zi.get(e);if(t&&t.fontNameCannoizedNoLowercase)return t.fontNameCannoizedNoLowercase}let t=e;const n=e.indexOf("(Body)");n>0&&(t=e.substring(0,n).trim());const o=t.replace(/[\""]/g,"");if(ol()){const t=Zi.get(e)||{};Zi.set(e,_object_spread_props(_object_spread({},t),{fontNameCannoizedNoLowercase:o}))}return o}(e).toLowerCase();if(ol()){const n=Zi.get(e)||{};Zi.set(e,_object_spread_props(_object_spread({},n),{fontNameCannonized:t}))}return t}function nl(e,t){try{return!!document.fonts.check(e)||(!t||"arial"!==tl(t))&&!(0,Se.isFontRefactorFGV3Enabled)()&&window.parent.document.fonts.check(e)}catch(e){return Vi("Error in documentFontsCheck"),!1}finally{el++}}function ol(){return void 0===Qi&&(Qi=(0,Se.isChangeGateEnabled)(Se.ChangeGate.CacheCannonizedFont)&&((0,Se.isChangeGateEnabled)(Se.ChangeGate.ModernFontRendering)?(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.ModernFontRendering"):(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.ModernFontPicker"))),!!Qi}const rl={},il={totalCount:0,unknown:0,static:0,flat:0,hierarchical:0},ll=new Set;let al,sl=!1,dl=!1;function cl(e){let t="Custom Font";return hl(e)&&(t=ul(e)),t}function ul(e){return`Sanitized_${e}`}function hl(e){const t=e.replace(/\s/g,"").toLowerCase();return void 0===al&&(al=(0,Se.isChangeGateEnabled)(Se.ChangeGate.UseSetForKnownFonts)),al?ai.has(t):li().indexOf(t)>-1}function gl(e){if(Kn()){const t=Ti(e);return function(e,t){if(!ll.has(e))switch(ll.add(e),il.totalCount+=1,t){case 0:il.unknown+=1;break;case 1:il.static+=1;break;case 2:il.flat+=1;break;case 3:il.hierarchical+=1}}(e,t),0!==t}return hl(e)}function fl(e,t){return Cl(e.CachedFont,function(e){if(Rl(e))return e.ShrunkSize}(e),t)}function Cl(e,t,n){const o=!!e.Bold,r=yl(o,!!e.Italic);var i;let l=null!==(i=null!=t?t:e.Size)&&void 0!==i?i:Jr;return ml(e)&&(l=Xi(l)),pl(n,r,l,e.FontName,o)}function ml(e){return!Bt(e.VerticalAlign)&&e.VerticalAlign!==Se.FontVerticalAlignment.None}function pl(e,t,n,o,r=!1){let i=tl(o),l=o;var a;e.ClientOnlyCache&&e.ClientOnlyCache.FallbackFonts&&e.ClientOnlyCache.FallbackFonts[Sl(i,n)]&&(i=Pt),function(e){return(0,Se.isFontRefactorFGV3Enabled)()&&!sl&&e===ei}(i)&&((null===(a=e.ClientOnlyCache)||void 0===a?void 0:a.renderWithOldDefaultFont)?(i=Pt,l=Pt):!sl&&nl(`${n}pt "${i}"`,i)?(sl=!0,dl&&setTimeout((()=>{vr.Hv.sendTraceTag(507053218,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,"getFontCssString: Was using fallback for Aptos Narrow, but now it is loaded.")}),200)):(i=Pt,l=Pt,e.ClientOnlyCache.renderWithOldDefaultFont=!0,dl=!0));const s=function(e,t){if(t&&Mo())return e;if(Ki||(ji=new Yi(!1,!0),ji.setWidth(1),ji.setHeight(1),qi=ji.getContext2d(),Ki=!0),!qi)return e;let n=Ji[e];return n||(qi.font=e,n=qi.font,Ji[e]=n,n)}(`${t} ${n}pt "${i}"`,r);return rl[s]=l,s}function yl(e,t){let n="";return n=e&&t?"bold italic":e?"bold":t?"italic":"normal",n}function Sl(e,t){return`${t}pt ${tl(e)}`}function Rl(e){return!(Po(e.PreviewText)||e.DisplayFormula||!e.CachedStyle.ShrinkToFit||e.WrapText)}function wl(e){return bl(e,e.CachedFont,!0)}function bl(e,t,n){const o=Rl(e);let r=o?e.ShrunkSize:t.Size;var i,l;return(!n&&ml(t)||ml(t)&&!n)&&(r=Xi(r)),r<0&&Vi(`\n      actual font size < 0.\n      doesCellHaveShrinkToFit: ${o},\n      cell.ShrunkSize: ${e.ShrunkSize},\n      Font:\n        size: ${t.Size};\n        fontName: ${cl(t.FontName)};\n        refCount: ${t.RefCount||0};\n      cell.CachedStyle:\n        isHidden: ${!!(null===(i=e.CachedStyle)||void 0===i?void 0:i.IsHidden)};\n        shrinkToFit: ${!!(null===(l=e.CachedStyle)||void 0===l?void 0:l.ShrinkToFit)};\n      cell.Ifmt: ${e.Ifmt||0};\n      cell.WrapText: ${e.WrapText};\n    `),r}function Il(e,t){let n=Math.round(e);if(n<Yr&&e>0&&(n=Yr),n>Kr&&(n=Kr),n<0)throw Error(`TextLayout.approximateValue: ${n} in Excel must be between 1pt and 409pt`);let o=t[n];if(o)return o;let r=n;for(;r>Yr&&!t[r];)r--;let i=n;for(;i<Kr&&!t[i];)i++;return o=function(e,t,n,o,r){const i=(n-o)/(r-o)*(e-t);return Math.round(t+i)}(t[i],t[r],n,r,i),t[n]=o,o}const vl={1:1,2:1,3:1,4:1,5:2,6:3,7:3,8:4,9:4,10:5,11:5,12:6,13:5,14:7,16:8,18:9,20:11,22:11,24:11,26:13,28:13,36:17,48:23,72:35,100:49,150:74,200:97,300:145,409:194},Fl={1:1,2:1,3:1,4:1,5:1,6:2,7:2,8:2,9:2,10:2,11:2,12:2,13:3,14:3,15:3,16:3,17:3,18:3,19:4,20:4,21:4,22:4,23:4,24:4,25:5,26:5,27:5,28:5,29:5,30:5,31:6,32:6,33:6,34:6,35:6,36:6,37:7,38:7,39:7,40:7,41:7,42:7,43:8,44:8,45:8,46:8,47:8,48:8,49:9,50:9,51:9,52:9,53:9,54:10,55:10,56:10,57:10,58:10,59:10,60:11,61:11,62:11,63:11,64:11,65:11,66:12,67:12,68:12,69:12,70:12,71:12,72:13,73:13,74:13,75:13,76:13,77:13,78:13,79:14,80:14,81:14,82:14,83:14,84:15,85:15,86:15,87:15,88:15,89:15,90:16,91:16,92:16,93:16,94:16,95:16,96:17,97:17,98:17,99:17,100:17,101:17,102:17,103:17,104:17,105:17,106:17,107:17,108:18,150:25,200:33,300:85,409:115},Tl={1:0,2:0,3:0,4:0,5:0,6:1,11:1,17:1,18:2,35:2,36:3,47:3,48:4,64:5,72:6,100:8,200:17,300:26,409:37},Dl={1:3,3:5,4:6,5:8,8:12,10:12,11:16,12:16,14:20,16:22,18:22,20:26,22:26,24:28,26:32,28:34,36:42,48:57,72:85,100:118,200:234,300:351,400:468,409:478},xl={1:0,3:0,4:0,5:1,8:1,10:1,11:1,12:1,14:2,16:2,18:2,20:3,22:3,24:4,26:5,28:5,36:7,48:10,72:16,100:22,200:44,300:67,400:89,409:90};function Al(e,t,n){var o;return(o=n)&&(o.StrikeThrough||o.Underline||o.VerticalAlign)?function(e){return(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TextOrientationSlice2,e)}(e)&&Bl(e,t):Bl(e,t)}function Bl(e,t){return function(e){return(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TextOrientationSlice1,e)}(e)&&!!(null==(o=t)?void 0:o.Orientation)&&!((n=null==t?void 0:t.HorizontalAlignment)===Se.HorizontalAlignment.Fill||n===Se.HorizontalAlignment.CenterAcrossSelection);var n,o}function Hl(e,t){(t>gt||t<ht)&&Rn("Orientation is not in the defined range","getOrientationInCanvas");const n=-1*t;return e?-1*n:n}function Ml(e,t,n,o){e.save(),e.textAlign=o<0?Ct:mt,e.translate(t,n),e.rotate(o)}function Pl(e,t,n){return e*Math.abs(Math.cos(n))+t}function Ol(e,t,n){return e*Math.abs(Math.sin(n))+t*Math.abs(Math.cos(n))}function kl(e,t,n,o,r,i,l){switch(e){case Se.VerticalAlignment.Top:return i+o+t;case Se.VerticalAlignment.Center:return l-(r-o)/2;case Se.VerticalAlignment.Bottom:case Se.VerticalAlignment.Justify:case Se.VerticalAlignment.Distributed:default:return l-(t-(n?Ee:0))}}function El(e,t){const n=!!e.WrapText||Rl(e);let o=Fl;switch(e.CachedStyle.VerticalAlignment){case Se.VerticalAlignment.Center:return n?Il(t,o):0;case Se.VerticalAlignment.Top:return e.CachedFont.Italic&&(o=vl),Il(t,o);case Se.VerticalAlignment.Justify:case Se.VerticalAlignment.Distributed:case Se.VerticalAlignment.Bottom:default:return Il(t,o)}}function Ll(e){return e*Math.PI/180}function Nl(e){var t;return(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)===Se.HorizontalAlignment.CenterAcrossSelection}function zl(e){var t;switch(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment){case Se.HorizontalAlignment.Justify:case Se.HorizontalAlignment.JustifyDistributed:case Se.HorizontalAlignment.Distributed:return!0}return!1}function Gl(e,t,n=!0){var o,r,i;if(t.DisplayFormula)return Se.HorizontalAlignment.Left;if(Po(t.PreviewText)&&(null===(i=t.PreviewCellStyle)||void 0===i?void 0:i.HorizontalAlignment))return t.PreviewCellStyle.HorizontalAlignment;const l=(null===(o=t.CachedStyle)||void 0===o?void 0:o.HorizontalAlignment)||Se.HorizontalAlignment.Automatic;if((null===(r=t.PivotTable)||void 0===r?void 0:r.HasExpandCollapseIndicator)&&!Bt(t.Spill)&&l!==Se.HorizontalAlignment.CenterAcrossSelection)return e.IsRtl?Se.HorizontalAlignment.Right:Se.HorizontalAlignment.Left;var a;if(Al(e,t.CachedStyle,t.CachedFont)&&(n||!(0,Se.isChangeGateEnabled)(Se.ChangeGate.InCellControlCheckboxAlignmentChangeInTextRotaion)))return Hl(e.IsRtl,null===(a=t.CachedStyle)||void 0===a?void 0:a.Orientation)<0?Se.HorizontalAlignment.Left:Se.HorizontalAlignment.Right;switch(l){case Se.HorizontalAlignment.Fill:return e.IsRtl?Se.HorizontalAlignment.Right:Se.HorizontalAlignment.Left;case Se.HorizontalAlignment.JustifyDistributed:case Se.HorizontalAlignment.Justify:case Se.HorizontalAlignment.Distributed:case Se.HorizontalAlignment.Automatic:return Lt(t)?Se.HorizontalAlignment.Left:function(e,t){var n,o,r;const i=(null===(n=t.CachedStyle)||void 0===n?void 0:n.HorizontalAlignment)||Se.HorizontalAlignment.Automatic;if((null===(o=t.PivotTable)||void 0===o?void 0:o.HasExpandCollapseIndicator)&&(i===Se.HorizontalAlignment.Distributed||i===Se.HorizontalAlignment.Fill))return e.IsRtl?Se.HorizontalAlignment.Right:Se.HorizontalAlignment.Left;switch((null===(r=t.CachedStyle)||void 0===r?void 0:r.ReadingOrder)||Se.ReadingOrderType.Context){case Se.ReadingOrderType.LeftToRight:return Se.HorizontalAlignment.Left;case Se.ReadingOrderType.RightToLeft:return Se.HorizontalAlignment.Right;case Se.ReadingOrderType.Context:const e=t.Text;if(!Bt(e)&&""!==e)return mr(e[0])?Se.HorizontalAlignment.Right:Se.HorizontalAlignment.Left}return Se.HorizontalAlignment.Left}(e,t)}return l}function Wl(e,t,n,o){let r=0;const i=Gl(e,t);switch(i){case Se.HorizontalAlignment.Left:r=n;break;case Se.HorizontalAlignment.Right:r=n-o;break;case Se.HorizontalAlignment.Center:case Se.HorizontalAlignment.CenterAcrossSelection:r=n-o/2;break;default:throw Error(`unexpected context alignment ${i}`)}return r}function Vl(e,t,n){t&&(e.fillStyle=t,e.fill()),e.strokeStyle=n,e.stroke()}function _l(e,t,n,o){e.beginPath(),e.moveTo(o[0].x,o[0].y);for(let t=1;t<o.length;t++)e.lineTo(o[t].x,o[t].y);Vl(e,t,n)}function Ul(e,t){var n;const o=null===(n=t.CondFormat)||void 0===n?void 0:n.Icon;if(o){if(o.IconOnly){const n=Gl(e,t);return n===Se.HorizontalAlignment.Left||n===Se.HorizontalAlignment.Automatic}return!0}return!1}function jl(e,t,n){return en(t,"cell","getCellWidth"),en(e,"model","getCellWidth"),en(e.ColumnWidths,"model.ColumnWidths","getCellWidth"),t.Merge&&en(e.ColumnOffsets,"model.ColumnOffsets","getCellWidth"),pa(e,t,n,!1)}function ql(e,t,n){return en(t,"cell","getCellHeight"),en(e,"model","getCellHeight"),en(e.RowHeights,"model.RowHeights","getCellHeight"),t.Merge&&en(e.RowOffsets,"model.RowOffsets","getCellHeight"),ma(e,t,n,!1)}function $l(e,t,n){return en(t,"cell","getCellWidth"),en(e,"model","getCellWidth"),en(e.ColumnWidths,"model.ColumnWidths","getCellWidth"),t.Merge&&en(e.ColumnOffsets,"model.ColumnOffsets","getCellWidth"),ya(e,t,n,!1,!1,!1)}function Xl(e,t,n){let o=e.ColumnOffsets[t.Col];return t.Merge&&t.Merge.SpansBlocks&&(o-=t.Merge.OriginDeltaX),e.IsRtl?n-o:o+jl(e,t,!1)-Le}function Yl(e,t){return Kl(e,t)+ql(e,t,!1)}function Kl(e,t){return Ca(e,t,!1,!1)}function Jl(e,t){return en(e,"model","getCellWidthAdjustedForDrawing"),en(e.ClientOnlyCache,"ClientOnlyCache","getCellHeightAdjustedForDrawing"),en(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","getCellWidthAdjustedForDrawing"),en(t,"cell","getCellWidthAdjustedForDrawing"),pa(e,t,!1,!0)}function Zl(e,t){return en(e,"model","getCellHeightAdjustedForDrawing"),en(e.ClientOnlyCache,"ClientOnlyCache","getCellHeightAdjustedForDrawing"),en(e.ClientOnlyCache.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","getCellHeightAdjustedForDrawing"),en(t,"cell","getCellHeightAdjustedForDrawing"),ma(e,t,!1,!0)}function Ql(e,t,n,o){return en(e,"model","getCellWidthAdjustedForDrawing"),en(e.ClientOnlyCache,"ClientOnlyCache","getCellWidthAdjustedForDrawing"),en(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","getCellWidthAdjustedForDrawing"),en(t,"cell","getCellWidthAdjustedForDrawing"),ya(e,t,void 0,n,!0,o)}function ea(e,t){return!e.IsRtl||t.RichValueIcon?Ql(e,t,!1,!1):ta(e,t,!1)-sa(t,e)+Le}function ta(e,t,n){const o=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,r=o.length-1,i=t.Col;if(!e.IsRtl||n)return Ql(e,t,n,!1)+Jl(e,t)-Le;const l=t.Merge&&t.Merge.SpansBlocks?t.Merge.OriginDeltaXAdjustedForDrawing:0;return o[r]+l-o[i]}function na(e,t){return ia(e,t,!1)+Zl(e,t)}function oa(e,t){return ia(e,t,!1)+Zl(e,t)/2}function ra(e,t,n){return(ta(e,t,n)+Ql(e,t,n,!1))/2}function ia(e,t,n){return Ca(e,t,!0,n)}function la(e){return!Bt(e.Merge)&&(e.Merge.Rows>0||!0===e.Merge.SpansBlocks)}function aa(e,t){const n=t.ColumnOffsets[fa(e)],o=ga(e,t),r=t.ColumnOffsets[o];return t.ColumnWidths[o]+Math.abs(r-n)}function sa(e,t){const n=Ra(t,fa(e),!0),o=ga(e,t),r=Ra(t,o,!0);return rr(o,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing)+Math.abs(r-n)}function da(e,t,n,o){const r=function(e,t,n,o){return(ha(e,t)?n:0)+(e.IsRtl?0:o)}(t,e,n,o),i=t.ColumnOffsets[fa(e)]+r;if(t.IsRtl){const n=ga(e,t),o=t.ColumnOffsets[n],i=t.ColumnWidths[n];return t.BlockWidth-o-i+r+Le}return i}function ca(e,t,n){return{x:Ql(e,t,n,!1)-Le,y:ia(e,t,!1)-Le,width:Jl(e,t)+Le,height:Zl(e,t)+Le}}function ua(e,t,n){const o=t.Spill&&n;let r=o?ea(e,t):Ql(e,t,!1,!1);return r=e.IsRtl?r-Le:r,{x:r,y:ia(e,t,!1),width:o?sa(t,e):Jl(e,t),height:Zl(e,t)}}function ha(e,t){var n;return!!Ul(e,t)||!!t.RichValueIcon||!Bt(null===(n=t.LinkedEntity)||void 0===n?void 0:n.IconWidth)&&!e.IsRtl}function ga(e,t){return en(t.ColumnNumbers,"model.ColumnNumbers","spillCell.getSpillCellEndCol"),Math.min(t.ColumnNumbers.length-1,e.Col+e.Spill.SpanToEnd)}function fa(e){return Math.max(0,e.Col-e.Spill.SpanToStart)}function Ca(e,t,n,o){let r=Sa(e,t.Row,n);return t.Merge&&t.Merge.SpansBlocks&&!o&&(r-=function(e,t){return t?e.Merge.OriginDeltaYAdjustedForDrawing:e.Merge.OriginDeltaY}(t,n)),r}function ma(e,t,n,o){if(t.Merge){if(t.Merge.SpansBlocks&&!n)return function(e,t){return t?e.Merge.HeightAdjustedForDrawing:e.Merge.Height}(t,o);const r=Sa(e,t.Row,o),i=function(e,t,n){const o=t.Row+t.Merge.Rows;return n?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[o+1]:e.RowOffsets[o]+e.RowHeights[o]}(e,t,o);return i-r}return function(e,t,n){return n?ir(t.Row,e.ClientOnlyCache.RowOffsetsAdjustedForDrawing):e.RowHeights[t.Row]}(e,t,o)}function pa(e,t,n,o){if(t.Merge){if(t.Merge.SpansBlocks&&!n)return function(e,t){return t?e.Merge.WidthAdjustedForDrawing:e.Merge.Width}(t,o);const r=Ra(e,t.Col,o),i=function(e,t,n){const o=t.Col+t.Merge.Columns;return n?e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[o+1]:e.ColumnOffsets[o]+e.ColumnWidths[o]}(e,t,o);return i-r}return function(e,t,n){return n?rr(t.Col,e.ClientOnlyCache.ColOffsetsAdjustedForDrawing):vn(t.Col,e)}(e,t,o)}function ya(e,t,n,o,r,i){let l=Ra(e,t.Col,r);return t.Merge&&t.Merge.SpansBlocks&&!i&&(l-=function(e,t){return t?e.Merge.OriginDeltaXAdjustedForDrawing:e.Merge.OriginDeltaX}(t,r)),!e.IsRtl||o?l:(r?ta(e,t,o):n-l)-pa(e,t,!1,r)+Le}function Sa(e,t,n){return n?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[t]:e.RowOffsets[t]}function Ra(e,t,n){return n?e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[t]:e.ColumnOffsets[t]}let wa;function ba(){return void 0===wa&&(wa=(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.SkeletonRectFillOnce",!1)),wa}function Ia(e,t,n,o,r,i){const l=Math.min(o/4,16),a=Math.min(r/4,8),s=t+o/2-l/2,d=n+r/2-a/2;i?e.rect(s,d,l,a):e.fillRect(s,d,l,a)}function va(e,t,n,o,r,i){const l={eventType:i,callback:r,zIndex:o,region:Ba(n)};Aa(e,t.CellHitRegions,l)}function Fa(e,t,n,o,r,i=(()=>!0)){const l={cursorType:o,zIndex:r,region:Ba(n),shouldChangeCursor:i};Aa(e,t.CellCursorHitRegions,l)}function Ta(e,t,n,o,r){const i={tooltipText:o,zIndex:r,region:Ba(n)};Aa(e,t.CellTooltipHitRegions,i)}function Da(e,t,n,o,r){const i={zIndex:o,eventType:"mouseenter",callback:r,region:Ba(n)};Aa(e,t.CellHitRegions,i)}function xa(e,t,n,o,r){const i={zIndex:o,eventType:"mouseleave",callback:r,region:Ba(n)};Aa(e,t.CellHitRegions,i)}function Aa(e,t,n){const o=function(e,t){const n=(0,Se.getCellLookupKey)(t.Row,t.Col);let o=e[n];return o||(e[n]=[],o=e[n]),o}(t,e);o.push(n)}function Ba(e){const t=e.scaleFactor,n=e.rect,o=n.x/t,r=n.y/t,i=n.width/t,l=n.height/t,a=e.renderingRegion,s=o-(e.isRtl?e.blockWidth-a.endOffsetX:a.startOffsetX),d=r-a.startOffsetY;return{x:e.isMirrored?a.endOffsetX-o-i:s,y:d,width:i,height:l}}const Ha={red:{color:"Red",infoString:"Full render"},blue:{color:"Blue",infoString:"Full render from PLT cache"},green:{color:"Green",infoString:"Partial Rendering (Rendering only changed cells)"}};function Ma(e,t,n){const{CellHitRegions:o,CellCursorHitRegions:r,CellTooltipHitRegions:i,CellLongPressHitRegions:l}=(0,Se.getRenderingRegionHitTestCache)(e,no(n));[o,r,i,l].forEach((e=>{e&&Object.values(e).forEach((e=>{for(let t=0;t<e.length;t++){const n=e[t],o=n.region,{x:r,y:i,width:l,height:a}=o;n.eventType,n.tooltipText,n.cursorType,n.onStart}}))}))}const Pa=!!document.fonts&&!!document.fonts.check;var Oa;!function(e){e[e.Pending=0]="Pending",e[e.Loaded=1]="Loaded",e[e.Failed=2]="Failed"}(Oa||(Oa={}));const ka=new Set(["aptos","aptos narrow","aptos display"]),Ea=new Set,La=new Set,Na=new Set,za=new Set,Ga={},Wa=new Set;let Va;function _a(){return void 0!==document.fonts}function Ua(){return document.fonts.ready}function ja(e){switch(e){case"inherit":case"initial":case"unset":case"revert":return!1}return!0}function qa(e,t){e.style.fontFamily=t}function $a(e,t){var n,o;const r=null===(n=t.CachedFont)||void 0===n?void 0:n.FontName;return!!ja(null===(o=t.CachedFont)||void 0===o?void 0:o.FontName)&&nl(fl(t,e),r)}function Xa(e,t){return Zn()?function(e,t){return"loaded"===Ka(e)?t===Oa.Loaded:t===Oa.Pending}(e,t):function(e,t){if("function"!=typeof document.fonts.values)return!1;const n=document.fonts.values();let o=n.next();for(;!o.done;){if(o.value&&o.value.family.replace(/[\""]/g,"").toLowerCase()===e.toLowerCase())switch(t){case Oa.Loaded:if("loaded"===o.value.status)return!0;break;case Oa.Failed:if("error"===o.value.status)return!0}o=n.next()}return!1}(e,t)}function Ya(e){return Zn()?Ka(e):function(e){if("function"!=typeof document.fonts.values)return;const t=document.fonts.values();let n=t.next();for(;!n.done;){if(n.value&&n.value.family.replace(/[\""]/g,"").toLowerCase()===e.toLowerCase())return n.value.status;n=t.next()}}(e)}function Ka(e){if(Pa)return nl(`11pt ${e}`,e)?"loaded":"loading"}function Ja(e,t){switch(e){case 0:return!1;case 1:return 0===t;case 2:return 0===t||1===t;default:return!0}}function Za(e){switch(e){case Oa.Loaded:return 0;case Oa.Failed:return 1;case Oa.Pending:return 2;default:return 6}}function Qa(e){switch(e){case"loaded":return 0;case"error":return 1;case"loading":return 2;case"unloaded":return 3;default:return 6}}function es(e,t=!0){return t&&(e=tl(e)),Ga[e]}function ts(e,t,n=!0){n&&(e=tl(e)),void 0===Va&&(Va=Kn()&&(0,Se.isChangeGateEnabled)(Se.ChangeGate.AddFontFlickerTelemetry)),!!Va&&!(!Ai()||"function"!=typeof di.isTrackingFontLoadTelemetry)&&di.isTrackingFontLoadTelemetry()&&Ga[e]===Oa.Pending&&t===Oa.Loaded&&za.add(e),Ga[e]=t}function ns(e,t=!0){return t&&(e=tl(e)),null!==Ga[e]&&void 0!==Ga[e]}function os(e){return Wa.has(e)}function rs(e){Wa.add(e)}function is(e){return nl("11pt "+e,e)}function ls(e){return!(!_a()||ns(e)||!ja(e)||!is(e)||(ts(e,Oa.Loaded,!1),0))}let as=!0;const ss=document.createElement("div"),ds=document.createElement("img"),cs=document.createElement("img");ss.innerText=".",ss.style.visibility="hidden",ds.style.height="0px",cs.style.height="0px",ss.appendChild(ds),ss.appendChild(cs),(null===(e=document)||void 0===e?void 0:e.body)&&document.body.appendChild(ss);let us={"6pt arial":{fontSize:6,fontMetrics:{height:9,baseline:2,middle:4.072916}},"7pt arial":{fontSize:7,fontMetrics:{height:11,baseline:2,middle:4.416666698}},"8pt arial":{fontSize:8,fontMetrics:{height:12,baseline:2.666666030883789,middle:4.765625}},"9pt arial":{fontSize:9,fontMetrics:{height:14,baseline:3.33333,middle:6.109375}},"10pt arial":{fontSize:10,fontMetrics:{height:15,baseline:3.6666666,middle:6.453125}},"11pt arial":{fontSize:11,fontMetrics:{height:16,baseline:4,middle:6.796875}},"12pt arial":{fontSize:12,fontMetrics:{height:19,baseline:4.33333333,middle:8.15625}},"13pt arial":{fontSize:13,fontMetrics:{height:21,baseline:4.6666666679,middle:9.15625}},"14pt arial":{fontSize:14,fontMetrics:{height:22,baseline:4.666666030883789,middle:9.84375}},"16pt arial":{fontSize:16,fontMetrics:{height:25,baseline:5.33333333,middle:11.53125}},"18pt arial":{fontSize:18,fontMetrics:{height:28,baseline:5.66666666,middle:12.21875}},"20pt arial":{fontSize:20,fontMetrics:{height:30,baseline:6,middle:12.9166666}},"22pt arial":{fontSize:22,fontMetrics:{height:34,baseline:6.666667938232422,middle:14.609375}},"24pt arial":{fontSize:24,fontMetrics:{height:37,baseline:7.333333,middle:15.63541}},"25pt arial":{fontSize:25,fontMetrics:{height:39,baseline:8,middle:16.6458339}},"26pt arial":{fontSize:26,fontMetrics:{height:40,baseline:8,middle:16.984375}},"28pt arial":{fontSize:28,fontMetrics:{height:43,baseline:8.6666666,middle:18.3437}},"36pt arial":{fontSize:36,fontMetrics:{height:55,baseline:10.666667938232422,middle:23.453125}},"20pt arial black":{fontSize:20,fontMetrics:{height:37,baseline:8,middle:14.90625}},"16pt browallia new":{fontSize:16,fontMetrics:{height:27,baseline:8,middle:11.6145839}},"1pt calibri":{fontSize:1,fontMetrics:{height:1,baseline:0,middle:.3125}},"2pt calibri":{fontSize:2,fontMetrics:{height:3,baseline:.7407407760620117,middle:1.3541667461395264}},"3pt calibri":{fontSize:3,fontMetrics:{height:4,baseline:.7407407760620117,middle:1.6666667461395264}},"4pt calibri":{fontSize:4,fontMetrics:{height:7,baseline:1.4814815521240234,middle:2.719907522201538}},"5pt calibri":{fontSize:5,fontMetrics:{height:8,baseline:1.4814815521240234,middle:3.032407760620117}},"6pt calibri":{fontSize:6,fontMetrics:{height:9,baseline:2,middle:3.8541669}},"7pt calibri":{fontSize:7,fontMetrics:{height:11,baseline:2.666666698,middle:4.8333333969}},"8pt calibri":{fontSize:8,fontMetrics:{height:13,baseline:2.6666669845581055,middle:5.46875}},"9pt calibri":{fontSize:9,fontMetrics:{height:15,baseline:3.3333330154418945,middle:5.78125}},"10pt calibri":{fontSize:10,fontMetrics:{height:17,baseline:3.3333330154418945,middle:7.09375}},"11pt calibri":{fontSize:11,fontMetrics:{height:18,baseline:4,middle:7.40625}},"12pt calibri":{fontSize:12,fontMetrics:{height:19,baseline:4,middle:7.71875}},"13pt calibri":{fontSize:13,fontMetrics:{height:21,baseline:4.6666666,middle:8.6875}},"14pt calibri":{fontSize:14,fontMetrics:{height:21,baseline:5.33333396911621,middle:9.328125}},"15pt calibri":{fontSize:15,fontMetrics:{height:23,baseline:5.6666666667,middle:9.640625}},"16pt calibri":{fontSize:16,fontMetrics:{height:26,baseline:6,middle:10.953125}},"17pt calibri":{fontSize:17,fontMetrics:{height:27,baseline:5.925926208496094,middle:11.192131042480469}},"18pt calibri":{fontSize:18,fontMetrics:{height:29,baseline:6.666666030883789,middle:11.578125}},"19pt calibri":{fontSize:19,fontMetrics:{height:31,baseline:6.666666030883789,middle:12.546297073364258}},"20pt calibri":{fontSize:20,fontMetrics:{height:32,baseline:7.333333969116211,middle:13.1875}},"21pt calibri":{fontSize:21,fontMetrics:{height:34,baseline:7.407405853271484,middle:13.91203498840332}},"22pt calibri":{fontSize:22,fontMetrics:{height:36,baseline:8,middle:14.8125}},"23pt calibri":{fontSize:23,fontMetrics:{height:37,baseline:8.148151397705078,middle:15.266206741333008}},"24pt calibri":{fontSize:24,fontMetrics:{height:39,baseline:8.666666793,middle:16.09375}},"25pt calibri":{fontSize:25,fontMetrics:{height:41,baseline:8.88888931274414,middle:16.63194465637207}},"26pt calibri":{fontSize:26,fontMetrics:{height:43,baseline:9.333333,middle:17.3854179}},"27pt calibri":{fontSize:27,fontMetrics:{height:44,baseline:9.629631042480469,middle:17.98611068725586}},"28pt calibri":{fontSize:28,fontMetrics:{height:45,baseline:10,middle:18.666666}},"29pt calibri":{fontSize:29,fontMetrics:{height:47,baseline:10.370368957519531,middle:19.351852416992188}},"30pt calibri":{fontSize:30,fontMetrics:{height:48,baseline:10.370372772216797,middle:19.652780532836914}},"31pt calibri":{fontSize:31,fontMetrics:{height:50,baseline:11.11111068725586,middle:20.70602035522461}},"32pt calibri":{fontSize:32,fontMetrics:{height:52,baseline:11.11111068725586,middle:21.018518447875977}},"33pt calibri":{fontSize:33,fontMetrics:{height:54,baseline:11.851852416992188,middle:22.06018829345703}},"34pt calibri":{fontSize:34,fontMetrics:{height:55,baseline:11.851852416992188,middle:22.37268829345703}},"35pt calibri":{fontSize:35,fontMetrics:{height:57,baseline:12.592594146728516,middle:23.425926208496094}},"36pt calibri":{fontSize:36,fontMetrics:{height:59,baseline:12.666666679,middle:24.140625}},"37pt calibri":{fontSize:37,fontMetrics:{height:60,baseline:13.333335876464844,middle:24.791667938232422}},"38pt calibri":{fontSize:38,fontMetrics:{height:61,baseline:13.333335876464844,middle:25.104167938232422}},"39pt calibri":{fontSize:39,fontMetrics:{height:64,baseline:14.444446563720703,middle:26.510421752929688}},"40pt calibri":{fontSize:40,fontMetrics:{height:65,baseline:14.074073791503906,middle:26.458335876464844}},"41pt calibri":{fontSize:41,fontMetrics:{height:67,baseline:14.444446563720703,middle:27.135421752929688}},"42pt calibri":{fontSize:42,fontMetrics:{height:68,baseline:14.814811706542969,middle:27.812496185302734}},"43pt calibri":{fontSize:43,fontMetrics:{height:70,baseline:15.555553436279297,middle:28.871524810791016}},"44pt calibri":{fontSize:44,fontMetrics:{height:71,baseline:15.555557250976562,middle:29.18402862548828}},"45pt calibri":{fontSize:45,fontMetrics:{height:73,baseline:16.296295166015625,middle:30.21990966796875}},"46pt calibri":{fontSize:46,fontMetrics:{height:76,baseline:16.666664123535156,middle:30.90277862548828}},"47pt calibri":{fontSize:47,fontMetrics:{height:77,baseline:16.666667938232422,middle:31.215282440185547}},"48pt calibri":{fontSize:48,fontMetrics:{height:72,baseline:17.333332061767578,middle:31.859375}},"49pt calibri":{fontSize:49,fontMetrics:{height:80,baseline:17.777774810791016,middle:32.951385498046875}},"50pt calibri":{fontSize:50,fontMetrics:{height:81,baseline:17.77777862548828,middle:33.24652862548828}},"51pt calibri":{fontSize:51,fontMetrics:{height:83,baseline:18.518516540527344,middle:34.30555725097656}},"52pt calibri":{fontSize:52,fontMetrics:{height:84,baseline:18.888893127441406,middle:34.982643127441406}},"53pt calibri":{fontSize:53,fontMetrics:{height:87,baseline:18.888893127441406,middle:35.295143127441406}},"54pt calibri":{fontSize:54,fontMetrics:{height:88,baseline:18.888885498046875,middle:35.607635498046875}},"55pt calibri":{fontSize:55,fontMetrics:{height:90,baseline:20,middle:37.02546310424805}},"56pt calibri":{fontSize:56,fontMetrics:{height:91,baseline:20,middle:37.32638931274414}},"57pt calibri":{fontSize:57,fontMetrics:{height:92,baseline:20,middle:37.638893127441406}},"58pt calibri":{fontSize:58,fontMetrics:{height:94,baseline:21.111114501953125,middle:39.062503814697266}},"59pt calibri":{fontSize:59,fontMetrics:{height:96,baseline:21.111106872558594,middle:39.375}},"60pt calibri":{fontSize:60,fontMetrics:{height:98,baseline:21.111114501953125,middle:39.687503814697266}},"61pt calibri":{fontSize:61,fontMetrics:{height:100,baseline:22.22222900390625,middle:41.111114501953125}},"62pt calibri":{fontSize:62,fontMetrics:{height:101,baseline:22.22222137451172,middle:41.40625}},"63pt calibri":{fontSize:63,fontMetrics:{height:102,baseline:22.22222900390625,middle:41.718753814697266}},"64pt calibri":{fontSize:64,fontMetrics:{height:104,baseline:23.333335876464844,middle:43.142364501953125}},"65pt calibri":{fontSize:65,fontMetrics:{height:106,baseline:23.3333328,middle:43.458332061}},"66pt calibri":{fontSize:66,fontMetrics:{height:107,baseline:23.333335876464844,middle:43.767364501953125}},"67pt calibri":{fontSize:67,fontMetrics:{height:110,baseline:24.44445037841797,middle:45.19097900390625}},"68pt calibri":{fontSize:68,fontMetrics:{height:111,baseline:24.444442749023438,middle:45.50347137451172}},"69pt calibri":{fontSize:69,fontMetrics:{height:112,baseline:24.44445037841797,middle:45.798614501953125}},"70pt calibri":{fontSize:70,fontMetrics:{height:114,baseline:25.555557250976562,middle:47.22222137451172}},"71pt calibri":{fontSize:71,fontMetrics:{height:116,baseline:25.55554962158203,middle:47.53472137451172}},"72pt calibri":{fontSize:72,fontMetrics:{height:117,baseline:25.925926208496094,middle:48.21759033203125}},"85pt calibri":{fontSize:85,fontMetrics:{height:138,baseline:30,middle:56.31945037841797}},"98pt calibri":{fontSize:98,fontMetrics:{height:160,baseline:35.55554962158203,middle:65.88541412353516}},"100pt calibri":{fontSize:100,fontMetrics:{height:162,baseline:35.55555725097656,middle:66.51620483398438}},"111pt calibri":{fontSize:111,fontMetrics:{height:181,baseline:40,middle:74.35763549804688}},"124pt calibri":{fontSize:124,fontMetrics:{height:202,baseline:44.44444274902344,middle:82.82986450195312}},"137pt calibri":{fontSize:137,fontMetrics:{height:223,baseline:48.888885498046875,middle:91.30209350585938}},"150pt calibri":{fontSize:150,fontMetrics:{height:243,baseline:53.33332824707031,middle:99.77430725097656}},"163pt calibri":{fontSize:163,fontMetrics:{height:266,baseline:58.88890075683594,middle:109.34028625488281}},"176pt calibri":{fontSize:176,fontMetrics:{height:287,baseline:63.333343505859375,middle:117.81251525878906}},"189pt calibri":{fontSize:189,fontMetrics:{height:308,baseline:67.77778625488281,middle:126.28474426269531}},"202pt calibri":{fontSize:202,fontMetrics:{height:329,baseline:72.22222900390625,middle:134.7569580078125}},"215pt calibri":{fontSize:215,fontMetrics:{height:350,baseline:76.66668701171875,middle:143.22918701171875}},"228pt calibri":{fontSize:228,fontMetrics:{height:371,baseline:81.11111450195312,middle:151.70138549804688}},"241pt calibri":{fontSize:241,fontMetrics:{height:392,baseline:86.66665649414062,middle:161.26736450195312}},"254pt calibri":{fontSize:254,fontMetrics:{height:413,baseline:91.11111450195312,middle:169.7395782470703}},"267pt calibri":{fontSize:267,fontMetrics:{height:434,baseline:95.5555419921875,middle:178.2117919921875}},"280pt calibri":{fontSize:280,fontMetrics:{height:456,baseline:100,middle:186.68402099609375}},"293pt calibri":{fontSize:293,fontMetrics:{height:477,baseline:104.4444580078125,middle:195.13888549804688}},"306pt calibri":{fontSize:306,fontMetrics:{height:499,baseline:110,middle:204.72222900390625}},"319pt calibri":{fontSize:319,fontMetrics:{height:519,baseline:114.4444580078125,middle:213.1944580078125}},"332pt calibri":{fontSize:332,fontMetrics:{height:540,baseline:118.88885498046875,middle:221.66665649414062}},"345pt calibri":{fontSize:345,fontMetrics:{height:561,baseline:123.33334350585938,middle:230.138916015625}},"358pt calibri":{fontSize:358,fontMetrics:{height:582,baseline:127.77777099609375,middle:238.61111450195312}},"371pt calibri":{fontSize:371,fontMetrics:{height:604,baseline:133.33331298828125,middle:248.17709350585938}},"384pt calibri":{fontSize:384,fontMetrics:{height:626,baseline:137.77780151367188,middle:256.6493225097656}},"397pt calibri":{fontSize:397,fontMetrics:{height:647,baseline:142.22222900390625,middle:265.12152099609375}},"409pt calibri":{fontSize:409,fontMetrics:{height:666,baseline:146.66668701171875,middle:273.2812805175781}},"12pt calibri light":{fontSize:12,fontMetrics:{height:19,baseline:4,middle:7.6979169845581055}},"14pt comic sans ms":{fontSize:14,fontMetrics:{height:26,baseline:5.3333332061,middle:10.03125}},"9pt georgia":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:5.890625}},"8pt microsoft sans serif":{fontSize:8,fontMetrics:{height:12,baseline:2,middle:4.760416507720947}},"8pt meiryo ui":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.9375}},"9pt meiryo ui":{fontSize:9,fontMetrics:{height:16,baseline:3,middle:6.3125}},"11pt meiryo ui":{fontSize:11,fontMetrics:{height:19,baseline:3,middle:7.046875}},"10pt segoe ui":{fontSize:10,fontMetrics:{height:18,baseline:3.3333330154418945,middle:6.666666030883789}},"6pt times new roman":{fontSize:6,fontMetrics:{height:10,baseline:2.666665,middle:4.45833301}},"7pt times new roman":{fontSize:7,fontMetrics:{height:11,baseline:2.666666698,middle:4.75}},"8pt times new roman":{fontSize:8,fontMetrics:{height:11,baseline:2.666666030883789,middle:4.390625}},"8.5pt times new roman":{fontSize:8.5,fontMetrics:{height:12,baseline:2.8888888888884,middle:4.53125}},"9pt times new roman":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:6.6875}},"10pt times new roman":{fontSize:10,fontMetrics:{height:15,baseline:3.3333333,middle:6.984375}},"11pt times new roman":{fontSize:11,fontMetrics:{height:17,baseline:4,middle:7.28125}},"12pt times new roman":{fontSize:12,fontMetrics:{height:18,baseline:4.3333333,middle:7.578125}},"13pt times new roman":{fontSize:13,fontMetrics:{height:19,baseline:4.5,middle:8.875}},"14pt times new roman":{fontSize:14,fontMetrics:{height:22,baseline:4.666666030883789,middle:9.171875}},"15pt times new roman":{fontSize:15,fontMetrics:{height:23,baseline:4.6666667938,middle:9.13541793}},"16pt times new roman":{fontSize:16,fontMetrics:{height:25,baseline:5.333333,middle:10.765625}},"18pt times new roman":{fontSize:18,fontMetrics:{height:28,baseline:6,middle:11.375}},"19pt times new roman":{fontSize:19,fontMetrics:{height:29,baseline:6,middle:11.666666603}},"20pt times new roman":{fontSize:20,fontMetrics:{height:31,baseline:6.666666603,middle:12.635416}},"8pt tahoma":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.90625}},"10pt tahoma":{fontSize:10,fontMetrics:{height:16,baseline:2.6666666,middle:6.30208301}},"11pt tahoma":{fontSize:11,fontMetrics:{height:18,baseline:3.3333333015,middle:7.333333015}},"12pt trebuchet ms":{fontSize:12,fontMetrics:{height:19,baseline:3.333333,middle:7.5208339691}},"14pt trebuchet ms":{fontSize:14,fontMetrics:{height:22,baseline:4,middle:8.875}},"8pt verdana":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.90625}},"9pt verdana":{fontSize:9,fontMetrics:{height:15,baseline:3,middle:6.265625}},"10pt verdana":{fontSize:10,fontMetrics:{height:16,baseline:2.66666603,middle:6.302083015}},"14pt webdings":{fontSize:14,fontMetrics:{height:19,baseline:4.000000953674316,middle:8.666667938232422}},"36pt wingdings":{fontSize:36,fontMetrics:{height:53,baseline:10,middle:22.000001907348633}}};function hs(e,t,n){eo()||ls(tl(e)),as&&(us=_object_spread({},us,{"8pt aptos narrow":{fontSize:8,fontMetrics:{height:13,baseline:3,middle:5.640625}},"9pt aptos narrow":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:5.984375}},"10pt aptos narrow":{fontSize:10,fontMetrics:{height:17,baseline:4,middle:7.3125}},"11pt aptos narrow":{fontSize:11,fontMetrics:{height:18,baseline:4,middle:7.640625}},"12pt aptos narrow":{fontSize:12,fontMetrics:{height:20,baseline:5,middle:8.96875}},"14pt aptos narrow":{fontSize:14,fontMetrics:{height:23,baseline:5,middle:9.625}},"16pt aptos narrow":{fontSize:16,fontMetrics:{height:26,baseline:6,middle:11.296875}},"18pt aptos narrow":{fontSize:18,fontMetrics:{height:30,baseline:7,middle:12.953125}},"20pt aptos narrow":{fontSize:20,fontMetrics:{height:33,baseline:8,middle:14.609375}},"24pt aptos narrow":{fontSize:24,fontMetrics:{height:39,baseline:9,middle:16.9375}},"26pt aptos narrow":{fontSize:26,fontMetrics:{height:43,baseline:10,middle:18.59375}},"28pt aptos narrow":{fontSize:28,fontMetrics:{height:46,baseline:11,middle:20.265625}},"36pt aptos narrow":{fontSize:36,fontMetrics:{height:59,baseline:14,middle:25.90625}},"48pt aptos narrow":{fontSize:48,fontMetrics:{height:78,baseline:18,middle:33.875}},"72pt aptos narrow":{fontSize:72,fontMetrics:{height:117,baseline:27,middle:50.8125}}}),as=!1);const o=Sl(e,t),r=us[o];if(r)return ps(r.fontMetrics);try{return ps(ms(e,t))}catch(r){Vi(`FontName:${cl(e)}, FontSize:${t} is trying to fallback to calibri ${r}`),n.ClientOnlyCache.FallbackFonts[o]=!0;try{return Ss(t)}catch(e){const n=Math.max(Math.round(t),1);try{return Ss(n)}catch(e){let t=13*Math.round((n-72)/13)+72;return t=Math.min(t,409),Ss(t)}}throw r}}function gs(e){const t=Object.getOwnPropertyNames(us),n=e.toLowerCase();for(let e=0;e<t.length;e++){const o=t[e];if(o.indexOf(n)>=0){const e=us[o].fontSize;try{ms(n,e)}catch(t){ms(Pt,e)}}}}function fs(e){let t=-1,n=-1,o=-1;const r=ds,i=cs;return ss.style.font=e,r.style.verticalAlign="baseline",i.style.verticalAlign="middle",zi(Gi.GetFontMetrics,(()=>{t=ss.clientHeight,n=Cs(r),o=Cs(i)}),!0),{height:t,baseline:n,middle:o}}function Cs(e){if(!ss||!e)throw Error(`getFontBaselineHeight: arguments cannot be null or undefined, fontMetricsDiv: ${ss}, baselineLocator: ${e}`);try{const t=ss.getBoundingClientRect(),n=e.getBoundingClientRect();return t.bottom-n.bottom}catch(e){return Vi("Error in getFontBaselineHeight: "+e),0}}function ms(e,t){const n=Sl(e,t);if(t>=0&&t<1)return us[n]={fontSize:t,fontMetrics:{baseline:0,height:1,middle:0}},us[n].fontMetrics;let o;try{o=fs(n)}catch(o){return ys(t,e,n,`Exception in getFontMetrics, error:${o}`)}return 0===o.height&&t>=1?ys(t,e,n,"fontMetricsDivHeight == 0."):(us[n]={fontSize:t,fontMetrics:o},o)}function ps(e){return{height:e.height,baseline:e.baseline,middle:e.middle}}function ys(e,t,n,o){var r;const i=null!==ss.parentNode?"Has Parent":"Parent is null",l=window.getComputedStyle(ss).getPropertyValue("display");ss.style.display="block",(null===(r=document)||void 0===r?void 0:r.body)&&document.body.appendChild(ss);const a=fs(n),s=window.getComputedStyle(ss),d=s.getPropertyValue("display"),c=s.getPropertyValue("height"),u=ss.getBoundingClientRect();if(0!==a.height)return us[n]={fontSize:e,fontMetrics:a},a;ss.style.overflow="hidden";const h=fs(n);if(0!==h.height)return us[n]={fontSize:e,fontMetrics:a},h;const g=`\n       ${o}\n       Font name: ${cl(t)} }, font size: ${e}.\n       fontMetricsDiv ${i}. fontMetricsDivDisplayMode: ${l}.\n       After another appendChild:\n       FontMetricsDivHeight2: ${a.height} (getFontMetricsDivHeight), fontMetricsDivDisplayMode: ${d} (getComputedStyle),\n       fontBoundingClientRect.height: ${u.height} }, top:${u.top} }, bottom:${u.bottom}.\n       css.height: ${s.height} }, css.line-height: ${s.lineHeight} }, computedHeight: ${c}.\n       FontMetricsDiv.scrollWidth: ${ss.scrollWidth} }, fontMetricsDiv.scrollHeight: ${ss.scrollHeight}`;if(Vi(g),!hl(t)){const t=`${Math.round(e)}pt calibri`;if(us[t])return us[t].fontMetrics}throw Error(g)}function Ss(e){const t=us[Sl(Pt,e)];return ps(t?t.fontMetrics:ms(Pt,e))}const Rs="rid";function ws(e,t){let n=!1,o=!1;for(let t=0;t<e.length&&(mr(e[t])?n=!0:o=!0,!o||!n);t++);const r=function(e,t){if(!e)return"ltr";switch(t){case Se.ReadingOrderType.LeftToRight:return"ltr";case Se.ReadingOrderType.RightToLeft:return"rtl";case Se.ReadingOrderType.Context:return mr(e[0])?"rtl":"ltr"}}(e,t);return{HasLtr:o,HasRtl:n,HasBidi:o&&n,BaseDir:r}}function bs(e,t){const n=[Fs(e,0)];if(1===t.length)return n;let o;for(let i=0;i<t.length;i++)if(" "===(r=t[i])||'"'===r||"'"===r||"."===r||"?"===r||":"===r||";"===r||"-"===r||","===r||"!"===r||"("===r||")"===r){Is(i,o)&&n.push(Ts(e,i));const r=i+1;vs(r,t.length)&&n.push(Fs(e,r)),o=i}var r;return n}function Is(e,t){return e>0&&!(e-1===t)}function vs(e,t){return e<t}function Fs(e,t){return{FontID:e.FontID||0,StartIndex:e.StartIndex+t,CachedFont:e.CachedFont}}function Ts(e,t){return{FontID:e.FontID||0,StartIndex:e.StartIndex+t,CachedFont:e.CachedFont,IsSpecialCharTextRun:!0}}const Ds="#969696",xs=2,As=32,Bs=19,Hs=As+Bs,Ms=.75,Ps=Hs+Bs+24,Os=184/164,ks=9,Es=3,Ls=0,Ns=2,zs=1;let Gs;function Ws(){return Gs||(Gs=di.getRibbonCommandsMapping()),Gs}function Vs(e,t,n,o,r,i,l){const a=or(r*o),s=Jl(t,n)-a,d=Zl(t,n)-a;let c=e;return l&&(c*=o),i&&(c*=r),Math.ceil(Math.max(Math.min(c,s,d),0))}function _s(e,t,n,o){return{isMirrored:o,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:{x:n.x,y:n.y,width:n.width,height:n.height},isRtl:e.IsRtl,blockWidth:e.BlockWidth}}function Us(e,t,n,o){const{commentRow:r,commentColumn:i}=function(e,t){var n,o;let r=e.RowNumbers[t.Row]-1,i=e.ColumnNumbers[t.Col]-1;const l=(null===(n=t.Merge)||void 0===n?void 0:n.OriginRow)||0,a=(null===(o=t.Merge)||void 0===o?void 0:o.OriginColumn)||0;return l&&a&&(r=l,i=a),{commentRow:r,commentColumn:i}}(e,t);return n?l=>{if(t.HasIgnorableError){const n=(0,Se.isPassRibbonCommandsToCanvasRendererEnabled)()?Ws().CardViewHideTemporaryCard:e.RibbonCommands.CardViewHideTemporaryCard;js(e,t,n,!0)(l)}return qs(e,t,!1,!0)(l),gi(r,i,n),o}:l=>(qs(e,t,!0,!0)(l),gi(r,i,n),o)}function js(e,t,n,o){const r=e.RowNumbers[t.Row],i=e.ColumnNumbers[t.Col];return l=>{const a=(0,Se.isPassRibbonCommandsToCanvasRendererEnabled)()?Ws().CardViewShowTemporaryErrorCard:e.RibbonCommands.CardViewShowTemporaryErrorCard,s=n===a;return t.Comment&&s&&Us(e,t,!1,!1)(l),fi(l,n,r,i),o}}function qs(e,t,n,o){const r=e.RowNumbers[t.Row],i=e.ColumnNumbers[t.Col];return l=>{if(!Bt(Yn(t,Wt.InCellImage))){let t;if((0,Se.isPassRibbonCommandsToCanvasRendererEnabled)()){const e=Ws();t=n?e.CardViewShowTemporaryDataCard:e.CardViewHideTemporaryCard}else t=n?e.RibbonCommands.CardViewShowTemporaryDataCard:e.RibbonCommands.CardViewHideTemporaryCard;fi(l,t,r,i)}return o}}const $s=1,Xs=1,Ys=2,Ks=1,Js="gray",Zs="white",Qs="#858585",ed="#10893c",td=16,nd=2,od=3,rd=[{x:5,y:6},{x:8,y:9},{x:11,y:6}],id=[{x:3,y:9},{x:5,y:11},{x:7,y:9}],ld={x:8,y:3},ad=[ld,{x:8,y:5},{x:10,y:6},{x:10,y:10},{x:12,y:10},{x:12,y:6},{x:14,y:5},{x:14,y:3},ld],sd=8,dd={x:4,y:3},cd={x:11,y:3};function ud(e,t,n,o){return Vs(td,e,t,n,o,!1,!0)}function hd(e,t,n,o){const r=ud(e,t,1,n);if((0,Se.isChangeGateEnabled)(Se.ChangeGate.RichIconFilterScale)&&t.RichValueIcon&&!t.PivotTable){const e=(Ys+Ns)/o;return Math.round(r/n+e)}return Math.round(t.PivotTable&&t.RichValueIcon?(r/n+Ys)*o:r/n+Ys*o)}function gd(e,t,n,o){return function(e){var t;const n=((null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)||Se.HorizontalAlignment.Automatic)>3;return e.AutoFilter&&n}(t)?hd(e,t,n,o):0}function fd(e,t){var n;return(t.AutoFilter||(null===(n=t.PivotFilter)||void 0===n?void 0:n.DisplayFilter)&&t.RichValueIcon)&&md(e,t.CachedStyle)}function Cd(e,t){return t.Autofilter&&md(e,t.CachedStyle)}function md(e,t){return(null==t?void 0:t.HorizontalAlignment)===Se.HorizontalAlignment.Right&&!e.IsRtl||(null==t?void 0:t.HorizontalAlignment)===Se.HorizontalAlignment.Left&&e.IsRtl}function pd(e,t,n,o,r){var i;const l=or(r*o),a=Zl(e,t)-2*l>n?Math.round($s*o):0;switch(null===(i=t.CachedStyle)||void 0===i?void 0:i.VerticalAlignment){case Se.VerticalAlignment.Top:return ia(e,t,!1)+a+l+n;case Se.VerticalAlignment.Center:return na(e,t)-Math.round(Zl(e,t)/2)+Math.round(n/2);case Se.VerticalAlignment.Bottom:default:return na(e,t)-a-l}}function yd(e,t,n,o,r){const i=or(r*o),l=Jl(e,t)-2*i>n?Math.round(Xs*o):0;return e.IsRtl?Ql(e,t,!1,!1)+i:ta(e,t,!1)-n-i-l}function Sd(e,t){return Math.floor(Il(e,Dl)*t)}function Rd(e,t){return Math.floor(Il(e,xl)*t)}function wd(e,t){return t===Se.VerticalAlignment.Bottom&&(e.Underline===Se.FontUnderline.Single||e.Underline===Se.FontUnderline.Double)}function bd(e,t,n){return e<t?t:e>n?n:e}function Id(e,t,n,o,r){var i;if(null===(i=t.CondFormat)||void 0===i?void 0:i.Icon)return Sd(n,1)+Rd(n,1)+Le;if(t.RichValueIcon){const n=function(e,t){if(t.PivotTable)return!1;const n=!!t.RichValueIcon&&!!t.AutoFilter;return e.IsRtl&&n&&!md(e,t.CachedStyle)}(e,t)?hd(e,t,o,r):0;return t.RichValueIcon.Width+zs+n}return 0}function vd(e){var t;return(null===(t=e.PivotTable)||void 0===t?void 0:t.HasExpandCollapseIndicator)?ks+Es:0}function Fd(e){return e?ks+Es:0}function Td(e,t){const n=Gl(e,t);switch(n){case Se.HorizontalAlignment.Left:case Se.HorizontalAlignment.CenterAcrossSelection:case Se.HorizontalAlignment.Center:return!e.IsRtl;case Se.HorizontalAlignment.Right:return e.IsRtl;case Se.HorizontalAlignment.Automatic:default:throw Error(`shouldExpandCollapseButtonShiftText: unsupported horizontalAlignment: ${n}`)}}function Dd(e){if(!e.Text)return!1;const t=e.Text.split("#").length-1;return e.CachedIsTextWidthExceedsCellWidth||t===e.Text.length&&e.ValueType===Se.CellValueType.Number}function xd(e,t=1){return Math.round(e*t*kt)}function Ad(e,t,n){(0,Se.verifyArgumentNotNull)(e,"model","getPivotTableTopAdjustedForDrawing"),(0,Se.verifyArgumentNotNull)(e.ClientOnlyCache,"ClientOnlyCache","getPivotTableTopAdjustedForDrawing");const o=e.ClientOnlyCache.RowOffsetsAdjustedForDrawing;return(0,Se.verifyArgumentNotNull)(o,"RowOffsetsAdjustedForDrawing","getPivotTableTopAdjustedForDrawing"),(0,Se.verifyArgumentNotNull)(t,"pivotTable","getPivotTableTopAdjustedForDrawing"),n&&!t.IsEmptyPivot&&0===t.DeltaYFromOriginPTAdjustedForDrawing?o[Gn(e,Md(t,n))]:o[t.FirstRowIndex]+t.DeltaYFromOriginPTAdjustedForDrawing}function Bd(e,t,n){(0,Se.verifyArgumentNotNull)(e,"model","getPivotTableLeftAdjustedForDrawing"),(0,Se.verifyArgumentNotNull)(e.ClientOnlyCache,"ClientOnlyCache","getPivotTableTopAdjustedForDrawing");const o=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing;return(0,Se.verifyArgumentNotNull)(o,"ColOffsetsAdjustedForDrawing","getPivotTableLeftAdjustedForDrawing"),(0,Se.verifyArgumentNotNull)(t,"pivotTable","getPivotTableLeftAdjustedForDrawing"),n||!e.IsRtl?o[t.FirstColIndex]+t.DeltaXFromOriginPTAdjustedForDrawing:o[o.length-1]-t.DeltaXFromOriginPTAdjustedForDrawing-o[t.FirstColIndex]-t.OriginPTWidthAdjustedForDrawing}function Hd(e,t,n,o){return(0,Se.verifyArgumentNotNull)(e,"model","isPivotIntersectsRenderingRegion"),(0,Se.verifyArgumentNotNull)(t,"pivotTable","isPivotIntersectsRenderingRegion"),(0,Se.verifyArgumentNotNull)(n,"renderingRegion","isPivotIntersectsRenderingRegion"),!(t.LastRowIndex<n.startRow)&&!((t.IsEmptyPivot?t.FirstRowIndex:Gn(e,Md(t,o)))>n.endRow||t.FirstColIndex<n.startColumn||t.LastColIndex>n.endColumn)}function Md(e,t){if(!t)return e.FirstRow;const n=e.ColumnHeaderRange;return Bt(n)||n.FirstColumn===n.LastColumn||n.FirstRow===n.LastRow?e.RowHeaderRange.FirstRow:e.ColumnHeaderRange.FirstRow}function Pd(e,t,n){var o,r;if(!(null===(r=e.CondFormat)||void 0===r||null===(o=r.Icon)||void 0===o?void 0:o.IconOnly))return!0;const i=e.CachedFont.Size,l=Rd(i,n),a=Sd(i,n),s=vd(e)*n;switch(e.CondFormat.Icon.CFIconHorizontalAlignment){case Se.HorizontalAlignment.Left:case Se.HorizontalAlignment.Right:return t-a-l-s>0;case Se.HorizontalAlignment.Center:return t/2-a/2-s>0;default:return!0}}function Od(e,t,n){const o=Hn(t.highContrastScheme,n);e.strokeStyle=o,e.lineWidth=Le,e.setLineDash(Qe)}function kd(e,t,n,o,r){let i=e.Col,l=e.Col;const a=n.ClientOnlyCache.ColOffsetsAdjustedForDrawing;e.Merge?(l+=e.Merge.Columns,e.Merge.SpansNextBlockHorizontally&&(l=a.length-1)):e.Spill&&(i-=e.Spill.SpanToStart,l+=e.Spill.SpanToEnd),i=Math.max(0,i),l=Math.min(n.ColumnNumbers.length,l);const s=Zl(n,e),d=ia(n,e,!1),c=s-Le;for(let e=i;e<l;e++){const n=Nr(a[e],rr(e,a),o,r);ur(t,n,d,n,d+c)}}function Ed(e,t,n,o,r){let i=e.Row,l=e.Row+e.Merge.Rows;const a=n.ClientOnlyCache.RowOffsetsAdjustedForDrawing;i=Math.max(0,i),l=Math.min(n.RowNumbers.length,l),e.Merge.SpansNextBlockVertically&&(l=a.length-1);const s=Ql(n,e,n.IsRtl,!1),d=Jl(n,e)-Le;for(let e=i;e<l;e++){const n=Nr(a[e],ir(e,a),o,r);ur(t,s,n,s+d,n)}}const Ld={},Nd={};var zd,Gd;function Wd(e){en(e,"model","validateModel"),en(e.RowOffsets,"model.RowOffsets","validateModel"),en(e.ColumnOffsets,"model.ColumnOffsets","validateModel"),en(e.RowHeights,"model.RowHeights","validateModel"),en(e.ColumnWidths,"model.ColumnWidths","validateModel")}function Vd(e,t){return{BorderLineStyle:Se.BorderLineType.Thin,Color:t,Weight:Je,BorderPosition:e}}function _d(e,t,n,o){var r,i;let l=(null===(r=n.CachedStyle)||void 0===r?void 0:r.BackgroundColor)?hr(null===(i=n.CachedStyle)||void 0===i?void 0:i.BackgroundColor):o;if(l===o)switch(t.BorderPosition){case Se.BorderPositionType.Top:{const t=Ud(n,zd.Top,e);l=t?hr(t):o;break}case Se.BorderPositionType.Left:{const t=Ud(n,zd.Left,e);l=t?hr(t):o;break}}if((0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.DoubleBorderMergeCellFix,e)&&Zd(e,n,t.BorderPosition)){const{BorderPosition:r}=t,i=r===Se.BorderPositionType.Right||r===Se.BorderPositionType.Bottom,d=r===Se.BorderPositionType.Top||r===Se.BorderPositionType.Left;if(i||d&&function(e,t,n){if(t.Merge)return!1;switch(n){case Se.BorderPositionType.Top:{const n=(0,Se.getCell)(t.Row-1,t.Col,e);return!!(null==n?void 0:n.Merge)}case Se.BorderPositionType.Left:{const n=(0,Se.getCell)(t.Row,t.Col-1,e);return!!(null==n?void 0:n.Merge)}}return!1}(e,n,t.BorderPosition))l=function(e,t,n,o){const r=Ud(e,new Map([[Se.BorderPositionType.Top,zd.Top],[Se.BorderPositionType.Left,zd.Left],[Se.BorderPositionType.Right,zd.Right],[Se.BorderPositionType.Bottom,zd.Bottom]]).get(t),n);return r?hr(r):o}(n,t.BorderPosition,e,o);else if(d&&n.Merge){var a,s;l=(null===(a=n.CachedStyle)||void 0===a?void 0:a.BackgroundColor)?hr(null===(s=n.CachedStyle)||void 0===s?void 0:s.BackgroundColor):o}}return l}function Ud(e,t,n){var o;let r;switch(t){case zd.Top:e.Row>0&&(r=(0,Se.getCell)(e.Row-1,e.Col,n));break;case zd.Left:e.Col>0&&(r=(0,Se.getCell)(e.Row,e.Col-1,n));break;case zd.Bottom:e.Row<n.RowNumbers.length&&(r=(0,Se.getCell)(e.Row+1,e.Col,n));break;case zd.Right:e.Col<n.ColumnNumbers.length&&(r=(0,Se.getCell)(e.Row,e.Col+1,n))}return null==r||null===(o=r.CachedStyle)||void 0===o?void 0:o.BackgroundColor}function jd(e,t,n,o,r,i){const l=Xd(e,t,n.BorderPosition,o),a=tc(n);a in i||(r.push(n),i[a]=[]),i[a].push(l)}function qd(e,t,n,o,r){let i=[],l="",a=Je;!function(e){e.strokeStyle="#000000",e.setLineDash([]),e.lineWidth=Je}(e),e.beginPath();for(let s=0;s<t.length;s++){const d=t[s],c=r||ec(d.Color),u=nc(d.BorderLineStyle),h=a!==d.Weight*o,g=l!==c,f=!(0,Se.areGridArraysEqual)(i,u,[]).isEqual;(h||g||f)&&(e.stroke(),e.beginPath(),h&&(a=d.Weight*o,e.lineWidth=a),g&&(l=c,e.strokeStyle=c),f&&(e.setLineDash(u),i=u));const C=n[tc(d)];for(let t=0;t<C.length;t++){const n=C[t];$d(e,d.Weight,n,o)}}e.stroke()}function $d(e,t,n,o){!function(e){return e.Y1===e.Y2}(n)?ur(e,Qd(n.X1,t,o),n.Y1-o,Qd(n.X2,t,o),n.Y2):ur(e,n.X1-o,Qd(n.Y1,t,o),n.X2,Qd(n.Y2,t,o))}function Xd(e,t,n,o){if(!e.IsRtl){const r=(0,Se.isChangeGateEnabled)(Se.ChangeGate.BlockEdgeBorderThicknessFix)&&lc(t,e)||Zd(e,t,n)?Le:o;return Yd(n,{X:Ql(e,t,!1,!1),Y:ia(e,t,!1)},{X:ta(e,t,!1)+r,Y:na(e,t)})}const r=(0,Se.isChangeGateEnabled)(Se.ChangeGate.BlockEdgeBorderThicknessFix)&&lc(t,e)||Zd(e,t,n)?o-Le:0,i=Yd(n,{X:ta(e,t,!1)+o,Y:ia(e,t,!1)},{X:Ql(e,t,!1,!1)+r,Y:na(e,t)});if(n===Se.BorderPositionType.Top||n===Se.BorderPositionType.Bottom){const e=i.X2;i.X2=i.X1,i.X1=e}return i}function Yd(e,t,n){switch(e){case Se.BorderPositionType.Top:return{X1:t.X,Y1:t.Y,X2:n.X,Y2:t.Y};case Se.BorderPositionType.Bottom:return{X1:t.X,Y1:n.Y,X2:n.X,Y2:n.Y};case Se.BorderPositionType.Right:return{X1:n.X,Y1:t.Y,X2:n.X,Y2:n.Y};case Se.BorderPositionType.Left:return{X1:t.X,Y1:t.Y,X2:t.X,Y2:n.Y};default:throw Error("borders::getLineCoordinates Encountered non default BorderPositionType value="+e)}}function Kd(e){switch(e){case Se.BorderLineType.Thin:case Se.BorderLineType.Medium:case Se.BorderLineType.Hair:case Se.BorderLineType.Thick:return!0;default:return!1}}function Jd(e,t,n){return!!lc(n,t)||!!Zd(t,n,e)||(n.HasError?rc(e):e===Se.BorderPositionType.Top||e===Se.BorderPositionType.Left)}function Zd(e,t,n){return!(!t.Merge&&!function(e,t,n){en(n,"model","isCellAdjacentToMergedCell");const o=function(e,t,n){return[(0,Se.getCell)(e-1,t,n),(0,Se.getCell)(e+1,t,n),(0,Se.getCell)(e,t-1,n),(0,Se.getCell)(e,t+1,n)]}(e,t,n);for(let e=0;e<o.length;e++)if(o[e]&&o[e].Merge)return!0;return!1}(t.Row,t.Col,e))&&rc(n)}function Qd(e,t,n){const o=wn(n);return t===Ze&&n%2==1?e:e-o}function ec(e){const t=e.Red+"_"+e.Green+"_"+e.Blue;let n=Ld[t];return Bt(n)?(n=`rgb(${e.Red},${e.Green},${e.Blue})`,Ld[t]=n,n):n}function tc(e){return`${ec(e.Color)}-${e.Weight}-${e.BorderLineStyle}`}function nc(e){let t=Nd[e];if(!Bt(t))return t;switch(e){case Se.BorderLineType.Dotted:t=tt;break;case Se.BorderLineType.DashDot:case Se.BorderLineType.MediumDashDot:t=ot;break;case Se.BorderLineType.DashDotDot:case Se.BorderLineType.MediumDashDotDot:t=rt;break;case Se.BorderLineType.MediumDashed:t=it;break;case Se.BorderLineType.SlantDashDot:case Se.BorderLineType.Dashed:t=nt;break;default:t=[]}return Nd[e]=t,t}function oc(e){return e.HasError?dt:e.CachedBorderStyle}function rc(e){return e<=Se.BorderPositionType.Right}function ic(e,t){const n=e.Col===t.endColumn+1&&e.Row>=t.startRow&&e.Row<=t.endRow,o=e.Row===t.endRow+1&&e.Col>=t.startColumn&&e.Col<=t.endColumn;return n||o}function lc(e,t){return e.Row===t.RowNumbers.length-1||e.Col===t.ColumnNumbers.length-1}!function(e){e[e.Top=0]="Top",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Bottom=3]="Bottom"}(zd||(zd={})),function(e){e[e.Other=1]="Other",e[e.CR=2]="CR",e[e.LF=4]="LF",e[e.Control=8]="Control",e[e.Extend=16]="Extend",e[e.Regional_Indicator=32]="Regional_Indicator",e[e.SpacingMark=64]="SpacingMark",e[e.L=128]="L",e[e.V=256]="V",e[e.T=512]="T",e[e.LV=1024]="LV",e[e.LVT=2048]="LVT",e[e.Prepend=4096]="Prepend",e[e.ZWJ=8192]="ZWJ"}(Gd||(Gd={}));const ac=0|Gd.Control|Gd.CR|Gd.LF,sc=0|Gd.L|Gd.V|Gd.LV|Gd.LVT,dc=0|Gd.V|Gd.LV,cc=0|Gd.V|Gd.T,uc=0|Gd.LVT|Gd.T;function hc(e,t){return!(e===Gd.CR&&t===Gd.LF||!gc(ac,e)&&!gc(ac,t)&&(e===Gd.L&&gc(sc,t)||gc(dc,e)&&gc(cc,t)||gc(uc,e)&&t===Gd.T||e===Gd.Regional_Indicator&&t===Gd.Regional_Indicator||t===Gd.Extend||t===Gd.ZWJ||t===Gd.SpacingMark||e===Gd.Prepend))}function gc(e,t){return 0!=(e&t)}function fc(e){return 8205===e?Gd.ZWJ:13===e?Gd.CR:10===e?Gd.LF:function(e){return 0<=e&&e<=9||11<=e&&e<=12||14<=e&&e<=31||127<=e&&e<=159||173===e||1564===e||6158===e||8203===e||8206<=e&&e<=8207||8232===e||8233===e||8234<=e&&e<=8238||8288<=e&&e<=8292||8293===e||8294<=e&&e<=8303||55296<=e&&e<=57343||65279===e||65520<=e&&e<=65528||65529<=e&&e<=65531||113824<=e&&e<=113827||119155<=e&&e<=119162||917504===e||917505===e||917506<=e&&e<=917535||917632<=e&&e<=917759||918e3<=e&&e<=921599}(e)?Gd.Control:function(e){return 768<=e&&e<=879||1155<=e&&e<=1159||1160<=e&&e<=1161||1425<=e&&e<=1469||1471===e||1473<=e&&e<=1474||1476<=e&&e<=1477||1479===e||1552<=e&&e<=1562||1611<=e&&e<=1631||1648===e||1750<=e&&e<=1756||1759<=e&&e<=1764||1767<=e&&e<=1768||1770<=e&&e<=1773||1809===e||1840<=e&&e<=1866||1958<=e&&e<=1968||2027<=e&&e<=2035||2070<=e&&e<=2073||2075<=e&&e<=2083||2085<=e&&e<=2087||2089<=e&&e<=2093||2137<=e&&e<=2139||2260<=e&&e<=2273||2275<=e&&e<=2306||2362===e||2364===e||2369<=e&&e<=2376||2381===e||2385<=e&&e<=2391||2402<=e&&e<=2403||2433===e||2492===e||2494===e||2497<=e&&e<=2500||2509===e||2519===e||2530<=e&&e<=2531||2561<=e&&e<=2562||2620===e||2625<=e&&e<=2626||2631<=e&&e<=2632||2635<=e&&e<=2637||2641===e||2672<=e&&e<=2673||2677===e||2689<=e&&e<=2690||2748===e||2753<=e&&e<=2757||2759<=e&&e<=2760||2765===e||2786<=e&&e<=2787||2810<=e&&e<=2815||2817===e||2876===e||2878===e||2879===e||2881<=e&&e<=2884||2893===e||2902===e||2903===e||2914<=e&&e<=2915||2946===e||3006===e||3008===e||3021===e||3031===e||3072===e||3134<=e&&e<=3136||3142<=e&&e<=3144||3146<=e&&e<=3149||3157<=e&&e<=3158||3170<=e&&e<=3171||3201===e||3260===e||3263===e||3266===e||3270===e||3276<=e&&e<=3277||3285<=e&&e<=3286||3298<=e&&e<=3299||3328<=e&&e<=3329||3387<=e&&e<=3388||3390===e||3393<=e&&e<=3396||3405===e||3415===e||3426<=e&&e<=3427||3530===e||3535===e||3538<=e&&e<=3540||3542===e||3551===e||3633===e||3636<=e&&e<=3642||3655<=e&&e<=3662||3761===e||3764<=e&&e<=3769||3771<=e&&e<=3772||3784<=e&&e<=3789||3864<=e&&e<=3865||3893===e||3895===e||3897===e||3953<=e&&e<=3966||3968<=e&&e<=3972||3974<=e&&e<=3975||3981<=e&&e<=3991||3993<=e&&e<=4028||4038===e||4141<=e&&e<=4144||4146<=e&&e<=4151||4153<=e&&e<=4154||4157<=e&&e<=4158||4184<=e&&e<=4185||4190<=e&&e<=4192||4209<=e&&e<=4212||4226===e||4229<=e&&e<=4230||4237===e||4253===e||4957<=e&&e<=4959||5906<=e&&e<=5908||5938<=e&&e<=5940||5970<=e&&e<=5971||6002<=e&&e<=6003||6068<=e&&e<=6069||6071<=e&&e<=6077||6086===e||6089<=e&&e<=6099||6109===e||6155<=e&&e<=6157||6277<=e&&e<=6278||6313===e||6432<=e&&e<=6434||6439<=e&&e<=6440||6450===e||6457<=e&&e<=6459||6679<=e&&e<=6680||6683===e||6742===e||6744<=e&&e<=6750||6752===e||6754===e||6757<=e&&e<=6764||6771<=e&&e<=6780||6783===e||6832<=e&&e<=6845||6846===e||6912<=e&&e<=6915||6964===e||6966<=e&&e<=6970||6972===e||6978===e||7019<=e&&e<=7027||7040<=e&&e<=7041||7074<=e&&e<=7077||7080<=e&&e<=7081||7083<=e&&e<=7085||7142===e||7144<=e&&e<=7145||7149===e||7151<=e&&e<=7153||7212<=e&&e<=7219||7222<=e&&e<=7223||7376<=e&&e<=7378||7380<=e&&e<=7392||7394<=e&&e<=7400||7405===e||7412===e||7416<=e&&e<=7417||7616<=e&&e<=7673||7675<=e&&e<=7679||8204===e||8400<=e&&e<=8412||8413<=e&&e<=8416||8417===e||8418<=e&&e<=8420||8421<=e&&e<=8432||11503<=e&&e<=11505||11647===e||11744<=e&&e<=11775||12330<=e&&e<=12333||12334<=e&&e<=12335||12441<=e&&e<=12442||42607===e||42608<=e&&e<=42610||42612<=e&&e<=42621||42654<=e&&e<=42655||42736<=e&&e<=42737||43010===e||43014===e||43019===e||43045<=e&&e<=43046||43204<=e&&e<=43205||43232<=e&&e<=43249||43302<=e&&e<=43309||43335<=e&&e<=43345||43392<=e&&e<=43394||43443===e||43446<=e&&e<=43449||43452===e||43493===e||43561<=e&&e<=43566||43569<=e&&e<=43570||43573<=e&&e<=43574||43587===e||43596===e||43644===e||43696===e||43698<=e&&e<=43700||43703<=e&&e<=43704||43710<=e&&e<=43711||43713===e||43756<=e&&e<=43757||43766===e||44005===e||44008===e||44013===e||64286===e||65024<=e&&e<=65039||65056<=e&&e<=65071||65438<=e&&e<=65439||66045===e||66272===e||66422<=e&&e<=66426||68097<=e&&e<=68099||68101<=e&&e<=68102||68108<=e&&e<=68111||68152<=e&&e<=68154||68159===e||68325<=e&&e<=68326||69633===e||69688<=e&&e<=69702||69759<=e&&e<=69761||69811<=e&&e<=69814||69817<=e&&e<=69818||69888<=e&&e<=69890||69927<=e&&e<=69931||69933<=e&&e<=69940||70003===e||70016<=e&&e<=70017||70070<=e&&e<=70078||70090<=e&&e<=70092||70191<=e&&e<=70193||70196===e||70198<=e&&e<=70199||70206===e||70367===e||70371<=e&&e<=70378||70400<=e&&e<=70401||70460===e||70462===e||70464===e||70487===e||70502<=e&&e<=70508||70512<=e&&e<=70516||70712<=e&&e<=70719||70722<=e&&e<=70724||70726===e||70832===e||70835<=e&&e<=70840||70842===e||70845===e||70847<=e&&e<=70848||70850<=e&&e<=70851||71087===e||71090<=e&&e<=71093||71100<=e&&e<=71101||71103<=e&&e<=71104||71132<=e&&e<=71133||71219<=e&&e<=71226||71229===e||71231<=e&&e<=71232||71339===e||71341===e||71344<=e&&e<=71349||71351===e||71453<=e&&e<=71455||71458<=e&&e<=71461||71463<=e&&e<=71467||72193<=e&&e<=72198||72201<=e&&e<=72202||72243<=e&&e<=72248||72251<=e&&e<=72254||72263===e||72273<=e&&e<=72278||72281<=e&&e<=72283||72330<=e&&e<=72342||72344<=e&&e<=72345||72752<=e&&e<=72758||72760<=e&&e<=72765||72767===e||72850<=e&&e<=72871||72874<=e&&e<=72880||72882<=e&&e<=72883||72885<=e&&e<=72886||73009<=e&&e<=73014||73018===e||73020<=e&&e<=73021||73023<=e&&e<=73029||73031===e||92912<=e&&e<=92916||92976<=e&&e<=92982||94095<=e&&e<=94098||113821<=e&&e<=113822||119141===e||119143<=e&&e<=119145||119150<=e&&e<=119154||119163<=e&&e<=119170||119173<=e&&e<=119179||119210<=e&&e<=119213||119362<=e&&e<=119364||121344<=e&&e<=121398||121403<=e&&e<=121452||121461===e||121476===e||121499<=e&&e<=121503||121505<=e&&e<=121519||122880<=e&&e<=122886||122888<=e&&e<=122904||122907<=e&&e<=122913||122915<=e&&e<=122916||122918<=e&&e<=122922||125136<=e&&e<=125142||125252<=e&&e<=125258||917536<=e&&e<=917631||917760<=e&&e<=917999}(e)?Gd.Extend:function(e){return 127462<=e&&e<=127487}(e)?Gd.Regional_Indicator:function(e){return 2307===e||2363===e||2366<=e&&e<=2368||2377<=e&&e<=2380||2382<=e&&e<=2383||2434<=e&&e<=2435||2495<=e&&e<=2496||2503<=e&&e<=2504||2507<=e&&e<=2508||2563===e||2622<=e&&e<=2624||2691===e||2750<=e&&e<=2752||2761===e||2763<=e&&e<=2764||2818<=e&&e<=2819||2880===e||2887<=e&&e<=2888||2891<=e&&e<=2892||3007===e||3009<=e&&e<=3010||3014<=e&&e<=3016||3018<=e&&e<=3020||3073<=e&&e<=3075||3137<=e&&e<=3140||3202<=e&&e<=3203||3262===e||3264<=e&&e<=3265||3267<=e&&e<=3268||3271<=e&&e<=3272||3274<=e&&e<=3275||3330<=e&&e<=3331||3391<=e&&e<=3392||3398<=e&&e<=3400||3402<=e&&e<=3404||3458<=e&&e<=3459||3536<=e&&e<=3537||3544<=e&&e<=3550||3570<=e&&e<=3571||3635===e||3763===e||3902<=e&&e<=3903||3967===e||4145===e||4155<=e&&e<=4156||4182<=e&&e<=4183||4228===e||6070===e||6078<=e&&e<=6085||6087<=e&&e<=6088||6435<=e&&e<=6438||6441<=e&&e<=6443||6448<=e&&e<=6449||6451<=e&&e<=6456||6681<=e&&e<=6682||6741===e||6743===e||6765<=e&&e<=6770||6916===e||6965===e||6971===e||6973<=e&&e<=6977||6979<=e&&e<=6980||7042===e||7073===e||7078<=e&&e<=7079||7082===e||7143===e||7146<=e&&e<=7148||7150===e||7154<=e&&e<=7155||7204<=e&&e<=7211||7220<=e&&e<=7221||7393===e||7410<=e&&e<=7411||7415===e||43043<=e&&e<=43044||43047===e||43136<=e&&e<=43137||43188<=e&&e<=43203||43346<=e&&e<=43347||43395===e||43444<=e&&e<=43445||43450<=e&&e<=43451||43453<=e&&e<=43456||43567<=e&&e<=43568||43571<=e&&e<=43572||43597===e||43755===e||43758<=e&&e<=43759||43765===e||44003<=e&&e<=44004||44006<=e&&e<=44007||44009<=e&&e<=44010||44012===e||69632===e||69634===e||69762===e||69808<=e&&e<=69810||69815<=e&&e<=69816||69932===e||70018===e||70067<=e&&e<=70069||70079<=e&&e<=70080||70188<=e&&e<=70190||70194<=e&&e<=70195||70197===e||70368<=e&&e<=70370||70402<=e&&e<=70403||70463===e||70465<=e&&e<=70468||70471<=e&&e<=70472||70475<=e&&e<=70477||70498<=e&&e<=70499||70709<=e&&e<=70711||70720<=e&&e<=70721||70725===e||70833<=e&&e<=70834||70841===e||70843<=e&&e<=70844||70846===e||70849===e||71088<=e&&e<=71089||71096<=e&&e<=71099||71102===e||71216<=e&&e<=71218||71227<=e&&e<=71228||71230===e||71340===e||71342<=e&&e<=71343||71350===e||71456<=e&&e<=71457||71462===e||72199<=e&&e<=72200||72249===e||72279<=e&&e<=72280||72343===e||72751===e||72766===e||72873===e||72881===e||72884===e||94033<=e&&e<=94078||119142===e||119149===e}(e)?Gd.SpacingMark:function(e){return 4352<=e&&e<=4447||43360<=e&&e<=43388}(e)?Gd.L:function(e){return 44033<=e&&e<=44059||44061<=e&&e<=44087||44089<=e&&e<=44115||44117<=e&&e<=44143||44145<=e&&e<=44171||44173<=e&&e<=44199||44201<=e&&e<=44227||44229<=e&&e<=44255||44257<=e&&e<=44283||44285<=e&&e<=44311||44313<=e&&e<=44339||44341<=e&&e<=44367||44369<=e&&e<=44395||44397<=e&&e<=44423||44425<=e&&e<=44451||44453<=e&&e<=44479||44481<=e&&e<=44507||44509<=e&&e<=44535||44537<=e&&e<=44563||44565<=e&&e<=44591||44593<=e&&e<=44619||44621<=e&&e<=44647||44649<=e&&e<=44675||44677<=e&&e<=44703||44705<=e&&e<=44731||44733<=e&&e<=44759||44761<=e&&e<=44787||44789<=e&&e<=44815||44817<=e&&e<=44843||44845<=e&&e<=44871||44873<=e&&e<=44899||44901<=e&&e<=44927||44929<=e&&e<=44955||44957<=e&&e<=44983||44985<=e&&e<=45011||45013<=e&&e<=45039||45041<=e&&e<=45067||45069<=e&&e<=45095||45097<=e&&e<=45123||45125<=e&&e<=45151||45153<=e&&e<=45179||45181<=e&&e<=45207||45209<=e&&e<=45235||45237<=e&&e<=45263||45265<=e&&e<=45291||45293<=e&&e<=45319||45321<=e&&e<=45347||45349<=e&&e<=45375||45377<=e&&e<=45403||45405<=e&&e<=45431||45433<=e&&e<=45459||45461<=e&&e<=45487||45489<=e&&e<=45515||45517<=e&&e<=45543||45545<=e&&e<=45571||45573<=e&&e<=45599||45601<=e&&e<=45627||45629<=e&&e<=45655||45657<=e&&e<=45683||45685<=e&&e<=45711||45713<=e&&e<=45739||45741<=e&&e<=45767||45769<=e&&e<=45795||45797<=e&&e<=45823||45825<=e&&e<=45851||45853<=e&&e<=45879||45881<=e&&e<=45907||45909<=e&&e<=45935||45937<=e&&e<=45963||45965<=e&&e<=45991||45993<=e&&e<=46019||46021<=e&&e<=46047||46049<=e&&e<=46075||46077<=e&&e<=46103||46105<=e&&e<=46131||46133<=e&&e<=46159||46161<=e&&e<=46187||46189<=e&&e<=46215||46217<=e&&e<=46243||46245<=e&&e<=46271||46273<=e&&e<=46299||46301<=e&&e<=46327||46329<=e&&e<=46355||46357<=e&&e<=46383||46385<=e&&e<=46411||46413<=e&&e<=46439||46441<=e&&e<=46467||46469<=e&&e<=46495||46497<=e&&e<=46523||46525<=e&&e<=46551||46553<=e&&e<=46579||46581<=e&&e<=46607||46609<=e&&e<=46635||46637<=e&&e<=46663||46665<=e&&e<=46691||46693<=e&&e<=46719||46721<=e&&e<=46747||46749<=e&&e<=46775||46777<=e&&e<=46803||46805<=e&&e<=46831||46833<=e&&e<=46859||46861<=e&&e<=46887||46889<=e&&e<=46915||46917<=e&&e<=46943||46945<=e&&e<=46971||46973<=e&&e<=46999||47001<=e&&e<=47027||47029<=e&&e<=47055||47057<=e&&e<=47083||47085<=e&&e<=47111||47113<=e&&e<=47139||47141<=e&&e<=47167||47169<=e&&e<=47195||47197<=e&&e<=47223||47225<=e&&e<=47251||47253<=e&&e<=47279||47281<=e&&e<=47307||47309<=e&&e<=47335||47337<=e&&e<=47363||47365<=e&&e<=47391||47393<=e&&e<=47419||47421<=e&&e<=47447||47449<=e&&e<=47475||47477<=e&&e<=47503||47505<=e&&e<=47531||47533<=e&&e<=47559||47561<=e&&e<=47587||47589<=e&&e<=47615||47617<=e&&e<=47643||47645<=e&&e<=47671||47673<=e&&e<=47699||47701<=e&&e<=47727||47729<=e&&e<=47755||47757<=e&&e<=47783||47785<=e&&e<=47811||47813<=e&&e<=47839||47841<=e&&e<=47867||47869<=e&&e<=47895||47897<=e&&e<=47923||47925<=e&&e<=47951||47953<=e&&e<=47979||47981<=e&&e<=48007||48009<=e&&e<=48035||48037<=e&&e<=48063||48065<=e&&e<=48091||48093<=e&&e<=48119||48121<=e&&e<=48147||48149<=e&&e<=48175||48177<=e&&e<=48203||48205<=e&&e<=48231||48233<=e&&e<=48259||48261<=e&&e<=48287||48289<=e&&e<=48315||48317<=e&&e<=48343||48345<=e&&e<=48371||48373<=e&&e<=48399||48401<=e&&e<=48427||48429<=e&&e<=48455||48457<=e&&e<=48483||48485<=e&&e<=48511||48513<=e&&e<=48539||48541<=e&&e<=48567||48569<=e&&e<=48595||48597<=e&&e<=48623||48625<=e&&e<=48651||48653<=e&&e<=48679||48681<=e&&e<=48707||48709<=e&&e<=48735||48737<=e&&e<=48763||48765<=e&&e<=48791||48793<=e&&e<=48819||48821<=e&&e<=48847||48849<=e&&e<=48875||48877<=e&&e<=48903||48905<=e&&e<=48931||48933<=e&&e<=48959||48961<=e&&e<=48987||48989<=e&&e<=49015||49017<=e&&e<=49043||49045<=e&&e<=49071||49073<=e&&e<=49099||49101<=e&&e<=49127||49129<=e&&e<=49155||49157<=e&&e<=49183||49185<=e&&e<=49211||49213<=e&&e<=49239||49241<=e&&e<=49267||49269<=e&&e<=49295||49297<=e&&e<=49323||49325<=e&&e<=49351||49353<=e&&e<=49379||49381<=e&&e<=49407||49409<=e&&e<=49435||49437<=e&&e<=49463||49465<=e&&e<=49491||49493<=e&&e<=49519||49521<=e&&e<=49547||49549<=e&&e<=49575||49577<=e&&e<=49603||49605<=e&&e<=49631||49633<=e&&e<=49659||49661<=e&&e<=49687||49689<=e&&e<=49715||49717<=e&&e<=49743||49745<=e&&e<=49771||49773<=e&&e<=49799||49801<=e&&e<=49827||49829<=e&&e<=49855||49857<=e&&e<=49883||49885<=e&&e<=49911||49913<=e&&e<=49939||49941<=e&&e<=49967||49969<=e&&e<=49995||49997<=e&&e<=50023||50025<=e&&e<=50051||50053<=e&&e<=50079||50081<=e&&e<=50107||50109<=e&&e<=50135||50137<=e&&e<=50163||50165<=e&&e<=50191||50193<=e&&e<=50219||50221<=e&&e<=50247||50249<=e&&e<=50275||50277<=e&&e<=50303||50305<=e&&e<=50331||50333<=e&&e<=50359||50361<=e&&e<=50387||50389<=e&&e<=50415||50417<=e&&e<=50443||50445<=e&&e<=50471||50473<=e&&e<=50499||50501<=e&&e<=50527||50529<=e&&e<=50555||50557<=e&&e<=50583||50585<=e&&e<=50611||50613<=e&&e<=50639||50641<=e&&e<=50667||50669<=e&&e<=50695||50697<=e&&e<=50723||50725<=e&&e<=50751||50753<=e&&e<=50779||50781<=e&&e<=50807||50809<=e&&e<=50835||50837<=e&&e<=50863||50865<=e&&e<=50891||50893<=e&&e<=50919||50921<=e&&e<=50947||50949<=e&&e<=50975||50977<=e&&e<=51003||51005<=e&&e<=51031||51033<=e&&e<=51059||51061<=e&&e<=51087||51089<=e&&e<=51115||51117<=e&&e<=51143||51145<=e&&e<=51171||51173<=e&&e<=51199||51201<=e&&e<=51227||51229<=e&&e<=51255||51257<=e&&e<=51283||51285<=e&&e<=51311||51313<=e&&e<=51339||51341<=e&&e<=51367||51369<=e&&e<=51395||51397<=e&&e<=51423||51425<=e&&e<=51451||51453<=e&&e<=51479||51481<=e&&e<=51507||51509<=e&&e<=51535||51537<=e&&e<=51563||51565<=e&&e<=51591||51593<=e&&e<=51619||51621<=e&&e<=51647||51649<=e&&e<=51675||51677<=e&&e<=51703||51705<=e&&e<=51731||51733<=e&&e<=51759||51761<=e&&e<=51787||51789<=e&&e<=51815||51817<=e&&e<=51843||51845<=e&&e<=51871||51873<=e&&e<=51899||51901<=e&&e<=51927||51929<=e&&e<=51955||51957<=e&&e<=51983||51985<=e&&e<=52011||52013<=e&&e<=52039||52041<=e&&e<=52067||52069<=e&&e<=52095||52097<=e&&e<=52123||52125<=e&&e<=52151||52153<=e&&e<=52179||52181<=e&&e<=52207||52209<=e&&e<=52235||52237<=e&&e<=52263||52265<=e&&e<=52291||52293<=e&&e<=52319||52321<=e&&e<=52347||52349<=e&&e<=52375||52377<=e&&e<=52403||52405<=e&&e<=52431||52433<=e&&e<=52459||52461<=e&&e<=52487||52489<=e&&e<=52515||52517<=e&&e<=52543||52545<=e&&e<=52571||52573<=e&&e<=52599||52601<=e&&e<=52627||52629<=e&&e<=52655||52657<=e&&e<=52683||52685<=e&&e<=52711||52713<=e&&e<=52739||52741<=e&&e<=52767||52769<=e&&e<=52795||52797<=e&&e<=52823||52825<=e&&e<=52851||52853<=e&&e<=52879||52881<=e&&e<=52907||52909<=e&&e<=52935||52937<=e&&e<=52963||52965<=e&&e<=52991||52993<=e&&e<=53019||53021<=e&&e<=53047||53049<=e&&e<=53075||53077<=e&&e<=53103||53105<=e&&e<=53131||53133<=e&&e<=53159||53161<=e&&e<=53187||53189<=e&&e<=53215||53217<=e&&e<=53243||53245<=e&&e<=53271||53273<=e&&e<=53299||53301<=e&&e<=53327||53329<=e&&e<=53355||53357<=e&&e<=53383||53385<=e&&e<=53411||53413<=e&&e<=53439||53441<=e&&e<=53467||53469<=e&&e<=53495||53497<=e&&e<=53523||53525<=e&&e<=53551||53553<=e&&e<=53579||53581<=e&&e<=53607||53609<=e&&e<=53635||53637<=e&&e<=53663||53665<=e&&e<=53691||53693<=e&&e<=53719||53721<=e&&e<=53747||53749<=e&&e<=53775||53777<=e&&e<=53803||53805<=e&&e<=53831||53833<=e&&e<=53859||53861<=e&&e<=53887||53889<=e&&e<=53915||53917<=e&&e<=53943||53945<=e&&e<=53971||53973<=e&&e<=53999||54001<=e&&e<=54027||54029<=e&&e<=54055||54057<=e&&e<=54083||54085<=e&&e<=54111||54113<=e&&e<=54139||54141<=e&&e<=54167||54169<=e&&e<=54195||54197<=e&&e<=54223||54225<=e&&e<=54251||54253<=e&&e<=54279||54281<=e&&e<=54307||54309<=e&&e<=54335||54337<=e&&e<=54363||54365<=e&&e<=54391||54393<=e&&e<=54419||54421<=e&&e<=54447||54449<=e&&e<=54475||54477<=e&&e<=54503||54505<=e&&e<=54531||54533<=e&&e<=54559||54561<=e&&e<=54587||54589<=e&&e<=54615||54617<=e&&e<=54643||54645<=e&&e<=54671||54673<=e&&e<=54699||54701<=e&&e<=54727||54729<=e&&e<=54755||54757<=e&&e<=54783||54785<=e&&e<=54811||54813<=e&&e<=54839||54841<=e&&e<=54867||54869<=e&&e<=54895||54897<=e&&e<=54923||54925<=e&&e<=54951||54953<=e&&e<=54979||54981<=e&&e<=55007||55009<=e&&e<=55035||55037<=e&&e<=55063||55065<=e&&e<=55091||55093<=e&&e<=55119||55121<=e&&e<=55147||55149<=e&&e<=55175||55177<=e&&e<=55203}(e)?Gd.LVT:function(e){return 4448<=e&&e<=4519||55216<=e&&e<=55238}(e)?Gd.V:function(e){return 4520<=e&&e<=4607||55243<=e&&e<=55291}(e)?Gd.T:function(e){return 44032===e||44060===e||44088===e||44116===e||44144===e||44172===e||44200===e||44228===e||44256===e||44284===e||44312===e||44340===e||44368===e||44396===e||44424===e||44452===e||44480===e||44508===e||44536===e||44564===e||44592===e||44620===e||44648===e||44676===e||44704===e||44732===e||44760===e||44788===e||44816===e||44844===e||44872===e||44900===e||44928===e||44956===e||44984===e||45012===e||45040===e||45068===e||45096===e||45124===e||45152===e||45180===e||45208===e||45236===e||45264===e||45292===e||45320===e||45348===e||45376===e||45404===e||45432===e||45460===e||45488===e||45516===e||45544===e||45572===e||45600===e||45628===e||45656===e||45684===e||45712===e||45740===e||45768===e||45796===e||45824===e||45852===e||45880===e||45908===e||45936===e||45964===e||45992===e||46020===e||46048===e||46076===e||46104===e||46132===e||46160===e||46188===e||46216===e||46244===e||46272===e||46300===e||46328===e||46356===e||46384===e||46412===e||46440===e||46468===e||46496===e||46524===e||46552===e||46580===e||46608===e||46636===e||46664===e||46692===e||46720===e||46748===e||46776===e||46804===e||46832===e||46860===e||46888===e||46916===e||46944===e||46972===e||47e3===e||47028===e||47056===e||47084===e||47112===e||47140===e||47168===e||47196===e||47224===e||47252===e||47280===e||47308===e||47336===e||47364===e||47392===e||47420===e||47448===e||47476===e||47504===e||47532===e||47560===e||47588===e||47616===e||47644===e||47672===e||47700===e||47728===e||47756===e||47784===e||47812===e||47840===e||47868===e||47896===e||47924===e||47952===e||47980===e||48008===e||48036===e||48064===e||48092===e||48120===e||48148===e||48176===e||48204===e||48232===e||48260===e||48288===e||48316===e||48344===e||48372===e||48400===e||48428===e||48456===e||48484===e||48512===e||48540===e||48568===e||48596===e||48624===e||48652===e||48680===e||48708===e||48736===e||48764===e||48792===e||48820===e||48848===e||48876===e||48904===e||48932===e||48960===e||48988===e||49016===e||49044===e||49072===e||49100===e||49128===e||49156===e||49184===e||49212===e||49240===e||49268===e||49296===e||49324===e||49352===e||49380===e||49408===e||49436===e||49464===e||49492===e||49520===e||49548===e||49576===e||49604===e||49632===e||49660===e||49688===e||49716===e||49744===e||49772===e||49800===e||49828===e||49856===e||49884===e||49912===e||49940===e||49968===e||49996===e||50024===e||50052===e||50080===e||50108===e||50136===e||50164===e||50192===e||50220===e||50248===e||50276===e||50304===e||50332===e||50360===e||50388===e||50416===e||50444===e||50472===e||50500===e||50528===e||50556===e||50584===e||50612===e||50640===e||50668===e||50696===e||50724===e||50752===e||50780===e||50808===e||50836===e||50864===e||50892===e||50920===e||50948===e||50976===e||51004===e||51032===e||51060===e||51088===e||51116===e||51144===e||51172===e||51200===e||51228===e||51256===e||51284===e||51312===e||51340===e||51368===e||51396===e||51424===e||51452===e||51480===e||51508===e||51536===e||51564===e||51592===e||51620===e||51648===e||51676===e||51704===e||51732===e||51760===e||51788===e||51816===e||51844===e||51872===e||51900===e||51928===e||51956===e||51984===e||52012===e||52040===e||52068===e||52096===e||52124===e||52152===e||52180===e||52208===e||52236===e||52264===e||52292===e||52320===e||52348===e||52376===e||52404===e||52432===e||52460===e||52488===e||52516===e||52544===e||52572===e||52600===e||52628===e||52656===e||52684===e||52712===e||52740===e||52768===e||52796===e||52824===e||52852===e||52880===e||52908===e||52936===e||52964===e||52992===e||53020===e||53048===e||53076===e||53104===e||53132===e||53160===e||53188===e||53216===e||53244===e||53272===e||53300===e||53328===e||53356===e||53384===e||53412===e||53440===e||53468===e||53496===e||53524===e||53552===e||53580===e||53608===e||53636===e||53664===e||53692===e||53720===e||53748===e||53776===e||53804===e||53832===e||53860===e||53888===e||53916===e||53944===e||53972===e||54e3===e||54028===e||54056===e||54084===e||54112===e||54140===e||54168===e||54196===e||54224===e||54252===e||54280===e||54308===e||54336===e||54364===e||54392===e||54420===e||54448===e||54476===e||54504===e||54532===e||54560===e||54588===e||54616===e||54644===e||54672===e||54700===e||54728===e||54756===e||54784===e||54812===e||54840===e||54868===e||54896===e||54924===e||54952===e||54980===e||55008===e||55036===e||55064===e||55092===e||55120===e||55148===e||55176===e}(e)?Gd.LV:Gd.Other}function Cc(e){if(!e)return[];const t=[];let n=0,o=e.charCodeAt(n),r=fc(e.codePointAt(n)),i=Gd.Other;for(let l=1;l<e.length;l++){const a=e.charCodeAt(l);l>=1&&mc(o,a)||(i=fc(e.codePointAt(l)),hc(r,i)&&(t.push(e.substring(n,l)),n=l),r=i,o=a)}return n<=e.length-1&&t.push(e.substring(n)),t}function mc(e,t){return 55296<=e&&e<=56319&&56320<=t&&t<=57343}var pc;function yc(e){switch(e){case Se.VerticalAlignment.Justify:case Se.VerticalAlignment.Distributed:return!0}return!1}function Sc(e,t,n,o,r,i,l){if(l)return Se.VerticalAlignment.Bottom;switch(e){case Se.VerticalAlignment.Top:case Se.VerticalAlignment.Bottom:case Se.VerticalAlignment.Center:return e;case Se.VerticalAlignment.Justify:case Se.VerticalAlignment.Distributed:return function(e,t,n,o,r,i){switch(t){case pc.WrapText:return function(e,t,n,o,r){if(1===r||t<o)switch(e){case Se.VerticalAlignment.Justify:return Se.VerticalAlignment.Top;case Se.VerticalAlignment.Distributed:return Se.VerticalAlignment.Center}if(t<n&&t>=o)switch(e){case Se.VerticalAlignment.Justify:case Se.VerticalAlignment.Distributed:return Se.VerticalAlignment.Top}return e}(e,n,o,r,i);case pc.CFIcon:return function(e){switch(e){case Se.VerticalAlignment.Justify:return Se.VerticalAlignment.Top;case Se.VerticalAlignment.Distributed:default:return Se.VerticalAlignment.Center}}(e)}}(e,t,n,o,r,i)}}!function(e){e[e.WrapText=0]="WrapText",e[e.CFIcon=1]="CFIcon"}(pc||(pc={}));let Rc=!0;const wc={},bc={},Ic={};let vc={},Fc=0,Tc=0,Dc=0;function xc(e,t,n,o){if(!t)return 0;if(o){Tc++;const o=e.font,r=rl[o],i=!!r&&es(r)!==Oa.Pending;let l=vc[o];if(l){const e=l[t];if(e)return Dc++,e}else l={};const a=Lc(e,t,n);return i&&(l[t]=a,vc[o]=l,Fc++),Fc===yi(12,200)&&(vr.Hv.sendTraceTag(544310413,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`measureTextWidth: Cache Reset, {"cacheHits"=${Dc}, "totalCalls"=${Tc}}`),Fc=0,vc={},Dc=0,Tc=0),a}return Lc(e,t,n)}function Ac(e,t,n,o,r){if(r)return Se.VerticalAlignment.Bottom;const i=t.CachedStyle,l=i.VerticalAlignment;return t.WrapText||t.Merge||i.VerticalText||!(n>o)||Al(e,i,t.CachedFont)||yc(l)?l:Se.VerticalAlignment.Center}function Bc(e,t,n,o){const r=su(e,t,n,o),i=ha(e,t)?r:0,l=vd(t),a=Td(e,t)?l:0,s=e.IsRtl?Le:0,d=$l(e,t,e.BlockWidth)+i+a;let c=jl(e,t,!1)-r-l;return c=Math.max(0,c),d+c/2-s}function Hc(e){return e*ke}function Mc(e,t,n,o){return cu(t,e,Ec(t,e,n,o))}function Pc(e,t){return cu(e,t,0)}function Oc(e,t,n,o,r,i,l){return{x:t+(e.IsRtl&&!l?0:i),y:n,width:sr(o)-i,height:r}}function kc(e,t,n,o,r,i,l,a=0){const s=du(t,r),d=Gl(e,t);let c=Fl;switch(d){case Se.HorizontalAlignment.Automatic:case Se.HorizontalAlignment.Left:return s+Il(n,c)+l+((0,Se.isIncreasedHeaderSizeEnabled)(e)?a:0);case Se.HorizontalAlignment.Right:return o&&(c=vl),s+Il(n,c)+l+((0,Se.isIncreasedHeaderSizeEnabled)(e)?a:0);case Se.HorizontalAlignment.Center:case Se.HorizontalAlignment.CenterAcrossSelection:return i?Il(n,c):0;default:throw Error(`getTextHorizontalPosition: unsupported horizontalAlignment: ${d}`)}}function Ec(e,t,n,o){let r=function(e,t,n,o){return function(e,t){var n;const o=Ul(e,t),r=!!(null===(n=t.LinkedEntity)||void 0===n?void 0:n.IconWidth)||!!t.RichValueIcon;if((o||r)&&!Al(e,t.CachedStyle,t.CachedFont)){const n=ha(e,t),o=Gl(e,t);switch(o){case Se.HorizontalAlignment.Right:return!n;case Se.HorizontalAlignment.Automatic:case Se.HorizontalAlignment.Left:return n;case Se.HorizontalAlignment.Center:case Se.HorizontalAlignment.CenterAcrossSelection:return!0;default:throw Error(`unexpected context alignment ${o}`)}}return!1}(e,t)?su(e,t,n,o):0}(e,t,n,o);return Td(e,t)&&(r+=vd(t)),r+=fd(e,t)?hd(e,t,n,o):0,r}function Lc(e,t,n){if(!t)return 0;if(n&&Rc){try{const n=t.replace(/^\s+|\s+$/g,""),o=e.measureText(n);if(!Bt(o.actualBoundingBoxLeft)&&!Bt(o.actualBoundingBoxRight)){const r=Math.abs(o.actualBoundingBoxRight)+Math.abs(o.actualBoundingBoxLeft),i=t.length-n.length;let l=0;return i>0&&(l=i*e.measureText(" ").width),r+l}}catch(e){}Rc=!1}return uu(e,t)}function Nc(e,t,n){const o=function(e,t,n){return hs(n,t,e).height}(e,t,n);return Math.ceil(o*ti)}function zc(e,t,n,o,r,i){const l=e.TextRuns,a=l?ru(t,e.TextRuns):e.CachedFont,s=l?a.Size:wl(e),d=Kl(t,e),c=Yl(t,e),u=Gc(t,e)?Ee:0;let h,g;if(ml(a))if(i)h=i;else{const e=hs(a.FontName,s,t),n=wd(a,r);h=function(e,t,n){switch(t){case Se.FontVerticalAlignment.Subscript:return e.baseline/2+_c(n);case Se.FontVerticalAlignment.Superscript:return e.middle+(e.middle-e.baseline);default:return e.baseline}}(e,l?Se.FontVerticalAlignment.None:a.VerticalAlign||0,n)}else h=i||hs(a.FontName,s,t).baseline;switch(r){case Se.VerticalAlignment.Bottom:case Se.VerticalAlignment.Justify:case Se.VerticalAlignment.Distributed:g=u+qc(c,h);break;case Se.VerticalAlignment.Top:g=jc(d,n,h);break;case Se.VerticalAlignment.Center:g=Uc(c,o,n,h);break;default:throw Error(`getTextVerticalPosition: unsupported verticalAlignment: ${r}`)}return{absoluteY:g,lastTextLineAlphabeticBaselineOffset:h}}function Gc(e,t){return function(e,t){en(e,"cell","cellHasBottomDoubleBorder");const n=(0,Se.getCell)(e.Row+1,e.Col,t);if(Bt(n)||Bt(n.CachedBorderStyle)||Bt(n.CachedBorderStyle.Borders))return!1;const o=n.CachedBorderStyle.Borders;for(let e=0;e<o.length;e++){const t=o[e];if(t.BorderPosition===Se.BorderPositionType.Top&&t.BorderLineStyle===Se.BorderLineType.Double)return!0}return!1}(t,e)||function(e){return!(!e.ShrunkSize||!e.CachedFont)&&e.ShrunkSize<e.CachedFont.Size}(t)}function Wc(e,t,n,o,r,i){const l=Nc(e,o,r),a=hs(r,o,e).baseline;switch(i){case Se.VerticalAlignment.Center:case Se.VerticalAlignment.Justify:case Se.VerticalAlignment.Distributed:return Uc(t,n,l,a);case Se.VerticalAlignment.Bottom:return qc(t,a);case Se.VerticalAlignment.Top:return jc(t-n,l,a)}}function Vc(e,t,n,o){const r=hs(n.FontName,o,e);return t-(r.middle-r.baseline)}function _c(e){return e?si:0}function Uc(e,t,n,o){return qc(e-(t+Le-n)/2,o)}function jc(e,t,n){return qc(e+t,n)}function qc(e,t){return e-ni-t}function $c(e){return Il(e,Tl)}function Xc(e,t,n){const o=Gl(e,t),r=Mc(t,e,n.zoom,n.devicePixelRatio);switch(o){case Se.HorizontalAlignment.Right:return Xl(e,t,e.BlockWidth)-r;case Se.HorizontalAlignment.Center:return Bc(e,t,n.zoom,n.devicePixelRatio);case Se.HorizontalAlignment.Automatic:case Se.HorizontalAlignment.Left:return $l(e,t,e.BlockWidth)+r;case Se.HorizontalAlignment.CenterAcrossSelection:return function(e,t,n,o){if(t.Spill){const r=su(e,t,n,o),i=vd(t),l=e.IsRtl?Le:0,a=aa(t,e)-r-i;return da(t,e,r,i)+a/2-l}return Bc(e,t,n,o)}(e,t,n.zoom,n.devicePixelRatio);default:throw Error(`getTextHorizontalPosition: unsupported horizontalAlignment: ${o}`)}}function Yc(e,t,n){const{width:o,textRunsDrawingInformation:r}=Jc(e,t,n);return n.CachedDrawingLayout.CellTextLayout.Width=o,n.CachedDrawingLayout.TextRunDrawingInformation=r,o}function Kc(e,t,n){return Jc(e,t,n).width}function Jc(e,t,n){n.CachedDrawingLayout||(n.CachedDrawingLayout={CellTextLayout:{}}),n.CachedDisplayText||En(t,n,n.Text);const o=!n.DisplayFormula&&n.TextRuns;if(n.CachedDrawingLayout.CellTextLayout.Width){if(o&&!n.CachedDrawingLayout.TextRunDrawingInformation)throw"getTextWidthInternal: TextRunsDrawingData is supposed to be defined";return{width:n.CachedDrawingLayout.CellTextLayout.Width,textRunsDrawingInformation:n.CachedDrawingLayout.TextRunDrawingInformation}}const r=kn(n,t);if(o){const o=nu(n),r=Qc(e,n.TextRuns,n.Text,t,o);return{width:r.totalSize,textRunsDrawingInformation:r.textRunsDrawingInformation}}return{width:xc(e,r,!0,(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TextWidthClientPhase1,t))}}function Zc(e,t,n){const o=xc(e,n.CachedDisplayText,!1,(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TextWidthClientPhase1,t));n.CachedDrawingLayout.CellTextLayout.Width=o}function Qc(e,t,n,o,r){const i=e.textAlign;e.textAlign="left";const l=eu(e,o,n,!1,r,t);return e.textAlign=i,l}function eu(e,t,n,o,r,i){const l=[],a=function(e,t,n){return void 0!==e&&e.HasBidi?function(e,t){const n=[];for(let o=0;o<e.length;o++){const r=bs(e[o],An(o,e,t));n.push(...r)}return n}(t,n):t}(r,i,n);let s=0;const d=(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TextWidthClientPhase1,t);for(let r=0;r<a.length;r++){const i=a[r],c={FontID:i.FontID||0,GlobalFontID:i.GlobalFontID,StartIndex:i.StartIndex},u=An(r,a,n),h=i.CachedFont,g=Cl(h,void 0,t);if(o){const e=Nc(t,h.Size,h.FontName),n=tu(e,u);c.HeightPx=n,c.WidthPx=e,s+=n}else{e.font=g;const t=xc(e,u,r===a.length-1,d);c.Underline=h.Underline,c.WidthPx=t,s+=t}c.Strikethrough=h.StrikeThrough,c.Text=u,c.FontCss=g,l[r]=_object_spread({},c,i)}return{textRunsDrawingInformation:l,totalSize:s}}function tu(e,t){return e*Cc(t).length}function nu(e){en(e.CachedDrawingLayout,"CachedDrawingLayout","getBidiContext");const t=e.CachedDrawingLayout.BidiContext;if(t)return t;const n=ws(e.Text,e.CachedStyle.ReadingOrder||Se.ReadingOrderType.Context);return e.CachedDrawingLayout.BidiContext=n,n}function ou(e,t){en(e.CachedDrawingLayout,"CachedDrawingLayout","getTextLineHeight"),en(e.CachedDrawingLayout.CellTextLayout,"CellTextLayout","getTextLineHeight"),en(e.CachedFont,"CachedFont","getTextLineHeight");const n=!!e.TextRuns;if(void 0!==e.CachedDrawingLayout.CellTextLayout.LineHeight)return e.CachedDrawingLayout.CellTextLayout.LineHeight;let o;n&&(o=ru(t,e.TextRuns));const r=n?o.Size:bl(e,e.CachedFont,!0),i=n?o.FontName:e.CachedFont.FontName;Bt(i)&&Vi(`\n    isRichText: ${n},\n    fontSize: ${r}\n    `);const l=Nc(t,r,i);return e.CachedDrawingLayout.CellTextLayout.LineHeight=l,l}function ru(e,t){let n;for(let o=0;o<t.length;o++){const r=t[o],i=r.CachedFont&&(0,Se.isGetStyleFixChangeGateEnabled)()&&r.CachedFont.GlobalId===r.GlobalFontID?r.CachedFont:(0,Se.getFontByID)(r,e,void 0);(!n||n.Size<i.Size)&&(n=i)}if(!n)throw"getLargestFont: Largest fonts is supposed to be defined";return n}function iu(e,t){const n=ru(e,t.TextRuns);return Nc(e,n.Size,n.FontName)}function lu(e,t){const n=ru(e,t.TextRuns);return hs(n.FontName,n.Size,e)}function au(e,t,n,o){en(o,"numFmt","getNumFmtSeparatorWidth"),en(o.Separator,"separator","getNumFmtSeparatorWidth");const r=o.Separator,i=fl(n,t)+r,l=wc[i];if(Bt(l)||0===l){const t=uu(e,r);return wc[i]=t,t}return wc[i]}function su(e,t,n,o){var r;return Po(t.PreviewText)||((null===(r=t.LinkedEntity)||void 0===r?void 0:r.IconWidth)||t.RichValueIcon)&&t.DisplayFormula?0:Id(e,t,wl(t),n,o)}function du(e,t){return Lt(e)?0:Hc(t)}function cu(e,t,n){const o=t.CachedIndent||0,r=wl(t),i=!Bt(t.WrapText)||Rl(t),l=Lt(t)?ou(t,e)/2:0,a=function(e){return e.IsRow?Dt:0}(e);return kc(e,t,r,t.CachedFont.Italic,o,i,n,a)+l}function uu(e,t){return e.measureText(t).width}function hu(e,t,n,o){let r=bc[o];if(r||(bc[o]=uu(e,"#"),r=bc[o]),n.CachedFont.Italic&&!Ic[o]){const n=xc(e,"#",!0,(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TextWidthClientPhase1,t));Ic[o]=n-r}}const gu=(0,Se.isChangeGateEnabled)(Se.ChangeGate.RotatedTextDecorationWithMergeCellBugFix);function fu(e,t,n,o,r){const i=n.CachedFont.Underline,l=n.CachedFont.StrikeThrough;(i||l)&&""!==n.CachedDisplayText&&(r.textWidth=Yc(e,t,n),Cu(t,n,o,r,n.CachedFont))}function Cu(e,t,n,o,r,i){if(en(t,"cell","CacheUnderlineLayout"),en(t.CachedFont,"cell.CachedFont","CacheUnderlineLayout"),en(t.CachedStyle,"cell.CachedStyle","CacheUnderlineLayout"),en(t.CachedDrawingLayout,"cell.CachedDrawingLayout","CacheUnderlineLayout"),r.Underline!==Se.FontUnderline.None&&!Lt(t)){const l={underline:r.Underline},a=Su(e,t,n,o,l,r,!1,i),s=t.CachedDrawingLayout.UnderlineRuns;if(a&&s.push(a),Ru(l)){const a=Su(e,t,n,o,{underline:l.underline===Se.FontUnderline.DoubleAccounting?Se.FontUnderline.SingleAccounting:Se.FontUnderline.Single},r,!0,i);a&&s.push(a)}}if(r.StrikeThrough){const i=Su(e,t,n,o,{strikethrough:!0},r,!1,void 0);i&&t.CachedDrawingLayout.StrikethroughRuns.push(i)}}function mu(e,t,n){const o=n.CachedDrawingLayout.TextOrientationLayout,r=n.CachedDrawingLayout.UnderlineRuns,i=n.CachedDrawingLayout.StrikethroughRuns,l=t.highContrastScheme?pr(n,t.highContrastScheme):void 0,a=null==o?void 0:o.clipRect;let s;a&&(s={x:a.x*t.scaleFactor,y:a.y*t.scaleFactor,width:a.width*t.scaleFactor,height:a.height*t.scaleFactor}),dr(e,s),Ml(e,o.TranslateX*t.scaleFactor,o.TranslateY*t.scaleFactor,o.Angle),e.beginPath(),pu(e,void 0,void 0,l,r,i),e.stroke(),e.restore(),cr(e,s)}function pu(e,t,n,o,r,i){for(const l of[r,i])if(l&&l.length>0){if(!t||!n){const r=l[0],i=null!=o?o:r.Color;t=i,n=r.LineWidth,e.strokeStyle=i,e.lineWidth=r.LineWidth}for(let r=0;r<l.length;r++){const i=l[r],a=null!=o?o:i.Color,s=t!==a,d=n!==i.LineWidth;(s||d)&&(t=a,n=i.LineWidth,e.stroke(),e.strokeStyle=a,e.lineWidth=i.LineWidth,e.beginPath()),vu(e,i)}}return{lineColor:t,lineWidth:n}}function yu(e){return e[0].Y>e[1].Y?{top:e[1],bottom:e[0]}:{top:e[0],bottom:e[1]}}function Su(e,t,n,o,r,i,l,a){const{scaleFactor:s}=n,d=l||o.partOfMixedUnderlineSequence&&r.underline===Se.FontUnderline.Single,c=bl(t,i,!1),u=function(e,t,n,o,r,i,l,a){const{textPositionX:s,textWidth:d}=o,{scaleFactor:c}=n;let u,h,g;if(r.underline===Se.FontUnderline.SingleAccounting||r.underline===Se.FontUnderline.DoubleAccounting){const o=Mc(t,e,n.zoom,n.devicePixelRatio);u=$l(e,t,e.BlockWidth)+o,h=Xl(e,t,e.BlockWidth)-o}else{const n=!Bt(t.TextRuns)||zl(t);({startX:u,endX:h}=function(e,t,n,o,r){let i,l,a=r?Se.HorizontalAlignment.Left:Gl(e,t);switch(Lt(t)&&(a=Se.HorizontalAlignment.Center),a){case Se.HorizontalAlignment.Automatic:case Se.HorizontalAlignment.Left:i=n,l=n+o;break;case Se.HorizontalAlignment.Right:i=n-o,l=n;break;case Se.HorizontalAlignment.CenterAcrossSelection:case Se.HorizontalAlignment.Center:i=n-o/2,l=n+o/2;break;default:i=n,l=n+o}return{startX:i,endX:l}}(e,t,s,d,n))}g=r.strikethrough?function(e,t,n,o,r){const{textPositionY:i}=n;en(t.CachedFont,"cell.CachedFont","calculateStrikethroughY");const l=$c(r.Size);return Vc(e,i,r,o)-l/2}(e,t,o,i,l):function(e,t,n,o){const{textPositionY:r}=t;en(e.CachedFont,"cell.CachedFont","calculateUnderlineY");return r+2*(null!=o?o:$c(n))}(t,o,i,a),u=Math.round(u*c),h=Math.round(h*c),g=Math.round(g*c);return{startX:u,endX:h,Y:g}}(e,t,n,o,r,c,i,a),h=u.startX,g=u.endX;let f=u.Y;const C=function(e,t,n){const o=(null!=n?n:$c(t))*e;return Math.max(Math.floor(o),1)}(s,c,a),m=Math.round(lt*C);Ru(r)&&(f+=m);const p=Al(e,t.CachedStyle,t.CachedFont);return d&&(f=f-C*(p?St:yt)+m),p?{StartX:h,EndX:g,Y:f,LineWidth:C,Color:i.Color}:function(e,t,n,o,r,i,l,a,s){const{clipRect:d}=o,{scaleFactor:c}=n,u=function(e,t,n,o,r,i,l,a){return function(e,t,n,o){const r=ia(e,t,!1);return o<=r&&o+n<=r}(e,t,r,i)||bu(e,t,r,i)||function(e,t,n,o){const{clipRect:r}=e,{scaleFactor:i}=t,l=r?(r.x+r.width)*i:0;let a=!1;return r&&(a=n>=l&&o>=l),a}(o,n,l,a)||function(e,t,n,o){const{clipRect:r}=e,{scaleFactor:i}=t,l=r?r.x*i:0;let a=!1;return r&&(a=n<=l&&o<=l),a}(o,n,l,a)}(e,t,n,o,r,i,l,a);if(!u||o.containSubscript&&bu(e,t,r,i)){if(d){const e=Math.round(d.x*c),t=Iu(l,a,e,Math.round(d.width*c)+e);l=t.start,a=t.end}if(function(e,t,n,o){const r=o+n,i=ia(e,t,!1)+Le,l=na(e,t)-Le;return o<=i||r>=l}(e,t,r,i)&&(!o.containSubscript||!bu(e,t,r,i))){const n=Iu(i,i+r,ia(e,t,!1),na(e,t)-Le);i=n.start,r=n.end-i}return{StartX:l,EndX:a,Y:i,LineWidth:r,Color:s.Color}}}(e,t,n,o,C,f,h,g,i)}function Ru(e){return e.underline===Se.FontUnderline.Double||e.underline===Se.FontUnderline.DoubleAccounting}function wu(e,t){return e[t].StartX===e[t+1].StartX}function bu(e,t,n,o){const r=na(e,t);return o>=r&&o+n>=r}function Iu(e,t,n,o){const r=Math.min(e,t),i=Math.max(e,t),l=Math.min(n,o),a=Math.max(n,o);return{start:Math.max(r,l),end:Math.min(i,a)}}function vu(e,t){if(0===t.LineWidth)return;const n=t.Y+wn(t.LineWidth);!function(e,t,n,o){e.moveTo(t,o),e.lineTo(n,o)}(e,t.StartX,t.EndX,n)}var Fu,Tu;!function(e){e[e.Wrap=0]="Wrap",e[e.Justify=1]="Justify",e[e.Distributed=2]="Distributed"}(Fu||(Fu={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(Tu||(Tu={}));const Du="textLineId",xu="textTokenId";function Au(e,t,n,o=0){if(e.isProcessingLastLine&&e.breakType===Fu.Justify){const n=function(e,t,n=0){let o="",r=0;for(let n=0;n<e.length;n++)o+=e[n].text,r+=e[n].width,n!==e.length-1&&(o+=$e,r+=t);return{Start:{Offset:n,Text:o,Width:r},SpaceWidthBetweenWords:t}}(t,e.singleSpaceWidth,o);return e.lineDirection===Tu.Vertical&&(n.Start.Offset=e.maxWidth-n.Start.Width),n}if(e.lineDirection===Tu.Vertical&&function(e){if(e.length>=2){const t=e[0];e[0]=e[e.length-1],e[e.length-1]=t}}(t),t.length>0){let r=o,i=0,l=t[i];const a={Start:{Offset:r,Text:l.text,Width:l.width},SpaceWidthBetweenWords:n};let s=Math.floor(n/e.singleSpaceWidth);s<1&&(s=1);const d=function(e,t,n,o){return e.lineDirection===Tu.Vertical&&o>3&&n-t*e.singleSpaceWidth>=0?Math.floor((n-t*e.singleSpaceWidth)*(o-3)/2):0}(e,s,n,t.length);r+=l.width+n+d,i++,(void 0===s||isNaN(s)||s===1/0)&&(Vi(`getJustifyDistributedLine: Invalid count variable. numberOfSpaces: ${s}, spaceWidthBetweenTokens: ${n}, singleSpaceWidth: ${e.singleSpaceWidth} `),s=1);let c="";const u=r;let h=0;for(;i<t.length-1;i++)l=t[i],c+=l.text,h+=l.width,i!==t.length-2&&(c+=$e.repeat(s),h+=e.singleSpaceWidth*s);if(""!==c&&(a.Middle={Offset:u,Text:c,Width:h}),t.length>1){const e=t[t.length-1],o=Bt(a.Middle)?r:u+h+n+d;a.End={Offset:o,Text:e.text,Width:e.width}}return a}}function Bu(e,t){const n=e;if(n.length<=1)return 0;if(t.breakType===Fu.Justify&&t.isProcessingLastLine)return t.singleSpaceWidth;let o=0;for(let e=0;e<n.length;e++)o+=n[e].width;const r=(t.maxWidth-o)/(n.length-1);return r<t.singleSpaceWidth?t.singleSpaceWidth:r}function Hu(e,t,n){return e?t[t.length-1-n]:t[n]}function Mu(e,t){return e.isProcessingLastLine&&e.breakType===Fu.Distributed&&1===t.length&&e.isCompleteTextVisible?(e.maxWidth-t[0].width)/2:0}function Pu(e,t,n,o,r,i,l){const a=[];let s=0,d=!1;for(let c=0;c<n.length;c++){const u=n[c];if(ku(u,o,r))if(Eu(u,o,r))a.push(u),s+=u.width;else{const n=Lu(e,t,u,o,r,i,l);d=i?d||!u.text.startsWith(n.text):Nu(u.text)?!u.text.startsWith(n.text):!u.text.endsWith(n.text),a.push(n),s+=n.width}}return{currentTextTokens:a,currentTokenWidthPx:s,combinePartialTokens:d}}function Ou(e){if(e.Start&&e.End){const t={Start:{Offset:e.Start.Offset,Text:e.End.Text,Width:e.End.Width},SpaceWidthBetweenWords:e.SpaceWidthBetweenWords};let n=t.Start.Offset;return e.Middle&&(t.Middle=e.Middle,n=t.Start.Offset+t.Start.Width+t.SpaceWidthBetweenWords,t.Middle.Offset=n,t.Middle.Text=e.Middle.Text.split(" ").reverse().join(" "),n=t.Middle.Offset+t.Middle.Width),t.End={Text:e.Start.Text,Width:e.Start.Width,Offset:n+t.SpaceWidthBetweenWords},t}return e}function ku(e,t,n){return e.start<n&&e.start+e.text.length>t}function Eu(e,t,n){return t<=e.start&&e.start+e.text.length<=n}function Lu(e,t,n,o,r,i,l){const a=n.start<o?o-n.start:0,s=a+r-(o>n.start?o:n.start),d=n.text.substring(a,s);return{text:d,start:n.start>o?n.start:o,width:i?tu(l,d):xc(e,d,!0,(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TextWidthClientPhase1,t)),containsThaiCharacters:n.containsThaiCharacters}}function Nu(e){return!!e&&ws(e,Se.ReadingOrderType.LeftToRight).HasRtl}function zu(e){return{singleSpaceWidth:e.singleSpaceWidth,breakType:e.breakType,isCompleteTextVisible:e.isCompleteTextVisible,isProcessingLastLine:e.isProcessingLastLine,maxWidth:e.maxWidth,lineDirection:e.lineDirection}}function Gu(e,t,n){return e===Tu.Vertical?n:t.measureText(" ").width}function Wu(e){return Hc(e)}function Vu(e,t,n,o,r,i,l,a,s){_u(e,t,n,o,i,r,void 0,l,!0===n.CachedFont.StrikeThrough,n.CachedFont,a,s)}function _u(e,t,n,o,r,i,l,a,s,d,c,u){const h=e.textAlign;"center"!==h&&(e.textAlign="center");const{graphemes:g,maxFontHeight:f,adjustedOffsetY:C}=qu(t,n,o,l,r,u);!function(e,t,n,o,r,i,l,a,s,d,c){let u=i;for(let i=o.length-1;i>=0;i--){const h=o[i];" "!==h&&(e.fillText(h,r,u),Uu(e,t,n,r,u,h,a,s,d,c)),u-=l}}(e,t,n,g,i,C,f,a,s,d,c),"center"!==h&&(e.textAlign=h)}function Uu(e,t,n,o,r,i,l,a,s,d){a&&Lt(n)&&Cu(t,n,l,{textPositionX:o,textPositionY:r,textWidth:xc(e,i,!0,(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TextWidthClientPhase1,t)),clipRect:d},s)}function ju(e,t,n,o,r){const i=function(e,t,n,o){const r=Wu(t);switch(e){case Se.VerticalAlignment.Top:return n+o+r;case Se.VerticalAlignment.Center:return n+o/2;case Se.VerticalAlignment.Bottom:default:return n-r}}(e,t,n,o);return r&&e===Se.VerticalAlignment.Distributed&&r<=0?i-r:i}function qu(e,t,n,o,r,i){var l;const a=Cc(n),s=o||ou(t,e),d=function(e,t){return(e.length-1)*t}(a,s);return{graphemes:a,maxFontHeight:s,adjustedOffsetY:ju(t.CachedStyle.VerticalAlignment,(null===(l=t.CachedStyle)||void 0===l?void 0:l.Indentation)||0,r,d,i),textHeight:d}}function $u(e,t,n,o,r,i,l,a,s,d){if(en(o,"cell","fillRichTextFormat"),en(n,"model","fillRichTextFormat"),en(r,"formattedText","fillRichTextFormat"),en(r.TextRuns[0].CachedFont,"formattedText.CachedFont","fillRichTextFormat"),0===r.Text.length)return;const c=r.TextRuns;en(c[0].CachedFont,"formattedText.CachedFont","fillRichTextFormat");const u=function(e,t){return!!t&&(Nt(e)?!(t.breakType===Fu.Justify&&t.isProcessingLastLine):zl(e))}(o,d),{totalTextRunHeight:h,totalTextRunWidth:g,largestFont:f,preparedRuns:C}=function(e,t,n,o,r,i,l,a,s){const d=nu(n),c=Lt(n),u=function(e,t,n,o,r){let i,l;const a=t.Fonts;if(n.WrapText){const a=Qc(e,o,r,t,nu(n));l=a.totalSize,i=a.textRunsDrawingInformation}else l=Yc(e,t,n),i=n.CachedDrawingLayout.TextRunDrawingInformation;if(!i||!o)throw"Unexpected: cachedCellRuns and runs are supposed to be defined";return{totalTextRunWidth:l,largestFont:ah(i,a),preparedRuns:i}}(e,t,n,r,i);let h=0,g=u.totalTextRunWidth;const f=u.largestFont,C=u.preparedRuns;return!c&&d.HasRtl&&zi(Gi.ReorderBidiTextRuns,(()=>{!function(e,t,n,o){if(n.HasRtl&&!n.HasLtr)return void e.reverse();const r=yr(n,o);for(let n=0;n<e.length;n++){const o=An(n,e,t),i=document.createElement("span");i.innerText=o,i.setAttribute(Rs,n.toString()),r.appendChild(i)}document.body.appendChild(r);for(let t=0;t<r.children.length;t++){const n=r.children[t],o=n.getAttribute(Rs);if(!o)throw Error("reorderTextRunsForBidiDrawing: runIndexAttr is undefined");const i=n.getBoundingClientRect().left;e[parseInt(o,10)].OffsetX=i}e.sort(((e,t)=>e.OffsetX-t.OffsetX)),document.body.removeChild(r)}(C,i,d,g)}),!0),c&&(h=function(e,t){let n=0;for(let o=0;o<t.length;o++){const r=t[o],i=r.CachedFont,l=Nc(e,null==i?void 0:i.Size,null==i?void 0:i.FontName),a=tu(l,r.Text);r.MaxGlyphHeightPx=l,r.HeightPx=a,n+=a}return n}(t,C)),n.CachedStyle.ShrinkToFit&&(c?h=function(e,t,n,o){const r=ql(e,t,!1);return o<r?o:function(e,t,n,o){let r=0;for(let n=0;n<t.length;n++){const i=t[n],l=i.CachedFont;Zu(e,i,Math.floor(l.Size*o)),r+=i.HeightPx}for(;r<n;){r=0;for(let n=0;n<t.length;n++){const o=t[n];o.ShrunkSize<Kr&&Zu(e,o,o.ShrunkSize+1),r+=o.HeightPx}}for(;r>n;){r=0;for(let n=0;n<t.length;n++){const o=t[n];o.ShrunkSize>Yr&&Zu(e,o,o.ShrunkSize-1),r+=o.HeightPx}}return r}(e,n,r,r/o)}(t,n,C,h):g=function(e,t,n,o,r){const i=jl(e,t,!1),l=t.CachedStyle.Indentation||0,a=fd(e,t)?hd(e,t,n.zoom,n.devicePixelRatio):0,s=kc(e,t,o[0].CachedFont.Size,t.CachedFont.Italic,l||0,!0,a),d=ar(i,s,su(e,t,n.zoom,n.devicePixelRatio),vd(t),0);if(r<d)return r;const c=d/(r+s);let u=0;for(let t=0;t<o.length;t++){const n=o[t];Ju(n,c,e),u+=n.WidthPx}return u}(t,n,o,C,g)),function(e){let t=0;for(;t<e.length;)if(e[t].Underline===Se.FontUnderline.None)t++;else{const{maxFontSize:n,sequenceEndRunIndex:o,hasMixedUnderlineTypes:r}=Qu(e,t),i=$c(n);for(;t<=o;t++)e[t].UnderlineWidth=i,e[t].HasMixedUnderline=r}}(C),!l||Bt(a)||Bt(s)||function(e,t,n,o,r,i){if(0===r.length)throw Error("prepareTextRunsForJustifyAndDistributed: At least one textRun expected");if(0===o.length)return;i&&(n.maxWidth=n.maxWidth-2*Le);const l=Mu(n,o);if(1===r.length){const t=e.font;let a=t;const s=r[0],d=s.FontCss;a!==d&&(e.font=d,a=d);const c=zu(n);c.singleSpaceWidth=Gu(n.lineDirection,e,s.MaxGlyphHeightPx);let u=Au(c,o,Bu(o,n),l);i||!Nu(s.Text)||Bt(u)||(u=Ou(u)),s.JustifyDistributedLine=u,s.WidthPx=function(e,t){let n=0;return t&&e.breakType===Fu.Justify?(n+=null==t?void 0:t.Start.Width,(null==t?void 0:t.Middle)&&(n+=null==t?void 0:t.Middle.Width),(null==t?void 0:t.End)&&(n+=null==t?void 0:t.End.Width),n):e.maxWidth}(n,u),a!==t&&(e.font=t)}else!function(e,t,n,o,r,i,l=0){const a=Bu(n,o),s=function(e){let t=e[0].start;for(let n=1;n<e.length;n++)e[n].start<t&&(t=e[n].start);return t}(n),d=e.font;let c=d,u=l;for(let l=0;l<r.length;l++){const d=Hu(i,r,l),h=d.FontCss;c!==h&&(e.font=h,c=h);const g=zu(o);g.singleSpaceWidth=Gu(o.lineDirection,e,d.MaxGlyphHeightPx);const f=d.StartIndex+s,C=f+(void 0!==d.Text?d.Text.length:0),{currentTextTokens:m,currentTokenWidthPx:p,combinePartialTokens:y}=Pu(e,t,n,f,C,i,d.MaxGlyphHeightPx);if(0!==m.length){let e=Au(g,m,a,u);i||Bt(e)||Nu(d.Text)&&(e=Ou(e)),d.JustifyDistributedLine=e,i&&o.lineDirection===Tu.Vertical?d.HeightPx=p+a*(m.length-1):d.WidthPx=p+a*(m.length-1),y||d.IsSpecialCharTextRun?u+=p+a*(m.length-1):u+=p+a*m.length}}c!==d&&(e.font=d)}(e,t,o,n,r,i,l)}(e,t,s,a,C,c),{totalTextRunHeight:h,totalTextRunWidth:g,largestFont:f,preparedRuns:C}}(e,n,o,t,c,r.Text,u,s,d);en((0,Se.getCellStyle)(n,o),"cellStyle","fillRichTextFormat"),function(e,t,n,o,r,i,l,a,s,d,c,u,h){var g;const f=e.textAlign,C=e.textBaseline,m=e.font,p=e.fillStyle,y=Lt(o);let S=a;y&&(S=function(e,t,n,o,r,i,l){var a;if(!i&&(null===(a=t.CachedStyle)||void 0===a?void 0:a.VerticalAlignment)===Se.VerticalAlignment.Justify){const r=ah(n,e.Fonts),i=hs(r.FontName,r.Size,e).baseline;return Yl(e,t)-ni-i-(l-o)}return r}(n,o,s,d,S,c,h)),S=function(e,t,n,o,r,i,l){return t?function(e,t,n,o){const r=e.CachedStyle.VerticalAlignment,i=o[o.length-1].HeightPx||0;switch(r){case Se.VerticalAlignment.Top:return t+n-i;case Se.VerticalAlignment.Justify:case Se.VerticalAlignment.Distributed:case Se.VerticalAlignment.Bottom:return t;case Se.VerticalAlignment.Center:return t+(n-i)/2}}(n,o,r,i):function(e,t,n,o){const r=n.CachedStyle.VerticalAlignment,i=Nc(e,t.Size,t.FontName),l=hs(t.FontName,t.Size,e).baseline;en(l,"textBaselineAdjustY","adjustYForVerticalAlignment");const a=o-l;return r===Se.VerticalAlignment.Center?a+(i-l)/2:a}(e,l,n,o)}(n,y,o,S,d,s,i);let R=y?l:th(n,o,l,c,r,h),w=!1;e.textAlign="left",e.textBaseline="alphabetic",t.highContrastScheme&&(e.fillStyle=pr(o,t.highContrastScheme));for(let r=0;r<s.length;r++){const i=Hu(y,s,r);en(i.CachedFont,"run.CachedFont","drawTextRuns");const l=i.CachedFont,d=l.VerticalAlign;let g=0,f=!1;y||o.WrapText||({subSuperOffsetY:g,isFontVerticalAlignment:f,hasVerticalAlignedFont:w}=oh(o,d,l,a,hs(l.FontName,l.Size,n),w)),e.font=i.FontCss,t.highContrastScheme||(e.fillStyle=i.CachedFont.Color),({offsetX:R,offsetY:S}=rh(e,n,o,t,R,nh(a,g,S,y,f),i,s,r,u,d,y,c,h))}w&&!Bt(null===(g=o.CachedDrawingLayout)||void 0===g?void 0:g.UnderlineRuns)&&function(e,t,n){if(Bt(n)||n.length<=0)return;const o=function(e,t,n){let o=-1,r=-1,i=0,l=!1;for(let e=0;e<n.length;e++)if(!(e>0&&wu(n,e-1)))if(e<n.length-1&&wu(n,e)){const{top:t,bottom:a}=yu([n[e],n[e+1]]);t.Y>o&&(o=t.Y),a.Y>r&&(r=a.Y,i=Math.max(a.LineWidth,1),l=!0)}else n[e].Y>o&&(o=n[e].Y,l||(i=Math.max(n[e].LineWidth,1)));return bu(e,t,i,r)&&(r=na(e,t)-i,o=r-2*i),o-r<2*i&&(o=r-2*i),{closestToBottomUnderline:o,closestToBottomDoubleUnderline:r,closestToBottomUnderlineWidth:i}}(e,t,n);for(let e=0;e<n.length;e++)if(!(e>0&&n[e].StartX===n[e-1].StartX)){if(e<n.length-1&&n[e].StartX===n[e+1].StartX){const{top:t,bottom:r}=yu([n[e],n[e+1]]);t.Y=o.closestToBottomUnderline,r.Y=o.closestToBottomDoubleUnderline,n[e+1].LineWidth=o.closestToBottomUnderlineWidth}else n[e].Y=o.closestToBottomUnderline;n[e].LineWidth=o.closestToBottomUnderlineWidth}}(n,o,o.CachedDrawingLayout.UnderlineRuns),e.textAlign=f,e.textBaseline=C,e.font=m,e.fillStyle=p}(e,t,n,o,g,f,i,l,C,h,u,a,null==d?void 0:d.maxWidth)}function Xu(e,t,n){if(en(e.Text,"formattedText.Text","substringFormattedText"),0===e.Text.length)return Ue;const o=e.Text.substring(t,n);if(0===o.length)return{Text:o,Fonts:e.Fonts,TextRuns:[]};const r=e.TextRuns;if(en(r,"formattedText.runs","substringFormattedText"),0===r.length)throw Error("Invalid param: formattedText runs.length === 0");Nn(r,e.Text);const i=e.Text.length,l={isCarriageReturnExists:-1!==e.Text.indexOf("\r"),formattedTextLength:i,text:e.Text},a=Ku(t,r,l),s=n&&n<e.Text.length?Ku(n-1,r,l):r.length-1,d=[],c=(0,Se.isGetStyleFixChangeGateEnabled)(),u=r[a];d.push({StartIndex:0,FontID:u.FontID||0,GlobalFontID:c?u.GlobalFontID||0:void 0,CachedFont:u.CachedFont});for(let e=a+1;e<=s;e++){const n=r[e],o=n.StartIndex-t;d.push({StartIndex:o,FontID:n.FontID||0,GlobalFontID:c?n.GlobalFontID||0:void 0,CachedFont:n.CachedFont})}return{Text:o,Fonts:e.Fonts,TextRuns:d}}function Yu(e,t){return e>=t.StartIndex&&e<t.EndIndex}function Ku(e,t,n){const o=[];for(let n=0;n<t.length;n++){const r=t[n];if(Yu(e,r))return n;r&&o.push({index:n,startIndex:r.StartIndex,endIndex:r.EndIndex})}const{text:r,formattedTextLength:i,isCarriageReturnExists:l}=n,a=Cc(r);throw Error(`Failed to find text run index for textOffsetIndex: ${e}, runs.length: ${t.length}, runsIndices: ${JSON.stringify(o)}, formattedTextLength: ${i}, isCarriageReturnExists:${l}, isGraphemeExists: ${(null==r?void 0:r.length)!==a.length} `)}function Ju(e,t,n){const o=e.CachedFont;e.ShrunkSize=o.Size*t,e.FontCss=Cl(o,e.ShrunkSize,n),e.WidthPx=e.WidthPx*t}function Zu(e,t,n){const o=t.CachedFont;t.ShrunkSize=n;const r=Nc(e,t.ShrunkSize,null==o?void 0:o.FontName),i=tu(r,t.Text);t.FontCss=Cl(o,t.ShrunkSize,e),t.MaxGlyphHeightPx=r,t.HeightPx=i}function Qu(e,t){let n=0,o=t,r=!1,i=!1;for(let l=t;l<e.length;l++){const t=e[l];if(t.Underline===Se.FontUnderline.None)break;t.Underline===Se.FontUnderline.Single?r=!0:t.Underline===Se.FontUnderline.Double&&(i=!0);const a=t.CachedFont;n=Math.max(n,t.ShrunkSize||a.Size),o=l}return{maxFontSize:n,sequenceEndRunIndex:o,hasMixedUnderlineTypes:r&&i}}function eh(e,t,n){return Qc(e,t.TextRuns,t.Text,n).totalSize}function th(e,t,n,o,r,i){return Wl(e,t,n,o&&!Bt(i)?i:r)}function nh(e,t,n,o,r){return o?n:r?t:e}function oh(e,t,n,o,r,i){let l=i,a=0,s=!1;return s=t===Se.FontVerticalAlignment.Subscript||t===Se.FontVerticalAlignment.Superscript,s&&(a=function(e,t,n,o,r,i){return i?function(e,t,n,o){switch(e){case Se.FontVerticalAlignment.Subscript:const r=_c(o);return n+t.baseline/2-r;case Se.FontVerticalAlignment.Superscript:return n-2*(t.middle-t.baseline);default:throw Error(`getYPositionForFontVerticalAlignmentRtf: Font vertical alignment ${e} is unexpected here`)}}(t,r,o,wd(n,e.CachedStyle.VerticalAlignment)):0}(e,t||Se.FontVerticalAlignment.None,n,o,r,s),l=!0),{subSuperOffsetY:a,hasVerticalAlignedFont:l,isFontVerticalAlignment:s}}function rh(e,t,n,o,r,i,l,a,s,d,c,u,h,g){let f=i,C=r;return h?function(e,t,n,o,r,i,l,a,s,d,c){var u,h;if(!n.JustifyDistributedLine)return;let g=t+(s?0:n.JustifyDistributedLine.Start.Offset);const f=g,C=!0===n.Strikethrough;ih(e,r,i,n.JustifyDistributedLine.Start,t,o,s,n.MaxGlyphHeightPx,l,C,a,d,c),g=t+(s?0:n.JustifyDistributedLine.Start.Offset+n.JustifyDistributedLine.Start.Width),(null===(u=n.JustifyDistributedLine)||void 0===u?void 0:u.Middle)&&(ih(e,r,i,n.JustifyDistributedLine.Middle,t,o,s,n.MaxGlyphHeightPx,l,C,a,d,c),g=t+(s?0:n.JustifyDistributedLine.Middle.Offset+n.JustifyDistributedLine.Middle.Width)),(null===(h=n.JustifyDistributedLine)||void 0===h?void 0:h.End)&&(ih(e,r,i,n.JustifyDistributedLine.End,t,o,s,n.MaxGlyphHeightPx,l,C,a,d,c),g=t+(s?0:n.JustifyDistributedLine.End.Offset+n.JustifyDistributedLine.End.Width)),s||n.Underline===Se.FontUnderline.None&&!n.Strikethrough||Cu(r,i,l,{clipRect:d,textPositionX:f,textPositionY:o,textWidth:g-f,partOfMixedUnderlineSequence:n.HasMixedUnderline},a,n.UnderlineWidth)}(e,r,l,i,t,n,o,l.CachedFont,u,d,g):(lh(e,t,n,l.Text,r,i,u,l.MaxGlyphHeightPx,o,!0===l.Strikethrough,l.CachedFont,d),u||l.Underline===Se.FontUnderline.None&&!l.Strikethrough||Cu(t,n,o,{clipRect:d,textPositionX:r,textPositionY:i,textWidth:l.WidthPx,containSubscript:c===Se.FontVerticalAlignment.Subscript,partOfMixedUnderlineSequence:l.HasMixedUnderline},l.CachedFont,l.UnderlineWidth),u?f=function(e,t,n,o,r){const i=r+1<o.length?Hu(!0,o,r+1).HeightPx:0;switch(e){case Se.VerticalAlignment.Top:return t-i;case Se.VerticalAlignment.Center:return t-(n.HeightPx+i)/2;case Se.VerticalAlignment.Bottom:case Se.VerticalAlignment.Justify:case Se.VerticalAlignment.Distributed:return t-n.HeightPx}}(n.CachedStyle.VerticalAlignment,i,l,a,s):C+=l.WidthPx),{offsetX:C,offsetY:f}}function ih(e,t,n,o,r,i,l,a,s,d,c,u,h){let g=r,f=i;l?f-=o.Offset:g+=o.Offset,lh(e,t,n,o.Text,g,f,l,a,s,d,c,u,h)}function lh(e,t,n,o,r,i,l,a,s,d,c,u,h){l?function(e,t,n,o,r,i,l,a,s,d,c,u){_u(e,t,n,o,i,r,l,a,s,d,c,u)}(e,t,n,o,r,i,a,s,d,c,u,h):e.fillText(o,r,i)}function ah(e,t){let n=0,o=t[0];for(let t=0;t<e.length;t++){const r=e[t].CachedFont;n=Math.max(n,r.Size),o.Size<n&&(o=r)}return o}function sh(e,t,n,o,r,i,l,a){r>0&&(e.fillText(t,n,o,r),fu(e,l,i,a,{textPositionX:n,textPositionY:o}))}function dh(e,t,n,o,r,i,l,a,s,d){dr(e,i),!d&&Lt(l)?Vu(e,a,l,n,o,r,t,i):!d||s||l.DisplayFormula||Po(l.PreviewText)?(e.fillText(n,o,r),fu(e,a,l,t,{textPositionX:o,textPositionY:r,clipRect:i})):$u(e,t,a,l,d,o,r,i),cr(e,i)}var ch;!function(e){e[e.Space=0]="Space",e[e.Word=1]="Word",e[e.HardBreak=2]="HardBreak",e[e.HardBreakCRLF=3]="HardBreakCRLF"}(ch||(ch={}));const uh="1".charCodeAt(0);function hh(e,t,n,o,r,i,l,a){return l?o?function(e,t,n,o,r,i,l){return r?{textRunsDrawingInformation:[],totalSize:i*n.length}:eu(e,o,n,!0,void 0,t)}(e,o.TextRuns,o.Text,t,i,r).totalSize:tu(a,n):o?eh(e,o,t):function(e,t,n,o,r){return r?o*n.length:(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TextWidthClientPhase1,t)?xc(e,n,!1,!0):e.measureText(n).width}(e,t,n,r,i)}function gh(e){switch(e){case Xe:case $e:return ch.Space;case Ye:return ch.HardBreak;case Ke:return ch.HardBreakCRLF}return ch.Word}function fh(e,t){return"\r"===e[t]&&t<e.length-1&&"\n"===e[t+1]?Ke:e[t]}function Ch(e,t){return t===ch.HardBreakCRLF?e+2:e+1}function mh(e,t,n){return!(!t||n!==ch.Word||e>t.length-1)&&t.charCodeAt(e)===uh}class ph{get width(){if(-1===this.cachedWidth)if(this.wordFormattedText){if(!this.formattedValue)throw Error("expected formattedValue to be set");this.cachedWidth=eh(this.ctx,this.formattedValue,this.model)}else this.cachedWidth=this.ctx.measureText(this.value).width;return this.cachedWidth}get value(){return this.cachedValue||(this.cachedValue=this.word.substring(0,this.prefixLength)),this.cachedValue}get formattedValue(){return this.wordFormattedText&&(this.cachedFormattedValue=Xu(this.wordFormattedText,0,this.prefixLength)),this.cachedFormattedValue}constructor(e,t,n,o,r){this.cachedWidth=-1,this.ctx=e,this.word=t,this.prefixLength=n,this.wordFormattedText=r,this.model=o}}class yh{item(e){let t=this.cachedItems[e];return t||(t=new ph(this.ctx,this.word,e+1,this.model,this.formattedText),this.cachedItems[e]=t),t}constructor(e,t,n,o){this.cachedItems=[],this.ctx=e,this.word=t,this.formattedText=o,this.model=n}}function Sh(e,t,n,o,r){if(0===t.length)return;const i=new yh(e,t,o,r),l={width:n,value:"IGNORED"};let a=mn(i,0,t.length,l,((e,t)=>e.width-t.width));a<0&&(a=~a,0!==a&&(a-=1));const s=i.item(a);return{width:s.width,value:s.value,remaining:t.substring(s.value.length),formattedRemaining:r?Xu(r,s.value.length):void 0}}function Rh(e,t,n,o,r,i,l,a,s){if(en(e,"canvas2dCtx","breakTextToLines"),""===t)return{textLines:[],tokensPerLine:[],requireClipping:!1};const d=Lt(l),c=d?ou(l,i):0,u=function(e,t,n,o,r,i,l,a){const s=[];let d=0;const c=n,u=null==a?void 0:a.BreakOp;for(;d<t.length;){const n=gh(fh(t,d));let a=Ch(d,n),h=fh(t,a),g=gh(h);for(;a<t.length&&n===g&&!mh(a,u,n);)a=Ch(a,n),h=fh(t,a),g=gh(h);const f=a-d,C=t.substring(d,a),m=l?Xu(l,d,a):void 0;let p=0;switch(n){case ch.Word:case ch.Space:p=hh(e,o,C,m,c,n===ch.Space,r,i);break;case ch.HardBreak:case ch.HardBreakCRLF:break;default:throw"breakToTextLines - textTokenizer - unexpected run type"}s.push({start:d,len:f,value:C,type:n,width:p}),d=a}return s}(e,t,r,i,d,c,a,s),h={text:t,tokens:u,maxWidth:n,unprocessedTokens:[],isSingleCharTooWide:!1,textLines:[],tokensPerLine:[],curLineStart:0,curLineWidth:0,lastFittingToken:void 0,isBreakTypeJustifyOrDistributed:(g=o,g===Fu.Justify||g===Fu.Distributed),containsThaiCharacters:!1,isVerticalText:d,textLineHeight:c};var g;for(let t=0;t<u.length;t++){const o=u[t];if(Dh(u,t),Eh(o))Ih(h,o,t);else if(Oh(o,n)){if(o.type===ch.Space&&!xh(u,t)){Fh(h,o,t);continue}wh(h,o)}else bh(h,o,t,e,i,a)}if(void 0!==h.lastFittingToken&&function(e){Lh(e),e.isSingleCharTooWide=Ph(e.lastFittingToken.width,e.lastFittingToken.len,e.maxWidth,e.isSingleCharTooWide)}(h),h.isBreakTypeJustifyOrDistributed&&h.textLines.length!==h.tokensPerLine.length)throw new Error(`breakTextToLines::breakTextToLines Mismatch in textLines and textTokenLines.\n      textTokenLines = ${h.tokensPerLine.length}, textLineLength = ${h.textLines.length}, MaxWidth = ${n}, Text = ${(0,Se.annonymize)(h.text)}`);return h.isBreakTypeJustifyOrDistributed&&(null==s?void 0:s.BreakOp)&&h.containsThaiCharacters&&(h.tokensPerLine=function(e){const t=[];for(let n=0;n<e.length;n++){const o=e[n];o.containsThaiCharacters?t.push(Nh(o.tokens)):t.push(o)}return t}(h.tokensPerLine)),{textLines:h.textLines,tokensPerLine:h.tokensPerLine,requireClipping:h.isSingleCharTooWide}}function wh(e,t){e.curLineWidth+=t.width,e.curLineWidth>e.maxWidth&&(Lh(e,t.width),e.curLineStart=t.start,e.curLineWidth=t.width),e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(t),e.lastFittingToken=t}function bh(e,t,n,o,r,i){if(t.type===ch.Space)return void Th(e,t,n);void 0!==e.lastFittingToken&&(e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(e.lastFittingToken),Lh(e));const l=i?Xu(i,t.start,t.start+t.len):void 0,a=e.isVerticalText?function(e,t,n){const o=[],r=Cc(e);let i=n,l=r[0];for(let e=1;e<r.length;e++)i+n>t?(o.push({value:l,size:i}),i=n,l=r[e]):(i+=n,l+=r[e]);return l&&i>0&&o.push({value:l,size:i}),o}(t.value,e.maxWidth,e.textLineHeight):function(e,t,n,o,r){const i=[];let l=Sh(e,t,n,o,r);for(;l;)i.push({value:l.value,size:l.width}),l=Sh(e,l.remaining,n,o,l.formattedRemaining);return i}(o,t.value,e.maxWidth,r,l);let s=t.start;for(let t=0;t<a.length-1;t++){const n=a[t],o={text:n.value,width:n.size,underlineWidth:n.size,startIndex:s,endIndex:s+n.value.length};if(s+=n.value.length,e.textLines.push(o),e.isBreakTypeJustifyOrDistributed){const t=ko(n.value);e.tokensPerLine.push({tokens:[{text:n.value,width:n.size,start:s,containsThaiCharacters:t}],containsThaiCharacters:t}),zh(e,t)}e.isSingleCharTooWide=Ph(o.width,o.text.length,e.maxWidth,e.isSingleCharTooWide)}const d=function(e,t){const n=e[e.length-1],o=t.start+t.len-n.value.length,r=n.size;return{start:o,len:n.value.length,value:n.value,type:ch.Word,width:r}}(a,t);e.lastFittingToken=d,e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(d),e.curLineWidth=e.lastFittingToken.width,e.curLineStart=e.lastFittingToken.start}function Ih(e,t,n){void 0!==e.lastFittingToken&&Lh(e);let o=function(e){switch(e.type){case ch.HardBreak:return e.len;case ch.HardBreakCRLF:return e.len/2;default:throw"breakToLines - this token should be hardBreak token"}}(t);0!==n&&n!==e.tokens.length-1&&o--;for(let n=0;n<o;n++)e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push(je),e.textLines.push(vh(n,t));e.curLineStart=t.start+t.len,e.curLineWidth=0,e.lastFittingToken=void 0}function vh(e,t){const n=t.start+e,o=n+function(e){return e.type===ch.HardBreakCRLF?Ke.length:Ye.length}(t);return{text:"",width:0,underlineWidth:0,startIndex:n,endIndex:o}}function Fh(e,t,n){if(kh(t),1===t.len)return e.curLineWidth+=t.width,void(e.lastFittingToken=t);!function(e,t,n){return Mh(e.tokens,n),!!Ah(e,n)&&(n===e.tokens.length-1||e.curLineWidth+t.width>e.maxWidth||Hh(e,t,n))}(e,t,n)?e.curLineWidth+t.width>e.maxWidth||Hh(e,t,n)?Th(e,t,n):(e.curLineWidth+=t.width,e.lastFittingToken=t):Bh(e,t)}function Th(e,t,n){kh(t);const o=t.width/t.len,r=e.maxWidth-e.curLineWidth;if(r<0)return;const i=Math.floor(r/o);t.width=o*i,e.curLineWidth+=t.width,e.lastFittingToken=t,(xh(e.tokens,n)||Ah(e,n))&&Bh(e,t)}function Dh(e,t){if(Mh(e,t),!e[t])throw"breakTextToLines - validateToken - tokens[index] is undefined"}function xh(e,t){return Mh(e,t),Dh(e,t),0===t&&e[t].type===ch.Space}function Ah(e,t){const n=e.tokens;return Mh(n,t),t>0&&n[t].type===ch.Space&&Eh(n[t-1])&&void 0===e.lastFittingToken}function Bh(e,t){if(t.type!==ch.Space)throw"breakTextToLines - addEmptyLineToTextLines - wrong token type, this function should get only spaces token";const n=_object_spread({},_e),o=t.start+t.len;n.underlineWidth=t.width,n.startIndex=t.start,n.endIndex=o,e.textLines.push(n),e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push(je),e.curLineStart=o,e.curLineWidth=0,e.lastFittingToken=void 0}function Hh(e,t,n){if(kh(t),n>=e.tokens.length-1)return!1;const o=e.tokens[n+1];return e.curLineWidth+t.width+o.width>e.maxWidth}function Mh(e,t){if(t<0||t>=e.length)throw"breakTextToLines - invalid token index"}function Ph(e,t,n,o){if(o)return!0;if(e>n){if(1!==t)throw"breakTextToLines - non single char line is too wide!";return!0}return o}function Oh(e,t){return e.width<t}function kh(e){if(e.type!==ch.Space)throw"breakTextToLines - wrong token type, expected spaces token!"}function Eh(e){return e.type===ch.HardBreak||e.type===ch.HardBreakCRLF}function Lh(e,t=0){en(e.lastFittingToken,"lineBreakCtx.lastFittingToken","createCurrentFittingLine");const n=e.curLineWidth-t;let o=n;if(e.lastFittingToken.type===ch.Space&&(o-=e.lastFittingToken.width),e.isBreakTypeJustifyOrDistributed){const t=function(e){const t=[];let n=!1;for(let o=0;o<e.length;o++){const r=e[o],i=ko(r.value);t.push({text:r.value,width:r.width,start:r.start,containsThaiCharacters:i}),i&&!n&&(n=!0)}return{tokens:t,containsThaiCharacters:n}}(e.unprocessedTokens);e.tokensPerLine.push(t),zh(e,t.containsThaiCharacters),e.unprocessedTokens=[]}const{text:r,start:i,end:l}=function(e){if(void 0===e.lastFittingToken)throw"breakTextToLines -invalid lastFittingToken - no token was set";const t=e.lastFittingToken.start+e.lastFittingToken.len;return{text:e.text.substring(e.curLineStart,t).trimRight(),start:e.curLineStart,end:t}}(e);e.textLines.push({text:r,underlineWidth:n,width:o,startIndex:i,endIndex:l})}function Nh(e){const t={tokens:[],containsThaiCharacters:!0};let n;for(let i=0;i<e.length;i++){const l=e[i];ko(l.text)?n?(r=l,n={text:(o=n).text+r.text,width:o.width+r.width,start:o.start,containsThaiCharacters:o.containsThaiCharacters||r.containsThaiCharacters}):n=l:(n&&(t.tokens.push(n),n=void 0),t.tokens.push(l))}var o,r;return n&&t.tokens.push(n),t}function zh(e,t){!e.containsThaiCharacters&&t&&(e.containsThaiCharacters=!0)}function Gh(e,t,n,o,r,i,l,a,s,d,c,u,h){d?$u(e,t,n,o,d,l,a,c,u,h):Lt(o)?Vu(e,n,o,i,l,a,t,c,s):r?e.fillText(i,l,a):e.fillText(i,l,a,s)}function Wh(e,t,n,o,r){let i=n-function(e,t,n){const o=wl(t),r=!Bt(t.WrapText)||Rl(t),i=fd(e,t)?hd(e,t,n.zoom,n.devicePixelRatio):0;return kc(e,t,o,t.CachedFont.Italic,0,r,i)}(o,e,r);return t===Fu.Distributed&&(i-=Hc(e.CachedStyle.Indentation||0)),i}function Vh(e){var t;return Lt(e)?function(e){switch(e){case Se.VerticalAlignment.Justify:return Fu.Justify;case Se.VerticalAlignment.Distributed:return Fu.Distributed;default:return Fu.Wrap}}(e.CachedStyle.VerticalAlignment):function(e){switch(e){case Se.HorizontalAlignment.Justify:return Fu.Justify;case Se.HorizontalAlignment.JustifyDistributed:case Se.HorizontalAlignment.Distributed:return Fu.Distributed;default:return Fu.Wrap}}((null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)||Se.HorizontalAlignment.Automatic)}function _h(e,t,n,o,r,i,l,a,s,d,c,u,h,g,f,C){const m=r.tokensPerLine[i].tokens,p=a.lineDirection===Tu.Horizontal?Wl(n,o,l,c):d;if(u)return void Gh(e,t,n,o,s,g,l,d,c,u,h,m,a);const y=Mu(a,m),S=Au(a,m,Bu(m,a),y);if(!S)return;const{textPortionOffsetX:R,textPortionOffsetY:w}=Uh(a,S.Start,l,d,p);if(Gh(e,t,n,o,s,S.Start.Text,R,w,c,u,h),S.Middle){const{textPortionOffsetX:r,textPortionOffsetY:i}=Uh(a,S.Middle,l,d,p);Gh(e,t,n,o,s,S.Middle.Text,r,i,c,u,h)}if(S.End){const{textPortionOffsetX:r,textPortionOffsetY:i}=Uh(a,S.End,l,d,p);Gh(e,t,n,o,s,S.End.Text,r,i,c,u,h)}if(!C&&a.lineDirection!==Tu.Vertical){const e=r.textLines[i],s=function(e,t,n,o,r){switch(e){case Fu.Justify:return o?t.underlineWidth:n;case Fu.Distributed:return o&&1===r?t.underlineWidth:n;case Fu.Wrap:default:return t.underlineWidth}}(a.breakType,e,a.maxWidth,a.isProcessingLastLine,m.length);Cu(n,o,t,{textPositionX:a.lineDirection===Tu.Horizontal?p+y:l,textPositionY:f,textWidth:s,clipRect:h},o.CachedFont)}}function Uh(e,t,n,o,r){let i=n,l=o;return e.lineDirection===Tu.Horizontal?i=r+t.Offset:e.lineDirection===Tu.Vertical&&(l=r-t.Offset),{textPortionOffsetX:i,textPortionOffsetY:l}}const jh="Yu Gothic",qh=6,$h="ltr",Xh="start",Yh=14;function Kh(e,t){return{fontColor:e?Vn(e.TextColor):We,fontProperties:"",direction:Zh(t),textBaseline:"bottom",textAlign:"start"}}function Jh(e,t,n,o,r){const i=function(e,t){if(Lt(t))return"center";const n=Gl(e,t);switch(n){case Se.HorizontalAlignment.Right:return"right";case Se.HorizontalAlignment.CenterAcrossSelection:case Se.HorizontalAlignment.Center:return"center";case Se.HorizontalAlignment.Left:return"left";default:throw Error(`getTextAlignment: unsupported horizontalAlignment: ${n}`)}}(o,n);t.textAlign!==i&&(t.textAlign=i,e.textAlign=i);const l=Ht;l!==t.textBaseline&&(e.textBaseline=l,t.textBaseline=l);const a=fl(n,o);t.fontProperties===a&&e.font===a||(t.fontProperties=a,e.font=a);const s=function(e,t,n){var o;return t?pr(e,t):(0,Se.isChangeGateEnabled)(Se.ChangeGate.PreviewCellsSettings)&&e.PreviewText&&(null===(o=n.ClientOnlyCache.PreviewCellsSettings)||void 0===o?void 0:o.RetainCellTextOnPreview)&&!e.RetainTextOnPreview?Ve:e.HasError?st:e.CachedFont.Color}(n,r,o);t.fontColor!==s&&(t.fontColor=s,e.fillStyle=s);const d=function(e,t){switch(e){case Se.ReadingOrderType.RightToLeft:return"rtl";case Se.ReadingOrderType.LeftToRight:return"ltr";case Se.ReadingOrderType.Context:return Zh(t);default:throw Error(`getCanvasDirection: unsupported readingOrder: ${e}`)}}(n.CachedStyle.ReadingOrder||Se.ReadingOrderType.Context,o.IsRtl);d!==t.direction&&(t.direction=d,e.direction=d)}function Zh(e){return e?"rtl":"ltr"}function Qh(e,t,n){return!!t||n||Nl(e)||Lt(e)||!!e.DisplayFormula||Po(e.PreviewText)}function eg(e){return!e.DisplayFormula&&!Po(e.PreviewText)&&!!e.Spill}function tg(e){var t;return!e.DisplayFormula&&!Po(e.PreviewText)&&!!e.WrapText&&function(e){return!!Lt(e)||(zl(e)||yc(e.CachedStyle.VerticalAlignment)?!(e.CachedIsTextWidthExceedsCellWidth&&e.ValueType===Se.CellValueType.Number):!(e.ValueType===Se.CellValueType.Number))}(e)&&!((null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)===Se.HorizontalAlignment.Fill)}function ng(e,t,n,o,r){const i=n+o-r;return Lt(t)?function(e,t,n){const o=function(e,t,n,o,r,i){const l=qu(e,t,n,void 0,r,i);return{adjustedOffsetY:l.adjustedOffsetY,textHeight:l.textHeight}}(e,t,t.Text,0,n,ql(e,t,!0));return o.adjustedOffsetY-o.textHeight}(e,t,i):Al(e,t.CachedStyle,t.CachedFont)?o-r:i}function og(e,t){if(!e.PhoneticTextRuns)return e.Text?e.Text:"";let n="",o=0;for(let r=0;r<e.PhoneticTextRuns.length;r++){const i=e.PhoneticTextRuns[r];o<i.BaseStartIndex&&(n+=t.substring(o,i.BaseStartIndex)),n+=e.Text.substring(i.PhoneticStartIndex,i.PhoneticStartIndex+i.PhoneticLength),o=i.BaseStartIndex+i.BaseTextLength}return o<t.length&&(n+=t.substring(o)),n}function rg(e,t,n,o,r,i){if(!n.PhonInfo||!n.PhonInfo.Text)return;if(function(e){return e.TextRuns||e.WrapText||Lt(e)}(n)||n.PhonInfo&&!n.PhonInfo.PhoneticTextRuns){let l=i;l||(n.TextRuns?(e.save(),l=Yc(e,t,n),e.restore()):l=Yc(e,t,n));const a=lg(t,n,l,r),s=og(n.PhonInfo,n.Text);return e.fillText(s,a,o),void Wi("drawPhoneticText: Row:"+n.Row.toString()+" Col:"+n.Col.toString())}const{phoneticTextRuns:l,textRuns:a}=function(e){const t=[],n=[];if(!e.PhonInfo||!e.PhonInfo.PhoneticTextRuns)return{phoneticTextRuns:t,textRuns:n};let o=0;for(let d=0;d<e.PhonInfo.PhoneticTextRuns.length;d++){var r;const c=e.PhonInfo.PhoneticTextRuns[d];if(o<c.BaseStartIndex){var i,l;const r={FontID:null!==(l=null===(i=e.CachedFont)||void 0===i?void 0:i.ID)&&void 0!==l?l:0,StartIndex:o,EndIndex:c.BaseStartIndex,IsSpecialCharTextRun:!1,CachedFont:e.CachedFont};n.push(r),t.push({BaseStartIndex:o,PhoneticStartIndex:0,BaseTextLength:c.BaseStartIndex-o,PhoneticLength:0})}var a,s;const u={FontID:null!==(a=null===(r=e.CachedFont)||void 0===r?void 0:r.ID)&&void 0!==a?a:0,StartIndex:c.BaseStartIndex,EndIndex:c.BaseStartIndex+(null!==(s=c.BaseTextLength)&&void 0!==s?s:0),IsSpecialCharTextRun:!1,CachedFont:e.CachedFont};n.push(u),t.push(c),o=c.BaseStartIndex+c.BaseTextLength}return{phoneticTextRuns:t,textRuns:n}}(n);e.save();const s=Qc(e,a,n.Text,t,void 0);e.restore();let d=lg(t,n,s.totalSize,r);for(let t=0;t<l.length;t++){const r=l[t];if(s.textRunsDrawingInformation[t]){if(0!==r.PhoneticLength){const t=n.PhonInfo.Text.substr(r.PhoneticStartIndex,r.PhoneticLength);e.fillText(t,d,o)}var c;d+=null!==(c=s.textRunsDrawingInformation[t].WidthPx)&&void 0!==c?c:0}}}function ig(e,t,n){const o=yl(!1,!1);e.font=pl(t,o,qh,jh);const r=Kh(n,t.IsRtl);e.fillStyle=r.fontColor,e.direction=$h,e.textAlign=Xh}function lg(e,t,n,o){if(Al(e,t.CachedStyle,t.CachedFont))return t.CachedDrawingLayout.TextOrientationLayout.Angle>0?-n:0;if(Lt(t)||t.WrapText){const n=Mc(t,e,o.zoom,o.devicePixelRatio);return $l(e,t,e.BlockWidth)+n}return th(e,t,Xc(e,t,o),!1,n,void 0)}function ag(e,t){return!(!t||!gr(t,e.renderingRegion)||tg(t)||Po(t.PreviewText)||t.ShowSkeleton||!t.Text||!t.PhonInfo||t.PhonInfo.Text===qe)}function sg(e,t,n,o){const r=function(e,t){const n=ou(t,e),o=Yh,r=ql(e,t,!0),i=Ac(e,t,n,r,!!t.DisplayFormula),{absoluteY:l,lastTextLineAlphabeticBaselineOffset:a}=zc(t,e,n+o,r,i,void 0);return ng(e,t,l,a,n)}(t,o),i=function(e,t,n,o){const r=eg(t),i=tg(t),l=jl(e,t,!0),a=ql(e,t,!0),s=Kl(e,t),d=function(e,t,n,o,r,i,l,a){var s;const d=$l(e,t,e.BlockWidth),c=Kl(e,t),u=void 0!==(null===(s=t.CondFormat)||void 0===s?void 0:s.Icon);if(t.Merge||n)return Oc(e,d,c,r,i,l,u);if(o){const n=vd(t),o=Sr(aa(t,e),l,n);return{x:da(t,e,l,n),y:a,width:o,height:i}}return Oc(e,d,c,r,i,l,u)}(e,t,i,r,l,a,su(e,t,n,o),s);return d}(t,o,n.zoom,n.devicePixelRatio);dr(e,i),function(e,t,n){if(Al(t,n.CachedStyle,n.CachedFont)){const t=n.CachedDrawingLayout.TextOrientationLayout;Ml(e,t.TranslateX,t.TranslateY,t.Angle),e.textAlign="left"}}(e,t,o),rg(e,t,o,r,n),function(e,t,n){Al(t,n.CachedStyle,n.CachedFont)&&(e.restore(),e.textAlign=Xh)}(e,t,o),cr(e,i)}function dg(e,t,n,o,r,i,l,a,s,d,c,u,h){var g;const f=Lt(o),C=Vh(o),m=f?(p=d,y=Wu((null===(g=o.CachedStyle)||void 0===g?void 0:g.Indentation)||0),Math.max(0,p-Le-y)):d;var p,y;if(m<=0||l<=0)return;const S=Wh(o,C,f?m:l,n,t),R=f?u:e.measureText($e).width,w=Rh(e,r,S,C,R,n,o,h,o.WrapText),b=nu(o);f&&function(e,t,n){var o;(null===(o=e.CachedStyle)||void 0===o?void 0:o.ReadingOrder)!==Se.ReadingOrderType.RightToLeft&&n.HasLtr&&!n.HasBidi&&(t.textLines=t.textLines.reverse(),t.tokensPerLine=t.tokensPerLine.reverse())}(o,w,b);const I=w.textLines,{rowsBottomY:v,rowsAlphabeticY:F,textHeight:T,formattedLines:D}=function(e,t,n,o){const r=[];let i=[],l=[];i=[0],l=[0];let a=0;if(n)for(let o=0;o<t.length;o++){const s=t[t.length-1-o],d=Xu(n,s.startIndex,s.endIndex);r[o]=d;const c=lu(e,d);l[o]=c.baseline;const u=iu(e,d);i[o+1]=i[o]+u,a+=u}else i=function(e,t){const n=[];for(let o=0;o<e;o++)n.push(o*t);return n}(t.length,o),a=o*t.length;return{rowsBottomY:i,rowsAlphabeticY:l,textHeight:a,formattedLines:r}}(n,I,h,u),x=!Bt(o.PhonInfo),A=w.requireClipping||c||x||function(e,t,n,o){return e&&t<n*o}(f,s,u,I.length);let B;A&&(B=a);const H=e.textAlign,M=e.textBaseline;let P=!1;var O;zl(o)&&!f&&(e.textAlign="left",e.textBaseline="alphabetic",P=!0,b.HasRtl&&function(e,t,n,o){if(!n.HasRtl||n.HasLtr)!function(e,t,n,o){const r=yr(n,o);for(let o=0;o<e.textLines.length;o++){const i=e.textLines[o],l=e.tokensPerLine[o],a=ws(i.text,t);if(n.HasBidi)if(a.HasRtl&&!a.HasLtr)l.tokens.reverse();else{const e=document.createElement("div");e.setAttribute(Du,o.toString());for(let t=0;t<l.tokens.length;t++){const n=l.tokens[t].text,o=document.createElement("span");o.innerText=n,o.setAttribute(xu,t.toString()),e.appendChild(o)}r.appendChild(e)}}document.body.appendChild(r);for(let t=0;t<r.children.length;t++){const n=r.children[t],o=n.getAttribute(Du);if(!o)throw Error("reorderTextTokensUsingDom: textLineIndexAttr is undefined");const i=parseInt(o,10),l=e.tokensPerLine[i].tokens;for(let e=0;e<n.children.length;e++){const t=n.children[e],o=t.getAttribute(xu);if(!o)throw Error("reorderTextTokensUsingDom: tokenIndexAttr is undefined");const r=t.getBoundingClientRect().left;l[parseInt(o,10)].OffsetX=r}l.sort(((e,t)=>e.OffsetX-t.OffsetX))}document.body.removeChild(r)}(e,t,n,o);else for(let t=0;t<e.tokensPerLine.length;t++)e.tokensPerLine[t].tokens.reverse()}(w,(null===(O=o.CachedStyle)||void 0===O?void 0:O.ReadingOrder)||Se.ReadingOrderType.Context,b,S));const k=x?Yh:0,E=f?o.CachedStyle.VerticalAlignment:Sc(o.CachedStyle.VerticalAlignment,pc.WrapText,d,T,u,I.length,o.DisplayFormula),L=f?Nt(o):yc(E),N=L&&I.length>1&&!f?function(e,t,n){return(e-t)/(n-1)}(d,T,I.length):0;!function(e,t){t&&dr(e,t)}(e,B);const z=F[0],G=zc(o,n,T+k,d,E,z),W=G.absoluteY;let V=f?function(e,t,n,o,r,i){const l=function(e,t,n,o,r){if(1===r&&zt(t)){var i;const o=Mc(t,e,n.zoom,n.devicePixelRatio);switch((null===(i=t.CachedStyle)||void 0===i?void 0:i.HorizontalAlignment)||Se.HorizontalAlignment.Automatic){case Se.HorizontalAlignment.Distributed:return Bc(e,t,n.zoom,n.devicePixelRatio);case Se.HorizontalAlignment.Justify:case Se.HorizontalAlignment.JustifyDistributed:return $l(e,t,e.BlockWidth)+o}}return o}(e,t,n,o,i);return function(e,t,n,o,r){switch(Gl(e,t)){case Se.HorizontalAlignment.Right:return n-o*(r-1);case Se.HorizontalAlignment.CenterAcrossSelection:case Se.HorizontalAlignment.Center:return n-o*(r-1)/2;default:case Se.HorizontalAlignment.Left:return n}}(e,t,l,r,i)}(n,o,t,i,u,I.length):i,_=0;zt(o)&&(_=function(e,t,n,o,r){if(!zt(t)||1===o)return 0;const i=function(e,t){var n;return e.IsRtl&&(null===(n=t.PivotTable)||void 0===n?void 0:n.HasExpandCollapseIndicator)?vd(t):0}(e,t),l=n,a=Xl(e,t,e.BlockWidth)-Pc(e,t)-i-l-r*(o-1);return a<0?0:a/(o-1)}(n,o,V,I.length,u));const U=function(e,t,n,o,r){return e?zc(t,n,o,r,t.CachedStyle.VerticalAlignment,void 0).absoluteY:0}(f,o,n,u,d);for(let r=0;r<I.length;r++){const i=I.length-1-r,s=I[i],c=s.text;f&&r>0&&(V+=u+_);const g=f?U:cg(W,z,v[r],F[r],N,r,L,!Bt(h));C===Fu.Wrap?(Gh(e,t,n,o,A,c,V,g,l,D[r],a),h||f||Cu(n,o,t,{textPositionX:V,textPositionY:g,textWidth:s.underlineWidth,clipRect:a},o.CachedFont)):_h(e,t,n,o,w,i,V,{breakType:C,singleSpaceWidth:R,maxWidth:S,isProcessingLastLine:ug(f,b,i,I.length),isCompleteTextVisible:T<d,lineDirection:f?Tu.Vertical:Tu.Horizontal},A,g,S,D[r],a,c,g,!Bt(h))}try{var j;if(x)ig(e,n,t.highContrastScheme),rg(e,n,o,ng(n,o,W,G.lastTextLineAlphabeticBaselineOffset,T),t),(null===(j=o.PhonInfo)||void 0===j?void 0:j.Text)!==qe&&Wi("drawWrapText: PhoneticRendered")}catch(e){throw Wi("drawWrapText: Error in drawing phonetic: "+e),e}P&&(e.textAlign=H,e.textBaseline=M),function(e,t){cr(e,t)}(e,B)}function cg(e,t,n,o,r,i,l,a){let s=a?e+t-n-o:e-n;return l&&(s-=r*i),s}function ug(e,t,n,o){return e&&!t.HasRtl?0===n:n===o-1}function hg(e,t,n,o){const r=Ll(Hl(e.IsRtl,o.Orientation||0));return(0,Se.isChangeGateEnabled)(Se.ChangeGate.FixRotatedTextWidth)?t*Math.abs(Math.cos(r))+n*Math.abs(Math.sin(r)):Pl(t,n,r)}function gg(e,t,n,o){const r=function(e,t,n){en(n,"cell","getNumFmtSeparatorWidth");const o=fl(n,t);return hu(e,t,n,o),bc[o]}(e,o,t);r<0&&Vi("buildNumFmtHashesString:: Invalid hashWidth. hashWidth: "+r+" MeasuredWidth: "+cl(t.CachedFont.FontName)+", FontSize:"+t.CachedFont.Size);const i=mg(e,o,t,n,r,!0);let l="";return l+="#".repeat(i),l}function fg(e,t,n,o,r,i){let l=o.Start||"";try{l+=o.Separator.repeat(r),l+=o.End||""}catch(r){return Vi("buildNumFmtText:: Invalid separatorCount."+Cg(e,t,n,o,i)),o.Start||""+o.End||""}return l}function Cg(e,t,n,o,r){var i;const l=ja(null===(i=n.CachedFont)||void 0===i?void 0:i.FontName),a=!!l&&nl(fl(n,t));return(0,Se.annonymize)(o.Separator)+" CachedWidth: "+r+" MeasuredWidth: "+e.measureText(o.Separator).width+", IsSpace: "+(" "===o.Separator)+", FontName:"+cl(n.CachedFont.FontName)+", FontSize:"+n.CachedFont.Size+", Length: "+o.Separator.length+", MLetterWidth: "+e.measureText("M").width+", IsDocumentAttached: "+function(e){try{return e instanceof CanvasRenderingContext2D?document.contains(e.canvas):"Offscreen"}catch(e){return!1}}(e)+", isFontValid: "+l+", FontLoadCheck: "+a}function mg(e,t,n,o,r,i){let l=0;if(n.CachedFont.Italic&&i){const i=function(e,t,n){en(n,"cell","getOverhangHashWidth");const o=fl(n,t);return hu(e,t,n,o),Ic[o]}(e,t,n);l=Math.max(Math.floor((o-i)/r),0)}else l=Math.max(Math.floor(o/r),0);return(Bt(l)||isNaN(l)||l===1/0)&&(Vi(`calculateSeparatorCountInMaxWidth: Invalid count variable. hashCount: ${l}, cellWidth: ${o}, hashWidth: ${r} `),l=0),l}let pg;void 0===window.gridRendererStringsCounter?window.gridRendererStringsCounter=1:window.gridRendererStringsCounter++;const yg="cursor",Sg="tooltip",Rg="longpress",wg="pointermove",bg="pointerleave",Ig="pointerdown",vg="pointerup",Fg={x:-1,y:-1},Tg="unset",Dg="pointer",xg="default",Ag="grab",Bg="click",Hg="dblclick",Mg=e=>{var t;return t=e,en(di,"externalCallbacks","setLastInputMethod"),di.setLastInputMethod(t),!1},Pg=()=>!1,Og=()=>!0;function kg(e,t){var n;const o=null===(n=e.ClientOnlyCache)||void 0===n?void 0:n.RowOffsetsAdjustedForDrawing;if(o)return o[t]}function Eg(e,t){var n;const o=null===(n=e.ClientOnlyCache)||void 0===n?void 0:n.RowOffsetsAdjustedForDrawing;if(o)return o[t+1]}function Lg(e,t){var n;const o=null===(n=e.ClientOnlyCache)||void 0===n?void 0:n.ColOffsetsAdjustedForDrawing;if(o)return e.IsRtl?o[o.length-1]-o[t]:o[t]}function Ng(e,t){var n;const o=null===(n=e.ClientOnlyCache)||void 0===n?void 0:n.ColOffsetsAdjustedForDrawing;if(o)return e.IsRtl?o[o.length-1]-o[t+1]:o[t+1]}function zg(e,t,n,o){return{start:Math.max(e,n),end:Math.min(t,o)}}function Gg(e,t,n){return function(e,t,n){const{start:o,end:r}=zg(t.FirstColumn,t.LastColumn,e.FirstColumn,e.LastColumn);return _n((o-1)%wt,(r-1)%wt,n.startColumn,n.endColumn)}(e,t,n)&&function(e,t,n){const{start:o,end:r}=zg(t.FirstRow,t.LastRow,e.FirstRow,e.LastRow);return _n((o-1)%Rt,(r-1)%Rt,n.startRow,n.endRow)}(e,t,n)}let Wg,Vg=!1,_g=!1;function Ug(e,t){return!Bt(e.Hyperlink)&&!!gr(e,t.renderingRegion)}function jg(e,t,n,o){const r=function(e,t,n,o){const{leftX:r,width:i}=function(e,t,n,o){var r;if(qg(n)||!$g()&&n.Spill)return{leftX:Ql(t,n,!1,!1),width:Jl(t,n)};const i=Yc(e,t,n),l=function(e,t,n,o){var r;const i=Xc(e,t,n),l=(null===(r=t.CachedStyle)||void 0===r?void 0:r.HorizontalAlignment)||Se.HorizontalAlignment.Automatic;switch(l){case Se.HorizontalAlignment.Right:return i-o;case Se.HorizontalAlignment.Center:return i-o/2;case Se.HorizontalAlignment.Automatic:case Se.HorizontalAlignment.Left:return i;default:throw Error(`getHyperlinkBoundsOnTextRectLeftX: unsupported horizontalAlignment for hyperlinks on text rect: ${l}`)}}(t,n,o,i),a=i*o.scaleFactor,s=l*o.scaleFactor;if(!$g()&&!n.Spill)return{leftX:Math.max(Ql(t,n,!1,!1),s),width:Math.min(Jl(t,n),a)};if(null===(r=n.Spill)||void 0===r?void 0:r.IsSpillBlocked){const e=t.IsRtl?ga(n,t):fa(n),o=t.IsRtl?fa(n):ga(n,t),r=t.IsRtl?Ng(t,e):Lg(t,e),i=t.IsRtl?Lg(t,o):Ng(t,o);if(r&&i){const e=Math.max(r,s);return{leftX:e,width:Math.min(i,s+a)-e}}}return{leftX:s,width:a}}(e,t,n,o),{topY:l,height:a}=function(e,t,n){var o;if(qg(t)){const n=Zl(e,t);return{topY:ia(e,t,!1),height:n}}const r=ou(t,e)*n.scaleFactor,i=function(e,t,n){var o;const r=null===(o=t.CachedStyle)||void 0===o?void 0:o.VerticalAlignment;switch(r){case Se.VerticalAlignment.Bottom:return na(e,t)-n-Le;case Se.VerticalAlignment.Center:return oa(e,t)-n/2;case Se.VerticalAlignment.Top:return ia(e,t,!1);default:throw Error(`getHyperlinkBoundsOnTextRectTopY: unsupported verticalAlignment: ${r}`)}}(e,t,r);let l=r;const a=null===(o=t.CachedDrawingLayout)||void 0===o?void 0:o.UnderlineRuns;return a&&a.length>0&&(l=a[0].Y+a[0].LineWidth-i),{topY:Math.max(i,ia(e,t,!1)),height:Math.min(l,Zl(e,t))}}(t,n,o);return{x:r,y:l,width:i,height:a}}(e,t,n,o);!function(e,t,n,o){const r=_s(e,n,o,!1),i=(0,Se.getRenderingRegionHitTestCache)(e,no(n.renderingRegion)),l=()=>(en(di,"externalCallbacks","inRangePicker"),!di.inRangePicker()),a=e=>{const t=!!e.metaKey&&e.metaKey,n=!!e.ctrlKey&&e.ctrlKey;return Ho()?t:n};$g()?(Da(t,i,r,Se.RenderFeaturesZIndex.Hyperlink,(n=>(l()&&$g()&&bi&&bi(e.RowNumbers[t.Row],e.ColumnNumbers[t.Col],!0,n.clientX),!1))),xa(t,i,r,Se.RenderFeaturesZIndex.Hyperlink,(n=>($g()&&bi&&bi(e.RowNumbers[t.Row],e.ColumnNumbers[t.Col],!1,n.clientX),!1))),Fa(t,i,r,"pointer",Se.RenderFeaturesZIndex.Hyperlink,a)):(Fa(t,i,r,"pointer",Se.RenderFeaturesZIndex.Hyperlink,l),Ta(t,i,r,function(e){var t,n,o;return(null===(t=e.Hyperlink)||void 0===t?void 0:t.Tooltip)?null===(n=e.Hyperlink)||void 0===n?void 0:n.Tooltip:pg.hyperlinkToolTip?function(e,...t){return e.replace(/{(\d+)}/g,(function(e,n){return void 0!==t[n]?t[n]:e}))}(pg.hyperlinkToolTip,null===(o=e.Hyperlink)||void 0===o?void 0:o.Text):qe}(t),Se.RenderFeaturesZIndex.Hyperlink)),va(t,i,r,Se.RenderFeaturesZIndex.Hyperlink,(n=>{var o,r,i,s,d,c,u;if(l()&&!Vg)if($g()&&a(n)||!$g())if(null===(o=t.Hyperlink)||void 0===o?void 0:o.IsValidHyperlink){if(null===(r=t.Hyperlink)||void 0===r?void 0:r.IsHyperlinkExternal)c=n,u=null===(i=t.Hyperlink)||void 0===i?void 0:i.Text,en(di,"externalCallbacks","followHyperlink"),di.followHyperlinkCallback(c,u);else if(t.Hyperlink.InternalLink){const e=t.Hyperlink.InternalLink;!function(e,t,n,o,r,i,l){en(di,"externalCallbacks","handleGoTo"),di.handleGoToCallback(e,t,n,o,r,i,l)}(n,e.ObjectName,e.SheetName,e.FirstRow,e.FirstColumn,e.LastRow,e.LastColumn)}}else di.invalidHyperlinkCallback();else $g()&&(s=e.RowNumbers[t.Row],d=e.ColumnNumbers[t.Col],en(di,"externalCallbacks","showCtrlClickHyperlinkCallout"),di.showCtrlClickHyperlinkCallout&&di.showCtrlClickHyperlinkCallout(s,d));return $g()?(Vg=!0,setTimeout((()=>{Vg=!1}),500)):Vg=!1,!1}),"click"),function(e,t,n,o,r,i){const l={zIndex:o,region:Ba(n),onStart:r,onEnd:i};Aa(e,t.CellLongPressHitRegions,l)}(t,i,r,Se.RenderFeaturesZIndex.Hyperlink,(()=>{_g=!0}),(()=>{_g&&(Vg=!0),_g=!1})),va(t,i,r,Se.RenderFeaturesZIndex.Hyperlink,Pg,"touchend")}(t,n,o,r)}function qg(e){var t;const n=e.CachedStyle;if(Bt(n))throw Error("shouldHyperlinkEventsBeRegisteredOnFullCell: cell.CachedStyle is null");return!!(e.WrapText||n.ShrinkToFit||n.Indentation||n.VerticalText||yc(n.VerticalAlignment)||(o=n.HorizontalAlignment,o>Se.HorizontalAlignment.Right)||e.ValueType===Se.CellValueType.Number||e.TextRuns||(null===(t=e.LinkedEntity)||void 0===t?void 0:t.IconWidth)||e.RichValueIcon||e.HasIgnorableError||Bt(e.Text));var o}function $g(){return void 0===Wg&&(Wg=(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.HyperlinkImprovementSlice1",!1)),Wg}function Xg(e,t,n,o,r,i,l,a){var s;const d=function(e,t){switch(e){case Se.HorizontalAlignment.Distributed:case Se.HorizontalAlignment.Justify:case Se.HorizontalAlignment.Automatic:case Se.HorizontalAlignment.JustifyDistributed:return t?Se.HorizontalAlignment.Right:Se.HorizontalAlignment.Left;case Se.HorizontalAlignment.Left:case Se.HorizontalAlignment.Right:case Se.HorizontalAlignment.Center:return e;case Se.HorizontalAlignment.CenterAcrossSelection:case Se.HorizontalAlignment.Fill:default:throw Error(`getEffectiveHorizontalAlignmentForRotatedText: Unsupported horizontal alignment ${e}`)}}(null===(s=t.CachedStyle)||void 0===s?void 0:s.HorizontalAlignment,e.IsRtl),c=Ec(e,t,l,a),u=function(e,t){return e.Underline?function(e){return Math.abs(e)===pt}(t)?2*Le:Le:0}(t.CachedFont,i);return function(e,t,n,o,r,i,l,a,s){const d=a<0;switch(e){case Se.HorizontalAlignment.Left:return d?t+o*Math.abs(Math.sin(a))+r:t+l-o+r+i;case Se.HorizontalAlignment.Right:return d?n-l-r-i+o:n-o*Math.abs(Math.sin(a))-r;case Se.HorizontalAlignment.Center:return d?t+(s-l)/2+o:n-(s-l)/2-o;default:throw Error(`getRotatedTextHorizontalPosition: unsupported horizontalAlignment: ${e}`)}}(d,$l(e,t,e.BlockWidth),Xl(e,t,e.BlockWidth),r,c,u,o,i,n)}function Yg(e,t,n,o,r){en(e.CachedDrawingLayout,"CachedDrawingLayout","cacheOrientationLayout");const i={TranslateX:t,TranslateY:n,Angle:o,clipRect:r};e.CachedDrawingLayout.TextOrientationLayout=i}const Kg=1,Jg=.6,Zg=57944,Qg=57945,ef=9744,tf=9745,nf=16;function of(e,t,n,o,r,i){const l=function(e,t,n,o,r,i){return lf(e,t,n,r,i)||rf(e,t,o,r)}(e,t,n,o,r,i),a=t.Spill&&i;if(l)return{x:a?ea(e,t):Ql(e,t,!1,!1),y:ia(e,t,!1),width:a?sa(t,e)-Le:Jl(e,t)-Le,height:Zl(e,t)-Le}}function rf(e,t,n,o){return n>=na(e,t)-Le||n-o<=ia(e,t,!1)}function lf(e,t,n,o,r){var i;const l=e.IsRtl,a=t.Spill&&(r||(null===(i=t.PivotTable)||void 0===i?void 0:i.HasExpandCollapseIndicator));return n<=(a?ea(e,t):Ql(e,t,l,!1))||n+o>=(a?function(e,t){return!t.Spill&&e.IsRtl?ta(e,t,!1):Ql(e,t,!1,!1)+sa(t,e)-Le}(e,t):ta(e,t,!1)-Le)}function af(e,t){if(!t||t.length<2)return;const n=t[0];e.moveTo(n.x,n.y);for(let n=1;n<t.length;n++){const o=t[n];e.lineTo(o.x,o.y)}}function sf(e,t,n,o){const{x:r,y:i,width:l,height:a}=o,s=Le*n.scaleFactor,d=Ql(e,t,!1,!1),c=ta(e,t,!1),u=ia(e,t,!1),h=na(e,t)-s,g=df(r,d,c),f=df(i,u,h);let C=r+l;C=df(C,d,c);const m=C-((0,Se.isChangeGateEnabled)(Se.ChangeGate.UseClippedXCheckbox)?g:r);let p=i+a;return p=df(p,u,h),{x:g,y:f,width:m,height:p-f}}function df(e,t,n){return e>n?n:e<t?t:e}var cf;!function(e){e[e.ColoredArrowUp=0]="ColoredArrowUp",e[e.ColoredArrowUpRight=1]="ColoredArrowUpRight",e[e.ColoredArrowRight=2]="ColoredArrowRight",e[e.ColoredArrowDownRight=3]="ColoredArrowDownRight",e[e.ColoredArrowDown=4]="ColoredArrowDown",e[e.TriangleHigh=5]="TriangleHigh",e[e.TriangleMedium=6]="TriangleMedium",e[e.TriangleLow=7]="TriangleLow",e[e.GrayArrowUp=8]="GrayArrowUp",e[e.GrayArrowUpRight=9]="GrayArrowUpRight",e[e.GrayArrowRight=10]="GrayArrowRight",e[e.GrayArrowDownRight=11]="GrayArrowDownRight",e[e.GrayArrowDown=12]="GrayArrowDown",e[e.CircleHigh=13]="CircleHigh",e[e.CircleMedium=14]="CircleMedium",e[e.CircleLow=15]="CircleLow",e[e.SignMedium=16]="SignMedium",e[e.SignLow=17]="SignLow",e[e.FourCircleHigh=18]="FourCircleHigh",e[e.FourCircleMedium1=19]="FourCircleMedium1",e[e.FourCircleMedium2=20]="FourCircleMedium2",e[e.FourCircleLow=21]="FourCircleLow",e[e.TrafficHigh=22]="TrafficHigh",e[e.TrafficMedium=23]="TrafficMedium",e[e.TrafficLow=24]="TrafficLow",e[e.CircleSymbolHigh=25]="CircleSymbolHigh",e[e.CircleSymbolMedium=26]="CircleSymbolMedium",e[e.CircleSymbolLow=27]="CircleSymbolLow",e[e.FlagHigh=28]="FlagHigh",e[e.FlagMedium=29]="FlagMedium",e[e.FlagLow=30]="FlagLow",e[e.SymbolHigh=31]="SymbolHigh",e[e.SymbolMedium=32]="SymbolMedium",e[e.SymbolLow=33]="SymbolLow",e[e.StarHigh=34]="StarHigh",e[e.StarMedium=35]="StarMedium",e[e.StarLow=36]="StarLow",e[e.CircleFilled=37]="CircleFilled",e[e.Circle75=38]="Circle75",e[e.CircleHalf=39]="CircleHalf",e[e.Circle25=40]="Circle25",e[e.CircleEmpty=41]="CircleEmpty",e[e.QuadrantFull=42]="QuadrantFull",e[e.Quadrant75=43]="Quadrant75",e[e.QuadrantHalf=44]="QuadrantHalf",e[e.Quadrant25=45]="Quadrant25",e[e.QuadrantEmpty=46]="QuadrantEmpty",e[e.SignalBarEmpty=47]="SignalBarEmpty",e[e.SignalBarLow=48]="SignalBarLow",e[e.SignalBarMedium1=49]="SignalBarMedium1",e[e.SignalBarMedium2=50]="SignalBarMedium2",e[e.SignalBarHigh=51]="SignalBarHigh"}(cf||(cf={}));const uf=[[cf.ColoredArrowDown,cf.ColoredArrowRight,cf.ColoredArrowUp],[cf.GrayArrowDown,cf.GrayArrowRight,cf.GrayArrowUp],[cf.FlagLow,cf.FlagMedium,cf.FlagHigh],[cf.CircleLow,cf.CircleMedium,cf.CircleHigh],[cf.TrafficLow,cf.TrafficMedium,cf.TrafficHigh],[cf.SignLow,cf.SignMedium,cf.CircleHigh],[cf.CircleSymbolLow,cf.CircleSymbolMedium,cf.CircleSymbolHigh],[cf.SymbolLow,cf.SymbolMedium,cf.SymbolHigh],[cf.ColoredArrowDown,cf.ColoredArrowDownRight,cf.ColoredArrowUpRight,cf.ColoredArrowUp],[cf.GrayArrowDown,cf.GrayArrowDownRight,cf.GrayArrowUpRight,cf.GrayArrowUp],[cf.FourCircleLow,cf.FourCircleMedium1,cf.FourCircleMedium2,cf.FourCircleHigh],[cf.SignalBarLow,cf.SignalBarMedium1,cf.SignalBarMedium2,cf.SignalBarHigh],[cf.FourCircleLow,cf.CircleLow,cf.CircleMedium,cf.CircleHigh],[cf.ColoredArrowDown,cf.ColoredArrowDownRight,cf.ColoredArrowRight,cf.ColoredArrowUpRight,cf.ColoredArrowUp],[cf.GrayArrowDown,cf.GrayArrowDownRight,cf.GrayArrowRight,cf.GrayArrowUpRight,cf.GrayArrowUp],[cf.SignalBarEmpty,cf.SignalBarLow,cf.SignalBarMedium1,cf.SignalBarMedium2,cf.SignalBarHigh],[cf.CircleEmpty,cf.Circle25,cf.CircleHalf,cf.Circle75,cf.CircleFilled],[cf.StarLow,cf.StarMedium,cf.StarHigh],[cf.TriangleLow,cf.TriangleMedium,cf.TriangleHigh],[cf.QuadrantEmpty,cf.Quadrant25,cf.QuadrantHalf,cf.Quadrant75,cf.QuadrantFull]],hf=2,gf=1,ff=3,Cf=Math.PI/5,mf=Math.sin(Cf),pf=Math.sin(2*Cf),yf=Math.cos(Cf),Sf=Math.cos(2*Cf),Rf=.4,wf=1.5*Math.PI,bf=0,If=.5*Math.PI,vf=Math.PI,Ff=2*Math.PI,Tf=.375,Df=.5625,xf=.9375,Af=.125,Bf=.8125,Hf=.3125,Mf=.34375,Pf=.1875,Of=.53125,kf=0,Ef=.4,Lf=.575,Nf=.87,zf=.22,Gf=.775,Wf=.37,Vf=.91,_f=.4,Uf=.24,jf=.55,qf=.09,$f=.8125,Xf=.1875,Yf=.5,Kf=.6875,Jf=.3125,Zf=.25,Qf=.25,eC=.375,tC=.125,nC=.6,oC=2,rC=.4,iC=.325,lC=.625,aC=2,sC=.18,dC=.62,cC=.875,uC=.875,hC=.875,gC=.13,fC=Math.PI/4,CC=.305,mC=1-CC,pC=.5,yC=.325,SC=1-yC,RC=.125,wC=Math.tan(Math.PI/4),bC=.4,IC=.55,vC=.7,FC=.05*Math.PI,TC=.25*Math.PI,DC=.45*Math.PI;function xC(e,t){const n=e.RowHeights[t.Row]-Le;return Ac(e,t,ou(t,e),n,t.DisplayFormula)}function AC(e,t,n,o){var r,i;const l=Sc(xC(e,t),pc.CFIcon,void 0,void 0,void 0,void 0,t.DisplayFormula),a=HC(e,t,n,o,l),s=null===(i=t.CondFormat)||void 0===i||null===(r=i.Icon)||void 0===r?void 0:r.IconOnly,d=na(e,t)-ff,c=ia(e,t,!1)+ff+o;switch(l){case Se.VerticalAlignment.Bottom:return s?d:bd(a,c,d);case Se.VerticalAlignment.Top:return s?c:bd(a,c,d);case Se.VerticalAlignment.Center:return s||MC(e,t,a,o)?Math.floor(oa(e,t)+o/2):a;default:throw Error(`getIconVerticalPosition: Vertical alignment ${l} is not supported in CF Icon!`)}}function BC(e,t,n,o,r){var i,l;return(null===(l=t.CondFormat)||void 0===l||null===(i=l.Icon)||void 0===i?void 0:i.IconOnly)?function(e,t,n,o,r){const i=t.CondFormat.Icon.CFIconHorizontalAlignment;switch(i){case Se.HorizontalAlignment.Right:const l=Rd(o,r)+function(e,t,n,o){return t.PivotTable&&t.PivotTable.HasExpandCollapseIndicator&&Pd(t,Jl(e,t),o)&&n===Se.HorizontalAlignment.Right?(vd(t)+Ot)*o:0}(e,t,i,r)+n;return Math.floor(ta(e,t,!1)-l);case Se.HorizontalAlignment.Fill:case Se.HorizontalAlignment.Justify:case Se.HorizontalAlignment.CenterAcrossSelection:case Se.HorizontalAlignment.Distributed:case Se.HorizontalAlignment.JustifyDistributed:case Se.HorizontalAlignment.Automatic:case Se.HorizontalAlignment.Left:return Math.floor(Ql(e,t,!1,!1)+Rd(o,r));case Se.HorizontalAlignment.Center:return Math.floor(ra(e,t,!1)-n/2);default:throw Error(`getIconLeftOnlyPosition: unsupported horizontalAlignment: ${i}`)}}(e,t,n,o,r):(Nl(t)&&t.Spill?ea(e,t):Ql(e,t,!1,!1))+Rd(o,r)}function HC(e,t,n,o,r){const i=Vc(e,zc(t,e,ou(t,e),ql(e,t,!1),r,void 0).absoluteY,t.CachedFont,wl(t))*n+.5*o;return Math.round(i)}function MC(e,t,n,o){return na(e,t)-ff<n||ia(e,t,!1)+ff>n+o}function PC(e,t,n,o){(0,Se.verifyArgumentNotNull)(e,"ctx","drawInCellCheckboxControl"),(0,Se.verifyArgumentNotNull)(t,"model","drawInCellCheckboxControl"),(0,Se.verifyArgumentNotNull)(o,"context","drawInCellCheckboxControl"),(0,Se.verifyArgumentNotNull)(n,"cell","drawInCellCheckboxControl"),kC(n)?LC(e,t,n,o,!1):EC(n)&&LC(e,t,n,o,!0)}function OC(e){return kC(e)||EC(e)}function kC(e){return!!e.Text&&e.ValueType===Se.CellValueType.Boolean&&void 0!==e.Value}function EC(e){var t;return!e.Text&&!e.CachedDisplayText&&(null===(t=e.InCellControlOptions)||void 0===t?void 0:t.Type)===Se.InCellControlType.Checkbox}function LC(e,t,n,o,r){var i,l;const a=null!==(l=null===(i=n.CachedFont)||void 0===i?void 0:i.Size)&&void 0!==l?l:nf,s=xd(a,o.scaleFactor),d=function(e,t,n,o,r){const i=function(e,t,n,o,r){let i=Gl(e,t,!1);const l=Rd(o,r);switch(t.HorizontalAlignmentSet||(i=Se.HorizontalAlignment.Center),i){case Se.HorizontalAlignment.Fill:case Se.HorizontalAlignment.Justify:case Se.HorizontalAlignment.CenterAcrossSelection:case Se.HorizontalAlignment.Distributed:case Se.HorizontalAlignment.JustifyDistributed:case Se.HorizontalAlignment.Automatic:case Se.HorizontalAlignment.Left:return Math.floor(Ql(e,t,!1,!1)+l);case Se.HorizontalAlignment.Right:return Math.floor(ta(e,t,!1)-n-l);case Se.HorizontalAlignment.Center:return Math.floor(ra(e,t,!1)-n/2);default:throw Error(`getCheckboxIconHorizontalPosition: Horizontal alignment ${i} is not supported for checkbox icon!`)}}(e,t,r,o,n.scaleFactor),l=(0,Se.isChangeGateEnabled)(Se.ChangeGate.CellIconBottomPadding)?Math.round(r*vt):0,a=AC(e,t,n.scaleFactor,r);let s=a-r-l;return e.RowOffsets[t.Row+1]-a>s-e.RowOffsets[t.Row]&&(s+=l),{x:i,y:s,width:r,height:r}}(t,n,o,a,s),c=of(t,n,d.x,d.y,s,!1);dr(e,c),function(e,t,n,o,r,i){var l,a;!function(e,t,n,o,r){const i=e.globalAlpha,l=e.textAlign,a=e.textBaseline;e.textAlign="left",e.textBaseline="alphabetic",function(e,t,n,o){var r;const i=n.highContrastScheme;var l;e.fillStyle=i?Vn(i.TextColor):null!==(l=null===(r=t.CachedFont)||void 0===r?void 0:r.Color)&&void 0!==l?l:We,e.font=`${o.width}px ${It}`}(e,t,n,o);const s="1"===t.Value||"true"===t.Value;var d;const c=String.fromCharCode(null!==(d=function(e){const t=(0,Se.isChangeGateEnabled)(Se.ChangeGate.XLYellowFontLoadCheckNew)&&(0,Se.isFontRefactorFGV3Enabled)();return t&&!Xa(It,Oa.Loaded)||(0,Se.isChangeGateEnabled)(Se.ChangeGate.CheckboxFallbackFont)&&!t&&es(It)!==Oa.Loaded?e?tf:ef:e?Qg:Zg}(s))&&void 0!==d?d:Zg),{x:u,y:h,height:g}=o,f=h+g;e.globalAlpha=r,e.fillText(c,u,f),e.globalAlpha=i,e.textAlign=l,e.textBaseline=a}(e,n,o,r,i?Jg:Kg);(null===(l=n.FormulaInfo)||void 0===l?void 0:l.FormulaType)===Se.CellFormulaType.ArrayFormula||(null===(a=n.FormulaInfo)||void 0===a?void 0:a.FormulaType)===Se.CellFormulaType.Formula||function(e,t,n,o,r){const i=o.y+o.height;let l;l=_s(e,n,lf(e,t,o.x,o.width,!1)||rf(e,t,i,o.width)?sf(e,t,n,o):o,!1);const a=pg.inCellControlCheckboxTooltip?pg.inCellControlCheckboxTooltip:void 0;!function(e,t,n,o,r,i){let l;l=Se.ChangeGate.StopCursorChangeForCheckboxWhenComponentRangePicker?e=>!di.isEditingOrInComponentRangePicker():e=>!di.isEditing(),Fa(e,t,n,Dg,o,l),va(e,t,n,o,i,Bg),va(e,t,n,o,i,Hg),r&&Ta(e,t,n,r,o)}(t,(0,Se.getRenderingRegionHitTestCache)(e,no(n.renderingRegion)),l,Se.RenderFeaturesZIndex.CheckboxIcon,a,r)}(t,n,o,r,(e=>(hi(e,(0,Se.isPassRibbonCommandsToCanvasRendererEnabled)()?Ws().ToggleInCellControlCheckbox:t.RibbonCommands.ToggleInCellControlCheckbox,"",void 0,n.Row,n.Col),!0)))}(e,t,n,o,d,r),cr(e,c)}function NC(e,t){return!(null==e||e.DisplayFormula||t&&!gr(e,t.renderingRegion)||!e.InCellControlOptions||(0,Se.isChangeGateEnabled)(Se.ChangeGate.HideCheckboxOnShowFormula)&&t&&Ir(e,t)||(0,Se.isChangeGateEnabled)(Se.ChangeGate.CheckboxInCellImageCheck)&&e.InCellImage||e.InCellControlOptions.Type!==Se.InCellControlType.Checkbox||!OC(e))}function zC(e,t){if(t.save(),t.beginPath(),(0,Se.isPartialHeaderCellRenderingEnabled)())for(const[n]of e.ClientOnlyCache.DirtyCellsMap){const o=WC(e,n);o&&GC(t,o)}else for(let n=0;n<e.ClientOnlyCache.DirtyCellsKeys.length;n++){const o=WC(e,e.ClientOnlyCache.DirtyCellsKeys[n]);o&&GC(t,o)}t.strokeStyle="transparent",t.stroke(),t.clip()}function GC(e,t){const{x:n,y:o,width:r,height:i}=t;e.moveTo(n,o),e.lineTo(n+r,o),e.lineTo(n+r,o+i),e.lineTo(n,o+i),e.lineTo(n,o)}function WC(e,t){const{row:n,column:o}=(0,Se.getRowColFromCellKey)(t),r=Cr(o,e);return{x:e.IsRtl?r:r-Le,y:e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[n]-Le,width:rr(o,e.ClientOnlyCache.ColOffsetsAdjustedForDrawing)+Le,height:ir(n,e.ClientOnlyCache.RowOffsetsAdjustedForDrawing)+Le}}function VC(e,t,n,o){if(!(0,Se.isPartialHeaderCellRenderingEnabled)()||!t.isDifferentialRendering)return!0;const r=(0,Se.getCellLookupKey)(n.Row,n.Col),i=e.ClientOnlyCache.DirtyCellsMap.get(r);if(!i)throw new Error(`isCellAreaDirty: Checking dirty area "${o}" for a cell that is not dirty`);return 0!=(i&o)}function _C(e,t,n){!function(e,t,n){en(e,"ctx","drawCellsText"),en(t,"model","drawCellsText"),en(n,"context","drawCellsText"),en(t.RowOffsets,"model.RowOffsets","drawCellsText"),en(t.ColumnOffsets,"model.ColumnOffsets","drawCellsText"),en(t.RowHeights,"model.RowHeights","drawCellsText"),en(t.ColumnWidths,"model.ColumnWidths","drawCellsText"),en(t.Styles,"model.Styles","drawCellsText");const o=Yo(),r=t.ClientOnlyCache.CellsToRender,i=t.BlockWidth,l=[];let a,s=o?void 0:$C(e,n.highContrastScheme,t),d=-1;for(let f=0;f<r.length;f++){var c,u,h,g;const C=r[f];if(!C)continue;if(!VC(t,n,C,Se.DirtyGridCellArea.EntireCell))continue;if(Ir(C,n))continue;if((0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.InCellControls,t)&&NC(C))continue;if(!(C.Text||C.PreviewText||C.PreviewNumFmt)){if(!(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.FormulaViewCellImagesFix,t))continue;if(!n.isFormulaView||!C.FormulaInfo)continue}if(0===C.ShrunkSize||0===(null===(c=C.CachedFont)||void 0===c?void 0:c.Size))continue;if(!gr(C,n.renderingRegion))continue;if(C.CondFormat&&(null===(u=C.CondFormat)||void 0===u?void 0:u.Icon)&&(null===(g=C.CondFormat)||void 0===g||null===(h=g.Icon)||void 0===h?void 0:h.IconOnly))continue;if(C.ShowSkeleton)continue;const m=t.RowHeights[C.Row]-Le,p=t.RowOffsets[C.Row];if(C.Row!==d&&(o&&-1===d?s=$C(e,n.highContrastScheme,t):-1!==d&&(s=XC(n.highContrastScheme,t.IsRtl,e,a)),a={x:0,y:p,width:i,height:m},dr(e,a),d=C.Row),la(C))l.push(C);else if(YC(t,C)){const o=t.IsRow?53:At;zi(Gi.DrawHeaderCellTextDurationMs,(()=>{jC(e,t,C,n,m,o,s)}),!0,!0)}else zi(Gi.DrawSingleCellTextDurationMs,(()=>{UC(e,t,n,C,s,p,m)}),!0,!0)}cr(e,a),s=Kh(n.highContrastScheme,t.IsRtl);for(let o=0;o<l.length;o++){const r=l[o],i=ql(t,r,!1)-Le,a=Kl(t,r);UC(e,t,n,r,s,a,i)}}(e,t,n),function(e,t,n){zi(Gi.HyperlinkEventRegistrationMs,(()=>function(e,t,n){(0,Se.verifyArgumentNotNull)(e,"ctx","registerHyperlinkEventHandlers"),(0,Se.verifyArgumentNotNull)(t,"model","registerHyperlinkEventHandlers"),(0,Se.verifyArgumentNotNull)(n,"context","registerHyperlinkEventHandlers");const o=t.ClientOnlyCache.CellsToRender;let r="";for(let i=0;i<o.length;i++){const l=o[i];if(!Ug(l,n))continue;const a=fl(l,t);r!==a&&(r=a,e.font=a),jg(e,t,l,n)}}(e,t,n)))}(e,t,n)}function UC(e,t,n,o,r,i,l){var a,s;const{zoom:d,devicePixelRatio:c}=n;let u=-1;zi(Gi.DrawTextTextLineHeight,(()=>{u=ou(o,t)}),!0,!0);const h=Ac(t,o,u,l,o.DisplayFormula),g=(null===(a=o.CachedStyle)||void 0===a?void 0:a.HorizontalAlignment)===Se.HorizontalAlignment.Fill,f=jl(t,o,!1),C=su(t,o,d,c);let m=0;var p;zi(Gi.DrawTextTextMaxWidth,(()=>{var e;m=ar(f,Pc(t,o),C,Fd(null===(e=o.PivotTable)||void 0===e?void 0:e.HasExpandCollapseIndicator),gd(t,o,d,c))}),!0,!0),qC(t,o,e,m,g,r,n),o.PreviewNumFmt&&function(e,t,n,o){var r;if(en(n,"cell","updatePreviewTextFormatting"),en(n.CachedFont,"cell.CachedFont","updatePreviewTextFormatting"),en(t,"model","updatePreviewTextFormatting"),Bt(n.PreviewNumFmt)||Bt(n.PreviewNumFmt.Separator)||""===n.PreviewNumFmt.Separator)return;const i=(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TextWidthClientPhase1,t),l=xc(e,n.PreviewNumFmt.Start,!0,i),a=xc(e,n.PreviewNumFmt.End,!0,i),s=au(e,t,n,n.PreviewNumFmt);if(0===s){if(!$a(t,n))return;return void Vi("updatePreviewTextFormatting:: Invalid SeparatorWidth."+Cg(e,t,n,n.PreviewNumFmt,s))}const d=mg(e,t,n,o-l-a,s,"#"===(null===(r=n.PreviewNumFmt)||void 0===r?void 0:r.Separator));n.PreviewText=fg(e,t,n,n.PreviewNumFmt,d,s)}(e,t,o,m),o.CachedIndent!==(null===(s=o.CachedStyle)||void 0===s?void 0:s.Indentation)&&(m=ar(f,Pc(t,o),C,Fd(null===(p=o.PivotTable)||void 0===p?void 0:p.HasExpandCollapseIndicator),gd(t,o,d,c)));const y=o.PhonInfo?Yh:0,S=kn(o,t),R=On(S,o,t),w=eg(o),b=tg(o),I=function(e,t,n,o,r,i,l,a,s,d,c,u){var h;const g=$l(e,t,e.BlockWidth),f=Kl(e,t),C=!!(null===(h=t.CondFormat)||void 0===h?void 0:h.Icon)||!!t.RichValueIcon;return t.Merge||i?function(e,t,n,o,r,i,l,a,s,d,c,u){if(t.Merge&&(la(t)||r||Yc(n,e,t)>=o||Lt(t))||u)return Oc(e,a,s,i,l,d,c)}(e,t,n,o,r,a,s,g,f,d,C,i):l?function(e,t,n,o,r,i,l){var a;const s=aa(t,e);if(t.Spill.IsSpillBlocked||n||(null===(a=t.CachedStyle)||void 0===a?void 0:a.HorizontalAlignment)===Se.HorizontalAlignment.CenterAcrossSelection||r){const n=vd(t),r=Sr(s,o,n);return{x:da(t,e,o,n),y:i,width:r,height:l}}}(e,t,r,d,u,c,s):Qh(t,r,u)?Oc(e,g,f,a,s,d,C):void 0}(t,o,e,m,R,b,w,f,l,C,i,g);Al(t,o.CachedStyle,o.CachedFont)?function(e,t,n,o,r,i,l,a,s,d,c){var u;const h=Ll(Hl(t.IsRtl,null===(u=n.CachedStyle)||void 0===u?void 0:u.Orientation)),g=bl(n,d?ru(t,d.TextRuns):n.CachedFont,!0);tg(n)?function(e,t,n,o,r,i,l,a,s,d,c,u,h){const{zoom:g,devicePixelRatio:f}=o,C=El(n,i),m=s-Le-ft*C,p=m/a,y=Math.atan(p);let S=0;if(S=Math.abs(l)>=y?Math.round(m/Math.abs(Math.sin(l))):Math.round(a/Math.abs(Math.cos(l))),S<=0)return;const R=xc(e,$e,!1,!0),w=n.WrapText,b=Rh(e,r,S,Fu.Wrap,R,t,n,u,w).textLines,{textLinesHeight:I,linesAlphabeticOffset:v,formattedLines:F}=function(e,t,n,o,r,i){const l=[],a=[],s=[];let d=0;if(i){for(let t=0;t<n.length;t++){const o=n[t],c=Xu(i,o.startIndex,o.endIndex);l[t]=c;const u=lu(e,c);s[t]=u.baseline,d=iu(e,c),a[t]=d+r}return{textLinesHeight:a,linesAlphabeticOffset:s,formattedLines:l}}const c=t.CachedFont,u=wl(t),h=hs(c.FontName,u,e).baseline;for(let e=0;e<n.length;e++)a.push(o+r),s.push(h);return{textLinesHeight:a,linesAlphabeticOffset:s,formattedLines:l}}(t,n,b,d,c,u),T=function(e,t,n,o,r,i,l,a,s){const d=function(e,t,n){const o=e.length;if(1===o)return Pl(e[0].width,t[0],n);if(o>1){const o=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n));let i=e[0].width*o,l=0;for(let n=1;n<e.length;n++)l+=t[n]/r,i=Math.max(i,l+e[n].width*o);return i+t[0]}return 0}(n,o,l);return Xg(e,t,i,d,o[0]-r[0],l,a,s)}(t,n,b,I,v,a,l,g,f),D=function(e,t,n,o,r,i,l,a,s){const d=function(e){let t=0,n=0;for(let o=0;o<e.length;o++)e[o].width>n&&(n=e[o].width,t=o);return t}(n),c=Ol(n[d].width,o[d],l),u=Kl(e,t),h=Yl(e,t);return kl(t.CachedStyle.VerticalAlignment,a,s,c,i,u,h)-r[d]*Math.abs(Math.cos(l))}(t,n,b,I,v,s,l,C,Gc(t,n)),x=e.textAlign,A=e.textBaseline;dr(e,h),Ml(e,T,D,l),Yg(n,T,D,l,h);let B=0,H=0;const M=Math.abs(Math.cos(l))/Math.abs(Math.sin(l));for(let r=0;r<b.length;r++)r>0&&(H=H+v[r-1]+I[r]-v[r],B=H*M*(l<0?1:-1)),Gh(e,o,t,n,!0,b[r].text,B,H,a,F[r],h),u||Cu(t,n,o,{textPositionX:B,textPositionY:H,textWidth:b[r].underlineWidth,clipRect:h},n.CachedFont);const P=!Bt(n.PhonInfo);try{if(P&&b.length>0){var O;ig(e,t,o.highContrastScheme);const r=-(I[0]-c-v[0]);e.textAlign="left",rg(e,t,n,r,o,b[0].width),(null===(O=n.PhonInfo)||void 0===O?void 0:O.Text)!==qe&&Wi("drawWrapText: RotatedPhoneticRendered")}}catch(e){throw Wi("drawWrapText: Error in drawing rotated phonetic: "+e),e}e.restore(),e.textAlign=x,e.textBaseline=A,cr(e,h)}(e,t,n,o,r,g,h,i,l,a,s,d,c):function(e,t,n,o,r,i,l,a,s,d,c,u){var h;const{zoom:g,devicePixelRatio:f}=o,C=Yc(e,t,n),m=hs(null===(h=n.CachedFont)||void 0===h?void 0:h.FontName,i,t).baseline,p=function(e,t,n,o,r,i,l,a,s){return Xg(e,t,o,Pl(n,r,l),r-i,l,a,s)}(t,n,C,a,d,m,l,g,f),y=function(e,t,n,o,r,i,l,a,s){var d;const c=El(t,o),u=Ol(r,i,a),h=Kl(e,t),g=Yl(e,t);return kl(null===(d=t.CachedStyle)||void 0===d?void 0:d.VerticalAlignment,c,s,u,n,h,g)-l*Math.abs(Math.cos(a))}(t,n,s,i,C,d,m,l,Gc(t,n));dr(e,u),Ml(e,p,y,l),Yg(n,p,y,l,u),c&&!n.DisplayFormula?$u(e,o,t,n,c,0,0,u):(e.fillText(r,0,0),Cu(t,n,o,{textPositionX:0,textPositionY:0,textWidth:C,clipRect:u},n.CachedFont)),e.restore(),cr(e,u)}(e,t,n,o,r,g,h,i,l,a+s,d,c)}(e,t,o,n,S,m,l,u,y,R,I):function(e,t,n,o,r,i,l,a,s,d,c,u,h,g,f,C,m){const p=Xc(t,n,o),y=zc(n,t,a+s,r,u,void 0).absoluteY;g?(en(m,"clipRect","drawSingleCellText"),dg(e,o,t,n,c,p,l,m,sr(i),r,la(n),a,C)):n.Merge?function(e,t,n,o,r,i,l,a,s,d){var c;d?dh(e,t,i,l,a,d,o,n,(null===(c=o.CachedStyle)||void 0===c?void 0:c.HorizontalAlignment)===Se.HorizontalAlignment.Fill,r):sh(e,i,l,a,s,o,n,t)}(e,o,t,n,C,c,p,y,l,m):h?function(e,t,n,o,r,i,l,a,s,d,c){en(o.Spill,"cell.Spill","spillCells.drawSpillCellText");const u=aa(o,n);a?dh(e,t,r,i,l,a,o,n,s,c):sh(e,r,i,l,ar(u,Pc(n,o),d,vd(o),0),o,n,t)}(e,o,t,n,c,p,y,m,f,d,C):Qh(n,C,f)?(en(m,"clipRect","drawSingleCellText"),dh(e,o,c,p,y,m,n,t,f,C)):sh(e,c,p,y,l,n,t,o)}(e,t,o,n,l,f,m,u,y,C,S,h,w,b,g,R,I)}function jC(e,t,n,o,r,i,l){const a=n.CachedStyle.VerticalAlignment,s=Xc(t,n,o),d=zc(n,t,xt,r,a,void 0).absoluteY;qC(t,n,e,i,!1,l,o),sh(e,n.Text,s,d,i,n,t,o)}function qC(e,t,n,o,r,i,l){zi(Gi.DrawTextUpdateCellContext,(()=>{Jh(n,i,t,e,l.highContrastScheme)}),!0,!0),(0,Se.shouldOverrideText)(t)&&function(e,t,n,o,r,i){en(n,"cell","updateNumberFormattingInformation"),en(n.CachedFont,"cell.CachedFont","updateNumberFormattingInformation"),en(t,"model","updateNumberFormattingInformation");const l=(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TextWidthClientPhase1,t);if((0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TextWidthClientPhase1,t)&&n.TolType!==Se.TolType.Autofit&&n.ValueType!==Se.CellValueType.Error&&n.ValueType!==Se.CellValueType.Boolean)return;if(Lt(n))return;if(!Bt(n.NumFmt)&&!Bt(n.NumFmt.Separator)&&""!==n.NumFmt.Separator){var a,s;const r=xc(e,null===(a=n.NumFmt)||void 0===a?void 0:a.Start,!0,l),i=xc(e,null===(s=n.NumFmt)||void 0===s?void 0:s.End,!0,l);if(r+i>o&&!Rl(n))Bn(n,gg(e,n,o,t)),Zc(e,t,n);else{var d;const l=au(e,t,n,n.NumFmt);if(!_a())return;const a=$a(t,n);if(0===l&&!a)return;if(0===l)return void Vi("updateNumberFormattingInformation:: Invalid SeparatorWidth."+Cg(e,t,n,n.NumFmt,l));const s=mg(e,t,n,o-r-i,l,"#"===(null===(d=n.NumFmt)||void 0===d?void 0:d.Separator));Bn(n,fg(e,t,n,n.NumFmt,s,l))}return}let c=Math.round(Yc(e,t,n));if(Al(t,n.CachedStyle,n.CachedFont)&&(0,Se.isChangeGateEnabled)(Se.ChangeGate.FixRotatedTextWidth)&&(c=hg(t,c,ou(n,t),n.CachedStyle)),c>o&&!Rl(n)){var u;n.CachedIndent=0;const l=(null===(u=n.CachedStyle)||void 0===u?void 0:u.Indentation)?function(e,t,n,o){var r;const i=jl(e,t,!1),l=su(e,t,n,o);return ar(i,Pc(e,t),l,Fd(null===(r=t.PivotTable)||void 0===r?void 0:r.HasExpandCollapseIndicator),gd(e,t,n,o))}(t,n,r,i):o,a=gg(e,n,l,t);a!==n.CachedDisplayText&&(n.CachedIsTextWidthExceedsCellWidth=!0,Bn(n,a),Zc(e,t,n))}}(n,e,t,o,l.zoom,l.devicePixelRatio),r&&function(e,t,n,o){const r=n.Text;if(r){const i=function(e,t,n){const{zoom:o,devicePixelRatio:r}=n;return ar(t.Spill?aa(t,e):jl(e,t,!1),Mc(t,e,o,r),su(e,t,o,r),vd(t),gd(e,t,o,r))}(t,n,o),l=xc(e,r,!1,(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TextWidthClientPhase1,t));let a=Math.floor(i/l);a<1&&(a=1),(void 0===a||isNaN(a)||a===1/0)&&(Vi(`updateCachedDisplayTextForFill: Invalid count variable. repeatCount: ${a}, maxTextWidth: ${i}, textWidth: ${l} `),a=1),Bn(n,r.repeat(a))}}(n,e,t,l)}function $C(e,t,n){const o=Kh(t,n.IsRtl);return e.direction=o.direction,e.fillStyle=o.fontColor,e.textBaseline="bottom",e.strokeStyle="transparent",function(e){Array.isArray(e.getLineDash())&&0!==e.getLineDash().length&&e.setLineDash([])}(e),o}function XC(e,t,n,o){return cr(n,o),Kh(e,t)}function YC(e,t){return!Bt(e.IsRow)&&(!!e.IsRow||!t.IsCellSnapped&&vn(t.Col,e)>At)}function KC(e,t,n,o){en(n,"cell.CachedStyle.Gradient.Stops","createGradientFill");const r=function(e,t){const{x:n,y:o,width:r,height:i}=t;switch(e){case Se.GradientShadingStyle.Vertical:case Se.GradientShadingStyle.Center:case Se.GradientShadingStyle.TopRightCorner:return{x0:n,y0:0,x1:n+r,y1:0};case Se.GradientShadingStyle.ReversedVertical:case Se.GradientShadingStyle.TopLeftCorner:return{x0:n+r,y0:0,x1:n,y1:0};case Se.GradientShadingStyle.Horizontal:case Se.GradientShadingStyle.BottomRightCorner:case Se.GradientShadingStyle.BottomLeftCorner:return{x0:0,y0:o,x1:0,y1:o+i};case Se.GradientShadingStyle.ReversedHorizontal:return{x0:0,y0:o+i,x1:0,y1:o};case Se.GradientShadingStyle.DiagonalUp:case Se.GradientShadingStyle.DiagonalDown:case Se.GradientShadingStyle.ReversedDiagonalUp:case Se.GradientShadingStyle.ReversedDiagonalDown:return function(e,t){const n=t.width*t.width,o=t.height*t.height,r=n+o,i=t.x+t.width/2,l=t.y+t.height/2;let a=t.width*o/r,s=n*t.height/r;switch(e){case Se.GradientShadingStyle.DiagonalUp:break;case Se.GradientShadingStyle.DiagonalDown:a=-a;break;case Se.GradientShadingStyle.ReversedDiagonalUp:s=-s;break;case Se.GradientShadingStyle.ReversedDiagonalDown:a=-a,s=-s;break;default:throw Error("getDiagonalGradientLine:: Gradient shading style is not diagonal.")}return{x0:i-a,y0:l-s,x1:i+a,y1:l+s}}(e,t);default:throw Error("getGradientLine:: Gradient not supported")}}(t,o),i=e.createLinearGradient(r.x0,r.y0,r.x1,r.y1);for(let e=0;e<n.length;e++)i.addColorStop(n[e].Position,n[e].Color);return i}function JC(e,t,n,o,r,i){const l=ca(t,n,!1);if(o===QC.Gradient)return function(e,t,n,o){let r=KC(e,t.ShadingStyle,t.Stops,n);return r!==o&&(e.fillStyle=r),e.fillRect(n.x,n.y,n.width,n.height),function(e){switch(e){case Se.GradientShadingStyle.TopLeftCorner:case Se.GradientShadingStyle.TopRightCorner:case Se.GradientShadingStyle.BottomLeftCorner:case Se.GradientShadingStyle.BottomRightCorner:case Se.GradientShadingStyle.Center:return!0;default:return!1}}(t.ShadingStyle)&&(r=e.fillStyle=KC(e,function(e){switch(e){case Se.GradientShadingStyle.TopLeftCorner:case Se.GradientShadingStyle.TopRightCorner:return Se.GradientShadingStyle.ReversedHorizontal;case Se.GradientShadingStyle.BottomLeftCorner:return Se.GradientShadingStyle.ReversedVertical;case Se.GradientShadingStyle.BottomRightCorner:return Se.GradientShadingStyle.Vertical;case Se.GradientShadingStyle.Center:return Se.GradientShadingStyle.Horizontal;default:throw Error("getSecondPassShadingStyle:: Gradient shading style does not have a second pass.")}}(t.ShadingStyle),t.Stops,n),function(e,t,n){const{x:o,y:r,width:i,height:l}=n;switch(e.beginPath(),e.moveTo(o,r),e.lineTo(o+i,r),t){case Se.GradientShadingStyle.TopLeftCorner:case Se.GradientShadingStyle.BottomRightCorner:e.lineTo(o+i,r+l);break;case Se.GradientShadingStyle.TopRightCorner:case Se.GradientShadingStyle.BottomLeftCorner:e.lineTo(o,r+l);break;case Se.GradientShadingStyle.Center:e.lineTo(o,r+l),e.lineTo(o+i,r+l);break;default:throw Error("setSecondPassStencil:: Gradient shading style does not have a second pass.")}e.lineTo(o,r)}(e,t.ShadingStyle,n),e.fill()),r}(e,n.CachedStyle.Gradient,l,r);const a=function(e,t,n){return t===QC.FormulaParseError?"#FFFFFF":n&&e.CachedStyle.BackgroundColor===Se.PartialRowColSelectionAndHoverBackgroundColor?Se.PartialRowColSelectionBackgroundColor:e.CachedStyle.BackgroundColor}(n,o,i);return r!==a&&(e.fillStyle=a),e.fillRect(l.x,l.y,l.width,l.height),a}function ZC(e){return e.HasError?QC.FormulaParseError:Bt(e.CachedStyle.Gradient)?Bt(e.CachedStyle.BackgroundColor)?QC.None:QC.Solid:QC.Gradient}var QC;function em(e,t,n){if(e===n.RowNumbers.length-1)return!0;const o=(0,Se.getCell)(e+1,t,n);if(!o)return!0;const r=o.CachedStyle;return!(null==r?void 0:r.BackgroundColor)&&!(null==r?void 0:r.Gradient)&&!(null==r?void 0:r.PatternStyle)}function tm(e,t,n){if(t===n.ColumnNumbers.length-1)return!0;const o=(0,Se.getCell)(e,t+1,n);if(!o)return!0;const r=o.CachedStyle;return!(null==r?void 0:r.BackgroundColor)&&!(null==r?void 0:r.Gradient)&&!(null==r?void 0:r.PatternStyle)}!function(e){e[e.None=0]="None",e[e.Solid=1]="Solid",e[e.FormulaParseError=2]="FormulaParseError",e[e.Gradient=3]="Gradient"}(QC||(QC={}));const nm="#FF9198",om="#D42314",rm="#F8DB8F",im="#DE6C00",lm="#A1DDAA",am="#309048",sm="#797774",dm="#3A3A38",cm="#FAFAFA",um="#3A3A38",hm="#D492D8",gm="#922E9B",fm="#C8C6C4",Cm="#3A3A38",mm="#3A3A38",pm="#FF9198",ym="#D42314",Sm="#3A3A38",Rm="#FAFAFA",wm="#83BEEC",bm="#3A3A38",Im="#3A3A38",vm="#D42314",Fm="#FF9198",Tm="#DE6C00",Dm="#F8DB8F",xm="#309048",Am="#A1DDAA",Bm="#D42314",Hm="#FF9198",Mm="#DE6C00",Pm="#F8DB8F",Om="#309048",km="#A1DDAA",Em="#DE6C00",Lm="#F8DB8F",Nm="#3A3A38",zm="#FAFAFA",Gm="#DE6C00",Wm="#F8DB8F",Vm="#D42314",_m="#FF9198",Um="#D42314",jm="#FF9198",qm="#DE6C00",$m="#F8DB8F",Xm="#309048",Ym="#A1DDAA",Km="#797774",Jm="#C8C6C4",Zm="#A1DDAA",Qm="#FF9198",ep="#F8DB8F",tp="#309048",np="#D42314",op="#DE6C00",rp="#FAFAFA";var ip,lp;function ap(e,t){en(e,"ctx","drawCircleIcon"),en(t,"drawingContext","drawCircleIcon");const{image:n,highContrastScheme:o}=t,r=function(e,t){if(t)return Vn(t.TextColor);switch(e){case cf.CircleHigh:case cf.TrafficHigh:case cf.CircleSymbolHigh:return am;case cf.CircleMedium:case cf.TrafficMedium:case cf.CircleSymbolMedium:return im;case cf.CircleLow:case cf.TrafficLow:case cf.CircleSymbolLow:return om;case cf.CircleEmpty:return um;case cf.CircleFilled:case cf.Circle25:case cf.CircleHalf:case cf.Circle75:return dm;case cf.FourCircleHigh:return ym;case cf.FourCircleLow:return mm;case cf.FourCircleMedium1:return Cm;case cf.FourCircleMedium2:return gm;default:throw Error(`getCircleOutlineColor: unsupported image type = ${e}`)}}(n,o),i=function(e,t){if(t)return Vn(t.TextColor);switch(e){case cf.CircleHigh:case cf.TrafficHigh:case cf.CircleSymbolHigh:return lm;case cf.CircleMedium:case cf.TrafficMedium:case cf.CircleSymbolMedium:return rm;case cf.CircleLow:case cf.TrafficLow:case cf.CircleSymbolLow:return nm;case cf.CircleEmpty:return cm;case cf.CircleFilled:return sm;case cf.FourCircleHigh:return pm;case cf.FourCircleLow:return;case cf.FourCircleMedium1:return fm;case cf.FourCircleMedium2:return hm;case cf.Circle25:case cf.CircleHalf:case cf.Circle75:return sm;default:throw Error(`getCircleInnerColor: unsupported image type = ${e}`)}}(n,o);sp(e,t,r,i)}function sp(e,t,n,o){const{image:r,highContrastScheme:i}=t,l=function(e){const{left:t,bottom:n,size:o}=e,r=o/2,i=r-Mr;return{centerX:Math.round(t+r),centerY:Math.round(n-r),innerRadius:i,outlineRadius:r}}(t),{outlineRadius:a}=l;a<=0||(dp(e,l.centerX,l.centerY,a,bf,Ff,n),o&&l.innerRadius>0&&function(e,t,n,o,r){const{centerX:i,centerY:l,innerRadius:a}=t;if(r)!function(e,t,n,o){const{centerX:r,centerY:i}=t,l=t.innerRadius,a=function(e){switch(e){case cf.Circle25:case cf.CircleHalf:case cf.Circle75:return ip.FillPortion;case cf.CircleLow:case cf.CircleEmpty:case cf.FourCircleHigh:case cf.TrafficLow:case cf.CircleSymbolLow:case cf.CircleSymbolMedium:case cf.CircleSymbolHigh:return ip.Empty;case cf.CircleHigh:case cf.TrafficHigh:case cf.CircleFilled:return ip.Full;case cf.CircleMedium:case cf.TrafficMedium:return ip.Stripes;case cf.FourCircleLow:case cf.FourCircleMedium1:case cf.FourCircleMedium2:return ip.InnerCircle;default:throw Error(`getHighContrastFillingType: image: ${e} not supported`)}}(o),s=Vn(n.BackgroundColor),d=Vn(n.TextColor);switch(a){case ip.Full:break;case ip.FillPortion:dp(e,r,i,l,cp(o),wf,s);break;case ip.Empty:dp(e,r,i,l,bf,Ff,s);break;case ip.InnerCircle:dp(e,r,i,l,bf,Ff,s);const t=function(e,t){switch(e){case cf.FourCircleMedium2:return t*bC;case cf.FourCircleMedium1:return t*IC;case cf.FourCircleLow:return t*vC;default:throw Error("highContrastCircles::getInnerRadius: unsupported image for drawing inner circle")}}(o,l);dp(e,r,i,t,bf,Ff,d);break;case ip.Stripes:dp(e,r,i,l,bf,Ff,s),function(e,t,n,o,r){e.strokeStyle=r,e.beginPath();const i={p1:{x:t+o*Math.cos(FC)-Pr,y:n+o*Math.sin(FC)-Pr},p2:{x:t+o*Math.cos(wf-FC)+Pr,y:n+o*Math.sin(wf-FC)+Pr}},l={p1:{x:t+o*Math.cos(TC)-Pr,y:n+o*Math.sin(TC)-Pr},p2:{x:t+o*Math.cos(wf-TC)+Pr,y:n+o*Math.sin(wf-TC)+Pr}},a={p1:{x:t+o*Math.cos(DC)-Pr,y:n+o*Math.sin(DC)-Pr},p2:{x:t+o*Math.cos(wf-DC)+Pr,y:n+o*Math.sin(wf-DC)+Pr}};ur(e,i.p1.x,i.p1.y,i.p2.x,i.p2.y),ur(e,l.p1.x,l.p1.y,l.p2.x,l.p2.y),ur(e,a.p1.x,a.p1.y,a.p2.x,a.p2.y),e.stroke()}(e,r,i,l,d);break;default:throw Error("circle-fillHighContrastCircle: unsupported filling type")}}(e,t,r,o);else switch(o){case cf.Circle25:case cf.CircleHalf:case cf.Circle75:const t=cp(o);dp(e,i,l,a,wf,t,n),dp(e,i,l,a,t,wf,cm);break;default:dp(e,i,l,a,bf,Ff,n)}}(e,l,o,r,i))}function dp(e,t,n,o,r,i,l){e.fillStyle=l,e.beginPath(),e.moveTo(t,n),e.arc(t,n,o,r,i),e.fill()}function cp(e){switch(e){case cf.Circle25:return bf;case cf.CircleHalf:return If;case cf.Circle75:return vf;default:throw Error(`getFillAngle: image: ${e} not supported`)}}function up(e,t,n,o){const{left:r,bottom:i,highContrastScheme:l}=o,a=function(e){return e?Vn(e.TextColor):bm}(l);return{innerColor:t,outerColor:a,bottom:i,left:r+n*(e+1),height:n*(e+2),width:n}}function hp(e,t,n,o,r){const{left:i,bottom:l,highContrastScheme:a}=r,s=function(e){return e?Vn(e.TextColor):bm}(a);return{innerColor:n,outerColor:s,bottom:l-e*o,left:i+t*o,height:o,width:o}}function gp(e,t){en(t.outerColor,"outerColor","drawFlags");const{outerColor:n}=t,o=function(e){const{left:t,bottom:n,width:o,height:r}=e,i=r/2;return{p1:{x:t+o+Pr,y:n-i-Pr},p2:{x:t+o-i/wC+Pr,y:n-r-Pr}}}(t),r=function(e){const{left:t,bottom:n,width:o}=e,r=o/2;return{p1:{x:t+r+Pr,y:n-Pr},p2:{x:t+Pr,y:n-r*wC-Pr}}}(t);e.strokeStyle=n,e.beginPath(),ur(e,o.p1.x,o.p1.y,o.p2.x,o.p2.y),ur(e,r.p1.x,r.p1.y,r.p2.x,r.p2.y),e.stroke()}function fp(e,t,n){en(e,"ctx","drawTriangle"),en(t,"drawingContext","drawTriangle");const{innerColor:o,outerColor:r,left:i,bottom:l,height:a,width:s}=t,d=i+s/2,c=n?l+a:l-a;e.beginPath(),e.moveTo(i,l),e.lineTo(i+s,l),e.lineTo(d,c),e.closePath(),o&&(e.fillStyle=o,e.fill()),r&&(e.strokeStyle=r,e.stroke())}function Cp(e,t,n,o,r){return Vs(n,e,t,o,r,!0,!0)}function mp(e,t,n){const o=wn(Le),{left:r,bottom:i,height:l,width:a}=t,s=n===lp.Right,d=i-l,c=s?r-o:r;af(e,[{x:c,y:d},{x:c+a+o,y:d},{x:c+(s?a+o:0),y:d+l+o},{x:c,y:d}])}function pp(e,t){if(t)return Vn(t.TextColor);switch(e){case cf.TriangleLow:return Bm;case cf.TriangleMedium:return Mm;case cf.TriangleHigh:return Om;default:throw Error(`getTriangleOuterColor: unsupported image type = ${e}`)}}function yp(e,t){if(t)return Vn(t.BackgroundColor);switch(e){case cf.TriangleLow:return Hm;case cf.TriangleMedium:return Pm;case cf.TriangleHigh:return km;default:throw Error(`getTriangleInnerColor: unsupported image type = ${e}`)}}function Sp(e,t){if(!t)switch(e){case cf.SignLow:return _m;case cf.SignMedium:return Wm;default:throw Error(`getInnerColor: unsupported image type = ${e}`)}}function Rp(e,t){if(t)return Vn(t.TextColor);switch(e){case cf.SignLow:return Vm;case cf.SignMedium:return Gm;default:throw Error(`getOuterColor: unsupported image type = ${e}`)}}function wp(e,t){en(e,"ctx","drawSymbols"),en(t,"drawingContext","drawSymbols");const{image:n,highContrastScheme:o}=t,r=function(e,t){if(t)return Vn(t.TextColor);switch(e){case cf.SymbolHigh:return Ym;case cf.SymbolMedium:return $m;case cf.SymbolLow:return jm;case cf.CircleSymbolHigh:case cf.CircleSymbolMedium:case cf.CircleSymbolLow:return rp;default:throw Error(`getSymbolInnerColor: unsupported image type = ${e}`)}}(n,o),i=function(e,t){if(t)return Vn(t.TextColor);switch(e){case cf.SymbolHigh:case cf.CircleSymbolHigh:return Xm;case cf.SymbolMedium:case cf.CircleSymbolMedium:return qm;case cf.SymbolLow:case cf.CircleSymbolLow:return Um;default:throw Error(`getSymbolOuterColor: unsupported image type = ${e}`)}}(n,o);switch(n){case cf.SymbolHigh:case cf.CircleSymbolHigh:!function(e,t,n,o){let r;const{size:i,left:l,bottom:a,image:s}=t;switch(s){case cf.SymbolHigh:r=function(e,t,n){const o=t-n,r=e+Tf*n,i={x:e+Pf*n,y:Mf*n+o};return[i,{x:e+kf*n,y:Of*n+o},{x:r,y:xf*n+o},{x:e+n,y:Hf*n+o},{x:e+Bf*n,y:Af*n+o},{x:r,y:Df*n+o},i]}(l+Pr,a,i);break;case cf.CircleSymbolHigh:r=function(e,t,n){const o=t-n,r=e+Ef*n,i={x:e+Uf*n,y:_f*n+o};return[i,{x:e+qf*n,y:jf*n+o},{x:r,y:Nf*n+o},{x:e+Vf*n,y:Wf*n+o},{x:e+Gf*n,y:zf*n+o},{x:r,y:Lf*n+o},i]}(l,a,i);break;default:throw Error(`drawCheckMark: unsupported image type = ${s}`)}_l(e,n,o,r)}(e,t,r,i);break;case cf.SymbolMedium:case cf.CircleSymbolMedium:!function(e,t,n,o){const{image:r}=t;switch(r){case cf.SymbolMedium:!function(e,t,n,o){const{size:r,left:i,bottom:l}=t,a=Math.floor(r*nC),s=Math.floor(r*Zf),d=Math.floor(r*Qf),c=a+Math.max(oC,Math.floor(tC*r)),u=i+Math.floor(eC*r);bp(e,u,l-(r-a),a,d,n,o),function(e,t,n,o,r,i,l,a,s){Or(e,{left:t,bottom:n-(o-s-r),outerColor:a,height:r,width:i,innerColor:l})}(e,u,l,r,s,d,n,o,c)}(e,t,n,o);break;case cf.CircleSymbolMedium:!function(e,t,n,o){const{size:r,left:i,bottom:l,image:a}=t,s=r-2*aC,d=Math.floor(s*lC),c=function(e){const t=Math.floor(e*rC);return t%2==0?t-1:t}(d),u=i+r/2,h=Math.round(u-(c+1)/2),g=l-aC,f=function(e){const t=Math.floor(e*iC);return t%2==0?t:t-1}(s),C=function(e,t,n){return e+Pr-(t-n)/2}(h,f,c),m={image:a,bottom:g,highContrastScheme:void 0,left:C,size:f};bp(e,h,Math.floor(l-aC-(f+1)),d,c,n,o),sp(e,m,o,n)}(e,t,n,o);break;default:throw Error(`drawExclamationMark: unsupported image type = ${r}`)}}(e,t,r,i);break;case cf.SymbolLow:case cf.CircleSymbolLow:!function(e,t,n,o){let r;const{size:i,left:l,bottom:a,image:s}=t;switch(s){case cf.SymbolLow:r=function(e,t,n){const o=t-n,r=Xf*n,i=r+e,l=r+o,a=$f*n,s=a+e,d=a+o,c=Jf*n,u=Yf*n,h=u+e,g=u+o,f=Kf*n,C={x:i,y:o};return[C,{x:e,y:l},{x:c+e,y:g},{x:e,y:d},{x:i,y:n+o},{x:h,y:f+o},{x:s,y:n+o},{x:e+n,y:d},{x:e+f,y:g},{x:e+n,y:l},{x:s,y:o},{x:h,y:c+o},C]}(l+Pr,a,i);break;case cf.CircleSymbolLow:r=function(e,t,n){const o=(y=n)%2==1?y+1:y,r=t-n,i=CC*o,l=i+e,a=i+r,s=mC*o,d=s+e,c=s+r,u=yC*o,h=pC*o,g=h+e,f=h+r,C=SC*o,m=RC*o,p={x:l,y:r+m};var y;return[p,{x:e+m,y:a},{x:u+e,y:f},{x:e+m,y:c},{x:l,y:o+r-m},{x:g,y:C+r},{x:d,y:o+r-m},{x:e+o-m,y:c},{x:e+C,y:f},{x:e+o-m,y:a},{x:d,y:r+m},{x:g,y:u+r},p]}(l,a,i);break;default:throw Error(`drawCrossMark: unsupported image type = ${s}`)}_l(e,n,o,r)}(e,t,r,i);break;default:throw Error(`drawSymbols: unsupported image type = ${n}`)}}function bp(e,t,n,o,r,i,l){Or(e,{left:t,bottom:n,outerColor:l,height:o,width:r,innerColor:i})}function Ip(e){let t=Math.round(sC*e);return t=t%2!=0?t+1:t,t}function vp(e){let t=Math.round(dC*e);return t=t%2!=0?t+1:t,t}function Fp(e,t){en(e,"ctx","drawCircleSymbols"),en(t,"drawingContext","drawCircleSymbols"),t.size>0&&(ap(e,t),wp(e,function(e){const{left:t,bottom:n,image:o,highContrastScheme:r,size:i}=e,l=Math.round(t),a=Math.round(n);return{size:Math.round(i),left:l,bottom:a,image:o,highContrastScheme:r}}(t)))}function Tp(e,t,n,o,r){const i=function(e,t,n,o){const r=t.CondFormat.Icon.IconOnly?t.CachedFont.Size:wl(t),i=Sd(r,n),l=t.CondFormat.Icon;return{size:i,image:uf[l.Set][l.Index],left:BC(e,t,i,r,n),bottom:AC(e,t,n,i),highContrastScheme:o}}(t,n,o,r),l=of(t,n,i.left,i.bottom,i.size,!1);if(!(i.size<=4)){switch(dr(e,l),i.image){case cf.CircleLow:case cf.CircleMedium:case cf.CircleHigh:case cf.CircleEmpty:case cf.CircleFilled:case cf.FourCircleHigh:case cf.FourCircleLow:case cf.FourCircleMedium1:case cf.FourCircleMedium2:case cf.Circle25:case cf.CircleHalf:case cf.Circle75:ap(e,i);break;case cf.CircleSymbolHigh:case cf.CircleSymbolMedium:case cf.CircleSymbolLow:Fp(e,i);break;case cf.TrafficHigh:case cf.TrafficMedium:case cf.TrafficLow:!function(e,t){en(e,"ctx","drawTrafficLightRimmed"),en(t,"drawingContext","drawTrafficLightRimmed");const{size:n,left:o,bottom:r,highContrastScheme:i}=t;let l=n;n%2==0&&(l=n-1);const a=function(e){return e?Vn(e.TextColor):Sm}(i);Or(e,{left:o,bottom:r,outerColor:a,height:l,width:l,innerColor:void 0}),t.size=l;const s=function(e){const{image:t,left:n,bottom:o,highContrastScheme:r,size:i}=e;return{size:i-2*hf,left:n+hf+.5,bottom:o-hf-.5,image:t,highContrastScheme:r}}(t);ap(e,s)}(e,i);break;case cf.SignalBarEmpty:case cf.SignalBarLow:case cf.SignalBarMedium1:case cf.SignalBarMedium2:case cf.SignalBarHigh:!function(e,t){en(e,"ctx","drawSignalBar"),en(t,"drawingContext","drawSignalBar");const{image:n,size:o,highContrastScheme:r}=t,i=Math.floor(o/5),l=function(e,t){const n=function(e){return e?Vn(e.BackgroundColor):Rm}(t),o=function(e){return e?Vn(e.TextColor):wm}(t);switch(e){case cf.SignalBarEmpty:return[n,n,n,n];case cf.SignalBarLow:return[o,n,n,n];case cf.SignalBarMedium1:return[o,o,n,n];case cf.SignalBarMedium2:return[o,o,o,n];case cf.SignalBarHigh:return[o,o,o,o];default:throw Error(`getBarsColors: image: ${e} not supported`)}}(n,r);for(let n=0;n<l.length;n++)Or(e,up(n,l[n],i,t));r&&function(e,t,n,o){const{left:r,bottom:i,highContrastScheme:l}=n,a=function(e,t,n,o){const r=function(e){switch(e){case cf.SignalBarEmpty:case cf.SignalBarLow:return 0;case cf.SignalBarMedium1:return 1;case cf.SignalBarMedium2:return 2;case cf.SignalBarHigh:return 3;default:throw Error(`getSeperators: image: ${e} not supported`)}}(e),i=[];let l=n-2*o+Pr,a=t+2*o+Pr;for(let e=0;e<r;e++)i.push({X:a,startY:l,endY:n-1.5}),l-=o,a+=o;return i}(e,r,i,o);t.strokeStyle=Vn(l.BackgroundColor),t.beginPath();for(let e=0;e<a.length;e++)ur(t,a[e].X,a[e].startY,a[e].X,a[e].endY);t.stroke()}(n,e,t,i)}(e,i);break;case cf.QuadrantEmpty:case cf.Quadrant25:case cf.QuadrantHalf:case cf.Quadrant75:case cf.QuadrantFull:!function(e,t){en(e,"ctx","drawQuadrantBoxes"),en(t,"drawingContext","drawQuadrantBoxes");const{image:n,size:o,highContrastScheme:r}=t,i=Math.floor(o/2),l=function(e,t){const n=function(e){return e?Vn(e.TextColor):wm}(t),o=function(e){return e?Vn(e.BackgroundColor):Rm}(t);switch(e){case cf.QuadrantEmpty:return[[o,o],[o,o]];case cf.Quadrant25:return[[n,o],[o,o]];case cf.QuadrantHalf:return[[n,n],[o,o]];case cf.Quadrant75:return[[n,n],[n,o]];case cf.QuadrantFull:return[[n,n],[n,n]];default:throw Error(`getBoxesColors: image: ${e} not supported`)}}(n,r);for(let n=0;n<l.length;n++)for(let o=0;o<l.length;o++)Or(e,hp(n,o,l[n][o],i,t));r&&function(e,t,n,o){const{left:r,bottom:i,highContrastScheme:l}=t,a=r+n+Pr,s=i-n-Pr,d=function(e,t,n,o){switch(e){case cf.QuadrantEmpty:return[];case cf.Quadrant25:return[{x:t,y:n+o-Pr},{x:t-o+Pr,y:n}];case cf.QuadrantHalf:return[{x:t+o,y:n},{x:t,y:n+o-Pr},{x:t-o+Pr,y:n}];case cf.Quadrant75:case cf.QuadrantFull:return[{x:t,y:n-o+Pr},{x:t+o-Pr,y:n},{x:t,y:n+o-Pr},{x:t-o+Pr,y:n}];default:throw Error(`getSeparatorsCoordinates: image: ${e} not supported`)}}(o,a,s,n);e.strokeStyle=Vn(l.BackgroundColor),e.beginPath();for(let t=0;t<d.length;t++)ur(e,a,s,d[t].x,d[t].y);e.stroke()}(e,t,i,n)}(e,i);break;case cf.FlagHigh:case cf.FlagMedium:case cf.FlagLow:!function(e,t){en(e,"ctx","drawFlags"),en(t,"drawingContext","drawFlags");const{image:n,size:o,left:r,bottom:i,highContrastScheme:l}=t,a=Math.floor(o/2),s=Math.floor(o/3),d=function(e,t){if(t)return function(e,t){if(e===cf.FlagHigh)return Vn(t.TextColor)}(e,t);switch(e){case cf.FlagHigh:return Am;case cf.FlagMedium:return Dm;case cf.FlagLow:return Fm;default:throw Error(`getFlagInnerColor: unsupported image type = ${e}`)}}(n,l),c=function(e,t){if(t)return Vn(t.TextColor);switch(e){case cf.FlagHigh:return xm;case cf.FlagMedium:return Tm;case cf.FlagLow:return vm;default:throw Error(`getFlagOuterColor: unsupported image type = ${e}`)}}(n,l);!function(e,t,n,o,r,i){const{left:l,bottom:a,image:s,highContrastScheme:d}=i,c={left:l,bottom:a-t,outerColor:r,height:t,width:n,innerColor:o};Or(e,c),s===cf.FlagMedium&&d&&gp(e,c)}(e,a,s,d,c,t),function(e,t,n,o,r,i){const{left:l,bottom:a,size:s,image:d,highContrastScheme:c}=i,u={left:l+n,bottom:a-t+Math.floor(s/8),outerColor:r,height:t,width:n,innerColor:o};Or(e,u),d===cf.FlagMedium&&c&&gp(e,u)}(e,a,s,d,c,t),function(e,t,n,o,r){const i=o-Pr,l=i-n,a=t+Pr;e.lineWidth=gf,e.setLineDash(Qe),e.strokeStyle=function(e){return e?Vn(e.TextColor):Im}(r),e.beginPath(),ur(e,a,i,a,l),e.stroke()}(e,r,2*a,i,l)}(e,i);break;case cf.TriangleHigh:case cf.TriangleMedium:case cf.TriangleLow:!function(e,t){en(e,"ctx","drawTriangleSet"),en(t,"drawingContext","drawTriangleSet");const{image:n,size:o,left:r,bottom:i,highContrastScheme:l}=t;switch(n){case cf.TriangleHigh:case cf.TriangleLow:const a=function(e){const{image:t,left:n,bottom:o,size:r,highContrastScheme:i}=e,l=Math.floor(r/2),a=Math.floor(r/4),s=o-a-Pr,d=n+Pr;switch(t){case cf.TriangleHigh:return{outerColor:pp(t,i),innerColor:yp(t,i),left:d,bottom:s,height:l,width:r};case cf.TriangleLow:return{outerColor:pp(t,i),innerColor:yp(t,i),left:n+Pr,bottom:o-a-l-Pr,height:l,width:r};default:throw Error(`getTriangleDrawingContext: unsupported image type = ${t}`)}}(t);fp(e,a,n===cf.TriangleLow);break;case cf.TriangleMedium:{const t=Math.floor(o/3);Or(e,{left:r,outerColor:pp(n,l),innerColor:yp(n,l),bottom:i-t,height:t,width:o});break}default:throw Error(`drawTriangleSet: unsupported image type = ${n}`)}}(e,i);break;case cf.StarHigh:case cf.StarMedium:case cf.StarLow:!function(e,t){en(e,"ctx","drawStarIcon"),en(t,"drawingContext","drawStarIcon");const{image:n,size:o,left:r,bottom:i,highContrastScheme:l}=t,a=Math.floor(o/2);if(a<=1)return;const s=function(e,t,n){const o=n*Rf,r=e+n+.5,i=o*mf,l=o*yf,a=n*pf,s=o*pf,d=o*Sf,c=n*mf,u=n*yf,h=t-n+(l-(Math.floor(l)+Pr)),g=h-l,f=h+d,C=h+u;return{topOuter:{x:r,y:h-n},topRightInner:{x:r+i,y:g},topRightOuter:{x:r+a,y:g},middleRightInner:{x:r+s,y:f},bottomRightOuter:{x:r+c,y:C},bottomInner:{x:r,y:h+o},bottomLeftOuter:{x:r-c,y:C},middleLeftInner:{x:r-s,y:f},topLeftOuter:{x:r-a,y:g},topLeftInner:{x:r-i,y:g}}}(r,i,a),d=function(e,t){if(t)return function(e,t){switch(e){case cf.StarHigh:case cf.StarMedium:return Vn(t.TextColor);case cf.StarLow:return;default:throw Error(`getStarLeftInnerColorHighContrast: unsupported image type = ${e}`)}}(e,t);switch(e){case cf.StarHigh:case cf.StarMedium:return Lm;case cf.StarLow:return zm;default:throw Error(`getStarLeftInnerColor: unsupported image type = ${e}`)}}(n,l),c=function(e,t){if(t)return Vn(t.TextColor);switch(e){case cf.StarHigh:case cf.StarMedium:return Em;case cf.StarLow:return Nm;default:throw Error(`getStarLeftOuterColor: unsupported image type = ${e}`)}}(n,l),u=function(e,t){if(t)return function(e,t){switch(e){case cf.StarHigh:return Vn(t.TextColor);case cf.StarLow:case cf.StarMedium:return;default:throw Error(`getStarRightInnerColorHighContrast: unsupported image type = ${e}`)}}(e,t);switch(e){case cf.StarHigh:return Lm;case cf.StarMedium:case cf.StarLow:return zm;default:throw Error(`getStarRightInnerColor: unsupported image type = ${e}`)}}(n,l),h=function(e,t){if(t)return Vn(t.TextColor);switch(e){case cf.StarHigh:return Em;case cf.StarMedium:case cf.StarLow:return Nm;default:throw Error(`getStarRightOuterColor: unsupported image type = ${e}`)}}(n,l),g=n===cf.StarMedium;e.beginPath(),function(e,t){e.moveTo(t.topOuter.x,t.topOuter.y),e.lineTo(t.topRightInner.x,t.topRightInner.y),e.lineTo(t.topRightOuter.x,t.topRightOuter.y),e.lineTo(t.middleRightInner.x,t.middleRightInner.y),e.lineTo(t.bottomRightOuter.x,t.bottomRightOuter.y),e.lineTo(t.bottomInner.x,t.bottomInner.y)}(e,s),g&&(Vl(e,u,h),e.beginPath()),function(e,t){e.moveTo(t.bottomInner.x,t.bottomInner.y),e.lineTo(t.bottomLeftOuter.x,t.bottomLeftOuter.y),e.lineTo(t.middleLeftInner.x,t.middleLeftInner.y),e.lineTo(t.topLeftOuter.x,t.topLeftOuter.y),e.lineTo(t.topLeftInner.x,t.topLeftInner.y),e.lineTo(t.topOuter.x,t.topOuter.y)}(e,s),Vl(e,d,c)}(e,i);break;case cf.SignLow:case cf.SignMedium:!function(e,t){en(e,"ctx","drawSigns"),en(t,"drawingContext","drawSigns");const{image:n}=t;switch(n){case cf.SignLow:!function(e,t){const{image:n,highContrastScheme:o}=t,r=Sp(n,o),i=Rp(n,o),l=function(e){const{size:t,left:n,bottom:o}=e,r=Math.floor(t/2),i=n+r+Pr,l=o-r-Pr;return{top:{x:i,y:l-r},right:{x:i+r,y:l},bottom:{x:i,y:l+r},left:{x:i-r,y:l}}}(t);e.beginPath(),e.moveTo(l.top.x,l.top.y),e.lineTo(l.right.x,l.right.y),e.lineTo(l.bottom.x,l.bottom.y),e.lineTo(l.left.x,l.left.y),e.lineTo(l.top.x,l.top.y),Vl(e,r,i)}(e,t);break;case cf.SignMedium:{const n=function(e){const{left:t,bottom:n,size:o,highContrastScheme:r,image:i}=e,l=t+Pr,a=n-Pr,s=Sp(i,r);return{outerColor:Rp(i,r),innerColor:s,left:l,bottom:a,height:o,width:o}}(t);fp(e,n,!1);break}default:throw Error(`drawSigns: unsupported image type = ${n}`)}}(e,i);break;case cf.SymbolHigh:case cf.SymbolMedium:case cf.SymbolLow:wp(e,i);break;case cf.ColoredArrowDown:case cf.ColoredArrowDownRight:case cf.ColoredArrowRight:case cf.ColoredArrowUp:case cf.ColoredArrowUpRight:case cf.GrayArrowDown:case cf.GrayArrowDownRight:case cf.GrayArrowRight:case cf.GrayArrowUp:case cf.GrayArrowUpRight:!function(e,t){en(e,"ctx","drawArrows"),en(t,"drawingContext","drawArrows");const{image:n,size:o,left:r,bottom:i,highContrastScheme:l}=t,a=function(e,t){if(t)return Vn(t.TextColor);switch(e){case cf.GrayArrowDown:case cf.GrayArrowDownRight:case cf.GrayArrowRight:case cf.GrayArrowUp:case cf.GrayArrowUpRight:return Km;case cf.ColoredArrowUp:return tp;case cf.ColoredArrowDown:return np;case cf.ColoredArrowUpRight:case cf.ColoredArrowRight:case cf.ColoredArrowDownRight:return op;default:throw Error(`getArrowOuterColor: unsupported image type = ${e}`)}}(n,l),s=function(e,t){if(t)return function(e,t){switch(e){case cf.GrayArrowDown:case cf.GrayArrowDownRight:case cf.GrayArrowRight:case cf.GrayArrowUp:case cf.GrayArrowUpRight:return Vn(t.TextColor);case cf.ColoredArrowUp:case cf.ColoredArrowDown:case cf.ColoredArrowUpRight:case cf.ColoredArrowRight:case cf.ColoredArrowDownRight:return Vn(t.BackgroundColor);default:throw Error(`getArrowHighContrastInnerColor: unsupported image type = ${e}`)}}(e,t);switch(e){case cf.GrayArrowDown:case cf.GrayArrowDownRight:case cf.GrayArrowRight:case cf.GrayArrowUp:case cf.GrayArrowUpRight:return Jm;case cf.ColoredArrowUp:return Zm;case cf.ColoredArrowDown:return Qm;case cf.ColoredArrowUpRight:case cf.ColoredArrowRight:case cf.ColoredArrowDownRight:return ep;default:throw Error(`getArrowInnerColor: unsupported image type = ${e}`)}}(n,l);let d=[];switch(n){case cf.GrayArrowDown:case cf.ColoredArrowDown:d=function(e,t,n){const o=dC*n,r=Ip(n),i=Math.floor(n/2+e)+Pr,l=Math.round(t),a=i+o*Math.cos(-3*fC),s=l+o*Math.sin(-3*fC),d=a+r*Math.cos(-fC),c=s+r*Math.sin(-fC),u=i-r/2,h=c+o/2*Math.sin(fC),g=h-o,f=u+r,C=g,m=f,p=h,y=i+(i-d),S=c,R=i+(i-a),w=s,b={x:i,y:l};return[b,{x:a,y:s},{x:d,y:c},{x:u,y:h},{x:u,y:Math.round(g)-Pr},{x:f,y:Math.round(C)-Pr},{x:m,y:p},{x:y,y:S},{x:R,y:w},b]}(r,i,o);break;case cf.GrayArrowUp:case cf.ColoredArrowUp:d=function(e,t,n){const o=t-n,r=dC*n,i=Ip(n),l=Math.floor(n/2+e)+Pr,a=Math.round(o),s=l+r*Math.cos(3*fC),d=a+r*Math.sin(3*fC),c=s+i*Math.cos(fC),u=d+i*Math.sin(fC),h=l-i/2,g=u+r/2*Math.sin(-fC),f=g+r,C=h+i,m=f,p=C,y=g,S=l+(l-c),R=u,w=l+(l-s),b=d,I={x:l,y:a};return[I,{x:s,y:d},{x:c,y:u},{x:h,y:g},{x:h,y:Math.round(f)-Pr},{x:C,y:Math.round(m)-Pr},{x:p,y},{x:S,y:R},{x:w,y:b},I]}(r,i,o);break;case cf.GrayArrowRight:case cf.ColoredArrowRight:d=function(e,t,n){const o=t-n,r=dC*n,i=Ip(n),l=Math.round(e+n),a=Math.floor(n/2+o)+Pr,s=l+r*Math.cos(-3*fC),d=a+r*Math.sin(-3*fC),c=s+i*Math.cos(3*fC),u=d+i*Math.sin(3*fC),h=c+r/2*Math.cos(fC),g=a-i/2,f=h-r,C=g,m=f,p=C+i,y=h,S=a+(a-g),R=c,w=a+(a-u),b=s,I=a+(a-d),v={x:l,y:a};return[v,{x:s,y:d},{x:c,y:u},{x:h,y:g},{x:Math.round(f)+Pr,y:C},{x:Math.round(m)+Pr,y:p},{x:y,y:S},{x:R,y:w},{x:b,y:I},v]}(r,i,o);break;case cf.GrayArrowDownRight:case cf.ColoredArrowDownRight:d=function(e,t,n){const o=t-n,r=Math.round(sC*n),i=vp(n),l=Math.floor(cC*n+e)+Pr,a=Math.floor(uC*n+o)+Pr,s=l,d=a-i,c=s-r,u=d,h=c,g=a-r-r/Math.sqrt(2),f=h+i*Math.cos(-3*fC),C=g+i*Math.sin(-3*fC),m=l-i,p=a,y=m,S=p-r,R={x:l,y:a};return[R,{x:s,y:d},{x:c,y:u},{x:h,y:g},{x:f,y:C},{x:f+r*Math.cos(3*fC),y:C+r*Math.sin(3*fC)},{x:l-r-r/Math.sqrt(2),y:S},{x:y,y:S},{x:m,y:p},R]}(r,i,o);break;case cf.GrayArrowUpRight:case cf.ColoredArrowUpRight:d=function(e,t,n){const o=t-n,r=Math.round(sC*n),i=vp(n),l=Math.floor(hC*n+e)+Pr,a=Math.floor(gC*n+o)+Pr,s=l-i,d=a,c=s,u=d+r,h=l-r-r/Math.sqrt(2),g=u,f=h+i*Math.cos(3*fC),C=g+i*Math.sin(3*fC),m=l,p=a+i,y=m-r,S=p,R={x:l,y:a};return[R,{x:s,y:d},{x:c,y:u},{x:h,y:g},{x:f,y:C},{x:f+r*Math.cos(fC),y:C+r*Math.sin(fC)},{x:y,y:a+r+r/Math.sqrt(2)},{x:y,y:S},{x:m,y:p},R]}(r,i,o);break;default:throw Error(`drawArrows: unsupported image type = ${n}`)}_l(e,s,a,d)}(e,i);break;default:throw Error(`drawConditionalFormattingIcon: imageType: ${i.image} not supported`)}cr(e,l)}}function Dp(e,t){e.lineWidth=xp(t),e.setLineDash(Qe),e.strokeStyle=Bt(t.highContrastScheme)?Me:`${Vn(t.highContrastScheme.TextColor)}`}function xp(e){return Pn(e)?ze:Le}function Ap(e,t,n,o,r,i,l){const a=o.Index,s=o.Min,d=o.Max;if(!Hp(a,s,d,n.renderingRegion,!0))return;const c=t.ClientOnlyCache,u=Pp(c.RowOffsetsAdjustedForDrawing,a,r,l);ur(e,-1===o.Min?0:Mp(c.ColOffsetsAdjustedForDrawing,s,r,i),u,-1===o.Max?t.BlockWidth*n.scaleFactor:Mp(c.ColOffsetsAdjustedForDrawing,d,r,i),u)}function Bp(e,t,n,o,r,i,l){const a=o.Index,s=o.Min,d=o.Max;if(!Hp(a,s,d,n.renderingRegion,!1))return;const c=t.ClientOnlyCache,u=Mp(c.ColOffsetsAdjustedForDrawing,a,r,i);ur(e,u,-1===o.Min?0:Pp(c.RowOffsetsAdjustedForDrawing,s,r,l),u,-1===o.Max?t.BlockHeight*n.scaleFactor:Pp(c.RowOffsetsAdjustedForDrawing,d,r,l))}function Hp(e,t,n,o,r){let i=r?o.startRow:o.startColumn,l=r?o.endRow:o.endColumn;return i<=(a=e)&&a<=l&&(l=r?o.endColumn:o.endRow,!(-1!==t&&t>l||(i=r?o.startColumn:o.startRow,-1!==n&&n<i)));var a}function Mp(e,t,n,o){return t>=0?Nr(e[t],rr(t,e),n,o):0}function Pp(e,t,n,o){return t>=0?Nr(e[t],ir(t,e),n,o):0}function Op(e,t,n,o,r,i,l){const a=t.ClientOnlyCache,s=l.FirstColumn<=0?-1:Nr(a.ColOffsetsAdjustedForDrawing[l.FirstColumn],0,o,i),d=l.FirstRow<=0?-1:Nr(a.RowOffsetsAdjustedForDrawing[l.FirstRow],0,o,r),c=l.LastColumn>=t.ColumnNumbers.length?t.BlockWidth*n.scaleFactor+1:Nr(a.ColOffsetsAdjustedForDrawing[l.LastColumn],rr(l.LastColumn,a.ColOffsetsAdjustedForDrawing),o,i),u=l.LastRow>=t.RowNumbers.length?t.BlockHeight*n.scaleFactor+1:Nr(a.RowOffsetsAdjustedForDrawing[l.LastRow],ir(l.LastRow,a.RowOffsetsAdjustedForDrawing),o,r);e.rect(s,d,c-s,u-d)}function kp(e,t,n){const o=wn(1);e.lineWidth=1,e.fillStyle=e.strokeStyle=n?Vn(n.TextColor):Ds,e.strokeRect(t.x+o,t.y+o,t.width,t.height)}function Ep(e,t,n,o){const r=n?Vn(n.TextColor):"#969696";e.font=Cl(t,void 0,o),e.fillStyle=r,e.textBaseline=Ht,e.textAlign="center"}function Lp(e,t,n){const o=Np(e,t,n),r=Bd(e,t,!1),i=Ad(e,t,!1),l=t.OriginPTWidthAdjustedForDrawing,a=t.OriginPTHeightAdjustedForDrawing,s=o.y+o.height,d=i+a,c=o.width,u=d-s-48*n,h=Math.min(c,Os*u),g=Math.min(u,c/Os),f=(s+d)/2;return{x:r+Math.round((l-h)/2),y:Math.round(f-g/2),width:h,height:g}}function Np(e,t,n){const o=Math.round(t.OriginPTWidthAdjustedForDrawing*Ms);return{x:Vp(e,t,o),y:Gp(e,t,n),width:o,height:Math.round(Bs*n)}}function zp(e,t){const n=Math.round(t.OriginPTWidth*Ms);return{x:_p(e,t,n),y:Wp(e,t),width:n-xs,height:Bs-xs}}function Gp(e,t,n){return Ad(e,t,!1)+Math.round(As*n)}function Wp(e,t){return e.RowOffsets[t.FirstRowIndex]+t.DeltaYFromOriginPT+As+xs}function Vp(e,t,n){const o=Math.floor((t.OriginPTWidthAdjustedForDrawing-n)/2);return Bd(e,t,!1)+o}function _p(e,t,n){const o=(t.OriginPTWidth-n)/2+xs;return function(e,t){const n=e.ColumnOffsets;return e.IsRtl?e.BlockWidth-t.DeltaXFromOriginPT-n[t.FirstColIndex]-t.OriginPTWidth:n[t.FirstColIndex]+t.DeltaXFromOriginPT}(e,t)+o}!function(e){e[e.Empty=0]="Empty",e[e.Stripes=1]="Stripes",e[e.InnerCircle=2]="InnerCircle",e[e.FillPortion=3]="FillPortion",e[e.Full=4]="Full"}(ip||(ip={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(lp||(lp={}));const Up=1,jp=1,qp=2,$p=1,Xp=1,Yp=0,Kp=1,Jp=[3,1];function Zp(e,t,n,o){if(function(e){return e>0&&e<100}(e))return{X:t+n-wn(Le),startY:o.y+Le,endY:o.y+o.height-Le}}function Qp(e,t,n,o,r){let i=Math.round(t.width*e/100);o&&(i=-i);const l=r&&i<0?$p:0,a=Math.min(n,n+i),s=t.x+a,d=Math.max(Math.abs(i)-l,0);return{x:s,y:t.y,width:d,height:t.height}}function ey(e,t){return t.information.GradientColor?function(e,t){const n=function(e){var t;const n=e.bar,o=n.x,r=o+n.width,i=null===(t=e.axis)||void 0===t?void 0:t.X;return(Bt(i)?e.isRtl:o<i)?{startX:r,endX:o,Y:n.y}:{startX:o,endX:r,Y:n.y}}(t),o=e.createLinearGradient(n.startX,n.Y,n.endX,n.Y);return o.addColorStop(Yp,t.information.Color),o.addColorStop(Kp,t.information.GradientColor),o}(e,t):t.information.Color}function ty(e,t,n,o){e.lineWidth=t,e.setLineDash(n),e.strokeStyle=o}function ny(e,t,n){n!==t&&(e.stroke(),e.beginPath(),e.strokeStyle=t)}function oy(e,t){const n=ry(Up,t),o=ry(jp,t),r=ry(qp,t);return{x:e.x+n+Le,y:e.y+n+Le,width:Math.max(0,e.width-2*n-2*Le),height:Math.max(0,e.height-o-r-2*Le)}}function ry(e,t){return Math.max(e,Math.round(e*t))}function iy(e,t,n,o){en(e,"ctx","drawDynamicImages"),en(t,"model","drawDynamicImages"),en(n,"context","drawDynamicImages");const r=function(e,t){switch(t){case Wt.Sparkline:return e.Sparklines;case Wt.InCellImage:return e.InCellImages;default:throw Error(`getDynamicImages: unsupported image type = ${t}`)}}(t,o);if(Bt(r))return;const i=t.ClientOnlyCache.CellsToRender,l=function(e,t,n,o,r){const i=Xt(e,o),l=Jt(i);return!l||l.version===t&&l.url===n||Qt(i),qt(i,r,t,n)}(o,r.Version,r.ImageUrl,n.blockIdentifier,n.blockIdentifier);if(l)for(let r=0;r<i.length;r++){const a=i[r];if(!gr(a,n.renderingRegion))continue;const s=Yn(a,o);Bt(s)||n.isFormulaView&&!Bt(a.FormulaInfo)||Po(a.PreviewText)||a.ShowSkeleton||ly(e,t,n,a,l,s,o)}}function ly(e,t,n,o,r,i,l){var a,s;const d=function(e){switch(e){case Wt.Sparkline:return 0;case Wt.InCellImage:return Le;default:throw Error(`marginForImageType: unsupported image type = ${e}`)}}(l),c=n.scaleFactor;var u;const h=c*(null!==(u=null===(a=o.Merge)||void 0===a?void 0:a.OriginDeltaX)&&void 0!==u?u:0);var g;const f=c*(null!==(g=null===(s=o.Merge)||void 0===s?void 0:s.OriginDeltaY)&&void 0!==g?g:0),C=0===h?d:0,m=0===f?d:0,p=i.ClusterOffsetX,y=i.ClusterOffsetY,S=function(e,t,n,o,r){let i=0,l=0;var a,s;ay(r)?(i=null!==(a=r.ClusterImageWidth)&&void 0!==a?a:0,l=null!==(s=r.ClusterImageHeight)&&void 0!==s?s:0):(i=jl(e,o,!1)-t,l=ql(e,o,!1)-n);return{imageWidth:i,imageHeight:l}}(t,C,m,o,i),R=function(e,t,n,o,r,i){let l=0,a=0;return ay(i)?(l=i.Width?i.Width*o-t:0,a=i.Height?i.Height*o-n:0):(l=Jl(e,r)-t,a=Zl(e,r)-n),{imageWidth:l,imageHeight:a}}(t,C,m,c,o,i),w=function(e,t,n,o,r,i,l,a){var s,d;if(!ay(a))return{left:0,right:0,top:0,bottom:0};const c=!!(null===(s=e.PivotTable)||void 0===s?void 0:s.HasExpandCollapseIndicator),u=c?Es*l:0,h=Fd(c)*l,g=Jl(t,e)-r,f=function(e,t,n,o,r,i,l){let a=0,s=0;if(n<=t+r+o)return{left:a,right:s};const d=n-t-o-r;switch(e){case Se.HorizontalAlignment.Right:a=d;break;case Se.HorizontalAlignment.Center:a=s=d/2;break;case Se.HorizontalAlignment.Automatic:case Se.HorizontalAlignment.Left:s=n-t-r}return i?s+=l?o+r:0:a+=l?o+r:0,{left:a,right:s}}(Gl(t,e),n,g,u,h,t.IsRtl,c),C=Zl(t,e)-i;var m;const p=function(e,t,n){let o=0,r=0;if(t>n)return{top:o,bottom:r};const i=n-t;switch(e){case Se.VerticalAlignment.Top:r=i;break;case Se.VerticalAlignment.Center:o=r=i/2;break;case Se.VerticalAlignment.Bottom:default:o=i}return{top:o,bottom:r}}(null!==(m=null===(d=e.CachedStyle)||void 0===d?void 0:d.VerticalAlignment)&&void 0!==m?m:Se.VerticalAlignment.Bottom,o,C);return{left:f.left,right:f.right,top:p.top,bottom:p.bottom}}(o,t,R.imageWidth,R.imageHeight,C,m,c,i),b=Ql(t,o,!1,!0)-h+w.left,I=ia(t,o,!0)-f+w.top,v=Jl(t,o)-C-w.right,F=Zl(t,o)-m-w.bottom,T={x:b,y:I,width:v,height:F},D=function(e,t,n,o,r,i,l){if(!ay(l))return{clusterImageWidth:e,clusterImageHeight:t,imageWidth:n,imageHeight:o};return r<n&&(e*=1-(n-r)/n,n=r),i<o&&(t*=1-(o-i)/o,o=i),{clusterImageWidth:e,clusterImageHeight:t,imageWidth:n,imageHeight:o}}(S.imageWidth,S.imageHeight,R.imageWidth,R.imageHeight,v,F,i);e.drawImage(r,p,y,D.clusterImageWidth,D.clusterImageHeight,b,I,D.imageWidth,D.imageHeight),function(e,t,n,o){if(!(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.ShowDynamicImageCardOnHover,e))return;const r=(0,Se.getRenderingRegionHitTestCache)(e,no(n.renderingRegion)),i=_s(e,n,o,e.IsRtl);Fa(t,r,i,xg,Se.RenderFeaturesZIndex.DynamicImage);const l=qs(e,t,!0,!0),a=qs(e,t,!1,!1);va(t,r,i,Se.RenderFeaturesZIndex.DynamicImage,l,"mouseenter"),va(t,r,i,Se.RenderFeaturesZIndex.DynamicImage,a,"mouseleave")}(t,o,n,T)}function ay(e){return!!(e.ClusterImageWidth&&e.ClusterImageHeight&&e.Width&&e.Height)}const sy=1,dy=1,cy=.5;function uy(e,t,n,o,r,i){const l=o.width;let a;i&&(a=of(t,n,o.left,o.bottom,l,!0)),dr(e,a),Or(e,o);const s=o.bottom-l;r?gy(e,o,s,l):function(e,t,n,o){gy(e,t,n,o),function(e,t,n,o){const r=t+Math.round(o/2)+cy,i=n+sy,l=n+o-sy-dy;e.beginPath(),ur(e,r,i,r,l),e.stroke()}(e,t.left,n,o)}(e,o,s,l),cr(e,a)}function hy(e,t){const n=Math.floor(t*e);return n%2==0?n:n-1}function gy(e,t,n,o){const r=Math.round(n+o/2)-cy,i=t.left+sy+dy,l=t.left+o-dy;e.strokeStyle=t.outerColor,e.beginPath(),ur(e,i,r,l,r),e.stroke()}function fy(e,t,n,o){return function(e){return!!(e.CachedDrawingLayout&&e.CachedDrawingLayout.CellTextLayout&&e.CachedDrawingLayout.CellTextLayout.Width)}(n)?Math.ceil(n.CachedDrawingLayout.CellTextLayout.Width*o):Math.ceil(Kc(e,t,n)*o)}function Cy(e,t,n){var o,r;return!(!(null==n?void 0:n.PivotTable)||!(null==n?void 0:n.PivotTable.CanExpandCollapse)||!gr(n,t.renderingRegion)||Po(n.PreviewText)||n.ShowSkeleton||(null===(r=n.CondFormat)||void 0===r||null===(o=r.Icon)||void 0===o?void 0:o.IconOnly)&&!Pd(n,Jl(e,n),t.scaleFactor))}function my(e,t,n,o){return ar(jl(e,t,!1),Pc(e,t),n,vd(t),0)*o}function py(e,t,n,o){const r=t.PivotTable,i=!!r.ConfirmRequired,l=e.RowNumbers[t.Row]-1,a=e.ColumnNumbers[t.Col]-1,s=e=>{var t,n,o,s,d;return t=e,n=i,o=l,s=a,d=r.SourceIndex,en(di,"externalCallbacks","togglePivotDrill"),di.togglePivotDrillCallback(t,n,o,s,d),!0},d=ua(e,t,!0),c=function(e,t,n){return{isMirrored:!1,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:n,isRtl:e.IsRtl,blockWidth:e.BlockWidth}}(e,n,d),u=(0,Se.getRenderingRegionHitTestCache)(e,no(n.renderingRegion));if(yy(t,u,c,Hg,s),o&&function(e,t){return!(e.x+e.width<t.left)&&(!(e.x>t.left+t.width)&&(!(e.y>t.bottom)&&!(e.y+e.height<t.bottom-t.height)))}(d,o)){const i=function(e,t,n,o){const r=n.width,i=n.left,l=n.bottom-r,a=r,s=r,d=Math.min(a,o.x+o.width-i),c=Math.max(l,o.y),u=Math.min(l+s,o.y+o.height)-c;return{isMirrored:!1,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:{x:Math.max(i,o.x),y:c,width:d,height:u},isRtl:e.IsRtl,blockWidth:e.BlockWidth}}(e,n,o,d);yy(t,u,i,Bg,s),Ta(t,u,i,r.ECButtonTitle,Se.RenderFeaturesZIndex.DrillIndicator),Fa(t,u,i,Dg,Se.RenderFeaturesZIndex.DrillIndicator)}}function yy(e,t,n,o,r){va(e,t,n,Se.RenderFeaturesZIndex.DrillIndicator,r,o),va(e,t,n,Se.RenderFeaturesZIndex.DrillIndicator,Mg,"touchstart")}function Sy(e,t,n,o){const{scaleFactor:r}=n,i=hy(r,ks),l=fy(e,t,o,r),a=Lt(o),s=function(e,t,n,o,r,i){var l;const{scaleFactor:a}=n,s=Es*a;if(i)return e.IsRtl?Math.floor(ta(e,t,!1)-s)-o:Math.floor(Ql(e,t,!1,!1)+s);let d=su(e,t,n.zoom,n.devicePixelRatio),c=0;if((0,Se.isChangeGateEnabled)(Se.ChangeGate.FixCellImageAlignmentWithRichPivotDrill)){const e=Yn(t,Wt.InCellImage);(null==e?void 0:e.Width)&&(c=(null==e?void 0:e.Width)*a)}let u=0;d>0&&t.RichValueIcon&&!(null===(l=t.CondFormat)||void 0===l?void 0:l.Icon)&&(u=d*a,d=0);const h=t.CachedIndent||Ls,g=du(t,h),f=Gl(e,t);if(function(e,t,n,o,r){if(!t.WrapText)return!1;const i=my(e,t,n,r);return t.WrapText&&i<o}(e,t,d,r,a))return function(e,t,n,o,r,i,l,a){const s=function(e,t){return t?e===Se.HorizontalAlignment.Right:e===Se.HorizontalAlignment.Center||e===Se.HorizontalAlignment.Left}(n,e.IsRtl),d=s?du(t,o)*a:Ls;if(e.IsRtl){const o=ta(e,t,!1);return t.WrapText&&d===Ls&&n===Se.HorizontalAlignment.Left&&l<=0?Math.floor(o):Math.min(Math.floor(o-r-i-d),o)}return Math.floor(Ql(e,t,!1,!1)+r+d)}(e,t,f,h,s,o,my(e,t,d,a),a);const C=Xc(e,t,n)*a;switch(f){case Se.HorizontalAlignment.Left:if(e.IsRtl)return Math.min(Math.floor(C+r+c+s),t.RichValueIcon?Math.floor(ta(e,t,!1)-s)-o:Number.MAX_VALUE);const n=(g+d+Es)*a;return Math.floor(Ql(e,t,!1,!1)+n);case Se.HorizontalAlignment.CenterAcrossSelection:case Se.HorizontalAlignment.Center:return e.IsRtl?Math.min(Math.floor(C+r/2+c/2+s),t.RichValueIcon?Math.floor(ta(e,t,!1)-s)-o:Number.MAX_VALUE):Math.max(Math.floor(C-r/2-c/2-u-s)-o,Ql(e,t,!1,!1));case Se.HorizontalAlignment.Right:return e.IsRtl?Math.floor(ta(e,t,!1)-s-g*a)-o:Math.max(Math.floor(C-r-c-u-s)-o,Ql(e,t,!1,!1));default:throw Error(`getAdjustedButtonLeft: unsupported horizontalAlignment: ${f}`)}}(t,o,n,i,l,a),d=function(e,t,n,o,r){var i;if(r)return Math.floor(oa(e,t)-o/2);const l=null===(i=t.CachedStyle)||void 0===i?void 0:i.VerticalAlignment;if(l===Se.VerticalAlignment.Justify)return Math.floor(Math.floor(oa(e,t)-o/2));const a=function(e,t,n,o){const r=ou(t,e);return zc(t,e,r,ql(e,t,!1)-Le,n,void 0).absoluteY*o+Oe-r*o/2/2}(e,t,l,n);return Math.round(a-o/2)}(t,o,r,i,a),c=n.highContrastScheme;return{outerColor:c?Vn(c.TextColor):"#3A3A38",innerColor:c?Vn(c.BackgroundColor):"#FAFAFA",left:s,bottom:d+i,height:i,width:i}}function Ry(e,t,n,o){return su(e,t,n.zoom,n.devicePixelRatio)*n.scaleFactor+(t.Spill?ea(e,t):Ql(e,t,!1,!1))>o.left}function wy(e,t,n){const o=t.left,r=t.bottom-t.height;e.beginPath(),Iy(e,o,r,n,!0,t),vy(e,t,id),e.stroke()}function by(e,t,n){const o=t.left,r=t.bottom-t.height;e.beginPath(),vy(e,t,ad),Iy(e,o,r,n,!1,t),e.stroke()}function Iy(e,t,n,o,r,i){const{width:l}=i,a=r?cd:dd,s=wn(Ks),d=Fy(t,a.x,s,l),c=Fy(n,o?a.y+sd:a.y,s,l),u=Ty(c,o?-sd:sd,l),h=Ty(d,-1,l),g=Ty(d,1,l),f=Ty(u,o?1:-1,l);e.moveTo(d,c),e.lineTo(d,u),e.moveTo(h,f),e.lineTo(g,f)}function vy(e,t,n){if(!n||0===n.length)return;const o=t.left,r=t.bottom-t.height,i=n[0],l=wn(Ks);e.moveTo(Fy(o,i.x,l,t.width),Fy(r,i.y,l,t.width));for(let i=1;i<n.length;i++){const a=n[i];e.lineTo(Fy(o,a.x,l,t.width),Fy(r,a.y,l,t.width))}}function Fy(e,t,n,o){return Math.round(Ty(e,t,o))+n}function Ty(e,t,n){return e+t/td*n}function Dy(e,t,n){(0,Se.verifyArgumentNotNull)(e,"ctx","drawAutoFilters"),(0,Se.verifyArgumentNotNull)(t,"model","drawAutoFilters"),(0,Se.verifyArgumentNotNull)(n,"context","drawAutoFilters");const o=Yo(),r=t.ClientOnlyCache.CellsToRender;let i=!1,l=o?void 0:My(n.highContrastScheme),a=o?void 0:Hy(n.highContrastScheme);const s=n.highContrastScheme;let d;!o&&s&&(d=Py(s,void 0));for(let c=0;c<r.length;c++){const u=r[c];VC(t,n,u,Se.DirtyGridCellArea.EntireCell)&&xy(u,n)&&(i||(e.setLineDash(Qe),e.lineWidth=Ks,o&&(l=My(s),a=Hy(s),s&&(d=Py(s,void 0))),i=!0),s||(d=Py(s,u.AutoFilter?u.AutoFilter.Type:u.PivotFilter.Type)),Ay(e,t,u,n,l,a,d))}}function xy(e,t){const n=e.AutoFilter;if(!n&&!e.PivotFilter)return!1;if(!gr(e,t.renderingRegion))return!1;if(e.PivotFilter)return e.PivotFilter.DisplayFilter;if(!n.RenderingContext)return!1;const{IsHidden:o,IsRenderingPermitted:r}=n.RenderingContext;return!(o||!r||Po(e.PreviewText)||e.ShowSkeleton)}function Ay(e,t,n,o,r,i,l){const a=function(e,t,n,o,r){const i=n.devicePixelRatio,l=ud(e,t,i,n.zoom);return{bottom:pd(e,t,l,i,n.zoom),left:yd(e,t,l,i,n.zoom),height:l,width:l,outerColor:o,innerColor:r,radius:[nd]}}(t,n,o,r,i);kr(e,a);const s=n.PivotFilter,d=n.AutoFilter,c=!(!s||(0,Se.isChangeGateEnabled)(Se.ChangeGate.TakeAutoFilterBeforePivotFilter)&&d);a.width>od&&function(e,t,n,o){switch(e.strokeStyle=o,t){case Se.AutoFilterType.Both:case Se.AutoFilterType.Filtered:!function(e,t){e.beginPath(),vy(e,t,id),vy(e,t,ad),e.stroke()}(e,n);break;case Se.AutoFilterType.BothAsc:case Se.AutoFilterType.BothTop:!function(e,t){by(e,t,!0)}(e,n);break;case Se.AutoFilterType.BothDesc:case Se.AutoFilterType.BothBottom:!function(e,t){by(e,t,!1)}(e,n);break;case Se.AutoFilterType.SortedAsc:case Se.AutoFilterType.SortedTop:!function(e,t){wy(e,t,!0)}(e,n);break;case Se.AutoFilterType.SortedDesc:case Se.AutoFilterType.SortedBottom:!function(e,t){wy(e,t,!1)}(e,n);break;default:!function(e,t){e.beginPath(),vy(e,t,rd),e.stroke()}(e,n)}}(e,c?s.Type:d.Type,a,l);const u=c?s.Title:(0,Se.isChangeGateEnabled)(Se.ChangeGate.AddLocalizedAutoFilterTitleMapping)&&(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.IgnoreAutoFilterTitle",!1)?xi(d.Type):d.Title;if(c&&(0,Se.isChangeGateEnabled)(Se.ChangeGate.AddLocalizedAutoFilterTitleMapping)&&(0,Se.isChangeGateEnabled)(Se.ChangeGate.AddPivotFilterTitleTag)){const e=xi(s.Type)===s.Title;vr.Hv.sendTraceTag(506587149,Fr.n.msoulscat_ES_EWAJSGrid,e?C.k.Info:C.k.Important,`PivotFilter title mapping is correct: ${e}, title in model: ${s.Title} , title in mapping: ${xi(s.Type)}`)}if(function(e,t){const n=t.PivotFilter;if(n)return n.DisplayFilter&&!n.IsHeaderSnapped;if(!e.PermissionSet)return!1;const{IsAutoFilterDisabled:o,IsSortDisabled:r}=e.PermissionSet,i=(0,Se.isPassRibbonCommandsToCanvasRendererEnabled)()||!!e.RibbonCommands;return!(o&&r)&&i}(t,n)){const e=By(t,n),r=t.ColumnNumbers[n.Col];!function(e,t,n,o,r,i,l){const a=Oy(e,n,o),s=(0,Se.getRenderingRegionHitTestCache)(e,no(n.renderingRegion)),d=e=>!0,c=(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.GetAutoFilterItemsOnMousedown",!1)&&!l;Fa(t,s,a,Dg,Se.RenderFeaturesZIndex.AutoFilter),Ta(t,s,a,i,Se.RenderFeaturesZIndex.AutoFilter),va(t,s,a,Se.RenderFeaturesZIndex.AutoFilter,r,"click"),va(t,s,a,Se.RenderFeaturesZIndex.AutoFilter,r,"touchend"),va(t,s,a,Se.RenderFeaturesZIndex.AutoFilter,c?n=>(function(e,t){var n;null===(n=di.requestAndUpdateAutoFilterItems)||void 0===n||n.call(di,e,t)}(By(e,t),e.ColumnNumbers[t.Col]),!0):d,"pointerdown"),va(t,s,a,Se.RenderFeaturesZIndex.AutoFilter,d,"dblclick"),va(t,s,a,Se.RenderFeaturesZIndex.AutoFilter,Mg,"touchstart"),l||Da(t,s,a,Se.RenderFeaturesZIndex.AutoFilter,(e=>(di.onAutoFilterMouseEnter(),!1)))}(t,n,o,a,c?t=>(function(e,t,n,o,r){en(di,"externalCallbacks","showPivotFilterMenu"),di.pivotFilterClickHandlerCallback(e,t,n,o,r)}(t,s.CommandData,s.IsPivotPageField,e,r),!0):n=>(hi(n,(0,Se.isPassRibbonCommandsToCanvasRendererEnabled)()?Ws().ShowAutoFilterMenu:t.RibbonCommands.ShowAutoFilterMenu,d.CommandData,void 0,e,r),!0),u,c)}else{const e=Oy(t,o,a),r=(0,Se.getRenderingRegionHitTestCache)(t,no(o.renderingRegion));Ta(n,r,e,u,Se.RenderFeaturesZIndex.AutoFilter),Fa(n,r,e,xg,Se.RenderFeaturesZIndex.AutoFilter)}}function By(e,t){const n=e.RowNumbers[t.Row];return void 0===e.IsRow||e.IsRow?n:-1}function Hy(e){return e?Vn(e.BackgroundColor):Zs}function My(e){return e?Vn(e.TextColor):Js}function Py(e,t){return e?Vn(e.TextColor):t===Se.AutoFilterType.None?Qs:ed}function Oy(e,t,n){return _s(e,t,{x:n.left,y:n.bottom-n.height,width:n.width,height:n.height},!1)}const ky="#bd67c9",Ey="#808080",Ly=8,Ny="#ff0000",zy=4,Gy=2,Wy=1.5;function Vy(e,t,n,o){const r=Xs+Gy;return ud(e,t,n,o)+Math.round(r*n*o)}function _y(e,t,n,o){let r=Vs(Ly,e,t,n,o,!0,!0);return qy(e,t,r,n,o)&&(r=jy(e,t,r,n,o)),r%2==1?r-1:r}function Uy(e,t,n,o,r){let i=Cp(e,t,n,o,r);return qy(e,t,i,o,r)&&(i=jy(e,t,i,o,r)),i}function jy(e,t,n,o,r){const i=Vy(e,t,o,r),l=or(r*o),a=Jl(e,t)-l-i;return Math.min(n,a)}function qy(e,t,n,o,r){var i,l;if(!t.Comment)return!1;const a=ia(e,t,!1);if(t.AutoFilter&&!(null===(i=t.AutoFilter.RenderingContext)||void 0===i?void 0:i.IsHidden)||(null===(l=t.PivotFilter)||void 0===l?void 0:l.DisplayFilter)){const i=ud(e,t,o,r);if(pd(e,t,i,o,r)-i-n<a)return!0}return!1}function $y(e,t,n,o,r){let i=!1;const l=t.ClientOnlyCache.CellsToRender;for(let d=0;d<l.length;d++){const c=l[d];if(c.Comment&&c.Comment.IsThreadedComment){if(r&&!!c.Comment.IsResolved!==o)continue;if(!Xy(c,n.renderingRegion))continue;const l=_y(t,c,n.devicePixelRatio,n.zoom);if(l<zy)continue;i||(i=!0,e.fillStyle=(a=n.highContrastScheme,s=o,a?Vn(s?a.LinkColor:a.TextColor):s?Ey:ky),e.beginPath()),Yy(e,t,c,n,l,Ky)}}var a,s;i&&e.fill()}function Xy(e,t){return!((0,Se.isChangeGateEnabled)(Se.ChangeGate.HideCommentIndicators)&&e.Comment.IsThreadedComment&&e.Comment.HideCommentIndicator||!gr(e,t))}function Yy(e,t,n,o,r,i,l){const a=function(e,t,n,o,r){const i=function(e,t,n,o,r){const i=qy(e,t,n,o,r)?Vy(e,t,o,r):0;return ta(e,t,e.IsRtl)-(n+i)}(e,t,n,o,r),l=function(e,t,n){return ia(e,t,!1)+n}(e,t,n);return{left:i,bottom:l,width:n,height:n,outerColor:void 0,innerColor:void 0}}(t,n,r,o.devicePixelRatio,o.zoom);i(e,a,l),function(e,t,n,o){const r=(0,Se.getRenderingRegionHitTestCache)(e,no(n.renderingRegion)),i=o.width,l=Math.min(Jl(e,t),Zl(e,t),i*Wy),a=function(e,t,n,o,r){const i=Ql(e,t,e.IsRtl,!1),l=ta(e,t,e.IsRtl),a=n+o-r,s=n+r;return(i>a||s>l)&&i-a>=s-l?n:a}(e,t,o.left,o.width,l),s=_s(e,n,{x:a,y:o.bottom-o.height,width:l,height:l},e.IsRtl),d=Us(e,t,!0,!0),c=Us(e,t,!1,!1);Fa(t,r,s,xg,Se.RenderFeaturesZIndex.Comments),va(t,r,s,Se.RenderFeaturesZIndex.Comments,d,"mouseenter"),va(t,r,s,Se.RenderFeaturesZIndex.Comments,c,"mouseleave")}(t,n,o,a)}function Ky(e,t){const{left:n,bottom:o,width:r,height:i}=t,l=function(e,t,n,o){return[{x:e,y:t},{x:e+n,y:t},{x:e+n,y:t+o},{x:e+n/2,y:t+o/2},{x:e,y:t+o/2},{x:e,y:t}]}(n,o-i,r,i);af(e,l)}function Jy(e,t,n,o){const r=(0,Se.getRenderingRegionHitTestCache)(e,no(n.renderingRegion)),i=Math.min(Jl(e,t),Zl(e,t),25*n.scaleFactor),l=_s(e,n,{x:o.left,y:o.bottom-o.height,width:i,height:i},e.IsRtl);let a=(0,Se.isPassRibbonCommandsToCanvasRendererEnabled)()?Ws().CardViewShowTemporaryErrorCard:e.RibbonCommands.CardViewShowTemporaryErrorCard;const s=js(e,t,a,!0);a=(0,Se.isPassRibbonCommandsToCanvasRendererEnabled)()?Ws().CardViewHideTemporaryCard:e.RibbonCommands.CardViewHideTemporaryCard;const d=js(e,t,a,!1);Fa(t,r,l,xg,Se.RenderFeaturesZIndex.RichError),va(t,r,l,Se.RenderFeaturesZIndex.RichError,s,"mouseenter"),va(t,r,l,Se.RenderFeaturesZIndex.RichError,d,"mouseleave")}function Zy(e,t){return!!e.HasIgnorableError&&!!gr(e,t.renderingRegion)}function Qy(e,t,n){return{left:Ql(e,t,e.IsRtl,!1),bottom:ia(e,t,!1)+n,width:n,height:n,outerColor:void 0,innerColor:void 0}}function eS(e,t){return!(!e.RichValueIcon||!gr(e,t.renderingRegion)||e.DisplayFormula||(0,Se.isChangeGateEnabled)(Se.ChangeGate.DontShowRichValueIconForSpilledArrayFormulasInFormulaView)&&Ir(e,t)||Po(e.PreviewText)||e.ShowSkeleton)}function tS(e,t,n,o,r){n.RichValueIcon.Type===Se.RichValueIconType.LinkedEntity?function(e,t,n){if(!t.RichValueIcon.Unicode)throw Error("drawUnicodeIcon: RichValueIconInformation does not have a char code value.");!function(e,t,n){const{x:o,y:r,height:i}=n,l=r+i;e.fillText(t,o,l)}(e,String.fromCharCode(t.RichValueIcon.Unicode),n)}(e,n,r):function(e,t,n,o){const r=jt(t.RichValueIcon.Type===Se.RichValueIconType.Disambiguation?1:2,n.blockIdentifier);r&&e.drawImage(r,o.x,o.y,o.width,o.height)}(e,n,o,r),function(e,t,n,o){const r=o.y+o.height;let i;if(lf(e,t,o.x,o.width,!1)||rf(e,t,r,o.width)){const r=sf(e,t,n,o);i=_s(e,n,r,!1)}else i=_s(e,n,o,!1);const l=(0,Se.getRenderingRegionHitTestCache)(e,no(n.renderingRegion)),a=function(e){let t;const n=e.RichValueIcon.Type;return n===Se.RichValueIconType.Disambiguation?t=pg.richValueIconDisambigTooltip:n!==Se.RichValueIconType.Sync&&(t=pg.richValueIconShowCard),t}(t);Fa(t,l,i,Dg,Se.RenderFeaturesZIndex.RichValueIcon),va(t,l,i,Se.RenderFeaturesZIndex.RichValueIcon,(e=>({handled:!0,stopPropagation:!1})),"pointerdown"),va(t,l,i,Se.RenderFeaturesZIndex.RichValueIcon,(t=>(hi(t,(0,Se.isPassRibbonCommandsToCanvasRendererEnabled)()?Ws().CardViewShowDataCardOrDisambiguationPane:e.RibbonCommands.CardViewShowDataCardOrDisambiguationPane,""),!0)),"click"),va(t,l,i,Se.RenderFeaturesZIndex.RichValueIcon,Mg,"touchstart"),va(t,l,i,Se.RenderFeaturesZIndex.RichValueIcon,Pg,"touchend"),a&&Ta(t,l,i,a,Se.RenderFeaturesZIndex.RichValueIcon)}(t,n,o,r)}function nS(e,t,n,o,r){const i=Math.round(r*o.scaleFactor),l=function(e,t){if(e.PivotTable)return!0;if(t.PivotTables&&t.PivotTables.length>0)for(let n=0;n<t.PivotTables.length;n++){const o=t.PivotTables[n];if(!o.IsEmptyPivot&&!o.IsOlap&&e.Row>=o.FirstRowIndex&&e.Row<=o.LastRowIndex&&e.Col>=o.FirstColIndex&&e.Col<=o.LastColIndex)return!0}return!1}(n,t);let a=0;if(l)a=function(e,t,n,o,r){var i;const l=xy(n,o),a=t.IsRtl&&l?hd(t,n,o.zoom,o.devicePixelRatio):0;let s=a+Ns+Ql(t,n,!1,!1),d=s;const c=Gl(t,n);let u=0;(null===(i=n.PivotTable)||void 0===i?void 0:i.HasExpandCollapseIndicator)&&(u=Math.round(vd(n)*o.scaleFactor),t.IsRtl||c===Se.HorizontalAlignment.Left||(s+=u));const h=n.CachedIndent||Ls,g=Math.round(du(n,h)*o.scaleFactor),f=Xc(t,n,o)*o.scaleFactor,C=e.font;e.font=Cl(n.CachedFont,void 0,t);const m=fy(e,t,n,o.scaleFactor);e.font!==C&&(e.font=C);const p=(r+zs)*o.scaleFactor;switch(c){case Se.HorizontalAlignment.Left:d=t.IsRtl?Math.max(Math.floor(f-p),s):Math.floor(a+u+Es*o.scaleFactor+g+Ql(t,n,!1,!1));break;case Se.HorizontalAlignment.CenterAcrossSelection:case Se.HorizontalAlignment.Center:t.IsRtl,d=Math.max(Math.floor(f-m/2-p),s);break;case Se.HorizontalAlignment.Right:d=t.IsRtl?Math.max(Math.floor(ta(t,n,!1)-g-Es*o.scaleFactor-u-m-p),s):Math.max(Math.floor(f-m-p),s);break;default:throw Error(`getRichValueIconDrawingContext: unsupported horizontalAlignment: ${c}`)}return d}(e,t,n,o,r);else{const e=xy(n,o),r=(0,Se.isChangeGateEnabled)(Se.ChangeGate.RichIconFilterScale)?o.zoom:o.devicePixelRatio,i=(0,Se.isChangeGateEnabled)(Se.ChangeGate.RichIconFilterScale)?o.devicePixelRatio:o.zoom,l=(0,Se.isChangeGateEnabled)(Se.ChangeGate.RichIconFilterScale)?o.scaleFactor:1;a=(t.IsRtl&&e?ud(t,n,i,r)+Math.round((Ys+Ns)*l):(0,Se.isChangeGateEnabled)(Se.ChangeGate.AddHorizontalPaddingWithScaleFactor)?Math.round(Ns*l):Ns)+Ql(t,n,!1,!1)}const s=function(e,t,n,o){const r=Sc(xC(e,t),pc.CFIcon,void 0,void 0,void 0,void 0,t.DisplayFormula),i=HC(e,t,n,o,r);let l;switch(l=(0,Se.isChangeGateEnabled)(Se.ChangeGate.CellIconBottomPadding)||t.RichValueIcon.Type!==Se.RichValueIconType.LinkedEntity?Math.round(o*vt):0,r){case Se.VerticalAlignment.Bottom:case Se.VerticalAlignment.Top:return i-l;case Se.VerticalAlignment.Center:return MC(e,t,i,o)?Math.floor(oa(e,t)+o/2):i-l;default:throw Error(`getIconVerticalPosition: Vertical alignment ${r} is not supported in RV Icon!`)}}(t,n,o.scaleFactor,i)-i;return{x:a,y:s,width:i,height:i}}function oS(e,t,n,o){if(!n.highContrastScheme){var r,i;const n=null!==(i=null===(r=t.CachedFont)||void 0===r?void 0:r.Color)&&void 0!==i?i:"";e.fillStyle!==n&&(e.fillStyle=n)}const l=`${o.width}px ${It}`;e.font!==l&&(e.font=l)}function rS(e,t){return!(!gr(e,t.renderingRegion)||Po(e.PreviewText)||e.ShowSkeleton||!e.HasError&&!Dd(e))}function iS(e,t,n){const o=(0,Se.getRenderingRegionHitTestCache)(e,no(t.renderingRegion)),r=Jl(e,n),i=Zl(e,n),l=e.IsRtl,a={x:Ql(e,n,l,!1),y:ia(e,n,!1),width:r,height:i};Ta(n,o,{isMirrored:l,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:a,isRtl:l,blockWidth:e.BlockWidth},function(e){if((0,Se.verifyArgumentNotNull)(pg,"gridRendererStrings","getGeneralTooltipStringForCell"),e.HasError)return pg.formulaErrorTooltip;if(Dd(e))return e.OriginalText;throw"getGeneralTooltipStringForCell: unexpected tooltip string"}(n),Se.RenderFeaturesZIndex.GeneralCellTooltip)}let lS;const aS=.25,sS=.25,dS=96*aS,cS=96*sS;function uS(e,t){return!(!e.TableColHeader&&!e.TableRowHeader||!gr(e,t.renderingRegion))}function hS(e,t,n,o){n.TableColHeader&&n.TableRowHeader&&gS(e,t,n,o,2),n.TableColHeader&&gS(e,t,n,o,0),n.TableRowHeader&&gS(e,t,n,o,1)}function gS(e,t,n,o,r){const i=function(e,t,n,o){const r=Ql(e,n,e.IsRtl,!1),i=Jl(e,n),l=ia(e,n,!1),a=Zl(e,n),s=Math.min(dS,a*aS*t.scaleFactor),d=Math.min(cS,i*sS*t.scaleFactor);switch(o){case 0:return{x:r,y:l,width:i,height:s};case 1:return{x:r,y:l,width:d,height:a};case 2:return{x:r,y:l,width:d,height:s};default:throw Error(`getTableSelectorRectInfo: unsupported selector type for table selector event: ${o}`)}}(t,o,n,r);o.debugMode&&function(e,t){Or(e,{outerColor:"#00FF00",innerColor:"",left:t.x,bottom:t.y+t.height,width:t.width,height:t.height})}(e,i);const l=_s(t,o,i,t.IsRtl),a=(0,Se.getRenderingRegionHitTestCache)(t,no(o.renderingRegion)),{cursor:s,zIndex:d}=function(e,t){switch(e){case 0:return{cursor:lS.columnSelectCursor,zIndex:Se.RenderFeaturesZIndex.ColumnOrRowSelector};case 1:return t?{cursor:lS.rowSelectRTLCursor,zIndex:Se.RenderFeaturesZIndex.ColumnOrRowSelector}:{cursor:lS.rowSelectLTRCursor,zIndex:Se.RenderFeaturesZIndex.ColumnOrRowSelector};case 2:return t?{cursor:lS.tableSelectRTLCursor,zIndex:Se.RenderFeaturesZIndex.TableSelector}:{cursor:lS.tableSelectLTRCursor,zIndex:Se.RenderFeaturesZIndex.TableSelector};default:throw Error(`getCursorAndZIndex: unsupported selector type for table selector event: ${e}`)}}(r,t.IsRtl);Fa(n,a,l,s,d),(0,Se.isChangeGateEnabled)(Se.ChangeGate.TableSelectionDragSelection)?(va(n,a,l,d,(e=>(Ci(e,t.RowNumbers[n.Row],t.ColumnNumbers[n.Col],r),2===r)),"pointerdown"),2===r&&va(n,a,l,d,Og,"pointerup")):(va(n,a,l,d,(e=>(Ci(e,t.RowNumbers[n.Row],t.ColumnNumbers[n.Col],r),!0)),"click"),va(n,a,l,d,Og,"pointerdown")),va(n,a,l,d,Og,"dblclick")}let fS=!1;function CS(e,t){return t.zIndex-e.zIndex}function mS(e,t){const n=e,o=e;if("touchstart"===t){const{clientX:e,clientY:t}=n.touches[0];return{clientX:e,clientY:t}}if("touchend"===t){const e=n.changedTouches.length,{clientX:t,clientY:o}=n.changedTouches[e-1];return{clientX:t,clientY:o}}return{clientX:o.clientX,clientY:o.clientY}}function pS(e,t,n,o,r,i){let l;if(0===o&&n===e.length-1)l=e.slice(0);else{l=e.slice(t,n+1),l[0]=0;for(let n=1;n<l.length;n++)l[n]=l[n]-o,l[n]<0&&(Vi(`getHitMapAxisOffsets: Unexpected input params: startOffsetPx: ${o}, startOffset: ${t}, offsets: ${e}`),l.splice(n,1),n--)}if(r){l=function(e,t){const n=e.slice(1).map(((t,n)=>t-e[n])).concat([t-e[e.length-1]]);return e=e.map(((e,o)=>t-e-n[o])).reverse()}(l,i);for(let e=0;e<l.length;e++)l[e]<0&&(Vi(`getHitMapAxisOffsets: Unexpected RTL conversion results: index: ${e}, offset: ${l[e]}`),l.splice(e,1),e--)}return l}class yS{render(e,t,n){let o;try{if(ki=[],Ei=[],!e)return Ni(!1,"render:: canvas is undefined");if(!t)return Ni(!1,"render:: model is undefined");if(!n)return Ni(!1,"render:: context is undefined");if(function(e){fS||(String.prototype.repeat||(String.prototype.repeat=function(e){if(null==this)throw new TypeError("can't convert "+this+" to object");let t=""+this,n=0;if(Bt(e)&&(n=0),e<0)throw new RangeError("repeat count must be non-negative");if(e===1/0)throw new RangeError("repeat count must be less than infinity");if(n=Math.floor(e),0===t.length||0===n)return"";if(t.length*n>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");const o=t.length*n;for(n=Math.floor(Math.log(n)/Math.log(2));n;)t+=t,n--;return t+=t.substring(0,o-t.length),t}),function(){const e=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]*$/;String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(e,"")})}(),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value(e,t){const n=t>0?0|t:0;return this.substring(n,n+e.length)===e}}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){let n=t;return(void 0===n||n>this.length)&&(n=this.length),this.substring(n-e.length,n)===e}),function(e){try{CanvasRenderingContext2D.prototype.getLineDash||(CanvasRenderingContext2D.prototype.getLineDash=function(){return[]},(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.UseOffscreenCanvas,e)&&Qn()&&(OffscreenCanvasRenderingContext2D.prototype.getLineDash||(OffscreenCanvasRenderingContext2D.prototype.getLineDash=function(){return[]})))}catch(e){}}(e),function(e){try{CanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(e){}),(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.UseOffscreenCanvas,e)&&Qn()&&(OffscreenCanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(e){}))}catch(e){}}(e),String.prototype.codePointAt||(String.prototype.codePointAt=function(e){if(null==this)throw TypeError();const t=String(this),n=t.length,o=e?Number(e):0;if(o<0||o>=n)return;const r=t.charCodeAt(o);let i;return r>=55296&&r<=56319&&n>o+1&&(i=t.charCodeAt(o+1),i>=56320&&i<=57343)?1024*(r-55296)+i-56320+65536:r}),function(){try{Array.prototype.map||(Array.prototype.map=function(e){if(null==this)throw new TypeError("this is null or not defined");const t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");let o;arguments.length>1&&(o=arguments[1]);const r=new Array(n);let i=0;for(;i<n;){if(i in t){const n=t[i],l=e.call(o,n,i,t);r[i]=l}i++}return r})}catch(e){}}(),Date.now||(Date.now=function(){return(new Date).getTime()}),fS=!0)}(t),t.RowOffsets.length>Se.MaxAllowedRowColCount)return Ni(!1,`render:: block # of rows = ${t.RowOffsets.length} > MaxAllowedRowColCount`);if(t.ColumnOffsets.length>Se.MaxAllowedRowColCount)return Ni(!1,`render:: block # of columns = ${t.ColumnOffsets.length} > MaxAllowedRowColCount`);if(zi(Gi.GetContextDurationMs,(()=>{this.ctx=e.getContext2d({alpha:!n.subPixelRenderingEnabled}),void 0===this.isDefaultFontFixEnabled&&(this.isDefaultFontFixEnabled=(0,tn.isChangeGateEnabled)("OfficeVSO:8844869_defaultFontCrash")),this.isDefaultFontFixEnabled&&this.ctx?this.ctx.font=Qr:this.isDefaultFontFixEnabled||(this.ctx.font=`${Jr}pt ${Zr}`)})),!this.ctx)return Ni(!1,`render:: ctx is undefined - ${this.prepareOffscreenCanvasMsg(t)}`);const r=function(e,t){en(e.zoom,"context.zoom","extendRenderingContext");const n=e;return n.scaleFactor=e.devicePixelRatio*e.zoom,(0,Se.isPartialHeaderCellRenderingEnabled)()&&(n.isDifferentialRendering=(0,Se.isDifferentialRenderingSupported)(t)),n}(n,t);if(zi(Gi.ModelPreparationsMs,(()=>{this.preprocessModel(t,n.renderingRegion,r)})),((0,Se.isPartialHeaderCellRenderingEnabled)()?r.isDifferentialRendering:(0,Se.isDifferentialRenderingSupported)(t))&&!uo(n.renderingRegion,t))return Ni(!0,"skipped rendering since rendering region doesn't have dirty cells");if(zi(Gi.RenderInternalDurationMs,(()=>{o=this.renderInternal(e,t,r)})),zi(Gi.RegisterHitRegionsMs,(()=>{this.shouldInitializeCanvasHitTest(t,r)&&this.initializeCanvasHitTest(e,t,r.renderingRegion,r.zoom)})),r.renderingRegion.isRendered=!0,Bt(o)&&(o=Ni(!0,"")),o.message+=this.prepareOffscreenCanvasMsg(t),o.succeeded){const e=function(){const e=Mi;Mi="";const t=$i();return Ui=void 0,{message:e,level:t}}();o.message=Bt(o.message)?e.message:o.message+"; "+e.message,o.messageLevel=e.level}}catch(e){return Ni(!1,`exception caught in render: message: ${e.message} name: ${e.name} stack: ${e.stack} error: ${e}`)}return o}setTransform(e,t,n,o,r){t?this.ctx.setTransform(-e,0,0,e,r+n,o):this.ctx.setTransform(e,0,0,e,n,o)}prepareOffscreenCanvasMsg(e){const t=(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.UseOffscreenCanvas,e),n=!!t&&Qn();return"- offscreenCanvasFG: "+(t?`ON offscreenCanvasSupported: ${n}`:"OFF")}initializeCanvasHitTest(e,t,n,o){e.removeAllEventListeners(),function(e,t,n){const o=pS(t.ColumnOffsets,n.startColumn,n.endColumn,n.startOffsetX,t.IsRtl,n.endOffsetX),r=pS(t.RowOffsets,n.startRow,n.endRow,n.startOffsetY,!1);e.setHitMapOffsets(o,r,t.BlockWidth,t.BlockHeight,n)}(e,t,n),e.setAppZoom(o);const r=(0,Se.getRenderingRegionHitTestCache)(t,no(n));ho(r.CellHitRegions,(t=>{e.addRegionEventListener(t)})),ho(r.CellCursorHitRegions,(t=>{e.addCursorRegion(t)})),ho(r.CellTooltipHitRegions,(t=>{e.addTooltipRegion(t)})),ho(r.CellLongPressHitRegions,(t=>{e.addLongPressRegion(t)})),e.optimizeHitMapLookup()}constructor(){this.isDefaultFontFixEnabled=void 0,this.ctx=null}}function SS(e,t,n,o,r){if(en(n,"cell","spillCell.updateCellSpill"),en(t,"model","spillCell.updateCellSpill"),!n.Text||n.WrapText||n.Merge||Rl(n)||n.ValueType===Se.CellValueType.Number||Lt(n))return;pn(t,n,"updateCellSpill");const i=Al(t,n.CachedStyle,n.CachedFont);e.font=fl(n,t);let l=Yc(e,t,n);i&&(l=hg(t,l,ou(n,t),n.CachedStyle),n.Spill=void 0);const a=RS(n,t,l,Se.SpillDirection.End,i,o,r),s=RS(n,t,l,Se.SpillDirection.Start,i,o,r),d=a.isSpillingOutsideOfBlock||s.isSpillingOutsideOfBlock,c=a.isBlockedByCellContent||s.isBlockedByCellContent;if(0===a.spilledOverCellsCount&&0===s.spilledOverCellsCount)return void((d||c)&&(n.Spill={SpanToStart:0,SpanToEnd:0,IsSpillBlocked:!0,IsSpillingOutsideOfBlock:d}));const u=bS(n,t,Se.SpillDirection.Start,i),h=bS(n,t,Se.SpillDirection.End,i),g=IS(u,n,t,Se.SpillDirection.Start),f=IS(h,n,t,Se.SpillDirection.End);n.Spill={SpanToStart:Math.min(s.spilledOverCellsCount,g),SpanToEnd:Math.min(a.spilledOverCellsCount,f),IsSpillBlocked:d||s.spilledOverCellsCount>g||a.spilledOverCellsCount>f,IsSpillingOutsideOfBlock:d}}function RS(e,t,n,o,r,i,l){const a=(0,Se.getCellStyle)(t,e);en(a,"cell.CachedStyle","spillCell.getNumberOfSpilledOverCells");const s=a.HorizontalAlignment||Se.HorizontalAlignment.Automatic,d=!!r||DS(e,s,t.IsRtl);return d?function(e,t,n,o,r,i,l){let a=e.Col,s=function(e,t,n,o,r,i,l){const a=vn(t.Col,e),s=function(e,t){var n;if(!(null===(n=t.PivotTable)||void 0===n?void 0:n.HasExpandCollapseIndicator))return!1;const o=Gl(e,t);return!function(e,t){const n=Gl(e,t);switch(n){case Se.HorizontalAlignment.Left:case Se.HorizontalAlignment.CenterAcrossSelection:case Se.HorizontalAlignment.Center:return!e.IsRtl;case Se.HorizontalAlignment.Right:return e.IsRtl;case Se.HorizontalAlignment.Automatic:default:throw Error(`doesExpandCollapseButtonShiftText: unsupported horizontalAlignment: ${n}`)}}(e,t)||o===Se.HorizontalAlignment.Center}(e,t)?vd(t):0,d=Mc(t,e,i,l)+n+s-a;if(d<=0)return 0;if(o===Se.HorizontalAlignment.Center)return d/2;return TS(o,r,e.IsRtl)?d:0}(t,e,n,o,r,i,l),d=0,c=!1;if(0===s)return{spilledOverCellsCount:d,isSpillingOutsideOfBlock:c,isBlockedByCellContent:!1};const u=t.ColumnNumbers.length;for(a+=r;wS(a,u)&&s>0;)d++,s-=vn(a,t),a+=r;return c=!wS(a,u)&&s>0,{spilledOverCellsCount:d,isSpillingOutsideOfBlock:c,isBlockedByCellContent:!1}}(e,t,n,s,o,i,l):{spilledOverCellsCount:0,isSpillingOutsideOfBlock:!1,isBlockedByCellContent:!d}}function wS(e,t){return e>=0&&e<t}function bS(e,t,n,o){const r=e.Row;let i=e.Col+n;for(;!o&&wS(i,t.ColumnNumbers.length);){const e=(0,Se.getCell)(r,i,t);if(e&&vS(e))return e;i+=n}return null}function IS(e,t,n,o){return e?Math.abs(e.Col-t.Col)-1:o===Se.SpillDirection.End?n.ColumnNumbers.length-t.Col:t.Col}function vS(e){var t;return!(!e||!e.Text&&!(null===(t=e.FormulaInfo)||void 0===t?void 0:t.Formula)&&!e.PreviewText)}function FS(e,t,n,o,r,i,l){const a=IS(t,n,o,r);if(t&&t.Spill){const s=(0,Se.getCellStyle)(o,t);en(s,"blockingCellStyle","spillCell.updateClosestNonEmptyCell");const d=s.HorizontalAlignment||Se.HorizontalAlignment.Automatic,c=-r,u=DS(t,d,o.IsRtl),h=TS(d,c,o.IsRtl);if(u&&h)if(n&&n.Text&&""!==n.Text){const e=(0,Se.getSpilledOverCount)(c,t);t.Spill.IsSpillBlocked=a<=e;const n=Math.min(e,a);n!==e&&(In(o,t),c===Se.SpillDirection.Start?t.Spill.SpanToStart=n:t.Spill.SpanToEnd=n)}else{n.Spill=void 0;const r=(0,Se.getSpilledOverCount)(c,t);SS(e,o,t,i,l),r!==(0,Se.getSpilledOverCount)(c,t)&&In(o,t)}}return a}function TS(e,t,n){return e===Se.HorizontalAlignment.Center||(t===Se.SpillDirection.Start?n?e===Se.HorizontalAlignment.Left:e===Se.HorizontalAlignment.Right:t===Se.SpillDirection.End&&(e===Se.HorizontalAlignment.Automatic||(n?e===Se.HorizontalAlignment.Right:e===Se.HorizontalAlignment.Left)))}function DS(e,t,n){return!e.RichValueIcon||t===Se.HorizontalAlignment.Left||!n&&t===Se.HorizontalAlignment.Automatic}function xS(e,t,n,o){Lt(n)?function(e,t){const n=t.CachedFont.Size,o=BS(e,t,n),r=ql(e,t,!1),i=AS(o,r,n,0,0,!1);t.ShrunkSize=i===n?i:function(e,t,n,o){let r=Math.floor(o);if(r<Yr)return Yr;let i=BS(e,t,r);for(;i<n&&r<Kr;)r+=1,i=BS(e,t,r);for(;i>n&&r>Yr;)r-=1,i=BS(e,t,r);return r}(e,t,r,i)}(t,n):function(e,t,n,o){var r;const{zoom:i,devicePixelRatio:l}=o,a=Cl(n.CachedFont,void 0,t);e.font=a;const s=Kc(e,t,n),d=jl(t,n,!1),c=n.CachedStyle.Indentation||0,u=n.CachedFont.Size,h=fd(t,n)?hd(t,n,i,l):0,g=kc(t,n,u,n.CachedFont.Italic,c||0,!0,h),f=!Bt(null===(r=n.LinkedEntity)||void 0===r?void 0:r.IconWidth)||!!n.RichValueIcon,C=Id(t,n,u,i,l),m=ar(d,g,0,0,function(e,t,n,o){return function(e,t){var n,o;if(!(null===(n=t.CachedStyle)||void 0===n?void 0:n.ShrinkToFit))return!1;const r=(null===(o=t.CachedStyle)||void 0===o?void 0:o.HorizontalAlignment)||Se.HorizontalAlignment.Automatic,i=e.IsRtl?r===Se.HorizontalAlignment.Right:r===Se.HorizontalAlignment.Left;return t.AutoFilter&&i}(e,t)?hd(e,t,n,o):0}(t,n,i,l));if(n.ShrunkSize=AS(s,m,u,g,C,f),n.ShrunkSize<0&&Vi(`\n    ShrinkSize was calculated to be negative: ${n.ShrunkSize},\n    textWidth: ${s},\n    cellWidth: ${d},\n    cellIndentation ${c},\n    maxTextWidth: ${m},\n    originalFontSize: ${u},\n    padding: ${g}\n    `),n.ShrunkSize&&n.ShrunkSize>0){const o=Cl(n.CachedFont,n.ShrunkSize,t);e.font=o,Yc(e,t,n)}}(e,t,n,o)}function AS(e,t,n,o,r,i){if(e+r<t)return n;const l=function(e,t,n,o,r){const i=e+o;return r?Math.max(t-o,0)/(e+n):t/(i+n)}(e,t,o,r,i);return n*l}function BS(e,t,n){return Nc(e,n,t.CachedFont.FontName)*t.CachedDisplayText.length}const HS=1790;function MS(e,t,n,o){if(n.CachedStyle||(n.CachedStyle=(0,Se.getReferencedObjectById)(n.CellStyleId||0,t.Styles)),n.CachedFont||(n.CachedFont=(0,Se.getReferencedObjectById)(n.CachedStyle.FontID||0,t.Fonts)),n.TextRuns){n.CachedFormattedText=function(e,t,n){if(t.TextRuns&&n.Fonts)return{Text:e,TextRuns:t.TextRuns,Fonts:n.Fonts}}(n.Text,n,t);const e=n.CachedFormattedText;for(let o=0;o<n.CachedFormattedText.TextRuns.length;o++){const r=e.TextRuns[o],i=r.FontID||0;try{e.TextRuns[o].CachedFont=(0,Se.getReferencedObjectById)(i,t.Fonts)}catch(e){return vr.Hv.sendTraceTag(520382479,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Warning,"calculateColWidthForMetadata: Exception in getting FontID: "+i+", ich: "+r.StartIndex+" index: "+o+", ModelFontSize: "+t.Fonts.length),n.SrvDx}}}return function(e,t,n,o){(0,Se.verifyArgumentNotNull)(n.CachedStyle,"CachedStyle","Preproccessor::Helper"),(0,Se.verifyArgumentNotNull)(n.CachedFont,"CachedFont","Preproccessor::Helper");let r=0;n.TextRuns&&(r=eh(e,n.CachedFormattedText,t));const i=Cl(n.CachedFont,n.CachedFont.Size,t);e.font!==i&&(e.font=i),n.TextRuns||(r=xc(e,n.Text,!0,!0)),Al(t,n.CachedStyle,n.CachedFont)&&(r=hg(t,r,n.TextRuns&&(0,Se.isChangeGateEnabled)(Se.ChangeGate.FixRotatedTextWidth)?iu(t,n.CachedFormattedText):Nc(t,n.CachedFont.Size,n.CachedFont.FontName),n.CachedStyle)),(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.InCellControls,t)&&(0,Se.isChangeGateEnabled)(Se.ChangeGate.InCellControlWithColAutofit)&&o&&n&&n.InCellControlType===Se.InCellControlType.Checkbox&&(r=xd(n.CachedFont.Size,o));const l=function(e,t){var n;const o=t.CachedStyle.VerticalText,r=t.CachedStyle.Indentation||0,i=o?0:Hc(r),l=(null===(n=t.CachedStyle)||void 0===n?void 0:n.VerticalText)?Nc(e,t.CachedFont.Size,t.CachedFont.FontName):0,a=function(e,t){if(t.CondWidthIcon){var n;const e=null===(n=t.CachedFont)||void 0===n?void 0:n.Size;return Sd(e,1)+Rd(e,1)+Le}if(t.RichValueIcon){const n=Cd(e,t)?Math.round(td+Ys):0;return t.IconWidth||0+zs+n}return 0}(e,t)||0,s=Fd(t.ExpandColButton);let d=0;return t.Autofilter&&(d=td,Cd(e,t)&&(d+=Ys)),i+l+s+a+d}(t,n),a=function(e){const t=xc(e,"1234567890",!0,!0);return Math.ceil(t/10)}(e);return Math.min(Math.round(r+l+a),HS)}(e,t,n,o)}let PS={};function OS(e){return PS[e]}function kS(e){PS[e]=void 0}function ES(e){const t=PS[e];return t?t.SrvDx:-1}function LS(e,t){PS[e]=t}function NS(){PS={}}let zS=!1;function GS(e,t,n){en(e.Cells,"cells","GridCanvasRenderer.initializeCachedObjects"),en(e.Styles,"styles","GridCanvasRenderer.initializeCachedObjects"),en(e.Fonts,"fonts","GridCanvasRenderer.initializeCachedObjects"),(0,Se.preprocessStyles)(e),(0,Se.initModelClientCache)(e),n&&(0,Se.cleanHitTestCache)(e,no(t));const o=function(e){return void 0===zS&&(zS=(0,Se.isGlobalFontsAndCellStylesFlightEnabled)(e)&&(0,Se.isChangeGateEnabled)(Se.ChangeGate.DiffRenderingOptimization)),zS}(e)?e.ClientOnlyCache.CellsToRender:e.Cells;for(let t=0;t<o.length;t++)bn(e,o[t],!1)}function WS(e,t,n,o){!function(e,t){return e.FirstRow>=t.FirstRow&&e.LastRow<=t.LastRow&&e.FirstColumn>=t.FirstColumn&&e.LastColumn<=t.LastColumn}(n,o)?function(e,t,n,o){VS(e,t,n.FirstColumn,n.LastColumn,n.FirstRow,o,!0),VS(e,t,n.FirstColumn,n.LastColumn,n.LastRow,o,!1),_S(e,t,n.FirstRow,n.LastRow,n.FirstColumn,o,!0),_S(e,t,n.FirstRow,n.LastRow,n.LastColumn,o,!1)}(e,t,n,o):function(e,t,n){const o=kg(t,(n.FirstRow-1)%Rt),r=Eg(t,(n.LastRow-1)%Rt),i=Lg(t,(n.FirstColumn-1)%wt),l=Ng(t,(n.LastColumn-1)%wt);void 0!==o&&void 0!==r&&void 0!==i&&void 0!==l&&e.strokeRect(i-bt,o-bt,l-i,r-o)}(e,t,n)}function VS(e,t,n,o,r,i,l){if(r>=i.FirstRow&&r<=i.LastRow){const{start:a,end:s}=zg(i.FirstColumn,i.LastColumn,n,o),d=(r-1)%Rt,c=(s-1)%wt,u=Lg(t,(a-1)%wt),h=Ng(t,c),g=l?kg(t,d):Eg(t,d);void 0!==u&&void 0!==h&&void 0!==g&&function(e,t,n,o){e.moveTo(t,o),e.lineTo(n,o)}(e,u,h,g-bt)}}function _S(e,t,n,o,r,i,l){if(r>=i.FirstColumn&&r<=i.LastColumn){const{start:a,end:s}=zg(i.FirstRow,i.LastRow,n,o),d=(r-1)%wt,c=(s-1)%Rt,u=kg(t,(a-1)%Rt),h=Eg(t,c),g=l?Lg(t,d):Ng(t,d);void 0!==u&&void 0!==h&&void 0!==g&&function(e,t,n,o){e.moveTo(o,t),e.lineTo(o,n)}(e,u,h,g-bt)}}class US extends yS{renderInternal(e,t,n){try{co(n.renderingRegion,t,n);const o=n.scaleFactor,r=Math.round(t.BlockWidth*o),i=n.renderingRegion,l=Math.round(-1*i.startOffsetY*o),a=Math.round(so(t,i)*o),s=(0,Se.isPartialHeaderCellRenderingEnabled)()?n.isDifferentialRendering:(0,Se.isDifferentialRenderingSupported)(t);return s&&(this.setTransform(1,!1,a,l,r),zC(t,this.ctx)),this.setTransform(1,!1,0,0,r),this.clearCanvas(t,e.getWidth(),e.getHeight(),n),this.setTransform(1,t.IsRtl,a,l,r),zi(Gi.DrawGridlinesDurationMs,(()=>function(e,t,n){if(!Er(t,n))return;Xr(e,t);const o=wn(Le),r=Lr(t.BlockWidth,n.scaleFactor,!1),i=Lr(t.BlockHeight,n.scaleFactor,!0);e.beginPath(),e.strokeStyle=Vr(t,n,!1,!1),Gr(e,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,t.BlockWidth*n.scaleFactor,o,i,n.renderingRegion),e.stroke(),e.beginPath(),e.strokeStyle=Vr(t,n,!1,!1),Wr(e,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.BlockHeight*n.scaleFactor,o,r,n.renderingRegion),e.stroke()}(this.ctx,t,n))),n.skeletonMode?(this.setTransform(1,!1,a,l,r),zi(Gi.DrawSkeletonMs,(()=>function(e,t,n){en(e,"ctx","drawSkeleton"),en(t,"model","drawSkeleton"),en(n,"context","drawSkeleton");const o=t.ClientOnlyCache;if(en(o,"ClientOnlyCache","drawSkeleton"),en(o.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","drawSkeleton"),en(o.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","drawSkeleton"),en(t.RowHeights,"RowHeights","drawSkeleton"),en(t.ColumnWidths,"ColumnWidths","drawSkeleton"),n.scaleFactor<Pe||!(0,Se.isChangeGateEnabled)(Se.ChangeGate.SkeletonWithoutGridLines)&&!t.ShowGridLines)return;e.fillStyle="#E4E4E4";const r=ba();r&&e.beginPath();for(let n=0;n<o.RowOffsetsAdjustedForDrawing.length-1;n++){const i=o.RowOffsetsAdjustedForDrawing[n],l=ir(n,o.RowOffsetsAdjustedForDrawing);for(let n=0;n<o.ColOffsetsAdjustedForDrawing.length-1;n++)Ia(e,Cr(n,t),i,rr(n,o.ColOffsetsAdjustedForDrawing),l,r)}r&&e.fill()}(this.ctx,t,n))),this.debugModeDrawings(t,n,a,l,r,s,o),Ni(!0,"finished grid skeleton rendering")):(zi(Gi.ClearGridlinesMs,(()=>{zi(Gi.ClearGridLinesForSpannedCellsMs,(()=>{!function(e,t,n){if(en(t,"model","clearGridLinesForText"),en(e,"ctx","clearGridLinesForText"),en(n,"context","clearGridLinesForText"),!t.ShowGridLines)return;if(!fr(Pn(n),Mn(t.BackgroundColor)))return;const o=t.ClientOnlyCache.CellsToRender,r=wn(Le),i=Lr(t.BlockWidth,n.scaleFactor,!1),l=Lr(t.BlockHeight,n.scaleFactor,!0);Od(e,n,t.BackgroundColor),e.beginPath();for(let a=0;a<o.length;a++){const s=o[a],d=!Bt(s)&&!Bt(s.Spill),c=!Bt(s)&&!Bt(s.Merge)&&(Bt(s.CachedStyle.BackgroundColor)||!Bt(n.highContrastScheme));gr(s,n.renderingRegion)&&(d||c)&&(kd(s,e,t,r,i),c&&la(s)&&Ed(s,e,t,r,l))}e.stroke()}(this.ctx,t,n)})),zi(Gi.ClearGridLinesForPivotTable,(()=>{!function(e,t,n){if(en(t,"model","clearGridLinesForEmptyPivotTables"),en(e,"ctx","clearGridLinesForEmptyPivotTables"),en(n,"context","clearGridLinesForEmptyPivotTables"),!t.ShowGridLines)return;if(!fr(Pn(n),Mn(t.BackgroundColor)))return;if(!t.PivotTables||0===t.PivotTables.length)return;let o=!1;for(let r=0;r<t.PivotTables.length;r++){const i=t.PivotTables[r];if(!i.HideGridLines)continue;if(!i.IsEmptyPivot&&Bt(i.RowHeaderRange))continue;if(!Hd(t,i,n.renderingRegion,!0))continue;o||(e.fillStyle=Hn(n.highContrastScheme,t.BackgroundColor),e.beginPath(),o=!0);const l=Bd(t,i,t.IsRtl),a=Ad(t,i,!0),s=i.OriginPTWidthAdjustedForDrawing-Le,d=i.OriginPTHeightAdjustedForDrawing-Le;e.rect(l,a,s,d)}o&&e.fill()}(this.ctx,t,n)}))})),this.setTransform(1,!1,a,l,r),zi(Gi.DrawBackgroundFillMs,(()=>function(e,t,n){if(en(t.RowOffsets,"model.RowOffsets","drawBackgroundFill"),en(t.ColumnOffsets,"model.ColumnOffsets","drawBackgroundFill"),en(t.RowHeights,"model.RowHeights","drawBackgroundFill"),en(t.ColumnWidths,"model.ColumnWidths","drawBackgroundFill"),en(t.Styles,"model.Styles","drawBackgroundFill"),n.highContrastScheme)return;let o;const r=[],i=t.ClientOnlyCache.GridlineOverridingCellsToRender;for(let l=0;l<i.length;l++){const a=i[l],s=ZC(a);s!==QC.None&&gr(a,n.renderingRegion)&&(la(a)?r.push([a,s]):o=JC(e,t,a,s,o))}for(let n=0;n<r.length;n++){const[i,l]=r[n];o=JC(e,t,i,l,o)}}(this.ctx,t,n))),zi(Gi.DrawPatternMs,(()=>function(e,t,n){if(n.highContrastScheme)return;const o=new Map,r=t.ClientOnlyCache.GridlineOverridingCellsToRender;for(let e=0;e<r.length;e++){const t=r[e];if(!gr(t,n.renderingRegion))continue;const a={styleType:(l=t).CachedStyle.PatternStyle,color:l.CachedStyle.PatternColor},s=a.styleType;if(!s||s===Se.PatternStyleType.Solid)continue;const d=`${(i=a).styleType}_${i.color}`;o.has(d)?o.get(d).push(t):o.set(d,[t])}var i,l;o.forEach(((o,r)=>{const i=function(e){const t={styleType:Se.PatternStyleType.None,color:""};if(!e)return t;const n=e.split("_");return 2!==n.length||(t.styleType=Se.PatternStyleType[Se.PatternStyleType[parseInt(n[0],10)]],t.color=n[1]),t}(r),l=function(e,t){const n=document.createElement("canvas"),o=t<=1?1:Math.trunc(t);n.width=8*o,n.height=8*o;const r=n.getContext("2d");switch(r.scale(o,o),r.fillStyle=e.color,r.strokeStyle=e.color,e.styleType){case Se.PatternStyleType.Gray75:r.beginPath(),r.lineWidth=1,r.moveTo(1+bt,0),r.lineTo(1+bt,n.height),r.moveTo(3+bt,0),r.lineTo(3+bt,n.height),r.moveTo(5+bt,0),r.lineTo(5+bt,n.height),r.moveTo(7+bt,0),r.lineTo(7+bt,n.height),r.stroke(),r.beginPath(),r.setLineDash([1,1]),r.moveTo(bt,0),r.lineTo(bt,n.height),r.moveTo(2+bt,1),r.lineTo(2+bt,n.height),r.moveTo(4+bt,0),r.lineTo(4+bt,n.height),r.moveTo(6+bt,1),r.lineTo(6+bt,n.height),r.stroke();break;case Se.PatternStyleType.Gray50:r.beginPath(),r.setLineDash([1,1]),r.lineWidth=1,r.moveTo(bt,1),r.lineTo(bt,n.height),r.moveTo(1+bt,0),r.lineTo(1+bt,n.height),r.moveTo(2+bt,1),r.lineTo(2+bt,n.height),r.moveTo(3+bt,0),r.lineTo(3+bt,n.height),r.moveTo(4+bt,1),r.lineTo(4+bt,n.height),r.moveTo(5+bt,0),r.lineTo(5+bt,n.height),r.moveTo(6+bt,1),r.lineTo(6+bt,n.height),r.moveTo(7+bt,0),r.lineTo(7+bt,n.height),r.stroke();break;case Se.PatternStyleType.Gray25:r.beginPath(),r.setLineDash([1,1]),r.lineWidth=1,r.moveTo(1+bt,0),r.lineTo(1+bt,n.height),r.moveTo(3+bt,1),r.lineTo(3+bt,n.height),r.moveTo(5+bt,0),r.lineTo(5+bt,n.height),r.moveTo(7+bt,1),r.lineTo(7+bt,n.height),r.stroke();break;case Se.PatternStyleType.Gray125:r.beginPath(),r.setLineDash([1,3]),r.lineWidth=1,r.moveTo(1+bt,3),r.lineTo(1+bt,n.height),r.moveTo(3+bt,1),r.lineTo(3+bt,n.height),r.moveTo(5+bt,3),r.lineTo(5+bt,n.height),r.moveTo(7+bt,1),r.lineTo(7+bt,n.height),r.stroke();break;case Se.PatternStyleType.Gray0625:r.beginPath(),r.setLineDash([1,3]),r.lineWidth=1,r.moveTo(3+bt,1),r.lineTo(3+bt,n.height),r.moveTo(7+bt,3),r.lineTo(7+bt,n.height),r.stroke();break;case Se.PatternStyleType.DiagStripe:r.beginPath(),r.setLineDash([2,2]),r.lineWidth=1,r.moveTo(2,bt),r.lineTo(n.width,bt),r.moveTo(1,1+bt),r.lineTo(n.width,1+bt),r.moveTo(0,2+bt),r.lineTo(n.width,2+bt),r.moveTo(3,3+bt),r.lineTo(n.width,3+bt),r.moveTo(2,4+bt),r.lineTo(n.width,4+bt),r.moveTo(1,5+bt),r.lineTo(n.width,5+bt),r.moveTo(0,6+bt),r.lineTo(n.width,6+bt),r.moveTo(3,7+bt),r.lineTo(n.width,7+bt),r.stroke(),r.fillRect(0,3,1,1),r.fillRect(0,7,1,1);break;case Se.PatternStyleType.ThinDiagStripe:r.beginPath(),r.setLineDash([1,3]),r.lineWidth=1,r.moveTo(3,bt),r.lineTo(n.width,bt),r.moveTo(2,1+bt),r.lineTo(n.width,1+bt),r.moveTo(1,2+bt),r.lineTo(n.width,2+bt),r.moveTo(0,3+bt),r.lineTo(n.width,3+bt),r.moveTo(3,4+bt),r.lineTo(n.width,4+bt),r.moveTo(2,5+bt),r.lineTo(n.width,5+bt),r.moveTo(1,6+bt),r.lineTo(n.width,6+bt),r.moveTo(0,7+bt),r.lineTo(n.width,7+bt),r.stroke();break;case Se.PatternStyleType.ReverseDiagStripe:r.beginPath(),r.setLineDash([2,2]),r.lineWidth=1,r.moveTo(1,bt),r.lineTo(n.width,bt),r.moveTo(2,1+bt),r.lineTo(n.width,1+bt),r.moveTo(3,2+bt),r.lineTo(n.width,2+bt),r.moveTo(0,3+bt),r.lineTo(n.width,3+bt),r.moveTo(1,4+bt),r.lineTo(n.width,4+bt),r.moveTo(2,5+bt),r.lineTo(n.width,5+bt),r.moveTo(3,6+bt),r.lineTo(n.width,6+bt),r.moveTo(0,7+bt),r.lineTo(n.width,7+bt),r.stroke(),r.fillRect(0,2,1,1),r.fillRect(0,6,1,1);break;case Se.PatternStyleType.ThinReverseDiagStripe:r.beginPath(),r.setLineDash([1,3]),r.lineWidth=1,r.moveTo(1,bt),r.lineTo(n.width,bt),r.moveTo(2,1+bt),r.lineTo(n.width,1+bt),r.moveTo(3,2+bt),r.lineTo(n.width,2+bt),r.moveTo(0,3+bt),r.lineTo(n.width,3+bt),r.moveTo(1,4+bt),r.lineTo(n.width,4+bt),r.moveTo(2,5+bt),r.lineTo(n.width,5+bt),r.moveTo(3,6+bt),r.lineTo(n.width,6+bt),r.moveTo(0,7+bt),r.lineTo(n.width,7+bt),r.stroke();break;case Se.PatternStyleType.HorzStripe:r.beginPath(),r.lineWidth=2,r.moveTo(0,1),r.lineTo(n.width,1),r.moveTo(0,5),r.lineTo(n.width,5),r.stroke();break;case Se.PatternStyleType.ThinHorzStripe:r.beginPath(),r.lineWidth=1,r.moveTo(0,1+bt),r.lineTo(n.width,1+bt),r.moveTo(0,5+bt),r.lineTo(n.width,5+bt),r.stroke();break;case Se.PatternStyleType.VertStripe:r.beginPath(),r.lineWidth=2,r.moveTo(1,0),r.lineTo(1,n.height),r.moveTo(5,0),r.lineTo(5,n.height),r.stroke();break;case Se.PatternStyleType.ThinVertStripe:r.beginPath(),r.lineWidth=1,r.moveTo(1+bt,0),r.lineTo(1+bt,n.height),r.moveTo(5+bt,0),r.lineTo(5+bt,n.height),r.stroke();break;case Se.PatternStyleType.ThinHorzCross:r.beginPath(),r.lineWidth=1,r.moveTo(0,1+bt),r.lineTo(n.width,1+bt),r.moveTo(0,5+bt),r.lineTo(n.width,5+bt),r.moveTo(3+bt,0),r.lineTo(3+bt,n.height),r.moveTo(7+bt,0),r.lineTo(7+bt,n.height),r.stroke();break;case Se.PatternStyleType.ThinDiagCross:r.beginPath(),r.setLineDash([1,1]),r.lineWidth=1,r.moveTo(0+bt,0),r.lineTo(0+bt,n.height),r.moveTo(2+bt,0),r.lineTo(2+bt,n.height),r.moveTo(4+bt,0),r.lineTo(4+bt,n.height),r.moveTo(6+bt,0),r.lineTo(6+bt,n.height),r.stroke(),r.beginPath(),r.setLineDash([1,3]),r.moveTo(1+bt,3),r.lineTo(1+bt,n.height),r.moveTo(3+bt,1),r.lineTo(3+bt,n.height),r.moveTo(5+bt,3),r.lineTo(5+bt,n.height),r.moveTo(7+bt,1),r.lineTo(7+bt,n.height),r.stroke();break;case Se.PatternStyleType.DiagCross:r.beginPath(),r.setLineDash([2,2]),r.lineWidth=1,r.moveTo(2,bt),r.lineTo(n.width,bt),r.moveTo(2,1+bt),r.lineTo(n.width,1+bt),r.moveTo(0,2+bt),r.lineTo(n.width,2+bt),r.moveTo(0,3+bt),r.lineTo(n.width,3+bt),r.moveTo(2,4+bt),r.lineTo(n.width,4+bt),r.moveTo(2,5+bt),r.lineTo(n.width,5+bt),r.moveTo(0,6+bt),r.lineTo(n.width,6+bt),r.moveTo(0,7+bt),r.lineTo(n.width,7+bt),r.stroke();break;case Se.PatternStyleType.ThickDiagCross:r.beginPath(),r.lineWidth=1,r.moveTo(0,1+bt),r.lineTo(n.width,1+bt),r.moveTo(0,3+bt),r.lineTo(n.width,3+bt),r.moveTo(0,5+bt),r.lineTo(n.width,5+bt),r.moveTo(0,7+bt),r.lineTo(n.width,7+bt),r.stroke(),r.beginPath(),r.setLineDash([2,2]),r.moveTo(2,0+bt),r.lineTo(n.width,0+bt),r.moveTo(0,2+bt),r.lineTo(n.width,2+bt),r.moveTo(2,4+bt),r.lineTo(n.width,4+bt),r.moveTo(0,6+bt),r.lineTo(n.width,6+bt),r.stroke();break;default:throw Error(`getPatternStyleTile:: Pattern not supported: ${e.styleType}`)}return n}(i,n.devicePixelRatio),a=e.createPattern(l,"repeat");if(!a)throw Error(`CanvasPattern from patternTile is null for ${r}`);e.fillStyle=a;for(let n=0;n<o.length;n++){const r=o[n],i=ca(t,r,!1),l=em(r.Row,r.Col,t)?i.height:i.height-Le;let a=i.width,s=i.x;tm(r.Row,r.Col,t)||(t.IsRtl?s+=Le:a-=Le),e.fillRect(s,i.y,a,l)}}))}(this.ctx,t,n))),zi(Gi.DrawEmptyPivotTableTitleContainers,(()=>function(e,t,n){if((0,Se.verifyArgumentNotNull)(t,"model","drawEmptyPivotTableTitleContainers"),(0,Se.verifyArgumentNotNull)(e,"ctx","drawEmptyPivotTableTitleContainers"),(0,Se.verifyArgumentNotNull)(n,"context","drawEmptyPivotTableTitleContainers"),!t.PivotTables||0===t.PivotTables.length)return;const o=Math.max(Math.round(xs*n.scaleFactor),1),r=wn(o);let i=!1;for(let l=0;l<t.PivotTables.length;l++){const a=t.PivotTables[l];if(!a.IsEmptyPivot)continue;if(a.OriginPTHeight<Hs)continue;if(!Hd(t,a,n.renderingRegion,!1))continue;i||(e.strokeStyle=n.highContrastScheme?Vn(n.highContrastScheme.TextColor):Ds,e.lineWidth=o,e.setLineDash(Qe),e.beginPath(),i=!0);const s=Np(t,a,n.scaleFactor);e.rect(r+s.x,r+s.y,s.width,s.height)}i&&e.stroke()}(this.ctx,t,n))),zi(Gi.DrawEmptyPivotTableImages,(()=>function(e,t,n){if((0,Se.verifyArgumentNotNull)(t,"model","drawEmptyPivotTableImages"),(0,Se.verifyArgumentNotNull)(e,"ctx","drawEmptyPivotTableImages"),(0,Se.verifyArgumentNotNull)(n,"context","drawEmptyPivotTableImages"),t.PivotTables&&0!==t.PivotTables.length)for(let o=0;o<t.PivotTables.length;o++){const r=t.PivotTables[o];if(!r.IsEmptyPivot)continue;if(r.OriginPTHeight<Ps)continue;if(!Hd(t,r,n.renderingRegion,!1))continue;const i=Lp(t,r,n.scaleFactor);if(i.width<80)continue;const l=jt(0,n.blockIdentifier);l?e.drawImage(l,i.x,i.y,i.width,i.height):kp(e,i,n.highContrastScheme)}}(this.ctx,t,n))),zi(Gi.DrawDataBarsMs,(()=>function(e,t,n){(0,Se.verifyArgumentNotNull)(t,"model","drawDataBars"),(0,Se.verifyArgumentNotNull)(e,"ctx","drawDataBars"),(0,Se.verifyArgumentNotNull)(n,"context","drawDataBars");const o=function(e,t){const n=e.ClientOnlyCache.CellsToRender,o=[];for(let s=0;s<n.length;s++){var r;const d=n[s];if(!gr(d,t.renderingRegion))continue;const c=null===(r=d.CondFormat)||void 0===r?void 0:r.DataBar;if(!c)continue;if(Po(d.PreviewText))continue;if(d.ShowSkeleton)continue;const u=c.Direction===Se.ReadingOrderType.RightToLeft||e.IsRtl&&c.Direction===Se.ReadingOrderType.Context,h=ca(e,d,!1),g=oy(h,t.scaleFactor),f=(i=c.AxisPostion,l=g.width,a=u,function(e,t,n){if(e<0||e>t)throw Error("adjustCellCoordinateIfRtl: coordinate is outside of the data bar bounds.");return n?t-e:e}(Math.round(l*i/100),l,a)),C=Zp(c.AxisPostion,g.x,f,h),m=!Bt(C),p=Qp(c.Length,g,f,u,m);o.push({information:c,axis:C,bar:p,isRtl:u})}var i,l,a;return o}(t,n),r=function(e){if(!Bt(e))return`${Vn(e.TextColor)}`}(n.highContrastScheme);!function(e,t,n){let o,r=!1;const i=!Bt(n);for(let l=0;l<t.length;l++){const a=t[l].axis;if(!Bt(a)){if(r||(o=i?n:t[l].information.AxisColor,ty(e,$p,Jp,o),e.beginPath(),r=!0),!i){const n=t[l].information.AxisColor;ny(e,n,o),o=n}ur(e,a.X,a.startY,a.X,a.endY)}}r&&e.stroke()}(e,o,r),Bt(r)&&function(e,t){let n;for(let o=0;o<t.length;o++){const r=t[o],i=r.bar,l=ey(e,r);n!==l&&(e.fillStyle=l,n=l),e.fillRect(i.x,i.y,i.width,i.height)}}(e,o),function(e,t,n){let o,r=!1;const i=!Bt(n);for(let a=0;a<t.length;a++){const s=t[a].information.BorderColor;if(Bt(n)&&Bt(s))continue;const d={x:(l=t[a].bar).x+wn(Xp),y:l.y+wn(Xp),width:Math.max(l.width-Xp,0),height:Math.max(l.height-Xp,0)};r||(o=i?n:s,ty(e,Xp,[],o),e.beginPath(),r=!0),i||(ny(e,s,o),o=s),d.width>0&&e.rect(d.x,d.y,d.width,d.height)}var l;r&&e.stroke()}(e,o,r)}(this.ctx,t,n))),zi(Gi.DrawCFIconsMs,(()=>function(e,t,n){en(e,"ctx","drawConditionalFormattingIcons"),en(t,"model","drawConditionalFormattingIcons"),en(n,"context","drawConditionalFormattingIcons");const o=t.ClientOnlyCache.CellsToRender;o.length>0&&(e.lineWidth=Mr,e.setLineDash(Qe));const r=null!==n.highContrastScheme?n.highContrastScheme:void 0;for(let l=0;l<o.length;l++){var i;const a=o[l];(null==a||null===(i=a.CondFormat)||void 0===i?void 0:i.Icon)&&(Po(a.PreviewText)||a.ShowSkeleton||gr(a,n.renderingRegion)&&Tp(e,t,a,n.scaleFactor,r))}}(this.ctx,t,n))),n.modelFromCache||(zi(Gi.DrawSparklines,(()=>{iy(this.ctx,t,n,Wt.Sparkline)})),zi(Gi.DrawInCellImagesMs,(()=>iy(this.ctx,t,n,Wt.InCellImage)))),zi(Gi.ClearGridlinesForBorderMs,(()=>{!function(e,t,n){if(!t.ShowGridLines)return;if(!fr(Pn(n),Mn(t.BackgroundColor)))return;Wd(t),Od(e,n,t.BackgroundColor);const o=t.ClientOnlyCache.GridlineOverridingCellsToRender;e.beginPath();for(let r=0;r<o.length;r++){const i=o[r],l=oc(i);if(!gr(i,n.renderingRegion))continue;if(!l)continue;if(!l.Borders||0===l.Borders.length||i.CachedStyle.BackgroundColor)continue;const a=l.Borders;for(let n=0;n<a.length;n++){const o=a[n];o.BorderLineStyle!==Se.BorderLineType.None&&(Kd(o.BorderLineStyle)||Jd(o.BorderPosition,t,i)&&$d(e,Je,Xd(t,i,o.BorderPosition,Le),Le))}}e.stroke()}(this.ctx,t,n)})),zi(Gi.DrawBordersMs,(()=>function(e,t,n){Wd(t);const o=or(n.scaleFactor),r=function(e,t,n,o){const r={},i=[],l=[],a={},s=e.ClientOnlyCache.GridlineOverridingCellsToRender;for(let d=0;d<s.length;d++){const c=s[d],u=oc(c);if(!gr(c,o.renderingRegion)&&!ic(c,o.renderingRegion))continue;if(!u)continue;if(!u.Borders||0===u.Borders.length)continue;const h=u.Borders;for(let o=0;o<h.length;o++){const s=h[o];if(s.BorderLineStyle!==Se.BorderLineType.None&&Jd(s.BorderPosition,e,c)){if(s.BorderLineStyle===Se.BorderLineType.Double){let o=c.CachedStyle.BackgroundColor?hr(c.CachedStyle.BackgroundColor):n;(0,Se.isChangeGateEnabled)(Se.ChangeGate.DoubleBorderFormattingFix)&&(o=_d(e,s,c,n)),jd(e,c,Vd(s.BorderPosition,o),t,l,a)}jd(e,c,s,t,i,r)}}}return{distinctBorderTypes:i,borderTypeToLineMap:r,distinctClearingDoubleBorderTypes:l,clearingDoubleBordersToLineMap:a}}(t,o,hr(Hn(n.highContrastScheme,t.BackgroundColor)),n);let i,l;n.highContrastScheme?(l=Vn(n.highContrastScheme.TextColor),i=Vn(n.highContrastScheme.BackgroundColor),qd(e,r.distinctBorderTypes,r.borderTypeToLineMap,o,l),qd(e,r.distinctClearingDoubleBorderTypes,r.clearingDoubleBordersToLineMap,o,i)):(qd(e,r.distinctBorderTypes,r.borderTypeToLineMap,o,void 0),qd(e,r.distinctClearingDoubleBorderTypes,r.clearingDoubleBordersToLineMap,o,void 0))}(this.ctx,t,n))),Pn(n)&&zi(Gi.DrawTableBordersMs,(()=>function(e,t,n){var o;!function(e,t,n){(0,Se.verifyArgumentNotNull)(e,"ctx","drawTableHighlightInHighContrast"),(0,Se.verifyArgumentNotNull)(n,"context","drawTableHighlightInHighContrast"),(0,Se.verifyArgumentNotNull)(t,"model","drawTableHighlightInHighContrast"),(0,Se.verifyArgumentNotNull)(t.RowOffsets,"model.RowOffsets","drawTableHighlightInHighContrast"),(0,Se.verifyArgumentNotNull)(t.ColumnOffsets,"model.ColumnOffsets","drawTableHighlightInHighContrast"),(0,Se.verifyArgumentNotNull)(t.RowNumbers,"model.RowNumbers","drawTableHighlightInHighContrast"),(0,Se.verifyArgumentNotNull)(t.ColumnNumbers,"model.ColumnNumbers","drawTableHighlightInHighContrast")}(e,t,n);const r=null===(o=t.ClientOnlyCache)||void 0===o?void 0:o.TableRangesCache;if(!(r&&r.length>0&&n.highContrastScheme))return;const i={FirstRow:t.RowNumbers[0],FirstColumn:t.ColumnNumbers[0],LastRow:t.RowNumbers[27],LastColumn:t.ColumnNumbers[29]};!function(e,t){e.lineWidth=3,e.strokeStyle=t.highContrastScheme?Vn(t.highContrastScheme.TextColor):"black"}(e,n),e.beginPath();for(let o=0;o<r.length;o++)Gg(r[o],i,n.renderingRegion)&&WS(e,t,r[o],i);e.stroke()}(this.ctx,t,n))),this.setTransform(1,t.IsRtl,a,l,r),zi(Gi.CellTooltipRegistrationMs,(()=>function(e,t,n){(0,Se.verifyArgumentNotNull)(e,"ctx","registerCellsTooltip"),(0,Se.verifyArgumentNotNull)(t,"model","registerCellsTooltip"),(0,Se.verifyArgumentNotNull)(n,"context","registerCellsTooltip");const o=t.ClientOnlyCache.CellsToRender;for(let e=0;e<o.length;e++){const r=o[e];rS(r,n)&&iS(t,n,r)}}(this.ctx,t,n))),zi(Gi.DrawCommentsMs,(()=>function(e,t,n){(0,Se.verifyArgumentNotNull)(e,"ctx","drawComments"),(0,Se.verifyArgumentNotNull)(t,"model","drawComments"),(0,Se.verifyArgumentNotNull)(n,"context","drawComments"),function(e,t,n){let o=!1;const r=t.ClientOnlyCache.CellsToRender;for(let l=0;l<r.length;l++){const a=r[l];if(a.Comment&&!a.Comment.IsThreadedComment){if(!Xy(a,n.renderingRegion))continue;const r=Uy(t,a,8,n.devicePixelRatio,n.zoom);if(r<zy)continue;o||(o=!0,e.fillStyle=(i=n.highContrastScheme)?Vn(i.TextColor):Ny,e.beginPath()),Yy(e,t,a,n,r,mp,lp.Right)}}var i;o&&e.fill()}(e,t,n);const o=(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.GreyOutResolvedCommentIndicators",!1);$y(e,t,n,!1,o),o&&$y(e,t,n,!0,o)}(this.ctx,t,n))),zi(Gi.DrawRichErrorMs,(()=>function(e,t,n){(0,Se.verifyArgumentNotNull)(e,"ctx","drawErrorNotch"),(0,Se.verifyArgumentNotNull)(t,"model","drawErrorNotch"),(0,Se.verifyArgumentNotNull)(n,"context","drawErrorNotch");let o=!1,r=!1;const i=t.ClientOnlyCache.CellsToRender;for(let l=0;l<i.length;l++){const a=i[l];if(!Zy(a,n))continue;o||(r=(0,Se.isPassRibbonCommandsToCanvasRendererEnabled)()?Boolean(Ws().CardViewShowTemporaryErrorCard):!!t.RibbonCommands,(0,Se.verifyArgumentNotNull)(t.RowNumbers,"model.RowNumbers","RowNumbers"),(0,Se.verifyArgumentNotNull)(t.ColumnNumbers,"model.ColumnNumbers","ColumnNumbers"),e.setLineDash(Qe),e.beginPath(),o=!0);const s=Qy(t,a,Cp(t,a,8,n.devicePixelRatio,n.zoom));mp(e,s,lp.Left),r&&Jy(t,a,n,s)}o&&(e.fillStyle=n.highContrastScheme?Vn(n.highContrastScheme.TextColor):"#156712",e.fill())}(this.ctx,t,n))),zi(Gi.RegisterTableSelectorsMs,(()=>function(e,t,n){(0,Se.verifyArgumentNotNull)(e,"ctx","registerTableSelectors"),(0,Se.verifyArgumentNotNull)(t,"model","registerTableSelectors"),(0,Se.verifyArgumentNotNull)(n,"context","registerTableSelectors"),(0,Se.verifyArgumentNotNull)(t.RowNumbers,"model.RowNumbers","registerTableSelectors"),(0,Se.verifyArgumentNotNull)(t.ColumnNumbers,"model.ColumnNumbers","registerTableSelectors");const o=t.ClientOnlyCache.CellsToRender;for(let r=0;r<o.length;r++){const i=o[r];uS(i,n)&&hS(e,t,i,n)}}(this.ctx,t,n))),this.setTransform(n.scaleFactor,!1,a,l,r),zi(Gi.DrawTextDurationMs,(()=>_C(this.ctx,t,n))),zi(Gi.DrawPhoneticTextDurationMs,(()=>function(e,t,n){en(e,"ctx","drawCellsPhoneticText"),en(t,"model","drawCellsPhoneticText"),en(n,"context","drawCellsPhoneticText"),en(t.Cells,"model.Cells","drawCellsPhoneticText");const o=t.ClientOnlyCache.CellsToRender;let r=!1;ig(e,t,n.highContrastScheme);for(let i=0;i<o.length;i++){const l=o[i];if(ag(n,l))try{sg(e,t,n,l),r=!0}catch(e){throw Wi("Error drawSingleCellPhoneticText: "+e),e}}r&&Wi("drawCellsPhoneticText: Phonetic rendered")}(this.ctx,t,n))),zi(Gi.DrawEmptyPivotTableTitleText,(()=>function(e,t,n){if((0,Se.verifyArgumentNotNull)(t,"model","drawEmptyPivotTableTitleText"),(0,Se.verifyArgumentNotNull)(e,"ctx","drawEmptyPivotTableTitleText"),(0,Se.verifyArgumentNotNull)(n,"context","drawEmptyPivotTableTitleText"),!t.PivotTables||0===t.PivotTables.length)return;let o,r=!1;for(let i=0;i<t.PivotTables.length;i++){const l=t.PivotTables[i];if(!l.IsEmptyPivot)continue;if(l.OriginPTHeight<Hs)continue;if(!Hd(t,l,n.renderingRegion,!1))continue;if(!l.PivotTableName)continue;if(!r){const i=(0,Se.getReferencedObjectById)(Se.UniqueStyleID.Default,t.Styles);o=(0,Se.getReferencedObjectById)(i.FontID||0,t.Fonts),Ep(e,o,n.highContrastScheme,t),r=!0}const a=zp(t,l),s=a.x+a.width/2,d=Wc(t,a.y+a.height,a.height,o.Size,o.FontName,Se.VerticalAlignment.Center);dr(e,a),e.fillText(l.PivotTableName,s,d),cr(e,a)}}(this.ctx,t,n))),this.setTransform(1,!1,a,l,r),zi(Gi.DrawTextDecoration,(()=>function(e,t,n){let o,r;e.beginPath();const i=[],l=t.ClientOnlyCache.CellsToRender;for(let c=0;c<l.length;c++){var a,s,d;const u=l[c];if(!gr(u,n.renderingRegion))continue;if(en(u.CachedFont,"cell.CachedFont","drawTextDecoration"),!u.CachedFont.StrikeThrough&&!u.CachedFont.Underline&&!u.TextRuns)continue;if(u.CondFormat&&(null===(a=u.CondFormat)||void 0===a?void 0:a.Icon)&&(null===(d=u.CondFormat)||void 0===d||null===(s=d.Icon)||void 0===s?void 0:s.IconOnly))continue;if(u.ShowSkeleton)continue;en(u.CachedDrawingLayout,"cell.CachedDrawingLayout","drawTextDecoration");const h=u.CachedDrawingLayout.TextOrientationLayout,g=u.CachedDrawingLayout.UnderlineRuns,f=u.CachedDrawingLayout.StrikethroughRuns,C=n.highContrastScheme?pr(u,n.highContrastScheme):void 0;if(h&&Al(t,u.CachedStyle,u.CachedFont)){i.push(u);continue}const{lineColor:m,lineWidth:p}=pu(e,o,r,C,g,f);o=m,r=p}e.stroke(),i.length>0&&function(e,t,n,o){let r,i=-1;const l=[];for(let a=0;a<o.length;a++){const s=o[a],d=(e.RowHeights[s.Row]-Le)*n.scaleFactor,c=e.ClientOnlyCache?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[s.Row]:e.RowOffsets[s.Row];s.Row!==i&&(-1!==i&&cr(t,r),r={x:0,y:c,width:e.BlockWidth*n.scaleFactor,height:d},dr(t,r),i=s.Row),gu&&la(s)?l.push(s):mu(t,n,s)}if(cr(t,r),gu)for(const e of l)mu(t,n,e)}(t,e,n,i)}(this.ctx,t,n))),zi(Gi.DrawExpandCollapseButtonsMs,(()=>function(e,t,n){if((0,Se.verifyArgumentNotNull)(e,"ctx","drawExpandCollapseButtons"),(0,Se.verifyArgumentNotNull)(t,"model","drawExpandCollapseButtons"),(0,Se.verifyArgumentNotNull)(n,"context","drawExpandCollapseButtons"),!t.PivotTables)return;const o=t.ClientOnlyCache.CellsToRender;let r=!1;for(let a=0;a<o.length;a++){var i;const s=o[a];if(!Cy(t,n,s))continue;let d;if(null===(i=s.PivotTable)||void 0===i?void 0:i.HasExpandCollapseIndicator){var l;if(r||(e.lineWidth=Mr,e.setLineDash(Qe),r=!0),e.font=Cl(s.CachedFont,void 0,t),d=Sy(e,t,n,s),(null===(l=s.CondFormat)||void 0===l?void 0:l.Icon)&&Ry(t,s,n,d))continue;uy(e,t,s,d,!!s.PivotTable.IsExpanded,!0)}py(t,s,n,d)}}(this.ctx,t,n))),zi(Gi.DrawRichValueIcons,(()=>function(e,t,n){(0,Se.verifyArgumentNotNull)(e,"ctx","drawRichValueIcons"),(0,Se.verifyArgumentNotNull)(t,"model","drawRichValueIcons"),(0,Se.verifyArgumentNotNull)(n,"context","drawRichValueIcons");const o=t.ClientOnlyCache.CellsToRender;!function(e,t){const n=t.highContrastScheme;e.fillStyle=n?Vn(n.TextColor):We,e.textAlign="left",e.textBaseline="alphabetic"}(e,n);for(let i=0;i<o.length;i++){var r;const l=o[i];if(!eS(l,n))continue;const a=nS(e,t,l,n,l.RichValueIcon.Width),{x:s,y:d,width:c}=a,u=of(t,l,s,d+c,c,!0);(null===(r=l.RichValueIcon)||void 0===r?void 0:r.Type)===Se.RichValueIconType.LinkedEntity&&oS(e,l,n,a),u&&dr(e,u),tS(e,t,l,n,a),u&&cr(e,u)}}(this.ctx,t,n))),zi(Gi.DrawAutoFiltersMs,(()=>Dy(this.ctx,t,n))),(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.InCellControls,t)&&zi(Gi.DrawInCellControls,(()=>function(e,t,n){(0,Se.verifyArgumentNotNull)(e,"ctx","drawInCellControls"),(0,Se.verifyArgumentNotNull)(t,"model","drawInCellControls"),(0,Se.verifyArgumentNotNull)(n,"context","drawInCellControls");const o=t.ClientOnlyCache.CellsToRender;for(let i=0;i<o.length;i++){var r;const l=o[i];NC(l,n)&&(null===(r=l.InCellControlOptions)||void 0===r?void 0:r.Type)===Se.InCellControlType.Checkbox&&PC(e,t,l,n)}}(this.ctx,t,n))),(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.ByExamplePreviewMode,t)&&zi(Gi.DrawSkeletonCellsMs,(()=>function(e,t,n){if(en(e,"ctx","drawSkeletonCells"),en(t,"model","drawSkeletonCells"),en(n,"context","drawSkeletonCells"),n.scaleFactor<Pe)return;const o=t.ClientOnlyCache.CellsToRender;e.fillStyle="#aaaaaa";const r=ba();r&&e.beginPath();for(let i=0;i<o.length;i++){const l=o[i];if(!(null==l?void 0:l.ShowSkeleton))continue;if(!gr(l,n.renderingRegion))continue;const a=ia(t,l,!0),s=Zl(t,l);Ia(e,Ql(t,l,!1,!0),a,Jl(t,l),s,r)}r&&e.fill()}(this.ctx,t,n))),this.setTransform(1,t.IsRtl,a,l,r),n.renderPageLayout&&(zi(Gi.DrawPrintAreasDurationMs,(()=>function(e,t,n){var o;if(function(e){en(e.BlockWidth,"model.BlockWidth","drawPrintAreas"),en(e.BlockHeight,"model.BlockHeight","drawPrintAreas"),en(e.RowNumbers,"model.RowNumbers","drawPrintAreas"),en(e.ColumnNumbers,"model.ColumnNumbers","drawPrintAreas"),en(e.ClientOnlyCache,"ClientOnlyCache","drawPrintAreas"),en(e.ClientOnlyCache.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","drawPrintAreas"),en(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","drawPrintAreas")}(t),!t.PrintAreas)return;Dp(e,n);const r=wn(xp(n)),i=Lr(t.BlockWidth,n.scaleFactor,!1),l=Lr(t.BlockHeight,n.scaleFactor,!0);e.beginPath();for(let d=0;d<(null===(o=t.PrintAreas)||void 0===o?void 0:o.length);d++)a=n.renderingRegion,s=t.PrintAreas[d],!(a.startRow>s.LastRow||a.startColumn>s.LastColumn||a.endRow+1<s.FirstRow||a.endColumn+1<s.FirstColumn||a.startRow>s.FirstRow&&a.startColumn>s.FirstColumn&&a.endRow<s.LastRow&&a.endColumn<s.LastColumn)&&Op(e,t,n,r,l,i,t.PrintAreas[d]);var a,s;e.stroke()}(this.ctx,t,n))),zi(Gi.DrawPageBreaksDurationMs,(()=>function(e,t,n){if(null==t.PageBreaks)return;Dp(e,n);const o=wn(xp(n)),r=Lr(t.BlockWidth,n.scaleFactor,!1),i=Lr(t.BlockHeight,n.scaleFactor,!0);e.beginPath(),function(e,t,n,o,r,i){var l;const a=null===(l=t.PageBreaks)||void 0===l?void 0:l.Row;if(null!=a)for(let l=0;l<a.length;++l)Ap(e,t,n,a[l],o,r,i)}(e,t,n,o,r,i),function(e,t,n,o,r,i){var l;const a=null===(l=t.PageBreaks)||void 0===l?void 0:l.Col;if(null!=a)for(let l=0;l<a.length;++l)Bp(e,t,n,a[l],o,r,i)}(e,t,n,o,r,i),e.stroke()}(this.ctx,t,n)))),(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.ByExamplePreviewMode,t)&&zi(Gi.DrawPreviewCellsModeOverlayMs,(()=>function(e,t,n){const o=qn(e);if(!n.isCellsPreviewMode||!o)return;const r=e.RowNumbers[0],i=e.ColumnNumbers[0];if(!function(e,t,n,o){return(0,Se.verifyArgumentNotNull)(e,"previewRange","isOverlayIntersectsRenderingRegion"),(0,Se.verifyArgumentNotNull)(t,"renderingRegion","isOverlayIntersectsRenderingRegion"),!(e.LastRow<t.startRow+n||e.FirstRow>t.endRow+n||e.FirstColumn<t.startColumn+o||e.LastColumn>t.endColumn+o)}(o,n.renderingRegion,r,i))return;const l=function(e,t){const n=qn(e),o=function(e,t){if(t.FirstRow<e.RowNumbers[0])return-100;let n=Gn(e,t.FirstRow);return n<0&&(n=~n),e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[n]}(e,n),r=function(e,t,n){if(t.LastRow>e.RowNumbers[e.RowNumbers.length-1])return lr(e.BlockHeight,n)+100;let o=Gn(e,t.LastRow);o<0&&(o=~o-1);const r=e.ClientOnlyCache.RowOffsetsAdjustedForDrawing;return r[o]+ir(o,r)}(e,n,t.scaleFactor),i=function(e,t){if(t.FirstColumn<e.ColumnNumbers[0])return-100;let n=Wn(e,t.FirstColumn);return n<0&&(n=~n),e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[n]}(e,n),l=function(e,t,n){if(t.LastColumn>e.ColumnNumbers[e.ColumnNumbers.length-1])return lr(e.BlockWidth,n)+100;let o=Wn(e,t.LastColumn);o<0&&(o=~o-1);const r=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing;return r[o]+rr(o,r)}(e,n,t.scaleFactor);return{x:i,y:o,width:l-i,height:r-o}}(e,n),a=n.highContrastScheme;var s;a||(t.fillStyle="#edebe9",t.globalAlpha=(0,Se.isChangeGateEnabled)(Se.ChangeGate.PreviewCellsSettings)&&(null===(s=e.ClientOnlyCache.PreviewCellsSettings)||void 0===s?void 0:s.RetainCellTextOnPreview)?.1:.4,t.fillRect(l.x,l.y,l.width,l.height),t.globalAlpha=.35,t.shadowColor="#000000",t.shadowBlur=4,t.shadowOffsetY=4),t.strokeStyle=a?Vn(a.TextColor):"#000000",t.lineWidth=a?3:1,t.strokeRect(l.x,l.y,l.width,l.height),t.globalAlpha=1,t.shadowColor="transparent"}(t,this.ctx,n))),s&&this.ctx.restore(),this.debugModeDrawings(t,n,a,l,r,s,o),Ni(!0,"finished rendering"))}catch(e){return Ni(!1,`exception caught in renderInternal: message: ${e.message} name: ${e.name} stack: ${e.stack} error: ${e}`)}}shouldInitializeCanvasHitTest(e,t){return!t.skeletonMode}preprocessModel(e,t,n){(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TableBordersInHighContrast,e)&&Pn(n)&&function(e){const t=(n={FirstRow:e.RowNumbers[0],FirstColumn:e.ColumnNumbers[0],LastRow:e.RowNumbers[27],LastColumn:e.ColumnNumbers[29]},en(di,"externalCallbacks","getTablesRangeContainingRangeCallback"),di.getTablesRangeContainingRange(n,!1));var n;if(t){const n=(0,Se.getModelClientCache)(e);n.TableRangesCache=t,n.DisableDiffRendering=!0}}(e),GS(e,t,this.shouldInitializeCanvasHitTest(e,n)),Rr(e,n.scaleFactor),function(e,t,n){const o=t.ClientOnlyCache.CellsToRender,r=(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.ByExamplePreviewMode,t);for(let i=0;i<o.length;i++){const l=o[i],a=l.CachedFont.Italic,s=l.CachedFont.FontName!==Zr,d=!!l.TextRuns,c=l.CachedFont.Underline!==Se.FontUnderline.None||l.CachedFont.StrikeThrough,u=!!l.AutoFilter;if(l.DisplayFormula=Ln(l,n.isFormulaView),r){const e=qn(t);e&&n.isCellsPreviewMode&&(0,Se.isModelCellContainedInRange)(t,e,l)||(l.PreviewText=void 0,l.PreviewNumFmt=void 0,l.PreviewCellStyle=void 0,(0,Se.isChangeGateEnabled)(Se.ChangeGate.PreviewCellsSettings)&&(l.RetainTextOnPreview=void 0))}else l.PreviewText&&(l.PreviewText=void 0),l.PreviewNumFmt&&(l.PreviewNumFmt=void 0),l.PreviewCellStyle&&(l.PreviewCellStyle=void 0),(0,Se.isChangeGateEnabled)(Se.ChangeGate.PreviewCellsSettings)&&(l.RetainTextOnPreview=void 0);if(l.Text&&(l.CachedDisplayText=kn(l,t)),!l.DisplayFormula&&!Po(l.PreviewText))if(l.Text&&Rl(l)&&xS(e,t,l,n),(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TextWidthClientPhase1,t))if(l.TolType===Se.TolType.Autofit)switch(l.ValueType){case Se.CellValueType.Number:l.Spill=void 0;break;case Se.CellValueType.String:(a||s||c||d||u)&&SS(e,t,l,n.zoom,n.devicePixelRatio)}else(l.TolType===Se.TolType.Spill||u)&&(SS(e,t,l,n.zoom,n.devicePixelRatio),(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.MoveSpillCellBeforeRendering,t)&&(In(t,l),l.Spill&&yo(t,l)));else(a||s||c||d||u)&&SS(e,t,l,n.zoom,n.devicePixelRatio);l.Merge&&to(t,l,n.scaleFactor)}}(this.ctx,e,n),function(e,t){if(e&&0!==e.length)for(let n=0;n<e.length;n++){const o=e[n];o.DeltaXFromOriginPTAdjustedForDrawing=Math.round(o.DeltaXFromOriginPT*t),o.DeltaYFromOriginPTAdjustedForDrawing=Math.round(o.DeltaYFromOriginPT*t),o.OriginPTHeightAdjustedForDrawing=Math.round(o.OriginPTHeight*t),o.OriginPTWidthAdjustedForDrawing=Math.round(o.OriginPTWidth*t)}}(e.PivotTables,n.scaleFactor)}clearCanvas(e,t,n,o){o.subPixelRenderingEnabled||Mn(e.BackgroundColor)?zi(Gi.FillRectDurationMs,(()=>{this.ctx.fillStyle=Hn(o.highContrastScheme,e.BackgroundColor),this.ctx.fillRect(0,0,t,n)})):zi(Gi.ClearRectDurationMs,(()=>{this.ctx.clearRect(0,0,t,n)}))}debugModeDrawings(e,t,n,o,r,i,l){t.debugMode&&(this.setTransform(1,e.IsRtl,n,o,r),function(e,t,n,o){const r=1*n.scaleFactor,i=5*n.scaleFactor,l=function(e,t){return e?Ha.blue:t?Ha.green:Ha.red}(n.modelFromCache,o);!function(e,t,n,o){e.beginPath(),e.lineWidth=1,e.setLineDash([]),e.strokeStyle="white",e.rect(t,t,n,n),e.strokeStyle=o.color,e.rect(t,t,n,n),e.stroke()}(t,r,i,l),function(e,t,n,o,r){var i;const l=(0,Se.getRenderingRegionHitTestCache)(e,no(t.renderingRegion)),a=2*o,s={isMirrored:e.IsRtl,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:{x:n,y:n,width:a,height:a},isRtl:e.IsRtl,blockWidth:e.BlockWidth};let d=null===(i=e.Cells)||void 0===i?void 0:i[0];d||(d=(0,Se.getDefaultCell)(0,0)),Fa(d,l,s,"help",Se.RenderFeaturesZIndex.DebugWatermark),Ta(d,l,s,function(e){let t="";const n=`${e.color} - ${e.infoString}`;return Object.keys(Ha).forEach((e=>t+=`${Ha[e].color} - ${Ha[e].infoString}\n`)),`${n}\n\n${t}`}(r),Se.RenderFeaturesZIndex.DebugWatermark)}(e,n,r,i,l)}(e,this.ctx,t,i),this.setTransform(l,!1,0,0,0),t.isCanvasHitTestDebugHighlight&&Ma(e,this.ctx,t.renderingRegion))}}class jS{static throwErrorWrapper(e,t){Rn(e,`BlockModelAccessor.${t}`)}static verifyArgumentNotNull(e,t,n){en(e,t,`BlockModelAccessor.${n}`)}getColumnWidth(e){return vn(e,this.model)}getRowHeight(e){return jS.verifyArgumentNotNull(this.model.RowHeights,"RowHeights","getRowHeight"),(e>this.model.RowHeights.length-1||e<0)&&jS.throwErrorWrapper("row height requested for a cell which is not in range of the model","getRowHeight"),this.model.RowHeights[e]}getColumnOffset(e){return jS.verifyArgumentNotNull(this.model.ColumnOffsets,"ColumnOffsets","getColumnOffset"),(e>this.model.ColumnOffsets.length-1||e<0)&&jS.throwErrorWrapper("column offset requested for a cell which is not in range of the model","getColumnOffset"),this.model.ColumnOffsets[e]}getRowOffset(e){return jS.verifyArgumentNotNull(this.model.RowOffsets,"RowOffsets","getRowOffset"),(e>this.model.RowOffsets.length-1||e<0)&&jS.throwErrorWrapper("row offset requested for a cell which is not in range of the model","getRowOffset"),this.model.RowOffsets[e]}getRowNumber(e){return jS.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","getRowNumber"),this.model.RowNumbers[e]}getColumnNumber(e){return jS.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnNumber"),this.model.ColumnNumbers[e]}getColumnOffsets(){var e;return null===(e=this.model.ColumnOffsets)||void 0===e?void 0:e.slice()}setColumnOffsets(e){jS.verifyArgumentNotNull(e,"newOffsets","setColumnOffsets"),this.model.ColumnOffsets=e,this.setDirty("setColumnOffsets",Se.DirtyType.ModelCoreChanges)}getColumnNumbers(){var e;return null===(e=this.model.ColumnNumbers)||void 0===e?void 0:e.slice()}setColumnNumbers(e){jS.verifyArgumentNotNull(e,"newNumbers","setColumnNumbers"),this.model.ColumnNumbers=e,this.setDirty("setColumnNumbers",Se.DirtyType.ModelCoreChanges)}getColumnWidths(){var e;return null===(e=this.model.ColumnWidths)||void 0===e?void 0:e.slice()}setColumnWidths(e){jS.verifyArgumentNotNull(e,"newWidths","setColumnWidths"),this.model.ColumnWidths=e,this.setDirty("setColumnWidths",Se.DirtyType.ModelCoreChanges)}setIsColumnWidthFixed(e,t){this.model.FixedColumns&&((e<0||e>=this.model.FixedColumns.length)&&jS.throwErrorWrapper(`columnIndex ${e} is out of bounds!`,"setIsColumnWidthFixed"),this.model.FixedColumns[e]=t)}getRowOffsets(){var e;return null===(e=this.model.RowOffsets)||void 0===e?void 0:e.slice()}setRowOffsets(e){jS.verifyArgumentNotNull(e,"newOffsets","setRowOffsets"),this.model.RowOffsets=e,this.setDirty("setRowOffsets",Se.DirtyType.ModelCoreChanges)}getRowNumbers(){var e;return null===(e=this.model.RowNumbers)||void 0===e?void 0:e.slice()}setRowNumbers(e){jS.verifyArgumentNotNull(e,"newNumbers","setRowNumbers"),this.model.RowNumbers=e,this.setDirty("setRowNumbers",Se.DirtyType.ModelCoreChanges)}getRowHeights(){var e;return null===(e=this.model.RowHeights)||void 0===e?void 0:e.slice()}setRowHeights(e){jS.verifyArgumentNotNull(e,"newHeights","setRowHeights"),this.model.RowHeights=e,this.setDirty("setRowHeights",Se.DirtyType.ModelCoreChanges)}getBlockWidth(){return this.model.BlockWidth}setBlockWidth(e){this.model.BlockWidth=e,this.setDirty("setBlockWidth",Se.DirtyType.ModelCoreChanges)}getBlockHeight(){return this.model.BlockHeight}setBlockHeight(e){this.model.BlockHeight=e,this.setDirty("setBlockHeight",Se.DirtyType.ModelCoreChanges)}isDirty(){var e,t;return null!==(t=null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.IsDirty)&&void 0!==t&&t}isDirtyDueToViewportChangeOnly(){var e;return!!(null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.DirtyType)&&this.model.ClientOnlyCache.DirtyType===Se.DirtyType.ViewportChange}setDirty(e,t){jS.verifyArgumentNotNull(t,"dirtyType","setDirty"),this.setDirtyInternal(t),vr.Hv.sendTraceTag(529278243,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`BlockModelAccessor::setDirty called, caller ${e}`),(0,Se.getModelClientCache)(this.model).DisableDiffRendering=!0}onRenderingCompleted(){const e=(0,Se.getModelClientCache)(this.model);(0,Se.isPartialHeaderCellRenderingEnabled)()?e.DirtyCellsMap=void 0:e.DirtyCellsKeys=void 0,e.DisableDiffRendering=!1,e.IsDirty=!1,e.DirtyTimestamp=void 0,e.DirtyType=Se.DirtyType.None,e.delayRenderingToNextAnimationFrame=Se.DelayRenderToNextAnimationFrameState.None}getColumnIndex(e){return jS.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnIndex"),mn(this.model.ColumnNumbers,0,this.model.ColumnNumbers.length,e,Cn)}getRowIndex(e){return Gn(this.model,e)}getHasTable(){return!!this.model.HasTable}getHasOutline(){return!!this.model.HasOutline}getIsEmptyBlocksSupported(){return Boolean(this.model.IsEmptyBlocksSupported)}getEmptyBlocksFallbackReasons(){var e;return null!==(e=this.model.EmptyBlocksFallbackReasonBitFlag)&&void 0!==e?e:0}getDirtyTimestamp(){var e,t;return null!==(t=null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.DirtyTimestamp)&&void 0!==t?t:-1}getMaxRowOutlineLevelInSheet(){var e;return null!==(e=this.model.MaxRowOutlineLevelInSheet)&&void 0!==e?e:0}getMaxColOutlineLevelInSheet(){var e;return null!==(e=this.model.MaxColOutlineLevelInSheet)&&void 0!==e?e:0}resetCellLookup(){(0,Se.getModelClientCache)(this.model).CellLookup=(0,Se.initCellLookup)(this.model)}setCellsDirty(e){if(e){if((0,Se.isPartialHeaderCellRenderingEnabled)()){this.ensureDirtyCellsMapInitialized();const t=(0,Se.getModelClientCache)(this.model);for(const n of e)t.DirtyCellsMap.set(n,Se.DirtyGridCellArea.EntireCell)}else{this.ensureDirtyCellsKeysInitialized();const t=(0,Se.getModelClientCache)(this.model);t.DirtyCellsKeys=t.DirtyCellsKeys.concat(e)}this.setDirtyInternal(Se.DirtyType.ModelCellChanges)}}getDirtyCellsCount(){var e,t;if((0,Se.isPartialHeaderCellRenderingEnabled)()){if(null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.DirtyCellsMap)return this.model.ClientOnlyCache.DirtyCellsMap.size}else if(null===(t=this.model.ClientOnlyCache)||void 0===t?void 0:t.DirtyCellsKeys)return this.model.ClientOnlyCache.DirtyCellsKeys.filter(Se.uniqueValuesFilter).length;return 0}getDirtyCellsKeys(){var e;return(null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.DirtyCellsKeys)?this.model.ClientOnlyCache.DirtyCellsKeys:[]}getDirtyCellsMap(){var e;return(null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.DirtyCellsMap)?this.model.ClientOnlyCache.DirtyCellsMap:new Map}isDifferentialRenderingSupported(){const e=(0,Se.isDifferentialRenderingSupported)(this.model),t=(0,Se.getModelClientCache)(this.model),n=this.getDirtyCellsCount();return vr.Hv.sendTraceTag(512267551,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`BlockModelAccessor::isDifferentialRenderingSupported result: ${e}, isDisabled: ${t.DisableDiffRendering}, isDirty: ${t.IsDirty}, dirtyCellsCount: ${n}, delayToNextAnimationFrame: ${t.delayRenderingToNextAnimationFrame}`),e}isRenderFlagEnabled(e){return(0,Se.isRenderFlagEnabled)(e,this.model)}overrideHeaderDragImprovementsRenderFlag(e){(0,Se.overrideRenderFlagForMismatch)(this.model,Se.RenderFlagsArray.HeaderDragImprovements,e)}overrideInCellControlCheckboxRenderFlag(e){(0,Se.overrideRenderFlagForMismatch)(this.model,Se.RenderFlagsArray.InCellControls,e)}isDelayRenderingToNextFrame(){return(0,Se.getModelClientCache)(this.model).delayRenderingToNextAnimationFrame===Se.DelayRenderToNextAnimationFrameState.Delay}delayRenderingToNextAnimationFrame(){const e=(0,Se.getModelClientCache)(this.model);e.delayRenderingToNextAnimationFrame!==Se.DelayRenderToNextAnimationFrameState.DoNotDelay&&(e.delayRenderingToNextAnimationFrame=Se.DelayRenderToNextAnimationFrameState.Delay)}doNotDelayRenderingToNextAnimationFrame(){(0,Se.getModelClientCache)(this.model).delayRenderingToNextAnimationFrame=Se.DelayRenderToNextAnimationFrameState.DoNotDelay}overrideGlobalStylesRenderFlag(e){(0,Se.overrideRenderFlagForMismatch)(this.model,Se.RenderFlagsArray.GlobalStylesSlice1,e),(0,Se.overrideRenderFlagForMismatch)(this.model,Se.RenderFlagsArray.GlobalStylesSlice2,e),(0,Se.overrideRenderFlagForMismatch)(this.model,Se.RenderFlagsArray.GlobalStylesSlice3,e)}setDirtyInternal(e,t=!1){const n=(0,Se.getModelClientCache)(this.model);n.IsDirty||(n.DirtyTimestamp=Date.now()),n.IsDirty=!0,n.DirtyType|=e,(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.DelayRenderToNextAnimationFrame,this.model)&&!t&&this.doNotDelayRenderingToNextAnimationFrame()}getOrCreateCanvasContext(){this.canvasInstance||(this.canvasInstance=document.createElement("canvas"));const e=this.canvasInstance.getContext("2d");if(!e)throw Error("GetOrCreateCanvasContext: ctx is undefined");return e}getAutoFilterMenuOffsetsFromCellStartInternal(e,t,n){const o=t*n;this.ensureCachedObjectsInitialized(this.model,e,o),wr(this.model)||Rr(this.model,o);const r=!this.model.IsRtl,i=Ql(this.model,e,!1,r),l=ia(this.model,e,!0),a=ud(this.model,e,n,t),s=yd(this.model,e,a,n,t)-i,d=pd(this.model,e,a,n,t)-l;return{x:Math.round(s/o),y:Math.round(d/o)}}getAutoFilterButtonTotalSizeInternal(e,t,n){const o=t*n;this.ensureCachedObjectsInitialized(this.model,e,o),wr(this.model)||Rr(this.model,o);const r=ud(this.model,e,n,t),i=or(o);return Math.round((r+i)/o)}ensureCachedObjectsInitialized(e,t,n){var o,r,i;jS.verifyArgumentNotNull(e,"model","ensureCachedObjectsInitialized"),jS.verifyArgumentNotNull(t,"cell","ensureCachedObjectsInitialized"),wr(this.model)||Rr(this.model,n),t.CachedStyle&&t.CachedBorderStyle&&t.CachedFont&&t.CachedIndent&&(null===(o=t.CachedDrawingLayout)||void 0===o?void 0:o.UnderlineRuns)&&(null===(r=t.CachedDrawingLayout)||void 0===r?void 0:r.StrikethroughRuns)&&(null===(i=t.CachedDrawingLayout)||void 0===i?void 0:i.CellTextLayout)||bn(e,t,!0);const l=t.Merge;!l||l.HeightAdjustedForDrawing&&l.OriginDeltaXAdjustedForDrawing&&l.WidthAdjustedForDrawing&&l.OriginDeltaYAdjustedForDrawing||to(e,t,n)}ensureDirtyCellsKeysInitialized(){const e=(0,Se.getModelClientCache)(this.model);return e.DirtyCellsKeys||(e.DirtyCellsKeys=[]),e.DirtyCellsKeys}ensureDirtyCellsMapInitialized(){const e=(0,Se.getModelClientCache)(this.model);return e.DirtyCellsMap||(e.DirtyCellsMap=new Map),e.DirtyCellsMap}constructor(e){this.canvasInstance=null,jS.verifyArgumentNotNull(e,"model","constructor"),this.model=e}}class qS extends jS{static verifyArgumentNotNull(e,t,n){en(e,t,`GridBlockModelAccessor.${n}`)}getCell(e,t){return(0,Se.getCell)(e,t,this.model)}shouldCellExistInModel(e,t){if(!this.getCell(e,t))try{(0,Se.validateCellShouldExistInModelUnsafe)(this.model,e,t)}catch(e){return!1}return!0}getOrCreateCell(e,t){return(0,Se.getOrCreateCell)(this.model,e,t)}getUniqueId(){return this.model.UniqueId}getCellStyle(e){return(0,Se.getCellStyle)(this.model,e)}getCellFont(e){return Fn(e,this.model)}hasRichText(e){return qS.verifyArgumentNotNull(e,"cell","hasRichText"),!Bt(null==e?void 0:e.TextRuns)}cloneCellFont(e){const t=Fn(e,this.model);return t?lo(t,t.ID||0,t.RefCount||0):t}getBorderStyle(e){return(0,Se.getCellBorderStyle)(this.model,e)}removeBorder(e){qS.verifyArgumentNotNull(e,"cell","removeBorder"),qS.verifyArgumentNotNull(this.model.BorderStyles,"this.model.BorderStyles","removeBorder"),e.BorderStyleID=e.GlobalBorderStyleID=Se.UniqueStyleID.DefaultBorder,e.CachedBorderStyle=(0,Se.getBorderStyleByID)(e,this.model)}getNumberOfBlockColumns(){return this.model.ColumnNumbers.length}isRtl(){return this.model.IsRtl}setIsRtl(e){this.model.IsRtl=e,this.setDirty("isRtl",Se.DirtyType.ModelCoreChanges)}replaceCellInModel(e,t){qS.verifyArgumentNotNull(e,"cell","replaceCellInModel"),qS.verifyArgumentNotNull(t,"immediateModel","replaceCellInModel"),qS.verifyArgumentNotNull(t.Styles,"immediateModel!.Styles","replaceCellInModel");const n=t.Styles[0];qS.verifyArgumentNotNull(n,"style","replaceCellInModel"),qS.verifyArgumentNotNull(t.Fonts,"immediateModel!.Fonts","replaceCellInModel");const o=this.duplicateAndSetFontsInModel(t.Fonts),r=(0,Se.isGlobalFontsAndCellStylesFlightEnabled)(this.model);r&&(0,Se.getGlobalFontsMap)().process(this.model.Fonts),e.TextRuns&&(e.TextRuns=Co(e.TextRuns,o),r&&mo(e.TextRuns,this.model.Fonts)),n.FontID=o[n.FontID||0],r&&(n.GlobalFontID=(0,Se.getGlobalStyleId)(n.FontID||0,this.model.Fonts)),e.CachedFont=(0,Se.getFontByID)(n,this.model,(null==e?void 0:e.StyleID)||0);const i=Oo(this.model)+1;if(n.ID=i,this.model.Styles.splice(i,0,n),r&&(0,Se.getGlobalCellStylesMap)().process(this.model.Styles),e.StyleID=i,e.CachedStyle=n,r&&(e.GlobalCellStyleID=(0,Se.getGlobalStyleId)(i,this.model.Styles)),!Bt(t.BorderStyles)){const n=t.BorderStyles[0];!Bt(n)&&!Bt(n.Borders)&&n.Borders.length>0&&(n.RefCount=1,(0,Se.isGlobalBorderStylesEnabled)(this.model)?this.setBordersNew(e,n,!1):this.setBorders(e,n))}if(this.getCell(e.Row,e.Col)){const t=Tn(e,this.model.Cells);this.model.Cells[t]=e,this.model.ClientOnlyCache.CellLookup[(0,Se.getCellLookupKey)(e.Row,e.Col)]=e}else this.attachCellToModel(e);n.RefCount=1}attachCellToModel(e){wo(e,this.model)}shouldApplyBorderAtPosition(e,t){return qS.verifyArgumentNotNull(e,"cell","shouldApplyBorderAtPosition"),qS.verifyArgumentNotNull(t,"borderPosition","shouldApplyBorderAtPosition"),function(e,t,n){if(t===Se.BorderPositionType.Top||t===Se.BorderPositionType.Left)return yn(e,t)&&Sn(e,t);const o=jo(e,t,n),r=qo(t);return o&&null!=r?!!(Xo(t)&&xn(e,t,o)||$o(t)&&Dn(e,t,o))||Sn(o,r)&&!yn(o,r):yn(e,t)}(e,t,this.model)}shouldRemoveBorderAtPosition(e,t){return qS.verifyArgumentNotNull(e,"cell","shouldRemoveBorderAtPosition"),qS.verifyArgumentNotNull(t,"borderPosition","shouldRemoveBorderAtPosition"),function(e,t,n){const o=jo(e,t,n),r=qo(t);if(o&&null!=r){if(Xo(t)&&xn(e,t,o)||$o(t)&&Dn(e,t,o))return!1;if(t===Se.BorderPositionType.Right||t===Se.BorderPositionType.Bottom)return Sn(o,r)&&!yn(o,r)}return yn(e,t)&&Sn(e,t)}(e,t,this.model)}deleteCellFromModel(e){qS.verifyArgumentNotNull(e,"cell","deleteCellFromModel"),qS.verifyArgumentNotNull(this.model.Cells,"this.model.Cells","deleteCellFromModel");const t=(0,Se.getCell)(e.Row,e.Col,this.model);if(!t)return;if(t.Row!==e.Row||t.Col!==e.Col)return;const n=!!e.Merge;let o=0,r=0;const i=Tn(e,this.model.Cells);n&&(o=e.Merge.Rows,r=e.Merge.Columns);for(let t=e.Row;t<=e.Row+o;t++)for(let n=e.Col;n<=e.Col+r;n++)delete this.model.ClientOnlyCache.CellLookup[(0,Se.getCellLookupKey)(t,n)];this.model.Cells.splice(i,1)}prepareCellStyleForEdit(e){qS.verifyArgumentNotNull(e,"cell","prepareCellStyleForEdit");const t=(0,Se.isGlobalFontsAndCellStylesFlightEnabled)(this.model),n=(null==e?void 0:e.StyleID)||0;let o;if(t)try{o=(0,Se.getReferencedObjectById)(n,this.model.Styles)}catch(t){const n=`PrepareCellStyleEdit: Exception while retrieving cell style with message: ${t} and stacktrace: ${new Error(t).stack||""}`;vr.Hv.sendTraceTag(507601601,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Important,n),o=this.getCellStyle(e)}else o=this.getCellStyle(e);if(Bt(e.CachedStyle)&&(e.CachedStyle=o),!t&&!this.isStyleUnique(o.ID||0)&&(o.RefCount||0)<=1)return!0;const r=Oo(this.model)+1,i=oo(this.model,o,r,1);return o.RefCount=Math.max(0,(o.RefCount||0)-1),this.model.Styles.splice(r,0,i),e.CachedStyle=i,e.StyleID=r,!1}updateGlobalCellStyleIDAfterEdit(e){qS.verifyArgumentNotNull(e,"cell","updateGlobalCellStyleIDAfterEdit");const t=this.getCellStyle(e);if(void 0===t.GlobalFontID||null===t.GlobalFontID)return void(e.GlobalCellStyleID=void 0);const n=(0,Se.getGlobalCellStylesMap)().getOrCreateID(t);e.GlobalCellStyleID=n,e.CachedStyle=(0,Se.getCellStyleByID)(e,this.model)}setDefaultHyperlinkStyleOnCell(e){qS.verifyArgumentNotNull(e,"cell","setDefaultHyperlinkStyleOnCell");const t=(0,Se.getReferencedObjectById)(Se.UniqueStyleID.Hyperlink,this.model.Styles);e.StyleID=Se.UniqueStyleID.Hyperlink,e.CachedStyle=t,t.RefCount=ao(t.RefCount||0)}hideCommentIndicators(e){qS.verifyArgumentNotNull(e,"isCommentIndicatorHidden","hideCommentIndicators"),qS.verifyArgumentNotNull(this.model,"this.model","hideCommentIndicators");let t=!1;if(e&&this.model){const o=this.model.Cells||[];for(const r of o){var n;if(null==r||null===(n=r.Comment)||void 0===n?void 0:n.IsThreadedComment){const n=e(this.getRowNumber(r.Row),this.getColumnNumber(r.Col));this.getHideCommentIndicator(r)!==n&&(this.setHideCommentIndicator(r,n),this.setCellAndSpannedOverCellsDirty(r),t=!0)}}}return t}editCellFontAttributes(e,t){if(qS.verifyArgumentNotNull(e,"cell","editFont"),qS.verifyArgumentNotNull(e,"editFontAction","editFont"),this.attachCellToModel(e),this.prepareFontForEdit(e),e.TextRuns)for(let n=0;n<e.TextRuns.length;n++){const o=e.TextRuns[n];Bt(o.CachedFont)&&(o.CachedFont=(0,Se.getReferencedObjectById)(o.FontID||0,this.model.Fonts)),t(o.CachedFont)}t(e.CachedFont)}copyCacheItemsToModel(e){en(e,"sourceModel","copyClientOnlyCacheToNewModel"),(null==e?void 0:e.ClientOnlyCache)&&(this.model.ClientOnlyCache||(this.model.ClientOnlyCache={}),this.model.ClientOnlyCache.RenderingRegionsHitTestCache=e.ClientOnlyCache.RenderingRegionsHitTestCache)}prepareFontForEdit(e){if(null==e?void 0:e.TextRuns)for(let t=0;t<e.TextRuns.length;t++){const n=e.TextRuns[t],o=Bt(n.CachedFont)?(0,Se.getReferencedObjectById)(n.FontID||0,this.model.Fonts):n.CachedFont;this.prepareTextRunFontForEdit(o,n)}this.prepareCellFontForEdit(e)}prepareBorderStyleForEdit(e){return qS.verifyArgumentNotNull(e,"cell","prepareBorderStyleForEdit"),Wo(e,this.model)}addLeftBorderToAdjacentCell(e){return qS.verifyArgumentNotNull(e,"cell","addLeftBorderToAdjacentCell"),function(e,t){if(en(e,"cell","addLeftBorderToAdjacentCell"),e.Col===t.ColumnNumbers.length-1)return;const n=(0,Se.getOrCreateCell)(t,e.Row,e.Col+1);wo(n,t);const o=(0,Se.getCellBorderStyle)(t,e);if(!o||0===o.Borders.length)return;let r;for(let e=0;e<o.Borders.length;e++){const t=o.Borders[e];if(t.BorderPosition===Se.BorderPositionType.Left){r={BorderLineStyle:t.BorderLineStyle,BorderPosition:Se.BorderPositionType.Left,Color:t.Color,Weight:t.Weight};break}}r&&bo(n,t,r,Se.BorderPositionType.Left)}(e,this.model)}cloneBorderStyle(e){qS.verifyArgumentNotNull(e,"cell","cloneBorderStyle");const t=this.getBorderStyle(e);return io(t,t.ID||0,1)}setBorders(e,t){return Ro(e,this.model,t)}setBordersNew(e,t,n){return qS.verifyArgumentNotNull(e,"cell","setBordersNew"),qS.verifyArgumentNotNull(e,"newBorderStyle","setBordersNew"),Vo(e,this.model,t,n)}afterBorderStyleEdit(e){return qS.verifyArgumentNotNull(e,"cell","afterBorderStyleEdit"),_o(e,this.model)}afterFontEdit(e){if(qS.verifyArgumentNotNull(e,"cell","afterFontEdit"),null==e?void 0:e.TextRuns)for(let t=0;t<e.TextRuns.length;t++){const n=e.TextRuns[t];Bt(n.CachedFont)&&(n.CachedFont=(0,Se.getFontByID)(n,this.model,void 0));const o=(0,Se.getGlobalFontsMap)().getOrCreateID(n.CachedFont);n.GlobalFontID=o}const t=(0,Se.getGlobalFontsMap)().getOrCreateID(null==e?void 0:e.CachedFont);e.CachedFont.GlobalId=t,e.CachedStyle.GlobalFontID=t,e.CachedFont=(0,Se.getFontByID)(e.CachedStyle,this.model,(null==e?void 0:e.StyleID)||0),this.updateGlobalCellStyleIDAfterEdit(e)}setInCellControlOptions(e,t){qS.verifyArgumentNotNull(e,"cell","setInCellControlOptions"),(0,Se.isChangeGateEnabled)(Se.ChangeGate.FixCopyBlankCellToACellWithCheckbox)?e.InCellControlOptions=t||void 0:(qS.verifyArgumentNotNull(t,"controlOptions","setInCellControlOptions"),t&&(e.InCellControlOptions=t))}getInCellControlOptions(e){return qS.verifyArgumentNotNull(e,"cell","getInCellControlOptions"),(0,Se.isChangeGateEnabled)(Se.ChangeGate.FixCopyBlankCellToACellWithCheckbox)||e.InCellControlOptions?e.InCellControlOptions:null}setHideCommentIndicator(e,t){qS.verifyArgumentNotNull(e,"cell","setHideCommentIndicator"),e&&e.Comment&&(e.Comment.HideCommentIndicator=t)}getHideCommentIndicator(e){return qS.verifyArgumentNotNull(e,"cell","getHideCommentIndicator"),!!(e&&e.Comment&&e.Comment.HideCommentIndicator)&&e.Comment.HideCommentIndicator}getCellCssFont(e){return pn(this.model,e,"getCellCssFont"),fl(e,this.model)}setCellAndSpannedOverCellsDirty(e){e&&(In(this.model,e),this.setDirtyInternal(Se.DirtyType.ModelCellChanges))}setAdjacentCellsDirty(e){if(!e)return;const t=(0,Se.isChangeGateEnabled)(Se.ChangeGate.AdjacentCellsMergeFix)?(0,Se.getAdjacentCellsKeys)(this.model,e):(0,Se.getAdjacentCellsKeysOld)(this.model,e.Row,e.Col);this.setCellsDirty(t)}getCalcBlockModel(){const e=new Se.CalcBlockModel,t=this.model.RowNumbers.slice(),n=this.model.ColumnNumbers.slice();e.addHeaders(t,n);for(let t=0;t<this.model.Cells.length;t++){const n=this.model.Cells[t],o=e.createCell(n);e.addCell(o)}return e}updateCellSpillInformation(e,t,n){var o,r;pn(this.model,e,"updateCellSpillInformation");const i=t*n;if(wr(this.model)||Rr(this.model,i),Bt(null==e||null===(o=e.CachedDrawingLayout)||void 0===o?void 0:o.CellTextLayout)||(e.CachedDrawingLayout.CellTextLayout={}),e.Merge)return;if((null==e||null===(r=e.CachedStyle)||void 0===r?void 0:r.HorizontalAlignment)===Se.HorizontalAlignment.CenterAcrossSelection)return;this.setCellAndSpannedOverCellsDirty(e),e.Spill=void 0;let l=null;l=this.getOrCreateCanvasContext(),this.setContextCellFont(l,e),(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.MoveSpillCellBeforeRendering,this.model)?e.TolType=Se.TolType.Spill:(SS(l,this.model,e,t,n),void 0!==e.Spill&&this.removeBordersWithinASpillCell(e),this.setCellAndSpannedOverCellsDirty(e))}updateTolType(e){if(pn(this.model,e,"updateTolType"),(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TextWidthClientPhase1,this.model)){let t=null;t=this.getOrCreateCanvasContext(),this.setContextCellFont(t,e);const n=jl(this.model,e,!0),o=xc(t,e.Text,!0,!0);if(e.ValueType===Se.CellValueType.Number)o/n*100>yi(9,80)&&(e.TolType=Se.TolType.Autofit);else if(null==e?void 0:e.Spill){const t=aa(e,this.model),n=o/(t-this.model.ColumnWidths[ga(e,this.model)])*100;o/t*100>yi(10,80)&&(e.TolType=Se.TolType.Spill),n<yi(11,120)&&(e.TolType=Se.TolType.Spill)}}}updateClosestNonEmptyCellsSpillInformation(e,t,n){qS.verifyArgumentNotNull(e,"cell","updateClosestNonEmptyCellsSpillInformation"),pn(this.model,e,"updateClosestNonEmptyCellsSpillInformation");let o=null;o=this.getOrCreateCanvasContext(),this.setContextCellFont(o,e),function(e,t,n,o,r){const i=Al(n,t.CachedStyle,t.CachedFont),l=bS(t,n,Se.SpillDirection.Start,i),a=bS(t,n,Se.SpillDirection.End,i);FS(e,l,t,n,Se.SpillDirection.Start,o,r),FS(e,a,t,n,Se.SpillDirection.End,o,r)}(o,e,this.model,t,n)}getUserInput(e){return qS.verifyArgumentNotNull(e,"cell","getUserInput"),e.UserInput}setUserInput(e,t){qS.verifyArgumentNotNull(e,"cell","setUserInput"),qS.verifyArgumentNotNull(t,"userInput","setUserInput"),e.UserInput=t}clearCellFormat(e){const t=(0,Se.getReferencedObjectById)(Se.UniqueStyleID.Default,this.model.Styles);e.StyleID=Se.UniqueStyleID.Default,e.CachedStyle=t,e.CachedFont=(0,Se.getFontByID)(t,this.model,Se.UniqueStyleID.Default),e.BorderStyleID=e.GlobalBorderStyleID=Se.UniqueStyleID.DefaultBorder,e.CachedBorderStyle=(0,Se.getBorderStyleByID)(e,this.model)}getCellWidth(e,t){return qS.verifyArgumentNotNull(e,"cell","getCellWidth"),jl(this.model,e,t)}getHorizontalPadding(e,t,n){qS.verifyArgumentNotNull(e,"cell","getHorizontalPadding");const o=t*n;return this.ensureCachedObjectsInitialized(this.model,e,o),Mc(e,this.model,t,n)}getCellHeight(e,t){return qS.verifyArgumentNotNull(e,"cell","getCellHeight"),ql(this.model,e,t)}getTextMaxWidth(e,t,n){qS.verifyArgumentNotNull(e,"cell","getTextDrawingMaxWidth");const o=t*n;return this.ensureCachedObjectsInitialized(this.model,e,o),ar(this.getCellWidth(e,!0),Mc(e,this.model,t,n),su(this.model,e,t,n),vd(e),0)}getFormattedText(e){qS.verifyArgumentNotNull(e,"cell","getFormattedText"),qS.verifyArgumentNotNull(this.model.Fonts,"this.model.Fonts","getFormattedText");const t=[],n=[],o=(0,Se.isGlobalFontsAndCellStylesFlightEnabled)(this.model),r=(e,t)=>{if(o)i(e,t);else if(!n[e])if(e<this.model.Fonts.length){const t=this.model.Fonts[e];n[e]=lo(t,t.ID||0,t.RefCount||0)}else jS.throwErrorWrapper(`Font ${e} does not exist`,"getFormattedText")},i=(e,t)=>{if(!n[e]){const o=(0,Se.getFontByID)(t,this.model,void 0);n[e]=lo(o,e||0,o.RefCount||0)}};if(e.TextRuns)e.TextRuns.forEach((e=>{r(e.FontID||0,e),t.push(po(e))}));else{let n=e.CachedStyle?e.CachedStyle:this.getCellStyle(e);(0,Se.isChangeGateEnabled)(Se.ChangeGate.StyleIdCrashFix)?n=(0,Se.getCellStyleByID)(e,this.model):(0,Se.isGlobalFontsAndCellStylesFlightEnabled)(this.model)&&(n=(0,Se.getReferencedObjectById)((null==e?void 0:e.StyleID)||0,this.model.Styles));const o={FontID:n.FontID||0,StartIndex:0};r(n.FontID||0,n),t.push(o)}return{Text:e.Text||"",TextRuns:t,Fonts:n}}getNoControlPhoneticText(e,t){return qS.verifyArgumentNotNull(e,"phoneticInfo","getNoControlPhoneticText"),qS.verifyArgumentNotNull(t,"cellText","getNoControlPhoneticText"),og(e,t)}prepareTextRunFontForEdit(e,t){!(0,Se.isGlobalFontsAndCellStylesFlightEnabled)(this.model)&&(e.RefCount||0)<=1||this.duplicateAndSetNewFontOnTextRun(e,t)}prepareCellFontForEdit(e){var t;const n=this.prepareCellStyleForEdit(e),o=(0,Se.isGlobalFontsAndCellStylesFlightEnabled)(this.model),r=(null==e||null===(t=e.CachedStyle)||void 0===t?void 0:t.FontID)||0;let i;if(o)try{i=(0,Se.getReferencedObjectById)(r,this.model.Fonts)}catch(t){const n=`PrepareCellFontEdit: Exception while retrieving font with message: ${t} and stacktrace: ${new Error(t).stack||""}`;vr.Hv.sendTraceTag(507601600,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Important,n),i=this.getCellFont(e)}else i=this.getCellFont(e);Bt(null==e?void 0:e.CachedFont)&&(e.CachedFont=i),n&&(i.RefCount||0)<=1||this.duplicateAndSetNewFontOnCell(i,e)}setFormattedText(e,t){qS.verifyArgumentNotNull(e,"cell","setFormattedText"),qS.verifyArgumentNotNull(t,"formattedText","setFormattedText"),qS.verifyArgumentNotNull(t.TextRuns,"formattedText.TextRuns","setFormattedText"),qS.verifyArgumentNotNull(t.Fonts,"formattedText.Fonts","setFormattedText"),qS.verifyArgumentNotNull(this.model.Fonts,"this.model.Fonts","setFormattedText"),this.attachCellToModel(e),e.Text=t.Text;const n=this.duplicateAndSetFontsInModel(t.Fonts),o=e.TextRuns=Co(t.TextRuns,n);(0,Se.isGlobalFontsAndCellStylesFlightEnabled)(this.model)&&((0,Se.getGlobalFontsMap)().process(t.Fonts),mo(e.TextRuns,this.model.Fonts));for(let e=0;e<o.length;e++)o[e].CachedFont=(0,Se.getFontByID)(o[e],this.model,void 0)}discardFormattedText(e){qS.verifyArgumentNotNull(e,"cell","discardFormattedText"),e.TextRuns=void 0}serializeCell(e){return(0,Se.serializeCell)(e,this.model)}getOutlineState(e,t){const n=e?this.model.RowOutlinesInformation:this.model.ColumnOutlinesInformation;if(!n)return Se.OutlineState.None;let o=Se.OutlineState.None;for(let r=0;r<n.length;r++){const i=n[r];for(let n=0;n<i.Outlines.length;n++){const r=i.Outlines[n];if(t===r.ButtonIndex&&!r.IsExpanded)return Se.OutlineState.Collapsed;this.isIndexInOutline(t,r,e)&&(o=Se.OutlineState.Expanded)}}return o}compareCells(e,t,n){return(0,Se.areGridCellsEqual)(e,t,n,this.model)}updateNumFmt(e){qS.verifyArgumentNotNull(e,"cell","updateNumFmt"),(0,Se.isAccAndCustomNumFmtApplicable)(e)?Et(e):e.NumFmt=void 0}updateCellText(e,t){qS.verifyArgumentNotNull(e,"cell","updateCellText"),qS.verifyArgumentNotNull(t,"text","updateCellText"),e.TextRuns=void 0,e.DisplayFormula=!1,En(this.model,e,t)}updateCellValue(e,t){qS.verifyArgumentNotNull(e,"cell","updateCellValue"),e.Value=null!=t?t:void 0}hasPageLayout(){return null!=this.model.PageBreaks||null!=this.model.PrintAreas}hasIntersectingPrintArea(e){const t=this.model.PrintAreas;if(qS.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","hasIntersectingPrintArea"),qS.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","hasIntersectingPrintArea"),t&&e){const n=this.model.RowNumbers.length,o=this.model.ColumnNumbers.length;for(let r=0;r<t.length;r++){const i=t[r];if(i.FirstRow===n||i.FirstColumn===o)continue;const l=this.getRowNumber(i.FirstRow),a=i.LastRow>=n?this.getRowNumber(n-1):this.getRowNumber(i.LastRow);if(Un(e,{FirstRow:l,FirstColumn:this.getColumnNumber(i.FirstColumn),LastRow:a,LastColumn:i.LastColumn>=o?this.getColumnNumber(o-1):this.getColumnNumber(i.LastColumn)}))return!0}}return!1}setPrintArea(e){e&&0!==e.length&&(this.model.PrintAreas=e,this.setDirty("setPrintArea",Se.DirtyType.ModelCoreChanges))}addToPrintArea(e){e&&0!==e.length&&(this.model.PrintAreas=(this.model.PrintAreas||[]).concat(e),this.setDirty("addToPrintArea",Se.DirtyType.ModelCoreChanges))}clearPrintArea(){this.model.PrintAreas&&(this.model.PrintAreas=void 0,this.setDirty("clearPrintArea",Se.DirtyType.ModelCoreChanges))}hasPrintArea(){return!!this.model.PrintAreas&&this.model.PrintAreas.length>0}getPrintArea(){if(!this.model.PrintAreas)return[];const e=[];for(let t=0;t<this.model.PrintAreas.length;t++){const n=this.model.PrintAreas[t];e.push({FirstRow:n.FirstRow,FirstColumn:n.FirstColumn,LastRow:n.LastRow,LastColumn:n.LastColumn})}return e}insertPageBreak(e){((null==e?void 0:e.Row)&&0!==e.Row.length||(null==e?void 0:e.Col)&&0!==e.Col.length)&&(this.insertRowBreak(null==e?void 0:e.Row),this.insertColBreak(null==e?void 0:e.Col),this.setDirty("insertPageBreak",Se.DirtyType.ModelCoreChanges))}removePageBreak(e){const t=this.removeRowBreak(null==e?void 0:e.Row),n=this.removeColBreak(null==e?void 0:e.Col);!this.model.PageBreaks||this.model.PageBreaks.Row||this.model.PageBreaks.Col||(this.model.PageBreaks=void 0),(t||n)&&this.setDirty("removePageBreak",Se.DirtyType.ModelCoreChanges)}resetAllPageBreak(){this.model.PageBreaks&&(this.model.PageBreaks=void 0,this.setDirty("resetAllPageBreak",Se.DirtyType.ModelCoreChanges))}getPivotTableRanges(){return this.duplicatePivotTableRangeInformations(this.model.PivotTables)}getSparklineRanges(){var e;return this.duplicateSparklineRangeInformations(null===(e=this.model.Sparklines)||void 0===e?void 0:e.Ranges)}getSparklinesUrl(){var e,t;return null!==(t=null===(e=this.model.Sparklines)||void 0===e?void 0:e.ImageUrl)&&void 0!==t?t:""}getAllRichValueFields(){return this.duplicateRichValueFields(this.model.AllRichValueFields)}disposeBlock(e){Bt(e)||""===e||function(e,t){const n=Xt(e,t);Jt(n)&&Qt(n)}(Wt.Sparkline,e)}getAutoFilterButtonTotalSize(e,t,n){return qS.verifyArgumentNotNull(e,"cell","getAutoFilterButtonTotalSize"),this.getAutoFilterButtonTotalSizeInternal(e,t,n)}getAutoFilterMenuOffsetsFromCellStart(e,t,n){return qS.verifyArgumentNotNull(e,"cell","getAutoFilterMenuOffsetsFromCellStart"),this.getAutoFilterMenuOffsetsFromCellStartInternal(e,t,n)}setPreviewRange(e){var t;const n=(0,Se.getModelClientCache)(this.model);n.PreviewCellsRange&&this.setPreviewRangeCellsDirty(n.PreviewCellsRange),(null===(t=n.PreviewCellsSettings)||void 0===t?void 0:t.PreviewCellsRange)&&this.setPreviewRangeCellsDirty(n.PreviewCellsSettings.PreviewCellsRange),e&&this.setPreviewRangeCellsDirty(e),n.PreviewCellsRange=e||void 0}setPreviewCellsSettings(e){var t;const n=(0,Se.getModelClientCache)(this.model);n.PreviewCellsRange&&this.setPreviewRangeCellsDirty(n.PreviewCellsRange),(null===(t=n.PreviewCellsSettings)||void 0===t?void 0:t.PreviewCellsRange)&&this.setPreviewRangeCellsDirty(n.PreviewCellsSettings.PreviewCellsRange),(null==e?void 0:e.PreviewCellsRange)&&this.setPreviewRangeCellsDirty(e.PreviewCellsRange),n.PreviewCellsSettings=e||void 0}getPreviewText(e){return qS.verifyArgumentNotNull(e,"cell","getPreviewText"),e.PreviewText}setPreviewText(e,t){qS.verifyArgumentNotNull(e,"cell","setPreviewText"),e.PreviewText=t}getPreviewNumFmt(e){return fn(e,"cell","getPreviewNumFmt"),e.PreviewNumFmt}setPreviewNumFmt(e,t){qS.verifyArgumentNotNull(e,"cell","setPreviewNumFmt"),e.PreviewNumFmt=t}setRetainTextOnPreview(e,t){qS.verifyArgumentNotNull(e,"cell","setRetainTextOnPreview"),e.RetainTextOnPreview=t}getPreviewCellStyle(e){return fn(e,"cell","getPreviewCellStyle"),e.PreviewCellStyle}setPreviewCellStyle(e,t){qS.verifyArgumentNotNull(e,"cell","setPreviewCellStyle"),e.PreviewCellStyle=t}isSkeletonCell(e){return qS.verifyArgumentNotNull(e,"cell","isSkeletonCell"),!!e.ShowSkeleton}setShowSkeleton(e,t){qS.verifyArgumentNotNull(e,"cell","setShowSkeleton"),e.ShowSkeleton=t}hasFilters(){for(let e=0;e<this.model.Cells.length;e++){const t=this.model.Cells[e];if(t.AutoFilter||t.PivotFilter)return!0}return!1}updatePivotTablesAfterColWidthProcessing(){const e=this.model.PivotTables;if(e&&0!==e.length)for(let t=0;t<e.length;t++){const n=e[t];for(let e=n.FirstColumn;e<=n.LastColumn;e++){const t=OS(e+1);t&&t.SrvDx&&t.CachedColWidth&&(n.OriginPTWidth=n.OriginPTWidth-t.SrvDx+t.CachedColWidth)}}}hasRichValueIcon(e){return null!=e&&null!=e.LinkedEntity&&null!=e.LinkedEntity.IconWidth&&e.LinkedEntity.IconWidth>0}getCellContentWidth(e){var t;if(fn(e,"cell","getCellContentWidth"),this.hasRichValueIcon(e))throw Error("getCellContentWidth: unsupported rich value icon!");const n=this.getOrCreateCanvasContext(),o={Text:e.Text,CellValueType:e.ValueType,CellStyleId:e.StyleID||0,Autofilter:null!=e.AutoFilter,ExpandColButton:null===(t=e.PivotTable)||void 0===t?void 0:t.ShouldShowExpandCollapseMenu,CondWidthIcon:null!=e.CondFormat&&null!=e.CondFormat.Icon,TextRuns:e.TextRuns};return MS(n,this.model,o)}isCellWidthFixed(e){return fn(e,"cell","isCellWidthFixed"),!!this.model.FixedColumns&&this.model.FixedColumns[e.Col]}isCellHeightFixed(e){return fn(e,"cell","isCellHeightFixed"),!!this.model.IsBitwiseFixedRows&&Eo(this.model.IsBitwiseFixedRows,e.Row)}getRichValueTypes(){return this.model.RichValueTypes||[]}getCellHeightWithWrap(e,t,n,o){var r;if(fn(e,"cell","getCellHeightWithWrap"),!o||e.ValueType!==Se.CellValueType.String||e.Merge||!e.Text||Eo(this.model.IsBitwiseFixedRows||0,e.Row))return this.getRowHeight(e.Row);e.CachedDrawingLayout||(e.CachedDrawingLayout={CellTextLayout:{}});const i={zoom:t,devicePixelRatio:n,debugMode:!1,isFormulaView:!1,isCanvasHitTestDebugHighlight:!1,isCellsPreviewMode:!1,modelFromCache:!1,renderPageLayout:!1,skeletonMode:!1,subPixelRenderingEnabled:!1,scaleFactor:t*n,isDifferentialRendering:!1};let l=null;l=this.getOrCreateCanvasContext(),bn(this.model,e,!1),l.font=fl(e,this.model);const a=jl(this.model,e,!0),s=su(this.model,e,t,devicePixelRatio),d=ar(a,Pc(this.model,e),s,Fd(null===(r=e.PivotTable)||void 0===r?void 0:r.HasExpandCollapseIndicator),gd(this.model,e,t,devicePixelRatio)),c=this.model.RowHeights[e.Row]-Le,u=Lt(e)?c:d,h=Wh(e,Vh(e),u,this.model,i);if(h<=0)return this.getRowHeight(e.Row);const g=Kc(l,this.model,e),f=ou(e,this.model);return Math.ceil(g/h)*f}updateBreakOpForCell(e){en(e,"cell","updateBreakOpForCell");const t=kn(e,this.model);if(!t)return;if(!ko(t))return;const n=function(e){if(!Intl.Segmenter)return;sn||(sn=new Intl.Segmenter("th",{granularity:"word"}));const t=sn.segment(e)[Symbol.iterator](),n=[];for(let t=0;t<e.length;t++)n.push("2");let o=t.next();for(;!1===o.done;){const e=o.value;e.isWordLike&&e.index>0&&(n[e.index]="1"),o=t.next()}return n.join("")}(t);n&&(e.WrapText||(e.WrapText={}),e.WrapText.BreakOp=n)}insertRowBreak(e){var t;e&&0!==e.length&&((null===(t=this.model.PageBreaks)||void 0===t?void 0:t.Row)&&this.model.PageBreaks.Row.length>0?this.model.PageBreaks.Row=this.model.PageBreaks.Row.concat(e):this.model.PageBreaks?this.model.PageBreaks.Row=e:this.model.PageBreaks={Row:e})}insertColBreak(e){var t;e&&0!==e.length&&((null===(t=this.model.PageBreaks)||void 0===t?void 0:t.Col)&&this.model.PageBreaks.Col.length>0?this.model.PageBreaks.Col=this.model.PageBreaks.Col.concat(e):this.model.PageBreaks?this.model.PageBreaks.Col=e:this.model.PageBreaks={Col:e})}removeRowBreak(e){var t;if(!e||0===e.length||!(null===(t=this.model.PageBreaks)||void 0===t?void 0:t.Row)||0===this.model.PageBreaks.Row.length)return!1;const n=this.model.PageBreaks.Row.filter((t=>e.every((e=>e.Index!==t.Index)))),o=this.model.PageBreaks.Row.length!==n.length;return this.model.PageBreaks.Row=n.length>0?n:void 0,o}removeColBreak(e){var t;if(!e||0===e.length||!(null===(t=this.model.PageBreaks)||void 0===t?void 0:t.Col)||0===this.model.PageBreaks.Col.length)return!1;const n=this.model.PageBreaks.Col.filter((t=>e.every((e=>e.Index!==t.Index)))),o=this.model.PageBreaks.Col.length!==n.length;return this.model.PageBreaks.Col=n.length>0?n:void 0,o}isStyleUnique(e){return e===Se.UniqueStyleID.Default||e===Se.UniqueStyleID.Hyperlink}removeBordersWithinASpillCell(e){for(let t=1;t<=e.Spill.SpanToEnd;t++){const n=this.getCell(e.Row,e.Col+t);if(n){const e=this.getBorderStyle(n);e&&e.Borders&&e.Borders.length>0&&this.removeCellLeftBorder(n,e)}}}removeCellLeftBorder(e,t){const n=io(t,t.ID||0,1);if(n&&n.Borders){const t=n.Borders.length;for(let o=0;o<t;o++){const t=n.Borders[o];t&&t.BorderPosition===Se.BorderPositionType.Left&&(n.Borders.splice(o),(0,Se.isGlobalBorderStylesEnabled)(this.model)?this.setBordersNew(e,n,!0):this.setBorders(e,n))}}}duplicateAndSetNewFontOnTextRun(e,t){const n=this.duplicateAndSetNewFontInModel(e,!1);t.FontID=n.newFontId,t.CachedFont=n.newFont}duplicateAndSetNewFontOnCell(e,t){const{newFontId:n,newFont:o}=this.duplicateAndSetNewFontInModel(e,!1);t.CachedFont=o,t.CachedStyle.FontID=n}duplicateAndSetFontsInModel(e){const t=[],n=Object.keys(e);for(let o=0;o<n.length;o++){const r=e[parseInt(n[o],10)||0],{newFontId:i}=this.duplicateAndSetNewFontInModel(r,!0);t[r.ID||0]=i}return t}duplicatePivotTableRangeInformations(e){if(!e)return;const t=[];for(let n=0;n<e.length;n++)t.push(this.duplicatePivotTableRangeInformation(e[n]));return t}duplicatePivotTableRangeInformation(e){return{AltText:e.AltText,AltTextSummary:e.AltTextSummary,AutoFormatOnUpdate:e.AutoFormatOnUpdate,ColGrandTotalOn:e.ColGrandTotalOn,ColumnAreaFields:this.duplicatePivotTableFieldInfos(e.ColumnAreaFields),ColumnHeaderRange:this.duplicateRangeInformation(e.ColumnHeaderRange),ColumnMemberPropIndexes:e.ColumnMemberPropIndexes,ColumnTotalIndexes:e.ColumnTotalIndexes,ConfirmationRequiredForDataOps:e.ConfirmationRequiredForDataOps,ConnectionName:e.ConnectionName,CurrentStyleName:e.CurrentStyleName,StyleIndex:e.StyleIndex,DataPivotFieldCaption:e.DataPivotFieldCaption,DataPivotFieldIndex:e.DataPivotFieldIndex,DataSource:e.DataSource,DeltaXFromOriginPT:e.DeltaXFromOriginPT,DeltaXFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,DeltaYFromOriginPT:e.DeltaYFromOriginPT,DeltaYFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,DisplayErrorString:e.DisplayErrorString,DisplayNullString:e.DisplayNullString,ErrorString:e.ErrorString,ExternalSourceIndex:e.ExternalSourceIndex,FieldListVersion:e.FieldListVersion,FieldWellVersion:e.FieldWellVersion,FirstColIndex:e.FirstColIndex,FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,FirstRowIndex:e.FirstRowIndex,HasActiveFilter:e.HasActiveFilter,HideGridLines:e.HideGridLines,IndentIncrement:e.IndentIncrement,IsActionable:e.IsActionable,IsEmptyPivot:e.IsEmptyPivot,IsOlap:e.IsOlap,IsPageArea:e.IsPageArea,IsRefreshableTabularOlap:e.IsRefreshableTabularOlap,LastColIndex:e.LastRowIndex,LastColumn:e.LastColumn,LastRow:e.LastRow,LastRowIndex:e.LastRowIndex,NullString:e.NullString,OriginPTHeight:e.OriginPTHeight,OriginPTHeightAdjustedForDrawing:e.OriginPTHeightAdjustedForDrawing,OriginPTWidth:e.OriginPTWidth,OriginPTWidthAdjustedForDrawing:e.OriginPTWidthAdjustedForDrawing,PageAreaFields:this.duplicatePivotTableFieldInfos(e.PageAreaFields),PivotTableName:e.PivotTableName,RangeType:e.RangeType,RefreshOnLoad:e.RefreshOnLoad,RowAreaCaptions:e.RowAreaCaptions,RowAreaFields:this.duplicatePivotTableFieldInfos(e.RowAreaFields),RowHeaderRange:this.duplicateRangeInformation(e.RowHeaderRange),RowLocation:e.RowLocation,RowMemberPropIndexes:e.RowMemberPropIndexes,RowTotalIndexes:e.RowTotalIndexes,RwGrandTotalOn:e.RwGrandTotalOn,SaveSourceDataWithFile:e.SaveSourceDataWithFile,ShowColumnHeaders:e.ShowColumnHeaders,ShowColumnStripes:e.ShowColumnStripes,ShowDrillIndicators:e.ShowDrillIndicators,ShowItemsWithNoDataOnCol:e.ShowItemsWithNoDataOnCol,ShowItemsWithNoDataOnRw:e.ShowItemsWithNoDataOnRw,ShowRowHeaders:e.ShowRowHeaders,ShowRowStripes:e.ShowRowStripes,SupportsBIExplore:e.SupportsBIExplore,ValueAreaFields:this.duplicatePivotTableFieldInfos(e.ValueAreaFields),Xluid:e.Xluid,SlicerConnections:e.SlicerConnections,AutoRefresh:e.AutoRefresh,SupportsAutoRefresh:e.SupportsAutoRefresh}}duplicateRangeInformation(e){if(e)return{FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,LastColumn:e.LastColumn,LastRow:e.LastRow,RangeType:e.RangeType}}duplicatePivotTableFieldInfos(e){if(!e)return;const t=[];for(let n=0;n<e.length;n++)t.push(this.duplicatePivotTableFieldInfo(e[n]));return t}duplicatePivotTableFieldInfo(e){return{BaseFieldIndex:e.BaseFieldIndex,Caption:e.Caption,DataFieldAggregationType:e.DataFieldAggregationType,DataFieldFormatType:e.DataFieldFormatType,Index:e.Index,IsCompactLayout:e.IsCompactLayout,RepeatItemLabels:e.RepeatItemLabels,ShowBlankLineAfterEachItem:e.ShowBlankLineAfterEachItem,ShowItemsWithNoData:e.ShowItemsWithNoData,ShowSubtotal:e.ShowSubtotal,ShowSubtotalAtTop:e.ShowSubtotalAtTop,SortInfo:e.SortInfo,LabelOrDateFilterType:e.LabelOrDateFilterType,ValueFilterType:e.ValueFilterType,MeasureType:e.MeasureType,HasManualFilter:e.HasManualFilter,IsDateField:e.IsDateField,IsImplicitMeasure:e.IsImplicitMeasure,IsNumeric:e.IsNumeric}}duplicateAndSetNewFontInModel(e,t){const n=this.model.Fonts.length,o=lo(e,n,t?e.RefCount||0:1);return t||(e.RefCount=Math.max(0,(e.RefCount||0)-1)),this.model.Fonts.splice(n,0,o),{newFontId:n,newFont:o}}duplicateSparklineRangeInformations(e){if(!e)return;const t=[];for(let n=0;n<e.length;n++)t.push(this.duplicateSparklineRangeInformation(e[n]));return t}duplicateSparklineRangeInformation(e){return{FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,LastColumn:e.LastColumn,LastRow:e.LastRow,LocationColumn:e.LocationColumn,LocationRow:e.LocationRow,RangeType:e.RangeType,SparklineType:e.SparklineType}}duplicateRichValueFields(e){if(!e)return;const t=[];for(let n=0;n<e.length;n++)t.push(this.duplicateRichValueField(e[n]));return t}duplicateRichValueField(e){return{Index:e.Index,RefersToDotFunction:e.RefersToDotFunction,Value:e.Value}}setContextCellFont(e,t){e.font=fl(t,this.model)}setPreviewRangeCellsDirty(e){const t={FirstColumn:Math.max(e.FirstColumn-1,0),FirstRow:Math.max(e.FirstRow-1,0),LastColumn:e.LastColumn+1,LastRow:e.LastRow+1};this.setCellsInRangeDirty(t)}setCellsInRangeDirty(e){for(let t=0;t<this.model.Cells.length;t++){const n=this.model.Cells[t];(0,Se.isModelCellContainedInRange)(this.model,e,n)&&this.setCellAndSpannedOverCellsDirty(n)}}isIndexInOutline(e,t,n){const o=n?this.model.RowNumbers.length:this.model.ColumnNumbers.length;if(t.IsNonDefaultDirection){const n=-1!==t.ButtonIndex?t.ButtonIndex+1:0,r=-1!==t.StartIndex?t.StartIndex:o-1;if(e>=n&&e<=r)return!0}else{const n=-1!==t.StartIndex?t.StartIndex:0,r=-1!==t.ButtonIndex?t.ButtonIndex-1:o-1;if(e>=n&&e<=r)return!0}return!1}}var $S,XS;!function(e){e[e.Inactive=0]="Inactive",e[e.Active=1]="Active",e[e.Cooldown=2]="Cooldown"}($S||($S={})),function(e){e[e.Inactive=0]="Inactive",e[e.Cooldown=1]="Cooldown"}(XS||(XS={}));let YS=$S.Inactive,KS=XS.Inactive,JS={};function ZS(e,t){return function(){if(YS===$S.Inactive){const e=yi(0,1e3);YS=$S.Active,setTimeout(QS,e)}return YS===$S.Active}()?function(e,t){const n=Li?Li.now():-1,o=e();if(Li){const e=Li.now()-n;JS[t]||(JS[t]=[]),JS[t].push(e.toFixed(4))}return o}(e,t):e()}function QS(){const e=yi(1,4e3);YS=$S.Cooldown,function(){if(KS===XS.Inactive){KS=XS.Cooldown;const e=yi(2,6e4);setTimeout((()=>{!function(){const e=JSON.stringify(JS);vr.Hv.sendTraceTag(574648710,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`HitTest::Telemetry::sendMeasurementResults: ${e}`),JS={},KS=XS.Inactive}()}),e)}}(),setTimeout((()=>{YS=$S.Inactive}),e)}const eR=new Map;function tR(e,t){if(!t||t.length<=1)return;const n=JSON.stringify(t.map((e=>e.zIndex)));eR.has(e)||eR.set(e,[]),eR.get(e).includes(n)||(eR.get(e).push(n),vr.Hv.sendTraceTag(508403979,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`logRegionCollision: source:${e}, regions:${n}`))}class nR extends Yi{addRegionEventListener(e){this.cacheRegionAndRegisterEvents(e,e.eventType)}removeAllEventListeners(){this.isRegisteredToEvents&&(this.registeredEventsHitRegions.pointerdown&&this.canvas.removeEventListener("pointerdown",this.pointerDownEventHandler),this.registeredEventsHitRegions.pointerup&&this.canvas.removeEventListener("pointerup",this.pointerUpEventHandler),this.registeredEventsHitRegions.click&&(this.canvas.removeEventListener(Ig,this.pointerDownEventHandler),this.canvas.removeEventListener("click",this.clickEventHandler)),this.registeredEventsHitRegions.touchstart&&this.canvas.removeEventListener("touchstart",this.touchStartEventHandler),this.registeredEventsHitRegions.dblclick&&this.canvas.removeEventListener("dblclick",this.dblClickEventHandler),this.registeredEventsHitRegions.touchend&&this.canvas.removeEventListener("touchend",this.touchEndEventHandler),this.isListeningToPointerMove&&(this.canvas.removeEventListener("pointermove",this.pointerMoveEventHandler),this.canvas.removeEventListener(bg,this.pointerLeaveEventHandler),this.isListeningToPointerMove=!1),this.registeredEventsHitRegions={},this.isRegisteredToEvents=!1,this.isHitMapSorted=!0)}addCursorRegion(e){this.cacheRegionAndRegisterEvents(e,yg)}addTooltipRegion(e){this.cacheRegionAndRegisterEvents(e,Sg)}addLongPressRegion(e){this.cacheRegionAndRegisterEvents(e,Rg)}dispose(){this.removeAllEventListeners(),super.dispose()}setHitMapOffsets(e,t,n,o,r){if(e.length>32||t.length>32)throw Error(`setHitMapOffsets:: offsets.length exceeds max allowed offsets length. x: ${e.length}, y: ${t.length}`);const i=r?r.endOffsetX-r.startOffsetX:n,l=nR.doOffsetsHaveEqualDistances(e,i),a=nR.getFirstOffsetSize(e,n);l&&0===a&&vr.Hv.sendTraceTag(522311843,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`setHitMapOffsets: width:${n} renderingRegion:${JSON.stringify(r)} offsetsX:${JSON.stringify(e)}}`),this.hitMapAxisX={areOffsetsEqual:l,equalOffsetsSize:a,offsets:e};const s=r?r.endOffsetY-r.startOffsetY:o,d=nR.doOffsetsHaveEqualDistances(t,s),c=nR.getFirstOffsetSize(t,o);d&&0===c&&vr.Hv.sendTraceTag(522311872,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`setHitMapOffsets: height:${o} renderingRegion:${JSON.stringify(r)} offsetsY:${JSON.stringify(t)}}`),this.hitMapAxisY={areOffsetsEqual:d,equalOffsetsSize:c,offsets:t}}optimizeHitMapLookup(){this.isHitMapSorted||this.sortHitMap()}setAppZoom(e){this.zoom=e}setDimensions(e,t,n){super.setDimensions(e,t,n),this.setDefaultHitMapAxes(e,t)}cancelLongPressTimer(e,t){this.longPressState.callbackScheduled&&!this.longPressState.longPressModeEnabled&&clearTimeout(this.longPressState.callbackId);const n=this.canvas;n&&n.releasePointerCapture&&-1!==this.longPressState.eventPointerId&&n.releasePointerCapture(this.longPressState.eventPointerId),this.longPressState.longPressModeEnabled&&this.handleMouseLongPressEnd(this.longPressState.lastHitRegion),this.longPressState={callbackScheduled:!1,longPressModeEnabled:!1,callbackId:-1,eventPointerId:-1,lastHitRegion:void 0};const o=mS(e,t),r=this.getEventCoordinatesInCanvas(o.clientX,o.clientY);this.handlePointerMove(e,r)}getHitMapOffsetsX(){return this.hitMapAxisX}getHitMapOffsetsY(){return this.hitMapAxisY}getAppZoom(){return this.zoom}getIsHitMapSorted(){return this.isHitMapSorted}getEventTypeRegisteredEventsHitRegions(e){return this.registeredEventsHitRegions[e]}getIntersectingHitMapAreasKeys(e){const t=[],n=this.getRenderingRegion();if(!n)return t;const o=n.endOffsetX-n.startOffsetX,r=n.endOffsetY-n.startOffsetY;if(!_n(e.x,e.x+e.width,0,0+o)||!_n(e.y,e.y+e.height,0,0+r))return t;let i=nR.getOffsetPosition(e.x,this.hitMapAxisX);const l=!!Ko(),a=l?0:1;let s=nR.getOffsetPosition(e.x+e.width-a,this.hitMapAxisX,l),d=nR.getOffsetPosition(e.y,this.hitMapAxisY),c=nR.getOffsetPosition(e.y+e.height-a,this.hitMapAxisY,l);(i<0||d<0||s>=this.hitMapAxisX.offsets.length||c>=this.hitMapAxisY.offsets.length)&&(this.arrayOverflowInvestigationLogged||(vr.Hv.sendTraceTag(508052569,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`InteractableCanvasElement::getIntersectingHitMapAreasKeys: xStartPosition:${i}, xEndPosition:${s}, yStartPosition:${d}, yEndPosition:${c}, hitMapAxisX:[${this.hitMapAxisX.offsets}], hitMapAxisY:[${this.hitMapAxisY.offsets}], region.x:${e.x}, region.width:${e.width}, region.y:${e.y}, region.height:${e.height}`),this.arrayOverflowInvestigationLogged=!0),i<0&&(i=0),d<0&&(d=0),s>=this.hitMapAxisX.offsets.length&&(s=this.hitMapAxisX.offsets.length-1),c>=this.hitMapAxisY.offsets.length&&(c=this.hitMapAxisY.offsets.length-1));for(let e=i;e<=s;e++)for(let n=d;n<=c;n++)t.push(nR.getHitMapAreaKeyFromOffsetPosition(e,n));return t}getHitMapAreaKeyFromOffset(e,t){const n=nR.getOffsetPosition(e,this.hitMapAxisX),o=nR.getOffsetPosition(t,this.hitMapAxisY);return nR.getHitMapAreaKeyFromOffsetPosition(n,o)}isEventStartAndEndInSameRegion(e,t,n){if(0===n.length)return!1;const{clientX:o,clientY:r}=mS(e,t),i=this.getEventCoordinatesInCanvas(o,r),l=this.getIntersectingHitRegions(t,i);return l.length>0&&(a=n[0],s=l[0],a.zIndex===s.zIndex&&(d=a.region,c=s.region,d.x===c.x&&d.y===c.y&&d.width===c.width&&d.height==d.height));var a,s,d,c}static getHitMapAreaKeyFromOffsetPosition(e,t){return(e<<5)+t}static getOffsetPosition(e,t,n){if(t.areOffsetsEqual)return 0===t.equalOffsetsSize&&Rn("areOffsetsEqual cannot be 0","getOffsetPosition"),n&&e%t.equalOffsetsSize==0?e/t.equalOffsetsSize-1:Math.floor(e/t.equalOffsetsSize);const o=mn(t.offsets,0,t.offsets.length,e,Cn);return o<0?~o-1:n?o-1:o}static doOffsetsHaveEqualDistances(e,t){if(e.length<2)return!0;const n=e[1];for(let t=2;t<e.length;t++)if(e[t]-e[t-1]!==n)return!1;return t-e[e.length-1]===n}getDefaultHitMapAxis(e){const t=Math.floor(e/30),n=[];for(let e=0;e<30;e++)n.push(e*t);return 0===t&&vr.Hv.sendTraceTag(522311873,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`InteractableCanvasElement::getDefaultHitMapAxis: totalSize:${e}`),{areOffsetsEqual:!0,equalOffsetsSize:t,offsets:n}}static getFirstOffsetSize(e,t){return e.length<2?t:e[1]}onPointerDown(e){if(!wi())return!1;const t="pointerdown",n=this.getEventCoordinatesInCanvas(e.clientX,e.clientY);return this.lastPointerDownClickHitRegions=this.getIntersectingHitRegions("click",n),this.handleMouseLongPress(e,t),this.onBasicPointerEvent(e,t,this.pointerDownEventHandler)}onPointerUp(e){const t="pointerup";return this.longPressState.callbackScheduled&&this.cancelLongPressTimer(e,t),this.onBasicPointerEvent(e,t,this.pointerUpEventHandler)}onPointerLeave(e){return this.handleMouseLeaveEventTriggering(e,Fg),this.lastPointerPosition=Fg,this.canvas.style.cursor=Tg,this.lastCursorType=Tg,!0}onClick(e){const t="click";return!(!wi()||!this.isEventStartAndEndInSameRegion(e,t,this.lastPointerDownClickHitRegions))&&this.onBasicPointerEvent(e,t,this.clickEventHandler)}ondblclick(e){return!!wi()&&this.onBasicPointerEvent(e,"dblclick",this.dblClickEventHandler)}onTouchStart(e){var t,n,o,r;if(!wi())return!1;const i=this.getEventCoordinatesInCanvas(null===(n=e.touches)||void 0===n||null===(t=n[0])||void 0===t?void 0:t.clientX,null===(r=e.touches)||void 0===r||null===(o=r[0])||void 0===o?void 0:o.clientY);return this.lastPointerDownTouchEndHitRegions=this.getIntersectingHitRegions("touchend",i),this.onBasicPointerEvent(e,"touchstart",this.touchStartEventHandler)}onTouchEnd(e){const t="touchend";return!(!wi()||!this.isEventStartAndEndInSameRegion(e,t,this.lastPointerDownTouchEndHitRegions))&&this.onBasicPointerEvent(e,t,this.touchEndEventHandler)}onBasicPointerEvent(e,t,n){return ZS((()=>this.isEventHasRegisteredHandlers(t)?this.handleBasicPointerEvents(t,e):(this.removeUnnecessaryEventListeners(t,n),!0)),t)}removeUnnecessaryEventListeners(e,t){this.isEventHasRegisteredHandlers("longpress")||(e!==Ig||this.isEventHasRegisteredHandlers("click")?e===vg&&this.canvas.removeEventListener(e,t):this.canvas.removeEventListener(e,t))}onPointerMove(e){wi()&&ZS((()=>{const t=this.getEventCoordinatesInCanvas(e.clientX,e.clientY);this.handlePointerMove(e,t)}),wg)}handleBasicPointerEvents(e,t){const n=mS(t,e),o=this.getEventCoordinatesInCanvas(n.clientX,n.clientY),r=this.getIntersectingHitRegions(e,o);return this.propagateEventToHandlers(t,r,e,(()=>!0))}handlePointerMove(e,t){this.longPressState.longPressModeEnabled||(this.handleMouseLeaveEventTriggering(e,t),this.handleMouseEnterEventTriggering(e,t),this.handleCursorType(e,t),this.handleTooltipChange(t)),this.lastPointerPosition=t}handleMouseLeaveEventTriggering(e,t){if(this.lastPointerPosition===Fg)return;const n=this.getIntersectingHitRegions("mouseleave",this.lastPointerPosition);this.propagateEventToHandlers(e,n,"mouseleave",(e=>t===Fg||!jn(e.region,t)))}handleMouseEnterEventTriggering(e,t){if(t===Fg)return;const n=this.getIntersectingHitRegions("mouseenter",t);this.propagateEventToHandlers(e,n,"mouseenter",(e=>this.lastPointerPosition===Fg||!jn(e.region,this.lastPointerPosition)))}propagateEventToHandlers(e,t,n,o){let r=Number.MAX_SAFE_INTEGER;this.getIsRegionCollisionTelemetryEnabled()&&tR(n,t);for(let i=0;i<t.length;i++){const l=t[i];if(l.zIndex>r)throw Error(`handleEventPropagationToHandlers: expected handlers to be sorted by z-index, highest first. latestZIndex=${r}, currentZIndex=${l.zIndex}, eventType: ${n}, totalHandlersCount=${t.length}`);if(o(l)){const t=l.callback(e);if("boolean"==typeof t){if(t)return e.stopPropagation(),e.preventDefault(),!1}else if(t.handled)return t.stopPropagation&&(e.stopPropagation(),e.preventDefault()),!1}r=l.zIndex}return!0}handleCursorType(e,t){let n=Tg;if(t!==Fg){const o=this.getIntersectingHitRegions(yg,t);if(o&&o.length>0){this.getIsRegionCollisionTelemetryEnabled()&&tR("cursor",o);const t=o.find((t=>t.shouldChangeCursor(e)));t&&(n=t.cursorType)}}this.lastCursorType!==n&&(this.lastCursorType=n,this.canvas.style.cursor=n)}handleTooltipChange(e){let t,n="";if(e!==Fg){const o=this.getIntersectingHitRegions(Sg,e);if(o&&o.length>0){this.getIsRegionCollisionTelemetryEnabled()&&tR("tooltip",o);const e=o[0],r=e.region;n=e.tooltipText,t=this.getHitMapAreaKeyFromOffset(r.x,r.y)}}const o=this.lastTooltipHitRegionKey!==t,r=this.lastTooltip!==n;if(r||o){if(this.lastTooltip=n,this.lastTooltipHitRegionKey=t,o&&!r)return this.canvas.setAttribute("title",""),void setTimeout((()=>{this.canvas.setAttribute("title",n)}),0);this.canvas.setAttribute("title",n)}}handleMouseLongPressStart(e){e&&e.onStart()}handleMouseLongPressEnd(e){e&&e.onEnd()}getLongPressHitRegion(e){if(e!==Fg){const t=this.getIntersectingHitRegions(Rg,e);if(t&&t.length>0)return t[0]}}cacheRegionAndRegisterEvents(e,t){this.registeredEventsHitRegions[t]||this.registerHandlersForEvent(t);const n=this.getEventHitAreaMap(t);this.addHitRegion(e,n)}registerHandlersForEvent(e){switch(e){case"pointerdown":this.canvas.addEventListener(e,this.pointerDownEventHandler);break;case"pointerup":this.canvas.addEventListener(e,this.pointerUpEventHandler);break;case"click":this.canvas.addEventListener(Ig,this.pointerDownEventHandler),this.canvas.addEventListener(e,this.clickEventHandler);break;case"dblclick":this.canvas.addEventListener(e,this.dblClickEventHandler);break;case"touchstart":this.canvas.addEventListener(e,this.touchStartEventHandler);break;case"touchend":this.canvas.addEventListener(e,this.touchEndEventHandler);break;case"longpress":this.canvas.addEventListener(Ig,this.pointerDownEventHandler),this.canvas.addEventListener(vg,this.pointerUpEventHandler);break;case"cursor":case"tooltip":case"mouseenter":case"mouseleave":this.isListeningToPointerMove||(this.canvas.addEventListener(wg,this.pointerMoveEventHandler),this.canvas.addEventListener(bg,this.pointerLeaveEventHandler),this.isListeningToPointerMove=!0)}this.isRegisteredToEvents=!0}getEventHitAreaMap(e){return this.registeredEventsHitRegions[e]||(this.registeredEventsHitRegions[e]={}),this.registeredEventsHitRegions[e]}addHitRegion(e,t){const n=this.getIntersectingHitMapAreasKeys(e.region);for(let o=0;o<n.length;o++){const r=n[o];t[r]||(t[r]=[]),t[r].push(e)}this.isHitMapSorted=!1}setDefaultHitMapAxes(e,t){this.hitMapAxisX=this.getDefaultHitMapAxis(e),this.hitMapAxisY=this.getDefaultHitMapAxis(t)}getEventCoordinatesInCanvas(e,t){const n=Bi()?e:e/this.zoom,o=Bi()?t:t/this.zoom,r=this.canvas.getBoundingClientRect();return{x:(n-r.left)/(Bi()?this.zoom:1),y:(o-r.top)/(Bi()?this.zoom:1)}}getIntersectingHitRegions(e,t){const n=[];if(this.registeredEventsHitRegions[e]){const o=this.getHitMapAreaKeyFromOffset(t.x,t.y);this.optimizeHitMapLookup();const r=this.registeredEventsHitRegions[e][o];if(r&&r.length>0)for(let e=0;e<r.length;e++){const o=r[e];jn(o.region,t)&&n.push(o)}}return n}isEventHasRegisteredHandlers(e){return!!this.registeredEventsHitRegions&&!!this.registeredEventsHitRegions[e]}sortHitMap(){const e=Object.keys(this.registeredEventsHitRegions);for(let t=0;t<e.length;t++){const n=this.registeredEventsHitRegions[e[t]],o=Object.keys(n);for(let e=0;e<o.length;e++){const t=parseInt(o[e],10);n[t]=n[t].sort(CS)}}this.isHitMapSorted=!0}handleMouseLongPress(e,t){const n=1===e.button,o="touch"===e.pointerType;if(this.longPressState.callbackScheduled&&(!e.target||!n)||o)return;const r=mS(e,t),i=this.getEventCoordinatesInCanvas(r.clientX,r.clientY),l=this.getLongPressHitRegion(i);if(!l)return;const a=e.target,s=e.pointerId;a&&a.setPointerCapture&&-1!==s&&a.setPointerCapture(s),this.longPressState.callbackId=window.setTimeout((()=>{this.onLongPress()}),800),this.longPressState.callbackScheduled=!0,this.longPressState.eventPointerId=s,this.longPressState.lastHitRegion=l}onLongPress(){this.canvas.style.cursor=Tg,this.lastCursorType=Tg,this.longPressState.longPressModeEnabled=!0,this.handleMouseLongPressStart(this.longPressState.lastHitRegion)}getIsRegionCollisionTelemetryEnabled(){var e;return void 0===this.isRegionCollisionTelemetryEnabled&&(this.isRegionCollisionTelemetryEnabled=(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.RegionCollisionTelemetry",void 0)),null!==(e=this.isRegionCollisionTelemetryEnabled)&&void 0!==e&&e}constructor(e,t){super(e,t),this.isHitMapSorted=!0,this.isRegisteredToEvents=!1,this.isListeningToPointerMove=!1,this.lastPointerPosition=Fg,this.lastPointerDownClickHitRegions=[],this.lastPointerDownTouchEndHitRegions=[],this.lastCursorType=Tg,this.lastTooltip="",this.longPressState={callbackScheduled:!1,longPressModeEnabled:!1,callbackId:-1,eventPointerId:-1,lastHitRegion:void 0},this.zoom=1,this.arrayOverflowInvestigationLogged=!1,this.registeredEventsHitRegions={},this.setDefaultHitMapAxes(this.getWidth(),this.getHeight()),this.pointerDownEventHandler=this.onPointerDown.bind(this),this.pointerUpEventHandler=this.onPointerUp.bind(this),this.pointerMoveEventHandler=this.onPointerMove.bind(this),this.clickEventHandler=this.onClick.bind(this),this.dblClickEventHandler=this.ondblclick.bind(this),this.touchStartEventHandler=this.onTouchStart.bind(this),this.touchEndEventHandler=this.onTouchEnd.bind(this),this.pointerLeaveEventHandler=this.onPointerLeave.bind(this)}}function oR(e,t,n,o){const r=t?e.RowOutlinesInformation:e.ColumnOutlinesInformation;if(!r)return;const i=r.length;for(let e=0;e<i;e++){const t=r[e],i=t.Outlines.length;for(let e=0;e<i;e++){const r=t.Outlines[e],i=n===r.ButtonIndex&&!!r.IsButtonHidden;r.ButtonIndex>-1&&n<=r.ButtonIndex&&!i&&(o?r.ButtonIndex++:r.ButtonIndex--);const l=r.IsNonDefaultDirection?n<=r.StartIndex:n<r.StartIndex;r.StartIndex>-1&&l&&(o?r.StartIndex++:r.StartIndex--)}}}function rR(e){return e?28:30}function iR(e,t,n,o,r,i,l,a){const s=function(e,t,n){return n?t-e:t}(n,o,l);go(e,o,(0,Se.createHeaderCell)(s,r,t,i,l)),sR(e,o+1,l?2*n:n,t,a)}function lR(e,t,n,o,r){fo(e,t),sR(e,t,n,o,r)}function aR(e,t,n){for(let o=t;o<e.length;o++)e[o]=e[o]+n}function sR(e,t,n,o,r){for(let i=t;i<n;i++){const t=e[i],n=i===r;if(o){const o=n?-1:e[i-1].Row;t.Row=o+1}else{const o=n?-1:e[i-1].Col;t.Col=o+1}}}function dR(e,t){const n=t?e.MaxRowOutlineLevelInSheet:e.MaxColOutlineLevelInSheet;return!!n&&n>0}const cR=2*Math.PI,uR=1,hR=2,gR=1,fR=6,CR=hR+uR,mR=5,pR=0,yR=4,SR=7,RR=mR+uR;function wR(e,t,n,o,r,i){let l,a;const{startHitRegionSize:s,endHitRegionSize:d}=function(e,t,n,o){const r=e?t.height:t.width;if(r<n+o){const e=r/2;return{startHitRegionSize:e,endHitRegionSize:e}}return{startHitRegionSize:n,endHitRegionSize:o}}(t,e,r,i);if(t){const t=n?e.x+e.width-o:e.x;l={x:t,y:e.y,width:o,height:s},a={x:t,y:e.y+e.height-d,width:o,height:d}}else n?(l={x:e.x+e.width-s,y:e.y,width:s,height:o},a={x:e.x,y:e.y,width:d,height:o}):(l={x:e.x,y:e.y,width:s,height:o},a={x:e.x+e.width-d,y:e.y,width:d,height:o});return{cellStartHitRegion:l,cellEndHitRegion:a}}function bR(e,t,n,o,r,i){let l=r-t.getCellExtent(n),a=0;const s=RR,d=e.IsRow?e.RowNumbers.length:e.ColumnNumbers.length;let c=n;for(;l>0||a<s;){var u,h;if(o?++c:--c,c<0||c>=d)break;const n=e.Cells[c],r=t.getCellExtent(c);l>0&&(i(c),l-=r),a+=r,IR(o?null===(u=n.InsertButtons)||void 0===u?void 0:u.End:null===(h=n.InsertButtons)||void 0===h?void 0:h.Start)>a&&i(c)}}function IR(e){return e?e.Type===Se.InsertButtonType.InsertButton?RR:e.Type===Se.InsertButtonType.InsertDot?CR:0:0}const vR=.1,FR=5,TR=0,DR=.5,xR=12,AR="#107C41",BR="#ffffff",HR=Se.DefaultHeaderFontSize+4;class MR extends jS{static verifyArgumentNotNull(e,t,n){en(e,t,`HeaderBlockModelAccessor.${n}`)}static throwErrorWrapper(e,t){Rn(e,`HeaderBlockModelAccessor.${t}`)}static isCellSnapped(e){return MR.verifyArgumentNotNull(e,"cell","isCellSnapped"),(0,Se.isChangeGateEnabled)(Se.ChangeGate.FixHeaderSnappingAutoFilterNone)?!!e.IsCellSnapped:!!e.AutoFilter}setIsCellSnapped(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"setIsCellSnapped"),this.model.Cells[e].IsCellSnapped=t||void 0}isCellSnapped(e){this.verifyRelativeIndexOfRowColNumbers(e,"isCellSnapped");const t=this.model.Cells[e];return MR.isCellSnapped(t)}getAdjacentBlocksFullySelectionInfo(){return(0,Se.getModelClientCache)(this.model).AdjacentBlocksFullySelectionInfo}setAdjacentBlocksFullySelectionInfo(e){(0,Se.getModelClientCache)(this.model).AdjacentBlocksFullySelectionInfo=e}getHeaderBlockModel(){return this.model}getIsHeaderSnapped(){return!!(0,Se.getModelClientCache)(this.model).isHeaderSnapped}setIsHeaderSnapped(e){(0,Se.getModelClientCache)(this.model).isHeaderSnapped=e}setStyleId(e,t){MR.verifyArgumentNotNull(t,"styleId","setStyleId");const n=this.getCell(e);if(!n)throw Error("HeaderBlockModelAccessor.setStyleId: Cell not in model");if(this.headerSnappingDiffRenderFixEnabled&&(t=MR.isCellSnapped(n)?this.getUpdatedCellAlignmentFromCenterToLeftRight(n,t):t),(n.StyleID||0)!==t){n.StyleID=t,!this.headerSnappingDiffRenderFixEnabled&&MR.isCellSnapped(n)&&this.updateCellAlignmentFromCenterToLeftRight(n);try{this.updateGlobalCellStyleID(n)}catch(e){vr.Hv.sendTraceTag(507130582,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Error,`HeaderBlockModelAccessor.setStyleId: ${e}`)}return!0}return!1}getStyleId(e){const t=this.getCell(e);if(!t)throw Error("HeaderBlockModelAccessor.setStyleId: Cell not in model");return t.StyleID||0}updateStylesForNamedSheetView(e){const t=(0,Se.isIncreasedHeaderSizeEnabled)(this.model)?(0,Se.getRowHeaderStylesArray)(Se.ViewMode.NamedSheetView,this.model.IsRtl):Se.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements;this.model.Styles=e?t:Se.ColumnHeadersNSVStylesArray,(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.NewDefaultTemplate,this.model)&&(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.NewThemeFontForHeaderFBarNBox,this.model)?this.model.Fonts=Se.HeadersNSVFonts:this.model.Fonts=Se.OldHeadersNSVFonts,this.processStyles(this.model)}updateStylesForDefaultViewMode(e){const t=(0,Se.isIncreasedHeaderSizeEnabled)(this.model)?(0,Se.getRowHeaderStylesArray)(Se.ViewMode.Default,this.model.IsRtl):Se.RowHeadersStylesArrayBeforeHeaderDragImprovements;this.model.Styles=e?t:Se.ColumnHeadersStylesArray,(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.NewDefaultTemplate,this.model)&&(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.NewThemeFontForHeaderFBarNBox,this.model)?this.model.Fonts=Se.HeadersFonts:this.model.Fonts=Se.OldHeadersFonts,this.processStyles(this.model)}updateSpillInformation(e,t){const n=this.getOrCreateCanvasContext(),o=e*t;wr(this.model)||Rr(this.model,o);for(const o of this.model.Cells)pn(this.model,o,"updateSpillInformation"),o.Spill=void 0,SS(n,this.model,o,e,t)}setCellExtent(e,t){const n=this.isRow?this.model.RowHeights:this.model.ColumnWidths;MR.verifyArgumentNotNull(n,"blockExtents","setCellExtent");const o=this.isRow?this.model.RowOffsets:this.model.ColumnOffsets;MR.verifyArgumentNotNull(o,"blockOffsets","setCellExtent"),(e>n.length-1||e<0)&&MR.throwErrorWrapper("Cell not in model","setCellExtent"),t<=0&&MR.throwErrorWrapper("Cell extent cannot be a non positive value","setCellExtent"),function(e,t,n,o){const r=o?e.ColumnWidths:e.RowHeights,i=n-r[t];0!==i&&(r[t]=n,aR(o?e.ColumnOffsets:e.RowOffsets,t+1,i),o?e.BlockWidth+=i:e.BlockHeight+=i)}(this.model,e,t,!this.isRow),this.setDirty("setCellExtent",Se.DirtyType.ModelCoreChanges)}getCellExtent(e){const t=this.isRow?this.model.RowHeights:this.model.ColumnWidths;return MR.verifyArgumentNotNull(t,"blockExtents","getCellExtent"),(e>t.length-1||e<0)&&MR.throwErrorWrapper("Cell not in model","getCellExtent"),t[e]}getAutoFilterMenuOffsetsFromCellStart(e,t,n){this.verifyRelativeIndexOfRowColNumbers(e,"getAutoFilterMenuOffsetsFromCellStart");const o=this.model.Cells[e];return this.getAutoFilterMenuOffsetsFromCellStartInternal(o,t,n)}getAutoFilterButtonTotalSize(e,t,n){this.verifyRelativeIndexOfRowColNumbers(e,"getAutoFilterButtonTotalSize");const o=this.model.Cells[e];return this.getAutoFilterButtonTotalSizeInternal(o,t,n)}addRowColToModel(e,t){!function(e,t,n,o,r){const i=r?e.RowNumbers:e.ColumnNumbers;if(i.indexOf(n)>=0)throw Error(`addRowColToModel: Invalid absolute index. ${r?"Row":"Column"} ${n} already exists in model`);if(o<0||o>i.length)throw Error("addRowColToModel: Invalid relative index.");var l,a;!function(e,t,n,o){const r=(o?e.RowNumbers.length:e.ColumnNumbers.length)+1,i=dR(e,o);if(iR(e.Cells,o,r,n,t,i,!1,0),i){const l=n+r,a=rR(o);iR(e.Cells,o,r,l,t,i,!0,a)}}(e,n,o,r),go(i,o,n),go(r?e.RowHeights:e.ColumnWidths,o,Se.MinimalCellExtent),go(l=r?e.RowOffsets:e.ColumnOffsets,a=o,l[a]),aR(l,a+1,Se.MinimalCellExtent),r?e.BlockHeight+=Se.MinimalCellExtent:e.BlockWidth+=Se.MinimalCellExtent,t.resetCellLookup(),oR(e,r,o,!0)}(this.model,this,e,t,this.isRow)}updateCellText(e,t){MR.verifyArgumentNotNull(t,"text","updateCellText"),this.verifyRelativeIndexOfRowColNumbers(e,"updateCellText");const n=this.model.Cells[e];n.Text=t,n.Spill={SpanToStart:0,SpanToEnd:0,IsSpillBlocked:!0}}setUnsetShowResizePill(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"setUnsetShowResizePill"),this.model.Cells[e].ShowResizePill=t}setUnsetResizePillLocation(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"setUnsetResizePillLocation"),this.model.Cells[e].ResizePillLocation=null!=t?t:void 0}setUnsetHoveredCell(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"setUnsetHoveredCell"),this.model.Cells[e].IsHovered=t}setInsertButton(e,t,n){this.verifyRelativeIndexOfRowColNumbers(e,"setInsertButton"),en(n,"buttonType","setInsertButton");const o=this.model.Cells[e];Bt(o.InsertButtons)&&(o.InsertButtons={Start:void 0,End:void 0});const r={Type:n};let i=!1,l=0;return t?this.areInsertButtonsSame(o.InsertButtons.Start,r)||(l=Math.max(IR(r),IR(o.InsertButtons.Start)),o.InsertButtons.Start=r,i=!0):this.areInsertButtonsSame(o.InsertButtons.End,r)||(l=Math.max(IR(o.InsertButtons.End),IR(r)),o.InsertButtons.End=r,i=!0),i&&this.setCellsDirtyForInsertButtonSpillOnUpdate(e,t,l),i}removeInsertButton(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"removeInsertButton");const n=this.model.Cells[e];let o=!1,r=0;var i,l,a,s;return t?(null===(i=n.InsertButtons)||void 0===i?void 0:i.Start)&&(r=IR(null===(l=n.InsertButtons)||void 0===l?void 0:l.Start),n.InsertButtons.Start=void 0,o=!0):(null===(a=n.InsertButtons)||void 0===a?void 0:a.End)&&(r=IR(null===(s=n.InsertButtons)||void 0===s?void 0:s.End),n.InsertButtons.End=void 0,o=!0),o&&this.setCellsDirtyForInsertButtonSpillOnUpdate(e,t,r),o}updateCellAlignment(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"updateCellAlignment");const n=this.model.Cells[e];if(this.headerSnappingDiffRenderFixEnabled){const e=n.StyleID||0;n.StyleID=t?this.getUpdatedCellAlignmentFromCenterToLeftRight(n,e):this.getUpdatedCellAlignmentFromLeftRightToCenter(n,e)}else t?this.updateCellAlignmentFromCenterToLeftRight(n):this.updateCellAlignmentFromLeftRightToCenter(n);try{this.updateGlobalCellStyleID(n)}catch(e){vr.Hv.sendTraceTag(507130581,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Error,`HeaderBlockModelAccessor.updateCellAlignment: ${e}`)}}activateCellAutoFilter(e,t){this.verifyAutoFilterArguments(e,t),this.model.Cells[e].AutoFilter=t}deactivateCellAutoFilter(e){this.verifyRelativeIndexOfRowColNumbers(e,"deactivateCellAutoFilter"),this.isRow&&MR.throwErrorWrapper("AutoFilter in headerSnapping should be deactivated only for column header, but called for row header","deactivateCellAutoFilter"),this.model.Cells[e].AutoFilter=void 0}getCellAutoFilterCommandData(e){this.verifyRelativeIndexOfRowColNumbers(e,"getCellAutoFilterCommandData");const t=this.model.Cells[e].AutoFilter;return t||MR.throwErrorWrapper(`AutoFilter should be initialized by now but is undefined, cellRelativeIndex=${e}`,"getCellAutoFilterCommandData"),t.CommandData}removeRowColFromModel(e,t){!function(e,t,n,o,r){const i=r?e.RowNumbers:e.ColumnNumbers;if(i.indexOf(n)<0)throw Error(`removeRowColFromModel: Invalid absolute index. ${r?"Row":"Column"} ${n} doesn't exists in model`);if(o<0||o>=i.length)throw Error("removeRowColFromModel: Invalid relative index.");const l=r?e.RowHeights[o]:e.ColumnWidths[o];!function(e,t,n){const o=(n?e.RowNumbers.length:e.ColumnNumbers.length)-1;if(lR(e.Cells,t,o,n,0),dR(e,n)){const r=t+o,i=rR(n);lR(e.Cells,r,2*o,n,i)}}(e,o,r),fo(i,o),fo(r?e.RowHeights:e.ColumnWidths,o),function(e,t){const n=t===e.length-1?0:e[t+1]-e[t];fo(e,t),aR(e,t,-n)}(r?e.RowOffsets:e.ColumnOffsets,o),r?e.BlockHeight-=l:e.BlockWidth-=l,t.resetCellLookup(),oR(e,r,o,!1)}(this.model,this,e,t,this.isRow)}isLastRowColOfPreviousBlockHidden(){var e,t;return this.isRow?!!(null===(e=this.model.AdjacentBlocksHiddensInfo)||void 0===e?void 0:e.IsLastRowOfPrevBlockHidden):!!(null===(t=this.model.AdjacentBlocksHiddensInfo)||void 0===t?void 0:t.IsLastColOfPrevBlockHidden)}setCellDirty(e,t){const n=this.isRow?this.model.RowHeights:this.model.ColumnWidths;if(MR.verifyArgumentNotNull(n,"blockExtents","setCellDirty"),(e>n.length-1||e<0)&&MR.throwErrorWrapper(`Cell index ${e} not in model, length ${n.length}`,"setCellDirty"),(0,Se.isPartialHeaderCellRenderingEnabled)()){const n=this.ensureDirtyCellsMapInitialized();this.setCellDirtyInternal(e,t,n)}else{const t=this.ensureDirtyCellsKeysInitialized();this.addCellToDirtyCellKeys(e,t),this.setAdjacentCellsDirtyIfHidden(e,t,void 0,Se.DirtyHeaderCellArea.EntireCell),(0,Se.isHeaderInsertEnabled)()&&this.setCellsDirtyForInsertButtonSpillsForCell(e,t,void 0)}(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.DelayRenderToNextAnimationFrame,this.model)?this.setDirtyInternal(Se.DirtyType.ModelCellChanges,!0):this.setDirtyInternal(Se.DirtyType.ModelCellChanges)}setDataCleansingIcon(e,t){const n=this.getCell(e);if(!n)throw Error("HeaderBlockModelAccessor.setDataCleansingIcon: Cell not in model");n.DataCleansingIcon=t}getCell(e){return this.model.Cells[e]}updateCellAlignmentFromCenterToLeftRight(e){MR.verifyArgumentNotNull(e,"cell","updateCellAlignmentLeftRight"),null!==e.StyleID&&void 0!==e.StyleID||(e.StyleID=Se.UniqueHeadersStyleID.Default);const t=this.model.IsRtl;switch(e.StyleID){case Se.UniqueHeadersStyleID.Default:e.StyleID=t?Se.UniqueHeadersStyleID.RightAlignment:Se.UniqueHeadersStyleID.LeftAlignment;break;case Se.UniqueHeadersStyleID.Hover:e.StyleID=t?Se.UniqueHeadersStyleID.HoverRightAlignment:Se.UniqueHeadersStyleID.HoverLeftAlignment;break;case Se.UniqueHeadersStyleID.PartialRowColSelection:e.StyleID=t?Se.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment:Se.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment;break;case Se.UniqueHeadersStyleID.PartialSelectionAndHover:e.StyleID=t?Se.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment:Se.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment;break;case Se.UniqueHeadersStyleID.WholeSelectionAndHover:e.StyleID=t?Se.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment:Se.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment;break;case Se.UniqueHeadersStyleID.WholeRowColSelection:e.StyleID=t?Se.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment:Se.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment;break;default:vr.Hv.sendTraceTag(509216715,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`updateCellAlignmentLeftRight: cell's styleId is unexpected, styleId=${e.StyleID}, cell.col=${e.Col}`)}}updateCellAlignmentFromLeftRightToCenter(e){switch(MR.verifyArgumentNotNull(e,"cell","updateCellAlignmentCenter"),null!==e.StyleID&&void 0!==e.StyleID||(e.StyleID=Se.UniqueHeadersStyleID.LeftAlignment),e.StyleID){case Se.UniqueHeadersStyleID.RightAlignment:case Se.UniqueHeadersStyleID.LeftAlignment:e.StyleID=Se.UniqueHeadersStyleID.Default;break;case Se.UniqueHeadersStyleID.HoverRightAlignment:case Se.UniqueHeadersStyleID.HoverLeftAlignment:e.StyleID=Se.UniqueHeadersStyleID.Hover;break;case Se.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment:case Se.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment:e.StyleID=Se.UniqueHeadersStyleID.PartialRowColSelection;break;case Se.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment:case Se.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment:e.StyleID=Se.UniqueHeadersStyleID.PartialSelectionAndHover;break;case Se.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment:case Se.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment:e.StyleID=Se.UniqueHeadersStyleID.WholeSelectionAndHover;break;case Se.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment:case Se.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment:e.StyleID=Se.UniqueHeadersStyleID.WholeRowColSelection;break;default:vr.Hv.sendTraceTag(509216714,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`updateCellAlignmentCenter: cell's styleId is unexpected, styleId=${e.StyleID}, cell.col=${e.Col}`)}}getUpdatedCellAlignmentFromCenterToLeftRight(e,t){MR.verifyArgumentNotNull(e,"cell","updateCellAlignmentLeftRight");const n=this.model.IsRtl;switch(t){case Se.UniqueHeadersStyleID.Default:return n?Se.UniqueHeadersStyleID.RightAlignment:Se.UniqueHeadersStyleID.LeftAlignment;case Se.UniqueHeadersStyleID.Hover:return n?Se.UniqueHeadersStyleID.HoverRightAlignment:Se.UniqueHeadersStyleID.HoverLeftAlignment;case Se.UniqueHeadersStyleID.PartialRowColSelection:return n?Se.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment:Se.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment;case Se.UniqueHeadersStyleID.PartialSelectionAndHover:return n?Se.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment:Se.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment;case Se.UniqueHeadersStyleID.WholeSelectionAndHover:return n?Se.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment:Se.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment;case Se.UniqueHeadersStyleID.WholeRowColSelection:return n?Se.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment:Se.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment;default:vr.Hv.sendTraceTag(506849216,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`updateCellAlignmentLeftRight: styleId is unexpected, styleId=${t}, cell.col=${e.Col}`)}return t}getUpdatedCellAlignmentFromLeftRightToCenter(e,t){switch(MR.verifyArgumentNotNull(e,"cell","updateCellAlignmentCenter"),t){case Se.UniqueHeadersStyleID.RightAlignment:case Se.UniqueHeadersStyleID.LeftAlignment:return Se.UniqueHeadersStyleID.Default;case Se.UniqueHeadersStyleID.HoverRightAlignment:case Se.UniqueHeadersStyleID.HoverLeftAlignment:return Se.UniqueHeadersStyleID.Hover;case Se.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment:case Se.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment:return Se.UniqueHeadersStyleID.PartialRowColSelection;case Se.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment:case Se.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment:return Se.UniqueHeadersStyleID.PartialSelectionAndHover;case Se.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment:case Se.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment:return Se.UniqueHeadersStyleID.WholeSelectionAndHover;case Se.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment:case Se.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment:return Se.UniqueHeadersStyleID.WholeRowColSelection;default:vr.Hv.sendTraceTag(506849187,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`updateCellAlignmentCenter: styleId is unexpected, styleId=${t}, cell.col=${e.Col}`)}return t}verifyRelativeIndexOfRowColNumbers(e,t){const n=this.isRow?this.model.RowNumbers.length:this.model.ColumnNumbers.length;(e<0||e>=n)&&MR.throwErrorWrapper(`Invalid header relative index, received index=${e}, but headerNumbers.length=${n}`,t)}verifyAutoFilterArguments(e,t){this.isRow&&MR.throwErrorWrapper("AutoFilter in headerSnapping should be activated only for column header, but called for row header","activateCellAutoFilter"),MR.verifyArgumentNotNull(t,"autoFilterData","activateCellAutoFilter"),this.verifyRelativeIndexOfRowColNumbers(e,"activateCellAutoFilter")}setAdjacentCellsDirtyIfHidden(e,t,n,o){const r=this.isRow?this.model.RowNumbers:this.model.ColumnNumbers;(0,Se.isPartialHeaderCellRenderingEnabled)()?(o&Se.DirtyHeaderCellArea.CellStartGridlineArea&&this.isPrevCellHidden(r,e)&&this.addCellToDirtyCellsMap(e-1,Se.DirtyHeaderCellArea.CellEndGridlineArea,n),o&Se.DirtyHeaderCellArea.CellEndGridlineArea&&this.isNextCellHidden(r,e)&&this.addCellToDirtyCellsMap(e+1,Se.DirtyHeaderCellArea.CellStartGridlineArea,n)):(this.isPrevCellHidden(r,e)&&this.addCellToDirtyCellKeys(e-1,t),this.isNextCellHidden(r,e)&&this.addCellToDirtyCellKeys(e+1,t))}setCellsDirtyForInsertButtonSpillOnUpdate(e,t,n){const o=(0,Se.isPartialHeaderCellRenderingEnabled)()?e=>this.addCellToDirtyCellsMap(e,Se.DirtyHeaderCellArea.GutterArea,this.ensureDirtyCellsMapInitialized()):e=>this.addCellToDirtyCellKeys(e,this.ensureDirtyCellsKeysInitialized());bR(this.model,this,e,t,n,o)}setCellsDirtyForInsertButtonSpillsForCell(e,t,n){var o,r;const i=(0,Se.isPartialHeaderCellRenderingEnabled)()?e=>this.addCellToDirtyCellsMap(e,Se.DirtyHeaderCellArea.GutterArea,n):e=>this.addCellToDirtyCellKeys(e,t),l=this.model.Cells[e],a=IR(null===(o=l.InsertButtons)||void 0===o?void 0:o.Start),s=IR(null===(r=l.InsertButtons)||void 0===r?void 0:r.End);bR(this.model,this,e,!0,a,i),bR(this.model,this,e,!1,s,i)}setCellDirtyInternal(e,t,n){const o=this.addCellToDirtyCellsMap(e,t,n);this.setAdjacentCellsDirtyIfHidden(e,void 0,n,o),(0,Se.isHeaderInsertEnabled)()&&o&Se.DirtyHeaderCellArea.GutterArea&&this.setCellsDirtyForInsertButtonSpillsForCell(e,void 0,n)}processStyles(e){en(e,"model","processStyles"),en(e.Fonts,"model.Fonts","HeaderBlockModelAccessor:processStyles"),en(e.Styles,"model.Styles","HeaderBlockModelAccessor:processStyles");const t=e.Fonts,n=e.Styles;if((0,Se.isGlobalFontsAndCellStylesFlightEnabled)(e)){try{this.processStylesWithGlobalFonts(n,t)}catch(e){(0,Se.disableGlobalFonts)(`HeaderBlockModelAccessor::ProcessStyle:: Fonts Processing failed with exception ${e}`)}try{this.processCellsWithGlobalCellStyles(e.Cells,e.Styles)}catch(e){(0,Se.disableGlobalCellStyles)(`HeaderBlockModelAccessor::ProcessStyle:: Cell Styles Processing failed with exception ${e}`)}}}processStylesWithGlobalFonts(e,t){(0,Se.getGlobalFontsMap)().process(t);for(let n=0;n<e.length;n++){const o=e[n];if(o){const e=o.FontID||0,n=(0,Se.getGlobalStyleId)(e,t);if(null==n)throw new Error(`HeaderBlockModelAccessor::preprocessStylesWithGlobalFonts: Local FontID ${e} not mapped to a Global Font ID`);o.GlobalFontID=n}}}processCellsWithGlobalCellStyles(e,t){(0,Se.getGlobalCellStylesMap)().process(t);for(let t=0;t<e.length;t++){const n=e[t];try{this.updateGlobalCellStyleID(n)}catch(e){vr.Hv.sendTraceTag(507130580,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Error,`HeaderBlockModelAccessor.processCellsWithGlobalCellStyles: ${e}`)}}}updateGlobalCellStyleID(e){if(!(0,Se.isGlobalFontsAndCellStylesFlightEnabled)(this.model))return;const t=e.StyleID||0,n=(0,Se.getGlobalStyleId)(t,this.model.Styles);if(null==n)throw new Error(`HeaderBlockModelAccessor::updateGlobalCellStyleID: Local Cell StyleID ${t} not mapped to a Global Style ID`);e.GlobalCellStyleID=n}addCellToDirtyCellKeys(e,t){const n=this.getHeaderRegularCellsIndex(),o=this.isRow?e:n,r=this.isRow?n:e;t.push((0,Se.getCellLookupKey)(o,r))}addCellToDirtyCellsMap(e,t,n){const o=this.getHeaderRegularCellsIndex(),r=this.isRow?e:o,i=this.isRow?o:e,l=(0,Se.getCellLookupKey)(r,i);var a;const s=null!==(a=n.get(l))&&void 0!==a?a:0,d=this.validateAndExpandDirtyAreas(e,s|t);return n.set(l,d),d}validateAndExpandDirtyAreas(e,t){let n=t;if(0==(n&Se.DirtyHeaderCellArea.EntireCell)&&n&(Se.DirtyHeaderCellArea.CellStartGridlineArea|Se.DirtyHeaderCellArea.CellEndGridlineArea)){let t=!0;this.isCellSnapped(e)&&(t=!1),t&&!this.isCellSizeSufficientForPartialGridlineRendering(e)&&(t=!1),t&&this.isRow&&(n|=Se.DirtyHeaderCellArea.GutterArea),t||(n|=Se.DirtyHeaderCellArea.EntireCell)}return 0==(n&(Se.DirtyHeaderCellArea.EntireCell|Se.DirtyHeaderCellArea.GutterArea|Se.DirtyHeaderCellArea.CellStartGridlineArea|Se.DirtyHeaderCellArea.CellEndGridlineArea))&&(n=Se.DirtyHeaderCellArea.EntireCell),n&Se.DirtyHeaderCellArea.EntireCell&&(n=Se.DirtyHeaderCellArea.EntireCell|Se.DirtyHeaderCellArea.GutterArea|Se.DirtyHeaderCellArea.CellStartGridlineArea|Se.DirtyHeaderCellArea.CellEndGridlineArea),n}isCellSizeSufficientForPartialGridlineRendering(e){const t=this.getCellExtent(e);if(this.isRow)return t>HR;{var n;const o=null===(n=this.model.Cells[e].Text)||void 0===n?void 0:n.length;return t>(o?14*o:At)+6}}getHeaderRegularCellsIndex(){return br(this.model,this.isRow)?1:0}areInsertButtonsSame(e,t){return(null==e?void 0:e.Type)===(null==t?void 0:t.Type)}isPrevCellHidden(e,t){return t>0&&e[t]>e[t-1]+1}isNextCellHidden(e,t){return t<e.length-1&&e[t+1]>e[t]+1}constructor(e,t){super(e),this.headerSnappingDiffRenderFixEnabled=!1,this.isRow=t,this.processStyles(e),(0,Se.isChangeGateEnabled)(Se.ChangeGate.RestrictStylesPreProcess)&&(e.AreStylesProcessed=!0),this.headerSnappingDiffRenderFixEnabled=(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.FixHeaderSnappingDiffRendering",!1)}}const PR=3,OR=5,kR=5.5,ER=3.5,LR=5,NR=.25,zR=2*kR+LR,GR=OR+LR,WR=OR+1,VR=2*ER+LR,_R=PR+LR,UR=PR+1;let jR,qR;function $R(e,t,n,o,r,i,l,a){var s;e.strokeStyle=n,e.fillStyle=o,e.lineWidth=t,e.beginPath(),null===(s=e.roundRect)||void 0===s||s.call(e,r,i,l-t,a-t,[90]),e.fill(),e.stroke()}function XR(e){return e?Vn(e.TextColor):AR}function YR(e){return e?Vn(e.BackgroundColor):BR}function KR(e,t,n,o){return{x:ta(e,t,e.IsRtl)-20*n-2*n,y:(o&&t.ResizePillLocation===Se.LocationInCell.CellStart?ia(e,t,!1):na(e,t))-PR*n/2}}function JR(e,t,n,o,r){const i=(r&&t.ResizePillLocation===Se.LocationInCell.CellStart?Ql(e,t,e.IsRtl,!1):ta(e,t,e.IsRtl)+Le)-OR*n/2,l=ia(e,t,!1),a=Br(n,o);return{x:i,y:l+a+(Zl(e,t)-a-16*n)/2}}const ZR=10,QR=12,ew=6,tw=4;function nw(e,t,n,o,r){const i={TopPx:r?n.EndPoint.TopPx:o,LeftPx:r?o:n.EndPoint.LeftPx,Cell:t};n.Button={EdgeInformation:i,IsExpand:n.IsExpanded},e.push(n.Button)}function ow(e,t,n,o,r,i){const l=!!t.IsNonDefaultDirection;!function(e,t,n,o,r){const i=-1===t.StartIndex,l=r&&i,a=function(e,t,n,o){return e.IsRow?o?e.BlockHeight*t:0:n}(e,o,n,l),s=function(e,t,n,o){return e.IsRow?n:o?e.IsRtl?0:e.BlockWidth*t:e.IsRtl?e.BlockWidth*t:0}(e,o,n,l);t.StartPoint={TopPx:a,LeftPx:s}}(e,t,r,i,l),function(e,t,n,o,r,i){const l=!!t.IsButtonHidden;if(e.IsRow){const a=function(e,t,n,o,r,i){let l=bt;return t?r?l=i?na(e,n)-bt:ia(e,n,!1)+bt:(l+=oa(e,n),l-=dw(o)):l+=i?0:e.BlockHeight*o,Math.floor(l)}(e,o,n,r,l,i);t.EndPoint={TopPx:a,LeftPx:t.StartPoint.LeftPx}}else{const a=function(e,t,n,o,r,i){let l=0;const a=e.IsRtl,s=a&&i,d=!a&&i;return t?r?l+=a&&!i||d?ta(e,n,!1):Ql(e,n,!1,!1):(l=ra(e,n,!1),l-=dw(o)):l=d?0:!a||s?e.BlockWidth*o:0,Math.floor(l)}(e,o,n,r,l,i);t.EndPoint={TopPx:t.StartPoint.TopPx,LeftPx:a}}}(e,t,n,o,i,l)}function rw(e,t,n,o){const r=n.StartIndex;r>-1&&(function(e,t,n,o){const r=cw(e,n),i=!!t.IsNonDefaultDirection;if(e.IsRow){const n=function(e,t,n){return n?na(e,t):ia(e,t,!1)}(e,r,i);t.StartPoint.TopPx=n>0?n-bt:0}else t.StartPoint.LeftPx=function(e,t,n,o){return e.IsRtl?function(e,t,n,o){return n?iw(e,t):lw(e,t,o)}(e,t,n,o):function(e,t,n,o){return n?lw(e,t,o):iw(e,t)}(e,t,n,o)}(e,r,i,o)}(e,n,r,o),function(e,t,n,o){const r=Math.round(tw*o),i=e.IsRow,l=t.StartPoint,a=function(e,t,n,o){return n?o?e-t-bt:e+t+bt:e}(l.LeftPx,r,i,e.IsRtl);ur(n,a,i?l.TopPx:l.TopPx+r,l.LeftPx,l.TopPx)}(e,n,t,o))}function iw(e,t){const n=Ql(e,t,!1,!1);return n>0?n-bt:bt}function lw(e,t,n){const o=ta(e,t,!1),r=e.BlockWidth*n;return o<r?o+bt:r-bt}function aw(e,t,n,o){const r=Math.round((ew+e*QR)*t);return n?Math.floor(o*t)-r:r}function sw(e,t,n){const o=t?0:Le;return e-dw(n)+o}function dw(e){return hy(e,ZR)/2}function cw(e,t){return e.IsRow?(0,Se.getCell)(t,0,e):(0,Se.getCell)(0,t,e)}function uw(e,t,n,o,r,i,l){i&&!t.IsButtonHidden&&nw(o,l,t,r,e.IsRow),ur(n,t.StartPoint.LeftPx,t.StartPoint.TopPx,t.EndPoint.LeftPx,t.EndPoint.TopPx)}function hw(e,t){return t&&(0,Se.isChangeGateEnabled)(Se.ChangeGate.HiddenIndicatorZoomFixEnabled)?Se.DefaultHiddenRowColInnerGapPx+2*pw(e):Se.DefaultHiddenRowColInnerGapPx+Le}function gw(e,t){return t?e+Le:e-Le}function fw(e,t,n,o,r,i,l,a,s,d,c,u,h,g,f,C){const{hiddenFrameStartPositionsPx:m,hiddenFramePartiallySelectedStartPositionsPx:p,hiddenFrameWhollySelectedStartPositionsPx:y}=function(e,t,n,o,r,i){const l=[],a=[],s=[],{startIndex:d,endIndex:c}=function(e,t,n){return{startIndex:e>0?e-1:0,endIndex:t<n?t+1:n}}(o,r,t.length-1);let u=t[d],h=Tr(n[d]),g=!!i&&Dr(n[d]);for(let o=d+1;o<=c;o++){const r=t[o],d=Tr(n[o]),c=!!i&&Dr(n[o]);r>u+1&&mw(e[o],h&&d?a:g&&c?s:l),h=d,g=c,u=r}return{hiddenFrameStartPositionsPx:l,hiddenFramePartiallySelectedStartPositionsPx:a,hiddenFrameWhollySelectedStartPositionsPx:s}}(r,i,o,c,u,C);!function(e,t,n,o,r,i,l,a){let s=n;if(e){const e=i[0];Tr(e)&&(s=o),a&&Dr(e)&&(s=r),mw(l[0],s)}if(t){const e=i[i.length-1];s=n,Tr(e)&&(s=o),a&&Dr(e)&&(s=r),mw(l[l.length-1],s)}}(h,g,m,p,y,o,r,C),Cw(m,e,t,n,l,a,s,d,!1,!1,f,C),C&&y.length>0&&Cw(y,e,t,n,l,a,s,d,!1,!0,f,C),Cw(p,e,t,n,l,a,s,d,!0,!1,f,C)}function Cw(e,t,n,o,r,i,l,a,s,d,c,u){if(e.length>0){const{frameOutlinesColor:h,fillColor:g}=function(e,t,n,o){return Bt(e.highContrastScheme)?e.viewMode===Se.ViewMode.NamedSheetView?o?{frameOutlinesColor:t||n?He:Be,fillColor:Se.NSVHeaderBackgroundColor}:t?{frameOutlinesColor:Ie,fillColor:Se.NSVHeaderBackgroundColor}:{frameOutlinesColor:be,fillColor:Se.NSVHeaderBackgroundColor}:o?t?{frameOutlinesColor:xe,fillColor:Se.PartialRowColSelectionBackgroundColor}:n?{frameOutlinesColor:Ae,fillColor:Se.WholeRowColSelectionBackgroundColor}:{frameOutlinesColor:Te,fillColor:De}:t?{frameOutlinesColor:we,fillColor:Se.PartialRowColSelectionBackgroundColor}:{frameOutlinesColor:Re,fillColor:Se.DefaultHeaderBackgroundColor}:{frameOutlinesColor:`${Vn(e.highContrastScheme.TextColor)}`,fillColor:`${Vn(e.highContrastScheme.BackgroundColor)}`}}(n,s,d,u);!function(e,t,n,o,r,i,l,a,s){if(s&&(0,Se.isChangeGateEnabled)(Se.ChangeGate.HiddenIndicatorZoomFixEnabled)){t.fillStyle=l;for(const l of r){const r=l-pw(e);t.fillRect(i?a:r,i?r:a,n,o)}}else{t.lineWidth=Le,t.strokeStyle=l,t.beginPath();for(const e of r){const r=e-wn(Le);t.rect(i?a:r,i?r:a,n,o)}t.stroke()}}(n,t,r,i,e,o,h,c,u),function(e,t,n,o,r,i,l){e.fillStyle=i;for(const i of o)e.fillRect(r?l:i,r?i:l,t,n)}(t,l,a,e,o,g,u&&!(0,Se.isChangeGateEnabled)(Se.ChangeGate.HiddenIndicatorZoomFixEnabled)?c-Le:c)}}function mw(e,t){const n=e-Math.ceil(Se.DefaultHiddenRowColInnerGapPx/2);t.push(n)}function pw(e){return Le*Math.max(Math.round(e.scaleFactor),1)}const yw=2,Sw=2,Rw=3,ww=2,bw=5,Iw=11;function vw(e,t,n,o,r){const i=Tw(e,t,o,r),l=Math.round((e.IsRow?Ql(e,t,e.IsRtl,!1):ia(e,t,!1))+Hr(e.IsRow?6:1,n)),a=Dw(Rw,o,r),s=Dw(2,o,r);return e.IsRow?{x:l,y:i,width:s,height:a}:{x:i,y:l,width:a,height:s}}function Fw(e,t,n){const o=Hr(yw,n),r=Hr(Sw,n),i=Dw(Rw,o,r),l=e.IsRow?Zl(e,t):Jl(e,t);if(l<=i)return;const a=Tw(e,t,o,r);if(e.IsRow){const o=Ql(e,t,e.IsRtl,!1),r=Hr(Tt,n),s=Hr(ww,n),d=i+2*s;return d<l?{x:o,y:a-s,width:r,height:d}:{x:o,y:ia(e,t,!1),width:r,height:l}}{const o=ia(e,t,!1),r=Hr(Iw,n),s=Hr(bw,n),d=i+2*s;return d<l?{x:a-s,y:o,width:d,height:r}:{x:Ql(e,t,e.IsRtl,!1),y:o,width:l,height:r}}}function Tw(e,t,n,o){const r=e.IsRow?oa(e,t):ra(e,t,e.IsRtl);return Math.round(r-n/2-o-n)}function Dw(e,t,n){return e*t+(e-1)*n}let xw;const Aw="header-cell-hover";let Bw,Hw;function Mw(e,t){const n=[];for(let o=0;o<t.length;o++){const r=ua(e,t[o],!1);n.push(r)}return n}function Pw(e,t,n,o,r){const i=_s(e,t,o,e.IsRtl);Fa(n,r,i,Ag,Se.RenderFeaturesZIndex.HeaderDragDropSquares,Uw);const l=function(e,t){const n=e.IsRow,o=xr(e,n?t.Row:t.Col,n);return e=>!(!$w(e)||!vi())&&(function(e,t,n){en(di,"externalCallbacks","onHeaderDragStartCallback"),di.onHeaderDragStartCallback(e,t,n)}(n,o,e),!0)}(e,n);va(n,r,i,Se.RenderFeaturesZIndex.HeaderDragDropSquares,l,Ig)}function Ow(e,t,n,o,r,i,l){const a=i,s=function(e,t,n,o){return e?n?t?e.height>=VR*o?ER*o:e.height>=_R*o?(e.height-LR*o)/2:e.height>=UR*o?PR*o/2:e.height*NR:e.width>=zR*o?kR*o:e.width>=GR*o?(e.width-LR*o)/2:e.width>=WR*o?OR*o/2:e.width*NR:Math.max(TR,Math.min(FR,Math.floor((t?e.height:e.width)*vR))):0}(e,t,a,o);let d,c;const u=Ar(o,r);if(t){const t=l?Tt*o:0,r=n?e.x:e.x+t,i=e.width-t;d={x:r,y:e.y,width:i,height:s},c={x:r,y:e.y+e.height-s-(a?0:Math.min(Le,e.height)),width:i,height:s+(a?0:Math.min(Le,e.height))}}else n?(d={x:e.x+e.width-s,y:e.y+u,width:s,height:e.height-u},c={x:e.x,y:e.y+u,width:s+(a?0:Math.min(Le,e.width)),height:e.height-u}):(d={x:e.x,y:e.y+u,width:s,height:e.height-u},c={x:e.x+e.width-s-(a?0:Math.min(Le,e.width)),y:e.y+u,width:s+(a?0:Math.min(Le,e.width)),height:e.height-u});return{firstResizeZoneHitRegion:d,secondResizeZoneHitRegion:c}}function kw(e,t,n,o,r,i,l){const a=function(e,t,n,o){if(!e)return 0;const r=o?DR:1,i=xR*t,l=n?e.height:e.width,a=Math.min(Le,l),s=(0,Se.isChangeGateEnabled)(Se.ChangeGate.UnhideSkittleHitRegionPreventOverlap)?(l-a)*r:Math.floor(l*r);return Math.max(0,Math.min(i,s))}(e,t,n,i);let s;return s=r?n?{x:e.x,y:e.y,width:e.width,height:a}:o?{x:e.x+e.width-a,y:e.y+l,width:a,height:e.height-l}:{x:e.x,y:e.y+l,width:a,height:e.height-l}:n?{x:e.x,y:e.y+e.height-a-Math.min(Le,e.height),width:e.width,height:a+Math.min(Le,e.height)}:o?{x:e.x,y:e.y+l,width:a+Math.min(Le,e.width),height:e.height-l}:{x:e.x+e.width-a-Math.min(Le,e.width),y:e.y+l,width:a+Math.min(Le,e.width),height:e.height-l},s}function Ew(e,t,n,o,r,i,l,a,s,d,c,u){const h=Vw(r,o,l,a,s,!1,d,u),g=Vw(r,o,l,a,s,!0,d,u),f=function(e,t){return n=>Yw(e,!0,t)&&"touch"!==n.pointerType&&"pen"!==n.pointerType}(l,u);Fa(e,t,n,i,Se.RenderFeaturesZIndex.HeaderResize,f),va(e,t,n,Se.RenderFeaturesZIndex.HeaderResize,h,Ig),va(e,t,n,Se.RenderFeaturesZIndex.HeaderResize,g,Hg),c&&(Da(e,t,n,Se.RenderFeaturesZIndex.HeaderResize,Ww(o,r,l,!0,u)),xa(e,t,n,Se.RenderFeaturesZIndex.HeaderResize,Ww(o,r,l,!1,u)))}function Lw(e,t,n,o,r,i,l){Da(e,t,n,Se.RenderFeaturesZIndex.UnhideSkittle,_w(o,r,i,!0,l)),xa(e,t,n,Se.RenderFeaturesZIndex.UnhideSkittle,_w(o,r,i,!1,l))}function Nw(e,t,n,o,r,i,l,a){const s=_s(e,t,r,!1);Fa(n,o,s,Dg,Se.RenderFeaturesZIndex.HeaderInsert,function(e,t,n){return o=>Fi(e,t,n)&&"touch"!==o.pointerType&&"pen"!==o.pointerType}(i,l,a)),Da(n,o,s,Se.RenderFeaturesZIndex.HeaderInsert,jw(i,l,a,!0)),xa(n,o,s,Se.RenderFeaturesZIndex.HeaderInsert,jw(i,l,a,!1)),va(n,o,s,Se.RenderFeaturesZIndex.HeaderInsert,function(e,t,n){return o=>!(!$w(o)||!Fi(e,t,n))&&(function(e,t,n,o){en(di,"externalCallbacks","onHeaderInsertButtonClick"),di.headerInsertButtonInvokedCallback(e,t,n,o)}(e,t,n,o),!0)}(i,l,a),Bg),va(n,o,s,Se.RenderFeaturesZIndex.HeaderInsert,function(e,t,n){return o=>!(!$w(o)||!Fi(e,t,n))}(i,l,a),Ig)}function zw(e,t,n){const o=n?1:0;return t?e.filter((e=>e.Col===o)):e.filter((e=>e.Row===o))}function Gw(e,t,n){const o=e.IsRow,r=o?t.Row:t.Col,i=xr(e,r,o);return e=>("touch"!==e.pointerType&&(Hi()&&n&&function(e,t,n){Hi()&&di.trackGridRendererEventResponseTime(e,t,void 0)}(e,[Aw]),function(e,t,n,o){en(di,"externalCallbacks","setOrRemoveHoveredCellCallback"),di.setOrRemoveHoveredCellCallback(e,t,n,o)}(i,r,o,n)),!0)}function Ww(e,t,n,o,r){return i=>(Yw(n,o,r)&&"touch"!==i.pointerType&&"pen"!==i.pointerType&&function(e,t,n,o){en(di,"externalCallbacks","setOrRemoveResizeZoneHoveredCallback"),di.setOrRemoveResizeZoneHoveredCallback(e,t,n,o)}(e,t,n,o),!1)}function Vw(e,t,n,o,r,i,l,a){return s=>($w(s)&&Yw(n,!0,a)&&(!function(e,t,n,o,r,i,l){en(di,"externalCallbacks","onHeaderResizeStartCallback"),di.onHeaderResizeStartCallback(e,t,n,o,r,i,l)}(s,t,e,n,o,l,i),Xw()&&(0,Se.isChangeGateEnabled)(Se.ChangeGate.DismissUnhideSkittleOnResize)&&(o||r)&&mi(t,n,o,!1,!1)),!0)}function _w(e,t,n,o,r){return i=>("touch"!==i.pointerType&&mi(e,t,n,o,r),!1)}function Uw(e){return vi()&&"touch"!==e.pointerType&&"pen"!==e.pointerType}function jw(e,t,n,o){return r=>("touch"!==r.pointerType&&function(e,t,n,o){en(di,"externalCallbacks","onHeaderInsertAreaHovered"),di.headerInsertHitAreaHoveredCallback(e,t,n,o)}(e,t,n,o),!1)}function qw(e,t,n,o){return r=>($w(r)&&function(e,t,n,o){en(di,"externalCallbacks","setOutlineLevelCanvas"),di.expandCollapseOutlines(e,t,n,o)}(e,t,n,o),!0)}function $w(e){return!("dblclick"!==e.type&&"click"!==e.type&&"mouse"!==e.pointerType)&&0===e.button}function Xw(){return void 0===xw&&(xw=(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.UnhideRowColumnSkittleSlice2",!1)),xw}function Yw(e,t,n){let o=!1;return void 0===Hw&&(Hw=(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.RenderResizePill")&&(0,Se.isChangeGateEnabled)(Se.ChangeGate.CacheIsResizeAllowedValue)),o=Hw?n?Ii(e):function(e,t){if(void 0!==Bw){const e=Bw;return t||(Bw=void 0),e}return Bw=Ii(e),Bw}(e,t):Ii(e),o}function Kw(e,t,n,o){const r=[];let i=e.x;for(let l=0;l<t;++l){let t=e.y;for(let e=0;e<n;++e)r.push({x:i,y:t}),t+=o;i+=o}return r}function Jw(e,t,n,o,r,i){let l,a=-2;const s=t.ClientOnlyCache.CellsToRender;for(const h of s){var d,c;if(!VC(t,n,h,Se.DirtyHeaderCellArea.GutterArea))continue;const s=null===(d=h.InsertButtons)||void 0===d?void 0:d.Start,g=null===(c=h.InsertButtons)||void 0===c?void 0:c.End;if(i&&0===(t.IsRow?h.Col:h.Row))continue;const f=t.IsRow?h.Row:h.Col,C=a+1===f&&(null==l?void 0:l.Type)===(null==s?void 0:s.Type);a=f,l=g;const m=!C&&(null==s?void 0:s.Type)===o,p=(null==g?void 0:g.Type)===o;(m||p)&&(r||(e.lineWidth=n.scaleFactor*uR,e.strokeStyle=(u=n.highContrastScheme)?Vn(u.TextColor):AR,e.fillStyle=eb(n.highContrastScheme),r=!0),m&&Zw(h,t,n,s,!0,!!t.IsRow,e),p&&Zw(h,t,n,g,!1,!!t.IsRow,e))}var u;return r}function Zw(e,t,n,o,r,i,l){const a=n.scaleFactor,s=uR*a,{x:d,y:c,radius:u}=function(e,t,n,o,r,i,l){const{radius:a,paddingForDrawing:s}=function(e,t,n,o){let r=0,i=0;return t?(e.Type===Se.InsertButtonType.InsertDot&&(r=hR*o,i=fR*o),e.Type===Se.InsertButtonType.InsertButton&&(r=mR*o,i=yR*o)):(e.Type===Se.InsertButtonType.InsertDot&&(r=hR*o,i=gR*o),e.Type===Se.InsertButtonType.InsertButton&&(r=mR*o,i=pR*o)),{radius:r,paddingForDrawing:i+r+n/2}}(e,t,o,r);let d=0,c=0;return t?(d=Ql(i,l,i.IsRtl,!1),c=n?ia(i,l,!1):na(i,l)):(c=ia(i,l,!1),d=n?Ql(i,l,i.IsRtl,!1):Ql(i,l,i.IsRtl,!1)+Jl(i,l)),t?{x:d+s,y:c-wn(o),radius:a}:{x:d-wn(o),y:c+s,radius:a}}(o,i,r,s,a,t,e);o.Type===Se.InsertButtonType.InsertDot?Qw(l,d,c,u):o.Type===Se.InsertButtonType.InsertButton&&function(e,t,n,o,r){Qw(e,t,n,r),function(e,t,n,o){e.beginPath(),e.moveTo(t-o/2,n),e.lineTo(t+o/2,n),e.moveTo(t,n-o/2),e.lineTo(t,n+o/2),e.stroke()}(e,t,n,o)}(l,d,c,SR*a,u)}function Qw(e,t,n,o){e.beginPath(),e.arc(t,n,o,0,cR),e.fill(),e.stroke()}function eb(e){return e?Vn(e.BackgroundColor):BR}function tb(e,t,n,o){const r=of(t,n,o.left,o.bottom,o.size,!1);dr(e,r),Fp(e,o),cr(e,r)}function nb(e,t,n,o){!function(e,t,n,o,r,i){const l=_s(e,n,o,!1),a=(0,Se.getRenderingRegionHitTestCache)(e,no(n.renderingRegion));Fa(t,a,l,Dg,Se.RenderFeaturesZIndex.DataCleansing),Ta(t,a,l,"Clean Data",Se.RenderFeaturesZIndex.DataCleansing),va(t,a,l,Se.RenderFeaturesZIndex.DataCleansing,r,"click"),va(t,a,l,Se.RenderFeaturesZIndex.DataCleansing,(e=>!0),"pointerdown"),va(t,a,l,Se.RenderFeaturesZIndex.DataCleansing,(e=>!0),"dblclick"),va(t,a,l,Se.RenderFeaturesZIndex.DataCleansing,r,"touchend"),va(t,a,l,Se.RenderFeaturesZIndex.DataCleansing,Mg,"touchstart")}(e,t,n,o,(t=>(hi(t,(0,Se.isPassRibbonCommandsToCanvasRendererEnabled)()?Ws().DataCleansingShowTaskPane:e.RibbonCommands.DataCleansingShowTaskPane,""),!0)))}function ob(e,t,n){return!(!e.DataCleansingIcon||Po(e.PreviewText)||e.ShowSkeleton||!gr(e,t.renderingRegion)||n.size<=4)}function rb(e,t,n,o){const r=wl(t),i=Sd(r,n);return{size:i,image:cf.CircleSymbolMedium,left:BC(e,t,i,r,n),bottom:AC(e,t,n,i),highContrastScheme:o}}function ib(e){return{x:e.left,y:e.bottom-e.size,width:e.size,height:e.size}}function lb(e,t){const{x:n,y:o,width:r,height:i}=t;e.rect(n,o,r,i)}function ab(e,t,n,o){let{x:r,width:i,height:l}=o;var a;t.IsRow?(a=n.scaleFactor,i=Hr(Tt,a)+Le,t.IsRtl&&(r=o.x+o.width-i)):l=Ar(n.scaleFactor,!0)+Le,e.rect(r,o.y,i,l)}function sb(e,t,n,o,r){const{x:i,y:l,width:a,height:s}=o;if(t.IsRow){const t=Math.ceil(2*n.scaleFactor);r&Se.DirtyHeaderCellArea.CellStartGridlineArea&&e.rect(i,l,a,t),r&Se.DirtyHeaderCellArea.CellEndGridlineArea&&e.rect(i,l+s-t,a,t)}else{const o=Math.ceil(3*n.scaleFactor),d=Ar(n.scaleFactor,!0)+Le;(t.IsRtl?r&Se.DirtyHeaderCellArea.CellEndGridlineArea:r&Se.DirtyHeaderCellArea.CellStartGridlineArea)&&e.rect(i,l+d,o,s-d),(t.IsRtl?r&Se.DirtyHeaderCellArea.CellStartGridlineArea:r&Se.DirtyHeaderCellArea.CellEndGridlineArea)&&e.rect(i+a-o,l+d,o,s-d)}}class db extends yS{renderInternal(e,t,n){try{co(n.renderingRegion,t,n);const r=Pn(n);let i;r&&(i=n.highContrastScheme,function(e,t){const n=t;n.HeaderPartialSelectionFontColor=Se.PartialRowColSelectionHCFontColor,e.highContrastScheme=n}(n,i));const l=Yo(),a=n.scaleFactor,s=Math.round(t.BlockWidth*a),d=n.renderingRegion,c=Math.round(-1*d.startOffsetY*a),u=Math.round(so(t,d)*a),h=(0,Se.isPartialHeaderCellRenderingEnabled)()?n.isDifferentialRendering:(0,Se.isDifferentialRenderingSupported)(t),g=(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.HeaderDragImprovements,t),f=(0,Se.isIncreasedHeaderSizeEnabled)(t);h&&(this.setTransform(1,!1,u,c,s),(0,Se.isPartialHeaderCellRenderingEnabled)()?function(e,t,n){t.save(),t.beginPath();for(const[o,r]of e.ClientOnlyCache.DirtyCellsMap){const i=r,l=WC(e,o);i&Se.DirtyHeaderCellArea.EntireCell?lb(t,l):(i&Se.DirtyHeaderCellArea.GutterArea&&ab(t,e,n,l),i&(Se.DirtyHeaderCellArea.CellStartGridlineArea|Se.DirtyHeaderCellArea.CellEndGridlineArea)&&sb(t,e,n,l,i))}t.strokeStyle="transparent",t.stroke(),t.clip()}(t,this.ctx,n):zC(t,this.ctx)),this.setTransform(1,!1,0,0,s),this.clearHeaderCanvas(e.getWidth(),e.getHeight(),n);const m=function(e,t,n){let o;const r=!!t.IsRow;if(!br(t,r))return o;const i=n.scaleFactor,l=t.IsRtl;return o=r?{x:l?0:Math.ceil(t.ColumnOffsets[1]*i),y:0,width:l?Math.floor(t.ColumnWidths[1]*i):Math.ceil(t.ColumnWidths[1]*i),height:Math.ceil(t.BlockHeight*i)}:{x:0,y:Math.ceil(t.RowOffsets[1]*i),width:Math.ceil(t.BlockWidth*i),height:Math.ceil(t.RowHeights[1]*i)},dr(e,o),o}(this.ctx,t,n);var o;return this.setTransform(1,!1,u,c,s),zi(Gi.DrawBackgroundFillMs,(()=>function(e,t,n){if(Bt(t.Cells))return;let o;const r=Pn(n),i=t.ClientOnlyCache.CellsToRender;for(let a=0;a<i.length;a++){const s=i[a];if(ZC(s)===QC.None)continue;if(!gr(s,n.renderingRegion))continue;const d=s.CachedStyle.BackgroundColor;r&&(l=d)!==Se.PartialRowColSelectionAndHoverBackgroundColor&&l!==Se.PartialRowColSelectionBackgroundColor||(o=JC(e,t,s,QC.Solid,o,r))}var l}(this.ctx,t,n))),t.ShowHeaders&&(this.setTransform(1,t.IsRtl,u,c,s),zi(Gi.DrawGridlinesDurationMs,(()=>function(e,t,n,o){if(!Er(t,n))return;if(function(e,t,n){if(!Er(t,n))return;Xr(e,t);const o=wn(Le),r=n.scaleFactor,i=Lr(t.BlockWidth,r,!1),l=Lr(t.BlockHeight,r,!0),a=!!t.IsRow,s=t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,d=t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,c=t.BlockWidth*r,u=t.BlockHeight*r,h=n.renderingRegion,g=Vr(t,n,!0,!0),f=Vr(t,n,!0,!1);e.beginPath(),e.strokeStyle=f,a?Gr(e,s,c,o,l,h):Wr(e,d,u,o,i,h),e.stroke(),e.beginPath(),e.strokeStyle=g,a?Wr(e,d,u,o,i,h):Gr(e,s,c,o,l,h),e.stroke()}(e,t,n),Pn(n))return;const r=t.IsRow,i=function(e,t,n){const o=[],r=n?t.startRow:t.startColumn,i=n?t.endRow:t.endColumn,l=i+1;let a=!1;for(let t=r;t<l;++t){const n=e[t];if(!n){const n=(e,...t)=>t.reduce(((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t)),{}),o=e.map(((e,t,o)=>n(e,"Row","Col")));vr.Hv.sendTraceTag(509677844,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Error,`getHeaderSelectedGridLines: firstGridLine:${r}, lastRowColInRenderingRegion:${i}, gridLineIndex:${t}, cells.length:${e.length}, cells:${JSON.stringify(o)}, `)}Tr(n)?(o.push(t),a=!0):a&&(o.push(t),a=!1)}return a&&o.push(l),o}(t.Cells,n.renderingRegion,r),l=wn(Le),a=n.scaleFactor,s=Lr(t.BlockHeight,a,!0),d=Lr(t.BlockWidth,a,!1),c=t.ClientOnlyCache.AdjacentBlocksFullySelectionInfo,u=t.AdjacentBlocksHiddensInfo,h=(0,Se.isFixFullySelectedGridLinesBetweenBlocksEnabled)();r?(function(e,t,n,o,r,i,l){const a=l.length,s=n[n.length-1];e.beginPath(),e.strokeStyle=_r(t);for(let t=0;t<a;++t){const n=l[t];if(0===n)continue;const a=zr(o[n],r,i);ur(e,0,a,s,a)}e.stroke()}(e,n,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,l,s,i),function(e,t,n,o,r,i,l,a,s){if(0===t.length)return;const d=o.scaleFactor,c=Ne*d,u=2*d,h=i,g=Math.max(c,u),[f,C]=[Se.WholeRowColSelectionBackgroundColor,Se.WholeRowColSelectionBackgroundColor];let m=!1;for(let o=0;o<t.length;o++){const i=t[o];if(Se.WholeSelectionHeadersStylesSet.has(i.StyleID||0))if(l){if((0===o&&!(null==a?void 0:a.IsLastCellOfPrevBlockFullySelected)&&!(null==s?void 0:s.IsLastRowOfPrevBlockHidden)||o>0&&!m&&e[o-1]===e[o]-1)&&qr(n,h,g,0,r,o,c,u,C,f),o<t.length-1){const i=t[o+1];Se.WholeSelectionHeadersStylesSet.has(i.StyleID||0)||e[o+1]!==e[o]+1||$r(n,h,g,0,r,o,c,u,C,f)}else o!==t.length-1||(null==a?void 0:a.IsFirstCellOfNextBlockFullySelected)||(null==s?void 0:s.IsFirstRowOfNextBlockHidden)||$r(n,h,g,0,r,o,c,u,C,f);m=!0}else{if(o>0&&!m&&e[o-1]===e[o]-1){const e=Math.max(u-c,0);kr(n,{outerColor:C,innerColor:f,left:0,bottom:r[o]+1+e,width:h,height:g,radius:[u,0,0,0]})}if(o<t.length-1){const i=t[o+1];Se.WholeSelectionHeadersStylesSet.has(i.StyleID||0)||e[o+1]!==e[o]+1||kr(n,{outerColor:C,innerColor:f,left:0,bottom:r[o+1]+c-1,width:h,height:g,radius:[0,0,0,u]}),m=!0}}else l&&(0===o&&(null==a?void 0:a.IsLastCellOfPrevBlockFullySelected)&&!(null==s?void 0:s.IsLastRowOfPrevBlockHidden)?qr(n,h,g,0,r,o,c,u,C,f):o===t.length-1&&(null==a?void 0:a.IsFirstCellOfNextBlockFullySelected)&&!(null==s?void 0:s.IsFirstRowOfNextBlockHidden)&&$r(n,h,g,0,r,o,c,u,C,f)),m=!1}n.stroke()}(t.RowNumbers,t.Cells,e,n,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,t.BlockWidth*a,h,c,u)):(function(e,t,n,o,r,i,l){const a=l.length,s=o[o.length-1];e.beginPath(),e.strokeStyle=_r(t);for(let t=0;t<a;++t){const o=l[t];if(0===o)continue;const a=zr(n[o],r,i);ur(e,a,0,a,s)}e.stroke()}(e,n,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,l,d,i),function(e,t,n,o,r,i,l,a,s,d){if(0===t.length)return;const c=o.scaleFactor,u=Ne*c,h=2*c,g=Math.max(u,h),f=i-Ar(c,l),C=i,[m,p]=[Se.WholeRowColSelectionBackgroundColor,Se.WholeRowColSelectionBackgroundColor];let y=!1;for(let o=0;o<t.length;o++){const i=t[o];if(Se.WholeSelectionHeadersStylesSet.has(i.StyleID||0)){if(a){if((0===o&&!(null==s?void 0:s.IsLastCellOfPrevBlockFullySelected)&&!(null==d?void 0:d.IsLastColOfPrevBlockHidden)||o>0&&!y&&e[o-1]===e[o]-1)&&Ur(n,g,f,C,r,o,u,h,p,m),o<t.length-1){const i=t[o+1];Se.WholeSelectionHeadersStylesSet.has(i.StyleID||0)||e[o+1]!==e[o]+1||jr(n,g,f,C,r,o,u,h,p,m)}else o!==t.length-1||(null==s?void 0:s.IsFirstCellOfNextBlockFullySelected)||(null==d?void 0:d.IsFirstColOfNextBlockHidden)||jr(n,g,f,C,r,o,u,h,p,m);y=!0}else if(o>0&&!y&&e[o-1]===e[o]-1&&kr(n,{outerColor:p,innerColor:m,left:r[o]-u,bottom:C,width:g,height:f,radius:[h,0,0,0]}),o<t.length-1){const i=t[o+1];if(!Se.WholeSelectionHeadersStylesSet.has(i.StyleID||0)&&e[o+1]===e[o]+1){const e=Math.max(h-u,0);kr(n,{outerColor:p,innerColor:m,left:r[o+1]-Ne-e,bottom:C,width:g,height:f,radius:[0,h,0,0]})}y=!0}}else a&&(0===o&&(null==s?void 0:s.IsLastCellOfPrevBlockFullySelected)&&!(null==d?void 0:d.IsLastColOfPrevBlockHidden)?Ur(n,g,f,C,r,o,u,h,p,m):o===t.length-1&&(null==s?void 0:s.IsFirstCellOfNextBlockFullySelected)&&!(null==d?void 0:d.IsFirstColOfNextBlockHidden)&&jr(n,g,f,C,r,o,u,h,p,m)),y=!1}n.stroke()}(t.ColumnNumbers,t.Cells,e,n,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.BlockHeight*a,o,h,c,u))}(this.ctx,t,n,f))),f&&(l||this.setTransform(1,t.IsRtl,u,c,s),zi(Gi.ClearColumnHeaderGutterAreaDurationMs,(()=>function(e,t,n,o,r,i){if(en(e,"ctx","clearColumnHeaderGutterArea"),en(t,"model","clearColumnHeaderGutterArea"),en(n,"context","clearColumnHeaderGutterArea"),en(t.IsRow,"model.IsRow","clearColumnHeaderGutterArea"),t.IsRow)return;const l=n.viewMode===Se.ViewMode.NamedSheetView&&br(t,!1);e.fillStyle=r?Vn(i.BackgroundColor):l?Se.NSVHeaderBackgroundColor:Se.DefaultHeaderBackgroundColor,e.fillRect(0,Hr(t.RowOffsets[t.RowOffsets.length-1],o),t.BlockWidth*o,Ar(o,!0))}(this.ctx,t,n,a,r,i)))),g&&(l||this.setTransform(1,t.IsRtl,u,c,s),zi(Gi.DrawRowColDragAndDropSixSquaresDurationMs,(()=>function(e,t,n){en(e,"ctx","drawRowColDragAndDropSixSquares"),en(t,"model","drawRowColDragAndDropSixSquares"),en(n,"context","drawRowColDragAndDropSixSquares"),en(t.IsRow,"model.IsRow","drawRowColDragAndDropSixSquares");const o=t.ClientOnlyCache.CellsToRender;for(const l of o){if(!VC(t,n,l,Se.DirtyHeaderCellArea.GutterArea))continue;if(!l.IsHovered)continue;if(!vi())return;const o=n.scaleFactor;let a,s=[];const d=Hr(yw,o),c=Hr(Sw,o),u=vw(t,l,o,d,c);if(t.IsRow){var r;if(Zl(t,l)<=u.height)continue;a=Pn(n)?pr(l,n.highContrastScheme):(null===(r=Fn(l,t))||void 0===r?void 0:r.Color)||Se.HoverFontColor,s=Kw(u,2,Rw,d+c)}else{if(Jl(t,l)<=u.width)continue;var i;a=Pn(n)?Vn(n.highContrastScheme.TextColor):n.viewMode===Se.ViewMode.NamedSheetView&&br(t,!1)?(null===(i=Fn(l,t))||void 0===i?void 0:i.Color)||Se.HoverFontColor:Dr(l)?Se.WholeRowColSelectionBackgroundColor:Se.HoverFontColor,s=Kw(u,Rw,2,d+c)}e.fillStyle=a;for(const t of s)e.fillRect(t.x,t.y,d,d)}}(this.ctx,t,n)))),this.setTransform(n.scaleFactor,!1,u,c,s),zi(Gi.DrawTextDurationMs,(()=>_C(this.ctx,t,n))),(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.DataCleansingColumnHeaders",!1)&&(this.setTransform(1,!1,u+2,c,s),zi(Gi.DrawDataCleansingHeaderIcon,(()=>function(e,t,n){if(!(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.DataCleansingColumnHeaders",!1)||!(0,Se.isPassRibbonCommandsToCanvasRendererEnabled)()&&!t.RibbonCommands)return;en(e,"ctx","drawDataCleansingHeaderIcon"),en(t,"model","drawDataCleansingHeaderIcon"),en(n,"context","drawDataCleansingHeaderIcon");const o=t.ClientOnlyCache.CellsToRender,r=Yo();let i=!1;!r&&o.length>0&&(e.lineWidth=Mr,e.setLineDash(Qe));const l=null!==n.highContrastScheme?n.highContrastScheme:void 0;for(let a=0;a<o.length;a++){const s=o[a];if(!VC(t,n,s,Se.DirtyGridCellArea.EntireCell))continue;const d=rb(t,s,n.scaleFactor,l);ob(s,n,d)&&(r&&!i&&(e.lineWidth=Mr,e.setLineDash(Qe),i=!0),tb(e,t,s,d),nb(t,s,n,ib(d)))}}(this.ctx,t,n)))),this.setTransform(1,t.IsRtl,u,c,s),zi(Gi.DrawHiddenRowColDurationMs,(()=>function(e,t,n,o,r){if(function(e){en(e.ColumnNumbers,"model.ColumnNumbers","drawHiddenRowCol"),en(e.RowNumbers,"model.RowNumbers","drawHiddenRowCol")}(t),n.scaleFactor<Pe)return;const i=t.IsRow,{isLastRowColOfPrevBlockHidden:l,isFirstRowColOfNextBlockHidden:a}=function(e,t){let n=!1,o=!1;return e.AdjacentBlocksHiddensInfo?(t?(n=!!e.AdjacentBlocksHiddensInfo.IsLastRowOfPrevBlockHidden,o=!!e.AdjacentBlocksHiddensInfo.IsFirstRowOfNextBlockHidden):(n=!!e.AdjacentBlocksHiddensInfo.IsLastColOfPrevBlockHidden,o=!!e.AdjacentBlocksHiddensInfo.IsFirstColOfNextBlockHidden),{isLastRowColOfPrevBlockHidden:n,isFirstRowColOfNextBlockHidden:o}):{isLastRowColOfPrevBlockHidden:!1,isFirstRowColOfNextBlockHidden:!1}}(t,i),s=br(t,i),d=t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,c=t.ClientOnlyCache.RowOffsetsAdjustedForDrawing;if(i){const r=rr(s?1:0,d),i=s?d[1]:0;fw(e,n,!0,t.Cells,c,t.RowNumbers,o&&(0,Se.isChangeGateEnabled)(Se.ChangeGate.HiddenIndicatorZoomFixEnabled)?gw(r,!0):r,hw(n,o),gw(r,o),Se.DefaultHiddenRowColInnerGapPx,n.renderingRegion.startRow,n.renderingRegion.endRow,l,a,i,o)}else{const i=Br(n.scaleFactor,r),u=ir(s?1:0,c)-i,h=s?c[1]:0,g=o&&(0,Se.isChangeGateEnabled)(Se.ChangeGate.HiddenIndicatorZoomFixEnabled)?h+i-Le:h+i;fw(e,n,!1,t.Cells,d,t.ColumnNumbers,hw(n,o),o&&(0,Se.isChangeGateEnabled)(Se.ChangeGate.HiddenIndicatorZoomFixEnabled)?gw(u,!0):u,Se.DefaultHiddenRowColInnerGapPx,gw(u,o),n.renderingRegion.startColumn,n.renderingRegion.endColumn,l,a,g,o)}}(this.ctx,t,n,this.isUnhideRowColumnUXImprovementsSlice1Enabled(),f))),(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.RenderResizePill,t)&&(l||this.setTransform(1,t.IsRtl,u,c,s),zi(Gi.DrawResizePillDurationMs,(()=>function(e,t,n,o){en(e,"ctx","drawResizePill"),en(t,"model","drawResizePill"),en(n,"context","drawResizePill");const r=t.ClientOnlyCache.CellsToRender;let i=!1;void 0===jR&&(jR=(0,Se.isRenderResizePillAcrossBlockEnabled)());for(const l of r){if(jR?Bt(l.ResizePillLocation):!l.ShowResizePill)continue;if((0,Se.isPartialHeaderCellRenderingEnabled)()&&(jR?!VC(t,n,l,l.ResizePillLocation===Se.LocationInCell.CellStart?Se.DirtyHeaderCellArea.CellStartGridlineArea:Se.DirtyHeaderCellArea.CellEndGridlineArea):!VC(t,n,l,Se.DirtyHeaderCellArea.CellEndGridlineArea)))continue;if(i){if(void 0===qR&&(qR=(0,Se.isChangeGateEnabled)(Se.ChangeGate.LogResizePillRenderingOnMultipleCells)),!qR)throw Error("drawResizePill: Resize pill already drawn on another cell");vr.Hv.shipAssertTag(506577280,Fr.n.msoulscat_ES_EWAJSGrid,!1,"drawResizePill: Resize pill already drawn on another cell")}i=!0;const r=n.highContrastScheme,a=n.scaleFactor,s=XR(r),d=YR(r);if(t.IsRow){const n=KR(t,l,a,jR),o=20*a,r=PR*a;$R(e,a,s,d,n.x,n.y,o,r)}else{const n=JR(t,l,a,o,jR),r=OR*a,i=16*a;$R(e,a,s,d,n.x,n.y,r,i)}}}(this.ctx,t,n,f)))),(0,Se.isHeaderInsertEnabled)()&&(l||this.setTransform(1,t.IsRtl,u,c,s),zi(Gi.DrawInsertDotAndInsertButton,(()=>function(e,t,n){(0,Se.verifyArgumentNotNull)(e,"ctx","drawInsertDotAndInsertButton"),(0,Se.verifyArgumentNotNull)(t,"model","drawInsertDotAndInsertButton"),(0,Se.verifyArgumentNotNull)(n,"context","drawInsertDotAndInsertButton");let o=!1;const r=t.IsRow?t.RowOutlinesInformation:t.ColumnOutlinesInformation;var i;const l=(null!==(i=null==r?void 0:r.length)&&void 0!==i?i:0)>0;o=Jw(e,t,n,Se.InsertButtonType.InsertDot,o,l),Jw(e,t,n,Se.InsertButtonType.InsertButton,o,l)}(this.ctx,t,n)))),(null===(o=t.ClientOnlyCache)||void 0===o?void 0:o.isHeaderSnapped)&&(this.setTransform(1,!1,u,c,s),zi(Gi.DrawAutoFiltersForHeaderSnappingMs,(()=>Dy(this.ctx,t,n))))),m&&cr(this.ctx,m),this.setTransform(1,!1,u,c,s),zi(Gi.DrawOutlines,(()=>function(e,t,n){const o=t.IsRow?t.RowOutlinesInformation:t.ColumnOutlinesInformation;if(!o||0===o.length)return;const r=[];!function(e,t){const n=t.highContrastScheme;n?e.strokeStyle=Vn(n.LinkColor):t.viewMode===Se.ViewMode.NamedSheetView?e.strokeStyle=Se.NSVOutlinesColor:e.strokeStyle=Se.OutlinesColor}(e,n),e.beginPath();const i=t.IsRow,l=i&&t.IsRtl,a=n.scaleFactor;for(let n=0;n<o.length;++n){const s=o[n].Outlines,d=aw(n,a,l,t.BlockWidth),c=d+bt,u=sw(d,i,a),h=s.length;for(let n=0;n<h;++n){const o=s[n],l=o.ButtonIndex,d=l>-1,h=d?cw(t,l):void 0;ow(t,o,h,d,c,a),o.IsExpanded||!d?(rw(t,e,o,a),uw(t,o,e,r,u,d,h),e.stroke()):nw(r,h,o,u,i)}}!function(e,t,n,o){const r=n.highContrastScheme,i=function(e,t){return e?Vn(e.LinkColor):t===Se.ViewMode.NamedSheetView?Se.NSVOutlinesColor:Se.OutlinesColor}(r,n.viewMode),l=function(e,t){return e?Vn(e.BackgroundColor):t===Se.ViewMode.NamedSheetView?Se.NSVHeaderBackgroundColor:Se.DefaultHeaderBackgroundColor}(r,n.viewMode);for(let r=0;r<t.length;++r){const a=t[r],s=hy(n.scaleFactor,ZR),d={outerColor:i,innerColor:l,left:a.EdgeInformation.LeftPx,bottom:a.EdgeInformation.TopPx+s,height:s,width:s};uy(o,e,a.EdgeInformation.Cell,d,a.IsExpand,!1)}}(t,r,n,e)}(this.ctx,t,n))),this.shouldInitializeCanvasHitTest(t,n)&&(l||this.setTransform(1,!1,u,c,s),zi(Gi.RegisterHeaderHitRegionsToModelMs,(()=>function(e,t){const n=e.IsRow,o=br(e,n);if(!e.ShowHeaders&&!o)return;const r=(0,Se.getRenderingRegionHitTestCache)(e,no(t.renderingRegion)),i=e.ClientOnlyCache.CellsToRender;if(0===i.length)return;const l=o?zw(i,n,!0):i,a=Mw(e,l);if(e.ShowHeaders){let o;!function(e,t,n,o,r){let i;lS?i=e.IsRow?e.IsRtl?lS.rowSelectRTLCursor:lS.rowSelectLTRCursor:lS.columnSelectCursor:(vr.Hv.sendTraceTag(508924443,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Warning,"headersHitTest: registerHeaderCellsHitRegionsToModelCache:: gridRendererCustomCursors is undefined. Using default cursor."),i=xg);for(let l=0;l<n.length;l++){const a=n[l],s=_s(e,t,o[l],!1);if(Fa(a,r,s,i,Se.RenderFeaturesZIndex.Headers),Da(a,r,s,Se.RenderFeaturesZIndex.Headers,Gw(e,a,!0)),xa(a,r,s,Se.RenderFeaturesZIndex.Headers,Gw(e,a,!1)),(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.HeaderDragImprovements,e)){const n=Fw(e,a,t.scaleFactor);n&&Pw(e,t,a,n,r)}}}(e,t,l,a,r),o=(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.ResizeHeaderUXModernization,e)?n?"ns-resize":"ew-resize":n?"row-resize":"col-resize",function(e,t,n,o,r,i,l){const a=(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.RenderResizePill,e),s=(0,Se.isRenderResizePillAcrossBlockEnabled)(),d=(0,Se.isIncreasedHeaderSizeEnabled)(e),c=(0,Se.isHeaderInsertEnabled)();for(let C=0;C<n.length;C++){const m=0===C,p=C+1===n.length,y=n[C],S=o[C],R=C,w=xr(e,C,l),b=w-1,I=w+1;let v,F=!1;var u,h;if(v=m?l?!!(null===(u=e.AdjacentBlocksHiddensInfo)||void 0===u?void 0:u.IsLastRowOfPrevBlockHidden):!!(null===(h=e.AdjacentBlocksHiddensInfo)||void 0===h?void 0:h.IsLastColOfPrevBlockHidden):xr(e,C-1,l)!==b,(0,Se.isChangeGateEnabled)(Se.ChangeGate.DismissUnhideSkittleOnResize))if(p){var g,f;F=l?!!(null===(g=e.AdjacentBlocksHiddensInfo)||void 0===g?void 0:g.IsFirstRowOfNextBlockHidden):!!(null===(f=e.AdjacentBlocksHiddensInfo)||void 0===f?void 0:f.IsFirstColOfNextBlockHidden)}else F=xr(e,C+1,l)!==I;const T=v?C:C-1,D=Ow(S,l,e.IsRtl,t.scaleFactor,d,a,c),x=_s(e,t,D.firstResizeZoneHitRegion,!1),A=_s(e,t,D.secondResizeZoneHitRegion,!1);1!==w&&Ew(y,r,x,b,T,i,l,v,!1,-1===T,a&&!v&&(s||!(-1===T)),p),l&&1048576===w||!l&&16384===w||Ew(y,r,A,w,R,i,l,!1,F,!1,a&&(s||!p),p)}}(e,t,l,a,r,o,n),Xw()&&function(e,t,n,o,r,i){let l;for(let u=0;u<n.length;u++){const h=0===u,g=u+1===n.length,f=n[u],C=o[u],m=xr(e,u,i),p=m-1,y=m+1;let S=!1,R=!1;var a,s,d,c;S=h?i?!!(null===(a=e.AdjacentBlocksHiddensInfo)||void 0===a?void 0:a.IsLastRowOfPrevBlockHidden):!!(null===(s=e.AdjacentBlocksHiddensInfo)||void 0===s?void 0:s.IsLastColOfPrevBlockHidden):xr(e,u-1,i)!==p,R=g?i?!!(null===(d=e.AdjacentBlocksHiddensInfo)||void 0===d?void 0:d.IsFirstRowOfNextBlockHidden):!!(null===(c=e.AdjacentBlocksHiddensInfo)||void 0===c?void 0:c.IsFirstColOfNextBlockHidden):xr(e,u+1,i)!==y;const w=S&&R;void 0!==l||i||!S&&!R||(l=Ar(t.scaleFactor,(0,Se.isIncreasedHeaderSizeEnabled)(e))),S&&Lw(f,r,_s(e,t,kw(C,t.scaleFactor,i,e.IsRtl,!0,w,null!=l?l:0),!1),m,i,!0,e.IsRtl),R&&Lw(f,r,_s(e,t,kw(C,t.scaleFactor,i,e.IsRtl,!1,w,null!=l?l:0),!1),m,i,!1,e.IsRtl)}}(e,t,l,a,r,n),(0,Se.isHeaderInsertEnabled)()&&function(e,t,n,o,r,i){const l=t.scaleFactor,a=i?Tt*l:Ar(l,!0),s=l*(i?5:7),d=l*(i?6:8);for(let l=0;l<n.length;l++){const c=n[l],u=xr(e,l,i),{cellStartHitRegion:h,cellEndHitRegion:g}=wR(o[l],i,e.IsRtl,a,s,d);Nw(e,t,c,r,h,u,i,!0),Nw(e,t,c,r,g,u,i,!1)}}(e,t,l,a,r,n)}if(o){const o=zw(i,n,!1),l=Mw(e,o);!function(e,t,n,o){const r=o?e.RowOutlinesInformation:e.ColumnOutlinesInformation;if(r)for(let i=0;i<r.length;i++){const l=r[i].Outlines,a=i+1;for(let r=0;r<l.length;r++){const i=l[r],s=i.ButtonIndex,d=xr(e,s,o)-1;if(-1===s||i.IsButtonHidden){if((0,Se.isChangeGateEnabled)(Se.ChangeGate.GroupRowColBugFix))continue;break}const c=i.Button,u=c.EdgeInformation.Cell,h=i.IsNonDefaultDirection?d+1:d-1,g=!i.IsExpanded,f=hy(t.scaleFactor,ZR),C=c.EdgeInformation.TopPx,m=_s(e,t,{x:c.EdgeInformation.LeftPx,y:C,width:f,height:f},!1);Ta(u,n,m,i.ECTitle,Se.RenderFeaturesZIndex.Headers),Fa(u,n,m,Dg,Se.RenderFeaturesZIndex.Headers,(e=>!0)),va(u,n,m,Se.RenderFeaturesZIndex.Headers,qw(o,a,h,null!=g&&g),Bg)}}}(e,t,r,n),function(e,t,n,o,r){for(let i=0;i<n.length;i++)va(n[i],r,_s(e,t,o[i],!1),Se.RenderFeaturesZIndex.Headers,(e=>!0),Ig)}(e,t,o,l,r)}}(t,n)))),h&&this.ctx.restore(),n.debugMode&&(this.setTransform(a,!1,0,0,0),n.isCanvasHitTestDebugHighlight&&Ma(t,this.ctx,n.renderingRegion)),Ni(!0,"finished rendering.")}catch(e){return Ni(!1,`exception caught in renderInternal: message: ${e.message} name: ${e.name} stack: ${e.stack} error: ${e}`)}}preprocessModel(e,t,n){GS(e,t,this.shouldInitializeCanvasHitTest(e,n)),Rr(e,n.scaleFactor)}shouldInitializeCanvasHitTest(e,t){return(0,Se.isPartialHeaderCellRenderingEnabled)()?!t.isDifferentialRendering:!(0,Se.isDifferentialRenderingSupported)(e)}clearHeaderCanvas(e,t,n){zi(Gi.FillRectDurationMs,(()=>{this.ctx.fillStyle=this.getCanvasBackgroundColor(n),this.ctx.fillRect(0,0,e,t)}))}getCanvasBackgroundColor(e){return Pn(e)?Vn(e.highContrastScheme.BackgroundColor):e.viewMode===Se.ViewMode.NamedSheetView?Se.NSVHeaderBackgroundColor:Se.DefaultHeaderBackgroundColor}isUnhideRowColumnUXImprovementsSlice1Enabled(){return void 0===this.unhideRowColumnUXImprovementsSlice1&&(this.unhideRowColumnUXImprovementsSlice1=(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.UnhideRowColumnUXImprovementsSlice1",!1)),this.unhideRowColumnUXImprovementsSlice1}constructor(){super(...arguments),this.unhideRowColumnUXImprovementsSlice1=void 0}}class cb{getModelAccessor(e){return en(e,"model","CanvasRendererFactory.getModelAccessor"),new qS(e)}getGridCanvasRenderer(){return new US}getHeaderCanvasRenderer(){return new db}createRenderingCanvasElement(e){return new nR(!((0,Se.isChangeGateEnabled)(Se.ChangeGate.FixBoldFontsOnMac)&&Ho()||(!window||!window.navigator||navigator.userAgent.indexOf("Edge/")>=0||!(navigator.userAgent.indexOf("Chrome/")>=0))&&(!window||!window.navigator||!(navigator.userAgent.indexOf(" Firefox/")>=0))),!!e)}createHeaderBlockModelAccessor(e,t,n){en(e,"gridModel","CanvasRendererFactory.createHeaderBlockModelAccessor"),en(n,"viewMode","CanvasRendererFactory.createHeaderBlockModelAccessor");const o=(0,Se.createHeaderBlockModel)(e,t,n);return new MR(o,t)}}const ub=new cb,hb="msofp",gb=["Aptos Narrow","aptos narrow","Calibri","calibri"],fb=(0,Se.isChangeGateEnabled)(Se.ChangeGate.IncreaseFontLoadTimeout)?yi(8,10):yi(8,7),Cb=(0,Se.isChangeGateEnabled)(Se.ChangeGate.IncreaseFontLoadTimeout)?yi(6,500):yi(6,100),mb=(0,Se.isChangeGateEnabled)(Se.ChangeGate.IncreaseFontLoadTimeout)?yi(7,5e3):yi(7,3e3),pb=(0,Se.isChangeGateEnabled)(Se.ChangeGate.RemoveRefCountCheckForFontLoad),yb=document.createElement("div"),Sb=[];let Rb,wb;yb.innerText=".",yb.style.visibility="hidden",(null===(t=document)||void 0===t?void 0:t.body)&&document.body.appendChild(yb);let bb=!1,Ib=0;function vb(e){const t=new Set,n=new Set,o=[];if(e.Fonts)for(let r=0;r<e.Fonts.length;r++){const i=e.Fonts[r];if(!i)continue;const l=i.FontName;if(!l)continue;const a=tl(l);if(Fb()&&n.add(a),!t.has(l)){if(eo()&&hl(a)&&!os(a)){const e=ls(a);rs(a),Fb()&&e&&o.push(a)}!(pb||(i.RefCount||0)>0)||ns(a,!1)&&es(a,!1)!==Oa.Pending||t.add(l)}}if(n.size>0){const e=Array.from(n.values());1===e.length&&gb.includes(e[0])||2===e.length&&gb.includes(e[0])&&gb.includes(e[1])||Ab(2,e)}o.length>0&&Ab(3,o),function(e){if(!ns(It)||es(It)===Oa.Pending){var t;const n=null===(t=e.ClientOnlyCache)||void 0===t?void 0:t.CellsToRender;if(n)for(let t=0;t<n.length;t++){const o=n[t],r=!!(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.InCellControls,e)&&o.InCellControlOptions&&o.InCellControlOptions.Type===Se.InCellControlType.Checkbox&&OC(o);if(o.RichValueIcon||r)return!0}}return!1}(e)&&t.add(It);const r=Array.from(t.values());return Fb()&&r.length>0&&Ab(4,r),r}function Fb(){return void 0===wb&&(wb=Kn()&&(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.FontRenderingTelemetry",!1)),!(!wb||bb)}function Tb(e){return new Promise((t=>{setTimeout((()=>Db(e,fb,t)),Cb)}))}function Db(e,t,n){const o=fb-t+1;switch(Ya(e)){case"loaded":vr.Hv.sendTraceTag(542722120,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`FontLoader::handleFontIsStillLoading: ${cl(e)} was loaded successfully after ${o} retries.`),n({font:e,isSuccessful:!0});break;case"loading":if(t>1){const o=function(e){const t=1<<fb-e+1;return Math.min(t*Cb,mb)}(t);setTimeout(Db,o,e,t-1,n)}else vr.Hv.sendTraceTag(542722121,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`FontLoader::handleFontIsStillLoading: ${cl(e)} failed to load after ${o} retries.`),n({font:e,isSuccessful:!1});break;default:n({font:e,isSuccessful:!1})}}function xb(e){qa(yb,e),ts(e,Oa.Pending),Fb()&&Ab(9,[e])}function Ab(e,t){Sb.push({stage:e,data:t,seq:++Ib})}function Bb(e){return!ns(e)&&!Xa(e,Oa.Loaded)}function Hb(){const e=document.createElement("div");return e.style.visibility="hidden",e.innerText=".",e}function Mb(){return Date.now()}function Pb(e,t){var n,o,r,i;return t.CachedStyle||(0,Se.getCellStyle)(e,t),t.TextRuns||t.Spill||t.Merge||t.DisplayFormula||t.PreviewText||(null===(n=t.CachedStyle)||void 0===n?void 0:n.VerticalText)||t.WrapText||Nl(t)||(null===(o=t.CachedStyle)||void 0===o?void 0:o.HorizontalAlignment)===Se.HorizontalAlignment.Fill||(null===(r=t.CachedStyle)||void 0===r?void 0:r.ShrinkToFit)||((null===(i=t.CachedStyle)||void 0===i?void 0:i.Indentation)||0)>0}const Ob=["keypress","keydown","click","contextmenu","dblclick","mousemove","scroll","touchmove","touchstart"];class kb{onMouseEntersFrame(){this.onEnterFrame(),this.userMouseIsInFrame=!0}onTimerTick(){this.userReportedActive=!1,1===this.activityReportMode&&this.userIsActive||this.userMouseIsInFrame&&this.isPageVisible()?this.reportActivity():this.onReportUserIsIdle()}reportActivity(){this.onReportUserIsActive(),this.userReportedActive=!0,this.userIsActive=!1}overrideDefaultsWithOptions(e){this.activityReportInSec=e.activityReportInSec||this.activityReportInSec,this.activityReportMode=e.activityReportMode||this.activityReportMode,this.detectFramesInSec=e.detectFramesInSec||this.detectFramesInSec,this.onActivity=e.onActivity||this.onActivity,this.onEnterFrame=e.onEnterFrame||this.onEnterFrame,this.onReportUserIsActive=e.onReportUserIsActive||this.onReportUserIsActive,this.onReportUserIsIdle=e.onReportUserIsIdle||this.onReportUserIsIdle}isPageVisible(){return"hidden"!==document.visibilityState}constructor(e){this.userReportedActive=!1,this.userIsActive=!1,this.userMouseIsInFrame=!1,this.attachedFrames=[],this.activityReportMode=1,this.activityReportInSec=5,this.detectFramesInSec=-1,this.onActivity=()=>{},this.onEnterFrame=()=>{},this.onReportUserIsActive=()=>{},this.onReportUserIsIdle=()=>{},this.attachListenerToNewFrames=()=>{const e=Array.prototype.slice.call(window.document.getElementsByTagName("frame")),t=Array.prototype.slice.call(window.document.getElementsByTagName("iframe")),n=e.concat(t);for(const e of n)this.attachedFrames.indexOf(e)<0&&(e.addEventListener("mouseenter",this.onMouseEntersFrame.bind(this),this,!1),this.attachedFrames.push(e),this.userMouseIsInFrame=!0)},this.onUserActivity=()=>{this.onActivity(),this.userIsActive=!0,2!==this.activityReportMode||this.userReportedActive||this.reportActivity(),this.userMouseIsInFrame=!1},this.overrideDefaultsWithOptions(e),Ob.forEach((e=>{window.addEventListener(e,this.onUserActivity,!0)})),e.scheduleByDefault&&(setInterval(this.onTimerTick.bind(this),1e3*this.activityReportInSec),this.detectFramesInSec>0&&setInterval(this.attachListenerToNewFrames,1e3*this.detectFramesInSec)),this.reportActivity()}}class Eb extends kb{startTrackingIfApplicable(){this.isScheduled||(this.isScheduled=!0,this.lastActiveTime=Mb(),setTimeout(this.onTimerTick.bind(this),1e3*this.activityReportInSec))}stopTracking(){this.isScheduled=!1}onTimerTick(){super.onTimerTick();const e=Mb()-this.lastActiveTime;this.isScheduled&&e<this.maxTimeAfterIdle?setTimeout(this.onTimerTick.bind(this),1e3*this.activityReportInSec):this.isScheduled=!1}reportActivity(){super.reportActivity(),this.lastActiveTime=Mb()}constructor(e,t){super(e),this.isScheduled=!1,this.maxTimeAfterIdle=t,this.lastActiveTime=Mb()}}const Lb=[];let Nb,zb,Gb,Wb={},Vb=Mb(),_b=!1;function Ub(){const e=Mb();for(;Mb()-e<Nb&&Lb.length>0&&!(navigator.scheduling&&navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending());){const e=Math.floor(Math.random()*Lb.length),t=Lb[e],n=Mb();if(t.canCollectorExecute())try{const e=t.collect();e.isValid&&Wb[t.getCollectorName()].push(e.value);const o=Mb()-n;o>Nb&&(vr.Hv.sendTraceTag(572602177,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`Name: ${t.getCollectorName()} is disabled because it exceeded execution threshold.\n            Threshold: ${Nb}, TimeTaken: ${o}`),t.disable())}catch(e){vr.Hv.sendTraceTag(572602178,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`Name: ${t.getCollectorName()}, Exception encountered in collector, Collector will be disabled. Exception - ${e}`),t.disable()}Lb.splice(e,1)}Lb.length<1&&Gb.stopTracking(),Mb()-Vb>zb&&setTimeout(jb,0)}function jb(){if(Wb){const e=Object.keys(Wb);for(let t=0;t<e.length;t++){const n=e[t],o=Wb[n];o&&o.length>0&&vr.Hv.sendTraceTag(572602179,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,JSON.stringify({Name:n,Results:o}))}}Wb={},Vb=Mb()}const qb="Insufficient Data",$b="Collector Disabled";class Xb{canCollectorExecute(){return!this.isDisabled&&!!this.data}getCollectorName(){return this.name}disable(){this.isDisabled=!0}register(e){this.data.push(e),function(e){Lb.length<100&&Lb.push(e);const t=e.getCollectorName();Wb[t]||(Wb[t]=[]),_b&&Gb.startTrackingIfApplicable()}(this)}constructor(e){this.isDisabled=!1,this.name=e,this.data=[]}}let Yb,Kb,Jb,Zb,Qb;class eI extends Xb{collect(){if(!this.canCollectorExecute())return{isValid:!1,value:$b};const e=this.data.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:qb};for(let n=0;n<e.Cells.length;n++){const o=e.Cells[n];o.Text&&!Pb(e,o)&&t.push(o)}if(t.length<1)return{isValid:!1,value:qb};const n=t[Math.floor(Math.random()*t.length)];n.CachedDisplayText||(n.CachedDisplayText=kn(n,e));const o=void 0,r=Kh(o,e.IsRtl);Jh(this.canvasContext,r,n,e,o);const i=Si(),l=Ri(),a=ar(jl(e,n,!0),Mc(n,e,i,l),su(e,n,i,l),vd(n),0),s=Yc(this.canvasContext,e,n);return{isValid:!0,value:{isCompressed:s>a,textWidth:s,maxWidth:a,len:n.CachedDisplayText.length,font:{name:cl(n.CachedFont.FontName),size:n.CachedFont.Size,italic:!!n.CachedFont.Italic,bold:!!n.CachedFont.Bold}}}}constructor(e){super("CompressedTextCollector"),this.canvasContext=e}}class tI extends Xb{collect(){if(!this.canCollectorExecute())return{isValid:!1,value:$b};const e=this.data.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:qb};for(let n=0;n<e.Cells.length;n++){const o=e.Cells[n];o.Text&&o.Spill&&t.push(o)}if(t.length<1)return{isValid:!1,value:qb};const n=t[Math.floor(Math.random()*t.length)],o=JSON.parse(JSON.stringify(n));return SS(this.canvasContext,e,o,Si(),Ri()),{isValid:!0,value:{isEqual:(0,Se.areGridCellsEqual)(n,o,e,e).isEqual,font:{name:cl(n.CachedFont.FontName),italic:!!n.CachedFont.Italic,bold:!!n.CachedFont.Bold}}}}constructor(e){super("SpillCellCollector"),this.canvasContext=e}}class nI extends Xb{collect(){if(!this.canCollectorExecute())return{isValid:!1,value:$b};const e=this.data.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:qb};for(let n=0;n<e.Cells.length;n++){const o=e.Cells[n];o.Text&&!Pb(e,o)&&oI(o)&&t.push(o)}if(t.length<1)return{isValid:!1,value:qb};const n=t[Math.floor(Math.random()*t.length)];n.CachedDisplayText||(n.CachedDisplayText=kn(n,e));const o=void 0,r=Kh(o,e.IsRtl);Jh(this.canvasContext,r,n,e,o);const i=Si(),l=Ri(),a=ar(n.SrvDx||0,Pc(e,n),su(e,n,i,l),vd(n),gd(e,n,i,l)),s=Yc(this.canvasContext,e,n);return{isValid:!0,value:{tooWide:s>a,tooNarrow:a>s+this.canvasContext.measureText(" ").width,textWidth:s,maxWidth:a,len:n.CachedDisplayText.length,font:{name:cl(n.CachedFont.FontName),size:n.CachedFont.Size,italic:!!n.CachedFont.Italic,bold:!!n.CachedFont.Bold}}}}constructor(e){super("AutoFitWidthCollector"),this.canvasContext=e}}function oI(e){return!!e.SrvDx}class rI extends Xb{collect(){if(!this.canCollectorExecute())return{isValid:!1,value:$b};const e=this.data.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:qb};for(let n=0;n<e.Cells.length;n++){const o=e.Cells[n];o.Text&&o.WrapText&&iI(o)&&t.push(o)}if(t.length<1)return{isValid:!1,value:qb};const n=t[Math.floor(Math.random()*t.length)],o=void 0,r=Kh(o,e.IsRtl);Jh(this.canvasContext,r,n,e,o);const i=Yc(this.canvasContext,e,n),l=ou(n,e),a=On(n.CachedDisplayText,n,e),s=Rh(this.canvasContext,n.CachedDisplayText,i,Fu.Wrap,this.canvasContext.measureText(" ").width,e,n,a,n.WrapText),d=s.textLines.length*l,c=n.SrvDy||0;return{isValid:!0,value:{tooLong:d>c,tooShort:c-d>l,textHeight:d,SrvDy:c,numLines:s.textLines.length,isRichText:!!a,font:{name:cl(n.CachedFont.FontName),size:n.CachedFont.Size,italic:!!n.CachedFont.Italic,bold:!!n.CachedFont.Bold}}}}constructor(e){super("AutoFitHeightCollector"),this.canvasContext=e}}function iI(e){return!!e.SrvDy}class lI extends Xb{collect(){if(!this.canCollectorExecute())return{isValid:!1,value:$b};const e=this.data.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:qb};for(let n=0;n<e.Cells.length;n++){const o=e.Cells[n];o.Text&&dI(o)&&t.push(o)}if(t.length<1)return{isValid:!1,value:qb};let n=0;const o={};for(let r=0;r<t.length;r++){const i=t[r],l=i.CachedDisplayText||kn(i,e),a=i.Text,s=aI(l);if(s!==aI(a)&&s&&(n++,i.CachedFont)){const e=sI(i.CachedFont);o[e]||(o[e]=0),o[e]+=1}}return{isValid:!0,value:{updatedCells:n,totalCells:t.length,fontWise:o}}}constructor(){super("CellHashDisplayCollector")}}function aI(e){for(let t=0;t<e.length;t++)if("#"!==e[t])return!1;return!0}function sI(e){const t=cl(e.FontName),n=e.Size;return`${yl(e.Bold||!1,e.Italic||!1)} ${t} ${n}pt`}function dI(e){return e.ValueType===Se.CellValueType.Number}var cI;!function(e){e[e.ThickBorder=0]="ThickBorder",e[e.MediumBorder=1]="MediumBorder",e[e.BoldText=2]="BoldText",e[e.CustomFont=3]="CustomFont",e[e.CellHashText=4]="CellHashText",e[e.CellTextOrientation=5]="CellTextOrientation",e[e.AccountingUnderline=6]="AccountingUnderline",e[e.SubScriptSuperScriptInWrapText=7]="SubScriptSuperScriptInWrapText",e[e.PatternStyle=8]="PatternStyle",e[e.DiagonalBorder=9]="DiagonalBorder",e[e.SpillCellAcrossBlocks=10]="SpillCellAcrossBlocks"}(cI||(cI={}));const uI="MissingFeatureWithoutFallback",hI="MissingFeatureWithFallback",gI="LowRenderingFeature",fI={};function CI(e,t){const n=t.CachedBorderStyle;if(n)for(let t=0;t<n.Borders.length;t++){const o=n.Borders[t];2===o.Weight?wI(e,cI.MediumBorder):3===o.Weight&&wI(e,cI.ThickBorder)}}function mI(e,t,n){const o=n.CachedStyle,r=n.CachedFont;o&&r&&o.Orientation&&(Al(t,n.CachedStyle,n.CachedFont)||wI(e,cI.CellTextOrientation))}function pI(e,t){if(!t.Text)return;const n=t.CachedDisplayTextRuns;if(n){for(let t=0;t<n.length;t++)if(n[t].CachedFont&&!gl(n[t].CachedFont.FontName)){wI(e,cI.CustomFont);break}}else t.CachedFont&&!gl(t.CachedFont.FontName)&&wI(e,cI.CustomFont)}function yI(e,t){const n=t.CachedFont;n&&(n.Underline!==Se.FontUnderline.SingleAccounting&&n.Underline!==Se.FontUnderline.DoubleAccounting||wI(e,cI.AccountingUnderline))}function SI(e,t){const n=t.CachedBorderStyle;n&&n.HasDiagBorder&&wI(e,cI.DiagonalBorder)}function RI(e,t){const n=t.CachedDisplayTextRuns;if(t.WrapText&&n)for(let t=0;t<n.length;t++){const o=n[t].CachedFont;if(o&&(o.VerticalAlign===Se.FontVerticalAlignment.Subscript||o.VerticalAlign===Se.FontVerticalAlignment.Superscript))return void wI(e,cI.SubScriptSuperScriptInWrapText)}}function wI(e,t){const n=cI[t];e[n]?e[n]+=1:e[n]=1}let bI,II,vI,FI;fI[cI[cI.AccountingUnderline]]={value:5,errorType:hI,veto:"ContentFallback"},fI[cI[cI.BoldText]]={value:25,errorType:gI,veto:"ContentRenderedIncorrectly"},fI[cI[cI.CellHashText]]={value:5,errorType:hI,veto:"ContentFallback"},fI[cI[cI.CellTextOrientation]]={value:5,errorType:hI,veto:"ContentFallback"},fI[cI[cI.CustomFont]]={value:5,errorType:hI,veto:"MissingFont"},fI[cI[cI.DiagonalBorder]]={value:1,errorType:uI,veto:"ContentRenderFailed"},fI[cI[cI.MediumBorder]]={value:25,errorType:gI,veto:"ContentRenderedIncorrectly"},fI[cI[cI.PatternStyle]]={value:1,errorType:uI,veto:"ContentRenderFailed"},fI[cI[cI.SpillCellAcrossBlocks]]={value:5,errorType:hI,veto:"ContentFallback"},fI[cI[cI.SubScriptSuperScriptInWrapText]]={value:25,errorType:gI,veto:"ContentRenderedIncorrectly"},fI[cI[cI.ThickBorder]]={value:25,errorType:gI,veto:"ContentRenderedIncorrectly"};class TI extends Xb{collect(){var e,t,n;if(!this.canCollectorExecute())return{isValid:!1,value:$b};const o=null===(e=performance.memory)||void 0===e?void 0:e.usedJSHeapSize,r=null===(t=performance.memory)||void 0===t?void 0:t.totalJSHeapSize,i=null===(n=performance.memory)||void 0===n?void 0:n.jsHeapSizeLimit,l=navigator.deviceMemory||-1,a=document.getElementsByTagName("*").length,s=di.blockCacheSizeCallback();let d=0;const c=document.getElementsByTagName("canvas");for(let e=0;e<c.length;e++){const t=c.item(e);t&&(d+=t.clientHeight*t.clientWidth)}return{isValid:!0,value:{usedJSHeapSize:o,totalJSHeapSize:r,jsHeapSizeLimit:i,deviceMemory:l,numOfDomElements:a,numOfCanvas:c.length,numOfGridCanvas:document.getElementsByClassName("ewr-sheettable").length,blockCacheSize:s,computedSizeOfCanvas:d}}}constructor(){super("AppMemoryInfoCollector")}}class DI extends Xb{collect(){return this.canCollectorExecute()?{isValid:!0,value:di.getBlockStatisticLog()}:{isValid:!1,value:$b}}constructor(){super("blockStatisticsLogCollector")}}class xI extends Xb{collect(){var e;if(!this.canCollectorExecute())return{isValid:!1,value:$b};const t=this.data.pop(),n=JSON.stringify(t),o=performance.now(),r=JSON.parse(n),i=JSON.parse(n),l=performance.now(),a=r.Cells,s=a[Math.floor(Math.random()*a.length)].Col,d=[],c=new Map,u=[],h=new Map,g=[],f=new Map,C=[],m=i.Styles.length,p=i.BorderStyles.length,y=i.Fonts.length;for(let e=0;e<a.length;e++){const t=a[e];if(t.Col!==s)continue;const n=MI(t);n.Col=0,d.push(n);const o=n.StyleID||0;if(c.has(o))n.StyleID=c.get(o);else{const e=AI(o,r,m,c),t=e.FontID||0;if(f.has(t))e.FontID=f.get(t);else{const n=HI(t,r,y,f);n.ID=y+n.Size,C.push(n),e.FontID=n.ID,f.set(t,n.ID)}e.ID=m+c.size,c.set(o,e.ID),u.push(e),n.StyleID=e.ID}const i=n.BorderStyleID||0;if(h.has(i))n.BorderStyleID=h.get(i);else{const e=BI(i,r,p,h);e.ID=p+c.size,h.set(o,e.ID),g.push(e),n.BorderStyleID=e.ID}}const S=performance.now();!function(e,t){e.ColMetadata.unshift(t.ColMetadata.shift()),e.ColumnNumbers.unshift(t.ColumnNumbers.shift()),e.ColumnOffsets.unshift(t.ColumnOffsets.shift()),e.ColumnWidths.unshift(t.ColumnWidths.shift())}(i,r);const R=performance.now();!function(e,t,n,o){var r,i,l;null===(r=e.Styles)||void 0===r||r.push(...t),null===(i=e.Fonts)||void 0===i||i.push(...n),null===(l=e.BorderStyles)||void 0===l||l.push(...o)}(i,u,C,g);const w=performance.now();null===(e=i.Cells)||void 0===e||e.push(...d);const b=performance.now(),I=(b-o).toFixed(2),v=(l-o).toFixed(2),F=(S-l).toFixed(2),T=(R-S).toFixed(2),D=(w-R).toFixed(2),x=(b-w).toFixed(2),A=(b-l).toFixed(2);return{isValid:!0,value:{numOfCellsCopied:d.length,numOfStylesCopied:u.length,numOfBorderStylesCopied:g.length,numOfFontsCopied:C.length,totalTime:I,totalTimeWithoutPreprocess:A,preparePhaseTime:F,preprocessTime:v,columnShiftTime:T,styleShiftTime:D,cellShiftTime:x}}}constructor(){super("ModelCascadeTimeCollector")}}function AI(e,t,n,o){return oo(t,(0,Se.getReferencedObjectById)(e,t.Styles),n+o.size,1)}function BI(e,t,n,o){return io((0,Se.getReferencedObjectById)(e,t.BorderStyles),n+o.size,1)}function HI(e,t,n,o){return lo((0,Se.getReferencedObjectById)(e,t.Fonts),n+o.size,1)}function MI(e){const t=e.Spill?{SpanToEnd:e.Spill.SpanToEnd,IsSpillBlocked:e.Spill.IsSpillBlocked,IsSpillingOutsideOfBlock:e.Spill.IsSpillingOutsideOfBlock,SpanToStart:e.Spill.SpanToStart}:void 0;return{Col:e.Col,Row:e.Row,Text:e.Text,StyleID:e.StyleID||0,Ifmt:e.Ifmt||0,IfmtStamped:e.IfmtStamped||0,BorderStyleID:e.BorderStyleID||0,HorizontalAlignmentSet:e.HorizontalAlignmentSet,ValueType:e.ValueType,HasIgnorableError:e.HasIgnorableError,TableColHeader:e.TableColHeader,TableRowHeader:e.TableRowHeader,SrvDx:e.SrvDx||0,SrvDy:e.SrvDy||0,TolType:e.TolType||0,Spill:t}}class PI extends Xb{collect(){var e,t,n,o;if(!this.canCollectorExecute())return{isValid:!1,value:$b};const r=new TextEncoder,i=this.data.pop(),l=r.encode(JSON.stringify(i)).length,a=r.encode(JSON.stringify(i.Cells)).length,s=r.encode(JSON.stringify(i.Styles)).length,d=r.encode(JSON.stringify(i.Fonts)).length,c=r.encode(JSON.stringify(i.BorderStyles)).length,u=s+c+d;return{isValid:!0,value:{sizePercentageForModel:u/l*100,sizePercentageForCell:u/(u+a)*100,modelSize:l,styleSize:s,borderStyleSize:c,fontSize:d,numOfCells:(null===(e=i.Cells)||void 0===e?void 0:e.length)||0,numOfStyles:(null===(t=i.Styles)||void 0===t?void 0:t.length)||0,numOfFonts:(null===(n=i.Fonts)||void 0===n?void 0:n.length)||0,numOfBorderStyles:(null===(o=i.BorderStyles)||void 0===o?void 0:o.length)||0}}}constructor(){super("ModelStyleSizeCollector")}}const OI=(0,tn.isChangeGateEnabled)("OfficeVSO:8688175_bitwiseBorderDuplicate");function kI(e){const t=function(e){if(e)return{SpanToEnd:e.SpanToEnd,SpanToStart:e.SpanToStart,IsSpillBlocked:e.IsSpillBlocked,IsSpillingOutsideOfBlock:e.IsSpillingOutsideOfBlock}}(e.Spill),n=function(e){if(e)return{Columns:e.Columns,Rows:e.Rows,IsOrigin:e.IsOrigin,OriginRow:e.OriginRow||0,OriginColumn:e.OriginColumn||0,SpansBlocks:e.SpansBlocks,Width:e.Width,Height:e.Height,OriginDeltaX:e.OriginDeltaX,OriginDeltaY:e.OriginDeltaY,WidthAdjustedForDrawing:e.WidthAdjustedForDrawing,HeightAdjustedForDrawing:e.HeightAdjustedForDrawing,OriginDeltaXAdjustedForDrawing:e.OriginDeltaXAdjustedForDrawing,OriginDeltaYAdjustedForDrawing:e.OriginDeltaYAdjustedForDrawing,SpansNextBlockVertically:e.SpansNextBlockVertically,SpansNextBlockHorizontally:e.SpansNextBlockHorizontally}}(e.Merge),o=function(e){if(e)return{Start:e.Start,End:e.End,Separator:e.Separator}}(e.NumFmt),r=function(e){if(!e)return;const t=[];if(e.PhoneticTextRuns)for(let o=0;o<e.PhoneticTextRuns.length;o++)t.push({BaseStartIndex:(n=e.PhoneticTextRuns[o]).BaseStartIndex,PhoneticStartIndex:n.PhoneticStartIndex,BaseTextLength:n.BaseTextLength,PhoneticLength:n.PhoneticLength});var n;return{Text:e.Text,PhoneticTextRuns:t}}(e.PhonInfo),i=function(e){if(!e)return;let t;var n,o;return e.Domain&&(t={Id:null===(n=e.Domain)||void 0===n?void 0:n.Id,StringId:null===(o=e.Domain)||void 0===o?void 0:o.StringId}),{Domain:t,IconWidth:e.IconWidth}}(e.LinkedEntity),l=function(e){if(e)return{Width:e.Width,Type:e.Type,Unicode:e.Unicode}}(e.RichValueIcon),a=function(e){if(e)return{Type:e.Type}}(e.InCellControlOptions),s=function(e){if(e)return{Icon:LI(e.Icon),DataBar:NI(e.DataBar)}}(e.CondFormat),d=function(e){if(!e)return;let t;return e.InternalLink&&(t={ObjectName:e.InternalLink.ObjectName,SheetName:e.InternalLink.SheetName,FirstRow:e.InternalLink.FirstRow,FirstColumn:e.InternalLink.FirstColumn,LastRow:e.InternalLink.LastRow,LastColumn:e.InternalLink.LastColumn}),{Text:e.Text,IsValidHyperlink:e.IsValidHyperlink,IsHyperlinkFormula:e.IsHyperlinkFormula,IsHyperlinkExternal:e.IsHyperlinkExternal,IsHyperlinkChecked:e.IsHyperlinkChecked,Tooltip:e.Tooltip,InternalLink:t}}(e.Hyperlink),c=zI(e.Sparkline),u=zI(e.InCellImage),h=function(e){if(e)return{HasExpandCollapseIndicator:e.HasExpandCollapseIndicator,IsExpanded:e.IsExpanded,ECButtonTitle:e.ECButtonTitle,ShouldShowExpandCollapseMenu:e.ShouldShowExpandCollapseMenu,CanExpandCollapse:e.CanExpandCollapse,SourceIndex:e.SourceIndex,ConfirmRequired:e.ConfirmRequired,CanShowDetails:e.CanShowDetails}}(e.PivotTable),g=function(e){if(e)return{Row:e.Row,Column:e.Column,IsThreadedComment:e.IsThreadedComment,HideCommentIndicator:e.HideCommentIndicator}}(e.Comment),f=function(e){if(e)return{Formula:e.Formula,FormulaType:e.FormulaType,IsArrayRoot:e.IsArrayRoot}}(e.FormulaInfo),C=function(e){if(e)return{Type:e.Type,Title:e.Title,Menu:e.Menu,RenderingContext:e.RenderingContext,CommandData:e.CommandData?e.CommandData:void 0}}(e.AutoFilter),m=function(e){if(e)return{Type:e.Type,DisplayFilter:e.DisplayFilter,IsPivotPageField:e.IsPivotPageField,CommandData:e.CommandData,Title:e.Title,IsHeaderSnapped:e.IsHeaderSnapped}}(e.PivotFilter),p=function(e){if(e)return{IsAnchor:e.IsAnchor,Range:e.Range?GI(e.Range):void 0}}(e.DynamicArrayInfo);let y=[];if(e.TextRuns)for(let t=0;t<e.TextRuns.length;t++)y.push(po(e.TextRuns[t],e.TextRuns[t].FontID||0));else y=void 0;return{Col:e.Col,Row:e.Row,Text:e.Text,StyleID:e.StyleID||0,GlobalCellStyleID:e.GlobalCellStyleID,Ifmt:e.Ifmt||0,IfmtStamped:e.IfmtStamped||0,BorderStyleID:e.BorderStyleID||0,GlobalBorderStyleID:e.GlobalBorderStyleID,HorizontalAlignmentSet:e.HorizontalAlignmentSet,Spill:t,Merge:n,NumFmt:o,WrapText:e.WrapText,ShrunkSize:e.ShrunkSize,AutoFilter:C,PivotFilter:m,TextRuns:y,CondFormat:s,PhonInfo:r,Comment:g,RichValueType:e.RichValueType,RichValueFieldsIndexes:e.RichValueFieldsIndexes?[...e.RichValueFieldsIndexes]:void 0,FormulaInfo:f,ValueType:e.ValueType,HasError:e.HasError,Hyperlink:d,Sparkline:c,InCellImage:u,LinkedEntity:i,RichValueIcon:l,InCellControlOptions:a,PivotTable:h,HasIgnorableError:e.HasIgnorableError,SrvDx:e.SrvDx||0,SrvDy:e.SrvDy||0,TolType:e.TolType,TableColHeader:e.TableColHeader,TableRowHeader:e.TableRowHeader,Value:e.Value,PhoneticInfo:e.PhoneticInfo,OriginalText:e.OriginalText,ErrorTooltip:e.ErrorTooltip,DynamicArrayInfo:p,BitwiseBorderPosition:OI&&e.BitwiseBorderPosition||0}}function EI(e){const t=[];if(e.Outlines)for(let o=0;o<e.Outlines.length;o++)t.push({StartIndex:(n=e.Outlines[o]).StartIndex,ButtonIndex:n.ButtonIndex,IsExpanded:n.IsExpanded,IsButtonHidden:n.IsButtonHidden,IsNonDefaultDirection:n.IsNonDefaultDirection,ECTitle:n.ECTitle});var n;return{Outlines:t}}function LI(e){if(e)return{Set:e.Set,Index:e.Index,IconOnly:e.IconOnly,CFIconHorizontalAlignment:e.CFIconHorizontalAlignment}}function NI(e){if(e)return{AxisColor:e.AxisColor,AxisPostion:e.AxisPostion,Length:e.Length,Color:e.Color,GradientColor:e.GradientColor,BorderColor:e.BorderColor,Direction:e.Direction}}function zI(e){if(e)return{ClusterOffsetX:e.ClusterOffsetX,ClusterOffsetY:e.ClusterOffsetY,AltText:e.AltText,Width:e.Width,Height:e.Height,ClusterImageWidth:e.ClusterImageWidth,ClusterImageHeight:e.ClusterImageHeight}}function GI(e){return{FirstRow:e.FirstRow,FirstColumn:e.FirstColumn,LastRow:e.LastRow,LastColumn:e.LastColumn}}function WI(e){return{Index:e.Index,Caption:e.Caption,ShowBlankLineAfterEachItem:e.ShowBlankLineAfterEachItem,ShowSubtotal:e.ShowSubtotal,RepeatItemLabels:e.RepeatItemLabels,ShowItemsWithNoData:e.ShowItemsWithNoData,ShowSubtotalAtTop:e.ShowSubtotalAtTop,IsCompactLayout:e.IsCompactLayout,BaseFieldIndex:e.BaseFieldIndex,DataFieldAggregationType:e.DataFieldAggregationType,DataFieldFormatType:e.DataFieldFormatType,SortInfo:e.SortInfo,LabelOrDateFilterType:e.LabelOrDateFilterType,ValueFilterType:e.ValueFilterType,MeasureType:e.MeasureType,HasManualFilter:e.HasManualFilter,IsDateField:e.IsDateField,IsImplicitMeasure:e.IsImplicitMeasure,IsNumeric:e.IsNumeric}}function VI(e){const t=e.RowAreaCaptions?[...e.RowAreaCaptions]:void 0,n=e.RowAreaFields?[]:void 0;if(e.RowAreaFields)for(let t=0;t<e.RowAreaFields.length;t++)n.push(WI(e.RowAreaFields[t]));const o=e.ColumnAreaFields?[]:void 0;if(e.ColumnAreaFields)for(let t=0;t<e.ColumnAreaFields.length;t++)o.push(WI(e.ColumnAreaFields[t]));const r=e.ValueAreaFields?[]:void 0;if(e.ValueAreaFields)for(let t=0;t<e.ValueAreaFields.length;t++)r.push(WI(e.ValueAreaFields[t]));const i=e.PageAreaFields?[]:void 0;if(e.PageAreaFields)for(let t=0;t<e.PageAreaFields.length;t++)i.push(WI(e.PageAreaFields[t]));const l=e.SlicerConnections?[]:void 0;if(e.SlicerConnections)for(let t=0;t<e.SlicerConnections.length;t++)l.push({Name:(a=e.SlicerConnections[t]).Name,Caption:a.Caption,WorksheetName:a.WorksheetName,Enabled:a.Enabled});var a;return{FirstRow:e.FirstRow,FirstColumn:e.FirstColumn,LastRow:e.LastRow,LastColumn:e.LastColumn,RangeType:e.RangeType,ConnectionName:e.ConnectionName,PivotTableName:e.PivotTableName,ConfirmationRequiredForDataOps:e.ConfirmationRequiredForDataOps,FieldListVersion:e.FieldListVersion,FieldWellVersion:e.FieldWellVersion,ColumnTotalIndexes:e.ColumnTotalIndexes,RowTotalIndexes:e.RowTotalIndexes,ColumnMemberPropIndexes:e.ColumnMemberPropIndexes,RowMemberPropIndexes:e.RowMemberPropIndexes,OriginPTWidth:e.OriginPTWidth,OriginPTHeight:e.OriginPTHeight,DeltaXFromOriginPT:e.DeltaXFromOriginPT,DeltaYFromOriginPT:e.DeltaYFromOriginPT,ColumnHeaderRange:e.ColumnHeaderRange,RowHeaderRange:e.RowHeaderRange,RowAreaCaptions:t,ExternalSourceIndex:e.ExternalSourceIndex,IsActionable:e.IsActionable,IsOlap:e.IsOlap,SupportsBIExplore:e.SupportsBIExplore,HideGridLines:e.HideGridLines,IsEmptyPivot:e.IsEmptyPivot,Xluid:e.Xluid,ShowDrillIndicators:e.ShowDrillIndicators,ShowColumnStripes:e.ShowColumnStripes,ShowRowStripes:e.ShowRowStripes,ShowRowHeaders:e.ShowRowHeaders,ShowColumnHeaders:e.ShowColumnHeaders,DataSource:e.DataSource,RowLocation:e.RowLocation,ColGrandTotalOn:e.ColGrandTotalOn,RwGrandTotalOn:e.RwGrandTotalOn,IndentIncrement:e.IndentIncrement,AutoFormatOnUpdate:e.AutoFormatOnUpdate,ShowItemsWithNoDataOnRw:e.ShowItemsWithNoDataOnRw,ShowItemsWithNoDataOnCol:e.ShowItemsWithNoDataOnCol,SaveSourceDataWithFile:e.SaveSourceDataWithFile,RefreshOnLoad:e.RefreshOnLoad,AltText:e.AltText,AltTextSummary:e.AltTextSummary,ErrorString:e.ErrorString,NullString:e.NullString,DataPivotFieldCaption:e.DataPivotFieldCaption,DataPivotFieldIndex:e.DataPivotFieldIndex,DisplayErrorString:e.DisplayErrorString,DisplayNullString:e.DisplayNullString,HasActiveFilter:e.HasActiveFilter,IsPageArea:e.IsPageArea,RowAreaFields:n,ColumnAreaFields:o,ValueAreaFields:r,PageAreaFields:i,CurrentStyleName:e.CurrentStyleName,FirstRowIndex:e.FirstRowIndex,FirstColIndex:e.FirstColIndex,LastRowIndex:e.LastRowIndex,LastColIndex:e.LastColIndex,StyleIndex:e.StyleIndex,IsRefreshableTabularOlap:e.IsRefreshableTabularOlap,SlicerConnections:l,OriginPTWidthAdjustedForDrawing:e.OriginPTWidthAdjustedForDrawing,OriginPTHeightAdjustedForDrawing:e.OriginPTHeightAdjustedForDrawing,DeltaXFromOriginPTAdjustedForDrawing:e.DeltaXFromOriginPTAdjustedForDrawing,DeltaYFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,AutoRefresh:e.AutoRefresh,SupportsAutoRefresh:e.SupportsAutoRefresh}}const _I=(0,Se.isChangeGateEnabled)(Se.ChangeGate.HideColMergedCellAcrossBlocks),UI=(0,Se.isChangeGateEnabled)(Se.ChangeGate.MergeInfoResetBugFix);function jI(e,t,n,o=!1){const r=(0,Se.isGlobalBorderStylesEnabled)(e),i=hv(t);var l,a,s,d;if(0!==i.length)for(const c of i){const i=vo(e)+1,u=io((0,Se.getBorderStyleByID)(c,e),i,1),h=cv(c,e,i,u,r,n);for(const o of t)if(l=o.Row,a=o.Col,s=c.Row,d=c.Col,!((l!==s||a!==d+1&&a!==d-1)&&(a!==d||l!==s+1&&l!==s-1)||o.Row!==c.Row-1&&o.Col!==c.Col-1)){const t=uv(o,e,n);if(Object.keys(t).length>0){t.BorderPosition=n?Se.BorderPositionType.Left:Se.BorderPositionType.Top,u.Borders.splice(0,0,t);const i=vo(e)+1;u.ID=i,c.BorderStyleID=i,e.BorderStyles.push(u),r&&(c.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(u)),Io(o,e,n?Se.BorderPositionType.Right:Se.BorderPositionType.Bottom)}}const g=o?[]:iv(c,e,n);if(Object.keys(h).length>0){const t=n?Se.BorderPositionType.Top:Se.BorderPositionType.Left;h.BorderPosition=t;for(const n of g)wo(n,e),bo(n,e,h,t)}}}function qI(e){return _object_spread_props(_object_spread({},e),{SpansBlocks:!1,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0,OriginRow:void 0,OriginColumn:void 0,WidthAdjustedForDrawing:void 0,HeightAdjustedForDrawing:void 0,OriginDeltaXAdjustedForDrawing:void 0,OriginDeltaYAdjustedForDrawing:void 0,SpansNextBlockHorizontally:void 0,SpansNextBlockVertically:void 0})}function $I(e,t,n,o,r,i,l){const a=e.Merge,s=n.Cells.find((t=>(i?t.Col===e.Col:t.Row===e.Row)&&t.Merge&&t.Merge.SpansBlocks&&(i?t.Row>0:t.Col>0)));s&&function(e,t,n,o,r,i,l,a,s){a?function(e,t,n,o,r,i,l,a){e.Rows-=i+l-t.Row+1,e.OriginDeltaY=tv(o.RowHeights,t.Row,i+l)+tv(r.RowHeights,n.Row,n.Row+n.Merge.Rows),n.Merge.Rows+=l+1,e.Height=n.Merge.Height,a||(e.OriginRow=n.Merge.OriginRow)}(e,t,n,o,r,i,l,s):function(e,t,n,o,r,i,l,a){e.Columns-=i+l-t.Col+1,e.OriginDeltaX=tv(o.ColumnWidths,t.Col,i+l)+tv(r.ColumnWidths,n.Col,n.Col+n.Merge.Columns),n.Merge.Columns+=l+1,e.Width=n.Merge.Width,a||(e.OriginColumn=n.Merge.OriginColumn)}(e,t,n,o,r,i,l,s)}(a,e,s,t,n,o,r,i,l)}function XI(e,t,n,o,r,i,l,a){if(!_I)return;const s=t.Cells.find((e=>(a?e.Col===n.Col:e.Row===n.Row)&&e.Merge&&e.Merge.SpansBlocks&&(a?e.Row>0:e.Col>0)));a?s.Merge.Rows+=n.Merge.Rows+1:s.Merge.Columns+=n.Merge.Columns+1;const d=a?!(s.Row+s.Merge.Rows===t.RowNumbers[t.RowNumbers.length-1]):!(s.Col+s.Merge.Columns===t.ColumnNumbers[t.ColumnNumbers.length-1]),c=JI(s,t)||ev(s),u=ZI(s,t)||QI(s);if(UI&&(a&&u&&!c||!a&&c&&!u)){var h,g;const e=null==s||null===(h=s.Merge)||void 0===h?void 0:h.OriginRow,n=null==s||null===(g=s.Merge)||void 0===g?void 0:g.OriginColumn,o=t.RowNumbers[s.Row],r=t.ColumnNumbers[s.Col];s.Merge=qI(s.Merge),(a&&e&&o>e+1||!a&&n&&r>n+1)&&(s.Merge.OriginRow=e,s.Merge.OriginColumn=n)}else UI||!d||c&&u||(s.Merge=qI(s.Merge));const f=KI(n,e,a?Se.BorderPositionType.Bottom:Se.BorderPositionType.Right);if(f){const d=e.BorderStyles.length,c=t.BorderStyles.length+i.length,u=io((0,Se.getBorderStyleByID)(s,t),c,1);a?u.Borders.splice(0,0,f):u.Borders.push(f),t.BorderStyles.push(u),s.BorderStyleID=c,l&&(s.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(u));const h=YI(f);h.BorderPosition=a?Se.BorderPositionType.Top:Se.BorderPositionType.Left;const g=[],C=n.Col+n.Merge.Columns,m=n.Row+n.Merge.Rows;if(a)for(let t=n.Col;t<=C;t+=1)g.push((0,Se.getDefaultCell)(m+1,t,e.Styles,e.Fonts));else for(let t=n.Row;t<=m;t+=1)g.push((0,Se.getDefaultCell)(t,C+1,e.Styles,e.Fonts));const p=io((0,Se.getBorderStyleByID)(g[0],e),d,1);p.Borders.push(h),e.BorderStyles.push(p);for(const e of g)a?e.Row-=o+1:e.Col-=o+1,r.push(e),e.BorderStyleID=d,l&&(e.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(p))}}function YI(e){return{BorderLineStyle:e.BorderLineStyle,BorderPosition:e.BorderPosition,Color:e.Color,Weight:e.Weight}}function KI(e,t,n){const o=(0,Se.getBorderStyleByID)(e,t);for(const e of o.Borders)if(e.BorderPosition===n)return e;return null}function JI(e,t){const n=e.Merge;return t.ColumnOffsets[e.Col]-n.OriginDeltaX+n.Width>t.BlockWidth}function ZI(e,t){const n=e.Merge;return t.RowOffsets[e.Row]-n.OriginDeltaY+n.Height>t.BlockHeight}function QI(e){if(!e)return!1;const t=e.Merge;return!(0!==e.Row||!t||!t.SpansBlocks)&&e.Row!==t.OriginRow&&t.Height>t.OriginDeltaY}function ev(e){if(!e)return!1;const t=e.Merge;return!(0!==e.Col||!t||!t.SpansBlocks)&&e.Col!==t.OriginColumn&&t.Width>t.OriginDeltaX}function tv(e,t,n){let o=0;for(let r=t;r<=n;r++)o+=e[r];return o}function nv(e,t,n,o,r){0!==(0,Se.getBorderStyleByID)(e,t).Borders.length&&(!r||o!==e.Col&&o!==e.Row?r||Io(e,t,n?Se.BorderPositionType.Bottom:Se.BorderPositionType.Right):av(e,t,n))}function ov(e,t,n){const o=[];switch(n){case Se.BorderPositionType.Top:for(const n of t)n.Row===e.Row-1&&o.push(n);break;case Se.BorderPositionType.Bottom:for(const n of t)n.Row===e.Row+1&&o.push(n);break;case Se.BorderPositionType.Left:for(const n of t)n.Col===e.Col-1&&o.push(n);break;case Se.BorderPositionType.Right:for(const n of t)n.Col===e.Col+1&&o.push(n)}return o}function rv(e,t,n){const o=n?Se.BorderPositionType.Top:Se.BorderPositionType.Left,r=KI(e,t,o);if(!r||0===Object.keys(r).length)return;const i=ov(e,t.Cells,o),l=YI(r);Io(e,t,o),l.BorderPosition=n?Se.BorderPositionType.Bottom:Se.BorderPositionType.Right;for(const e of i)bo(e,t,l,l.BorderPosition)}function iv(e,t,n){const o=[];if(n)for(let n=e.Col;n<=e.Col+e.Merge.Columns;n++)o.push((0,Se.getOrCreateCell)(t,e.Row+e.Merge.Rows+1,n));else for(let n=e.Row;n<=e.Row+e.Merge.Rows;n++)o.push((0,Se.getOrCreateCell)(t,n,e.Col+e.Merge.Columns+1));return o}function lv(e,t,n,o){const r=KI(e,n,o?Se.BorderPositionType.Bottom:Se.BorderPositionType.Right);if(!r)return[];const i=YI(r);i.BorderPosition=o?Se.BorderPositionType.Top:Se.BorderPositionType.Left;const l=kI(e);o?l.Row=0:l.Col=0;const a=iv(l,t,o);for(const e of a)o?e.Row=0:e.Col=0,wo(e,t),bo(e,t,i,i.BorderPosition);return a}function av(e,t,n){const o=n?Se.BorderPositionType.Top:Se.BorderPositionType.Left,r=ov(e,t.Cells,o);r.length>0&&function(e,t,n){const o=n?Se.BorderPositionType.Bottom:Se.BorderPositionType.Right;for(const n of e)Io(n,t,o)}(r,t,n)}function sv(e,t,n,o,r,i){var l;const a=gv(o,t,i,r);if(!a)return;const s=a.Merge,d=fv(o,a),c=Cv(o,a);if(i){var u;a.Row=0,s.OriginRow=null===(u=t.Merge)||void 0===u?void 0:u.OriginRow,s.Rows+=r+1,s.OriginDeltaY=tv(n.RowHeights,e.Row,e.Row+e.Merge.Rows);const i=tv(n.RowHeights,e.Row,n.RowHeights.length-1)+tv(o.RowHeights,a.Row,a.Row+a.Merge.Rows-r-1);return a.Merge.Height=i,e.Merge.Height=i,void(d&&(s.OriginDeltaX=e.Merge.OriginDeltaX,e.Merge.Width=s.Width))}a.Col=0,s.OriginColumn=null===(l=t.Merge)||void 0===l?void 0:l.OriginColumn,s.Columns+=r+1,s.OriginDeltaX=tv(n.ColumnWidths,e.Col,e.Col+e.Merge.Columns);const h=tv(n.ColumnWidths,e.Col,n.ColumnWidths.length-1)+tv(o.ColumnWidths,a.Col,a.Col+a.Merge.Columns-r-1);a.Merge.Width=h,e.Merge.Width=h,c&&(s.OriginDeltaY=e.Merge.OriginDeltaY,e.Merge.Height=s.Height)}function dv(e,t,n,o){var r,i;const l=gv(t,e,o,n);if(!l)return;const a=l.Merge,s=fv(t,l),d=Cv(t,l);var c,u,h;s||d||(l.Merge=qI(a)),o?(l.Row=n-e.Merge.Rows,l.Merge.Rows+=(null===(c=e.Merge)||void 0===c?void 0:c.Rows)+1,s&&(l.Merge.OriginRow=null===(u=e.Merge)||void 0===u?void 0:u.OriginRow,l.Merge.OriginDeltaY=0)):(l.Col=n-(null===(r=e.Merge)||void 0===r?void 0:r.Columns),l.Merge.Columns+=(null===(i=e.Merge)||void 0===i?void 0:i.Columns)+1,d&&(l.Merge.OriginColumn=null===(h=e.Merge)||void 0===h?void 0:h.OriginColumn,l.Merge.OriginDeltaX=0))}function cv(e,t,n,o,r,i){let l={};const a=i?o.Borders.findIndex((e=>e.BorderPosition===Se.BorderPositionType.Bottom)):o.Borders.findIndex((e=>e.BorderPosition===Se.BorderPositionType.Right));return-1!==a&&(l=YI(o.Borders[a]),o.Borders.splice(a,1),e.BorderStyleID=n,t.BorderStyles.push(o),r&&(e.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(o))),l}function uv(e,t,n){const o=KI(e,t,n?Se.BorderPositionType.Right:Se.BorderPositionType.Bottom);return o?YI(o):{}}function hv(e){return e.filter((e=>e.Merge&&e.Merge.SpansBlocks))}function gv(e,t,n,o){return e.Cells.find((e=>!Bt(e.Merge)&&(n?e.Col===t.Col&&e.Row===o+1:e.Row===t.Row&&e.Col===o+1)))}function fv(e,t){return JI(t,e)||ev(t)}function Cv(e,t){return ZI(t,e)||QI(t)}const mv=(0,Se.isChangeGateEnabled)(Se.ChangeGate.EnableMergeCellSupportForFreezePanesCse),pv=(0,Se.isChangeGateEnabled)(Se.ChangeGate.EnableFreezePanesCSEForMergedEdgeCells);let yv,Sv;function Rv(){return void 0===yv&&(yv=(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.FreezePanesCseSlice1",!1)),!!yv}function wv(e,t,n,o,r,i,l,a,s,d,c,u,h){var g,f;const C=Rv()&&!!c,m=Xv(s,a[a.length-1]),p=d?(null===(g=t.ColumnNumbers)||void 0===g?void 0:g.length)-1:(null===(f=t.RowNumbers)||void 0===f?void 0:f.length)-1,y=!!C&&Xv(u,p),S=d?e.Col:e.Row,R=C&&Xv(S,function(e,t){return(null==t?void 0:t.performDiagonalCascading)||(null==t?void 0:t.skipCascadingBeforeRowColIndex)?e?Tv-1:Fv-1:(null==t?void 0:t.rowColIndexToEndRangeCascade)-1}(d,c));if(!m&&!R&&!y)return!1;(m||y)&&function(e,t,n,o=!1,r){const i=n?e.Col:e.Row;if(o&&i===r&&(n?i===Tv-1:i===Fv-1))return;const l=(0,Se.isGlobalBorderStylesEnabled)(t),a=t.BorderStyles.length,s=io((0,Se.getBorderStyleByID)(e,t),a,1),d=s.Borders.findIndex((e=>o?n?e.BorderPosition===Se.BorderPositionType.Right:e.BorderPosition===Se.BorderPositionType.Bottom:n?e.BorderPosition===Se.BorderPositionType.Bottom:e.BorderPosition===Se.BorderPositionType.Right));-1!==d&&(s.Borders.splice(d,1),e.BorderStyleID=a,t.BorderStyles.push(s),l&&(e.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(s)))}(e,t,d,C,u);let w=!1,b=!1,I=!1;const v=n+o.length,F=e.BorderStyleID||0,T=io((0,Se.getReferencedObjectById)(F,t.BorderStyles),v,1);return m&&(w=function(e,t,n,o,r,i,l,a,s,d,c,u,h,g,f){const C=n?f!==e.Col:f!==e.Row,m=function(e,t,n,o){return(null==n?void 0:n.skipCascadingBeforeRowColIndex)?e?t.Col+n.rowColIndexToEndRangeCascade:t.Row+n.rowColIndexToEndRangeCascade:o}(n,e,h,f),p=function(e,t,n,o,r,i,l){return i?i?e?qv(t,n,o,e,r,l):jv(t,n,o,e,r,l):{}:e?qv(t,n,o,e):jv(t,n,o,e)}(n,e,t,c,u,C,m);return 0!==Object.keys(p).length&&vv(e,t,o,r,i,l,a,p,s,d,!0,c,n,h,f,g)}(e,t,d,n,o,r,i,l,v,T,s,C,c,h,u)),C&&(y&&(b=function(e,t,n,o,r){const i=e.BorderStyleID||0;return!t.has(i)&&i!==Se.UniqueStyleID.DefaultBorder&&(t.set(i,o),n.push(r),!0)}(e,i,o,v,T)),R&&(I=function(e,t,n,o,r,i,l,a,s,d,c,u,h){const g=n?e.Col:e.Row,f=function(e,t,n,o,r,i,l,a){return n?jv(e,t,o,!n,true,l):qv(e,t,(null==i?void 0:i.performDiagonalCascading)?a:o,!n,true,(null==i?void 0:i.skipCascadingBeforeRowColIndex)?n?e.Row+(null==i?void 0:i.rowColIndexToEndRangeCascade):e.Col+(null==i?void 0:i.rowColIndexToEndRangeCascade):l)}(e,t,n,g,0,c,u,h);return 0!==Object.keys(f).length&&vv(e,t,o,r,i,l,a,f,s,d,!1,c.performDiagonalCascading?h:g,!n,c,h,u)}(e,t,d,n,o,r,i,l,v,T,c,h,u))),w||I||b}function bv(e){return e===Vv.FreezePane&&(void 0===Sv&&(Sv=(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.FreezePanesCseSlice2",!1)),!!Sv&&Rv())&&mv}function Iv(e,t,n,o){if(pv){if(!e.Merge)return!1;if(o){if(e.Row+e.Merge.Rows===t)return!1}else if(e.Col+e.Merge.Columns===t)return!1}return Yv(e,t,n,o)}function vv(e,t,n,o,r,i,l,a,s,d,c,u,h,g,f,C){let m=!1;const p=e.BorderStyleID||0,y=(0,Se.isGlobalBorderStylesEnabled)(t),S=e.BorderStyleID||0,R=h?f!==e.Col:f!==e.Row,w=$v(e,t.Cells,u,h,!c||!!R,(null==g?void 0:g.skipCascadingBeforeRowColIndex)?h?e.Col+(null==g?void 0:g.rowColIndexToEndRangeCascade):e.Row+(null==g?void 0:g.rowColIndexToEndRangeCascade):c?f:C).BorderStyleID||0;if(r&&i.get(S)&&l.get(w))e.BorderStyleID=i.get(S),y&&(e.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID((0,Se.getReferencedObjectById)(p,t.BorderStyles)));else{if(r&&(i.set(S,s),l.set(w,n+l.size)),h){const e=d.Borders;let t=e.length;for(let n=0;n<e.length;n++)e[n].BorderPosition<a.BorderPosition&&(t=n+1);d.Borders.splice(t,0,a)}else d.Borders.push(a);o.push(d),e.BorderStyleID=s,y&&(e.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(d)),m=!0}return m}const Fv=28,Tv=30,Dv=64,xv=20;let Av=0,Bv=!1;const Hv=(0,Se.isChangeGateEnabled)(Se.ChangeGate.MergeCellBorderScenarios),Mv=(0,Se.isChangeGateEnabled)(Se.ChangeGate.MungedBorderBugFixes),Pv=(0,Se.isChangeGateEnabled)(Se.ChangeGate.HideDeleteCSEBlockEdgeBorderFix),Ov=(0,Se.isChangeGateEnabled)(Se.ChangeGate.BorderInsertionBugFix),kv=(0,Se.isChangeGateEnabled)(Se.ChangeGate.InsertOperationBugFix),Ev=(0,Se.isChangeGateEnabled)(Se.ChangeGate.EnableDeleteRowColCSEForMergeCellSpanningAcrossTwoBlocks),Lv=(0,Se.isChangeGateEnabled)(Se.ChangeGate.MergeInfoOriginRowColMismatchBugFix),Nv=(0,Se.isChangeGateEnabled)(Se.ChangeGate.InsertCSEForMergeCellSpanningBlocks);let zv=new Map,Gv=new Map;function Wv(e){return(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.HideColumnMergedCellSlice1,e)&&(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.HideColumnSlice1,e)}var Vv;function _v(e,t,n,o,r){const i=KI(t,o,Se.BorderPositionType.Top);if(i){e||xF(n,[e=(0,Se.getOrCreateCell)(n,r||n.RowNumbers.length-1,t.Col)]);const o=io((0,Se.getBorderStyleByID)(e,n),n.BorderStyles.length,1),l=YI(i);l.BorderPosition=Se.BorderPositionType.Bottom;let a=0;for(let e=0;e<o.Borders.length;e++)if(o.Borders[e].BorderPosition>Se.BorderPositionType.Bottom){a=1,o.Borders.splice(e,0,l);break}a||o.Borders.push(l),e.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(o),n.BorderStyles.push(o),e.BorderStyleID=o.ID}}function Uv(e,t,n,o,r){const i=KI(t,o,Se.BorderPositionType.Left);if(i){e||xF(n,[e=(0,Se.getOrCreateCell)(n,t.Row,r||n.ColumnNumbers.length-1)]);const o=io((0,Se.getBorderStyleByID)(e,n),n.BorderStyles.length,1),l=YI(i);l.BorderPosition=Se.BorderPositionType.Right,o.Borders.push(l),e.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(o),n.BorderStyles.push(o),e.BorderStyleID=o.ID}}function jv(e,t,n,o,r,i){const l={},a=$v(e,t.Cells,n,o,r,i);if(!a)return l;const s=(0,Se.getBorderStyleByID)(a,t);for(const e of s.Borders)if(e.BorderPosition===Se.BorderPositionType.Left)return l.BorderLineStyle=e.BorderLineStyle,l.BorderPosition=Se.BorderPositionType.Right,l.Weight=e.Weight,l.Color=e.Color,l;return l}function qv(e,t,n,o,r,i){const l={},a=$v(e,t.Cells,n,o,r,i);if(!a)return l;const s=(0,Se.getBorderStyleByID)(a,t);for(const e of s.Borders)if(e.BorderPosition===Se.BorderPositionType.Top)return l.BorderLineStyle=e.BorderLineStyle,l.BorderPosition=Se.BorderPositionType.Bottom,l.Weight=e.Weight,l.Color=e.Color,l;return l}function $v(e,t,n,o,r,i){for(const l of t)if(o){if(l.Col===(r?i:e.Col)&&l.Row===n+1)return l}else if(l.Row===(r?i:e.Row)&&l.Col===n+1)return l;return null}function Xv(e,t){return e===t}function Yv(e,t,n,o){return!!e.Merge&&(o?aF(t,n,e.Row,e.Row+e.Merge.Rows):aF(t,n,e.Col,e.Col+e.Merge.Columns))}function Kv(e,t){return function(e,t){for(const n of e.Borders)if(n.BorderPosition===t)return!0;return!1}((0,Se.getBorderStyleByID)(e,t),Se.BorderPositionType.Left)}function Jv(e,t,n,o){const r=e.Cells.filter((e=>n?e.Row===t-1:e.Col===t-1));for(const t of r){if(Hv&&t.Merge)continue;const r=(0,Se.isGlobalBorderStylesEnabled)(e),i=e.BorderStyles.length,l=io((0,Se.getBorderStyleByID)(t,e),i,1),a=l.Borders.findIndex((e=>o?n?e.BorderPosition===Se.BorderPositionType.Right:e.BorderPosition===Se.BorderPositionType.Bottom:n?e.BorderPosition===Se.BorderPositionType.Bottom:e.BorderPosition===Se.BorderPositionType.Right));-1!==a&&(l.Borders.splice(a,1),t.BorderStyleID=i,e.BorderStyles.push(l),r&&(t.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(l)))}}function Zv(e,t,n){return!!e.Merge&&(n?Qv(t,e.Row,e.Row+e.Merge.Rows):Qv(t,e.Col,e.Col+e.Merge.Columns))}function Qv(e,t,n){return t<=e&&n>=e}function eF(e,t){for(let n=0;n<e.length;n++)if(t===e[n])return n;return-1}function tF(e,t,n){var o,r,i,l,a,s,d,c,u,h;JF(t),JF(e),null===(o=t.ColumnNumbers)||void 0===o||o.push(e.ColumnNumbers[n]),null===(r=t.ColMetadata)||void 0===r||r.push(e.ColMetadata[n]),null===(i=t.ColumnWidths)||void 0===i||i.push(e.ColumnWidths[n]),null===(l=t.FixedColumns)||void 0===l||l.push(e.FixedColumns[n]),null===(a=t.ColumnOffsets)||void 0===a||a.push(e.ColumnOffsets[n]),null===(s=e.ColumnNumbers)||void 0===s||s.splice(n,1),null===(d=e.ColMetadata)||void 0===d||d.splice(n,1),null===(c=e.ColumnWidths)||void 0===c||c.splice(n,1),null===(u=e.FixedColumns)||void 0===u||u.splice(n,1),null===(h=e.ColumnOffsets)||void 0===h||h.splice(n,1);let g=0;for(let t=0;t<e.ColumnWidths.length;t++)e.ColumnOffsets[t]=g,g+=e.ColumnWidths[t];e.BlockWidth=g;let f=0;for(let e=0;e<t.ColumnWidths.length;e++)t.ColumnOffsets[e]=f,f+=t.ColumnWidths[e];t.BlockWidth=f}function nF(e,t,n,o,r){JF(t),JF(e);const i=n.length;for(const o of n){var l,a,s,d,c,u,h,g,f;r?(null===(l=t.RowNumbers)||void 0===l||l.push(e.RowNumbers[o]),null===(a=t.RowHeights)||void 0===a||a.push(e.RowHeights[o]),null===(s=t.RowOutlinesInformation)||void 0===s||s.push(e.RowOutlinesInformation[o]),null===(d=t.RowOffsets)||void 0===d||d.push(e.RowOffsets[o])):(null===(c=t.ColumnNumbers)||void 0===c||c.push(e.ColumnNumbers[o]),null===(u=t.ColMetadata)||void 0===u||u.push(e.ColMetadata[o]),null===(h=t.ColumnWidths)||void 0===h||h.push(e.ColumnWidths[o]),null===(g=t.FixedColumns)||void 0===g||g.push(e.FixedColumns[o]),null===(f=t.ColumnOffsets)||void 0===f||f.push(e.ColumnOffsets[o]))}const C=n[0];if(r){var m,p,y,S;null===(m=e.RowNumbers)||void 0===m||m.splice(C,i),null===(p=e.RowHeights)||void 0===p||p.splice(C,i),null===(y=e.RowOutlinesInformation)||void 0===y||y.splice(C,i),null===(S=e.RowOffsets)||void 0===S||S.splice(C,i);let n=0;for(let t=0;t<e.RowHeights.length;t++)e.RowOffsets[t]=n,n+=e.RowHeights[t];e.BlockHeight=n;let o=0;for(let e=0;e<t.RowHeights.length;e++)t.RowOffsets[e]=o,o+=t.RowHeights[e];t.BlockHeight=o}else{var R,w,b,I,v;null===(R=e.ColumnNumbers)||void 0===R||R.splice(C,i),null===(w=e.ColMetadata)||void 0===w||w.splice(C,i),null===(b=e.ColumnWidths)||void 0===b||b.splice(C,i),null===(I=e.FixedColumns)||void 0===I||I.splice(C,i),null===(v=e.ColumnOffsets)||void 0===v||v.splice(C,i);let n=0;for(let t=0;t<e.ColumnWidths.length;t++)e.ColumnOffsets[t]=n,n+=e.ColumnWidths[t];e.BlockWidth=n;let o=0;for(let e=0;e<t.ColumnWidths.length;e++)t.ColumnOffsets[e]=o,o+=t.ColumnWidths[e];t.BlockWidth=o}o||(r?(gF(t.RowNumbers,t.RowNumbers.length-i,Av),gF(e.RowNumbers,0,Av)):(gF(t.ColumnNumbers,t.ColumnNumbers.length-i,Av),gF(e.ColumnNumbers,0,Av)))}function oF(e,t,n){var o,r,i,l,a;JF(t),JF(e);const s=n.length,d=e.ColumnNumbers.length;for(const o of n){var c,u,h,g;const n=o+s-d;null===(c=t.ColumnNumbers)||void 0===c||c.splice(n,0,e.ColumnNumbers[o]),null===(u=t.ColumnWidths)||void 0===u||u.splice(n,0,e.ColumnWidths[o]),null===(h=t.ColMetadata)||void 0===h||h.splice(n,0,e.ColMetadata[o]),null===(g=t.FixedColumns)||void 0===g||g.splice(n,0,e.FixedColumns[o])}const f=n[s-1]+s-d;mF(t.ColumnNumbers,f,s),yF(t);const C=n[0];null===(o=e.ColumnNumbers)||void 0===o||o.splice(C,s),null===(r=e.ColMetadata)||void 0===r||r.splice(C,s),null===(i=e.ColumnWidths)||void 0===i||i.splice(C,s),null===(l=e.FixedColumns)||void 0===l||l.splice(C,s),null===(a=e.ColumnOffsets)||void 0===a||a.splice(C,s),yF(e)}function rF(e,t,n){var o,r,i,l;const a=n.length,s=e.RowNumbers.length;for(const o of n){var d,c,u;const n=o+a-s;null===(d=t.RowNumbers)||void 0===d||d.splice(n,0,e.RowNumbers[o]),null===(c=t.RowHeights)||void 0===c||c.splice(n,0,e.RowHeights[o]),null===(u=t.RowOutlinesInformation)||void 0===u||u.splice(n,0,e.RowOutlinesInformation[o])}const h=n[a-1]+a-s;mF(t.RowNumbers,h,a),pF(t);const g=n[0];null===(o=e.RowNumbers)||void 0===o||o.splice(g,a),null===(r=e.RowHeights)||void 0===r||r.splice(g,a),null===(i=e.RowOffsets)||void 0===i||i.splice(g,a),null===(l=e.RowOutlinesInformation)||void 0===l||l.splice(g,a),pF(e)}function iF(e,t,n){return n?e.Row===t:e.Col===t}function lF(e,t,n,o){return o?e.Row<=t+n&&e.Row>=t:e.Col<=t+n&&e.Col>=t}function aF(e,t,n,o){return n<=e+t&&o>=e}function sF(e,t,n,o){let r=!!(t.RichValueFieldsIndexes||t.PivotFilter||t.PivotTable||t.InCellImage||t.Sparkline);const i=Rv()?n!==Vv.Hide&&n!==Vv.FreezePane:n!==Vv.Hide;return r=r||i&&!!t.CondFormat,Wv(e)&&t.Merge?_I&&function(e){switch(e){case Vv.Delete:return Ev;case Vv.Insert:return Nv;case Vv.Hide:return Hv;default:return!1}}(n)||(r=r||!!t.Merge.SpansBlocks):r=r||!!t.Merge,BF(e)||(r=r||!!t.AutoFilter),HF(e)||(r=r||!!t.FormulaInfo),(0,Se.isGlobalFontsAndCellStylesFlightEnabled)(e)||(r=r||!!t.TextRuns),r&&function(e,t,n,o){var r;let i="";const l=[];if(t.RichValueFieldsIndexes&&l.push("RichValueFieldsIndexes"),t.PivotFilter&&l.push("PivotFilter"),t.PivotTable&&l.push("PivotTable"),t.InCellImage&&l.push("InCellImage"),t.Sparkline&&l.push("Sparkline"),(null===(r=t.Merge)||void 0===r?void 0:r.SpansBlocks)&&l.push("MergeCellSpansBlocks"),t.CondFormat&&n!==Vv.Hide&&l.push("CondFormat"),t.FormulaInfo&&!HF(e)&&l.push("FormulaInfo"),t.Merge&&!Wv(e)&&l.push("MergeCell"),t.AutoFilter&&!BF(e)&&l.push("AutoFilter"),t.TextRuns&&!(0,Se.isGlobalFontsAndCellStylesFlightEnabled)(e)&&l.push("TextRuns"),l.length>0&&(i=l.join(",")),""!==i){let e="";switch(n){case Vv.Hide:e="Hide";break;case Vv.Unhide:e="Unhide";break;case Vv.Insert:e="Insert";break;case Vv.Delete:e="Delete";break;case Vv.FreezePane:e="FreezePane"}e=e.concat(o?"Row":"Column"),vr.Hv.sendTraceTag(507353300,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`CSE unattempted due to complex cell  for commandName= ${e},reason= ${i}`)}}(e,t,n,o),r}function dF(e){return!e||0===e.length}function cF(e,t){var n,o,r,i,l;null===(n=e.ColumnNumbers)||void 0===n||n.splice(t,1),null===(o=e.ColMetadata)||void 0===o||o.splice(t,1),null===(r=e.ColumnWidths)||void 0===r||r.splice(t,1),null===(i=e.FixedColumns)||void 0===i||i.splice(t,1),null===(l=e.ColumnOffsets)||void 0===l||l.splice(t,1);let a=0;for(let t=0;t<e.ColumnWidths.length;t++)e.ColumnOffsets[t]=a,a+=e.ColumnWidths[t];e.BlockWidth=a}function uF(e,t,n,o){const r=t[0],i=t.length;if(n){var l,a,s,d;Av=hF(e,t,n),null===(l=e.RowNumbers)||void 0===l||l.splice(r,i),null===(a=e.RowHeights)||void 0===a||a.splice(r,i),null===(s=e.RowOffsets)||void 0===s||s.splice(r,i),null===(d=e.RowOutlinesInformation)||void 0===d||d.splice(r,i);let c=0;for(let t=0;t<e.RowHeights.length;t++)e.RowOffsets[t]=c,c+=e.RowHeights[t];e.BlockHeight=c,o||gF(e.RowNumbers,r,Av)}else{var c,u,h,g,f;Av=hF(e,t,n),null===(c=e.ColumnNumbers)||void 0===c||c.splice(r,i),null===(u=e.ColMetadata)||void 0===u||u.splice(r,i),null===(h=e.ColumnWidths)||void 0===h||h.splice(r,i),null===(g=e.FixedColumns)||void 0===g||g.splice(r,i),null===(f=e.ColumnOffsets)||void 0===f||f.splice(r,i);let l=0;for(let t=0;t<e.ColumnWidths.length;t++)e.ColumnOffsets[t]=l,l+=e.ColumnWidths[t];e.BlockWidth=l,o||gF(e.ColumnNumbers,r,Av)}}function hF(e,t,n){const o=t.length;return n?e.RowNumbers[t[o-1]]-e.RowNumbers[t[0]]+1:e.ColumnNumbers[t[o-1]]-e.ColumnNumbers[t[0]]+1}function gF(e,t,n){for(let o=t;o<e.length;o++)e[o]=e[o]-n}function fF(e,t){const n=t.length,o=0===t[0],r=t[0]-1;let i,l;var a,s;o||!Eo(e.IsBitwiseFixedRows||0,r)?(i=xv,l={}):(i=null===(a=e.RowHeights)||void 0===a?void 0:a[r],l=null===(s=e.RowOutlinesInformation)||void 0===s?void 0:s[r]);for(let n=0;n<t.length;n++){var d,c,u;const o=t[n],r=0===o?1:e.RowNumbers[o-1]+1;null===(d=e.RowNumbers)||void 0===d||d.splice(o,0,r),null===(c=e.RowHeights)||void 0===c||c.splice(o,0,i),null===(u=e.RowOutlinesInformation)||void 0===u||u.splice(o,0,l)}const h=t[n-1];mF(e.RowNumbers,h,n),pF(e)}function CF(e,t){const n=t.length,o=0===t[0],r=t[0]-1;let i,l,a;var s,d,c;o?(i=Dv,l={},a=!1):(i=null===(s=e.ColumnWidths)||void 0===s?void 0:s[r],l=null===(d=e.ColMetadata)||void 0===d?void 0:d[r],a=null===(c=e.FixedColumns)||void 0===c?void 0:c[r]);for(let n=0;n<t.length;n++){var u,h,g,f;const o=t[n],r=0===o?1:e.ColumnNumbers[o-1]+1;null===(u=e.ColumnNumbers)||void 0===u||u.splice(o,0,r),null===(h=e.ColumnWidths)||void 0===h||h.splice(o,0,i),null===(g=e.ColMetadata)||void 0===g||g.splice(o,0,l),null===(f=e.FixedColumns)||void 0===f||f.splice(o,0,a)}const C=t[t.length-1];mF(e.ColumnNumbers,C,n),yF(e)}function mF(e,t,n){for(let o=t+1;o<e.length;o++)e[o]=e[o]+n}function pF(e){let t=0;for(let n=0;n<e.RowHeights.length;n++)e.RowOffsets[n]=t,t+=e.RowHeights[n];e.BlockHeight=t}function yF(e){let t=0;for(let n=0;n<e.ColumnWidths.length;n++)e.ColumnOffsets[n]=t,t+=e.ColumnWidths[n];e.BlockWidth=t}function SF(e,t,n){if(n){for(const n of t)if(e.Row===n)return!0;return!1}for(const n of t)if(e.Col===n)return!0;return!1}function RF(e,t,n){if(-1===n)return[-1];const o=[n];for(let r=1;r<=t;r++){const t=eF(e,e[n+r]);if(-1===t)return[-1];o.push(t)}return o}function wF(e,t,n,o){var r,i;return o?e.Row>=t&&e.Row+(null===(i=e.Merge)||void 0===i?void 0:i.Rows)<=t+n:e.Col>=t&&e.Col+(null===(r=e.Merge)||void 0===r?void 0:r.Columns)<=t+n}function bF(e,t,n,o,r,i){const l=e.Merge;let a=-1,s=-1;if(function(e,t,n,o,r){const[i,l]=TF(r,t,n,o),[a,s]=DF(e,r,o);return i>a&&l<s}(e,t,n,o,i))o?l.Rows-=n+1:l.Columns-=n+1,a=t,s=t+n+1;else if(FF(e,t,n,o,i)){if(Hv&&nv(e,i,o,t,!0),r&&(IF(e,i,l),l.IsOrigin=void 0),o){const o=t-e.Row+n+1;l.Rows-=o,!r&&l.OriginRow&&(Lv?l.OriginRow=i.RowNumbers[t]-1||0:l.OriginRow-=n-o+1),a=e.Row}else{const o=t-e.Col+n+1;l.Columns-=o,!r&&l.OriginColumn&&(Lv?l.OriginColumn=i.ColumnNumbers[t]-1||0:l.OriginColumn-=n-o+1),a=e.Col}s=t+n+1,!Lv||r||l.SpansBlocks||(e.Merge=qI(e.Merge))}else if(function(e,t,n,o,r){const[i,l]=TF(r,t,n,o),[a,s]=DF(e,r,o);return i>a&&l>=s}(e,t,n,o,i)){let n;Hv&&nv(e,i,o,t,!1),r&&IF(e,i,l),o?(n=e.Row+e.Merge.Rows-t+1,l.Rows-=n):(n=e.Col+e.Merge.Columns-t+1,l.Columns-=n),a=t,s=t+n}l.SpansBlocks&&(o?function(e,t,n,o){for(let r=e;r<t;r++)n.Height-=o.RowHeights[r]}(a,s,l,i):function(e,t,n,o){for(let r=e;r<t;r++)n.Width-=o.ColumnWidths[r]}(a,s,l,i))}function IF(e,t,n){0!==(null==n?void 0:n.OriginRow)&&void 0!==(null==n?void 0:n.OriginRow)||(n.OriginRow=t.RowNumbers[e.Row]-1||0),0!==(null==n?void 0:n.OriginColumn)&&void 0!==(null==n?void 0:n.OriginColumn)||(n.OriginColumn=t.ColumnNumbers[e.Col]-1||0)}function vF(e,t,n,o,r,i,l){const a=e.Merge;a.OriginColumn=t.ColumnNumbers[e.Col]-1,a.OriginRow=t.RowNumbers[e.Row]-1,a.SpansBlocks=!0,a.Width=tv(t.ColumnWidths,e.Col,e.Col+a.Columns),a.Height=tv(t.RowHeights,e.Row,e.Row+a.Rows),r?(i?(l||(a.OriginRow-=o+1),a.Rows=n+o-e.Row):(l||(a.OriginColumn-=o+1),a.Columns=n+o-e.Col),a.IsOrigin=!0):(i?(l||(a.OriginRow-=o+1),a.Rows-=n+o-e.Row+1,a.OriginDeltaY=tv(t.RowHeights,e.Row,n+o)):(l||(a.OriginColumn-=o+1),a.Columns-=n+o-e.Col+1,a.OriginDeltaX=tv(t.ColumnWidths,e.Col,n+o)),a.IsOrigin=!1)}function FF(e,t,n,o,r){const[i,l]=TF(r,t,n,o),[a,s]=DF(e,r,o);return i<=a&&l<s}function TF(e,t,n,o){return o?[e.RowNumbers[t],e.RowNumbers[t+n]]:[e.ColumnNumbers[t],e.ColumnNumbers[t+n]]}function DF(e,t,n){var o,r,i,l;return n?[0===((null===(i=e.Merge)||void 0===i?void 0:i.OriginRow)||0)?t.RowNumbers[e.Row]:((null===(l=e.Merge)||void 0===l?void 0:l.OriginRow)||0)+1,t.RowNumbers[e.Row+e.Merge.Rows]]:[0===((null===(o=e.Merge)||void 0===o?void 0:o.OriginColumn)||0)?t.ColumnNumbers[e.Col]:((null===(r=e.Merge)||void 0===r?void 0:r.OriginColumn)||0)+1,t.ColumnNumbers[e.Col+e.Merge.Columns]]}function xF(e,t){for(const n of t){const t=Tn(n,e.Cells);e.Cells.splice(t,0,n)}}function AF(e,t){for(const n of t){const t=Tn(n,e.Cells);e.Cells.splice(t,1)}}function BF(e){return(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.HideColumnAutoFilterSlice1,e)&&(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.HideColumnSlice1,e)}function HF(e){return(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.HideColumnFormulaSlice1,e)&&(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.HideColumnSlice1,e)}function MF(e,t,n,o,r){const i=e.Merge;if(Nv?(i.OriginRow||i.OriginColumn||(i.OriginColumn=t.ColumnNumbers[e.Col]-1,i.OriginRow=t.RowNumbers[e.Row]-1),i.SpansBlocks||(i.Width=tv(t.ColumnWidths,e.Col,e.Col+i.Columns),i.Height=tv(t.RowHeights,e.Row,e.Row+i.Rows),i.SpansBlocks=!0)):(i.OriginColumn=t.ColumnNumbers[e.Col]-1,i.OriginRow=t.RowNumbers[e.Row]-1,i.SpansBlocks=!0,i.Width=tv(t.ColumnWidths,e.Col,e.Col+i.Columns),i.Height=tv(t.RowHeights,e.Row,e.Row+i.Rows)),o)r?(i.OriginDeltaY=tv(t.RowHeights,e.Row,e.Row+i.Rows-(n+1)+(Fv+n-(e.Row+e.Merge.Rows))),i.Rows=n-(Fv+n+1-(e.Row+e.Merge.Rows+1))):(i.OriginDeltaX=tv(t.ColumnWidths,e.Col,e.Col+i.Columns-(n+1)+(Tv+n-(e.Col+e.Merge.Columns))),i.Columns=n-(Tv+n+1-(e.Col+e.Merge.Columns+1)));else if(r){const t=Fv+n+1-(e.Row+e.Merge.Rows+1);i.Rows=i.Rows+t-(n+1),i.IsOrigin=!0}else{const t=Tv+n+1-(e.Col+e.Merge.Columns+1);i.Columns=i.Columns+t-(n+1)}}function PF(e,t,n){const o=t?e.Col:e.Row;return n.skipCascadingBeforeRowColIndex?o<n.rowColIndexToEndRangeCascade:o>=n.rowColIndexToEndRangeCascade}function OF(e,t,n,o,r){return!!r&&((null==r?void 0:r.skipCascadingBeforeRowColIndex)&&!o?e.Row-=null==r?void 0:r.rowColIndexToEndRangeCascade:(null==r?void 0:r.performDiagonalCascading)&&!o&&(e.Col-=n+1,e.Row=t.RowNumbers.length-(null==r?void 0:r.rowColIndexToEndRangeCascade)+e.Row),!0)}function kF(e,t){Mv||(function(e,t){const n=WF(e,t);(function(e,t,n){const o=t?Se.BorderPositionType.Top:Se.BorderPositionType.Left,r=t?Se.BorderPositionType.Bottom:Se.BorderPositionType.Right;for(let s=0;s<e.Cells.length;s++){var i,l,a;const d=e.Cells[s];if(d.Merge||d[t?"Row":"Col"]===(t?((null===(i=e.RowNumbers)||void 0===i?void 0:i.length)||0)-1:((null===(l=e.ColumnNumbers)||void 0===l?void 0:l.length)||0)-1))continue;d.CachedBorderStyle||(d.CachedBorderStyle=(0,Se.getBorderStyleByID)(d,e));const c=null===(a=d.CachedBorderStyle)||void 0===a?void 0:a.Borders.find((e=>e.BorderPosition===o));if(c&&yn(d,r)){const r=t?(0,Se.getCell)(d.Row+1,d.Col,e):(0,Se.getCell)(d.Row,d.Col+1,e);if(!r||!Sn(r,o)){if(r&&r.Merge)continue;const e=t?(0,Se.getCellLookupKey)(d.Row+1,d.Col):(0,Se.getCellLookupKey)(d.Row,d.Col+1);n.set(e,c)}}}})(e,t,n),VF(e,t,n);const o=_F(e,t);(function(e,t,n,o){const r=t?Se.BorderPositionType.Bottom:Se.BorderPositionType.Right,i=t?Se.BorderPositionType.Top:Se.BorderPositionType.Left;for(let s=0;s<e.Cells.length;s++){var l,a;const d=e.Cells[s];if(!d.Merge&&d[t?"Row":"Col"]!==(t?((null===(l=e.RowNumbers)||void 0===l?void 0:l.length)||0)-1:((null===(a=e.ColumnNumbers)||void 0===a?void 0:a.length)||0)-1)&&(d.CachedBorderStyle||(d.CachedBorderStyle=(0,Se.getBorderStyleByID)(d,e)),d.CachedBorderStyle&&d.CachedBorderStyle.Borders&&d.CachedBorderStyle.Borders.length>0&&yn(d,r))){const r=t?(0,Se.getCell)(d.Row+1,d.Col,e):(0,Se.getCell)(d.Row,d.Col+1,e);if(r&&Sn(r,i)&&!yn(r,i)){if(r&&r.Merge)continue;const e=t?(0,Se.getCellLookupKey)(d.Row+1,d.Col):(0,Se.getCellLookupKey)(d.Row,d.Col+1);if(o.has(e)){const t=o.get(e);if(t&&t.BorderPosition===i)continue}n.set(e,i)}}}})(e,t,o,n),UF(e,t,o)}(e,t),NF(e,t),zF(e,t))}function EF(e,t,n,o,r,i,l,a){Mv&&(i!==Vv.Hide&&i!==Vv.Delete?function(e,t,n,o,r,i,l){if((r?t.Row:t.Col)===n){const n=r?(0,Se.getCell)(t.Row-1,t.Col,e):(0,Se.getCell)(t.Row,t.Col-1,e);if(!n)return;if(t.CachedBorderStyle=(0,Se.getBorderStyleByID)(t,e),n.CachedBorderStyle=(0,Se.getBorderStyleByID)(n,e),kv){if(r?yn(n,Se.BorderPositionType.Bottom)&&Sn(t,Se.BorderPositionType.Top):yn(n,Se.BorderPositionType.Right)&&Sn(t,Se.BorderPositionType.Left)){if(!r&&!yn(t,Se.BorderPositionType.Left)||r&&!yn(t,Se.BorderPositionType.Top)){const e=(0,Se.getCellLookupKey)(r?t.Row+o+1:t.Row,r?t.Col:t.Col+o+1);l.set(e,r?Se.BorderPositionType.Top:Se.BorderPositionType.Left)}const n=(0,Se.getCellLookupKey)(t.Row,t.Col),a=KI(t,e,r?Se.BorderPositionType.Top:Se.BorderPositionType.Left);a&&i.set(n,a),VF(e,r,i),UF(e,r,l)}}else if(yn(n,Se.BorderPositionType.Right)&&Sn(t,Se.BorderPositionType.Left)){if(!yn(t,Se.BorderPositionType.Left)){const e=(0,Se.getCellLookupKey)(r?t.Row+o+1:t.Row,r?t.Col:t.Col+o+1);l.set(e,Se.BorderPositionType.Left)}const n=(0,Se.getCellLookupKey)(t.Row,t.Col),a=KI(t,e,Se.BorderPositionType.Left);a&&i.set(n,a),VF(e,r,i),UF(e,r,l)}}}(e,t,n,o,r,l,a):function(e,t,n,o,r,i,l){const a=r?t.Row:t.Col;if(a===n){const n=r?(0,Se.getCell)(t.Row-1,t.Col,e):(0,Se.getCell)(t.Row,t.Col-1,e);if(n&&(t.CachedBorderStyle=(0,Se.getBorderStyleByID)(t,e),n.CachedBorderStyle=(0,Se.getBorderStyleByID)(n,e),r?yn(n,Se.BorderPositionType.Bottom)&&Sn(t,Se.BorderPositionType.Top):yn(n,Se.BorderPositionType.Right)&&Sn(t,Se.BorderPositionType.Left))){const n=KI(t,e,r?Se.BorderPositionType.Top:Se.BorderPositionType.Left);if(n){const o=(0,Se.getCellLookupKey)(t.Row,t.Col);i.set(o,n),VF(e,r,i)}}}if(a===n+o){const n=r?(0,Se.getCell)(t.Row+1,t.Col,e):(0,Se.getCell)(t.Row,t.Col+1,e);if(!n)return;if(t.CachedBorderStyle=(0,Se.getBorderStyleByID)(t,e),n.CachedBorderStyle=(0,Se.getBorderStyleByID)(n,e),r?!yn(n,Se.BorderPositionType.Top)&&Sn(n,Se.BorderPositionType.Top)&&yn(t,Se.BorderPositionType.Bottom):!yn(n,Se.BorderPositionType.Left)&&Sn(n,Se.BorderPositionType.Left)&&yn(t,Se.BorderPositionType.Right)){const t=(0,Se.getCellLookupKey)(r?n.Row-o-1:n.Row,r?n.Col:n.Col-o-1);l.set(t,r?Se.BorderPositionType.Top:Se.BorderPositionType.Left),UF(e,r,l)}}}(e,t,n,o,r,l,a))}function LF(e,t){Mv&&(zF(e,t),NF(e,t))}function NF(e,t){const n=WF(e,t);for(let t=0;t<e.Cells.length;t++){const o=e.Cells[t],r=(0,Se.getCellLookupKey)(o.Row,o.Col);if(n.has(r)){o.CachedBorderStyle=(0,Se.getBorderStyleByID)(o,e);const t=n.get(r);t&&(Ov?cT(o,e,t,t.BorderPosition):bo(o,e,t,t.BorderPosition)),n.delete(r)}}for(const t of Array.from(n.keys())){const{row:o,column:r}=(0,Se.getRowColFromCellKey)(t),i=(0,Se.getDefaultCell)(o,r);i.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID({Borders:[],ID:0}),i.CachedBorderStyle=(0,Se.getBorderStyleByID)(i,e);const l=n.get(t);l&&(Ov?cT(i,e,l,l.BorderPosition):bo(i,e,l,l.BorderPosition));const a=Tn(i,e.Cells);e.Cells.splice(a,0,i),n.delete(t)}VF(e,t,n)}function zF(e,t){const n=_F(e,t);if(0!==n.size){for(let t=0;t<e.Cells.length;t++){const o=e.Cells[t],r=(0,Se.getCellLookupKey)(o.Row,o.Col);if(n.has(r)){o.CachedBorderStyle=(0,Se.getBorderStyleByID)(o,e);const t=n.get(r);(t&&!Mv||void 0!==t)&&Io(o,e,t),n.delete(r)}}UF(e,t,n)}}function GF(e,t){return t?e.ColumnNumbers[0]:e.RowNumbers[0]}function WF(e,t){const n=GF(e,t);let o=zv.get(n);return o||(o=new Map),o}function VF(e,t,n){const o=GF(e,t);zv.set(o,n)}function _F(e,t){const n=GF(e,t);let o=Gv.get(n);return o||(o=new Map),o}function UF(e,t,n){const o=GF(e,t);Gv.set(o,n)}function jF(e,t,n){return n?t.Index>=e.RowNumbers.length||t.Index<0:t.Index>=e.ColumnNumbers.length||t.Index<0}function qF(e,t,n,o,r){const i=r?e.RowNumbers[t.Index]:e.ColumnNumbers[t.Index],l=r?n.FirstRow:n.FirstColumn,a=r?n.LastRow:n.LastColumn;return i+1>=l&&i<a&&o===Vv.Delete}function $F(e,t,n,o,r,i){const l=r?e.RowNumbers[t.Index]:e.ColumnNumbers[t.Index],a=r?n.FirstRow:n.FirstColumn,s=r?n.LastRow:n.LastColumn;l>=s?t.Index+=i:l+1>=a&&l<s&&(o===Vv.Insert||o===Vv.Unhide?t.Index+=i:o===Vv.Hide&&(t.Index-=t.Index-eF(r?e.RowNumbers:e.ColumnNumbers,a)+1))}function XF(e,t,n){e&&e.PageBreaks&&(0!==t.length?n?e.PageBreaks.Row=t:e.PageBreaks.Col=t:n?e.PageBreaks.Row=void 0:e.PageBreaks.Col=void 0)}function YF(e){e&&e.PageBreaks&&(e.PageBreaks.Row&&0===e.PageBreaks.Row.length&&(e.PageBreaks.Row=void 0),e.PageBreaks.Col&&0===e.PageBreaks.Col.length&&(e.PageBreaks.Col=void 0),e.PageBreaks.Row||e.PageBreaks.Col||(e.PageBreaks=void 0))}function KF(e){return e===Vv.Hide||e===Vv.Delete}function JF(e){NS();const t=[];for(let n=0;n<e.ColumnNumbers.length;n++)t.push(null);e.ColMetadata=t}function ZF(e,t,n){const o=n?(0,Se.getCell)(t.Row+1,t.Col,e):(0,Se.getCell)(t.Row,t.Col+1,e);if(!o)return;const r=eT(e,t,n),i=eT(e,o,n);if(0===r.length||0===i.length)return;let l=0,a=0;const s=[];for(;l<r.length&&a<i.length;){const e=r[l].BorderPosition,n=i[a].BorderPosition;if(e===n){if(QF(t,o,r[l],i[a])){const e=_object_spread({},r[l]);e.BorderPosition===Se.BorderPositionType.Bottom?e.BorderPosition=Se.BorderPositionType.Top:e.BorderPosition===Se.BorderPositionType.Right&&(e.BorderPosition=Se.BorderPositionType.Left),s.push(e)}l++,a++}else e<n?l++:a++}return{ID:e.BorderStyles.length,Borders:s,RefCount:0}}function QF(e,t,n,o){const r=yn(e,n.BorderPosition),i=yn(t,o.BorderPosition);return(r&&i||!r&&!i)&&(a=o,s=(l=n).Color,d=a.Color,s.Blue===d.Blue&&s.Green===d.Green&&s.Red===d.Red&&l.Weight===a.Weight&&l.BorderLineStyle===a.BorderLineStyle);var l,a,s,d}function eT(e,t,n){var o;const r=null===(o=(0,Se.getBorderStyleByID)(t,e))||void 0===o?void 0:o.Borders,i=[];for(const e of r)(yn(t,e.BorderPosition)||n&&Se.BorderPositionType.Left===e.BorderPosition||!n&&Se.BorderPositionType.Top===e.BorderPosition)&&i.push(e);return function(e,t,n,o){if(!(o&&yn(t,Se.BorderPositionType.Bottom)||!o&&yn(t,Se.BorderPositionType.Right)))return;const r=o?(0,Se.getCell)(t.Row+1,t.Col,e):(0,Se.getCell)(t.Row,t.Col+1,e);if(!r||o&&yn(t,Se.BorderPositionType.Bottom)&&yn(r,Se.BorderPositionType.Top)||!o&&yn(t,Se.BorderPositionType.Right)&&yn(r,Se.BorderPositionType.Left))return;const i=(0,Se.getBorderStyleByID)(r,e),l=null==i?void 0:i.Borders;if(0!==l.length)for(const e of l)if(o&&e.BorderPosition===Se.BorderPositionType.Top||!o&&e.BorderPosition===Se.BorderPositionType.Left){const t=_object_spread({},e);t.BorderPosition=o?Se.BorderPositionType.Bottom:Se.BorderPositionType.Right,tT(n,t)}}(e,t,i,n),i}function tT(e,t){let n=0;for(;n<e.length&&e[n].BorderPosition<t.BorderPosition;)n++;e.splice(n,0,t)}function nT(e,t,n,o,r,i){if(!(e&&e.PrintAreas&&t&&t.FirstRow&&t.FirstColumn&&t.LastRow&&t.LastColumn))return void(e&&i.length>0&&(e.PrintAreas=i));const l=e.PrintAreas.length,a=i.length,s=[];for(let a=0;a<l;a++){const l=e.PrintAreas[a],d=r?t.FirstRow:t.FirstColumn,c=r?t.LastRow:t.LastColumn,u=r?l.FirstRow>e.RowNumbers.length-1?e.RowNumbers[e.RowNumbers.length-1]+1:e.RowNumbers[l.FirstRow]:l.FirstColumn>e.ColumnNumbers.length-1?e.ColumnNumbers[e.ColumnNumbers.length-1]+1:e.ColumnNumbers[l.FirstColumn],h=r?l.LastRow>e.RowNumbers.length-1?e.RowNumbers[e.RowNumbers.length-1]+1:e.RowNumbers[l.LastRow]:l.LastColumn>e.ColumnNumbers.length-1?e.ColumnNumbers[e.ColumnNumbers.length-1]+1:e.ColumnNumbers[l.LastColumn],g=o===Vv.Hide||o===Vv.Delete?-n:n;if(d<=u&&c<=u)r?(l.FirstRow+=g,l.LastRow+=g):(l.FirstColumn+=g,l.LastColumn+=g);else if(d<u&&c>u&&c<=h){const e=o===Vv.Hide||o===Vv.Delete?-1*(u-d):n;r?(l.FirstRow+=e,l.LastRow+=g):(l.FirstColumn+=e,l.LastColumn+=g)}else if(d>=u&&c<=h)r?l.LastRow+=g:l.LastColumn+=g;else if(d>u&&d<=h&&c>=h){const e=o===Vv.Hide||o===Vv.Delete?-1*(h-d+1):n;r?l.LastRow+=e:l.LastColumn+=e}else if(d>h);else if(o===Vv.Delete)Bv=!0;else{if(o===Vv.Hide)continue;o===Vv.Insert&&(r?(l.FirstRow+=n,l.LastRow+=n):(l.FirstColumn+=n,l.LastColumn+=n))}if(iT(e,l,r))s.push(l);else{const t=_object_spread({},l);sT(e,l,o,r)&&s.push(l),i.push(t)}}e.PrintAreas=s;for(let t=0;t<a;t++){const n=i[t];lT(e,n,o,r)||e.PrintAreas.push(n)}return!1}function oT(e,t,n){return n?t.LastRow>e.RowNumbers.length-1||t.FirstRow<0:t.LastColumn>e.ColumnNumbers.length-1||t.FirstColumn<0}function rT(e,t,n,o,r){const i=_object_spread({},n);switch(o){case Vv.Hide:case Vv.Delete:r?(i.FirstRow=n.FirstRow+t.RowNumbers.length,n.FirstRow=0,i.LastRow=t.RowNumbers.length):(i.FirstColumn=n.FirstColumn+t.ColumnNumbers.length,n.FirstColumn=0,i.LastColumn=t.ColumnNumbers.length);break;case Vv.Insert:case Vv.Unhide:r?(n.LastRow=e.RowNumbers.length,i.FirstRow=0,i.LastRow-=n.LastRow):(n.LastColumn=e.ColumnNumbers.length,i.FirstColumn=0,i.LastColumn-=n.LastColumn)}return i}function iT(e,t,n){return n?!(t.FirstRow<0&&t.LastRow<0||t.FirstRow>e.RowNumbers.length-1&&t.LastRow>e.RowNumbers.length-1):!(t.FirstColumn<0&&t.LastColumn<0||t.FirstColumn>e.ColumnNumbers.length-1&&t.LastColumn>e.ColumnNumbers.length-1)}function lT(e,t,n,o){if(!e.PrintAreas||0===e.PrintAreas.length)return!1;for(const r of e.PrintAreas)if(aT(r,t,n,o))return o?n===Vv.Hide||n===Vv.Delete?r.LastRow=t.LastRow:r.FirstRow=t.FirstRow:n===Vv.Hide||n===Vv.Delete?r.LastColumn=t.LastColumn:r.FirstColumn=t.FirstColumn,!0;return!1}function aT(e,t,n,o){return o?e.FirstColumn===t.FirstColumn&&e.LastColumn===t.LastColumn&&(n===Vv.Hide||n===Vv.Delete?e.LastRow===t.FirstRow:e.FirstRow===t.LastRow):e.FirstRow===t.FirstRow&&e.LastRow===t.LastRow&&(n===Vv.Hide||n===Vv.Delete?e.LastColumn===t.FirstColumn:e.FirstColumn===t.LastColumn)}function sT(e,t,n,o){let r=!1;return o?n===Vv.Insert||n===Vv.Unhide?t.FirstRow===e.RowNumbers.length&&(t.LastRow=e.RowNumbers.length,r=!0):t.LastRow===e.RowNumbers.length&&(t.FirstRow=e.RowNumbers.length,r=!0):n===Vv.Insert||n===Vv.Unhide?t.FirstColumn===e.ColumnNumbers.length&&(t.LastColumn=e.ColumnNumbers.length,r=!0):t.LastColumn===e.ColumnNumbers.length&&(t.FirstColumn=e.ColumnNumbers.length,r=!0),r}function dT(e,t,n){t.CachedBorderStyle=(0,Se.getBorderStyleByID)(t,e);const o=n?(0,Se.getCell)(t.Row-1,t.Col,e):(0,Se.getCell)(t.Row,t.Col-1,e);(n?!yn(t,Se.BorderPositionType.Top)&&Sn(t,Se.BorderPositionType.Top):!yn(t,Se.BorderPositionType.Left)&&Sn(t,Se.BorderPositionType.Left))&&(o?yn(o,n?Se.BorderPositionType.Bottom:Se.BorderPositionType.Right)||Io(t,e,n?Se.BorderPositionType.Top:Se.BorderPositionType.Left):Io(t,e,Se.BorderPositionType.Left))}function cT(e,t,n,o){const r=(0,Se.getCellBorderStyle)(t,e);if(!r)return;let i=r.Borders.length;for(let e=0;e<r.Borders.length;e++){const t=r.Borders[e];if(t.BorderPosition>o){i=e;break}if(t.BorderPosition===o)return}Wo(e,t),(0,Se.getCellBorderStyle)(t,e).Borders.splice(i,0,n),_o(e,t)}let uT;!function(e){e.Hide="Hide",e.Unhide="Unhide",e.Insert="Insert",e.Delete="Delete",e.FreezePane="FreezePane"}(Vv||(Vv={}));class hT extends Xb{collect(){if(!this.canCollectorExecute())return{isValid:!1,value:$b};const e=this.data.pop();if(!e)return{isValid:!1,value:qb};const t=e[Math.floor(Math.random()*e.length)].FontName;let n=window.performance.now();const o=document.fonts.check(`12px ${t}`,"random text"),r=window.performance.now()-n;n=window.performance.now();var i;return{isValid:!0,value:{isFontLoadedDocumentCheck:o,timeTakenForDocumentCheck:r,isFontLoadedCanvas:(i=t,di.isFontSupported(i)),timeTakenForCanvasCheck:window.performance.now()-n,isFontKnown:hl(t),fontName:Ti(t)}}}constructor(){super("FontCheckTelemetryCollector")}}class gT{static lookupPerfMetricName(e){return Gi[e]}static measureTextWidth(e,t,n,o){const r=gT.canvasContext();return gT.measureTextWidthWithContext(r,e,t,n,o)}static measureTextWidthOffscreen(e,t,n,o){const r=gT.offScreenCanvasContext();return gT.measureTextWidthWithContext(r,e,t,n,o)}static measureTextWidthWithContext(e,t,n,o,r){if(!e)throw Error("measureTextWidthWithContext: ctx is undefined");return e.font=n,xc(e,t,o,r)}static compareFormattedTexts(e,t){return(0,Se.areFormattedTextsEqual)(e,t)}static compareMergeInformation(e,t){return(0,Se.areMergeInformationEqual)(e,t)}static compareInCellControlOptions(e,t){return(0,Se.areInCellControlOptionsEqual)(e,t)}static compareNumberFormatInformation(e,t){return(0,Se.areNumberFormatInformationEqual)(e,t)}static compareHeaderBlockModels(e,t){return(0,Se.compareHeaderBlockModels)(e,t)}static compareGridBlockModels(e,t,n,o){return(0,Se.compareGridBlockModels)(e,t,n,o)}static comparePartialGridBlockModels(e,t,n,o,r,i){return(0,Se.comparePartialGridBlockModels)(e,t,n,o,r,i)}static serializeCell(e,t){return(0,Se.serializeCell)(e,t)}static registerActionOnFontLoad(e,t,n,o,r){var i;null===(i=function(e,t,n,o,r){if(!_a()||!zn(t))return;r&&0!==r.length||(r=vb(e));const i=function(e){if(void 0===Rb&&(Rb=Kn()&&(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.LocalFontSourceInMFP",!1)),!Rb||0===e.length)return e;const t=new Set,n=[],o=Zn();for(let r=0;r<e.length;r++){const i=e[r];if(t.has(i)||ns(i)&&es(i)===Oa.Loaded)continue;const l=tl(i);o&&!Di(l)||(os(l)||(rs(l),!o&&!Di(l)&&0===Ti(i)||!is(l))?t.add(i):(ts(i,Oa.Loaded),Fb()&&n.push(i)))}return n.length>0&&Ab(7,n),Array.from(t.values())}(r);if(i.length>0)return t(0),Fb()&&Ab(8,i),function(e){void 0!==cn||(cn=(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.FontLoadRefactorV2",!1)&&(0,tn.getBooleanFeatureGate)("Microsoft.Office.Excel.ModernFontRendering",!1)),cn?function(e){const t=[];for(let n=0;n<e.length;n++)Bb(e[n])&&t.push(e[n]);0!==t.length&&(1!==t.length?function(e){const t=Hb();for(let n=0;n<e.length;n++){const o=e[n],r=Hb();qa(r,o),t.appendChild(r)}yb.appendChild(t);for(let t=0;t<e.length;t++)ts(e[t],Oa.Pending);Fb()&&e.length>0&&Ab(9,e),setTimeout((()=>{window.requestAnimationFrame((()=>{yb.removeChild(t)}))}),Cb)}(t):xb(t[0]))}(e):function(e){for(let t=0;t<e.length;t++)Bb(e[t])&&xb(e[t])}(e)}(i),function(e,t,n){const o=[],r=[];return Ua().then((()=>function(e,t,n){Jn()&&performance.mark("checkLoadedFonts::start");const o=[];for(let r=0;r<e.length;r++){const i=e[r];Xa(i,Oa.Loaded)?t.push(i):Xa(i,Oa.Failed)?n.push(i):"loading"===Ya(i)&&o.push(Tb(i))}return Jn()&&performance.measure("checkLoadedFonts","checkLoadedFonts::start"),Promise.all(o)}(e,o,r))).then((e=>{if(!zn(t))return;Jn()&&performance.mark("delayedFontsHandling::start");const[i,l]=function(e){const t=[],n=[];for(let o=0;o<e.length;o++){const r=e[o];r.isSuccessful?t.push(r.font):n.push(r.font)}return[t,n]}(e);!function(e){for(let t=0;t<e.length;t++){const n=e[t];es(n)!==Oa.Loaded&&(gs(n),ts(n,Oa.Loaded))}Fb()&&e.length>0&&Ab(10,e)}(o.concat(i)),function(e,t){const n=zn(t);for(let o=0;o<e.length;o++){const r=e[o];ts(r,Oa.Failed),n&&hl(r)&&t(ul(r))}Fb()&&e.length>0&&Ab(11,e)}(r.concat(l),n),Jn()&&performance.measure("delayedFontsHandling","delayedFontsHandling::start"),(o.length>0||i.length>0)&&t(1),t(2),Jn()&&performance.measure("delayedFontsHandling::stateChangeCallback","delayedFontsHandling::start")})).catch((e=>{!function(e,t){zn(e)&&zn(t)&&(t("API_Failure"),e(2))}(t,n)}))}(i,t,n);o&&t(1)}(e,t,n,o,r))||void 0===i||i.catch((e=>{throw e}))}static getFontsLoadStatus(e){return function(e){if(0===e.length)return[];const t=new Map;return e.forEach((e=>{t.set(e.toLowerCase(),{font:e,status:5,fromCache:!1})})),function(e){let t=0;for(const n in Ga){const o=Za(es(n)),r=e.get(n);void 0!==r&&Ja(r.status,o)&&(void 0===r.status&&t++,r.status=o,r.fromCache=!0)}return t===e.size}(t)||function(e){if("function"!=typeof document.fonts.values)return;e.forEach((e=>{5===e.status&&(e.status=4)}));const t=document.fonts.values();let n=t.next();for(;!n.done;){if(n.value){const t=n.value.family.replace(/[\""]/g,"").toLowerCase(),o=e.get(t),r=Qa(n.value.status);void 0!==o&&Ja(o.status,r)&&(o.status=r)}n=t.next()}}(t),Array.from(t.values())}(e)}static stopFontRenderingTelemetry(){bb=!0}static getFontLoadRenderingLogs(){return Sb}static registerExternalCallbacks(e){!function(e){di=e}(e)}static isExternalCallbacksRegistered(){return Ai()}static initializeLogger(e){e&&(0,vr.n6)(e)}static initializeChangeGates(e){(0,tn.setChangeGateDictionaryGetter)((()=>e))}static initializeFeatureGates(e){(0,tn.setFeatureGateDictionaryGetter)((()=>e))}static initializeGridRendererImageLoader(e,t){!function(e,t){Vt.onImageLoadSuccessCallback=e,Vt.onImageLoadFailureCallback=t}(e,t)}static setStaticImageUrl(e,t){!function(e,t){(0,Se.verifyArgumentNotNull)(t,"url","setStaticImageUrl");const n=$t(e),o=Jt(n);if(o){if(o.url)throw Error(`setStaticImageUrl: image url already defined. image: ${e}, old url: ${o.url}, new url: ${t}`);o.url=t,Kt(o)}else Zt(n,{blockIdentifiers:[],status:Gt.Initialized,url:t})}(e,t)}static loadPreviewFont(e){!function(e){qa(yb,hb),Ua().then((()=>{Xa(hb,Oa.Failed)&&e("ERROR")}),(()=>{e("API_Failure")}))}(e)}static loadPreviewFontFamily(e,t){!function(e,t){"loaded"!==Ya(e)&&((Zn()||"unloaded"===Ya(e))&&qa(yb,e),Ua().then((()=>{Xa(e,Oa.Failed)&&t("ERROR")}),(()=>{t("API_Failure")})))}(e,t)}static isFontLoadApiSupported(){return _a()}static initPassiveTestManager(){!function(){if(!_b){Nb=yi(3,25),zb=yi(5,6e4);const e=yi(4,1e4);Gb=new Eb({onReportUserIsIdle:()=>{window.requestIdleCallback?window.requestIdleCallback(Ub):setTimeout(Ub,0)}},e),Lb.length>0&&Gb.startTrackingIfApplicable(),_b=!0}}()}static initGridRendererStrings(e){!function(e){pg=e,Bt(pg)&&vr.Hv.sendTraceTag(507847511,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Error,"initGridRendererStrings: gridRendererStrings is null or undefined")}(e)}static isGridRendererStringsInitialized(){return!Bt(pg)}static initGridRendererCustomCursors(e){!function(e){vr.Hv.sendTraceTag(509110487,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`GridRendererCustomCursors: initGridRendererCustomCursors:: isNullOrUndefined(strings): ${Bt(e)}`),lS=e}(e)}static isGridRendererCustomCursorsInitialized(){return!Bt(lS)}static registerForCompressedTextTelemetryCollector(e){const t=gT.canvasContext();t&&function(e,t){Yb||(Yb=new eI(e)),function(e){if(!e||!e.Cells)return!1;for(let t=0;t<e.Cells.length;t++){const n=e.Cells[t];if(n.Text&&!Pb(e,n))return!0}return!1}(t)&&Yb.register(t)}(t,e)}static registerForSpillCellTelemetryCollector(e){const t=gT.canvasContext();t&&function(e,t){Kb||(Kb=new tI(e)),function(e){if(!e||!e.Cells)return!1;for(let t=0;t<e.Cells.length;t++){const n=e.Cells[t];if(n.Spill&&n.Text)return!0}return!1}(t)&&Kb.register(t)}(t,e)}static registerForAutoFitWidthTelemetryCollector(e){const t=gT.canvasContext();t&&function(e,t){Jb||(Jb=new nI(e)),function(e){if(!e||!e.Cells)return!1;for(let t=0;t<e.Cells.length;t++){const n=e.Cells[t];if(n.Text&&!Pb(e,n))return!0}return!1}(t)&&Jb.register(t)}(t,e)}static registerForAutofitHeightTelemetryCollector(e){const t=gT.canvasContext();t&&function(e,t){Zb||(Zb=new rI(e)),function(e){if(!e||!e.Cells)return!1;for(let t=0;t<e.Cells.length;t++){const n=e.Cells[t];if(n.Text&&n.WrapText&&iI(n))return!0}return!1}(t)&&Zb.register(t)}(t,e)}static registerCellHashDisplayCollector(e){!function(e){Qb||(Qb=new lI),function(e){if(!e||!e.Cells)return!1;for(let t=0;t<e.Cells.length;t++){const n=e.Cells[t];if(n.Text&&dI(n))return!0}return!1}(e)&&Qb.register(e)}(e)}static registerAppMemoryInfoCollector(){bI||(bI=new TI),bI.register({})}static registerModelCascadeTimeInfoCollector(e){!function(e){vI||(vI=new xI),function(e){var t;return!!(null===(t=e.Cells)||void 0===t?void 0:t.length)}(e)&&vI.register(e)}(e)}static registerModelStyleSizeInfoCollector(e){!function(e){var t;FI||(FI=new PI),(null===(t=e.Cells)||void 0===t?void 0:t.length)&&FI.register(e)}(e)}static registerBlockStatisticsInfoCollector(){II||(II=new DI),II.register({})}static registerForFontCheckTelemetryCollector(e){gT.canvasContext()&&function(e){if(uT||(uT=new hT),!document.fonts||!Ti)return;const t=function(e){const t=[];if(!e.Fonts)return t;for(let n=0;n<e.Fonts.length;n++){const o=e.Fonts[n];o&&t.push(o)}return t}(e);t.length>0&&uT.register(t)}(e)}static preprocessModel(e,t,n){return function(e,t,n,o){const r=[];if(!t.ColMetadata)return r;try{for(let e=0;e<t.ColMetadata.length;e++){const n=t.ColMetadata[e],o=t.ColumnNumbers[e];n?n.SrvDx&&n.SrvDx>0&&ES(o)!==n.SrvDx&&kS(o):kS(o)}let i=0;for(let n=0;n<t.ColMetadata.length;n++){const l=t.ColMetadata[n],a=t.ColumnNumbers[n];if(t.ColumnOffsets[n]=i,l&&l.SrvDx&&l.SrvDx>0){const i=OS(a);if(i&&l.SrvDx===i.SrvDx)i.CachedColWidth&&(r.push({colIndex:a,newWidth:i.CachedColWidth,isCacheChanged:!1}),t.ColumnWidths[n]=i.CachedColWidth);else{if(l.CachedStyle=(0,Se.getReferencedObjectById)(l.CellStyleId||0,t.Styles),l.CachedFont=(0,Se.getReferencedObjectById)(l.CachedStyle.FontID||0,t.Fonts),l.CachedStyle.VerticalText)continue;l.CachedColWidth=MS(e,t,l,o),r.push({colIndex:a,newWidth:l.CachedColWidth,isCacheChanged:!0}),t.ColumnWidths[n]=l.CachedColWidth,LS(a,l)}}i+=t.ColumnWidths[n]}return t.BlockWidth=i,(0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.TextWidthClientNewProcessing,t)&&void 0!==n&&void 0!==o&&function(e,t,n,o){(0,Se.initModelClientCache)(t),Rr(t,n*o);const r=t.Cells;for(let i=0;i<r.length;i++){const l=r[i];if(l.CachedStyle=(0,Se.getReferencedObjectById)(l.StyleID||0,t.Styles),l.CachedFont=(0,Se.getReferencedObjectById)(l.CachedStyle.FontID||0,t.Fonts),!Bt(l.TextRuns))for(let e=0;e<l.TextRuns.length;e++){const n=l.TextRuns[e];n.CachedFont=(0,Se.getReferencedObjectById)(n.FontID||0,t.Fonts)}const a=l.CachedFont.Italic,s=l.CachedFont.FontName!==Zr,d=!!l.TextRuns,c=l.CachedFont.Underline!==Se.FontUnderline.None||l.CachedFont.StrikeThrough,u=!!l.AutoFilter;if(l.Text&&(l.CachedDisplayText=kn(l,t)),!l.DisplayFormula&&!Po(l.PreviewText))if(l.TolType===Se.TolType.Autofit)switch(l.ValueType){case Se.CellValueType.Number:l.Spill=void 0;break;case Se.CellValueType.String:(a||s||c||d||u)&&SS(e,t,l,n,o)}else(l.TolType===Se.TolType.Spill||u)&&SS(e,t,l,n,o)}}(e,t,n,o),r}catch(e){if((0,Se.isChangeGateEnabled)(Se.ChangeGate.ImprovedExceptionHandling))return vr.Hv.sendTraceTag(507360604,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Warning,`GridCanvasRenderer.preprocessAutofitWidth: Error occurred while preprocessing autofit width. Error: ${e}`),r;throw e}}(gT.canvasContext(),e,t,n)}static getProcessedColumnWidth(e,t){const n=OS(e);return n&&n.SrvDx===t&&n.CachedColWidth||t}static resetColWidthCache(){NS()}static resetColWidthCacheByCol(e){!function(e){PS[e]=void 0}(e)}static analyzeLowRenderingFidelity(e){return function(e){const t={};for(let r=0;r<e.Cells.length;r++){const i=e.Cells[r];i&&(pI(t,i),CI(t,i),mI(t,e,i),yI(t,i),RI(t,i),SI(t,i),n=t,(o=i).Spill&&o.Spill.IsSpillBlocked&&o.Spill.IsSpillingOutsideOfBlock&&wI(n,cI.SpillCellAcrossBlocks))}var n,o;return t}(e)}static hasRenderingFidelityThresholdExceeded(e,t){return function(e,t){return t>fI[e].value}(e,t)}static getErrorTypeForRenderingFidelityProblem(e){return function(e){return fI[e].errorType+"_"+e}(e)}static getVetoForRenderingFidelityProblem(e){return function(e){return fI[e].veto}(e)}static renderingRegionContainsDirtyCells(e,t){return uo(e,t)}static calculateRowHeaderWidth(e,t){return(0,Se.calculateRowHeaderWidth)(e,t)}static getCellStyleHashes(e){return function(e){const t=new Set,n=e.Styles||[];for(let o=0;o<n.length;o++){const r=n[o];if(r)if((0,Se.isRenderFlagEnabled)(Se.RenderFlagsArray.GlobalStylesSlice1,e)){const i=(0,Se.getReferencedObjectById)(r.FontID||0,e.Fonts);t.add((0,Se.generateKeyFromModelStyles)(Se.StyleType.CellStyle,n[o])+(0,Se.generateKeyFromModelStyles)(Se.StyleType.Font,i))}else t.add(Do(e,n[o]))}return t}(e)}static canRowColHideOrCascade(e,t,n,o){return function(e,t,n,o){if(dF(e.Cells))return!0;const r=eF(n?e.RowNumbers:e.ColumnNumbers,t);if(-1===r)return!1;const i=e.Cells;for(let t=0;t<i.length;t++){const l=i[t];let a=!1;if(l.Merge&&(a=Zv(l,r,n),vr.Hv.sendTraceTag(507353301,Fr.n.msoulscat_ES_EWAJSGrid,C.k.Info,`ModelCascadeHelper::canCellsOfRowColHideOrCascade called, MergedCellAcrossBlocks: ${!!l.Merge.SpansBlocks}, rowColIndex: ${r}, cell.Col: ${l.Col}, cell.Row: ${l.Row}, isMergedCellIntersectRowCol: ${a}`)),(iF(l,r,n)||a)&&sF(e,l,o,n))return!1}return!0}(e,t,n,o)}static canMultipleRowColHideOrCascade(e,t,n,o,r){return function(e,t,n,o,r){if(dF(e.Cells))return!0;const i=eF(o?e.RowNumbers:e.ColumnNumbers,t);if(-1===i)return!1;const l=e.Cells;for(let t=0;t<l.length;t++){const a=l[t];if(bv(r)&&Iv(a,i,n,o))return!1;if((lF(a,i,n,o)||Yv(a,i,n,o))&&sF(e,a,r,o))return!1}return!0}(e,t,n,o,r)}static performModelCascade(e,t,n,o){return function(e,t,n,o){if(o)return{isSuccess:!1,exception:"Rows are not supported"};const r={};try{const i=(0,Se.isGlobalBorderStylesEnabled)(e),l=(0,Se.isGlobalFontsAndCellStylesFlightEnabled)(e),a=performance.now(),s=eF(o?e.RowNumbers:e.ColumnNumbers,n);if(-1===s)return{isSuccess:!1,exception:"Incorrect rowColIndex found"};if(dF(e.Cells))return r.timeTaken=performance.now()-a,tF(e,t,s),{isSuccess:!0,metric:r};const d=[],c=[],u=[],h=new Map,g=[],f=new Map,C=[],m=new Map,p=t.Styles.length,y=t.Fonts.length,S=t.BorderStyles.length,R=t.ColumnNumbers.length;let w=!1;e.ClientOnlyCache=void 0,t.ClientOnlyCache=void 0;let b=!1,I=!1,v=!1;(0,Se.preprocessModelStyles)(e),(0,Se.preprocessModelStyles)(t);for(let n=0;n<e.Cells.length;n++){const r=e.Cells[n];let a=!1;if(r.Col!==s){r.Col-=1,c.push(r);continue}if(r.Merge&&!wF(r,s,0,o)){const t=kI(r);vF(t,e,s,0,a,!1,!0),a=!0,t.Col=0,c.push(t)}r.Merge&&a&&vF(r,e,s,0,a,!1,!0);const F=r.Col;r.Col=R,d.push(r);const T=r.StyleID||0;let D=!1,x=!1;if(!h.has(T)&&T!==Se.UniqueStyleID.Default&&T!==Se.UniqueStyleID.Hyperlink){const t=(0,Se.getReferencedObjectById)(T,e.Styles),n=t.FontID||0;if(D=!l||Bt(r.GlobalCellStyleID),x=!l||Bt(t.GlobalFontID),x&&!f.has(n)){const t=y+f.size;f.set(n,t);const o=lo((0,Se.getReferencedObjectById)(n,e.Fonts),t,1);g.push(o),v=!0}if(D){let e=Se.UniqueStyleID.Default;e=p-nn+u.length,h.set(T,e);const o=ro(t,e,1);o.FontID=f.get(n),u.push(o),I=!0}}const A=r.BorderStyleID||0,B=!i||Bt(r.GlobalBorderStyleID);if(B){if(!m.has(A)&&A!==Se.UniqueStyleID.DefaultBorder){const t=S+m.size;m.set(A,t);const n=io((0,Se.getReferencedObjectById)(A,e.BorderStyles),t,1),i=jv(r,e,F,o);0!==Object.keys(i).length&&n.Borders.push(i),Kv(r,e)&&(w=!0),C.push(n),b=!0}}else if(i){const n=jv(r,e,F,o),i=0!==Object.keys(n).length,l=Kv(r,e);if(i||l){const o=t.BorderStyles.length,a=io((0,Se.getBorderStyleByID)(r,e),o,1);i&&(a.Borders.push(n),r.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(a)),r.BorderStyleID=o,t.BorderStyles.push(a),w=l}}D&&(r.StyleID=T===Se.UniqueStyleID.Default?Se.UniqueStyleID.Default:h.get(T)),B&&(r.BorderStyleID=A===Se.UniqueStyleID.DefaultBorder?Se.UniqueStyleID.DefaultBorder:m.get(A))}b&&t.BorderStyles.push(...C),w&&Jv(t,R,o),tF(e,t,s);for(const e of d){const n=Tn(e,t.Cells);t.Cells.splice(n,0,e)}if(I)for(const e of u)t.Styles.splice(e.ID||0,0,e);v&&t.Fonts.push(...g),e.Cells=c,r.countOfStylesMoved=h.size,r.countOfFontsMoved=f.size,r.countOfBorderStylesMoved=m.size,r.timeTaken=performance.now()-a}catch(e){return{isSuccess:!1,exception:e,metric:r}}return{isSuccess:!0,metric:r}}(e,t,n,o)}static performModelCascadeForMultipleRowCols(e,t,n,o,r){return function(e,t,n,o,r){if(r)return{isSuccess:!1,exception:"Rows are not supported"};const i={};try{const l=(0,Se.isGlobalBorderStylesEnabled)(e),a=(0,Se.isGlobalFontsAndCellStylesFlightEnabled)(e),s=performance.now(),d=r?e.RowNumbers:e.ColumnNumbers,c=!0,u=eF(d,n),h=RF(d,o,u);if(-1===h[0])return{isSuccess:!1,exception:"Incorrect rowColIndex found"};if(dF(e.Cells))return i.timeTaken=performance.now()-s,nF(e,t,h,c,r),{isSuccess:!0,metric:i};const g=[],f=[],C=[],m=new Map,p=[],y=new Map,S=[],R=new Map,w=new Map,b=t.Styles.length,I=t.Fonts.length,v=t.BorderStyles.length,F=t.ColumnNumbers.length,T=o+1;e.ClientOnlyCache=void 0,t.ClientOnlyCache=void 0;let D=!1,x=!1,A=!1;(0,Se.preprocessModelStyles)(e),(0,Se.preprocessModelStyles)(t);for(let t=0;t<e.Cells.length;t++){const n=e.Cells[t];let i=!1;if(!SF(n,h,r)){n.Col-=T,f.push(n);continue}if(n.Merge&&!wF(n,u,o,r)){const t=kI(n);vF(t,e,u,o,i,!1,!0),i=!0,t.Col=0,f.push(t)}n.Merge&&i&&vF(n,e,u,o,i,!1,!0);const s=n.Col;n.Col=F+s,g.push(n);const d=n.StyleID||0;let c=!1,B=!1;if(!m.has(d)&&d!==Se.UniqueStyleID.Default&&d!==Se.UniqueStyleID.Hyperlink){const t=(0,Se.getReferencedObjectById)(d,e.Styles),o=t.FontID||0;if(c=!a||Bt(n.GlobalCellStyleID),B=!a||Bt(t.GlobalFontID),B&&!y.has(o)){const t=I+y.size;y.set(o,t);const n=lo((0,Se.getReferencedObjectById)(o,e.Fonts),t,1);p.push(n),A=!0}if(c){const e=b-nn+C.length;m.set(d,e);const n=ro(t,e,1);n.FontID=y.get(o),C.push(n),x=!0}}const H=n.BorderStyleID||0,M=!l||Bt(n.GlobalBorderStyleID);if(M&&!R.has(H)&&H!==Se.UniqueStyleID.DefaultBorder){const t=v+S.length;R.set(H,t);const n=io((0,Se.getReferencedObjectById)(H,e.BorderStyles),t,1);S.push(n),D=!0}const P=n.BorderStyleID||0;if(c&&(n.StyleID=d===Se.UniqueStyleID.Default?Se.UniqueStyleID.Default:m.get(d)),M&&(n.BorderStyleID=H===Se.UniqueStyleID.DefaultBorder?Se.UniqueStyleID.DefaultBorder:R.get(H)),Xv(s,h[h.length-1])){const t=jv(n,e,s,r);if(0!==Object.keys(t).length){const o=n.BorderStyleID||0,i=v+S.length,a=$v(n,e.Cells,s,r).BorderStyleID||0;if(M&&R.get(o)&&w.get(a))n.BorderStyleID=R.get(o),l&&(n.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID((0,Se.getReferencedObjectById)(P,e.BorderStyles)));else{M&&(R.set(o,i),w.set(a,v+w.size));const r=io((0,Se.getReferencedObjectById)(P,e.BorderStyles),i,1);r.Borders.push(t),S.push(r),n.BorderStyleID=i,l&&(n.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(r)),D=!0}}}}D&&t.BorderStyles.push(...S),Jv(t,F,r),nF(e,t,h,c,r);for(const e of g){const n=Tn(e,t.Cells);t.Cells.splice(n,0,e)}if(x)for(const e of C)t.Styles.splice(e.ID||0,0,e);A&&t.Fonts.push(...p),e.Cells=f,i.countOfStylesMoved=m.size,i.countOfFontsMoved=y.size,i.countOfBorderStylesMoved=R.size,i.timeTaken=performance.now()-s}catch(e){return{isSuccess:!1,exception:e,metric:i}}return{isSuccess:!0,metric:i}}(e,t,n,o,r)}static performModelCascadeRowColsOperations(e,t,n,o,r,i,l){return function(e,t,n,o,r,i,l){const a=r===Vv.Hide||r===Vv.FreezePane;return a||r===Vv.Delete?function(e,t,n,o,r,i,l){const a={};try{const s=(0,Se.isGlobalBorderStylesEnabled)(e),d=(0,Se.isGlobalFontsAndCellStylesFlightEnabled)(e),c=performance.now(),u=r?e.RowNumbers:e.ColumnNumbers,h=eF(u,n),g=RF(u,o,h),f=Rv()&&!!l;if(-1===g[0])return{isSuccess:!1,exception:"Incorrect rowColIndex found"};if(f){if(dF(e.Cells)&&!(null==l?void 0:l.performDiagonalCascading))return a.timeTaken=performance.now()-c,nF(e,t,g,i,r),{isSuccess:!0,metric:a}}else if(dF(e.Cells))return a.timeTaken=performance.now()-c,nF(e,t,g,i,r),kF(t,r),LF(t,r),{isSuccess:!0,metric:a};const C=[],m=[],p=[],y=new Map,S=[],R=new Map,w=[],b=new Map,I=new Map,v=t.Styles.length,F=t.Fonts.length,T=t.BorderStyles.length,D=o+1,x=r?t.RowOffsets.length:t.ColumnOffsets.length;e.ClientOnlyCache=void 0,t.ClientOnlyCache=void 0;let A=!1,B=!1,H=!1,M=!1,P=!1,O=!1;(0,Se.preprocessModelStyles)(e),(0,Se.preprocessModelStyles)(t);for(let n=0;n<e.Cells.length;n++){const a=e.Cells[n];let c=!1;const u=r?a.Row:a.Col,k=r?a.Col:a.Row;if(f&&PF(a,r,l)){m.push(a);continue}if(!SF(a,g,r)){r?a.Row-=D:a.Col-=D,m.push(a);continue}if(a.Merge)if(wF(a,h,o,r))a.Merge.SpansBlocks?XI(e,t,a,o,m,w,s,r):O=!0;else{const n=kI(a);n.Merge.SpansBlocks&&_I?($I(n,e,t,h,o,r,i),Hv||0!==n.Merge.Columns&&0!==n.Merge.Rows||(M=!0)):vF(n,e,h,o,c,r,i),!Hv||0!==n.Merge.Columns&&0!==n.Merge.Rows||(M=!0),a.Merge.SpansBlocks||(c=!0),r?n.Row=0:n.Col=0,Hv&&n.Merge&&Io(n,e,r?Se.BorderPositionType.Top:Se.BorderPositionType.Left),m.push(n)}if(a.Merge)if(c)vF(a,e,h,o,c,r,i),!Hv||0!==a.Merge.Columns&&0!==a.Merge.Rows||(P=!0);else if(a.Merge.SpansBlocks&&!c)continue;const E=r?a.Row:a.Col;r?a.Row=x+E:a.Col=x+E,f&&OF(a,t,o,r,l),C.push(a);const L=a.StyleID||0;let N=!1,z=!1;if(N=!d||Bt(a.GlobalCellStyleID),!y.has(L)&&L!==Se.UniqueStyleID.Default&&L!==Se.UniqueStyleID.Hyperlink){const t=(0,Se.getReferencedObjectById)(L,e.Styles);z=!d||Bt(t.GlobalFontID);const n=t.FontID||0;if(z&&!R.has(n)){const t=F+R.size;R.set(n,t);const o=lo((0,Se.getReferencedObjectById)(n,e.Fonts),t,1);S.push(o),H=!0}if(N){const e=v-nn+p.length;y.set(L,e);const o=ro(t,e,1);o.FontID=R.get(n),p.push(o),B=!0}}const G=a.BorderStyleID||0,W=!s||Bt(a.GlobalBorderStyleID);if(W&&!b.has(G)&&G!==Se.UniqueStyleID.DefaultBorder){const t=T+w.length;b.set(G,t);const n=io((0,Se.getReferencedObjectById)(G,e.BorderStyles),t,1);w.push(n),A=!0}const V=a.BorderStyleID||0;if(N&&(a.StyleID=L===Se.UniqueStyleID.Default?Se.UniqueStyleID.Default:y.get(L)),W&&(a.BorderStyleID=G===Se.UniqueStyleID.DefaultBorder?Se.UniqueStyleID.DefaultBorder:b.get(G)),f){const t=wv(a,e,T,w,W,b,I,g,E,r,l,k,u);A=A||t}else if(!a.Merge&&Xv(E,g[g.length-1])){let t=!1,n={},o={};if(r?(n=qv(a,e,E,r),t=0!==Object.keys(n).length):(o=jv(a,e,E,r),t=0!==Object.keys(o).length),t){const t=a.BorderStyleID||0,i=T+w.length,l=$v(a,e.Cells,E,r).BorderStyleID||0;if(W&&b.get(t)&&I.get(l))a.BorderStyleID=b.get(t),s&&(a.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID((0,Se.getReferencedObjectById)(V,e.BorderStyles)));else{W&&(b.set(t,i),I.set(l,T+I.size));const d=io((0,Se.getReferencedObjectById)(V,e.BorderStyles),i,1);if(r){const e=d.Borders;let t=e.length;for(let o=0;o<e.length;o++)Ov&&e[o].BorderPosition>n.BorderPosition?t=o:!Ov&&e[o].BorderPosition<n.BorderPosition&&(t=o+1);d.Borders.splice(t,0,n)}else d.Borders.push(o);w.push(d),a.BorderStyleID=i,s&&(a.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(d)),A=!0}}}}A&&t.BorderStyles.push(...w),(!f||f&&!(null==l?void 0:l.performDiagonalCascading))&&(Jv(t,x,r),nF(e,t,g,i,r));for(const n of C){const i=Tn(n,t.Cells);if(Pv&&(r?n.Row+o===t.RowNumbers.length-1:n.Col+o===t.ColumnNumbers.length-1)&&dT(t,n,r),t.Cells.splice(i,0,n),n.Merge){if(rv(n,t,r),!O){Io(n,t,Se.BorderPositionType.Right);continue}if(r?n.Merge.Rows===o:n.Merge.Columns===o){const o=lv(n,e,t,r);for(const e of o)m.push(e)}}}if(B)for(const e of p)t.Styles.splice(e.ID||0,0,e);if(H&&t.Fonts.push(...S),f&&(null==l?void 0:l.performDiagonalCascading)||kF(t,r),_I){const t=[];for(const e of m){const n=Tn(e,t);t.splice(n,0,e)}e.Cells=t}else e.Cells=m;M&&jI(e,m,r),Hv&&P&&jI(t,C,r,P),LF(t,r),a.countOfStylesMoved=y.size,a.countOfFontsMoved=R.size,a.countOfBorderStylesMoved=b.size,a.timeTaken=performance.now()-c}catch(e){return{isSuccess:!1,exception:e,metric:a}}return{isSuccess:!0,metric:a}}(e,t,n,o,i,a,l):function(e,t,n,o,r){const i={};try{const l=performance.now(),a=r?e.RowNumbers:e.ColumnNumbers,s=eF(a,n),d=RF(a,o,s);if(-1===d[0])return{isSuccess:!1,exception:"Incorrect rowColIndex found"};if(dF(e.Cells)&&dF(t.Cells))return i.timeTaken=performance.now()-l,r?rF(e,t,d):oF(e,t,d),kF(t,r),LF(e,r),{isSuccess:!0,metric:i};const c=[],u=[],h=[],g=e.ColumnNumbers.length,f=e.RowNumbers.length,C=o+1;e.ClientOnlyCache=void 0,t.ClientOnlyCache=void 0,(0,Se.preprocessModelStyles)(e),(0,Se.preprocessModelStyles)(t);for(let e=0;e<t.Cells.length;e++){const n=t.Cells[e];r?n.Row+=C:n.Col+=C;const i=n.Merge;Nv&&!Bt(i)&&i.SpansBlocks&&(r?n.Merge.OriginRow+=o+1:n.Merge.OriginColumn+=o+1)}for(let n=0;n<e.Cells.length;n++){const i=e.Cells[n];let l=!1,a={},u=!1,m=!1,p=!1;if(Nv&&(u=i.Merge&&i.Merge.SpansBlocks,m=i.Merge&&(JI(i,e)||ev(i)),p=i.Merge&&(ZI(i,e)||QI(i))),!SF(i,d,r)&&!Yv(i,s,o,r))continue;if(i.Merge)if(wF(i,s,o,r)){if(Nv&&i.Merge.SpansBlocks){dv(i,t,o,r);continue}}else a=kI(i),MF(i,e,o,l,r),l=!0;if(i.Merge&&l&&0!==Object.keys(a).length&&(MF(a,e,o,l,r),Nv&&u&&(sv(i,a,e,t,o,r),r&&p||!r&&m)))continue;l||c.push(i);const y=r?i.Row:i.Col;let S;S=l?a:kI(i),r?S.Merge&&l?S.Row=0:S.Row=y+C-f:S.Merge&&l?S.Col=0:S.Col=y+C-g,h.push(S)}r?rF(e,t,d):oF(e,t,d),AF(e,c),xF(e,u),xF(t,h),kF(t,r),function(e,t,n,o){(function(e,t,n){const o=e.Cells.filter((e=>n?e.Row===t:e.Col===t));for(let t=0;t<o.length;t++){const r=o[t];if(n){if(KI(r,e,Se.BorderPositionType.Bottom)){const t=io((0,Se.getBorderStyleByID)(r,e),e.BorderStyles.length,1),n=t.Borders.findIndex((e=>e.BorderPosition===Se.BorderPositionType.Bottom));-1!==n&&t.Borders.splice(n,1),r.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(t),e.BorderStyles.push(t),r.BorderStyleID=t.ID}}else if(KI(r,e,Se.BorderPositionType.Right)){const t=io((0,Se.getBorderStyleByID)(r,e),e.BorderStyles.length,1),n=t.Borders.findIndex((e=>e.BorderPosition===Se.BorderPositionType.Right));-1!==n&&t.Borders.splice(n,1),r.GlobalBorderStyleID=(0,Se.getGlobalBorderStyleMap)().getOrCreateID(t),e.BorderStyles.push(t),r.BorderStyleID=t.ID}}})(t,n,o),function(e,t,n){const o=n?e.RowNumbers.length-1:e.ColumnNumbers.length-1,r=e.Cells.filter((e=>n?e.Row===o:e.Col===o)),i=t.Cells.filter((e=>n?0===e.Row:0===e.Col));let l=0,a=0;for(;a<i.length;){const o=l<r.length?r[l]:null,s=i[a];n?o?o.Col===s.Col?(_v(o,s,e,t),l++,a++):o.Col<s.Col?l++:(_v(o,s,e,t),a++):(_v(o,s,e,t),a++):o?o.Row===s.Row?(Uv(o,s,e,t),l++,a++):o.Row<s.Row?l++:(Uv(o,s,e,t),a++):(Uv(o,s,e,t),a++)}}(e,t,o)}(e,t,o,r),LF(e,r),i.countOfStylesMoved=0,i.countOfFontsMoved=0,i.countOfBorderStylesMoved=0,i.timeTaken=performance.now()-l}catch(e){return{isSuccess:!1,exception:e,metric:i}}return{isSuccess:!0,metric:i}}(e,t,n,o,i)}(e,t,n,o,r,i,l)}static hideRowCols(e,t,n){return function(e,t,n){if(n)return!1;const o=eF(n?e.RowNumbers:e.ColumnNumbers,t);if(-1===o)return!1;if(dF(e.Cells))return cF(e,o),!0;const r=[];for(let t=0;t<e.Cells.length;t++){const i=e.Cells[t];i.Col===o||Zv(i,o,!1)?i.Merge&&(wF(i,o,0,n)||(bF(i,o,0,!1,!0,e),r.push(i))):(i.Col>o&&(i.Col-=1),r.push(i))}return cF(e,o),e.Cells=r,!0}(e,t,n)}static hideMultipleRowCols(e,t,n,o){return function(e,t,n,o){const r=o?e.RowNumbers:e.ColumnNumbers,i=eF(r,t),l=RF(r,n,i);if(-1===l[0])return!1;if(dF(e.Cells))return uF(e,l,o,!0),!0;const a=[],s=l[l.length-1];for(let t=0;t<e.Cells.length;t++){const r=e.Cells[t];SF(r,l,o)||Yv(r,i,n,o)?r.Merge&&(wF(r,i,n,o)||(bF(r,i,n,o,!0,e),r.Col>l[0]&&(r.Col-=n),a.push(r))):(o?r.Row>s&&(r.Row-=n+1):r.Col>s&&(r.Col-=n+1),a.push(r))}return uF(e,l,o,!0),e.Cells=a,!0}(e,t,n,o)}static performModelRowColOperation(e,t,n,o,r,i=!1){return function(e,t,n,o,r,i=!1){return zv=new Map,Gv=new Map,o===Vv.Hide||o===Vv.FreezePane||o===Vv.Delete?function(e,t,n,o,r,i=!1){const l=r===Vv.Hide||r===Vv.FreezePane,a=o?e.RowNumbers:e.ColumnNumbers,s=eF(a,t),d=RF(a,n,s);if(-1===d[0])return!1;if(dF(e.Cells))return uF(e,d,o,l),!0;const c=[],u=d[d.length-1],h=WF(e,o),g=_F(e,o);for(let i=0;i<e.Cells.length;i++){const m=e.Cells[i];if(EF(e,m,s,n,o,r,h,g),SF(m,d,o)||Yv(m,s,n,o))m.Merge&&(wF(m,s,n,o)?!Hv||s!==m.Col&&s!==m.Row||av(m,e,o):(!l&&FF(m,s,n,o,e)&&(m.Text=void 0),bF(m,s,n,o,l,e),o?m.Row>s&&(m.Row=s):m.Col>s&&(m.Col=s),c.push(m)));else{if(m.Merge&&!l){const e=a[d[d.length-1]]-t+1;var f,C;o?(null===(f=m.Merge)||void 0===f?void 0:f.OriginRow)&&0!==m.Merge.OriginRow&&(m.Merge.OriginRow-=Lv?e:n+1):(null===(C=m.Merge)||void 0===C?void 0:C.OriginColumn)&&0!==m.Merge.OriginColumn&&(m.Merge.OriginColumn-=Lv?e:n+1)}o?m.Row>u&&(m.Row-=n+1):m.Col>u&&(m.Col-=n+1),c.push(m)}}return Rv()&&r===Vv.FreezePane&&s>0&&function(e,t,n){const o=n-1,r=e.Cells.filter((e=>t?e.Row===o:e.Col===o)),i=e.Cells.filter((e=>t?e.Row===n:e.Col===n));let l=0,a=0;for(;l<i.length;){const n=a<r.length?r[a]:null,o=i[l];t?n?n.Col===o.Col?(_v(n,o,e,e),a++,l++):n.Col<o.Col?a++:(_v(n,o,e,e),l++):(_v(n,o,e,e),l++):n?n.Row===o.Row?(Uv(n,o,e,e),a++,l++):n.Row<o.Row?a++:(Uv(n,o,e,e),l++):(Uv(n,o,e,e),l++)}}(e,o,s),uF(e,d,o,l),e.Cells=[],xF(e,c),i&&LF(e,o),!0}(e,t,n,r,o,i):function(e,t,n,o,r,i=!1){const l=o?e.RowNumbers:e.ColumnNumbers,a=eF(l,t),s=RF(l,n,a);if(-1===s[0])return!1;if(dF(e.Cells))return o?fF(e,s):CF(e,s),!0;const d=[],c=WF(e,o),u=_F(e,o),h=[];for(let t=0;t<e.Cells.length;t++){const i=e.Cells[t];EF(e,i,a,n,o,r,c,u);const l=s[0]-1;let p=0,y=0;if(o){if(i.Row>=a){var g;r===Vv.Insert&&i.Merge&&(null===(g=i.Merge)||void 0===g?void 0:g.OriginRow)&&0!==i.Merge.OriginRow&&(i.Merge.OriginRow+=n+1),i.Row+=n+1,d.push(i);continue}if(i.Merge&&i.Row<a&&i.Row+i.Merge.Rows>=a){i.Merge.Rows+=n+1,d.push(i),Nv&&i.Merge.SpansBlocks&&h.push(i);continue}}else{if(i.Col>=a){var f;r===Vv.Insert&&i.Merge&&(null===(f=i.Merge)||void 0===f?void 0:f.OriginColumn)&&0!==i.Merge.OriginColumn&&(i.Merge.OriginColumn+=n+1),i.Col+=n+1,d.push(i);continue}if(i.Merge&&i.Col<a&&i.Col+i.Merge.Columns>=a){i.Merge.Columns+=n+1,d.push(i),Nv&&i.Merge.SpansBlocks&&h.push(i);continue}}if(-1===l){d.push(i);continue}o?i.Merge?i.Row+i.Merge.Rows===l&&(p=i.Merge.Columns+1,y=s.length):i.Row===l&&(p=1,y=s.length):i.Merge?i.Col+i.Merge.Columns===l&&(p=s.length,y=i.Merge.Rows+1):i.Col===l&&(p=s.length,y=1);const S=(0,Se.getCellStyleByID)(i,e);let R,w,b;if(i.HorizontalAlignmentSet)R=(0,Se.getGlobalCellStylesMap)().getOrCreateID(S),w=S;else{var C;const t=Oo(e)+1,n=oo(e,(0,Se.getCellStyleByID)(i,e),t,1);n.HorizontalAlignment=Se.HorizontalAlignment.Automatic,null===(C=e.Styles)||void 0===C||C.splice(t,0,n),R=(0,Se.getGlobalCellStylesMap)().getOrCreateID(n),w=n}let I=0,v=0;var m;y>0&&p>0&&(b=ZF(e,i,o),b&&(b.RefCount=Math.max(p,y),I=b.ID||0,null===(m=e.BorderStyles)||void 0===m||m.push(b)),v=void 0===b?0:(0,Se.getGlobalBorderStyleMap)().getOrCreateID(b));for(let e=0;e<y;e++)for(let t=0;t<p;t++){const n=o?s[0]+e:i.Row+e,r=o?i.Col+t:s[0]+t,l=(0,Se.getDefaultCell)(n,r);l.GlobalCellStyleID=R,l.CachedStyle=w,l.StyleID=w.ID||0,l.WrapText=i.WrapText,l.BorderStyleID=I,l.GlobalBorderStyleID=v,d.push(l)}d.push(i)}e.Cells=[],xF(e,d),o?fF(e,s):CF(e,s);for(const t of h)o?t.Merge.Height=tv(e.RowHeights,t.Row,t.Row+t.Merge.Rows):t.Merge.Width=tv(e.ColumnWidths,t.Col,t.Col+t.Merge.Columns);return i&&LF(e,o),!0}(e,t,n,r,o,i)}(e,t,n,o,r,i)}static cloneModel(e){return function(e){if(!e)return null;const t=e.ColumnNumbers?[...e.ColumnNumbers]:void 0,n=e.ColumnWidths?[...e.ColumnWidths]:void 0,o=e.ColumnOffsets?[...e.ColumnOffsets]:void 0,r=e.ColMetadata?[...e.ColMetadata]:void 0,i=e.FixedColumns?[...e.FixedColumns]:void 0,l=e.RowNumbers?[...e.RowNumbers]:void 0,a=e.RowHeights?[...e.RowHeights]:void 0,s=e.RowOffsets?[...e.RowOffsets]:void 0,d=[];if(e.Cells)for(let t=0;t<e.Cells.length;t++)d.push(kI(e.Cells[t]));const c=[];if(e.Styles)for(let t=0;t<e.Styles.length;t++){let n=e.Styles[t];n&&(n=ro(n,n.ID||0,n.RefCount||0)),c.push(n)}const u=[];if(e.BorderStyles)for(let t=0;t<e.BorderStyles.length;t++){let n=e.BorderStyles[t];n&&(n=io(n,n.ID||0,n.RefCount||0)),u.push(n)}const h=[];if(e.Fonts)for(let t=0;t<e.Fonts.length;t++){let n=e.Fonts[t];n&&(n=lo(n,n.ID||0,n.RefCount||0)),h.push(n)}const g=e.PrintAreas?[]:void 0;if(e.PrintAreas)for(let t=0;t<e.PrintAreas.length;t++)g.push(GI(e.PrintAreas[t]));const f=e.PivotTables?[]:void 0;if(e.PivotTables)for(let t=0;t<e.PivotTables.length;t++)f.push(VI(e.PivotTables[t]));const C=e.AllRichValueFields?[]:void 0;if(e.AllRichValueFields)for(let t=0;t<e.AllRichValueFields.length;t++)C.push({Index:(m=e.AllRichValueFields[t]).Index,RefersToDotFunction:m.RefersToDotFunction,Value:m.Value});var m;const p=[...e.RenderFlagsArray],y=e.RibbonCommands?{ShowAutoFilterMenu:(S=e.RibbonCommands).ShowAutoFilterMenu,CardViewShowTemporaryDataCard:S.CardViewShowTemporaryDataCard,CardViewShowTemporaryErrorCard:S.CardViewShowTemporaryErrorCard,CardViewHideTemporaryCard:S.CardViewHideTemporaryCard,CardViewShowDataCardOrDisambiguationPane:S.CardViewShowDataCardOrDisambiguationPane,ToggleInCellControlCheckbox:S.ToggleInCellControlCheckbox}:void 0;var S;const R=e.PageBreaks?{Row:(I=e.PageBreaks).Row?[...I.Row]:void 0,Col:I.Col?[...I.Col]:void 0}:void 0,w=e.Sparklines?function(e){const t=[];for(let o=0;o<e.Ranges.length;o++)t.push({LocationRow:(n=e.Ranges[o]).LocationRow,LocationColumn:n.LocationColumn,SparklineType:n.SparklineType,FirstRow:n.FirstRow,FirstColumn:n.FirstColumn,LastRow:n.LastRow,LastColumn:n.LastColumn,RangeType:n.RangeType});var n;return{Ranges:t,ImageUrl:e.ImageUrl,Version:e.Version}}(e.Sparklines):void 0,b=e.InCellImages?{ImageUrl:(v=e.InCellImages).ImageUrl,Version:v.Version}:void 0;var I,v;const F=e.PermissionSet?{IsAutoFilterDisabled:(T=e.PermissionSet).IsAutoFilterDisabled,IsSortDisabled:T.IsSortDisabled}:void 0;var T;const D=e.AdjacentBlocksHiddensInfo?{IsFirstColOfNextBlockHidden:(x=e.AdjacentBlocksHiddensInfo).IsFirstColOfNextBlockHidden,IsFirstRowOfNextBlockHidden:x.IsFirstRowOfNextBlockHidden,IsLastRowOfPrevBlockHidden:x.IsLastRowOfPrevBlockHidden,IsLastColOfPrevBlockHidden:x.IsLastColOfPrevBlockHidden}:void 0;var x;const A=e.RowOutlinesInformation?[]:void 0;if(e.RowOutlinesInformation)for(let t=0;t<e.RowOutlinesInformation.length;t++)A.push(EI(e.RowOutlinesInformation[t]));const B=e.ColumnOutlinesInformation?[]:void 0;if(e.ColumnOutlinesInformation)for(let t=0;t<e.ColumnOutlinesInformation.length;t++)B.push(EI(e.ColumnOutlinesInformation[t]));return{BlockWidth:e.BlockWidth,BlockHeight:e.BlockHeight,RowOffsets:s,ColumnOffsets:o,RowHeights:a,ColumnWidths:n,RowNumbers:l,ColumnNumbers:t,ColMetadata:r,FixedColumns:i,RowOutlinesInformation:A,ColumnOutlinesInformation:B,MaxRowOutlineLevelInSheet:e.MaxRowOutlineLevelInSheet,MaxColOutlineLevelInSheet:e.MaxColOutlineLevelInSheet,UniqueId:e.UniqueId,ShowGridLines:e.ShowGridLines,ShowHeaders:e.ShowHeaders,IsRtl:e.IsRtl,PermissionSet:F,GridLineColor:e.GridLineColor,BackgroundColor:e.BackgroundColor,Cells:d,Styles:c,Fonts:h,BorderStyles:u,CellsEncoding:e.CellsEncoding||0,RenderFlagsArray:p,HandleFlagsMismatch:e.HandleFlagsMismatch,PageBreaks:R,PrintAreas:g,PivotTables:f,Sparklines:w,InCellImages:b,AllRichValueFields:C,RibbonCommands:y,AdjacentBlocksHiddensInfo:D,HasTable:e.HasTable,HasOutline:e.HasOutline,IsBitwiseFixedRows:e.IsBitwiseFixedRows}}(e)}static getRenderedFontsTelemetry(){return il.documentFontsCheckCount=el,il}static getFlickeredFontsInBootPhase(){return za.forEach((e=>{ka.has(e)?Ea.add(e):hl(e)?La.add(e):Na.add(e)})),{defaultAptosFonts:Array.from(Ea),oldFonts:Array.from(La),newOrCustomFonts:Array.from(Na)}}static preprocessModelStyles(e){return(0,Se.preprocessModelStyles)(e)}static preprocessStyles(e){return(0,Se.processGlobalStyles)(e)}static isGlobalBorderStylesEnabled(e){return(0,Se.isGlobalBorderStylesEnabled)(e)}static isGlobalFontsAndCellStylesEnabled(){return(0,Se.isGlobalFontsAndCellStylesEnabled)()}static isGlobalBorderStylesEnabledNew(){return(0,Se.isGlobalBorderStylesEnabledNew)()}static getGlobalStylesTelemetry(){return(0,Se.getGlobalStylesTelemetry)()}static disableGlobalBorderStyles(e){return(0,Se.disableGlobalBorderStyles)(e)}static getFontsToDownload(e){return vb(e)}static getChangedCells(e,t){return function(e,t){const n=[];if(!e)return n;if(e.Cells&&0===e.Cells.length)return n;for(let o=0;o<e.Cells.length;o++){const r=e.Cells[o];if(!r)continue;const i=e.RowNumbers[r.Row],l=e.ColumnNumbers[r.Col];(r.Text||r.Value)&&(t(i,l)||zo(r,e,t))&&n.push({rowNum:i,colNum:l,cellText:""})}return n}(e,t)}static updateReferenceUpdateForModel(e,t,n,o){return function(e,t,n,o){const r=[];if(!e)return r;if(e.Cells&&0===e.Cells.length)return r;let i,l;for(let a=0;a<e.Cells.length;a++){const s=e.Cells[a];if(!s)continue;let d;const c=e.RowNumbers[s.Row],u=e.ColumnNumbers[s.Col];if(s.FormulaInfo&&s.FormulaInfo.FormulaType!==Se.CellFormulaType.Value){const n=o(s.FormulaInfo.Formula);if(n&&n.newFormula){if(s.FormulaInfo.Formula=n.newFormula,d=n.newFormula,s.CachedDisplayText=void 0,s.CachedDisplayTextRuns=void 0,n.isRefError){if(s.Text=t,s.HasIgnorableError=!0,s.ValueType=Se.CellValueType.Error,s.Value="4",d=t,!i){const{refErrorStyle:t,refErrorGlobalId:n}=Lo(e,s);i=t,l=n}No(s,i,l)}r.push({rowNum:c,colNum:u,cellText:d||s.Text||""});continue}}(s.Text||s.Value)&&(n(c,u)||zo(s,e,n))&&r.push({rowNum:c,colNum:u,cellText:s.Text||""})}return r}(e,t,n,o)}static removeExtraModelRowCol(e){return function(e){const t=e.ColumnNumbers.length,n=e.RowNumbers.length,o=Fv,r=Tv,i=[];if(t>r){var l,a,s,d,c;const n=t-r;if(null===(l=e.ColumnNumbers)||void 0===l||l.splice(r,n),null===(a=e.ColMetadata)||void 0===a||a.splice(r,n),null===(s=e.ColumnWidths)||void 0===s||s.splice(r,n),null===(d=e.FixedColumns)||void 0===d||d.splice(r,n),null===(c=e.ColumnOffsets)||void 0===c||c.splice(r,n),yF(e),!dF(e.Cells))for(const t of e.Cells)(t.Col>=r||t.Col>r)&&i.push(t)}if(n>o){var u,h,g,f;const t=n-o;if(null===(u=e.RowNumbers)||void 0===u||u.splice(o,t),null===(h=e.RowHeights)||void 0===h||h.splice(o,t),null===(g=e.RowOutlinesInformation)||void 0===g||g.splice(o,t),null===(f=e.RowOffsets)||void 0===f||f.splice(o,t),pF(e),!dF(e.Cells))for(const t of e.Cells)(t.Row>=o||t.Row>o)&&i.push(t)}AF(e,i)}(e)}static updateWithClientRowHeights(e,t){return function(e,t){if(t){for(let n=0;n<e.RowHeights.length;n++){const o=e.RowNumbers[n],r=t.get(o);!r||void 0!==r.serverHeight&&r.serverHeight!==e.RowHeights[n]||(r.serverHeight=e.RowHeights[n],e.RowHeights[n]=r.clientHeight)}Go(e)}}(e,t)}static removeRowHeightOverridesFromModel(e,t){return function(e,t){if(t){for(let n=0;n<e.RowHeights.length;n++){const o=e.RowNumbers[n],r=t.get(o);r&&r.serverHeight&&r.clientHeight===e.RowHeights[n]&&(e.RowHeights[n]=r.serverHeight)}Go(e)}}(e,t)}static getWholeSelectionHeadersStylesSet(){return Se.WholeSelectionHeadersStylesSet}static getPartialSelectionHeadersStylesSet(){return Se.PartiallySelectionHeadersStylesSet}static getHoverHeadersStylesSet(){return Se.HoverHeadersStylesSet}static updatedPageBreaksOfCurrentBlockPair(e,t,n,o,r,i){return function(e,t,n,o,r,i){var l,a,s,d;const c=r===Vv.Hide||r===Vv.Delete?-1*n:n,u=i?null==e||null===(l=e.PageBreaks)||void 0===l?void 0:l.Row:null==e||null===(a=e.PageBreaks)||void 0===a?void 0:a.Col,h=i?null==t||null===(s=t.PageBreaks)||void 0===s?void 0:s.Row:null==t||null===(d=t.PageBreaks)||void 0===d?void 0:d.Col,g=[],f=[],C=[];if(u){for(let t=0;t<u.length;t++)if(!qF(e,u[t],o,r,i))if($F(e,u[t],o,r,i,c),jF(e,u[t],i)){const n=i?e.RowNumbers.length:e.ColumnNumbers.length;u[t].Index+=r===Vv.Hide||r===Vv.Delete?n:-1*n,C.push(u[t])}else g.push(u[t]);XF(e,g,i)}if(h){for(let e=0;e<h.length;e++)qF(t,h[e],o,r,i)||($F(t,h[e],o,r,i,c),f.push(h[e]));XF(t,f,i)}!function(e,t,n,o){if(!e||0===t.length)return;if(e.PageBreaks||(e.PageBreaks={}),o&&!e.PageBreaks.Row)return void(e.PageBreaks.Row=t);if(!o&&!e.PageBreaks.Col)return void(e.PageBreaks.Col=t);const r=o?e.PageBreaks.Row:e.PageBreaks.Col;KF(n)?r.push(...t):r.unshift(...t)}(t,C,r,i),YF(e),YF(t)}(e,t,n,o,r,i)}static updatePrintAreasOfCurrentBlockPair(e,t,n,o,r,i){return function(e,t,n,o,r,i){const l=[];if(nT(e,o,n,r,i,l),Bv)return Bv=!1,!0;if(function(e,t,n,o){if(e&&0!==t.length)for(const r of t)o?KF(n)?(r.LastRow+=e.RowNumbers.length,r.FirstRow+=e.RowNumbers.length):(r.LastRow-=e.RowNumbers.length,r.FirstRow-=e.RowNumbers.length):KF(n)?(r.LastColumn+=e.ColumnNumbers.length,r.FirstColumn+=e.ColumnNumbers.length):(r.LastColumn-=e.ColumnNumbers.length,r.FirstColumn-=e.ColumnNumbers.length)}(t,l,r,i),e&&e.PrintAreas)for(const n of null==e?void 0:e.PrintAreas)oT(e,n,i)&&!sT(e,n,r,i)&&l.push(rT(e,t,n,r,i));return nT(t,o,n,r,i,l),Bv?(Bv=!1,!0):(e&&e.PrintAreas&&0===e.PrintAreas.length&&(e.PrintAreas=void 0),t&&t.PrintAreas&&0===t.PrintAreas.length&&(t.PrintAreas=void 0),!1)}(e,t,n,o,r,i)}static canvasInstance(){return gT.canvas||(gT.canvas=document.createElement("canvas")),gT.canvas}static offScreenCanvasInstance(){return gT.offScreenCanvas||(gT.offScreenCanvas=new OffscreenCanvas(1,1)),gT.offScreenCanvas}static canvasContext(){return gT.canvasInstance().getContext("2d")}static offScreenCanvasContext(){return gT.offScreenCanvasInstance().getContext("2d")}static isMergedCellSpanningAcrossBlocks(e){return function(e){const t=hv(e.Cells);if(0===t.length)return!1;for(const n of t)if(JI(n,e)&&ZI(n,e))return!0;return!1}(e)}}const fT="UnavailabilityToast";class CT{setVisibility(e){this.toastElement.style.visibility=e?"visible":"hidden"}dispose(){var e;null===(e=this.toastElement.parentNode)||void 0===e||e.removeChild(this.toastElement)}setTitle(e){e?this.toastTitleElement?this.toastTitleElement.innerText=e:(this.toastTitleElement=this.createToastTitle(e),this.toastElement.appendChild(this.toastTitleElement)):this.toastTitleElement&&(this.toastElement.removeChild(this.toastTitleElement),this.toastTitleElement=void 0)}setMessage(e){e?this.toastMessageElement?this.toastMessageElement.innerText=e:(this.toastMessageElement=this.createToastMessage(e),this.toastElement.appendChild(this.toastMessageElement)):this.toastMessageElement&&(this.toastElement.removeChild(this.toastMessageElement),this.toastMessageElement=void 0)}setIcon(e,t){this.hasSpinner=!!t,this.toastElement.removeChild(this.toastIconElement),this.toastIconElement=this.createToastIcon(e),this.toastElement.insertBefore(this.toastIconElement,this.toastElement.firstChild)}createToastContainer(){const e=document.createElement("div");return e.id=fT,e.setAttribute("role","alert"),e.setAttribute("style",'display: flex;\n      visibility: hidden;\n      padding: 12px 16px;\n      background-color: #FFF4CE;\n      color: #484644;\n      font-size: 14px;\n      line-height: 20px;\n      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.19);\n      border-radius: 4px;\n      font-family: "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif;\n      -webkit-touch-callout: none;\n      -webkit-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n      pointer-events: auto;\n      border: 2px solid transparent;'),e.appendChild(this.toastIconElement),e}createToastIcon(e){const t=document.createElement("span");if(t.id="UnavailabilityToastIcon",this.hasSpinner)!function(e,t){const n=document.createElement("div");n.id="UnavailbilitySpinner",n.setAttribute("style","border: 1.5px solid black;\n    border-top: 1.5px solid gray;\n    border-radius: 100%;\n    font-size: 12px;\n    width: 20px;\n    height: 20px;\n    -webkit-animation: spin 1.2s linear infinite; /* Safari */\n    animation: spin 1.2s linear infinite;"),t?n.style.marginLeft="7px":n.style.marginRight="7px";const o=document.createElement("style");o.type="text/css";const r=document.createTextNode("  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    20% { transform: rotate(50deg); }\n    70% { transform: rotate(270deg); }\n    100% { transform: rotate(360deg); }\n  }\n  \n  @-webkit-keyframes spin {\n    0% { -webkit-transform: rotate(0deg); }\n    20% { -webkit-transform: rotate(50deg); }\n    70% { -webkit-transform: rotate(270deg); }\n    100% { -webkit-transform: rotate(360deg); }\n  }\n  ");o.appendChild(r),n.appendChild(o),e.appendChild(n)}(t,this.isRTL);else{const n=null!=e?e:this.OpenWorkbookIcon;t.setAttribute("style",`display: inline-block;\n        height: 20px;\n        width: 20px;\n        background-repeat: no-repeat;\n        background-image: url("data:image/svg+xml;charset=utf8,${n}");`+this.elementsMargin)}return t}createToastTitle(e){const t=document.createElement("span");return t.id="UnavailabilityToastTitle",t.innerText=e,t.setAttribute("style","font-weight: 600;"+this.elementsMargin),t}createToastMessage(e){const t=document.createElement("span");return t.id="UnavailabilityToastText",t.innerText=e,t}constructor(e,t,n,o,r,i){this.OpenWorkbookIcon="%3Csvg%20width%3D%2220%22%20height%3D%2218%22%20viewBox%3D%220%200%2020%2018%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0D%0A%3Cpath%20d%3D%22M8.17383%207.24219C8.02409%207.48307%207.84831%207.70443%207.64648%207.90625C7.45117%208.10156%207.23307%208.27409%206.99219%208.42383L7.49023%209.63477L6.33789%2010.1035L5.83984%208.90234C5.57943%208.96745%205.29948%209%205%209C4.70052%209%204.42057%208.96745%204.16016%208.90234L3.66211%2010.1035L2.50977%209.63477L3.00781%208.42383C2.76693%208.27409%202.54557%208.10156%202.34375%207.90625C2.14844%207.70443%201.97591%207.48307%201.82617%207.24219L0.615234%207.74023L0.146484%206.58789L1.34766%206.08984C1.28255%205.82943%201.25%205.54948%201.25%205.25C1.25%204.95052%201.28255%204.67057%201.34766%204.41016L0.146484%203.91211L0.615234%202.75977L1.82617%203.25781C2.12565%202.76953%202.51953%202.37565%203.00781%202.07617L2.50977%200.865234L3.66211%200.396484L4.16016%201.59766C4.42057%201.53255%204.70052%201.5%205%201.5C5.29948%201.5%205.57943%201.53255%205.83984%201.59766L6.33789%200.396484L7.49023%200.865234L6.99219%202.07617C7.48047%202.37565%207.87435%202.76953%208.17383%203.25781L9.38477%202.75977L9.85352%203.91211L8.65234%204.41016C8.71745%204.67057%208.75%204.95052%208.75%205.25C8.75%205.54948%208.71745%205.82943%208.65234%206.08984L9.85352%206.58789L9.38477%207.74023L8.17383%207.24219ZM5%207.75C5.34505%207.75%205.66732%207.6849%205.9668%207.55469C6.27279%207.42448%206.53971%207.24544%206.76758%207.01758C6.99544%206.78971%207.17448%206.52604%207.30469%206.22656C7.4349%205.92057%207.5%205.59505%207.5%205.25C7.5%204.90495%207.4349%204.58268%207.30469%204.2832C7.17448%203.97721%206.99544%203.71029%206.76758%203.48242C6.53971%203.25456%206.27279%203.07552%205.9668%202.94531C5.66732%202.8151%205.34505%202.75%205%202.75C4.65495%202.75%204.32943%202.8151%204.02344%202.94531C3.72396%203.07552%203.46029%203.25456%203.23242%203.48242C3.00456%203.71029%202.82552%203.97721%202.69531%204.2832C2.5651%204.58268%202.5%204.90495%202.5%205.25C2.5%205.59505%202.5651%205.92057%202.69531%206.22656C2.82552%206.52604%203.00456%206.78971%203.23242%207.01758C3.46029%207.24544%203.72396%207.42448%204.02344%207.55469C4.32943%207.6849%204.65495%207.75%205%207.75ZM18.75%2012.125C18.75%2012.4831%2018.7044%2012.8444%2018.6133%2013.209L19.9512%2013.7559L19.4824%2014.918L18.1348%2014.3613C17.7507%2014.9993%2017.2428%2015.5072%2016.6113%2015.8848L17.168%2017.2227L16.0059%2017.7012L15.459%2016.3633C15.0944%2016.4544%2014.7331%2016.5%2014.375%2016.5C14.0169%2016.5%2013.6556%2016.4544%2013.291%2016.3633L12.7441%2017.7012L11.582%2017.2227L12.1387%2015.8848C11.5007%2015.5072%2010.9928%2014.9993%2010.6152%2014.3613L9.26758%2014.918L8.79883%2013.7559L10.1367%2013.209C10.0456%2012.8444%2010%2012.4831%2010%2012.125C10%2011.7669%2010.0456%2011.4056%2010.1367%2011.041L8.79883%2010.4941L9.26758%209.33203L10.6152%209.88867C10.9928%209.25716%2011.5007%208.74935%2012.1387%208.36523L11.582%207.01758L12.7441%206.54883L13.291%207.88672C13.6556%207.79557%2014.0169%207.75%2014.375%207.75C14.7331%207.75%2015.0944%207.79557%2015.459%207.88672L16.0059%206.54883L17.168%207.01758L16.6113%208.36523C17.2428%208.74935%2017.7507%209.25716%2018.1348%209.88867L19.4824%209.33203L19.9512%2010.4941L18.6133%2011.041C18.7044%2011.4056%2018.75%2011.7669%2018.75%2012.125ZM14.375%2015.25C14.8047%2015.25%2015.2083%2015.1686%2015.5859%2015.0059C15.9635%2014.8431%2016.2923%2014.6217%2016.5723%2014.3418C16.8587%2014.0553%2017.0833%2013.7233%2017.2461%2013.3457C17.4154%2012.9616%2017.5%2012.5547%2017.5%2012.125C17.5%2011.6953%2017.4154%2011.2917%2017.2461%2010.9141C17.0833%2010.5365%2016.8587%2010.2077%2016.5723%209.92773C16.2923%209.64128%2015.9635%209.41667%2015.5859%209.25391C15.2083%209.08464%2014.8047%209%2014.375%209C13.9453%209%2013.5384%209.08464%2013.1543%209.25391C12.7767%209.41667%2012.4447%209.64128%2012.1582%209.92773C11.8783%2010.2077%2011.6569%2010.5365%2011.4941%2010.9141C11.3314%2011.2917%2011.25%2011.6953%2011.25%2012.125C11.25%2012.5547%2011.3314%2012.9616%2011.4941%2013.3457C11.6569%2013.7233%2011.8783%2014.0553%2012.1582%2014.3418C12.4447%2014.6217%2012.7767%2014.8431%2013.1543%2015.0059C13.5384%2015.1686%2013.9453%2015.25%2014.375%2015.25Z%22%20fill%3D%22%23797775%22%2F%3E%0D%0A%3C%2Fsvg%3E",this.hasSpinner=null!=i&&i,this.isRTL=o,this.elementsMargin=o?"margin-left: 8px;":"margin-right: 8px;",this.toastIconElement=this.createToastIcon(r),this.toastElement=this.createToastContainer(),this.setTitle(t),this.setMessage(n),e.appendChild(this.toastElement)}}class mT{static createInstance(e,t,n,o,r,i){return new CT(e,t,n,o,r,i)}}function pT(e,t){return e?t(e)?e:pT(e.parentElement,t):null}var yT=r(91);let ST;class RT{static getInstance(){return ST||(ST=new RT),ST}showToast(e,t,n,o,r,i,l,a){if(!this.isToastVisible()||a){if(this.toast)this.toast.setIcon(o,r),this.toast.setTitle(e),this.toast.setMessage(t);else{const l=document.createElement("div");l.setAttribute("style",(e=>`position: absolute;\n        display: flex;\n        z-index: 2000;\n        left: 0px;\n        right: 0px;\n        top: ${e?"40px":"8px"};\n        margin: auto;\n        align-items: center;\n        justify-content: center;\n        pointer-events: none;\n        opacity : 0;\n        transition: opacity 0.35s;\n        transition-timing-function: ease-in;`)(i)),document.body.appendChild(l),this.toast=mT.createInstance(l,e,t,n,o,r),requestAnimationFrame((()=>{l.style.opacity="1"}))}this.isToastVisible()||(this.toast.setVisibility(!0),this.isVisible=!0),this.logToastVisibilityChange(!0,l),this.displayTime=window.performance.now()}}dismissToast(e){var t;this.isToastVisible()&&(null===(t=this.toast)||void 0===t||t.setVisibility(!1),this.isVisible=!1,this.logToastVisibilityChange(!1,e),this.displayTime=void 0)}isToastVisible(){var e,t;return(0,yT.isChangeGateEnabled)("SharedOnline.ChangeGate.IsToastVisibleModified")?this.isVisible||"visible"===(null===(t=document.getElementById(fT))||void 0===t?void 0:t.style.visibility)&&!pT(document.getElementById(fT),(e=>"none"===getComputedStyle(e).display)):this.isVisible||"visible"===(null===(e=document.getElementById(fT))||void 0===e?void 0:e.style.visibility)}logToastVisibilityChange(e,t){let n="Unavailability Toast Visibility Changed: "+(e?"Shown":"Dismissed");!e&&this.displayTime&&(n+=`, Duration Visible: ${Math.trunc(window.performance.now()-this.displayTime)}`),t&&(n+=`, Kind: ${t}`),vr.Hv.sendTraceTag(537249949,Fr.n.msoulscat_Wac_Telemetry,C.k.Info,n)}constructor(){this.toast=void 0,this.isVisible=!1}}return i}()}));