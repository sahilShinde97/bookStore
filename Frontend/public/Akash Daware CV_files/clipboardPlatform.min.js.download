function asyncGeneratorStep(e,t,r,a,o,i,n){try{var s=e[i](n),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(a,o)}function _async_to_generator(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var i=e.apply(t,r);function n(e){asyncGeneratorStep(i,a,o,n,s,"next",e)}function s(e){asyncGeneratorStep(i,a,o,n,s,"throw",e)}n(void 0)}))}}function _define_property(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),a.forEach((function(t){_define_property(e,t,r[t])}))}return e}var clipboardPlatform=function(e){var t={};function r(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(a,o,function(t){return e[t]}.bind(null,o));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=47)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.replaceChildren=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;const a=r(5);t.utils=a;const o=r(2);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return o.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return o.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return o.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return o.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return o.ConsoleLogger}});const i=r(7);t.browserSupport=i;const n=r(8);t.perfWatch=n;const s=r(10);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return s.initStopwatchFactory}});const c=r(11);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return c.TelemetryCollector}});var l=r(12);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return l.getNewGuid}});var d=r(13);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return d.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return d.TextAreaInputMode}});var u=r(14);Object.defineProperty(t,"replaceChildren",{enumerable:!0,get:function(){return u.replaceChildren}})},function(e,t,r){"use strict";r.d(t,"mc",(function(){return s})),r.d(t,"Eb",(function(){return c})),r.d(t,"Hb",(function(){return y})),r.d(t,"Ib",(function(){return C})),r.d(t,"Nb",(function(){return E})),r.d(t,"a",(function(){return L})),r.d(t,"D",(function(){return w})),r.d(t,"B",(function(){return T})),r.d(t,"t",(function(){return _})),r.d(t,"u",(function(){return I})),r.d(t,"M",(function(){return P})),r.d(t,"A",(function(){return A})),r.d(t,"K",(function(){return O})),r.d(t,"N",(function(){return j})),r.d(t,"L",(function(){return x})),r.d(t,"b",(function(){return M})),r.d(t,"m",(function(){return W})),r.d(t,"H",(function(){return R})),r.d(t,"c",(function(){return $})),r.d(t,"e",(function(){return U})),r.d(t,"J",(function(){return F})),r.d(t,"gc",(function(){return N})),r.d(t,"Db",(function(){return H})),r.d(t,"Mb",(function(){return B})),r.d(t,"Jb",(function(){return K})),r.d(t,"Lb",(function(){return q})),r.d(t,"Kb",(function(){return X})),r.d(t,"Gb",(function(){return Q})),r.d(t,"Ab",(function(){return Y})),r.d(t,"jb",(function(){return l})),r.d(t,"bc",(function(){return d})),r.d(t,"ac",(function(){return u})),r.d(t,"Yb",(function(){return m})),r.d(t,"Zb",(function(){return g})),r.d(t,"i",(function(){return p})),r.d(t,"j",(function(){return ee})),r.d(t,"p",(function(){return te})),r.d(t,"E",(function(){return re})),r.d(t,"k",(function(){return ae})),r.d(t,"q",(function(){return oe})),r.d(t,"F",(function(){return ie})),r.d(t,"P",(function(){return ne})),r.d(t,"hb",(function(){return se})),r.d(t,"ib",(function(){return ce})),r.d(t,"lc",(function(){return le})),r.d(t,"Cb",(function(){return de})),r.d(t,"hc",(function(){return ue})),r.d(t,"ic",(function(){return me})),r.d(t,"Wb",(function(){return ge})),r.d(t,"Xb",(function(){return pe})),r.d(t,"Rb",(function(){return fe})),r.d(t,"Vb",(function(){return be})),r.d(t,"Ub",(function(){return he})),r.d(t,"Qb",(function(){return Se})),r.d(t,"Sb",(function(){return ye})),r.d(t,"Tb",(function(){return Ce})),r.d(t,"qb",(function(){return Ee})),r.d(t,"sb",(function(){return Le})),r.d(t,"ob",(function(){return we})),r.d(t,"nb",(function(){return Te})),r.d(t,"R",(function(){return _e})),r.d(t,"mb",(function(){return Ie})),r.d(t,"lb",(function(){return Pe})),r.d(t,"pb",(function(){return Ae})),r.d(t,"tb",(function(){return Oe})),r.d(t,"g",(function(){return xe})),r.d(t,"r",(function(){return De})),r.d(t,"f",(function(){return f})),r.d(t,"n",(function(){return b})),r.d(t,"I",(function(){return h})),r.d(t,"d",(function(){return S})),r.d(t,"s",(function(){return Me})),r.d(t,"xb",(function(){return Ze})),r.d(t,"qc",(function(){return et})),r.d(t,"C",(function(){return nt})),r.d(t,"kc",(function(){return st})),r.d(t,"bb",(function(){return ct})),r.d(t,"U",(function(){return lt})),r.d(t,"kb",(function(){return dt})),r.d(t,"S",(function(){return mt})),r.d(t,"z",(function(){return gt})),r.d(t,"Pb",(function(){return pt})),r.d(t,"oc",(function(){return ft})),r.d(t,"T",(function(){return bt})),r.d(t,"pc",(function(){return ht})),r.d(t,"h",(function(){return yt})),r.d(t,"V",(function(){return Et})),r.d(t,"W",(function(){return _t})),r.d(t,"X",(function(){return St})),r.d(t,"ab",(function(){return Pt})),r.d(t,"cb",(function(){return At})),r.d(t,"Fb",(function(){return Ot})),r.d(t,"nc",(function(){return jt})),r.d(t,"dc",(function(){return xt})),r.d(t,"yb",(function(){return Dt})),r.d(t,"O",(function(){return Mt})),r.d(t,"fb",(function(){return $t})),r.d(t,"db",(function(){return Ut})),r.d(t,"gb",(function(){return Nt})),r.d(t,"eb",(function(){return Jt})),r.d(t,"v",(function(){return zt})),r.d(t,"Ob",(function(){return Ht})),r.d(t,"ub",(function(){return Vt})),r.d(t,"vb",(function(){return Gt})),r.d(t,"wb",(function(){return Bt})),r.d(t,"l",(function(){return Kt})),r.d(t,"G",(function(){return qt})),r.d(t,"o",(function(){return Xt})),r.d(t,"rb",(function(){return Qt})),r.d(t,"Q",(function(){return Yt})),r.d(t,"zb",(function(){return Be})),r.d(t,"Z",(function(){return tr})),r.d(t,"x",(function(){return rr})),r.d(t,"Y",(function(){return Zt})),r.d(t,"w",(function(){return er})),r.d(t,"y",(function(){return ar})),r.d(t,"cc",(function(){return We})),r.d(t,"ec",(function(){return $e})),r.d(t,"fc",(function(){return Re})),r.d(t,"Bb",(function(){return o})),r.d(t,"jc",(function(){return a}));var a={};r.r(a),r.d(a,"sharedClipboardSettingsVariableName",(function(){return Ue})),r.d(a,"defaultPromiseTimeoutInMinutes",(function(){return Fe})),r.d(a,"getSharedClipboardSettings",(function(){return ke})),r.d(a,"initializeSharedClipboardSettingsFromWindow",(function(){return ze})),r.d(a,"initializeSharedClipboardSettings",(function(){return He})),r.d(a,"createEmptySharedClipboardSettings",(function(){return Ge}));var o={};r.r(o),r.d(o,"divTagName",(function(){return cr})),r.d(o,"preTagName",(function(){return lr})),r.d(o,"tableTagName",(function(){return dr})),r.d(o,"trTagName",(function(){return ur})),r.d(o,"tdTagName",(function(){return mr})),r.d(o,"ccpTimestampHtmlCustomAttributeName",(function(){return hr})),r.d(o,"minCcpTimestampHtmlCustomAttributeValue",(function(){return Sr})),r.d(o,"ensureOneLFPerNewLine",(function(){return yr})),r.d(o,"trimToLength",(function(){return Cr})),r.d(o,"createTextHtmlFromTextPlain",(function(){return Er})),r.d(o,"createHtmlItemFromTextPlain",(function(){return vr})),r.d(o,"createPlainTextFromHtml",(function(){return Lr})),r.d(o,"isContainsTimestampWrapper",(function(){return Tr})),r.d(o,"addClipboardWrapperForEdge",(function(){return _r})),r.d(o,"getFragmentFromTextHtml",(function(){return Ir})),r.d(o,"getCcpTimestampHtmlCustomAttributeFromWrappingTag",(function(){return Pr})),r.d(o,"getExternalSource",(function(){return Ar})),r.d(o,"encodeAngleBrackets",(function(){return Or})),r.d(o,"wrapContentWithTagAndAttributes",(function(){return jr}));var i=r(0);let n;function s(){return n}function c(e){if(!e)throw new Error("The 'logger' argument is missing");n=i.ULS.getFromExternalLogger(e)}const l="",d=" ",u=".",m="1",g="1";var p,f,b,h,S;function y(e,t){return C(e,[t])}function C(e,t){if(!function(e){return!(!e||"object"!=typeof e||!("reason"in e))&&!!function(e){if(!e&&0!==e)return!1;const t=Number(e);return!isNaN(t)&&t.toString()===e.toString()}(e.reason)}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;const r=e.reason;return t.indexOf(r)>=0}function E(e){if(e&&"object"==typeof e){if(v(e.reason))return!0;if(e.innerError&&"string"==typeof e.innerError)try{if(v(JSON.parse(e.innerError).reason))return!0}catch(e){}}if("string"==typeof e)try{if(v(JSON.parse(e).reason))return!0}catch(e){}return!1}function v(e){return e===f.LocalStorageInitilizationInaccessible}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory",e[e.AsyncSystemClipboard=8]="AsyncSystemClipboard",e[e.AsyncSystemClipboardAndLocalStorage=9]="AsyncSystemClipboardAndLocalStorage",e[e.AsyncSystemClipboardAndInMemory=10]="AsyncSystemClipboardAndInMemory"}(p||(p={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage"}(f||(f={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(b||(b={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext"}(h||(h={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(S||(S={}));class L extends Error{static augmentParameterValue(e){return e&&"string"==typeof e?e.trim():l}constructor(e,t,r){const a=L.augmentParameterValue(e);if(super(a),this.name=L.augmentParameterValue(t),this.errorName=this.name,this.name?s().ULS.traceTag(596456211,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Error '${this.name}': ${a}`):s().ULS.traceTag(596456212,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error message: "+a),r){this.innerError=r;let e=this.innerError.message;e||(e=this.innerError.name);const t=L.augmentParameterValue(e);t.length>0&&s().ULS.traceTag(596456213,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Inner error message: "+t)}this.stack||(this.stack=(new Error).stack)}}class w extends L{constructor(e,t){super(e,"NoValidKeyError",t)}}class T extends L{static getDefaultMessage(e){let t="Missing argument";return e.length>0&&(t=`Missing argument: '${e}'`),t}constructor(e,t,r){const a=L.augmentParameterValue(t),o=T.getDefaultMessage(a);let i=L.augmentParameterValue(e);0===i.length&&(i=o),super(i,"MissingArgumentError",r),this.name=a}}class _ extends L{static getDefaultMessage(e,t){return e.length>0?`Invalid '${e}' argument: '${t}'`:"Invalid argument"}constructor(e,t,r,a){const o=L.augmentParameterValue(t);let i=r;i||(i=l);const n=_.getDefaultMessage(o,i);let s=L.augmentParameterValue(e);0===e.length&&(s=n),super(s,"InvalidArgumentError",a),this.name=o,this.value=i}}class I extends L{constructor(e,t){super(e,"InvalidOperationError",t)}}class P extends L{constructor(e,t){super(e,"UnsupportedError",t)}}class A extends L{constructor(e,t,r,a,o){super(`${e}. Data version: ${t}, Infra version: ${r}, blockMismatchDataVersion: ${a}`,"MismatchVersionError",o)}}class O extends L{constructor(e,t,r,a){super(`${e}. Duration in clipboard (ms) : ${t}, TTL (ms): ${r}`,"TTLClipboardDataError",a)}}class j extends L{constructor(e,t,r,a){super(`${e}. Data User Hash : ${t}, infra User Hash: ${r}`,"UserHashMismatchError",a)}}class x extends L{constructor(e,t){super(e,"UnexpectedError",t)}}function D(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:l}class M extends L{constructor(e,t,r,a,o){super(t||"reason="+e,r,a),this.reason=e,o&&(this.errorName=o)}}class W extends M{constructor(e,t,r){super(e,t,"CopyError",r,D(e,b))}}class R extends M{constructor(e,t,r){super(e,t,"PasteError",r,D(e,h))}}class $ extends M{constructor(e,t,r){super(e,t,"CancelError",r,D(e,S))}}class U extends M{constructor(e,t,r){super(e,t,"ClipboardPlatformError",r,D(e,f))}}class F extends M{constructor(e,t,r){super(e,t,"SharedClipboardError",r,D(e,f))}}function N(e){if(!e||!Array.isArray(e)||0===e.length)return void s().ULS.traceTag(596456214,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: no actions to execute");let t=0,r=void 0;if(e.forEach(e=>{if(t+=1,e)try{e()}catch(e){s().ULS.traceTag(596456216,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`rethrowAfterAllActions: callback action #${t} threw an exception: ${e.message}`),r||(r=new I(e.message,e))}else s().ULS.traceTag(596456215,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`rethrowAfterAllActions: callback action #${t} is empty`)}),r)throw r}function J(){return k}const k={userAgent:()=>window&&window.navigator?window.navigator.userAgent:l,appVersion:()=>window&&window.navigator?window.navigator.appVersion:l};let z={};function H(){z={}}const V=new RegExp("(\\bTrident/| MSIE )"),G=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function B(){if(void 0===z.isIEProperty){z.isIEProperty=!1;const e=J();if(e&&e.userAgent&&"function"==typeof e.userAgent){const t=e.userAgent();if(t){const e=t.match(V);e&&2===e.length&&(z.isIEProperty=!0)}}}return z.isIEProperty}function K(){if(void 0===z.isEdgeProperty){z.isEdgeProperty=!1,z.isEdgeWithTextHtmlClipboardSupportProperty=!1,z.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;const e=J();if(e&&e.appVersion&&"function"==typeof e.appVersion){const t=e.appVersion();if(t){const e=t.match(G);if(e&&2===e.length){z.isEdgeProperty=!0;const t=Number(e[1]);isNaN(t)||(t>=16.16299&&(z.isEdgeWithTextHtmlClipboardSupportProperty=!0),t>=17.17123&&(z.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return z.isEdgeProperty}function q(){return K()&&z.isEdgeWithTextHtmlClipboardSupportProperty}function X(){return K()&&z.isEdgeVersionWithTextHtmlWrapperSupportProperty}function Q(){const e=J();let t=!1;if(e&&e.userAgent){const r=e.userAgent();r&&r.indexOf("Edg/")>=0&&(t=!0)}return t}function Y(){return Z}const Z={postMessage:(e,t,r,a)=>{e.postMessage(t,r,a)}},ee="copy",te="cut",re="paste",ae="copy",oe="cut",ie="paste",ne=(e,t,r,a=!1)=>(e.addEventListener(t,r,a),()=>{e.removeEventListener(t,r,a)}),se="text/plain",ce="Text",le="text/html",de="image/png",ue="data/shadow-workbook",me="web data/shadow-workbook",ge="metadata/is-last-copy-was-external",pe="metadata/is-last-copy-was-external-XLO-source",fe="metadata/chrome-extension-id",be="metadata/ccp-infra-version",he="copyId",Se="metadata/additional-signature-data-attributes",ye="metadata/copy-context",Ce="web metadata/copy-context";function Ee(){return{items:{}}}const ve=function(){const e={items:{}};return{getData:()=>e,getItem:e=>{},setItem:(e,t)=>{throw new I(`Cannot set an item with clipboard data format '${e}' in an immutable empty clipboard (content is ${t&&t.length>0?"not ":l}empty)`)},hasDeferredItem:e=>!1,getDeferredItem:e=>{},get:()=>je(void 0)}}();function Le(){return ve}function we(e){return e&&e.items?Object.keys(e.items).length:0}function Te(e){return we(e&&e.getData())}function _e(e){let t=e;t||(t={items:{}});const r=e=>Ie(t,e);return{getItem:r,setItem:(e,r)=>{!function(e,t,r){if(!e)throw new T(l,"clipboardItemsData");if(!e.items)throw new _(l,"clipboardItemsData.items");e.items[t]=r}(t,e,r)},hasDeferredItem:e=>{const t=r(e);return t&&t.length>0},getDeferredItem:e=>Promise.resolve(r(e)),getData:()=>t,get:()=>je(t)}}function Ie(e,t){if(!e)throw new T(l,"clipboardItemsData");if(!e.items)throw new _(l,"clipboardItemsData.items");return e.items[t]}function Pe(e,t){if(!e||0===e.length||!t||!t.trim())return l;let r=void 0;return e.forEach(e=>{e.clipboardDataFormat===t&&(r=e.data)}),r||l}function Ae(e){return Pe(e,se)}function Oe(e){let t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:se,data:l}),t}function je(e){const t=[];if(0===we(e))return t;for(const r in e.items){let a=Ie(e,r);a||(a=l);const o={clipboardDataFormat:r,data:a,deferred:!1};t.push(o)}return t}var xe,De,Me;!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage",e[e.AsyncSystemClipboard=4]="AsyncSystemClipboard"}(xe||(xe={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PictureInCell=2048]="PictureInCell",e[e.ColumnWidths=4096]="ColumnWidths",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink",e[e.PastePictureInCell=2052]="PastePictureInCell",e[e.PasteWithColumnWidths=4100]="PasteWithColumnWidths"}(De||(De={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(Me||(Me={}));const We="BulsEndpointUrl",Re="WacCluster",$e="usid",Ue="sharedClipboardSettings",Fe=2;let Ne=Ge(),Je=!1;function ke(){if(!Je)throw new I("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return Ne}function ze(){Je=!1,function(){if(!window||!(Ue in window))return Ne=Ge(),void(Je=!0);const e=window[Ue];if(!e||"object"!=typeof e)return Ne=Ge(),void(Je=!0);Ve(e)}()}function He(e){Je=!1,Ve(e)}function Ve(e){if(!e)throw new T(l,"sharedClipboardSettingsCandidate");const t=Ge();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return Ne=t,void(Je=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return s().ULS.traceTag(596124181,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),Ne=t,void(Je=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();let r=t.sharedClipboardHostingApp;const a=r.indexOf("-");a>=0&&(r=r.substr(a+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch(t){s().ULS.traceTag(579737680,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some(e=>!e||!e.trim()))return s().ULS.traceTag(596124182,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp=l,t.sharedClipboardHostingApps=[],Ne=t,void(Je=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch(t){s().ULS.traceTag(579737681,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some(e=>!e||!e.trim()))return s().ULS.traceTag(596124183,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp=l,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],Ne=t,void(Je=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return s().ULS.traceTag(596124184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=l,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],Ne=t,void(Je=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return s().ULS.traceTag(596124185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' or '${r}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=l,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],Ne=t,void(Je=!0)}t.whitelistOriginComponents=!0,Ne=t,Je=!0}function Ge(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:l,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:1,sharedClipboardExpirationInMinutes:3600,clipboardPromiseTimeoutInMinutes:Fe,remoteLoggerPath:l}}function Be(){let e=l;return window&&window.location&&window.location.origin?(e=window.location.origin,e||(e=l)):(s().ULS.traceTag(595932950,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`windowLocation.getWindowLocation: is window exist: ${!!window}. is window.location exist: ${window&&!!window.location}. is window.location.origin exist ${window&&window.location&&!!window.location.origin}. is window.location.protocol exist ${window&&window.location&&!!window.location.protocol}. is window.location.hostname exist ${window&&window.location&&!!window.location.hostname}. is window.location.port exist ${window&&window.location&&!!window.location.port}`),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}const Ke=new RegExp("^\\d+$");let qe,Xe,Qe=!1;function Ye(e){if(!e)throw new T(l,"origin");const t=e.trim().toLowerCase();let r=l,a=t.split("://",3);if(!a||0===a.length||!a[0]||"http"!==a[0]&&"https"!==a[0])throw new _("Missing protocol","origin",e);if(1===a.length)throw new _("Missing domain","origin",e);if(a.length>2)throw new _("'://' should appear once","origin",e);let o=a[1];if(!o)throw new _("Missing domain","origin",e);if(r=a[0]+"://",o=o.trim(),a=o.trim().split("/",3),!a||0===a.length||!a[0]||!a[0].trim())throw new _("Missing domain","origin",e);if(a.length>2)throw new _("The last part of the origin should be the domain","origin",e);if(2===a.length&&a[1])throw new _("The last part of the origin should be the domain","origin",e);if(a=o.split(":",3),!a||0===a.length||!a[0]||!a[0].trim())throw new _("Missing domain","origin",e);if(a.length>2||2===a.length&&(!a[1]||!a[1].trim()))throw new _("The last part of the origin should be the domain and an optional port number","origin",e);if(o=a[0].trim(),r+=o,2===a.length){const t=a[1].trim(),o=Ke.exec(t);if(!o||1!==o.length)throw new _("Invalid port number","origin",e);const i=Number(t);if(isNaN(i))throw new _("Invalid port number","origin",e);r+=":"+t}return s().ULS.traceTag(596452423,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`getValidatedOrigin: origin = '${e}'; validated origin = '${r}'`),r}function Ze(e){ot();const t=Ye(e);let r=t.split("://");if(!r||2!==r.length||!r[0]||!r[1])throw new _("Invalid origin","parentOrigin",e);const a=ke();let o=l;if(a.whitelistOriginComponents){const t=r[0]+"://";if(r=r[1].split("."),!r||r.length<2||!r[0])throw new _("Invalid origin","parentOrigin",e);r.splice(0,1,a.sharedClipboardHostingApp),o=t+r.join(".")}else o=t;return s().ULS.traceTag(596452424,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`getSharedClipboardValidatedOrigin: app's origin = '${e}'; Shared Clipboard iframe origin = '${o}' components=${JSON.stringify(r)}`),o}function et(e){ot();const t=Ye(e),r=Ye(Be().origin);if(t===r)return t;if(!ke().whitelistOriginComponents)throw new I(`validateOriginForReceivedMessage: Caller origin '${e}' doesn't match the current window's origin '${r}'`);const a=tt(t),o=tt(r);if(a.protocol!==o.protocol)throw new I(`validateRemoteWindowOrigin: Caller origin's protocol '${a.protocol}' doesn't match the current window origin's protocol '${o.protocol}'`);if(a.environment!==o.environment)throw new I(`validateRemoteWindowOrigin: Caller origin's environment '${a.environment}' doesn't match the current window origin's environment '${o.environment}'`);return t}function tt(e){ot();const t=e.split("://",2),r=t[0],a=rt(t[1]),o={protocol:r};if(o.environment=at(e,a,Xe),a.length<=o.environment.length+1)throw new _("Missing app component","origin",e);if("."!==a.charAt(o.environment.length))throw new _("Missing a domain separator after the environment component","origin",e);const i=a.substr(o.environment.length+".".length);if(o.app=at(e,i,qe),o.app.length<i.length&&"-"!==i.charAt(o.app.length))throw new _("When the Office Online app name is not the domain prefix, '-' should precede it","origin",e);return o}function rt(e){if(!e)throw new T(l,"stringToReverse");const t=e.length;let r=l;for(let a=t-1;a>=0;a-=1)r+=e.charAt(a);return r}function at(e,t,r){if(!t)throw new T(l,"reversedValidatedHostname");if(!r)throw new T(l,"reversedStringsToLengthMap");const a=t.length,o=Object.keys(r).filter(e=>{const o=r[e];return o<=a&&t.substr(0,o)===e});if(o&&o.length>0)return rt(o[0]);throw new _("Invalid origin","validatedOrigin",e)}function ot(){if(Qe)return;const e=ke();e.whitelistOriginComponents&&(qe=it(e.sharedClipboardHostingApps),Xe=it(e.sharedClipboardHostingEnvironments),Qe=!0)}function it(e){const t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach(e=>{t[rt(e)]=e.length}),t):t}const nt=1;function st(e,t){return null==e||e===nt||null==t||e!==t}function ct(){return ut()}function lt(){return ut()}function dt(e){if(!e)throw new T(l,"id");const t=e.trim().toLowerCase();if(0===t.length)throw new _(l,"id");return t}function ut(){return(Math.random()+1).toString(36).substring(7)}function mt(e,t,r,a,o){const i={id:e,operationCode:t,destination:r,userHash:a,clipboardItemsData:o};return ft(i),i}class gt{}function pt(e){return"get"===e||"set"===e||"init"===e}gt.localStorageData="localStorage/data",gt.localStorageMetadata="localStorage/metadata",gt.initIframe="initIframe";const ft=function(e){if(!e)throw new T(l,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new T(l,"id");if(!e.operationCode)throw new T(l,"operationCode");if(!e.destination)throw new T(l,"destination");if(!pt(e.operationCode))throw new _(l,"operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new _(`'${e.operationCode}' expects no clipboard items`,"clipboardItemsData")};function bt(e,t,r,a,o){const i={id:e,operationCode:t,failed:r,error:a,clipboardItemsData:o};return ht(i),i}const ht=function(e){if(!e)throw new T(l,"clipboardOperationResultMessage");const t=["failed","error","clipboardItemsData","operationCode","id","userHash"];let r=!1;for(const a of t)if(e.hasOwnProperty(a)){r=!0;break}if(!r)throw new w("clipboardOperationResultMessage has no valid key");if(!e.id||0===e.id.trim().length)throw s().ULS.traceTag(553747865,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`Missing argument 'id'. keys: ${JSON.stringify(Object.keys(e))}, isConstructorObject: ${e.constructor===Object}, operationCode: ${e.operationCode}, id: ${e.id}, failed: ${e.failed}, error: ${e.error}.`),new T(l,"id");if(!e.operationCode)throw new T(l,"operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new _(l,"operationCode",e.operationCode);if(e.failed){if(!e.error)throw new _(`A failed '${e.operationCode}' operation expects a non-empty error argument`,"error");if(e.clipboardItemsData)throw new _(`A failed '${e.operationCode}' operation does not expect a clipboardItemsData argument`,"clipboardItemsData")}else{if(e.error)throw new _(`'${e.operationCode}' expects an empty error argument`,"error");if("unknownresult"===e.operationCode)throw new _(`'${e.operationCode}' can only be used with a failure message`,"operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new _(`'${e.operationCode}' expects a clipboardItems argument`,"clipboardItemsData")}else if(e.clipboardItemsData)throw new _(`'${e.operationCode}' expects no clipboardItemsData argument`,"clipboardItemsData")};function St(e){if(!e||0===e.trim().length)throw new _(l,"className",e);return(()=>{let t=!1;function r(t){return`${e}:${t}: already disposed`}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&s().ULS.traceTag(596456217,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new I(r(e))}}})()}class yt{initialize(e){return e.then(e=>(this.clipboardStorage=e,s().ULS.traceTag(596453007,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Clipboard strategy type '${this.clipboardStrategyType}' was initialized.`),Promise.resolve(this)),e=>(s().ULS.traceTag(596453008,i.LogCategory.msoulscat_ES_EWAJS,E(e)?i.TraceLevel.Info:i.TraceLevel.Error,`Failed to initialize clipboard strategy type '${this.clipboardStrategyType}'. Error: ${i.utils.getStringifiedError(e)}`),Promise.reject(e)))}set(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){const e="ClipboardStrategyBase.set: this.clipboardStorage should be defined";return s().ULS.shipAssertTag(596121485,i.LogCategory.msoulscat_ES_EWAJS,!1,e),Promise.reject(new U(f.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new U(f.SetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).set`,e))}}get(e){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){const e="ClipboardStrategyBase.get: this.clipboardStorage should be defined";return s().ULS.shipAssertTag(596121486,i.LogCategory.msoulscat_ES_EWAJS,!1,e),Promise.reject(new U(f.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then(e=>(this.clipboardDataProcessor&&this.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e))).catch(t=>{throw s().ULS.traceTag(507848131,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`ClipboardStrategyBase.get - Failed to get clipboard items. Command id: ${e.id}, Error: ${i.utils.getStringifiedError(t)}`),t})}catch(e){return Promise.reject(new U(f.GetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).get`,e))}}onSystemClipboardChangedExternally(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(Le(),e):(s().ULS.shipAssertTag(595882508,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new U(f.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new U(f.ClearClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).onSystemClipboardChangedExternally`,e))}}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())}constructor(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=St(""+e)}}const Ct=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function Et(e){let t=e;return t&&0!==t.trim().length||(t=ct()),new Tt(t)}function vt(){return Ct?window.performance.now():Date.now()}function Lt(e){return Ct?new Date(e+window.performance.timing.navigationStart):new Date(e)}function wt(e,t,r){if(!r)throw new T(l,"creationTimestamp");return`${e?"Fulfilled":"Still unfulfilled"} after ${e?t?t-r:"?":vt()-r}ms`}class Tt{fulfilled(){return this.isFulfilled}resolve(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):s().ULS.traceTag(596456257,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`Deferred promise - resolve: the resolve for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}reject(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):s().ULS.traceTag(596456260,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`Deferred promise - reject: the reject for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}markAsFulfilled(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=vt(),s().ULS.traceTag(596456261,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Deferred promise: marking promise #${this.sequenceId} with id '${this.id}' as fulfilled (${this.rejected?"rejected":"resolved"}). ${wt(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`))}fulfillmentCheck(e){return s().ULS.traceTag(596456258,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Deferred promise: asked to ${e} deferred promise #${this.sequenceId} with id '${this.id}'`),this.isFulfilled&&s().ULS.traceTag(596456259,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`Deferred promise: cannot ${e} deferred promise #${this.sequenceId} with id '${this.id}' since it was ${this.rejected?"rejected":"resolved"} already on ${Lt(this.fulfillmentTimestamp)}. ${wt(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`),this.isFulfilled}constructor(e){this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=dt(e),Tt.sequenceId+=1,this.sequenceId=Tt.sequenceId,this.creationTimestamp=vt(),s().ULS.traceTag(596456225,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Deferred promise: creating deferred promise #${this.sequenceId} with id '${this.id}' on ${Lt(this.creationTimestamp)}`),this.promise=new Promise((e,t)=>{s().ULS.traceTag(596456226,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Deferred promise: registering callback for promise #${this.sequenceId} with id '${this.id}' on ${Lt(vt())}`),this.internalResolve=e,this.internalReject=t})}}function _t(){return new It}Tt.sequenceId=0;class It{getDeferredPromise(e){const t=dt(e);return this.deferredResultMessagePromiseCache[t]}getPromise(e){const t=this.getDeferredPromise(e);if(t)return s().ULS.traceTag(596456218,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Deferred promise cache: found a deferred promise with id '${e}'.`),t.promise;s().ULS.traceTag(596456219,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Deferred promise cache: there is no deferred promise with id '${e}'.`)}addNewPromise(e){const t=Et(e);if(this.getDeferredPromise(t.id))throw new _("A deferred promise already exists in the cache for the specified id","id",t.id);const r=dt(t.id);return this.deferredResultMessagePromiseCache[r]=t,s().ULS.traceTag(596456220,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Deferred promise cache: added a new deferred promise with id '${t.id}'.`),t}getLength(){let e=0;for(const t in this.deferredResultMessagePromiseCache)e+=1;return e}delete(e){if(!this.getDeferredPromise(e))return void s().ULS.traceTag(596456221,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Deferred promise cache: no need to delete an item with id '${e}' since this id is not associated with an existing deferred promise.`);const t=dt(e);delete this.deferredResultMessagePromiseCache[t],s().ULS.traceTag(596456222,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Deferred promise cache: deleted id '${e}'.`)}clear(){if(s().ULS.traceTag(596456223,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Deferred promise cache: clearing ${this.getLength()} items from the cache`),this.deferredResultMessagePromiseCache)for(const e in this.deferredResultMessagePromiseCache){const t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){s().ULS.traceTag(596456224,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`Deferred promise cache: clear failed to reject promise id '${e}' with this exception: ${t.message}. Ignoring.`)}}this.deferredResultMessagePromiseCache={}}constructor(){this.deferredResultMessagePromiseCache={}}}function Pt(e){if(!e)throw new T(l,"validator");return{deserialize:t=>function(e,t){if(!e)throw new T(l,"incomingMessage");if(!t)throw new T(l,"validator");if(0===e.length)throw new _("An empty message is invalid","incomingMessage");const r=e.trim();if(0===r.length)throw new _("A message cannot contain only spaces","incomingMessage");let a;try{a=JSON.parse(r)}catch(t){throw new _("Deserialization failed","incomingMessage",`Contains ${e.length.toString()} characters`,t)}if(!a)throw new _("Deserialization returned nothing","incomingMessage");return t(a),a}(t,e)}}function At(e){if(!e)throw new T(l,"validator");return{serialize:t=>function(e,t){if(!e)throw new T(l,"outgoingMessage");if(!t)throw new T(l,"validator");return t(e),function(e){let t;try{t=JSON.stringify(e)}catch(t){throw new _("Serialization failed","outgoingMessage",Object.keys(e).length+" properties",t)}return s().ULS.traceTag(596452375,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"The length of the serialized message is "+t.length),t}(e)}(t,e)}}const Ot="initmessageid",jt="unknownmessageid",xt="CreatorOrigin";function Dt(e){if(!e)throw new T(l,"remoteWindow");if(!("window"in e)||!e.window)throw new T(l,"remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new T(l,"remoteWindow.windowOrigin");const t=et(e.windowOrigin);return{window:e.window,windowOrigin:t}}class Mt{get disposableImplementationExtension(){return this._disposableImplementationExtension}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(N([()=>{this.sender&&this.sender.dispose()},()=>{this.receiver&&this.receiver.dispose()}]),this.disposableImplementationExtension.dispose())}postMessage(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new T(l,"outgoingMessage");if(!this.sender){const e="WindowRPCBase::postMessage - this.sender should be defined";throw s().ULS.shipAssertTag(596121484,i.LogCategory.msoulscat_ES_EWAJS,!1,e),new I(e)}this.sender.postMessage(e)}constructor(e,t,r,a){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=St(a)}}function Wt(){return Rt}const Rt={addEventListener:(e,t)=>window.addEventListener(e,t),removeEventListener:(e,t)=>window.removeEventListener(e,t)};function $t(e,t,r){return new Ft(e,t,r)}function Ut(e,t,r){return new Ft(e,t,r)}class Ft{dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(Wt().removeEventListener("message",this.windowMessageHandler),this.disposableImplementationExtension.dispose())}shouldFilterMessageEvent(e){try{if(!e.origin||!e.source)return s().ULS.traceTag(596452370,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return s().ULS.traceTag(596452371,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return s().ULS.traceTag(596452372,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return s().ULS.traceTag(596452373,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1}onMessageReceived(e){if(this.shouldFilterMessageEvent(e))return;let t=void 0;try{t=this.deserializer.deserialize(e.data)}catch(e){s().ULS.traceTag(596452374,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: unable to deserialize incoming message. "+i.utils.getStringifiedError(e));try{this.handler.handleDeserializationError(e)}catch(e){s().ULS.traceTag(596452184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to handle deserialization error. "+i.utils.getStringifiedError(e))}return}if(t)try{this.handler.handleMessage(t).catch(e=>{s().ULS.traceTag(595985880,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))})}catch(e){s().ULS.traceTag(596452186,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))}else s().ULS.traceTag(596452185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: the incoming message is empty")}constructor(e,t,r){if(this.deserializer=e,this.handler=t,this.windowMessageHandler=e=>this.onMessageReceived(e),!e)throw new T(l,"deserializer");if(!t)throw new T(l,"handler");if(!r)throw new T(l,"windowRPC");this.disposableImplementationExtension=St("WindowRPCReceiverInternal"),this.remoteWindow=Dt(r.remoteWindow),Wt().addEventListener("message",this.windowMessageHandler)}}function Nt(e,t){return new kt(e,t)}function Jt(e,t){return new kt(e,t)}class kt{postMessage(e){if(!e)throw new T(l,"outgoingMessage");if(!this.remoteWindow.window)throw new I("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new I("The remote window does not support postMessage");const t=this.serializer.serialize(e);Y().postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e,t,r=!1){if(this.serializer=e,this.delayedQueueEnabled=r,!e)throw new T(l,"serializer");if(!t)throw new T(l,"windowRPC");this.disposableImplementationExtension=St("WindowRPCSenderInternal"),this.remoteWindow=Dt(t.remoteWindow)}}const zt="_LocalStorageChangedFlag";function Ht(){try{const e="XLO_CCP",t="1";return localStorage.setItem(e,t),localStorage.getItem(e)===t}catch(e){return!1}}function Vt(e){return"OfficeOnlineCCP_Data_"+e}function Gt(e){return"OfficeOnlineCCP_Metadata_"+e}function Bt(e){return Gt(e)+zt}class Kt{constructor(){this.copyStatus=Xt.Started,this.isTimestampStoredInSystemClipboard=!1,this.isAsyncSerializeFailed=!1,this.succeededPopulatingSystemClipboardSync=void 0,this.succeededPopulatingSystemClipboardAsync=void 0,this.isFullSheetCopy=!1}}class qt{profilingMessage(e){const t=i.perfWatch.timeStamp()-this.startTime;return`onPasteProfiling: ${e}, pasteId: ${this.id}, timeMS: ${t.toFixed()}`}constructor(){this.startTime=i.perfWatch.timeStamp()}}var Xt;function Qt(){return{}}function Yt(e){let t=void 0;return e&&e.lastCopy&&(t=_object_spread({},e.lastCopy)),{lastCopy:t}}function Zt(e){try{s().ULS.traceTag(595716237,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Attempting to create clipboard storage type '${xe.LocalStorage}'`);const t=new er(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(Xt||(Xt={}));class er{get(e){this.disposableImplementationExtension.throwIfDisposed("get"),s().ULS.traceTag(595716238,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`localStorageClipboardStorage.get: commandParameters.id='${e?e.id:l}'`);const t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(Le());try{const e=JSON.parse(t);if(!e||0===we(e))return Promise.resolve(Le());const r=_e(e);return Promise.resolve(r)}catch(e){return Promise.resolve(Le())}}set(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),s().ULS.traceTag(595716239,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`localStorageClipboardStorage.set: item count=${Te(e)}'; commandParameters.id='${t?t.id:l}'`),0===Te(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));const r=""+(this.localStorageKey+zt),a=ct();return s().ULS.traceTag(595654546,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`localStorageClipboardStorage.set: set local storage value. eventFalgKey = ${r}. eventFlagValue = ${a}`),localStorage.setItem(r,a),Promise.resolve()}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[se,le,"data/shadow-workbook"]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new U(f.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: failed access to localStorage",e)}if(!e)throw new U(f.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=xe.LocalStorage,this.disposableImplementationExtension=St("LocalStorageClipboardStorage")}}function tr(e){return s().ULS.traceTag(595716236,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Attempting to create clipboard strategy type '${p.LocalStorage}' with localStorageKey: '${e}'`),(new rr).initialize(Zt(e))}class rr extends yt{constructor(e){super(p.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},e)}}class ar{onStorageChanged(e){s().ULS.shipAssertTag(595716249,i.LogCategory.msoulscat_ES_EWAJS,null!=e,"e should not be null"),s().ULS.traceTag(595716288,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = ${e.key}. localStorageKeyToWatch = ${this.localStorageKeyToWatch}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),s().ULS.traceTag(595716289,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = "+this.lastLocalStorageValue),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then(()=>{this.raiseMetadataChangedEvent()},()=>{s().ULS.traceTag(595716295,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")}))}raiseMetadataChangedEvent(){return s().ULS.traceTag(595715525,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = "+this.lastLocalStorageValue),this.clipboardStrategy.get({userHash:0}).then(e=>{this.listener(e),s().ULS.traceTag(595716232,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = "+this.lastLocalStorageValue)},e=>{s().ULS.traceTag(595716233,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")})}isLocalStorageValueChanged(){const e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return s().ULS.traceTag(595715526,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = ${this.lastLocalStorageValue}. currentLocalStorageValue = ${e}`),this.lastLocalStorageValue=e,t}waitForLocalStorageValueToChange(e){if(s().ULS.traceTag(595715527,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = "+this.lastLocalStorageValue),this.isLocalStorageValueChanged())return s().ULS.traceTag(595715528,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = "+this.lastLocalStorageValue),Promise.resolve();const t=Et(),r=new Date,a=setInterval(()=>{const o=(new Date).getTime()-r.getTime();s().ULS.traceTag(595715529,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = ${r}. elapseTime = ${o}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()?(clearInterval(a),s().ULS.traceTag(595716234,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = ${r}. elapseTime = ${o}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.resolve()):o>e&&(clearInterval(a),s().ULS.traceTag(595716235,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = ${r}. elapseTime = ${o}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.reject())},200);return t.promise}constructor(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}}const or=new RegExp("(\n\r)|(\r\n)|(\r)","g"),ir=new RegExp("(\t)","g"),nr=new RegExp("<","g"),sr=new RegExp(">","g"),cr="div",lr="pre",dr="table",ur="tr",mr="td",gr="\x3c!--StartFragment--\x3e".length,pr="\x3c!--EndFragment--\x3e".length,fr="Version:0.9\nStartHTML:0000000100\nEndHTML:{EndHTML0}\nStartFragment:0000000134\nEndFragment:{EndFragm}\n<html>\n<body>\n\x3c!--StartFragment--\x3e\n",br="</html>".length,hr="data-ccp-timestamp",Sr=0;function yr(e){return e?e.replace(or,"\n"):e}function Cr(e){return e?e.length<=10240?e:e.substr(0,10240):l}function Er(e){var t;const r=function(e){return e?e.replace(or,`</${mr}></${ur}><${ur}><${mr}>`):e}((t=Or(e))?t.replace(ir,`</${mr}><${mr}>`):t);return`<${dr}><${ur}><${mr}>${r}</${mr}></${ur}></${dr}>`}function vr(e,t,r){if(r!==Sr&&!r)throw new T(l,"timestamp");if(isNaN(r))throw new _(l,"timestamp",r.toString());return _r(function(e,t,r){return`<${e} ${hr}='${r}'>${t}</${e}>`}(e,Er(t),r))}function Lr(e){const t=[],r=e.getElementsByTagName("tr");if(r.length>0){const e=wr(r[0]);t.push(e);for(let e=1;e<r.length;e+=1){t.push("\r"),t.push("\n");const a=wr(r[e]);t.push(a)}}return t.join("")}function wr(e){const t=[],r=e.getElementsByTagName("td");if(r.length>0){t.push(r[0].innerText);for(let e=1;e<r.length;e+=1)t.push("\t"),t.push(r[e].innerText)}return t.join("")}function Tr(e){return!!(e&&e.firstChild&&e.firstElementChild)&&!!e.firstElementChild.getAttribute(hr)}function _r(e){if(!K()||X())return e;const t="0000000000".length,r=fr.length+e.length+"\x3c!--EndFragment--\x3e\n</body>\n</html>".length;let a=(r-"\x3c!--EndFragment--\x3e\n</body>\n</html>".length).toString();if(a.length<t&&(a="0000000000".substr(0,t-a.length)+a),a.length!==t){const e=`addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Fragment xml comment is ${a.length} but it should be ${t}`;throw s().ULS.shipAssertTag(596128536,i.LogCategory.msoulscat_ES_EWAJS,!1,e),new U(f.UnexpectedClipboardTextHtmlContentLength,e)}let o=(r-br).toString();if(o.length<t&&(o="0000000000".substr(0,t-o.length)+o),o.length!==t){const e=`addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Html tag is ${o.length} but it should be ${t}`;throw s().ULS.shipAssertTag(596128537,i.LogCategory.msoulscat_ES_EWAJS,!1,e),new U(f.UnexpectedClipboardTextHtmlContentLength,e)}const n=fr.replace("{EndHTML0}",o).replace("{EndFragm}",a)+e+"\x3c!--EndFragment--\x3e\n</body>\n</html>";return s().ULS.shipAssertTag(596128538,i.LogCategory.msoulscat_ES_EWAJS,n.length===r,`addClipboardWrapperForEdge: The resulting text/html payload length of ${n.length} differs from the expected length of ${r}`),n}function Ir(e){if(!e)return l;if(!e.trim())return e;const t=e.indexOf("\x3c!--StartFragment--\x3e"),r=e.indexOf("\x3c!--EndFragment--\x3e");if(t<0||r<0||t>r)return e;const a=t+gr,o=r-a,i=e.indexOf("\x3c!--StartFragment--\x3e",a),n=e.indexOf("\x3c!--EndFragment--\x3e",r+pr);return i>=0||n>=0?e:e.substr(a,o)}function Pr(e){const t=function(e,t){if(!e||!e.trim())return;if(!t||!t.trim())throw new T(l,"attributeName");const r=new RegExp(t+"=['\"](\\d+)['\"]","i").exec(e);return!r||r.length<2?void 0:r[1]}(e,hr);if(!t||!t.trim())return;const r=Number(t);return!r&&r!==Sr||isNaN(r)?void 0:r}function Ar(e){if(!e||!e.trim())return;const t=(new DOMParser).parseFromString(e,"text/html"),r=function(e){const t=e.getElementsByTagName("meta");for(let e=0;e<t.length;e+=1){const r=t[e];if("ProgId"===r.getAttribute("name")){const e=r.getAttribute("content");if(null!==e){if(e.length>64)return void s().ULS.shipAssertTag(595683460,i.LogCategory.msoulscat_ES_EWAJS,!1,"ProgID longer than 64 characters");if(e.startsWith("Word"))return"Word Desktop";if(e.startsWith("Excel"))return"Excel Desktop";if(e.startsWith("PowerPoint"))return"PowerPoint Desktop";if(e.startsWith("OneNote"))return"OneNote Desktop";s().ULS.traceTag(595683457,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"htmlClipboardItem.getOfficeDesktopOrigin: unrecognized ProgId content")}return}}}(t);if(void 0!==r)return r;const a=function(e){if(null===e||null===e.body||null===e.body.children||0===e.body.children.length)return;const t=e.body.children[0];if(null!=t&&null!=t.classList)for(let e=0;e<t.classList.length;e+=1){const r=t.classList[e];if(r.startsWith("SCXO"))return"OneNote Online";if(r.startsWith("SCXP"))return"PowerPoint Online";if(r.startsWith("SCXW"))return"Word Online"}}(t);return void 0!==a?a:function(e){if(null===e)return!1;const t=e.getElementsByTagName("b");if(0===t.length)return!1;const r=t[0];return!(null==r||null==r.id||null==r.id.startsWith||!r.id.startsWith("docs-internal-guid-"))}(t)?"Google Docs":void 0}function Or(e){return e?e.replace(nr,"&lt;").replace(sr,"&gt;"):l}function jr(e,t,r){let a="";return r&&(a=Object.keys(r).reduce((e,t)=>t?`${e} ${t}='${r[t]}'`:e,"")),`<${t}${a}>${e}</${t}>`}},function(e,t,r){"use strict";var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(a||(t.TraceLevel=a={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(o||(t.LogCategory=o={})),t.ULS={getFromExternalLogger:function(e){const t=e;return{ULS:{trace:(e,r,a)=>t.traceTag(0,e,r,a),traceTag:(e,r,a,o)=>t.traceTag(e,r,a,o),debugTrace:(e,r,a)=>t.debugTraceTag(0,e,r,a),debugTraceTag:(e,r,a,o)=>t.debugTraceTag(e,r,a,o),assert:(e,r,a)=>t.assertTag(0,e,r,a),assertTag:(e,r,a,o)=>t.assertTag(e,r,a,o),shipAssert:(e,r,a)=>t.shipAssertTag(0,e,r,a),shipAssertTag:(e,r,a,o)=>t.shipAssertTag(e,r,a,o),dnmTrace:(e,r,a)=>t.dnmTraceTag(0,e,r,a),dnmTraceTag:(e,r,a,o)=>t.dnmTraceTag(e,r,a,o)}}}},t.ConsoleLogger=class{shipAssertTag(e,t,r,a){console.assert(r,"shipAssertTag:",e,t,a)}assertTag(e,t,r,a){console.assert(r,"assertTag",e,t,a)}traceTag(e,t,r,a){console.log("traceTag",e,a,t,r)}dnmTraceTag(e,t,r,a){console.log("dnmTraceTag",e,a,t,r)}debugTraceTag(e,t,r,a){console.log("debugTraceTag",e,a,t,r)}},t.NulLogger=class{shipAssertTag(){}assertTag(){}traceTag(){}debugTraceTag(){}dnmTraceTag(){}}},function(e,t,r){"use strict";let a;r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));const o=e=>{a=e},i=(e,t=!1)=>a?a.getBooleanFeatureGate(e,t):t},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce((e,a)=>e.then(()=>r&&r.stop?Promise.resolve(void 0):t(a,r)),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r=0){if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;const a={};Object.getOwnPropertyNames(t).forEach(e=>{"stack"!==e&&e.toUpperCase()!==e&&(a[e]=t[e])});const o=Object.getPrototypeOf(t);o&&"object"==typeof o&&Object.keys(o).forEach(e=>{"stack"!==e&&e.toUpperCase()!==e&&(a[e]=t[e])});const i={};return Object.keys(a).forEach(t=>{i[t]=e(a[t],r+1)}),i}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};const a=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";let t=e.trim().substring(0,200).trim().replace(a,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));let r=Promise.reject();for(let a=1;a<=t;a+=1)r=r.catch(t=>e(a,t));return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();let r=t(e[0]);for(let a=1;a<e.length;a+=1){const o=e[a];r=r.catch(()=>t(o))}return r},t.getQueryParameterByName=function(e,t){const r=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;let t=5381,r=t;const a=e.length;for(let o=0;o<a&&(t=4294967295&((t<<5)+t^e.charCodeAt(o)),o!==a-1);o+=2)r=4294967295&((r<<5)+r^e.charCodeAt(o+1));let o=t+35685*r+(23896*r<<16)&4294967295;return o<0&&(o+=4294967296),o}},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;const a={};t.promises=function(){return void 0===a.promises&&(a.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),a.promises}},function(e,t,r){"use strict";function a(){const e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function o(e,t,r){e[t]=a()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){const t=a(),r=e,i=t,n={},s=(e,t,a)=>function(e,t,r,a,i,n){o(e,"end",r);const s={sessionName:t,result:a?"success":"failure",message:n,marks:e};i(JSON.stringify(s))}(n,r,i,e,t,a);return n.start=0,{mark:e=>(e=>o(n,e,i))(e),end:e=>s(!0,e),success:(e,t)=>s(!0,e,t),failure:(e,t)=>s(!1,e,t)}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=a},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;let a=()=>Date.now();t.initStopwatchFactory=function(e,t=1){return"undefined"!=typeof self&&self.performance&&self.performance.now&&(a=()=>self.performance.now()),function(r){let o=a(),i=r;return{reset(e){null!=e&&(i=e),o=a()},stop(r){const n=a()-o,s=JSON.stringify({Target:i,Duration:n.toFixed(t),StopInfo:r});e(s)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0,t.TelemetryCollector=class{getJsonForLogging(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"}addEvent(e,t){null!=e&&null!=t&&(this.events[e]=t)}clearEvents(){this.events={}}getEventsLoggableString(){return JSON.stringify(this.events)}incrementCounter(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)}getCountersLoggableString(){return JSON.stringify(this.counters)}clearCounters(){this.counters={}}startTimer(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})}endTimer(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)}getTimerDuration(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"}getTimersLoggableString(){return JSON.stringify(this.timers)}constructor(){this.counters={},this.timers={},this.events={}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){const e=new Uint8Array(31),t=function(e){const t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof crypto?crypto:"undefined"!=typeof msCrypto?msCrypto:void 0;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}let a=!1;const o="undefined"!=typeof performance?performance:void 0;try{o&&o.now&&o.now()!==1/0&&(a=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(let r=0;r<e.length;r+=1){try{if(a){t.perfNow=!0;let e=Math.floor(100*o.now())%10;(e<0||e>9)&&(e=0);for(let t=0;t<e;t+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[r]=Math.floor(16*Math.random())}return t}(e);let r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const a=15&e[r];return r+=1,("x"===t?a:3&a|8).toString(16)}),t]}},function(e,t,r){"use strict";var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(a||(t.TextAreaVirtualKeyboardPolicy=a={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(o||(t.TextAreaInputMode=o={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=e=>{if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=e=>!!e.replaceChildren},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(17);a.__exportStar(r(18),t),a.__exportStar(r(28),t),a.__exportStar(r(19),t),a.__exportStar(r(29),t),a.__exportStar(r(30),t),a.__exportStar(r(31),t)},function(e,t,r){/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */e.exports=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,r){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,r)}function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function a(e,o,i){return(a=r()?Reflect.construct:function(e,r,a){var o=[null];o.push.apply(o,r);var i=new(Function.bind.apply(e,o));return a&&t(i,a.prototype),i}).apply(null,arguments)}function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,void 0):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var n=Object.hasOwnProperty,s=Object.setPrototypeOf,c=Object.isFrozen,l=Object.getPrototypeOf,d=Object.getOwnPropertyDescriptor,u=Object.freeze,m=Object.seal,g=Object.create,p="undefined"!=typeof Reflect&&Reflect,f=p.apply,b=p.construct;f||(f=function(e,t,r){return e.apply(t,r)}),u||(u=function(e){return e}),m||(m=function(e){return e}),b||(b=function(e,t){return a(e,o(t))});var h,S=A(Array.prototype.forEach),y=A(Array.prototype.pop),C=A(Array.prototype.push),E=A(String.prototype.toLowerCase),v=A(String.prototype.toString),L=A(String.prototype.match),w=A(String.prototype.replace),T=A(String.prototype.indexOf),_=A(String.prototype.trim),I=A(RegExp.prototype.test),P=(h=TypeError,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return b(h,t)});function A(e){return function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];return f(e,t,a)}}function O(e,t,r){var a;r=null!==(a=r)&&void 0!==a?a:E,s&&s(e,null);for(var o=t.length;o--;){var i=t[o];if("string"==typeof i){var n=r(i);n!==i&&(c(t)||(t[o]=n),i=n)}e[i]=!0}return e}function j(e){var t,r=g(null);for(t in e)!0===f(n,e,[t])&&(r[t]=e[t]);return r}function x(e,t){for(;null!==e;){var r=d(e,t);if(r){if(r.get)return A(r.get);if("function"==typeof r.value)return A(r.value)}e=l(e)}return function(e){return console.warn("fallback value for",e),null}}var D=u(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),M=u(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),W=u(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),R=u(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),$=u(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),U=u(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),F=u(["#text"]),N=u(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),J=u(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),k=u(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),z=u(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),H=m(/\{\{[\w\W]*|[\w\W]*\}\}/gm),V=m(/<%[\w\W]*|[\w\W]*%>/gm),G=m(/\${[\w\W]*}/gm),B=m(/^data-[\-\w.\u00B7-\uFFFF]/),K=m(/^aria-[\-\w]+$/),q=m(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),X=m(/^(?:\w+script|data):/i),Q=m(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Y=m(/^html$/i),Z=function(){return"undefined"==typeof window?null:window},ee=function(t,r){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var a=null;r.currentScript&&r.currentScript.hasAttribute("data-tt-policy-suffix")&&(a=r.currentScript.getAttribute("data-tt-policy-suffix"));var o="dompurify"+(a?"#"+a:"");try{return t.createPolicy(o,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};return function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z(),a=function(e){return t(e)};if(a.version="2.4.7",a.removed=[],!r||!r.document||9!==r.document.nodeType)return a.isSupported=!1,a;var i=r.document,n=r.document,s=r.DocumentFragment,c=r.HTMLTemplateElement,l=r.Node,d=r.Element,m=r.NodeFilter,g=r.NamedNodeMap,p=void 0===g?r.NamedNodeMap||r.MozNamedAttrMap:g,f=r.HTMLFormElement,b=r.DOMParser,h=r.trustedTypes,A=d.prototype,te=x(A,"cloneNode"),re=x(A,"nextSibling"),ae=x(A,"childNodes"),oe=x(A,"parentNode");if("function"==typeof c){var ie=n.createElement("template");ie.content&&ie.content.ownerDocument&&(n=ie.content.ownerDocument)}var ne=ee(h,i),se=ne?ne.createHTML(""):"",ce=n,le=ce.implementation,de=ce.createNodeIterator,ue=ce.createDocumentFragment,me=ce.getElementsByTagName,ge=i.importNode,pe={};try{pe=j(n).documentMode?n.documentMode:{}}catch(e){}var fe={};a.isSupported="function"==typeof oe&&le&&void 0!==le.createHTMLDocument&&9!==pe;var be,he,Se=H,ye=V,Ce=G,Ee=B,ve=K,Le=X,we=Q,Te=q,_e=null,Ie=O({},[].concat(o(D),o(M),o(W),o($),o(F))),Pe=null,Ae=O({},[].concat(o(N),o(J),o(k),o(z))),Oe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),je=null,xe=null,De=!0,Me=!0,We=!1,Re=!0,$e=!1,Ue=!1,Fe=!1,Ne=!1,Je=!1,ke=!1,ze=!1,He=!0,Ve=!1,Ge="user-content-",Be=!0,Ke=!1,qe={},Xe=null,Qe=O({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ye=null,Ze=O({},["audio","video","img","source","image","track"]),et=null,tt=O({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),rt="http://www.w3.org/1998/Math/MathML",at="http://www.w3.org/2000/svg",ot="http://www.w3.org/1999/xhtml",it=ot,nt=!1,st=null,ct=O({},[rt,at,ot],v),lt=["application/xhtml+xml","text/html"],dt="text/html",ut=null,mt=n.createElement("form"),gt=function(e){return e instanceof RegExp||e instanceof Function},pt=function(t){ut&&ut===t||(t&&"object"===e(t)||(t={}),t=j(t),be=be=-1===lt.indexOf(t.PARSER_MEDIA_TYPE)?dt:t.PARSER_MEDIA_TYPE,he="application/xhtml+xml"===be?v:E,_e="ALLOWED_TAGS"in t?O({},t.ALLOWED_TAGS,he):Ie,Pe="ALLOWED_ATTR"in t?O({},t.ALLOWED_ATTR,he):Ae,st="ALLOWED_NAMESPACES"in t?O({},t.ALLOWED_NAMESPACES,v):ct,et="ADD_URI_SAFE_ATTR"in t?O(j(tt),t.ADD_URI_SAFE_ATTR,he):tt,Ye="ADD_DATA_URI_TAGS"in t?O(j(Ze),t.ADD_DATA_URI_TAGS,he):Ze,Xe="FORBID_CONTENTS"in t?O({},t.FORBID_CONTENTS,he):Qe,je="FORBID_TAGS"in t?O({},t.FORBID_TAGS,he):{},xe="FORBID_ATTR"in t?O({},t.FORBID_ATTR,he):{},qe="USE_PROFILES"in t&&t.USE_PROFILES,De=!1!==t.ALLOW_ARIA_ATTR,Me=!1!==t.ALLOW_DATA_ATTR,We=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Re=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,$e=t.SAFE_FOR_TEMPLATES||!1,Ue=t.WHOLE_DOCUMENT||!1,Je=t.RETURN_DOM||!1,ke=t.RETURN_DOM_FRAGMENT||!1,ze=t.RETURN_TRUSTED_TYPE||!1,Ne=t.FORCE_BODY||!1,He=!1!==t.SANITIZE_DOM,Ve=t.SANITIZE_NAMED_PROPS||!1,Be=!1!==t.KEEP_CONTENT,Ke=t.IN_PLACE||!1,Te=t.ALLOWED_URI_REGEXP||Te,it=t.NAMESPACE||ot,Oe=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&gt(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Oe.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&gt(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Oe.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Oe.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),$e&&(Me=!1),ke&&(Je=!0),qe&&(_e=O({},o(F)),Pe=[],!0===qe.html&&(O(_e,D),O(Pe,N)),!0===qe.svg&&(O(_e,M),O(Pe,J),O(Pe,z)),!0===qe.svgFilters&&(O(_e,W),O(Pe,J),O(Pe,z)),!0===qe.mathMl&&(O(_e,$),O(Pe,k),O(Pe,z))),t.ADD_TAGS&&(_e===Ie&&(_e=j(_e)),O(_e,t.ADD_TAGS,he)),t.ADD_ATTR&&(Pe===Ae&&(Pe=j(Pe)),O(Pe,t.ADD_ATTR,he)),t.ADD_URI_SAFE_ATTR&&O(et,t.ADD_URI_SAFE_ATTR,he),t.FORBID_CONTENTS&&(Xe===Qe&&(Xe=j(Xe)),O(Xe,t.FORBID_CONTENTS,he)),Be&&(_e["#text"]=!0),Ue&&O(_e,["html","head","body"]),_e.table&&(O(_e,["tbody"]),delete je.tbody),u&&u(t),ut=t)},ft=O({},["mi","mo","mn","ms","mtext"]),bt=O({},["foreignobject","desc","title","annotation-xml"]),ht=O({},["title","style","font","a","script"]),St=O({},M);O(St,W),O(St,R);var yt=O({},$);O(yt,U);var Ct=function(e){var t=oe(e);t&&t.tagName||(t={namespaceURI:it,tagName:"template"});var r=E(e.tagName),a=E(t.tagName);return!!st[e.namespaceURI]&&(e.namespaceURI===at?t.namespaceURI===ot?"svg"===r:t.namespaceURI===rt?"svg"===r&&("annotation-xml"===a||ft[a]):Boolean(St[r]):e.namespaceURI===rt?t.namespaceURI===ot?"math"===r:t.namespaceURI===at?"math"===r&&bt[a]:Boolean(yt[r]):e.namespaceURI===ot?!(t.namespaceURI===at&&!bt[a])&&!(t.namespaceURI===rt&&!ft[a])&&!yt[r]&&(ht[r]||!St[r]):!("application/xhtml+xml"!==be||!st[e.namespaceURI]))},Et=function(e){C(a.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=se}catch(t){e.remove()}}},vt=function(e,t){try{C(a.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){C(a.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Pe[e])if(Je||ke)try{Et(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Lt=function(e){var t,r;if(Ne)e="<remove></remove>"+e;else{var a=L(e,/^[\r\n\t ]+/);r=a&&a[0]}"application/xhtml+xml"===be&&it===ot&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var o=ne?ne.createHTML(e):e;if(it===ot)try{t=(new b).parseFromString(o,be)}catch(e){}if(!t||!t.documentElement){t=le.createDocument(it,"template",null);try{t.documentElement.innerHTML=nt?se:o}catch(e){}}var i=t.body||t.documentElement;return e&&r&&i.insertBefore(n.createTextNode(r),i.childNodes[0]||null),it===ot?me.call(t,Ue?"html":"body")[0]:Ue?t.documentElement:i},wt=function(e){return de.call(e.ownerDocument||e,e,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT,null,!1)},Tt=function(e){return e instanceof f&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof p)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},_t=function(t){return"object"===e(l)?t instanceof l:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},It=function(e,t,r){fe[e]&&S(fe[e],(function(e){e.call(a,t,r,ut)}))},Pt=function(e){var t;if(It("beforeSanitizeElements",e,null),Tt(e))return Et(e),!0;if(I(/[\u0080-\uFFFF]/,e.nodeName))return Et(e),!0;var r=he(e.nodeName);if(It("uponSanitizeElement",e,{tagName:r,allowedTags:_e}),e.hasChildNodes()&&!_t(e.firstElementChild)&&(!_t(e.content)||!_t(e.content.firstElementChild))&&I(/<[/\w]/g,e.innerHTML)&&I(/<[/\w]/g,e.textContent))return Et(e),!0;if("select"===r&&I(/<template/i,e.innerHTML))return Et(e),!0;if(!_e[r]||je[r]){if(!je[r]&&Ot(r)){if(Oe.tagNameCheck instanceof RegExp&&I(Oe.tagNameCheck,r))return!1;if(Oe.tagNameCheck instanceof Function&&Oe.tagNameCheck(r))return!1}if(Be&&!Xe[r]){var o=oe(e)||e.parentNode,i=ae(e)||e.childNodes;if(i&&o)for(var n=i.length-1;n>=0;--n)o.insertBefore(te(i[n],!0),re(e))}return Et(e),!0}return e instanceof d&&!Ct(e)?(Et(e),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!I(/<\/no(script|embed|frames)/i,e.innerHTML)?($e&&3===e.nodeType&&(t=e.textContent,t=w(t,Se," "),t=w(t,ye," "),t=w(t,Ce," "),e.textContent!==t&&(C(a.removed,{element:e.cloneNode()}),e.textContent=t)),It("afterSanitizeElements",e,null),!1):(Et(e),!0)},At=function(e,t,r){if(He&&("id"===t||"name"===t)&&(r in n||r in mt))return!1;if(Me&&!xe[t]&&I(Ee,t));else if(De&&I(ve,t));else if(!Pe[t]||xe[t]){if(!(Ot(e)&&(Oe.tagNameCheck instanceof RegExp&&I(Oe.tagNameCheck,e)||Oe.tagNameCheck instanceof Function&&Oe.tagNameCheck(e))&&(Oe.attributeNameCheck instanceof RegExp&&I(Oe.attributeNameCheck,t)||Oe.attributeNameCheck instanceof Function&&Oe.attributeNameCheck(t))||"is"===t&&Oe.allowCustomizedBuiltInElements&&(Oe.tagNameCheck instanceof RegExp&&I(Oe.tagNameCheck,r)||Oe.tagNameCheck instanceof Function&&Oe.tagNameCheck(r))))return!1}else if(et[t]);else if(I(Te,w(r,we,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==T(r,"data:")||!Ye[e])if(We&&!I(Le,w(r,we,"")));else if(r)return!1;return!0},Ot=function(e){return e.indexOf("-")>0},jt=function(t){var r,o,i,n;It("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var c={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Pe};for(n=s.length;n--;){var l=r=s[n],d=l.name,u=l.namespaceURI;if(o="value"===d?r.value:_(r.value),i=he(d),c.attrName=i,c.attrValue=o,c.keepAttr=!0,c.forceKeepAttr=void 0,It("uponSanitizeAttribute",t,c),o=c.attrValue,!c.forceKeepAttr&&(vt(d,t),c.keepAttr))if(Re||!I(/\/>/i,o)){$e&&(o=w(o,Se," "),o=w(o,ye," "),o=w(o,Ce," "));var m=he(t.nodeName);if(At(m,i,o)){if(!Ve||"id"!==i&&"name"!==i||(vt(d,t),o=Ge+o),ne&&"object"===e(h)&&"function"==typeof h.getAttributeType)if(u);else switch(h.getAttributeType(m,i)){case"TrustedHTML":o=ne.createHTML(o);break;case"TrustedScriptURL":o=ne.createScriptURL(o)}try{u?t.setAttributeNS(u,d,o):t.setAttribute(d,o),y(a.removed)}catch(e){}}}else vt(d,t)}It("afterSanitizeAttributes",t,null)}},xt=function e(t){var r,a=wt(t);for(It("beforeSanitizeShadowDOM",t,null);r=a.nextNode();)It("uponSanitizeShadowNode",r,null),Pt(r)||(r.content instanceof s&&e(r.content),jt(r));It("afterSanitizeShadowDOM",t,null)};return a.sanitize=function(t){var o,n,c,d,u,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((nt=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!_t(t)){if("function"!=typeof t.toString)throw P("toString is not a function");if("string"!=typeof(t=t.toString()))throw P("dirty is not a string, aborting")}if(!a.isSupported){if("object"===e(r.toStaticHTML)||"function"==typeof r.toStaticHTML){if("string"==typeof t)return r.toStaticHTML(t);if(_t(t))return r.toStaticHTML(t.outerHTML)}return t}if(Fe||pt(m),a.removed=[],"string"==typeof t&&(Ke=!1),Ke){if(t.nodeName){var g=he(t.nodeName);if(!_e[g]||je[g])throw P("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof l)1===(n=(o=Lt("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===n.nodeName||"HTML"===n.nodeName?o=n:o.appendChild(n);else{if(!Je&&!$e&&!Ue&&-1===t.indexOf("<"))return ne&&ze?ne.createHTML(t):t;if(!(o=Lt(t)))return Je?null:ze?se:""}o&&Ne&&Et(o.firstChild);for(var p=wt(Ke?t:o);c=p.nextNode();)3===c.nodeType&&c===d||Pt(c)||(c.content instanceof s&&xt(c.content),jt(c),d=c);if(d=null,Ke)return t;if(Je){if(ke)for(u=ue.call(o.ownerDocument);o.firstChild;)u.appendChild(o.firstChild);else u=o;return(Pe.shadowroot||Pe.shadowrootmod)&&(u=ge.call(i,u,!0)),u}var f=Ue?o.outerHTML:o.innerHTML;return Ue&&_e["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&I(Y,o.ownerDocument.doctype.name)&&(f="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+f),$e&&(f=w(f,Se," "),f=w(f,ye," "),f=w(f,Ce," ")),ne&&ze?ne.createHTML(f):f},a.setConfig=function(e){pt(e),Fe=!0},a.clearConfig=function(){ut=null,Fe=!1},a.isValidAttribute=function(e,t,r){ut||pt({});var a=he(e),o=he(t);return At(a,o,r)},a.addHook=function(e,t){"function"==typeof t&&(fe[e]=fe[e]||[],C(fe[e],t))},a.removeHook=function(e){if(fe[e])return y(fe[e])},a.removeHooks=function(e){fe[e]&&(fe[e]=[])},a.removeAllHooks=function(){fe={}},a}()}()},function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return n})),r.d(t,"__decorate",(function(){return s})),r.d(t,"__param",(function(){return c})),r.d(t,"__esDecorate",(function(){return l})),r.d(t,"__runInitializers",(function(){return d})),r.d(t,"__propKey",(function(){return u})),r.d(t,"__setFunctionName",(function(){return m})),r.d(t,"__metadata",(function(){return g})),r.d(t,"__awaiter",(function(){return p})),r.d(t,"__generator",(function(){return f})),r.d(t,"__createBinding",(function(){return b})),r.d(t,"__exportStar",(function(){return h})),r.d(t,"__values",(function(){return S})),r.d(t,"__read",(function(){return y})),r.d(t,"__spread",(function(){return C})),r.d(t,"__spreadArrays",(function(){return E})),r.d(t,"__spreadArray",(function(){return v})),r.d(t,"__await",(function(){return L})),r.d(t,"__asyncGenerator",(function(){return w})),r.d(t,"__asyncDelegator",(function(){return T})),r.d(t,"__asyncValues",(function(){return _})),r.d(t,"__makeTemplateObject",(function(){return I})),r.d(t,"__importStar",(function(){return A})),r.d(t,"__importDefault",(function(){return O})),r.d(t,"__classPrivateFieldGet",(function(){return j})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return D}));var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function n(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(r[a[o]]=e[a[o]])}return r}function s(e,t,r,a){var o,i=arguments.length,n=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(n=(i<3?o(n):i>3?o(t,r,n):o(t,r))||n);return i>3&&n&&Object.defineProperty(t,r,n),n}function c(e,t){return function(r,a){t(r,a,e)}}function l(e,t,r,a,o,i){function n(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,c=a.kind,l="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?a.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,a.name):{}),m=!1,g=r.length-1;g>=0;g--){var p={};for(var f in a)p[f]="access"===f?{}:a[f];for(var f in a.access)p.access[f]=a.access[f];p.addInitializer=function(e){if(m)throw new TypeError("Cannot add initializers after decoration has completed");i.push(n(e||null))};var b=(0,r[g])("accessor"===c?{get:u.get,set:u.set}:u[l],p);if("accessor"===c){if(void 0===b)continue;if(null===b||"object"!=typeof b)throw new TypeError("Object expected");(s=n(b.get))&&(u.get=s),(s=n(b.set))&&(u.set=s),(s=n(b.init))&&o.push(s)}else(s=n(b))&&("field"===c?o.push(s):u[l]=s)}d&&Object.defineProperty(d,a.name,u),m=!0}function d(e,t,r){for(var a=arguments.length>2,o=0;o<t.length;o++)r=a?t[o].call(e,r):t[o].call(e);return a?r:void 0}function u(e){return"symbol"==typeof e?e:"".concat(e)}function m(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function g(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,r,a){return new(r||(r=Promise))((function(o,i){function n(e){try{c(a.next(e))}catch(e){i(e)}}function s(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,s)}c((a=a.apply(e,t||[])).next())}))}function f(e,t){var r,a,o,i,n={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(n=0)),n;)try{if(r=1,a&&(o=2&s[0]?a.return:s[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,s[1])).done)return o;switch(a=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,a=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if(!((o=(o=n.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){n=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){n.label=s[1];break}if(6===s[0]&&n.label<o[1]){n.label=o[1],o=s;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(s);break}o[2]&&n.ops.pop(),n.trys.pop();continue}s=t.call(e,n)}catch(e){s=[6,e],a=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var b=Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]};function h(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||b(t,e,r)}function S(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,o,i=r.call(e),n=[];try{for(;(void 0===t||t-- >0)&&!(a=i.next()).done;)n.push(a.value)}catch(e){o={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return n}function C(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function E(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var a=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],n=0,s=i.length;n<s;n++,o++)a[o]=i[n];return a}function v(e,t,r){if(r||2===arguments.length)for(var a,o=0,i=t.length;o<i;o++)!a&&o in t||(a||(a=Array.prototype.slice.call(t,0,o)),a[o]=t[o]);return e.concat(a||Array.prototype.slice.call(t))}function L(e){return this instanceof L?(this.v=e,this):new L(e)}function w(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,o=r.apply(e,t||[]),i=[];return a={},n("next"),n("throw"),n("return"),a[Symbol.asyncIterator]=function(){return this},a;function n(e){o[e]&&(a[e]=function(t){return new Promise((function(r,a){i.push([e,t,r,a])>1||s(e,t)}))})}function s(e,t){try{(r=o[e](t)).value instanceof L?Promise.resolve(r.value.v).then(c,l):d(i[0][2],r)}catch(e){d(i[0][3],e)}var r}function c(e){s("next",e)}function l(e){s("throw",e)}function d(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function T(e){var t,r;return t={},a("next"),a("throw",(function(e){throw e})),a("return"),t[Symbol.iterator]=function(){return this},t;function a(a,o){t[a]=e[a]?function(t){return(r=!r)?{value:L(e[a](t)),done:!1}:o?o(t):t}:o}}function _(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=S(e),t={},a("next"),a("throw"),a("return"),t[Symbol.asyncIterator]=function(){return this},t);function a(r){t[r]=e[r]&&function(t){return new Promise((function(a,o){!function(e,t,r,a){Promise.resolve(a).then((function(t){e({value:t,done:r})}),t)}(a,o,(t=e[r](t)).done,t.value)}))}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var P=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function A(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&b(t,e,r);return P(t,e),t}function O(e){return e&&e.__esModule?e:{default:e}}function j(e,t,r,a){if("a"===r&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)}function x(e,t,r,a,o){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?o.call(e,r):o?o.value=r:t.set(e,r),r}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;const a={};function o(){return void 0===globalThis.__get_feature_gate_dictionary_variable?a:globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){var r;return null!==(r=o()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=o,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){var r;const a=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===a||"false"!==a&&t},t.getNumberFeatureGate=function(e,t){var r;const a=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===a)return t;if("infinity"===a||"+infinity"===a)return 1/0;if("-infinity"===a)return-1/0;const o=parseFloat(a);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r;const a=null===(r=i(e))||void 0===r?void 0:r.trim();if(void 0===a)return t;const o=parseInt(a,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";function a(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0,t.getChangeGateDictionary=a,t.isChangeGateEnabled=function(e){var t;return null===(t=a()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},,,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;const a=r(18);t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,a.getBooleanFeatureGate)(t,r);case"number":return(0,a.getNumberFeatureGate)(t,r);case"string":return(0,a.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;const a=r(19);t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,a.isChangeGateEnabled)(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;const a=r(19);function o(e){const t=(0,a.setChangeGateDictionaryGetter)(void 0);return(0,a.setChangeGateDictionaryGetter)(()=>_object_spread({},void 0!==t?t():{},e)),t}t.overrideChangeGates=o,t.overrideTypedChangeGates=function(e,t){return o(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;const a=r(18);function o(e){var t;const r={};for(const t of Object.keys(e)){var o;r[t]=null===(o=e[t])||void 0===o?void 0:o.toString()}const i=null!==(t=(0,a.setFeatureGateDictionaryGetter)(void 0))&&void 0!==t?t:()=>({});return(0,a.setFeatureGateDictionaryGetter)(()=>_object_spread({},i(),r)),i}t.overrideFeatureGates=o,t.overrideTypedFeatureGates=function(e,t){return o(t)}},,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.r(t),r.d(t,"createClipboardItems",(function(){return a.R})),r.d(t,"getClipboardPlatformEnvironment",(function(){return Ke})),r.d(t,"setClipboardPlatformFeatureGateManager",(function(){return qe}));var a=r(1),o=r(0);let i;var n=r(15);let s;const c={serializeMetadata:function(e){if(!e)return"{}";try{const t={},r=function(e){if(e)try{if(!e.id)throw new a.e(a.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.id is not defined");if(!e.sessionId)throw new a.e(a.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.sessionId is not defined");if(void 0===e.copyStatus)throw new a.e(a.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.copyStatus is not defined");return{id:e.id,sessionId:e.sessionId,sourceItem:s.serializeSourceItem(e.sourceItem),commandParameters:s.serializeCommandParameters(e.commandParameters),copyStatus:e.copyStatus,isTimestampStoredInSystemClipboard:e.isTimestampStoredInSystemClipboard,isAsyncSerializeFailed:e.isAsyncSerializeFailed,asyncClipboardItemsKeys:e.asyncClipboardItemsKeys,syncClipboardItemsKeys:e.syncClipboardItemsKeys,isFullSheetCopy:e.isFullSheetCopy}}catch(e){return void Object(a.mc)().ULS.traceTag(595945243,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataSerializer.serializeCopyContext: failed to serialized copyContext: "+o.utils.getStringifiedError(e))}}(e.lastCopy);return r&&(t.copyContext=r),JSON.stringify(t)}catch(e){return Object(a.mc)().ULS.traceTag(595945242,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataSerializer.serializeMetadata: failed to serialized metadata: "+o.utils.getStringifiedError(e)),"{}"}},deserializeMetadata:function(e){if(!e)return Object(a.rb)();try{const t=JSON.parse(e),r={};return t.copyContext&&(r.lastCopy=function(e){if(e)try{if(!e.id)throw new a.e(a.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.id is not defined");if(!e.sessionId)throw new a.e(a.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sessionId is not defined");if(!e.copyStatus)throw new a.e(a.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.copyStatus is not defined");if(!e.sourceItem)throw new a.e(a.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sourceItem is not defined");if(!e.commandParameters)throw new a.e(a.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.commandParameters is not defined");const t=new a.l;return t.id=e.id,t.sessionId=e.sessionId,t.copyStatus=e.copyStatus,t.isTimestampStoredInSystemClipboard=e.isTimestampStoredInSystemClipboard,t.isAsyncSerializeFailed=e.isAsyncSerializeFailed,t.sourceItem=s.deserializeSourceItem(e.sourceItem),t.commandParameters=s.deserializeCommandParameters(e.commandParameters),t.asyncClipboardItemsKeys=e.asyncClipboardItemsKeys,t.syncClipboardItemsKeys=e.syncClipboardItemsKeys,t.isFullSheetCopy=e.isFullSheetCopy,t}catch(e){return void Object(a.mc)().ULS.traceTag(595945245,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`MetadataSerializer.deserializeMetadata: failed to deserialized copyContext with error: ${o.utils.getStringifiedError(e)}.`)}}(t.copyContext)),r}catch(e){Object(a.mc)().ULS.traceTag(595945244,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataSerializer.deserializeMetadata: failed to deserialized metadata with error: "+o.utils.getStringifiedError(e))}return Object(a.rb)()}};let l,d,u,m=Object(a.rb)();const g={};let p;const f={getCachedMetadata:function(){return Object(a.mc)().ULS.traceTag(595730648,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.getCachedMetadata: get cached metadata with value: "+C(m)),Object(a.Q)(m)},updateMetadata:function(e){Object(a.mc)().ULS.traceTag(595730652,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.updateMetadata: start update metadata with metadata : "+C(e));const t=_object_spread({},m,e),r=Object(a.R)();r.setItem("metadata",d.serializeMetadata(t)),Object(a.mc)().ULS.traceTag(595730653,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.updateMetadata: schedule metadata with value: "+C(t)),S(r,t)},clear:function(){Object(a.mc)().ULS.traceTag(595730654,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.clear: start clear metadata");const e=Object(a.rb)();S(Object(a.R)(),e)},addMetadataChangeListener:function(e,t){e||Object(a.mc)().ULS.traceTag(595936158,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define"),t||Object(a.mc)().ULS.traceTag(595936159,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listener to be define"),g[e]&&Object(a.mc)().ULS.traceTag(595936160,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`MetadataManager.addMetadataChangeListener: listener with same listenerId(${e} already exist.`),g[e]=t},removeMetadataChangeListener:function(e){e||Object(a.mc)().ULS.traceTag(595936161,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define"),g[e]?delete g[e]:Object(a.mc)().ULS.traceTag(595936162,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`MetadataManager.removeMetadataChangeListener: can't find listener with listenerId = ${e}.`)},getMetadataSyncPromise:function(){return p&&Object(n.isChangeGateEnabled)("OfficeVSO:2594435_ArtCCPWaitForCopyToComplete")?(Object(a.mc)().ULS.traceTag(595937174,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: metadata not sync, return deferred promise."),p.deferredPromise.promise.then(e=>(Object(a.mc)().ULS.traceTag(595937175,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: sync promise resolved."),e))):(Object(a.mc)().ULS.traceTag(595937173,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: metadata is sync, return resolved promise."),Promise.resolve(Object(a.Q)(m)))},isMetadataSync:function(){return!p},serializeMetadata:function(e){return d.serializeMetadata(e)},deserializeMetadata:function(e){return d.deserializeMetadata(e)}};function b(e){try{if(e&&0!==Object(a.nb)(e)){const t=e.getItem("metadata");m=d.deserializeMetadata(t),Object(a.mc)().ULS.traceTag(595730650,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.onMetadataChanged: set cached metadata with value "+C(m))}else Object(a.mc)().ULS.traceTag(595730649,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.onMetadataChanged: set empty cached metadata because clipboardItems were not found"),m=Object(a.rb)()}catch(e){Object(a.mc)().ULS.traceTag(595945248,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataManager.onMetadataChanged: failed to parse metadata string with error: "+o.utils.getStringifiedError(e)),m=Object(a.rb)()}h(Object(a.Q)(m))}function h(e){Object(a.mc)().ULS.traceTag(595730651,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.updateListenerForMetadataChanged: update listeners with metadata : "+C(e));for(const t in g){const r=g[t];r&&r(e)}}function S(e,t){const r=Object(a.bb)();p?p.metadataSyncMessageId=r:(p={metadataSyncMessageId:r,deferredPromise:Object(a.V)()},Object(a.mc)().ULS.traceTag(595937176,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.scheduleMetadataUpdate: _syncMetadata created. "+p.metadataSyncMessageId)),Object(a.mc)().ULS.traceTag(595937177,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`MetadataManager.scheduleMetadataUpdate: set metadata request was sent with message id ${r}.`),setTimeout(()=>{l.set(e,{}).then(()=>{m=t,Object(a.mc)().ULS.traceTag(595937178,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`MetadataManager.scheduleMetadataUpdate: set metadata successfully. messageId=${r}. _syncMetadata.metadataSyncMessageId = ${p&&p.metadataSyncMessageId}. newMetadata = ${C(t)}`),y(r)},e=>{Object(a.mc)().ULS.traceTag(595945250,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataManager.updateMetadata: failed to update metadata store with error: "+o.utils.getStringifiedError(e)),y(r)})},0)}function y(e){if(Object(a.mc)().ULS.traceTag(595730655,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.notifyMetadataSyncIfNeeded: start notifyMetadataSyncIfNeeded with messageId: "+e),p&&p.metadataSyncMessageId===e){const e=p;p=void 0;const t=Object(a.Q)(m);Object(a.mc)().ULS.traceTag(595730656,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.notifyMetadataSyncIfNeeded: resolve with metadata: "+C(t)),h(t),e.deferredPromise.resolve(t)}}function C(e){return e?e.lastCopy?"copyContext.id="+e.lastCopy.id:"copy context is null":"metadata is null"}class E{wrapTextWithDataSignature(e,t,r,o="null",i){const n={ccp_infra_version:3,ccp_infra_timestamp:r,ccp_infra_user_hash:this.userHash,ccp_infra_copy_id:o};let s;return s=null!==i&&0!==Object.keys(i).length?_object_spread({},n,i):n,s[a.Bb.ccpTimestampHtmlCustomAttributeName]=r,a.Bb.wrapContentWithTagAndAttributes(e,t,s)}ensureDataSignatureInHtmlItem(e){if(0===Object(a.nb)(e))return;const t=Object(a.tb)(e),r=Object(a.lb)(t,a.lc),o=Object(a.lb)(t,a.Ub),i=Object(a.lb)(t,a.Qb);let n=null;if(i!==a.jb&&(n=JSON.parse(i)),r){if(void 0!==this.getRegExIntValue(r,"ccp_infra_version=['|\"](\\d+)['|\"]"))return;return void e.setItem(a.lc,this.wrapTextWithDataSignature(r,a.Bb.divTagName,Date.now(),o,n))}const s=Object(a.pb)(t),c=a.Bb.createTextHtmlFromTextPlain(s),l=this.wrapTextWithDataSignature(c,a.Bb.preTagName,Date.now(),o,n);e.setItem(a.lc,a.Bb.addClipboardWrapperForEdge(l))}extractSignatureData(e){if(Object(a.ob)(e)>0){const t=Object(a.mb)(e,a.lc),r=this.getRegExIntValue(t,"ccp_infra_version=['|\"](\\d+)['|\"]");if(void 0===r)return this.parsePreSignatureData(t);if(this.blockMismatchDataVersion&&3!==r)throw Object(a.mc)().ULS.traceTag(595902983,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`clipboardDataManager.extractSignatureData: block mismatch version. dataVer = ${r}, CCPInfraVersion = 3`),new a.A("ClipboardDataManagerImpl.extractSignatureData",r,3,this.blockMismatchDataVersion);return r<3?(Object(a.mc)().ULS.traceTag(595902986,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`clipboardDataManager.extractSignatureData: got data with older version then app version: dataVer = ${r}, CCPInfraVersion = 3. Converting to the data`),this.parseOldSignatureData(t)):(r>3&&Object(a.mc)().ULS.traceTag(595900176,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`clipboardDataManager.extractSignatureData: got data with newer version then app version: dataVer = ${r}, CCPInfraVersion = 3. ( It's OK - Should be forward compatibility)`),this.parseCurrentVersionSignatureData(t))}}parseCurrentVersionSignatureData(e){const t=this.getRegExIntValue(e,"\\s+ccp_infra_timestamp=['|\"](\\d+)['|\"]"),r=this.getRegExIntValue(e,"\\s+ccp_infra_user_hash=['|\"](\\d+)['|\"]");if(void 0!==t&&void 0!==r){const i=this.getRegExStringValue(e,"\\s+ccp_infra_copy_id=['|\"]([\\w-]+)['|\"]");return i&&Object(a.mc)().ULS.traceTag(595183181,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.parseCurrentVersionSignatureData: copy ID of legacy paste cross session : "+i),{ccp_infra_version:3,ccp_infra_timestamp:t,ccp_infra_user_hash:r,ccp_infra_copy_id:i||""}}Object(a.mc)().ULS.traceTag(595902985,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"clipboardDataManager.extractSignatureData: Failed to extract SignatureData. textHtmlItem: "+e)}parseOldSignatureData(e){return this.parseCurrentVersionSignatureData(e)}parsePreSignatureData(e){const t=a.Bb.getCcpTimestampHtmlCustomAttributeFromWrappingTag(e);if(Object(a.mc)().ULS.traceTag(595723668,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.parsePreSignatureData: dataTimeStamp="+t),t){if(this.blockMismatchDataVersion)throw Object(a.mc)().ULS.traceTag(595899270,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"clipboardDataManager.parsePreSignatureData: block mismatch version. block pre signature data"),new a.A("ClipboardDataManagerImpl.extractSignatureData",NaN,3,this.blockMismatchDataVersion);const e={ccp_infra_version:3,ccp_infra_timestamp:t,ccp_infra_user_hash:0};return Object(a.mc)().ULS.traceTag(595723669,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.parsePreSignatureData"),e}}validateTTL(e){if(e&&this.ttlInMs){const t=Date.now()-e.ccp_infra_timestamp;if(t>this.ttlInMs)throw Object(a.mc)().ULS.traceTag(595899858,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`Time elapsed (${t} ms) from setting Clipboard (${e.ccp_infra_timestamp}) is greater then TTL (${this.ttlInMs} ms) - return error`),new a.K("clipboardDataManager.validateTTL validation failed",t,this.ttlInMs)}}validateUserHash(e){if(e&&e.ccp_infra_user_hash!==this.userHash)throw Object(a.mc)().ULS.traceTag(595723670,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"clipboardDataManager.validateUserHash: user hash mismatch detected. throw error"),new a.N("clipboardDataManager.validateUserHash validation failed",e?e.ccp_infra_user_hash:0,this.userHash)}setMetaDataVersionItem(e){if(0===Object(a.nb)(e))return;e.setItem(a.Vb,JSON.stringify({ccp_infra_version:3}))}validateMetaDataVersionItem(e){if(e&&Object(a.nb)(e)>0){const t=Object(a.mb)(e.getData(),a.Vb);let r=void 0;try{r=JSON.parse(t)}catch(e){if(!this.blockMismatchDataVersion)return;throw Object(a.mc)().ULS.traceTag(595899272,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"clipboardDataManager.validateMetaDataVersionItem: failed parse SignatureMetaData. error = "+e),new a.L("ClipboardDataManagerImpl.validateMetaDataVersionItem: failed parse SignatureMetaData. SignatureMetaData text = "+t)}if(this.blockMismatchDataVersion&&3!==r.ccp_infra_version)throw Object(a.mc)().ULS.traceTag(595899203,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`clipboardDataManager.validateMetaDataVersionItem: block mismatch version. dataVer = ${r.ccp_infra_version}, CCPInfraVersion = 3`),new a.A("ClipboardDataManagerImpl.validateMetaDataVersionItem",r.ccp_infra_version,3,this.blockMismatchDataVersion)}}createClipboardDataProcessor(e){return Object(a.mc)().ULS.traceTag(595723671,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor: get called. validateUserHash="+e),{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:(t=>{if(Object(a.mc)().ULS.traceTag(595723672,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: get called. validateUserHash="+e),t){const r=this.extractSignatureData(t.getData());Object(a.mc)().ULS.traceTag(595723673,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: clipboardItems not empty. validateUserHash="+e),r&&t.setItem(a.Ub,r.ccp_infra_copy_id),this.validateTTL(r),e&&(Object(a.mc)().ULS.traceTag(595723674,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: going to validate user hash. validateUserHash="+e),this.validateUserHash(r))}}).bind(this)}}createDualClipboardDataProcessor(e){return Object(a.mc)().ULS.traceTag(595723675,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.createDualClipboardDataProcessor: get called."),{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:(e=>{Object(a.mc)().ULS.traceTag(595723676,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.createDualClipboardDataProcessor.postGet: get called."),e&&e.clipboardItemsData&&(e.signatureData=this.extractSignatureData(e.clipboardItemsData),e.signatureData&&(e.clipboardItemsData.items[a.Ub]=e.signatureData.ccp_infra_copy_id),this.validateTTL(e.signatureData))}).bind(this),validateUserHash:e?this.validateUserHash.bind(this):()=>{}}}createClipboardMetaDataProcessor(){return{preSetProcess:this.setMetaDataVersionItem.bind(this),postGetProcess:this.validateMetaDataVersionItem.bind(this)}}getRegExStringValue(e,t){const r=new RegExp(t,"g").exec(e);if(r&&r.length&&r.length>1)return r[1]}getRegExIntValue(e,t){const r=this.getRegExStringValue(e,t);if(r){const e=Number(r);return isNaN(e)?void 0:e}}constructor(e,t,r){this.ttlInMs=t,this.blockMismatchDataVersion=r,e?this.userHash=o.utils.calcHashCode(e):(this.userHash=1565411791,Object(a.mc)().ULS.traceTag(595903939,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"userId not exist!. Use default ID"))}}class v extends a.O{init(e){return this.deferredResultMessagePromiseCache=Object(a.W)(),this.sender=Object(a.eb)(this.serializer,this),this.receiver=Object(a.db)(this.deserializer,this,this),this.postInitMessage(e).catch(e=>(Object(a.mc)().ULS.traceTag(596129250,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Init failure or timeout. Error: "+o.utils.getStringifiedError(e)),Object(a.Hb)(e,a.f.IframeInitializationTimeout)?Promise.reject(e):Promise.reject(new a.e(a.f.IframeInitialization,"failed to init the Shared Clipboard",e))))}registerPushMessageListener(e,t){this.pushMessageListeners[e]=t}postInitMessage(e){const t=Object(a.S)(a.Fb,"init",a.z.initIframe);if(!this.deferredResultMessagePromiseCache){const e="RPC Client - postInitMessage: this.deferredResultMessagePromiseCache should be defined";return Object(a.mc)().ULS.shipAssertTag(596121487,o.LogCategory.msoulscat_ES_EWAJS,!1,e),Promise.reject(new a.u(e))}const r=this.postMessage(t),i=this.deferredResultMessagePromiseCache.getDeferredPromise(t.id),n=Date.now();return setTimeout(()=>{if(i&&!i.fulfilled()){const e=Date.now(),t=`initialization started on ${new Date(n)} and timed out on ${new Date(e)} after ${e-n} ms`;Object(a.mc)().ULS.traceTag(596129251,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,t),i.reject(new a.e(a.f.IframeInitializationTimeout,t))}},e),r}postMessage(e){try{if(!e)throw new a.B(a.jb,"outgoingMessage");if(Object(a.mc)().ULS.shipAssertTag(596452175,o.LogCategory.msoulscat_ES_EWAJS,!!e.id,"postMessage: outgoingMessage.id must be defined"),super.postMessage(e),!this.deferredResultMessagePromiseCache){const e="RPC Client - postMessage: this.deferredResultMessagePromiseCache should be defined";throw Object(a.mc)().ULS.shipAssertTag(596121488,o.LogCategory.msoulscat_ES_EWAJS,!1,e),new a.u(e)}return this.deferredResultMessagePromiseCache.addNewPromise(e.id).promise}catch(t){return Promise.reject(new a.u(`Unable to post message for operation '${e?e.operationCode:void 0}'`,t))}}handleMessage(e){Object(a.mc)().ULS.traceTag(596452376,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`RPC Client - handleMessage: incomingMessage.id='${e&&e.id}'; incomingMessage.operationCode='${e&&e.operationCode}'; incomingMessage.failed='${e&&e.failed}'; incomingMessage.error='${e&&e.error}'; incomingMessage.clipboardItems.length=${Object(a.ob)(e&&e.clipboardItemsData)}`);const t=this.pushMessageListeners[e.operationCode];if(t)return t(e.clipboardItemsData),Promise.resolve();if(!this.deferredResultMessagePromiseCache){const e="RPC Client - handleMessage: this.deferredResultMessagePromiseCache should be defined";return Object(a.mc)().ULS.shipAssertTag(596121489,o.LogCategory.msoulscat_ES_EWAJS,!1,e),Promise.reject(new a.u(e))}const r="initresult"===e.operationCode?a.Fb:e.id,i=this.deferredResultMessagePromiseCache.getDeferredPromise(r);return i?(this.deferredResultMessagePromiseCache.delete(r),e.failed?i.reject(e.error):i.resolve(e),Promise.resolve()):(Object(a.mc)().ULS.traceTag(596452377,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,r===e.id?`RPC Client - handleMessage: no deferred promise with id '${e.id}'; dropping this result.`:`RPC Client - handleMessage: no deferred promise with id '${r}' for message id '${e.id}'; dropping this result.`),Promise.resolve())}handleDeserializationError(e){return!e||"NoValidKeyError"!==e.errorName||this.deferredResultMessagePromiseCache&&0!==this.deferredResultMessagePromiseCache.getLength()?(Object(a.mc)().ULS.traceTag(596452379,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`RPC Client - handleDeserializationError. There are ${this.deferredResultMessagePromiseCache?this.deferredResultMessagePromiseCache.getLength():0} deferred promise(s) in the cache. Error: ${o.utils.getStringifiedError(e)}`),Promise.resolve()):(Object(a.mc)().ULS.traceTag(542687372,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"RPC Client - handleDeserializationError. Error: "+o.utils.getStringifiedError(e)),Promise.resolve())}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(a.gc)([()=>{this.deferredResultMessagePromiseCache&&this.deferredResultMessagePromiseCache.clear()}]),super.dispose())}constructor(e,t,r){super(e,t,r,"WindowRPCClientInternal"),this.pushMessageListeners={}}}const L=[],w={initialized:!1,origin:a.jb,src:a.jb,deferredPromise:void 0};let T=void 0;function _(){return w}function I(){if(T){try{T()}catch(e){}T=void 0}}let P,A,O=void 0;function j(){if(!O)return Promise.reject("state in undefined, please make sure to call initialize first");let e=function(){if(!_().initialized)throw new a.u("getIframe: the initialize function should be called beforehand");const e=document.getElementsByTagName("iframe");if(e&&0!==e.length){Object(a.mc)().ULS.traceTag(595952723,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`getIframe: found ${e.length} iframes`);for(let t=0;t<e.length;t+=1){const r=e[t];if(r&&r.id&&"clipboard"===r.id)return r}Object(a.mc)().ULS.traceTag(595952724,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"getIframe: the CCP iframe does not exist")}else Object(a.mc)().ULS.traceTag(595952722,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"getIframe: found no iframes")}();e&&(Object(a.mc)().ULS.traceTag(596448770,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`ensureIframeWindow: The CCP iframe exists. Removing the iframe and re-adding it. iframe.src ${void 0!==e.src&&void 0!==O.src&&e.src.toLowerCase()===O.src.toLowerCase()?"===":"!=="} src; deferredPromise ${void 0===O.deferredPromise?"does not exist":"exists"}; The iframe's content window ${void 0===e.contentWindow?"does not exist":"exists"}.`),function(e){if(!e)throw new a.B(a.jb,"iframe");Object(a.mc)().ULS.traceTag(595952725,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"removeIframe: removing the CCP iframe"),I(),e.parentNode&&e.parentNode.removeChild(e)}(e),e=void 0);let t=O.deferredPromise,r=t?t.id:a.jb;if(t){I(),O.deferredPromise=void 0;const e=`ensureIframeWindow: the CCP iframe does not exist and the deferred promise of its content window should not exist as well. Rejecting deferred promise id '${r}' and creating a new one`;Object(a.mc)().ULS.shipAssertTag(596453587,o.LogCategory.msoulscat_ES_EWAJS,!1,e),t.reject(new a.u(e)),t=void 0}O.deferredPromise=Object(a.V)(Object(a.bb)()),t=O.deferredPromise,r=t.id;try{e=function(){const e=document.createElement("iframe");return e.style.display="none",e.id="clipboard",Object(a.mc)().ULS.shipAssertTag(595952726,o.LogCategory.msoulscat_ES_EWAJS,!T,"createIframe: the last shared clipboard iframe's onload event listener should have been removed. Removing it and registering a new event listener."),I(),T=Object(a.P)(e,"load",e=>function(e){Object(a.mc)().ULS.traceTag(595952727,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"CCP iframe onload event: Entering"),I();const t=_().deferredPromise;if(!t)return void Object(a.mc)().ULS.shipAssertTag(595952728,o.LogCategory.msoulscat_ES_EWAJS,!1,"CCP iframe onload event: the CCP iframe does not have a matching deferred promise to notify subscribers when the iframe loaded");const r=t.id;try{_().deferredPromise=void 0;const i=e.target;if(!i){const e=`CCP iframe onload event: the CCP iframe should exist when its onload event is called. Rejecting deferred promise id '${r}'`;return Object(a.mc)().ULS.shipAssertTag(595952729,o.LogCategory.msoulscat_ES_EWAJS,!1,e),void t.reject(new a.u(e))}if(!i.contentWindow){const e=`CCP iframe onload event: the contentWindow of the CCP iframe does not exist. Rejecting deferred promise id '${r}'`;return Object(a.mc)().ULS.shipAssertTag(595952730,o.LogCategory.msoulscat_ES_EWAJS,!1,e),void t.reject(new a.u(e))}Object(a.mc)().ULS.traceTag(595952732,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`CCP iframe onload event: resolving deferred promise id '${r}' with the iframe`),t.resolve(i)}catch(e){const i=`iframeOnLoad: an error has occurred: [${o.utils.getStringifiedError(e)}]. Rejecting deferred promise id '${r}'`;Object(a.mc)().ULS.traceTag(595952733,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,i),t.reject(new a.u(i,e))}}(e)),e.src=_().src,e}(),document.getElementsByTagName("body")[0].appendChild(e)}catch(e){const t=`ensureIframeWindow: unable to create and/or add a CCP iframe. Dropping tentative deferred promise id '${r}'`;return Object(a.mc)().ULS.traceTag(596453588,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,t),O.deferredPromise=void 0,I(),Promise.reject(new a.u(t,e))}return t&&!t.fulfilled()?t.promise:(I(),e.contentWindow?(O.deferredPromise=void 0,Promise.resolve(e)):(Object(a.mc)().ULS.shipAssertTag(596453589,o.LogCategory.msoulscat_ES_EWAJS,!1,`ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '${r}'`),Promise.reject(new a.u(`ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '${r}'`))))}function x(){if(A)return A.promise;A=Object(a.V)(Object(a.bb)());try{const t=(e=Object(a.zb)().origin,O||(O=_()),O.initialized||(O.origin=Object(a.xb)(e),O.src=function(e){const t=_().origin;let r=t;"/"!==t.charAt(t.length-1)&&(r+="/"),r+="clipboard/shared.aspx",e&&(r+=`?${encodeURIComponent(a.dc)}=${encodeURIComponent(e)}`);const s=[];L.forEach(e=>{Object(n.isChangeGateEnabled)(e)||s.push({key:e,value:"1"})});const c=function(){if(!i)throw new a.u("ClipboardPlatformSettings is not ready. Call ClipboardPlatformEnvironment.init(...).");return i}();c&&(c.sessionId&&s.push({key:a.ec,value:c.sessionId}),c.bulsEndpointUrl&&s.push({key:a.cc,value:c.bulsEndpointUrl}));const[l,d]=Object(o.getNewGuid)();return Object(a.mc)().ULS.traceTag(595722560,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`getValidatedIframeSrc.getValidatedIframeSrc: Generate correlation if for loading the shared clipboard frame. CorrelationId: ${l} newGuidLogging: ${d}`),s.push({key:"corrid",value:l}),s.push({key:"NoAuth",value:"true"}),s.length>0&&s.forEach(e=>{r+=r.indexOf("?")>=0?"&":"?",r+=`${encodeURIComponent(e.key)}=${encodeURIComponent(e.value)}`}),r}(e),O.initialized=!0),O.origin);P=function(e,t){return new v(Object(a.cb)(a.oc),Object(a.ab)(a.pc),{window:void 0,windowOrigin:e})}(t),o.utils.retry((e,t)=>function(e,t){if(!P){const e="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";return Object(a.mc)().ULS.shipAssertTag(595947544,o.LogCategory.msoulscat_ES_EWAJS,!1,e),Promise.reject(new a.u(e))}const r=o.perfWatch.start("Iframe_initialize_"+e);o.perfWatch.mark(r,"start"),P.remoteWindow.window=void 0;const i=i=>{const n=Object(a.Hb)(i,a.f.IframeInitializationTimeout)?` due to a timeout of approx. ${t} ms`:a.jb;o.perfWatch.mark(r,"finish_error"),o.perfWatch.failure(r,e=>Object(a.mc)().ULS.traceTag(596452419,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,e),`Attempt #${e} failed to initialize an iframe ${n}. ${e<3?"Retrying...":"No more retries!"}. Error: ${o.utils.getStringifiedError(i)}`)},n=Object(a.V)();return j().then(n=>{if(o.perfWatch.mark(r,"iframe_loaded"),o.perfWatch.mark(r,"iframe_waiting_for_idb_init"),!P){const e="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";Object(a.mc)().ULS.shipAssertTag(595947545,o.LogCategory.msoulscat_ES_EWAJS,!1,e);const t=new a.u(e);return i(t),Promise.reject(t)}if(!n.contentWindow){const e="clipboardIframeLoader::initializeIframe - remoteWindow.contentWindow should be defined";Object(a.mc)().ULS.shipAssertTag(595903557,o.LogCategory.msoulscat_ES_EWAJS,!1,e);const t=new a.u(e);return i(t),Promise.reject(t)}return P.remoteWindow.window=n.contentWindow,P.init(t).then(()=>(o.perfWatch.mark(r,"iframe_idb_init_complete"),o.perfWatch.mark(r,"finish"),o.perfWatch.success(r,e=>Object(a.mc)().ULS.traceTag(596452418,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,e),`Attempt #${e} initialized iframe`),Promise.resolve()))}).then(()=>{n.resolve()},e=>{i(e),n.reject(e)}),n.promise}(e,2e4+(Object(a.Hb)(t,a.f.IframeInitializationTimeout)?5e3:0)*(e-1)),3).then(()=>{A.resolve(P)},e=>{A.reject(e)})}catch(e){A.reject(e)}var e;return A.promise}class D{innerInitialize(){return x().then(e=>(this.initialized=!0,this.windowRPCClient=e,this))}registerPushMessageListener(e,t){this.windowRPCClient&&this.windowRPCClient.registerPushMessageListener(e,t)}postMessage(e,t){if(!this.initialized)return Promise.reject(new a.e(a.f.IframeInitialization));const r=o.perfWatch.start("BaseIframeProxy_"+t);o.perfWatch.mark(r,"start");const i=e=>(o.perfWatch.mark(r,"finish_error"),o.perfWatch.failure(r,e=>Object(a.mc)().ULS.traceTag(596452188,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,e),"Failed in BaseIframeProxy.postMessage. Error: "+o.utils.getStringifiedError(e)),Promise.reject(new a.e(a.f.IframeProxyGeneralError,"Failed in BaseIframeProxy.postMessage",e)));if(!this.windowRPCClient){const e="BaseIframeProxy.postMessage - this.windowRPCClient should be defined";return Object(a.mc)().ULS.shipAssertTag(595944461,o.LogCategory.msoulscat_ES_EWAJS,!1,e),i(new a.u(e))}return this.windowRPCClient.postMessage(e).then(e=>(Object(a.mc)().ULS.shipAssertTag(595944462,o.LogCategory.msoulscat_ES_EWAJS,!!e,"BaseIframeProxy.postMessage: postMessage must have returned a result message"),e?e.failed?Promise.reject(new a.e(a.f.IframeProxyGeneralError,"BaseIframeProxy.postMessage: the operation failed. Error: "+e.error)):(o.perfWatch.mark(r,"finish"),o.perfWatch.success(r,e=>Object(a.mc)().ULS.traceTag(596452187,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,e)),Promise.resolve(e)):Promise.reject(new a.e(a.f.IframeProxyEmptyResultMessage,"BaseIframeProxy.postMessage: postMessage succeeded but returned nothing")))).catch(e=>i(e))}constructor(){this.initialized=!1}}class M{initialize(e){return new a.y(this.localStorageKey,e,e=>{this._onMetadataChangedListener&&this._onMetadataChangedListener(e)}),Promise.resolve()}setOnMetadataChangedListener(e){Object(a.mc)().ULS.traceTag(595716297,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),Object(a.mc)().ULS.shipAssertTag(595716298,o.LogCategory.msoulscat_ES_EWAJS,!!e,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=e}constructor(e){this.localStorageKey=e}}class W extends D{initialize(e){return super.innerInitialize().then(()=>{this.registerPushMessageListener("getMetadata_longPollingresult",e=>{this._onMetadataChangedListener&&this._onMetadataChangedListener(Object(a.R)(e))})})}setOnMetadataChangedListener(e){Object(a.mc)().ULS.traceTag(595730647,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"LongPollingMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),Object(a.mc)().ULS.shipAssertTag(595944466,o.LogCategory.msoulscat_ES_EWAJS,!!e,"LongPollingMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=e}}class R extends a.h{constructor(e){super(a.i.SystemClipboard,{browserStorage:!1,systemClipboard:!0,inMemory:!1},e)}}let $=!0;function U(){return $}function F(){$=!1}let N=!0;function J(){return N}function k(){N=!1}function z(){let e=void 0;try{e=window.clipboardData}catch(e){Object(a.mc)().ULS.traceTag(595985225,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"ieSystemClipboard.getDataTransfer: An error occurred when attempting to access window.clipboardData. Error: "+o.utils.getStringifiedError(e))}return e}function H(){if(Object(a.mc)().ULS.shipAssertTag(596455701,o.LogCategory.msoulscat_ES_EWAJS,Object(a.Mb)(),"The browser must be IE"),!Object(a.Mb)())throw new a.u("The browser must be IE")}function V(e){return!!e}function G(e){if(!e)return void Object(a.mc)().ULS.traceTag(596456320,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"A clipboard event parameter is missing");let t=void 0;try{t=e.clipboardData}catch(e){throw Object(a.mc)().ULS.traceTag(595985224,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"systemClipboard.getDataTransfer: An error occurred when attempting to access rawEvent.clipboardData. Error: "+o.utils.getStringifiedError(e)),e}return t}function B(e,t,r,i){let n=!1;try{const i=G(r);if(!i||!V(i))return Object(a.mc)().ULS.traceTag(596456264,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`setData - programmatic ${a.j} and ${a.p} is broken. There is no valid data transfer object. clipboardDataFormat = '${e}'`),!1;n=i.setData(e,t),!1===n&&Object(a.mc)().ULS.traceTag(596456265,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`setData returned false for '${e}'.`)}catch(t){Object(a.mc)().ULS.traceTag(596456266,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`setData with '${e}' threw an exception: ${o.utils.getStringifiedError(t)}`)}return void 0===n&&(n=!0),n}function K(e,t,r,i){if(H(),!i&&!U()&&!J())return Object(a.mc)().ULS.traceTag(596456269,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`setData - programmatic ${a.j} and ${a.p} clipboard access is not supported. rawEvent is empty = ${!!r}`),!1;const n=z();if(!n||!V(n))return Object(a.mc)().ULS.traceTag(596456270,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`setData - ${a.j} and ${a.p} is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '${e}'`),i||(Object(a.mc)().ULS.shipAssertTag(596456271,o.LogCategory.msoulscat_ES_EWAJS,U()&&J(),`setData - programmatic ${a.j} and ${a.p} is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '${U()}'. isProgrammaticAccessSupported = '${J()}'. clipboardDataFormat = '${e}'`),F(),k()),!1;let s,c=e;c===a.hb&&(c=a.ib);try{s=n.setData(c,t),!1===s&&Object(a.mc)().ULS.traceTag(596456272,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`setData returned false for '${c}'.`)}catch(e){Object(a.mc)().ULS.traceTag(596456273,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`setData with '${c}' threw an exception: ${e.message}`)}return!i&&U()&&(F(),!1===s&&k()),void 0===s&&(s=!0),s}function q(){return U()&&K(a.hb,a.jb,void 0,!1),!!J()||(Object(a.mc)().ULS.traceTag(596456274,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`document.execCommand - programmatic clipboard access is not allowed for '${a.j}' and '${a.p}'.`),!1)}const X={execCommandCopy:function(){let e;try{e=document.execCommand(a.j,!1,null)}catch(e){Object(a.mc)().ULS.traceTag(596456262,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`document.execCommand('${a.j}') threw an exception. This is a browser bug. Ignoring. Exception: ${e.message}`)}return void 0===e&&(e=!0),e},execCommandCut:function(){let e;try{e=document.execCommand(a.p,!1,null)}catch(e){Object(a.mc)().ULS.traceTag(596456263,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`document.execCommand('${a.p}') threw an exception. This is a browser bug. Ignoring. Exception: ${e.message}`)}return void 0===e&&(e=!0),e},setData:B,defaultClipboardDataFormat:a.hb},Q={execCommandCopy:function(){if(H(),!q())return!1;try{document.execCommand(a.j,!1,null)}catch(e){Object(a.mc)().ULS.traceTag(596456267,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`document.execCommand('${a.j}') threw an exception. This is a browser bug. Ignoring. Exception: ${e.message}`)}return!0},execCommandCut:function(){if(H(),!q())return!1;try{document.execCommand(a.p,!1,null)}catch(e){Object(a.mc)().ULS.traceTag(596456268,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`document.execCommand('${a.p}') threw an exception. This is a browser bug. Ignoring. Exception: ${e.message}`)}return!0},setData:K,defaultClipboardDataFormat:a.ib};let Y=void 0;function Z(e,t,r,a){return ee().setData(e,t,r,a)}function ee(){return void 0===Y&&(Y=X),Y}Object(a.Mb)()&&(Y=Q);let te=void 0;const re={};function ae(){if(void 0===te&&(te=!1,"chrome"in window)){const e=window.chrome;e&&("runtime"in e&&e.runtime?"sendMessage"in e.runtime&&e.runtime.sendMessage?te=!0:Object(a.mc)().ULS.traceTag(596455703,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"chrome.runtime.sendMessage is not available"):Object(a.mc)().ULS.traceTag(596455704,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"chrome.runtime is not available"))}return te}function oe(e){if(!e||!e.items)return Promise.reject(new a.H(a.I.ClipboardIsInaccessible,`getImageDataUrlFromClipboardData: clipboardData is undefined=${!e} clipboardData.items is undefined=${!e.items}`));for(let t=0;t<e.items.length;t+=1){const r=e.items[t].type&&e.items[t].type.startsWith("image");if(r||Object(a.mc)().ULS.traceTag(528859143,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Non-image type read from System Clipboard. File Type is "+e.items[t].type),"file"===e.items[t].kind&&r)return ie(e.items[t].getAsFile())}return Promise.resolve(a.jb)}function ie(e){const t=o.perfWatch.start("ImageFile_Read_From_Clipboard"),r=e?e.size:-1,i=Object(a.V)(),n=new FileReader;return n.onload=()=>{n.result?(o.perfWatch.success(t,e=>Object(a.mc)().ULS.traceTag(595911452,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,ne(e,r))),i.resolve(n.result.toString())):(o.perfWatch.failure(t,e=>Object(a.mc)().ULS.traceTag(595911453,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,ne(e,r))),i.reject(new a.H(a.I.FileReaderResultIsEmpty,"getImageDataUrlFromClipboardData: FileReader result is null or undefined")))},n.onerror=()=>{o.perfWatch.failure(t,e=>Object(a.mc)().ULS.traceTag(595911454,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,ne(e,r))),i.reject(new a.H(a.I.FileReaderFailed,"getImageDataUrlFromClipboardData: FileReader failed"))},o.perfWatch.mark(t,"Starting_readAsDataURL"),n.readAsDataURL(e),i.promise}function ne(e,t){const r=JSON.parse(e);return r.filesize=t,JSON.stringify(r)}function se(e,t,r){if(H(),!r&&!U()&&!J())return Object(a.mc)().ULS.traceTag(596456327,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`getData - programmatic ${a.E} clipboard access is not supported. rawEvent is empty = ${!!t}`),Promise.resolve(a.jb);const i=z();if(!i||!V(i))return Object(a.mc)().ULS.traceTag(596456328,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`getData - ${a.E} is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '${e}'`),r||(Object(a.mc)().ULS.shipAssertTag(596456329,o.LogCategory.msoulscat_ES_EWAJS,U()&&J(),`getData - programmatic ${a.E} is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '${U()}'. isProgrammaticAccessSupported = '${J()}'. clipboardDataFormat = '${e}'`),F(),k()),Promise.resolve(a.jb);let n=e;n===a.hb&&(n=a.ib);let s=a.jb;try{s=i.getData(n),s||(s=a.jb),Object(a.mc)().ULS.traceTag(596456330,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`getData('${n}') returned ${s.length} characters`)}catch(e){Object(a.mc)().ULS.traceTag(596456331,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`getData with '${n}' threw an exception. This is a browser bug. Ignoring. Exception: ${e.message}`)}if(!r&&U()&&(F(),s===a.jb)){if(B(e,a.bc,void 0))return se(e,void 0,!1).then(t=>(t===a.jb?k():B(e,a.jb,void 0),Promise.resolve(s)));k()}return Promise.resolve(s)}const ce={init:function(){},execCommandPaste:function(){let e;try{e=document.execCommand(a.E,!1,null)}catch(e){Object(a.mc)().ULS.traceTag(596456322,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`document.execCommand('${a.E}') threw an exception. This is a browser bug. Ignoring. Exception: ${e.message}`)}return void 0===e&&(e=!0),e},getData:function(e,t,r){let i=a.jb;try{const r=G(t);if(!r||!V(r))return Promise.resolve(i);if(e===a.Cb)return oe(r);i=r.getData(e),i||(i=a.jb),Object(a.mc)().ULS.traceTag(596456323,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`getData('${e}') returned ${i.length} characters`)}catch(t){Object(a.mc)().ULS.traceTag(596456324,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`getData with '${e}' threw an exception. This is a browser bug. Ignoring. Exception:: ${o.utils.getStringifiedError(t)}`)}return Promise.resolve(i)},browserExtensionPaste:function(){return Promise.reject(new a.e(a.f.NoBrowserExtensionsInConfiguration))}},le={init:function(){},execCommandPaste:function(){if(H(),U()&&se(a.hb,void 0,!1),!J())return Object(a.mc)().ULS.traceTag(596456325,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`document.execCommand - programmatic clipboard '${a.E}' access is not allowed in this session.`),!1;try{document.execCommand(a.E,!1,null)}catch(e){Object(a.mc)().ULS.traceTag(596456326,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`document.execCommand('${a.E}') threw an exception. This is a browser bug. Ignoring. Exception: ${e.message}`)}return!0},getData:se,browserExtensionPaste:function(){return Promise.reject(new a.e(a.f.NoBrowserExtensionsInConfiguration))}},de={init:function(){!function(){const e=Ke().getChromeExtensionIds();if(0===e.length)return;const t={command:"getAvailableCommands"};e.forEach(e=>{window.chrome.runtime.sendMessage(e,t,void 0,t=>{const r=window.chrome.runtime.lastError;if(t&&Array.isArray(t)&&0!==t.length&&!r)re[e]=t;else{let t=a.jb;r&&"message"in r&&"string"==typeof r.message&&(t=r.message),Object(a.mc)().ULS.traceTag(589947074,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`chromeSystemClipboard - 'getAvailableCommands': browser extension '${e}' is not available. Error: ${t}`)}})})}()},execCommandPaste:function(){let e=!1;try{e=document.execCommand(a.E,!1,null),void 0===e&&(e=!0)}catch(e){Object(a.mc)().ULS.traceTag(596455698,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`Chrome: document.execCommand('${a.E}') threw an exception. This is a browser bug. Ignoring. Exception: ${e.message}`)}return e},getData:function(e,t,r){let i=a.jb;try{const r=G(t);if(!r||!V(r))return Promise.resolve(i);if(e===a.Cb)return oe(r);i=r.getData(e),i||(i=a.jb),Object(a.mc)().ULS.traceTag(596455699,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`Chrome: getData('${e}') returned ${i.length} characters`)}catch(t){Object(a.mc)().ULS.traceTag(596455700,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`Chrome: getData with '${e}' threw an exception. This is a browser bug. Ignoring. Exception:: ${o.utils.getStringifiedError(t)}`)}return Promise.resolve(i)},browserExtensionPaste:function(){return function(){if(!ae())return Promise.reject(new a.e(a.f.MissingBrowserExtensionCapability));const e=function(){for(const e in re)if(re[e].includes("getClipboardData"))return e;return null}();return e?function(e,t){return new Promise((r,i)=>{let n=!0;window.chrome.runtime.sendMessage(e,t,void 0,t=>{const o=window.chrome.runtime.lastError;if(!t||"object"!=typeof t||Array.isArray(t)||o){n=!1;let t=a.jb;o&&"message"in o&&"string"==typeof o.message&&(t=o.message),i(new a.e(a.f.UnavailableBrowserExtension,`chromeSystemClipboard - 'getClipboardData': browser extension '${e}' is not available. Error: ${t}`))}else{n=!1;const e=t,a=e.html,o=e.img,i=e.text,s=function(e,t,r){const a=!!e,o=!!t,i=!!r,n=e.includes("<img src=");return o&&!i||o&&a&&n}(a,o,i);r({text:i,html:s?o:a})}}),setTimeout(()=>{n&&(Object(a.mc)().ULS.traceTag(589947076,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`chromeSystemClipboard - getPasteWithExtensionPromise reject the promise after timeout. chromeExtenstionsInfo: '${re}'`),i(new a.e(a.f.UnavailableBrowserExtension,`chromeSystemClipboard - 'getClipboardData': browser extension '${e}' is not available. Timeout after : 2000 ms`)))},2e3)})}(e,{command:"getClipboardData"}).then(t=>{if(!t)return Promise.reject(new a.e(a.f.NoAvailableBrowserExtensions));Object(a.mc)().ULS.traceTag(589947075,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`chromeSystemClipboard - paste by browser extension '${e}'`);const r=Object(a.R)();return r.setItem(a.hb,t.text),r.setItem(a.lc,t.html),r.setItem(a.Rb,e),r}):Promise.reject(new a.e(a.f.NoBrowserExtensionWithGetClipboardDataCommand))}()}};let ue=void 0;function me(){return void 0===ue&&(ue=ae()?de:ce),ue}Object(a.Mb)()&&(ue=le);var ge=r(16);const pe=(e,t)=>{if(be(e))e.replaceChildren(t);else{for(;e.firstChild;)e.removeChild(e.firstChild);fe(e,t)}},fe=(e,t)=>{if(he(e))e.append(t);else if("string"==typeof t){const r=document.createTextNode(t);e.appendChild(r)}else e.appendChild(t)},be=e=>!!e.replaceChildren,he=e=>!!e.append;function Se(){const e=document.getSelection();if(e&&e.getRangeAt&&"function"==typeof e.getRangeAt&&!(e.rangeCount<1))return e.getRangeAt(0)}function ye(e,t,r){Object(a.mc)().ULS.shipAssertTag(596444114,o.LogCategory.msoulscat_ES_EWAJS,!1===t&&!r||!0===t&&(!!r||r===a.jb),`enableClipboardEvents: useTextHtmlContentCandidate = '${t}', textHtmlContentCandidate is ${r||r===a.jb?a.jb:"not "}provided`);let i=document.activeElement&&document.activeElement.id;i||Object(a.mc)().ULS.traceTag(595719625,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"hiddenContentEditableDiv.enableClipboardEvents: activeElementIdToRestore must to be define");const n=function(e,t){let r=ve();if(r&&r.tagName&&"div"!==r.tagName.toLowerCase()&&(r.parentElement&&r.parentElement.removeChild(r),r=void 0),r||(r=function(){const e=document.createElement("div");return function(e){e.id="ccpContentEditable",e.contentEditable="true",Te()&&(e.contentEditable="false"),e.spellcheck=!1,e.setAttribute("autocomplete","off"),e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("aria-hidden","true"),e.tabIndex=-1,e.style.display="inline-block",e.style.position="absolute",e.style.fontSize="10",e.style.height="0px",e.style.width="0px",e.style.top="0px",e.style.left="0px",e.style.zIndex="-100",e.style.overflow="hidden",e.onmousemove=()=>{e.onmousemove=null,Object(a.mc)().ULS.assertTag(595957699,o.LogCategory.msoulscat_ES_EWAJS,!1,"contentEditableElement.onmousemove: Mouse move event is not expected on element 'ccpContentEditable'. it should be covered by other elements")}}(e),document.body.appendChild(e),e}()),Object(a.Mb)()){let o=t;e?o||(o=a.jb):o=we().outerHTML,r.innerHTML=ge.sanitize(o)}else pe(r,e?null!=t?t:a.jb:we());return r}(t,r);i&&i===n.id&&(i=void 0),n.focus();const s=document.getSelection();if(s){s.removeAllRanges();const e=document.createRange();e.selectNodeContents(n),s.addRange(e)}return e&&Ce(!0),i}function Ce(e){if(!Te())return;const t=ve();t&&(t.contentEditable=e?"true":"false")}function Ee(){const e=ve();if(!e)return!1;try{const t=e.clientLeft+e.scrollWidth/2,r=e.clientTop+e.scrollTop/2,a=document.elementFromPoint(t,r);return!!a&&(a.id===e.id||!!a.parentElement&&a.parentElement.id===e.id)}catch(e){return Object(a.mc)().ULS.traceTag(595957534,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"isContentEditableElementVisibleToUser: hit test failed with error: "+o.utils.getStringifiedError(e)),!1}}function ve(){return document.getElementById("ccpContentEditable")}function Le(){const e=ve();e&&(Object(a.Mb)()?e.innerHTML=ge.sanitize(we().outerHTML):pe(e,we()))}function we(){const e=document.createElement("span");return e.innerText=a.ac,e}function Te(){return!Object(a.Mb)()}class _e{get(e){if(this.disposableImplementationExtension.throwIfDisposed("get"),Object(a.mc)().ULS.traceTag(596449096,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`SystemClipboardStorage.get: isKeyboardEvent = '${e.isKeyboardEvent}'`),e.skipSystemClipboardAccess){Object(a.mc)().ULS.traceTag(596124883,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.get: Skipping system clipboard access");const e=Object(a.P)(document,a.F,t=>this.skipSystemClipboardPasteHandler(t,e),!0);return this.removeLastPasteEventListenerCallback=e,Promise.resolve(Object(a.sb)())}if(this.lastDeferredPastePromise&&!this.lastDeferredPastePromise.fulfilled()){const e=this.lastDeferredPastePromise,t=`There exists a pending deferred promise with id '${e.id}', representing an active ${a.E} event. Scheduling a rejection to execute after the current operation.`;Object(a.mc)().ULS.traceTag(596455680,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,t),window.setTimeout(()=>{e.reject(new a.e(a.f.RejectingPendingPastePromiseDueToNewPasteOperation,t))},0)}this.clearPasteCallbackConfiguration(this.lastDeferredPastePromise,!0,!1);const t=Object(a.V)();this.lastDeferredPastePromise=t;const r=t.id,i=Object(a.P)(document,a.F,r=>this.pasteHandler(r,t,e.isKeyboardEvent,i),!0);this.removeLastPasteEventListenerCallback=i,this.selectedRangeToRestore=Se(),this.activeElementIdToRestore=ye(!0,!1);try{let o=!1;if(e.isKeyboardEvent||(o=me().execCommandPaste()),e.isKeyboardEvent);else if(!o)return this.clearPasteCallbackConfiguration(t,!0,!0),e.isAsyncSystemClipboardEnabled?Promise.reject(new a.e(a.f.ClipboardIsInaccessible,`Reject the Promise if not keyboard event in SystemClipboardStorage.get. Deferred promise id = '${r}'`)):me().browserExtensionPaste().then(t=>(e.isChromiumExtension=!0,e.clearSystemClipboard&&this.clearSystemClipboard(),t),t=>(!e.isAsyncSystemClipboardEnabled&&e.clearSystemClipboard&&this.clearSystemClipboard(),Promise.reject(new a.e(a.f.ClipboardIsInaccessible,`document.execCommand(${a.E}) failed in SystemClipboard.get. Deferred promise id = '${r}'`,t))))}catch(e){return this.clearPasteCallbackConfiguration(t,!0,!1),Promise.reject(new a.e(a.f.GetClipboardItems,`Failed in SystemClipboard.get. Deferred promise id = '${r}'`,e))}return t.promise.then(t=>(e.clearSystemClipboard&&this.clearSystemClipboard(),t),t=>(e.clearSystemClipboard&&this.clearSystemClipboard(),Object(a.Hb)(t,a.f.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(t):Promise.reject(new a.e(a.f.GetClipboardItems,`Failed in SystemClipboard.get. Deferred promise id = '${r}'`,t))))}set(e,t){if(this.disposableImplementationExtension.throwIfDisposed("set"),Object(a.mc)().ULS.traceTag(596449097,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`SystemClipboardStorage.set: isKeyboardEvent = '${t.isKeyboardEvent}'; cutCopyPasteFlags = '${t.commandType}'`),Object(a.mc)().ULS.shipAssertTag(595932513,o.LogCategory.msoulscat_ES_EWAJS,!t.skipSystemClipboardAccess,"SystemClipboardStorage.set: skipSystemClipboardAccess shouldn't be used using set of SystemClipboardStorage as we have to set the timestamp metadata in the html in order to support last copy item scenario. "),Object(a.Mb)()&&!t.isKeyboardEvent){if(t.silentClipboardAccessFailures&&U())return Object(a.mc)().ULS.traceTag(596455681,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Aborting attempt to store content in the clipboard since silentClipboardAccessFailures is on and the user did not select Allow access in IE's clipboard access dialog"),Promise.resolve();if(!U()&&!J())return Object(a.mc)().ULS.traceTag(596455682,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection."),Promise.resolve()}if(this.lastDeferredCutCopyPromise&&!this.lastDeferredCutCopyPromise.fulfilled()){const e=this.lastDeferredCutCopyPromise,r=`There exists a pending deferred promise with id '${e.id}', representing an active ${a.p}/${a.j} event. Scheduling a rejection to execute after the current operation.`;Object(a.mc)().ULS.traceTag(596455683,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,r),window.setTimeout(()=>{e.reject(new a.e(t.isKeyboardEvent?a.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation:a.f.RejectingBlockedSyncCutCopyPromise,r))},0)}this.clearCutCopyCallbackConfiguration(this.lastDeferredCutCopyPromise,!0,!1);const r=Object(a.V)();this.lastDeferredCutCopyPromise=r;const i=r.id;try{const n=Object(a.tb)(e),s=_e.getClipboardCutCopyEventType(t.commandType),c=Object(a.P)(document,s,e=>{t.isTimestampStoredInSystemClipboard=!0,this.cutCopyHandler(e,r,n,t.isKeyboardEvent,t.commandType,c)});this.removeLastCutCopyEventListenerCallback=c;let l=a.jb;Object(a.Mb)()&&(l=Object(a.lb)(n,a.lc)),this.selectedRangeToRestore=Se(),this.activeElementIdToRestore=ye(!1,!!l,l);let d=!1;if(Object(a.Mb)()&&t.isKeyboardEvent||(d=t.commandType===a.r.Cut?ee().execCommandCut():ee().execCommandCopy()),t.isKeyboardEvent);else if(!d)return this.clearCutCopyCallbackConfiguration(r,!0,!0),!Object(a.Mb)()||U()||J()||(Object(a.mc)().ULS.traceTag(596455684,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection. Deferred promise id = '${i}'`),r.resolve()),Promise.resolve()}catch(e){return this.clearCutCopyCallbackConfiguration(r,!0,!1),Promise.reject(new a.e(a.f.SetClipboardItems,`Failed in SystemClipboard.set. Deferred promise id = '${i}'`,e))}return r.promise.catch(e=>e&&Object(a.Ib)(e,[a.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,a.f.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.reject(new a.e(a.f.SetClipboardItems,`Failed in SystemClipboard.set. Deferred promise id = '${i}'`,e)))}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[a.hb,a.lc,a.Cb]}cutCopyHandler(e,t,r,i,n,s){try{if(Object(a.mc)().ULS.traceTag(596449098,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '${i}'; cutCopyPasteFlags = '${n}'; bubbles = '${e.bubbles}'; eventPhase = '${e.eventPhase}'`),s(),this.removeLastCutCopyEventListenerCallback===s&&(this.removeLastCutCopyEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("cutCopyHandler"))return;if(Object(a.mc)().ULS.shipAssertTag(596455686,o.LogCategory.msoulscat_ES_EWAJS,!!t,`SystemClipboardStorage.cutCopyHandler: the deferred promise parameter is missing. isKeyboardEvent = '${i}'; cutCopyPasteFlags = '${n}'`),!t)return;if(Object(a.mc)().ULS.traceTag(596455687,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '${i}'; cutCopyPasteFlags = '${n}'; deferred promise id = '${t.id}'`),Object(a.mc)().ULS.shipAssertTag(596455688,o.LogCategory.msoulscat_ES_EWAJS,!t.fulfilled(),`SystemClipboardStorage.cutCopyHandler: deferred promise '${t.id}' is already fulfilled. isKeyboardEvent = '${i}'; cutCopyPasteFlags = '${n}'`),t.fulfilled())return;const c=()=>{t.resolve(),this.clearCutCopyCallbackConfiguration(t,!1,!1)},l=Object(a.lb)(r,a.lc);if(l&&Object(a.Mb)())window.setTimeout(c,0);else{l&&Z(a.lc,l,e,i);const t=Object(a.pb)(r);Z(ee().defaultClipboardDataFormat,t,e,i),e.preventDefault(),c()}}catch(e){this.clearCutCopyCallbackConfiguration(t,!1,!1),Object(a.mc)().ULS.traceTag(596455689,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`SystemClipboardStorage.cutCopyHandler callback with deferred promise id '${t?t.id:a.jb}' (fulfilled = '${t?t.fulfilled():a.jb}') failed with this exception: ${e&&e.message?e.message:"NA"}. Call stack: ${e.stack?e.stack:"NA"}`),t&&t.reject(new a.e(a.f.SetClipboardItems,`Failed in SystemClipboard.set > cutCopyHandler callback. Deferred promise id = '${t.id}'. Error: ${e&&e.message?e.message:"NA"}`,e))}}pasteHandler(e,t,r,i){let n=!0;try{if(Object(a.mc)().ULS.traceTag(596449099,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`SystemClipboardStorage.pasteHandler: isKeyboardEvent = '${r}'; eventPhase='${e.eventPhase}'`),e.preventDefault(),i(),this.removeLastPasteEventListenerCallback===i&&(this.removeLastPasteEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("pasteHandler"))return;if(Object(a.mc)().ULS.shipAssertTag(596455690,o.LogCategory.msoulscat_ES_EWAJS,!!t,`SystemClipboardStorage.pasteHandler: the deferred promise parameter is missing. isKeyboardEvent = '${r}'`),!t)return;if(Object(a.mc)().ULS.traceTag(596455691,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`SystemClipboardStorage.pasteHandler: isKeyboardEvent = '${r}'; deferred promise id = '${t.id}'`),Object(a.mc)().ULS.shipAssertTag(596455692,o.LogCategory.msoulscat_ES_EWAJS,!t.fulfilled(),`SystemClipboardStorage.pasteHandler: deferred promise '${t.id}' is already fulfilled. isKeyboardEvent = '${r}'`),t.fulfilled())return;const s=Object(a.R)(),c=this.getSupportedDataFormats(),l=this.readDataFormats(c,e,r,s);Promise.all(l).then(()=>{e.stopPropagation(),n=!1,Object(a.Mb)()?window.setTimeout(()=>{const e=document.getElementById("ccpContentEditable");if(e&&e.firstChild&&"IMG"===e.firstChild.nodeName){const t=e.firstChild;t&&t.src&&t.src.indexOf("base64")>-1?s.setItem(a.Cb,t.src):Object(a.mc)().ULS.traceTag(595907107,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: IE has provided the IMG HTML rather than the image blob, which is unsupported.")}else s.setItem(a.lc,function(){const e=ve();return Object(a.mc)().ULS.shipAssertTag(596444113,o.LogCategory.msoulscat_ES_EWAJS,!!e,"getTextHtmlContent: the content editable element does not exist"),e?ge.sanitize(e.innerHTML):a.jb}()),a.Bb.isContainsTimestampWrapper(e)&&s.setItem(a.hb,a.Bb.createPlainTextFromHtml(e));Le(),t.resolve(s),this.clearPasteCallbackConfiguration(t,!1,!1)},0):(Le(),t.resolve(s),this.clearPasteCallbackConfiguration(t,!1,!1))})}catch(r){Le();try{n&&e.stopPropagation()}catch(e){Object(a.mc)().ULS.traceTag(595985030,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"SystemClipboardStorage.pasteHandler: failed when performing stopPropagation/preventDefault on the raw event. Failed with an exception: "+o.utils.getStringifiedError(e))}this.clearPasteCallbackConfiguration(t,!1,!1),Object(a.mc)().ULS.traceTag(596455693,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`SystemClipboardStorage.pasteHandler callback with deferred promise id '${t?t.id:a.jb}' (fulfilled = '${t?t.fulfilled():a.jb}') failed with an exception: ${r&&r.message?r.message:"NA"}. Call stack: ${r.stack?r.stack:"NA"}`),t&&t.reject(new a.e(a.f.GetClipboardItems,`Failed in SystemClipboard.get > pasteHandler callback. Deferred promise id = '${t.id}'. Error: ${r&&r.message?r.message:"NA"}`,r))}}isFileFormat(e){return e===a.Cb}isPlainTextEmpty(e){const t=e.getItem("text/plain");return!t||0===t.length}readDataFormats(e,t,r,i){if(!this.skipFilesIfPlainTextExists||!r&&Object(a.Gb)())return this.readDataFormatsInternal(e,t,r,i);const n=e.filter(e=>this.isFileFormat(e));if(0===n.length)return this.readDataFormatsInternal(e,t,r,i);const s=e.filter(e=>!this.isFileFormat(e)),c=this.readDataFormatsInternal(s,t,r,i);return[Promise.all(c).then(()=>{if(!this.isPlainTextEmpty(i))return Object(a.mc)().ULS.traceTag(595653317,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.readDataFormats: skip files loading because clipboard contains plain text"),Promise.resolve();const e=this.readDataFormatsInternal(n,t,r,i);return Promise.all(e)})]}readDataFormatsInternal(e,t,r,i){const n=[];return e.forEach(e=>{n.push(function(e,t,r){return me().getData(e,t,r)}(e,t,r).then(t=>{Object(a.mc)().ULS.traceTag(541646989,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.readDataFormatsInternal: Read "+e+" from clipboard"),i.setItem(e,t)}).catch(t=>{Object(a.mc)().ULS.traceTag(595653318,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,`SystemClipboardStorage.readDataFormatsInternal: Failed to get data of type [${e}]. Error [${o.utils.getStringifiedError(t)}]`)}))}),n}skipSystemClipboardPasteHandler(e,t){try{t(),e.stopPropagation(),e.preventDefault()}catch(e){Object(a.mc)().ULS.traceTag(595993058,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`SystemClipboardStorage.skipSystemClipboardPasteHandler: failed with an exception: ${e&&e.message?e.message:"NA"}. Call stack: ${e.stack?e.stack:"NA"}`)}this.removeLastPasteEventListenerCallback===t&&(this.removeLastPasteEventListenerCallback=void 0)}hasPlainText(e){return!!e&&Object.keys(e.getData().items).indexOf(a.hb)>-1}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(a.gc)([()=>{this.lastDeferredCutCopyPromise&&!this.lastDeferredCutCopyPromise.fulfilled()&&(this.lastDeferredCutCopyPromise.reject(),this.lastDeferredCutCopyPromise=void 0,this.removeLastCutCopyEventListenerCallback&&(this.removeLastCutCopyEventListenerCallback(),this.removeLastCutCopyEventListenerCallback=void 0))},()=>{this.lastDeferredPastePromise&&!this.lastDeferredPastePromise.fulfilled()&&(this.lastDeferredPastePromise.reject(),this.lastDeferredPastePromise=void 0,this.removeLastPasteEventListenerCallback&&(this.removeLastPasteEventListenerCallback(),this.removeLastPasteEventListenerCallback=void 0))}]),this.disposableImplementationExtension.dispose())}static getClipboardCutCopyEventType(e){if(!e)return a.k;if(e===a.r.Copy)return a.k;if(e===a.r.Cut)return a.q;throw new a.t(a.jb,"cutCopyPasteFlags",e.toString())}restoreFocusToPreviouslyActiveElement(){if(!this.activeElementIdToRestore)return;const e=document.getElementById(this.activeElementIdToRestore);e&&e.focus(),this.activeElementIdToRestore=void 0}restoreSelection(){this.selectedRangeToRestore&&(function(e){if(!e)return;const t=document.getSelection();t&&t.removeAllRanges&&"function"==typeof t.removeAllRanges&&t.addRange&&"function"==typeof t.addRange&&(t.removeAllRanges(),t.addRange(e))}(this.selectedRangeToRestore),this.selectedRangeToRestore=void 0)}clearCutCopyCallbackConfiguration(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),Object(a.mc)().ULS.shipAssertTag(595957697,o.LogCategory.msoulscat_ES_EWAJS,!Ee(),"SystemClipboardStorage.set: ccpContentEditable is visible to the user during a copy/cut operation, but it should not be visible."),(e===this.lastDeferredCutCopyPromise||e&&this.lastDeferredCutCopyPromise&&e.id===this.lastDeferredCutCopyPromise.id)&&(this.lastDeferredCutCopyPromise=void 0),t&&this.removeLastCutCopyEventListenerCallback&&(r||Object(a.mc)().ULS.traceTag(596449290,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`SystemClipboardStorage.set: the ${a.p}/${a.j} event listener was not called. Calling removeLastCutCopyEventListenerCallback()`),this.removeLastCutCopyEventListenerCallback(),this.removeLastCutCopyEventListenerCallback=void 0)}clearPasteCallbackConfiguration(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),Ce(!1),Object(a.mc)().ULS.shipAssertTag(595957698,o.LogCategory.msoulscat_ES_EWAJS,!Ee(),"SystemClipboardStorage.clearPasteCallbackConfiguration: ccpContentEditable is visible to the user during a paste operation, but it should not be visible"),(e===this.lastDeferredPastePromise||e&&this.lastDeferredPastePromise&&e.id===this.lastDeferredPastePromise.id)&&(this.lastDeferredPastePromise=void 0),t&&this.removeLastPasteEventListenerCallback&&(r||Object(a.mc)().ULS.traceTag(596449291,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`SystemClipboardStorage.get: the ${a.E} event listener was not called. Calling removeLastPasteEventListenerCallback()`),this.removeLastPasteEventListenerCallback(),this.removeLastPasteEventListenerCallback=void 0)}clearSystemClipboard(){const e=Object(a.sb)(),t={isKeyboardEvent:!1,commandType:a.r.Copy};this.set(e,t).then(()=>{Object(a.mc)().ULS.traceTag(595935906,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard succeed")},()=>{Object(a.mc)().ULS.traceTag(595935907,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard failed")})}constructor(e){this.lastDeferredCutCopyPromise=void 0,this.removeLastCutCopyEventListenerCallback=void 0,this.lastDeferredPastePromise=void 0,this.selectedRangeToRestore=void 0,this.removeLastPasteEventListenerCallback=void 0,this.activeElementIdToRestore=void 0,this.skipFilesIfPlainTextExists=e,this.clipboardStorageType=a.g.SystemClipboard,this.disposableImplementationExtension=Object(a.X)("SystemClipboardStorage"),me().init()}}class Ie extends a.h{constructor(e){super(a.i.InMemory,{browserStorage:!1,systemClipboard:!1,inMemory:!0},e)}}class Pe{dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.inMemoryClipboardItems=void 0,this.disposableImplementationExtension.dispose())}get(e){return this.disposableImplementationExtension.throwIfDisposed("get"),this.inMemoryClipboardItems?Promise.resolve(this.inMemoryClipboardItems):Promise.resolve(Object(a.sb)())}set(e,t){return this.disposableImplementationExtension.throwIfDisposed("set"),this.inMemoryClipboardItems=e,Promise.resolve()}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[a.hb,a.lc,"data/shadow-workbook"]}constructor(){this.clipboardStorageType=a.g.InMemory,this.disposableImplementationExtension=Object(a.X)("InMemoryClipboardStorage")}}class Ae extends a.h{constructor(e){super(a.i.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},e)}}class Oe{initialize(e,t){return this.initialized=!1,this.systemClipboardStrategy=void 0,this.fullAccessClipboardStrategy=void 0,e.then(e=>(this.systemClipboardStrategy=e,t.then(e=>(this.fullAccessClipboardStrategy=e,this.initialized=!0,Promise.resolve(this)))))}set(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new a.e(a.f.ClipboardStrategyNotInitialized));const r={systemClipboardOperationResult:Object(a.T)(a.ac,"setresult",!1),fullAccessClipboardOperationResult:Object(a.T)(a.ac,"setresult",!1)};return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.preSetProcess(e),this.systemClipboardStrategy.set(e,t).then(()=>Promise.resolve(r),e=>(r.systemClipboardOperationResult.failed=!0,r.systemClipboardOperationResult.clipboardOperationResultError=e,Object(a.Ib)(e,[a.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,a.f.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.resolve(r))).then(r=>this.fullAccessClipboardStrategy?this.fullAccessClipboardStrategy.set(e,t).then(()=>Promise.resolve(r),e=>(Object(a.mc)().ULS.traceTag(595933078,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`Failed to save to fullAccessClipboardStrategy. clipboardStrategyType: '${this.fullAccessClipboardStrategy&&this.fullAccessClipboardStrategy.clipboardStrategyType}', Command Id: '${t.id?t.id:a.jb}', Error: ${o.utils.getStringifiedError(e)}`),r.fullAccessClipboardOperationResult.failed=!0,r.fullAccessClipboardOperationResult.clipboardOperationResultError=e,Promise.resolve(r))):(r.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(r))).then(e=>{if(e.systemClipboardOperationResult.failed&&e.fullAccessClipboardOperationResult.failed){let t=e.systemClipboardOperationResult.clipboardOperationResultError;return t||(t=e.fullAccessClipboardOperationResult.clipboardOperationResultError),t?Promise.reject(t):Promise.reject(new a.e(a.f.SetClipboardItems,a.jb))}return Promise.resolve()})}catch(e){return Promise.reject(new a.e(a.f.SetClipboardItems,"Failed in system clipboard.set",e))}}get(e){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new a.e(a.f.ClipboardStrategyNotInitialized));const t={systemClipboardOperationResult:Object(a.T)(a.ac,"getresult",!1,void 0,Object(a.qb)()),fullAccessClipboardOperationResult:Object(a.T)(a.ac,"getresult",!1,void 0,Object(a.qb)())};return this.systemClipboardStrategy.get(e).then(e=>(t.systemClipboardOperationResult.clipboardItemsData=e.getData(),this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.postGetProcess(t.systemClipboardOperationResult),Promise.resolve(t))).catch(r=>(Object(a.mc)().ULS.traceTag(507904974,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`Failed to get data from systemClipboardStrategy. clipboardStrategyType: '${this.systemClipboardStrategy&&this.systemClipboardStrategy.clipboardStrategyType}', Command Id: '${e.id?e.id:a.jb}', Error: ${o.utils.getStringifiedError(r)}`),t.systemClipboardOperationResult.failed=!0,t.systemClipboardOperationResult.clipboardOperationResultError=r,Object(a.Hb)(r,a.f.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(r):Promise.resolve(t))).then(t=>this.fullAccessClipboardStrategy?this.fullAccessClipboardStrategy.get(e).then(e=>(t.fullAccessClipboardOperationResult.clipboardItemsData=e.getData(),this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.postGetProcess(t.fullAccessClipboardOperationResult),Promise.resolve(t))).catch(r=>(Object(a.mc)().ULS.traceTag(595933079,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,`Failed to get from fullAccessClipboardStrategy. clipboardStrategyType: '${this.fullAccessClipboardStrategy&&this.fullAccessClipboardStrategy.clipboardStrategyType}', Command Id: '${e.id?e.id:a.jb}', Error: ${o.utils.getStringifiedError(r)}`),t.fullAccessClipboardOperationResult.failed=!0,t.fullAccessClipboardOperationResult.clipboardOperationResultError=r,Promise.resolve(t))):(t.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(t))).then(t=>{if(t.systemClipboardOperationResult.failed||e.skipSystemClipboardAccess){if(t.fullAccessClipboardOperationResult.failed){let e=t.systemClipboardOperationResult.clipboardOperationResultError;return e||(e=t.fullAccessClipboardOperationResult.clipboardOperationResultError),e?Promise.reject(e):Promise.reject(new a.e(a.f.GetClipboardItems,a.jb))}return 0===Object(a.ob)(t.fullAccessClipboardOperationResult.clipboardItemsData)?Promise.reject(t.systemClipboardOperationResult.clipboardOperationResultError):this.validateAndReturnFullAccessData(t)}return t.fullAccessClipboardOperationResult.failed?Promise.resolve(Object(a.R)(t.systemClipboardOperationResult.clipboardItemsData)):Object(a.Jb)()&&!Object(a.Lb)()?this.pasteSourceReconciliationBasedOnlyOnTextPlain(t):this.pasteSourceReconciliation(t,e)})}catch(e){return Promise.reject(new a.e(a.f.GetClipboardItems,"Failed in system clipboard.get",e))}}onSystemClipboardChangedExternally(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.initialized?this.fullAccessClipboardStrategy?this.fullAccessClipboardStrategy.onSystemClipboardChangedExternally(e):(Object(a.mc)().ULS.shipAssertTag(595882509,o.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.fullAccessClipboardStrategy should be defined"),Promise.reject(new a.e(a.f.ClipboardStrategyNotInitialized))):Promise.reject(new a.e(a.f.ClipboardStrategyNotInitialized))}catch(e){return Promise.reject(new a.e(a.f.ClearClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).onSystemClipboardChangedExternally`,e))}}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(a.gc)([()=>{this.systemClipboardStrategy&&this.systemClipboardStrategy.dispose()},()=>{this.fullAccessClipboardStrategy&&this.fullAccessClipboardStrategy.dispose()}]),this.disposableImplementationExtension.dispose())}pasteSourceReconciliation(e,t){let r=void 0;e.systemClipboardOperationResult.signatureData&&(r=e.systemClipboardOperationResult.signatureData.ccp_infra_timestamp);let i,n=void 0;return e.fullAccessClipboardOperationResult.signatureData&&(n=e.fullAccessClipboardOperationResult.signatureData.ccp_infra_timestamp),Object(a.mc)().ULS.traceTag(595719624,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`systemClipboardAndFullAccessClipboardStrategy.pasteSourceReconciliation: ccpTimestampInSystemClipboard=${r} ccpTimestampInFullAccessClipboard=${n}`),r?(i=n||0,r>i?(je(e.systemClipboardOperationResult.clipboardItemsData,!0),Promise.resolve(Object(a.R)(e.systemClipboardOperationResult.clipboardItemsData))):Promise.resolve(Object(a.R)(e.fullAccessClipboardOperationResult.clipboardItemsData))):t.isTimestampStoredInSystemClipboard?xe(e)?Promise.resolve(Object(a.R)(e.fullAccessClipboardOperationResult.clipboardItemsData)):De(e)?this.validateAndReturnFullAccessData(e):(je(e.systemClipboardOperationResult.clipboardItemsData,!1),Promise.resolve(Object(a.R)(e.systemClipboardOperationResult.clipboardItemsData))):this.validateAndReturnFullAccessData(e)}validateAndReturnFullAccessData(e){return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.validateUserHash(e.fullAccessClipboardOperationResult.signatureData),Promise.resolve(Object(a.R)(e.fullAccessClipboardOperationResult.clipboardItemsData))}pasteSourceReconciliationBasedOnlyOnTextPlain(e){return 0===Object(a.ob)(e.systemClipboardOperationResult.clipboardItemsData)||0===Object(a.ob)(e.fullAccessClipboardOperationResult.clipboardItemsData)?Promise.resolve(Object(a.R)(e.systemClipboardOperationResult.clipboardItemsData)):xe(e)?Promise.resolve(Object(a.R)(e.fullAccessClipboardOperationResult.clipboardItemsData)):De(e)?this.validateAndReturnFullAccessData(e):(e.systemClipboardOperationResult.clipboardItemsData.items[a.Wb]=a.Yb,Promise.resolve(Object(a.R)(e.systemClipboardOperationResult.clipboardItemsData)))}constructor(e,t,r,o){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this._fullAccessClipboardStrategyType=r,this.dualClipboardDataProcessor=o,this.initialized=!1,this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.disposableImplementationExtension=Object(a.X)(""+e)}}function je(e,t){e.items[a.Wb]=a.Yb,t&&(e.items[a.Xb]=a.Zb)}function xe(e){const t=e.systemClipboardOperationResult.clipboardItemsData.items[a.hb],r=a.Bb.ensureOneLFPerNewLine(a.Bb.trimToLength(t)),o=e.fullAccessClipboardOperationResult.clipboardItemsData.items[a.hb];return!!o&&r===a.Bb.ensureOneLFPerNewLine(a.Bb.trimToLength(o))}function De(e){const t=e.systemClipboardOperationResult.clipboardItemsData.items[a.hb];return a.Bb.ensureOneLFPerNewLine(a.Bb.trimToLength(t))===Ke().getCopyToClipboardLatencyMessage()}class Me extends Oe{constructor(e){super(a.i.SystemClipboardAndLocalStorage,{browserStorage:!0,systemClipboard:!0,inMemory:!1},a.i.LocalStorage,e)}}class We extends Oe{constructor(e){super(a.i.SystemClipboardAndInMemory,{browserStorage:!1,systemClipboard:!0,inMemory:!0},a.i.InMemory,e)}}class Re extends D{initialize(){return this.innerInitialize().then(()=>this)}get(e){this.disposableImplementationExtension.throwIfDisposed("get"),Object(a.mc)().ULS.traceTag(595947538,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`ClipboardStorageIframeProxy.get: isKeyboardEvent = ${e.isKeyboardEvent}; silentClipboardAccessFailures = ${e.silentClipboardAccessFailures||!1}`);const t=Object(a.S)(Object(a.bb)(),"get",this.messageDestination,e.userHash);return this.postMessage(t,"get").then(e=>e.clipboardItemsData?Promise.resolve(Object(a.R)(e.clipboardItemsData)):Promise.resolve(Object(a.sb)()))}set(e,t){let r;return this.disposableImplementationExtension.throwIfDisposed("set"),Object(a.mc)().ULS.traceTag(595947541,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`ClipboardStorageIframeProxy.set: isKeyboardEvent = ${t.isKeyboardEvent}; silentClipboardAccessFailures = ${t.silentClipboardAccessFailures||!1}`),r=Object(a.nb)(e)>0?Object(a.S)(Object(a.bb)(),"set",this.messageDestination,t.userHash,e.getData()):Object(a.S)(Object(a.bb)(),"set",this.messageDestination),this.postMessage(r,"set").then(()=>{})}clearClipboardNecessary(e,t){return Object(a.kc)(e,t)}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[a.hb,a.lc,"data/shadow-workbook"]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e,t){if(super(),this.messageDestination=t,!t)throw new a.B(a.jb,"messageDestination");this.clipboardStorageType=e,this.disposableImplementationExtension=Object(a.X)(t)}}class $e extends Re{constructor(e){super(a.g.LocalStorage,e)}}class Ue extends a.h{constructor(e){super(a.i.AsyncSystemClipboard,{browserStorage:!1,systemClipboard:!0,inMemory:!1},e)}}var Fe,Ne=r(3);class Je{get(e){var t=this;return _async_to_generator((function*(){t.disposableImplementationExtension.throwIfDisposed("get"),e.isAsyncClipboardAPI=!0;const r=window.performance.now();if(e.skipSystemClipboardAccess)return Promise.resolve(Object(a.sb)());const i=t.cancelLastPendingPaste(e),n=Object(a.V)();let s=null;if(e.isKeyboardEvent)t.isLastPasteEventListenerRemoved=!1,s=Object(a.P)(document,a.F,i=>{var c;i.preventDefault(),i.stopPropagation(),null===(c=s)||void 0===c||c(),t.lastRemovePasteEventListener=null,t.isLastPasteEventListenerRemoved=!0,Object(a.mc)().ULS.traceTag(507012887,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`AsyncSystemClipboardStorage.get - Paste event triggered by keyboard. DeferredPromiseId: ${null==n?void 0:n.id}, Command id: ${e.id}`),t.readFromSystemClipboard(e,r).then(e=>{null==n||n.resolve(e)}).catch(e=>{null==n||n.reject(e)})},!0);else{const i={name:"clipboard-read",allowWithoutGesture:!1};try{var c;const r=yield null===(c=navigator.permissions)||void 0===c?void 0:c.query(i);if(Object(a.mc)().ULS.traceTag(507626376,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`AsyncSystemClipboardStorage.get - Clipboard read permission state: ${null==r?void 0:r.state}. Command id: ${e.id}`),t.initialClipboardPermissionState=null==r?void 0:r.state,"denied"===(null==r?void 0:r.state))throw t.clipboardIsInaccessibleError;"prompt"===(null==r?void 0:r.state)&&(t.isActionPerformedOnPermissionPrompt=!1,r.onchange=()=>{t.isActionPerformedOnPermissionPrompt=!0,"denied"===(null==r?void 0:r.state)?Object(a.mc)().ULS.traceTag(507626375,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"AsyncSystemClipboardStorage.get - Clipboard read permission is denied from prompt. Command id: "+e.id):"granted"===(null==r?void 0:r.state)&&Object(a.mc)().ULS.traceTag(507626374,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"AsyncSystemClipboardStorage.get - Clipboard read permission is granted from prompt. Command id: "+e.id)})}catch(r){if(r===t.clipboardIsInaccessibleError)throw r;Object(a.mc)().ULS.traceTag(508651269,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`AsyncSystemClipboardStorage.get: Failed to query "clipboard-read" permission. Command id: ${e.id}, Error: ${o.utils.getStringifiedError(r)}`)}try{const a=yield t.readFromSystemClipboard(e,r);n.resolve(a)}catch(e){n.reject(e)}}return yield i,t.lastClipboardItemsDeferredPromise=n,t.lastRemovePasteEventListener=s,n.promise}))()}set(e,t){var r=this;return _async_to_generator((function*(){r.disposableImplementationExtension.throwIfDisposed("set"),t.isAsyncClipboardAPI=!0;const i=window.performance.now(),n=Object(Ne.a)("Microsoft.Office.Excel.EnableAsyncClipboardApiWriteSW",!1),s=r.getSupportedDataFormats();try{const l={name:"clipboard-write",allowWithoutGesture:!1};try{var c;const e=yield null===(c=navigator.permissions)||void 0===c?void 0:c.query(l);if(Object(a.mc)().ULS.traceTag(507626372,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`AsyncSystemClipboardStorage.set - Clipboard write permission state: ${null==e?void 0:e.state}. Command id: ${t.id}`),r.initialClipboardPermissionState=null==e?void 0:e.state,"denied"===(null==e?void 0:e.state))throw r.clipboardIsInaccessibleError;"prompt"===(null==e?void 0:e.state)&&(r.isActionPerformedOnPermissionPrompt=!1,e.onchange=()=>{r.isActionPerformedOnPermissionPrompt=!0,"denied"===(null==e?void 0:e.state)?Object(a.mc)().ULS.traceTag(507626371,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"AsyncSystemClipboardStorage.set - Clipboard write permission is denied from prompt. Command id: "+t.id):"granted"===(null==e?void 0:e.state)&&Object(a.mc)().ULS.traceTag(507626370,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"AsyncSystemClipboardStorage.set - Clipboard write permission is granted from prompt. Command id: "+t.id)})}catch(e){if(e===r.clipboardIsInaccessibleError)throw e;Object(a.mc)().ULS.traceTag(508651268,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`AsyncSystemClipboardStorage.set: Failed to query "clipboard-write" permission. Command id: ${t.id}, Error: ${o.utils.getStringifiedError(e)}`)}const d=Object(a.tb)(e);if(!d||d.length<1)return;const u={};for(const e of d){if(!s.includes(e.clipboardDataFormat))continue;const t=Object(a.lb)(d,e.clipboardDataFormat),o=new Blob([t],{type:e.clipboardDataFormat}),i=s.includes(`${r.webCustomFormatPrefix}${e.clipboardDataFormat}`);i&&n?u[`${r.webCustomFormatPrefix}${e.clipboardDataFormat}`]=o:i||(u[e.clipboardDataFormat]=o)}const m=new ClipboardItem(u,{unsanitized:[a.lc]});yield navigator.clipboard.write([m]);const g=window.performance.now()-i;Object(a.mc)().ULS.traceTag(508703872,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`AsyncSystemClipboardStorage.set: Write successful. Command id: ${t.id}, TimeInMs: ${g}`),t.isTimestampStoredInSystemClipboard=!0}catch(e){throw"prompt"!==r.initialClipboardPermissionState||r.isActionPerformedOnPermissionPrompt||Object(a.mc)().ULS.traceTag(507626369,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"AsyncSystemClipboardStorage.set - Clipboard write permission prompt is closed without any action. Command id: "+t.id),Object(a.mc)().ULS.traceTag(508843076,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`AsyncSystemClipboardStorage.set: Failed to write data formats to system clipboard. Command id: ${t.id}, Error: ${o.utils.getStringifiedError(e)}`),new a.e(a.f.ClipboardIsInaccessible,"AsyncSystemClipboardStorage.set - Clipboard permission is denied or failed to write. Command id: "+t.id,e)}}))()}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[a.hb,a.lc,a.Cb,a.hc,a.ic,a.Sb,a.Tb]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.lastClipboardItemsDeferredPromise&&!this.lastClipboardItemsDeferredPromise.fulfilled()&&(this.lastClipboardItemsDeferredPromise.reject(),this.lastClipboardItemsDeferredPromise=null),this.lastRemovePasteEventListener&&(this.lastRemovePasteEventListener(),this.lastRemovePasteEventListener=null),this.disposableImplementationExtension.dispose())}readFromSystemClipboard(e,t){var r=this;return _async_to_generator((function*(){const i=Object(a.R)();try{const s=Object(Ne.a)("Microsoft.Office.Excel.EnableAsyncClipboardApiReadSW",!1),c=r.getSupportedDataFormats(),l=yield navigator.clipboard.read({unsanitized:[a.lc]});if(!l||l.length<1)return i;for(const d of l)for(const l of d.types){if(!c.includes(l))continue;const u=yield d.getType(l);if(!u){Object(a.mc)().ULS.traceTag(506840981,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`AsyncSystemClipboardStorage.readFromSystemClipboard: Failed to read blob for '${l}' type, Command id: ${e.id}, isKeyboardEvent: ${e.isKeyboardEvent}`);continue}let m;m=l===a.Cb?yield(n=u,ie(n)):yield u.text();const g=window.performance.now()-t;Object(a.mc)().ULS.traceTag(508703873,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`AsyncSystemClipboardStorage.readFromSystemClipboard: Read successful. DataFormat: '${l}', TimeInMs: ${g}, Command id: ${e.id}, isKeyboardEvent: ${e.isKeyboardEvent}`);const p=l.startsWith(r.webCustomFormatPrefix);p&&s?i.setItem(l.replace(r.webCustomFormatPrefix,""),m):p||i.setItem(l,m)}}catch(t){if("prompt"!==r.initialClipboardPermissionState||r.isActionPerformedOnPermissionPrompt||e.isKeyboardEvent||Object(a.mc)().ULS.traceTag(507626373,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"AsyncSystemClipboardStorage.readFromSystemClipboard - Clipboard read permission prompt is closed without any action. Command id: "+e.id),t.name===r.emptyClipboardReadErrorName&&t.message===r.emptyClipboardReadErrorMessage)return Object(a.mc)().ULS.traceTag(508352130,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`AsyncSystemClipboardStorage.readFromSystemClipboard: System clipboard is empty. Command id: ${e.id}, Error: ${o.utils.getStringifiedError(t)}`),i;throw Object(a.mc)().ULS.traceTag(508843077,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`AsyncSystemClipboardStorage.readFromSystemClipboard: Failed to read data formats from system clipboard. Command id: ${e.id}, IsKeyboardEvent: ${e.isKeyboardEvent}, Error: ${o.utils.getStringifiedError(t)}`),new a.e(a.f.ClipboardIsInaccessible,"AsyncSystemClipboardStorage.readFromSystemClipboard - Clipboard permission is denied or failed to read. Command id: "+e.id,t)}finally{e.clearSystemClipboard&&r.clearSystemClipboard()}var n;return i}))()}clearSystemClipboard(){return _async_to_generator((function*(){try{yield navigator.clipboard.writeText(""),Object(a.mc)().ULS.traceTag(508703843,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"AsyncSystemClipboardStorage.clearSystemClipboard: Clipboard cleared")}catch(e){Object(a.mc)().ULS.traceTag(508703842,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"AsyncSystemClipboardStorage.clearSystemClipboard: Failed to clear system clipboard.")}}))()}cancelLastPendingPaste(e){return new Promise((t,r)=>{setTimeout(()=>{try{if(this.lastRemovePasteEventListener&&!this.isLastPasteEventListenerRemoved&&(Object(a.mc)().ULS.traceTag(507007387,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"AsyncSystemClipboardStorage.cancelLastPendingPaste - Removed last paste event listener, Command id: "+e.id),this.lastRemovePasteEventListener(),this.lastRemovePasteEventListener=null),this.lastClipboardItemsDeferredPromise&&!this.lastClipboardItemsDeferredPromise.fulfilled()){const t=`AsyncSystemClipboardStorage.cancelLastPendingPaste - Rejected last ClipboardItemsDeferredPromise, Command id: ${e.id}, DeferredPromiseId: ${this.lastClipboardItemsDeferredPromise.id}`;Object(a.mc)().ULS.traceTag(507007386,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,t),this.lastClipboardItemsDeferredPromise.reject(new a.e(a.f.RejectingPendingPastePromiseDueToNewPasteOperation,t)),this.lastClipboardItemsDeferredPromise=null}}catch(t){Object(a.mc)().ULS.traceTag(507007385,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"AsyncSystemClipboardStorage.cancelLastPendingPaste - Failed to clear the last paste event handler and promise, Command id: "+e.id)}t()},0)})}constructor(){this.initialClipboardPermissionState=null,this.isActionPerformedOnPermissionPrompt=!1,this.lastClipboardItemsDeferredPromise=null,this.lastRemovePasteEventListener=null,this.isLastPasteEventListenerRemoved=!0,this.webCustomFormatPrefix="web ",this.emptyClipboardReadErrorName="DataError",this.emptyClipboardReadErrorMessage="No valid data on clipboard.",this.clipboardPermissionDeniedErrorMessage="AsyncSystemClipboardStorage - Clipboard permission is denied",this.clipboardIsInaccessibleError=new a.e(a.f.ClipboardIsInaccessible,this.clipboardPermissionDeniedErrorMessage),this.clipboardStorageType=a.g.AsyncSystemClipboard,this.disposableImplementationExtension=Object(a.X)("AsyncSystemClipboardStorage")}}class ke extends Oe{constructor(e){super(a.i.AsyncSystemClipboardAndLocalStorage,{browserStorage:!0,systemClipboard:!0,inMemory:!1},a.i.LocalStorage,e)}}class ze{initialize(e,t){var r=this;return _async_to_generator((function*(){r.initialized=!1;const[a,o]=yield Promise.all([e,t]);return r.systemClipboardStorage=a,r.asyncSystemClipboardStorage=o,r.initialized=!0,r}))()}get(e){var t=this;return _async_to_generator((function*(){t.disposableImplementationExtension.throwIfDisposed("get");const r=window.performance.now();if(!t.initialized||!t.asyncSystemClipboardStorage||!t.systemClipboardStorage)throw new a.e(a.f.ClipboardStrategyNotInitialized);try{return yield t.systemClipboardStorage.get(e)}catch(r){Object(a.mc)().ULS.traceTag(508154642,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`CombinedSystemClipboardStorage.get - systemClipboardStorage get failed. Command id: ${e.id}, Error: ${o.utils.getStringifiedError(r)}`);try{return yield t.asyncSystemClipboardStorage.get(e)}catch(t){throw Object(a.mc)().ULS.traceTag(507904976,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`CombinedSystemClipboardStorage.get - asyncSystemClipboardStorage get failed. Command id: ${e.id}, Error: ${o.utils.getStringifiedError(t)}`),new a.e(a.f.ClipboardIsInaccessible,"CombinedSystemClipboardStorage.get - Clipboard permission is denied or failed to read",t)}}finally{Object(a.mc)().ULS.traceTag(508154640,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`CombinedSystemClipboardStorage.get | System clipboard total read time: ${window.performance.now()-r} ms, Command id: ${e.id}`)}}))()}set(e,t){var r=this;return _async_to_generator((function*(){r.disposableImplementationExtension.throwIfDisposed("set");const i=window.performance.now();if(!r.initialized||!r.asyncSystemClipboardStorage||!r.systemClipboardStorage)throw new a.e(a.f.ClipboardStrategyNotInitialized);try{return void(yield r.systemClipboardStorage.set(e,t))}catch(i){Object(a.mc)().ULS.traceTag(508154638,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`CombinedSystemClipboardStorage.set - systemClipboardStorage set failed. Command id: ${t.id}, Error: ${o.utils.getStringifiedError(i)}`);try{return void(yield r.asyncSystemClipboardStorage.set(e,t))}catch(e){throw Object(a.mc)().ULS.traceTag(507904975,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`CombinedSystemClipboardStorage.set - asyncSystemClipboardStorage set failed. Command id: ${t.id}, Error: ${o.utils.getStringifiedError(e)}`),new a.e(a.f.ClipboardIsInaccessible,"CombinedSystemClipboardStorage.set - Clipboard permission is denied or failed to write",e)}}finally{Object(a.mc)().ULS.traceTag(508154637,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`CombinedSystemClipboardStorage.set - System clipboard total write time: ${window.performance.now()-i} ms, Command id: ${t.id}`)}}))()}getSupportedDataFormats(){var e,t,r,a;return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[...null!==(e=null===(t=this.systemClipboardStorage)||void 0===t?void 0:t.getSupportedDataFormats())&&void 0!==e?e:[],...null!==(r=null===(a=this.asyncSystemClipboardStorage)||void 0===a?void 0:a.getSupportedDataFormats())&&void 0!==r?r:[]].reduce((e,t)=>(-1===e.indexOf(t)&&e.push(t),e),[])}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(){this.initialized=!1,this.clipboardStorageType=a.g.AsyncSystemClipboard,this.disposableImplementationExtension=Object(a.X)("CombinedSystemClipboardStorage")}}class He extends Oe{constructor(e){super(a.i.AsyncSystemClipboardAndInMemory,{browserStorage:!1,systemClipboard:!0,inMemory:!0},a.i.InMemory,e)}}function Ve(e){return new _e(e)}function Ge(){return new Je}function Be(e,t,r,n,m,g){const p=function(e,t,r){return new E(e,t,r)}(r,n,m);return function(e,t,r,n){let m=a.s.NoError;return o.utils.chainFallbackPromises(e,e=>function(e,t,r,n){Object(a.mc)().ULS.traceTag(595716231,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Attempting to create clipboard strategy type '${e.clipboardStrategyType}'`);const m=()=>(()=>{switch(e.clipboardStrategyType){case a.i.SystemClipboard:case a.i.SystemClipboardAndInMemory:case a.i.AsyncSystemClipboard:case a.i.AsyncSystemClipboardAndInMemory:return e;case a.i.SystemClipboardAndLocalStorage:case a.i.AsyncSystemClipboardAndLocalStorage:return e.systemClipboardStrategyParameters;default:throw new a.L("createClipboardEnvironmentComponentsByType: getSystemClipboardParameters couldn't be used for "+e.clipboardStrategyType)}})().skipFilesIfPlainTextExists,g=()=>{switch(e.clipboardStrategyType){case a.i.LocalStorage:return e;case a.i.AsyncSystemClipboard:case a.i.AsyncSystemClipboardAndInMemory:case a.i.SystemClipboardAndLocalStorage:case a.i.AsyncSystemClipboardAndLocalStorage:return e.localStorageStrategyParameters;default:throw new a.L("createClipboardEnvironmentComponentsByType: getLocalStorageParameters couldn't be used for "+e.clipboardStrategyType)}},p=e=>r.createClipboardDataProcessor(e),h=()=>r.createClipboardMetaDataProcessor(),S=e=>r.createDualClipboardDataProcessor(e),y=()=>{const e=g();return e.useSharedClipboardIframe?new W:function(e){return new M(e)}(Object(a.wb)(e.sharedClipboardSchemaVersion))},C=e=>{let t;return t=Object(Ne.a)("Microsoft.Office.Excel.EnableAsyncClipboardApiByDefault",!1)?Promise.resolve(Ge()):Promise.resolve((new ze).initialize(Promise.resolve(Ve(m())),Promise.resolve(Ge()))),function(e){return new Ue(e)}(e).initialize(t)},E=()=>(new R).initialize(Promise.resolve(Ve(m()))),v=e=>function(e){return new Ie(e)}(e).initialize(Promise.resolve(new Pe)),L=(e,t)=>{const r=g();return r.useSharedClipboardIframe?((e=>{const t={};e.wacCluster&&(t.wacCluster=e.wacCluster.trim()),e.sessionId&&(t.sessionId=e.sessionId),n&&(t.bulsEndpointUrl=n);const r=e.sharedClipboardOverrideOrigin?1:0;a.jc.initializeSharedClipboardSettings({sharedClipboardHostingApp:e.sharedClipboardHostingApp,sharedClipboardHostingApps:e.sharedClipboardHostingApps,sharedClipboardHostingEnvironments:e.sharedClipboardHostingEnvironments,sharedClipboardSchemaVersion:e.sharedClipboardSchemaVersion,sharedClipboardExpirationInMinutes:e.sharedClipboardExpirationInMinutes,clipboardPromiseTimeoutInMinutes:e.sharedClipboardExpirationInMinutes,whitelistOriginComponents:r}),function(e){Object(a.mc)().ULS.shipAssertTag(595944468,o.LogCategory.msoulscat_ES_EWAJS,!!e,"ClipboardPlatformSettings.setClipboardPlatformSettings: expect clipboardPlatformSettings to be defined."),i=e}(t)})(r),function(e){return new Ae(e)}(t).initialize((s=e?a.z.localStorageMetadata:a.z.localStorageData,new $e(s)).initialize())):function(e){return new a.x(e)}(t).initialize(Promise.resolve((c=e?Object(a.vb)(r.sharedClipboardSchemaVersion):Object(a.ub)(r.sharedClipboardSchemaVersion),new a.w(c))));var s,c},w=(e,r,i)=>Promise.all([e,r]).then(([e,r])=>((e,r)=>(r?r.initialize(e):Promise.resolve(void 0)).then(()=>function(e,t,r){return Object(a.mc)().ULS.shipAssertTag(595945246,o.LogCategory.msoulscat_ES_EWAJS,!!e,"MetadataManager.createMetadataManager: expected clipboardStrategy to be defined."),Object(a.mc)().ULS.shipAssertTag(595945247,o.LogCategory.msoulscat_ES_EWAJS,!!e,"MetadataManager.createMetadataManager: expected metadataSerializationHelper to be defined."),l=e,d=function(e){return s=e,c}(t),u=r,u&&u.setOnMetadataChangedListener(b),f}(e,t,r)))(r,i).then(t=>({dataClipboardStrategy:e,metadataManager:t})));try{switch(e.clipboardStrategyType){case a.i.AsyncSystemClipboard:return w(C(p(!1)),L(!0,h()),y());case a.i.SystemClipboard:return w(E(),v(h()));case a.i.InMemory:return w(v(p(!1)),v(h()));case a.i.LocalStorage:return w(L(!1,p(!0)),L(!0,h()),y());case a.i.AsyncSystemClipboardAndLocalStorage:return w((T=S(!0),new ke(T)).initialize(C(),L(!1)),L(!0,h()),y());case a.i.AsyncSystemClipboardAndInMemory:return w((()=>{return(e=S(!1),new He(e)).initialize(C(),v());var e})(),L(!0,h()),y());case a.i.SystemClipboardAndLocalStorage:return w((()=>{return(e=S(!0),new Me(e)).initialize(E(),L(!1));var e})(),L(!0,h()),y());case a.i.SystemClipboardAndInMemory:return w((()=>{return(e=S(!1),new We(e)).initialize(E(),v());var e})(),v(h()))}return Promise.reject(new a.e(a.f.UnsupportedClipboardStrategyType,`Clipboard strategy type '${e.clipboardStrategyType}' is not supported`))}catch(t){return Promise.reject(new a.e(a.f.UnsupportedClipboardStrategyType,`failed to create clipboardStrategyType: '${e.clipboardStrategyType}' with error: ${o.utils.getStringifiedError(t)}`))}var T}(e,t,r,n).then(t=>(Object(a.mc)().ULS.traceTag(595716294,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Clipboard strategy type '${e.clipboardStrategyType}' was created.`),t.infraInitializationError=m,t)).catch(t=>{let r=!1;r=Object(a.Nb)(t),r&&(m=a.s.LocalStorageInaccessible);const i=`clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: selectClipboardStrategy: failed to create clipboard strategy type '${e.clipboardStrategyType}'. Error: ${o.utils.getStringifiedError(t)}`;return Object(a.mc)().ULS.traceTag(595716230,o.LogCategory.msoulscat_ES_EWAJS,r?o.TraceLevel.Info:o.TraceLevel.Error,i),Promise.reject(new a.e(a.f.SelectClipboardStrategy,i,t))}))}(e,t,p,g).then(e=>({dataClipboardStrategy:e.dataClipboardStrategy,clipboardDataManager:p,metadataManager:e.metadataManager,infraInitializationError:e.infraInitializationError}))}function Ke(){return Qe}function qe(e){(class{static setFeatureGateManager(e){Object(Ne.b)(e)}}).setFeatureGateManager(e)}!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.StateReady=1]="StateReady",e[e.InitializationSucceed=2]="InitializationSucceed"}(Fe||(Fe={}));const Xe={initializationStatus:Fe.NotInitialized,stateInitialized:!1,clipboardStrategy:void 0,chromeExtensionIds:[],clipboardPromiseTimeoutInMinutes:a.jc.defaultPromiseTimeoutInMinutes,copyToClipboardLatencyMessage:"Retrieving data. Wait a few seconds and try to cut or copy again.",metadataManager:void 0,clipboardDataManager:void 0,initializationError:a.s.NoError},Qe={init:function(e,t,r,i,n,s,c,l,d,u,m,g,p,f,b,h,S,y){return Xe.lastClipboardPlatformEnvironmentInitializationInfo?Promise.resolve(Xe.lastClipboardPlatformEnvironmentInitializationInfo):(Object(a.Eb)(e),t&&Array.isArray(t)?(Object(a.mc)().ULS.traceTag(596455702,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,`ClipboardPlatformEnvironment.init: chromeExtensionIds = '${JSON.stringify(t)}'`),Xe.chromeExtensionIds=function(e){const t=[];if(!e)return t;for(const r of e)r&&"string"==typeof r&&r.trim().length>0&&t.push(r);return t}(t),u&&(Xe.copyToClipboardLatencyMessage=u),"number"!=typeof d||isNaN(d)||(Xe.clipboardPromiseTimeoutInMinutes=d),Xe.initializationStatus=Fe.StateReady,Be(p,g,f,b,h,y).then(e=>(Xe.clipboardDataManager=e.clipboardDataManager,Xe.metadataManager=e.metadataManager,Xe.clipboardStrategy=e.dataClipboardStrategy,Xe.initializationError=e.infraInitializationError,Xe.initializationStatus=Fe.InitializationSucceed,Xe.lastClipboardPlatformEnvironmentInitializationInfo={clipboardStrategiesToInitialize:p,dataClipboardCapabilities:Xe.clipboardStrategy&&Xe.clipboardStrategy.clipboardCapabilities,dataClipboardStrategyType:Xe.clipboardStrategy&&Xe.clipboardStrategy.clipboardStrategyType,infraInitializationError:Xe.initializationError},Xe.lastClipboardPlatformEnvironmentInitializationInfo))):Promise.reject(new a.B(a.jb,"chromeExtensionIds")))},getClipboardStrategy:function(){if(Ye(),!Xe.clipboardStrategy)throw new a.u("A clipboard strategy has not been selected. Call selectClipboardStrategy.");return Xe.clipboardStrategy},getChromeExtensionIds:function(){return Ze(),Xe.chromeExtensionIds},getClipboardPromiseTimeoutInMinutes:function(){return Ze(),Xe.clipboardPromiseTimeoutInMinutes},getCopyToClipboardLatencyMessage:function(){return Ze(),Xe.copyToClipboardLatencyMessage},getMetadataManager:function(){return Ye(),Xe.metadataManager},getClipboardDataManager:function(){return Ye(),Xe.clipboardDataManager},getInitializationError:function(){return Ye(),Xe.initializationError}};function Ye(){if(Xe.initializationStatus!==Fe.InitializationSucceed)throw new a.u("ClipboardPlatformEnvironment is not initialized. Call init(...).")}function Ze(){if(Xe.initializationStatus<Fe.StateReady)throw new a.u("ClipboardPlatformEnvironment state is not ready. Call init(...).")}}]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/clipboardPlatform.min.js.map/2fecd69b29f9a5356aa37c1abb27b276/clipboardPlatform.min.js.map